const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/section-one-D2RkjZUN.js","assets/OrbitControls-C56au4j5.js","assets/section-one-CgPhTYXR.css","assets/section-three-ogRKiRgT.js","assets/section-three-D_qGwwWg.css","assets/section-tw-Dc0uVwEA.js","assets/section-tw-15Ojsrp3.css"])))=>i.map(i=>d[i]);
var qI=Object.defineProperty;var zI=(n,e,t)=>e in n?qI(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var OA=(n,e,t)=>zI(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function nx(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const xi={},xf=[],za=()=>{},HI=()=>!1,kg=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),ix=n=>n.startsWith("onUpdate:"),kr=Object.assign,rx=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},$I=Object.prototype.hasOwnProperty,li=(n,e)=>$I.call(n,e),an=Array.isArray,bf=n=>Vg(n)==="[object Map]",GT=n=>Vg(n)==="[object Set]",xn=n=>typeof n=="function",rr=n=>typeof n=="string",Xl=n=>typeof n=="symbol",Ui=n=>n!==null&&typeof n=="object",qT=n=>(Ui(n)||xn(n))&&xn(n.then)&&xn(n.catch),zT=Object.prototype.toString,Vg=n=>zT.call(n),WI=n=>Vg(n).slice(8,-1),HT=n=>Vg(n)==="[object Object]",sx=n=>rr(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,R0=nx(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Gg=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},jI=/-(\w)/g,qo=Gg(n=>n.replace(jI,(e,t)=>t?t.toUpperCase():"")),XI=/\B([A-Z])/g,uh=Gg(n=>n.replace(XI,"-$1").toLowerCase()),qg=Gg(n=>n.charAt(0).toUpperCase()+n.slice(1)),__=Gg(n=>n?`on${qg(n)}`:""),Ru=(n,e)=>!Object.is(n,e),v_=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},$T=(n,e,t,i=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:i,value:t})},QI=n=>{const e=parseFloat(n);return isNaN(e)?n:e},YI=n=>{const e=rr(n)?Number(n):NaN;return isNaN(e)?n:e};let I5;const zg=()=>I5||(I5=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function pa(n){if(an(n)){const e={};for(let t=0;t<n.length;t++){const i=n[t],r=rr(i)?eB(i):pa(i);if(r)for(const s in r)e[s]=r[s]}return e}else if(rr(n)||Ui(n))return n}const ZI=/;(?![^(]*\))/g,KI=/:([^]+)/,JI=/\/\*[^]*?\*\//g;function eB(n){const e={};return n.replace(JI,"").split(ZI).forEach(t=>{if(t){const i=t.split(KI);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function On(n){let e="";if(rr(n))e=n;else if(an(n))for(let t=0;t<n.length;t++){const i=On(n[t]);i&&(e+=i+" ")}else if(Ui(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const tB="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",nB=nx(tB);function WT(n){return!!n||n===""}const jT=n=>!!(n&&n.__v_isRef===!0),Lt=n=>rr(n)?n:n==null?"":an(n)||Ui(n)&&(n.toString===zT||!xn(n.toString))?jT(n)?Lt(n.value):JSON.stringify(n,XT,2):String(n),XT=(n,e)=>jT(e)?XT(n,e.value):bf(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[i,r],s)=>(t[y_(i,s)+" =>"]=r,t),{})}:GT(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>y_(t))}:Xl(e)?y_(e):Ui(e)&&!an(e)&&!HT(e)?String(e):e,y_=(n,e="")=>{var t;return Xl(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ms;class iB{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ms,!e&&Ms&&(this.index=(Ms.scopes||(Ms.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Ms;try{return Ms=this,e()}finally{Ms=t}}}on(){Ms=this}off(){Ms=this.parent}stop(e){if(this._active){this._active=!1;let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(this.effects.length=0,t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function QT(){return Ms}function rB(n,e=!1){Ms&&Ms.cleanups.push(n)}let Si;const x_=new WeakSet;class YT{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ms&&Ms.active&&Ms.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,x_.has(this)&&(x_.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||KT(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,B5(this),JT(this);const e=Si,t=ca;Si=this,ca=!0;try{return this.fn()}finally{eM(this),Si=e,ca=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)lx(e);this.deps=this.depsTail=void 0,B5(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?x_.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){mv(this)&&this.run()}get dirty(){return mv(this)}}let ZT=0,N0,P0;function KT(n,e=!1){if(n.flags|=8,e){n.next=P0,P0=n;return}n.next=N0,N0=n}function ox(){ZT++}function ax(){if(--ZT>0)return;if(P0){let e=P0;for(P0=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;N0;){let e=N0;for(N0=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){n||(n=i)}e=t}}if(n)throw n}function JT(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function eM(n){let e,t=n.depsTail,i=t;for(;i;){const r=i.prevDep;i.version===-1?(i===t&&(t=r),lx(i),sB(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}n.deps=e,n.depsTail=t}function mv(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(tM(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function tM(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===Q0))return;n.globalVersion=Q0;const e=n.dep;if(n.flags|=2,e.version>0&&!n.isSSR&&n.deps&&!mv(n)){n.flags&=-3;return}const t=Si,i=ca;Si=n,ca=!0;try{JT(n);const r=n.fn(n._value);(e.version===0||Ru(r,n._value))&&(n._value=r,e.version++)}catch(r){throw e.version++,r}finally{Si=t,ca=i,eM(n),n.flags&=-3}}function lx(n,e=!1){const{dep:t,prevSub:i,nextSub:r}=n;if(i&&(i.nextSub=r,n.prevSub=void 0),r&&(r.prevSub=i,n.nextSub=void 0),t.subs===n&&(t.subs=i,!i&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)lx(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function sB(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let ca=!0;const nM=[];function Gu(){nM.push(ca),ca=!1}function qu(){const n=nM.pop();ca=n===void 0?!0:n}function B5(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Si;Si=void 0;try{e()}finally{Si=t}}}let Q0=0;class oB{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ux{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Si||!ca||Si===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Si)t=this.activeLink=new oB(Si,this),Si.deps?(t.prevDep=Si.depsTail,Si.depsTail.nextDep=t,Si.depsTail=t):Si.deps=Si.depsTail=t,iM(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const i=t.nextDep;i.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=i),t.prevDep=Si.depsTail,t.nextDep=void 0,Si.depsTail.nextDep=t,Si.depsTail=t,Si.deps===t&&(Si.deps=i)}return t}trigger(e){this.version++,Q0++,this.notify(e)}notify(e){ox();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{ax()}}}function iM(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)iM(i)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const N1=new WeakMap,Fc=Symbol(""),gv=Symbol(""),Y0=Symbol("");function ls(n,e,t){if(ca&&Si){let i=N1.get(n);i||N1.set(n,i=new Map);let r=i.get(t);r||(i.set(t,r=new ux),r.map=i,r.key=t),r.track()}}function Ml(n,e,t,i,r,s){const o=N1.get(n);if(!o){Q0++;return}const a=l=>{l&&l.trigger()};if(ox(),e==="clear")o.forEach(a);else{const l=an(n),u=l&&sx(t);if(l&&t==="length"){const A=Number(i);o.forEach((p,g)=>{(g==="length"||g===Y0||!Xl(g)&&g>=A)&&a(p)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),u&&a(o.get(Y0)),e){case"add":l?u&&a(o.get("length")):(a(o.get(Fc)),bf(n)&&a(o.get(gv)));break;case"delete":l||(a(o.get(Fc)),bf(n)&&a(o.get(gv)));break;case"set":bf(n)&&a(o.get(Fc));break}}ax()}function aB(n,e){const t=N1.get(n);return t&&t.get(e)}function Th(n){const e=Zn(n);return e===n?e:(ls(e,"iterate",Y0),Vo(n)?e:e.map(us))}function Hg(n){return ls(n=Zn(n),"iterate",Y0),n}const lB={__proto__:null,[Symbol.iterator](){return b_(this,Symbol.iterator,us)},concat(...n){return Th(this).concat(...n.map(e=>an(e)?Th(e):e))},entries(){return b_(this,"entries",n=>(n[1]=us(n[1]),n))},every(n,e){return fl(this,"every",n,e,void 0,arguments)},filter(n,e){return fl(this,"filter",n,e,t=>t.map(us),arguments)},find(n,e){return fl(this,"find",n,e,us,arguments)},findIndex(n,e){return fl(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return fl(this,"findLast",n,e,us,arguments)},findLastIndex(n,e){return fl(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return fl(this,"forEach",n,e,void 0,arguments)},includes(...n){return w_(this,"includes",n)},indexOf(...n){return w_(this,"indexOf",n)},join(n){return Th(this).join(n)},lastIndexOf(...n){return w_(this,"lastIndexOf",n)},map(n,e){return fl(this,"map",n,e,void 0,arguments)},pop(){return kA(this,"pop")},push(...n){return kA(this,"push",n)},reduce(n,...e){return F5(this,"reduce",n,e)},reduceRight(n,...e){return F5(this,"reduceRight",n,e)},shift(){return kA(this,"shift")},some(n,e){return fl(this,"some",n,e,void 0,arguments)},splice(...n){return kA(this,"splice",n)},toReversed(){return Th(this).toReversed()},toSorted(n){return Th(this).toSorted(n)},toSpliced(...n){return Th(this).toSpliced(...n)},unshift(...n){return kA(this,"unshift",n)},values(){return b_(this,"values",us)}};function b_(n,e,t){const i=Hg(n),r=i[e]();return i!==n&&!Vo(n)&&(r._next=r.next,r.next=()=>{const s=r._next();return s.value&&(s.value=t(s.value)),s}),r}const uB=Array.prototype;function fl(n,e,t,i,r,s){const o=Hg(n),a=o!==n&&!Vo(n),l=o[e];if(l!==uB[e]){const p=l.apply(n,s);return a?us(p):p}let u=t;o!==n&&(a?u=function(p,g){return t.call(this,us(p),g,n)}:t.length>2&&(u=function(p,g){return t.call(this,p,g,n)}));const A=l.call(o,u,i);return a&&r?r(A):A}function F5(n,e,t,i){const r=Hg(n);let s=t;return r!==n&&(Vo(n)?t.length>3&&(s=function(o,a,l){return t.call(this,o,a,l,n)}):s=function(o,a,l){return t.call(this,o,us(a),l,n)}),r[e](s,...i)}function w_(n,e,t){const i=Zn(n);ls(i,"iterate",Y0);const r=i[e](...t);return(r===-1||r===!1)&&fx(t[0])?(t[0]=Zn(t[0]),i[e](...t)):r}function kA(n,e,t=[]){Gu(),ox();const i=Zn(n)[e].apply(n,t);return ax(),qu(),i}const cB=nx("__proto__,__v_isRef,__isVue"),rM=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Xl));function hB(n){Xl(n)||(n=String(n));const e=Zn(this);return ls(e,"has",n),e.hasOwnProperty(n)}class sM{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,i){if(t==="__v_skip")return e.__v_skip;const r=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!r;if(t==="__v_isReadonly")return r;if(t==="__v_isShallow")return s;if(t==="__v_raw")return i===(r?s?xB:uM:s?lM:aM).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=an(e);if(!r){let l;if(o&&(l=lB[t]))return l;if(t==="hasOwnProperty")return hB}const a=Reflect.get(e,t,Wr(e)?e:i);return(Xl(t)?rM.has(t):cB(t))||(r||ls(e,"get",t),s)?a:Wr(a)?o&&sx(t)?a:a.value:Ui(a)?r?cM(a):Fu(a):a}}class oM extends sM{constructor(e=!1){super(!1,e)}set(e,t,i,r){let s=e[t];if(!this._isShallow){const l=jc(s);if(!Vo(i)&&!jc(i)&&(s=Zn(s),i=Zn(i)),!an(e)&&Wr(s)&&!Wr(i))return l?!1:(s.value=i,!0)}const o=an(e)&&sx(t)?Number(t)<e.length:li(e,t),a=Reflect.set(e,t,i,Wr(e)?e:r);return e===Zn(r)&&(o?Ru(i,s)&&Ml(e,"set",t,i):Ml(e,"add",t,i)),a}deleteProperty(e,t){const i=li(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&i&&Ml(e,"delete",t,void 0),r}has(e,t){const i=Reflect.has(e,t);return(!Xl(t)||!rM.has(t))&&ls(e,"has",t),i}ownKeys(e){return ls(e,"iterate",an(e)?"length":Fc),Reflect.ownKeys(e)}}class fB extends sM{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const AB=new oM,dB=new fB,pB=new oM(!0);const _v=n=>n,Dp=n=>Reflect.getPrototypeOf(n);function mB(n,e,t){return function(...i){const r=this.__v_raw,s=Zn(r),o=bf(s),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,u=r[n](...i),A=t?_v:e?vv:us;return!e&&ls(s,"iterate",l?gv:Fc),{next(){const{value:p,done:g}=u.next();return g?{value:p,done:g}:{value:a?[A(p[0]),A(p[1])]:A(p),done:g}},[Symbol.iterator](){return this}}}}function Ip(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function gB(n,e){const t={get(r){const s=this.__v_raw,o=Zn(s),a=Zn(r);n||(Ru(r,a)&&ls(o,"get",r),ls(o,"get",a));const{has:l}=Dp(o),u=e?_v:n?vv:us;if(l.call(o,r))return u(s.get(r));if(l.call(o,a))return u(s.get(a));s!==o&&s.get(r)},get size(){const r=this.__v_raw;return!n&&ls(Zn(r),"iterate",Fc),Reflect.get(r,"size",r)},has(r){const s=this.__v_raw,o=Zn(s),a=Zn(r);return n||(Ru(r,a)&&ls(o,"has",r),ls(o,"has",a)),r===a?s.has(r):s.has(r)||s.has(a)},forEach(r,s){const o=this,a=o.__v_raw,l=Zn(a),u=e?_v:n?vv:us;return!n&&ls(l,"iterate",Fc),a.forEach((A,p)=>r.call(s,u(A),u(p),o))}};return kr(t,n?{add:Ip("add"),set:Ip("set"),delete:Ip("delete"),clear:Ip("clear")}:{add(r){!e&&!Vo(r)&&!jc(r)&&(r=Zn(r));const s=Zn(this);return Dp(s).has.call(s,r)||(s.add(r),Ml(s,"add",r,r)),this},set(r,s){!e&&!Vo(s)&&!jc(s)&&(s=Zn(s));const o=Zn(this),{has:a,get:l}=Dp(o);let u=a.call(o,r);u||(r=Zn(r),u=a.call(o,r));const A=l.call(o,r);return o.set(r,s),u?Ru(s,A)&&Ml(o,"set",r,s):Ml(o,"add",r,s),this},delete(r){const s=Zn(this),{has:o,get:a}=Dp(s);let l=o.call(s,r);l||(r=Zn(r),l=o.call(s,r)),a&&a.call(s,r);const u=s.delete(r);return l&&Ml(s,"delete",r,void 0),u},clear(){const r=Zn(this),s=r.size!==0,o=r.clear();return s&&Ml(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=mB(r,n,e)}),t}function cx(n,e){const t=gB(n,e);return(i,r,s)=>r==="__v_isReactive"?!n:r==="__v_isReadonly"?n:r==="__v_raw"?i:Reflect.get(li(t,r)&&r in i?t:i,r,s)}const _B={get:cx(!1,!1)},vB={get:cx(!1,!0)},yB={get:cx(!0,!1)};const aM=new WeakMap,lM=new WeakMap,uM=new WeakMap,xB=new WeakMap;function bB(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function wB(n){return n.__v_skip||!Object.isExtensible(n)?0:bB(WI(n))}function Fu(n){return jc(n)?n:hx(n,!1,AB,_B,aM)}function SB(n){return hx(n,!1,pB,vB,lM)}function cM(n){return hx(n,!0,dB,yB,uM)}function hx(n,e,t,i,r){if(!Ui(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=r.get(n);if(s)return s;const o=wB(n);if(o===0)return n;const a=new Proxy(n,o===2?i:t);return r.set(n,a),a}function wf(n){return jc(n)?wf(n.__v_raw):!!(n&&n.__v_isReactive)}function jc(n){return!!(n&&n.__v_isReadonly)}function Vo(n){return!!(n&&n.__v_isShallow)}function fx(n){return n?!!n.__v_raw:!1}function Zn(n){const e=n&&n.__v_raw;return e?Zn(e):n}function TB(n){return!li(n,"__v_skip")&&Object.isExtensible(n)&&$T(n,"__v_skip",!0),n}const us=n=>Ui(n)?Fu(n):n,vv=n=>Ui(n)?cM(n):n;function Wr(n){return n?n.__v_isRef===!0:!1}function Ln(n){return MB(n,!1)}function MB(n,e){return Wr(n)?n:new EB(n,e)}class EB{constructor(e,t){this.dep=new ux,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Zn(e),this._value=t?e:us(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,i=this.__v_isShallow||Vo(e)||jc(e);e=i?e:Zn(e),Ru(e,t)&&(this._rawValue=e,this._value=i?e:us(e),this.dep.trigger())}}function Ke(n){return Wr(n)?n.value:n}const CB={get:(n,e,t)=>e==="__v_raw"?n:Ke(Reflect.get(n,e,t)),set:(n,e,t,i)=>{const r=n[e];return Wr(r)&&!Wr(t)?(r.value=t,!0):Reflect.set(n,e,t,i)}};function hM(n){return wf(n)?n:new Proxy(n,CB)}function U5(n){const e=an(n)?new Array(n.length):{};for(const t in n)e[t]=NB(n,t);return e}class RB{constructor(e,t,i){this._object=e,this._key=t,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return aB(Zn(this._object),this._key)}}function NB(n,e,t){const i=n[e];return Wr(i)?i:new RB(n,e,t)}class PB{constructor(e,t,i){this.fn=e,this.setter=t,this._value=void 0,this.dep=new ux(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Q0-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Si!==this)return KT(this,!0),!0}get value(){const e=this.dep.track();return tM(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function LB(n,e,t=!1){let i,r;return xn(n)?i=n:(i=n.get,r=n.set),new PB(i,r,t)}const Bp={},P1=new WeakMap;let xc;function DB(n,e=!1,t=xc){if(t){let i=P1.get(t);i||P1.set(t,i=[]),i.push(n)}}function IB(n,e,t=xi){const{immediate:i,deep:r,once:s,scheduler:o,augmentJob:a,call:l}=t,u=N=>r?N:Vo(N)||r===!1||r===0?El(N,1):El(N);let A,p,g,v,x=!1,S=!1;if(Wr(n)?(p=()=>n.value,x=Vo(n)):wf(n)?(p=()=>u(n),x=!0):an(n)?(S=!0,x=n.some(N=>wf(N)||Vo(N)),p=()=>n.map(N=>{if(Wr(N))return N.value;if(wf(N))return u(N);if(xn(N))return l?l(N,2):N()})):xn(n)?e?p=l?()=>l(n,2):n:p=()=>{if(g){Gu();try{g()}finally{qu()}}const N=xc;xc=A;try{return l?l(n,3,[v]):n(v)}finally{xc=N}}:p=za,e&&r){const N=p,D=r===!0?1/0:r;p=()=>El(N(),D)}const T=QT(),w=()=>{A.stop(),T&&T.active&&rx(T.effects,A)};if(s&&e){const N=e;e=(...D)=>{N(...D),w()}}let R=S?new Array(n.length).fill(Bp):Bp;const E=N=>{if(!(!(A.flags&1)||!A.dirty&&!N))if(e){const D=A.run();if(r||x||(S?D.some((B,I)=>Ru(B,R[I])):Ru(D,R))){g&&g();const B=xc;xc=A;try{const I=[D,R===Bp?void 0:S&&R[0]===Bp?[]:R,v];l?l(e,3,I):e(...I),R=D}finally{xc=B}}}else A.run()};return a&&a(E),A=new YT(p),A.scheduler=o?()=>o(E,!1):E,v=N=>DB(N,!1,A),g=A.onStop=()=>{const N=P1.get(A);if(N){if(l)l(N,4);else for(const D of N)D();P1.delete(A)}},e?i?E(!0):R=A.run():o?o(E.bind(null,!0),!0):A.run(),w.pause=A.pause.bind(A),w.resume=A.resume.bind(A),w.stop=w,w}function El(n,e=1/0,t){if(e<=0||!Ui(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,Wr(n))El(n.value,e,t);else if(an(n))for(let i=0;i<n.length;i++)El(n[i],e,t);else if(GT(n)||bf(n))n.forEach(i=>{El(i,e,t)});else if(HT(n)){for(const i in n)El(n[i],e,t);for(const i of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,i)&&El(n[i],e,t)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function jd(n,e,t,i){try{return i?n(...i):n()}catch(r){Xd(r,e,t)}}function ma(n,e,t,i){if(xn(n)){const r=jd(n,e,t,i);return r&&qT(r)&&r.catch(s=>{Xd(s,e,t)}),r}if(an(n)){const r=[];for(let s=0;s<n.length;s++)r.push(ma(n[s],e,t,i));return r}}function Xd(n,e,t,i=!0){const r=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||xi;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const A=a.ec;if(A){for(let p=0;p<A.length;p++)if(A[p](n,l,u)===!1)return}a=a.parent}if(s){Gu(),jd(s,null,10,[n,l,u]),qu();return}}BB(n,t,r,i,o)}function BB(n,e,t,i=!0,r=!1){if(r)throw n;console.error(n)}const Cs=[];let Ba=-1;const Sf=[];let vu=null,af=0;const fM=Promise.resolve();let L1=null;function AM(n){const e=L1||fM;return n?e.then(this?n.bind(this):n):e}function FB(n){let e=Ba+1,t=Cs.length;for(;e<t;){const i=e+t>>>1,r=Cs[i],s=Z0(r);s<n||s===n&&r.flags&2?e=i+1:t=i}return e}function Ax(n){if(!(n.flags&1)){const e=Z0(n),t=Cs[Cs.length-1];!t||!(n.flags&2)&&e>=Z0(t)?Cs.push(n):Cs.splice(FB(e),0,n),n.flags|=1,dM()}}function dM(){L1||(L1=fM.then(mM))}function UB(n){an(n)?Sf.push(...n):vu&&n.id===-1?vu.splice(af+1,0,n):n.flags&1||(Sf.push(n),n.flags|=1),dM()}function O5(n,e,t=Ba+1){for(;t<Cs.length;t++){const i=Cs[t];if(i&&i.flags&2){if(n&&i.id!==n.uid)continue;Cs.splice(t,1),t--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function pM(n){if(Sf.length){const e=[...new Set(Sf)].sort((t,i)=>Z0(t)-Z0(i));if(Sf.length=0,vu){vu.push(...e);return}for(vu=e,af=0;af<vu.length;af++){const t=vu[af];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}vu=null,af=0}}const Z0=n=>n.id==null?n.flags&2?-1:1/0:n.id;function mM(n){try{for(Ba=0;Ba<Cs.length;Ba++){const e=Cs[Ba];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),jd(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ba<Cs.length;Ba++){const e=Cs[Ba];e&&(e.flags&=-2)}Ba=-1,Cs.length=0,pM(),L1=null,(Cs.length||Sf.length)&&mM()}}let Ur=null,gM=null;function D1(n){const e=Ur;return Ur=n,gM=n&&n.type.__scopeId||null,e}function zn(n,e=Ur,t){if(!e||n._n)return n;const i=(...r)=>{i._d&&J5(-1);const s=D1(e);let o;try{o=n(...r)}finally{D1(s),i._d&&J5(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function yv(n,e){if(Ur===null)return n;const t=Xg(Ur),i=n.dirs||(n.dirs=[]);for(let r=0;r<e.length;r++){let[s,o,a,l=xi]=e[r];s&&(xn(s)&&(s={mounted:s,updated:s}),s.deep&&El(o),i.push({dir:s,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function tc(n,e,t,i){const r=n.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(Gu(),ma(l,t,8,[n.el,a,n,e]),qu())}}const _M=Symbol("_vte"),vM=n=>n.__isTeleport,L0=n=>n&&(n.disabled||n.disabled===""),k5=n=>n&&(n.defer||n.defer===""),V5=n=>typeof SVGElement<"u"&&n instanceof SVGElement,G5=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,xv=(n,e)=>{const t=n&&n.to;return rr(t)?e?e(t):null:t},yM={name:"Teleport",__isTeleport:!0,process(n,e,t,i,r,s,o,a,l,u){const{mc:A,pc:p,pbc:g,o:{insert:v,querySelector:x,createText:S,createComment:T}}=u,w=L0(e.props);let{shapeFlag:R,children:E,dynamicChildren:N}=e;if(n==null){const D=e.el=S(""),B=e.anchor=S("");v(D,t,i),v(B,t,i);const I=(L,F)=>{R&16&&(r&&r.isCE&&(r.ce._teleportTarget=L),A(E,L,F,r,s,o,a,l))},O=()=>{const L=e.target=xv(e.props,x),F=xM(L,e,S,v);L&&(o!=="svg"&&V5(L)?o="svg":o!=="mathml"&&G5(L)&&(o="mathml"),w||(I(L,F),s1(e,!1)))};w&&(I(t,B),s1(e,!0)),k5(e.props)?Ts(()=>{O(),e.el.__isMounted=!0},s):O()}else{if(k5(e.props)&&!n.el.__isMounted){Ts(()=>{yM.process(n,e,t,i,r,s,o,a,l,u),delete n.el.__isMounted},s);return}e.el=n.el,e.targetStart=n.targetStart;const D=e.anchor=n.anchor,B=e.target=n.target,I=e.targetAnchor=n.targetAnchor,O=L0(n.props),L=O?t:B,F=O?D:I;if(o==="svg"||V5(B)?o="svg":(o==="mathml"||G5(B))&&(o="mathml"),N?(g(n.dynamicChildren,N,L,r,s,o,a),gx(n,e,!0)):l||p(n,e,L,F,r,s,o,a,!1),w)O?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):Fp(e,t,D,u,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const V=e.target=xv(e.props,x);V&&Fp(e,V,null,u,0)}else O&&Fp(e,B,I,u,1);s1(e,w)}},remove(n,e,t,{um:i,o:{remove:r}},s){const{shapeFlag:o,children:a,anchor:l,targetStart:u,targetAnchor:A,target:p,props:g}=n;if(p&&(r(u),r(A)),s&&r(l),o&16){const v=s||!L0(g);for(let x=0;x<a.length;x++){const S=a[x];i(S,e,t,v,!!S.dynamicChildren)}}},move:Fp,hydrate:OB};function Fp(n,e,t,{o:{insert:i},m:r},s=2){s===0&&i(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:u,props:A}=n,p=s===2;if(p&&i(o,e,t),(!p||L0(A))&&l&16)for(let g=0;g<u.length;g++)r(u[g],e,t,2);p&&i(a,e,t)}function OB(n,e,t,i,r,s,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:u,createText:A}},p){const g=e.target=xv(e.props,l);if(g){const v=L0(e.props),x=g._lpa||g.firstChild;if(e.shapeFlag&16)if(v)e.anchor=p(o(n),e,a(n),t,i,r,s),e.targetStart=x,e.targetAnchor=x&&o(x);else{e.anchor=o(n);let S=x;for(;S;){if(S&&S.nodeType===8){if(S.data==="teleport start anchor")e.targetStart=S;else if(S.data==="teleport anchor"){e.targetAnchor=S,g._lpa=e.targetAnchor&&o(e.targetAnchor);break}}S=o(S)}e.targetAnchor||xM(g,e,A,u),p(x&&o(x),e,g,t,i,r,s)}s1(e,v)}return e.anchor&&o(e.anchor)}const kB=yM;function s1(n,e){const t=n.ctx;if(t&&t.ut){let i,r;for(e?(i=n.el,r=n.anchor):(i=n.targetStart,r=n.targetAnchor);i&&i!==r;)i.nodeType===1&&i.setAttribute("data-v-owner",t.uid),i=i.nextSibling;t.ut()}}function xM(n,e,t,i){const r=e.targetStart=t(""),s=e.targetAnchor=t("");return r[_M]=s,n&&(i(r,n),i(s,n)),s}const yu=Symbol("_leaveCb"),Up=Symbol("_enterCb");function VB(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Yl(()=>{n.isMounted=!0}),CM(()=>{n.isUnmounting=!0}),n}const Ro=[Function,Array],bM={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ro,onEnter:Ro,onAfterEnter:Ro,onEnterCancelled:Ro,onBeforeLeave:Ro,onLeave:Ro,onAfterLeave:Ro,onLeaveCancelled:Ro,onBeforeAppear:Ro,onAppear:Ro,onAfterAppear:Ro,onAppearCancelled:Ro},wM=n=>{const e=n.subTree;return e.component?wM(e.component):e},GB={name:"BaseTransition",props:bM,setup(n,{slots:e}){const t=YM(),i=VB();return()=>{const r=e.default&&MM(e.default(),!0);if(!r||!r.length)return;const s=SM(r),o=Zn(n),{mode:a}=o;if(i.isLeaving)return S_(s);const l=q5(s);if(!l)return S_(s);let u=bv(l,o,i,t,p=>u=p);l.type!==Ls&&K0(l,u);let A=t.subTree&&q5(t.subTree);if(A&&A.type!==Ls&&!Mc(l,A)&&wM(t).type!==Ls){let p=bv(A,o,i,t);if(K0(A,p),a==="out-in"&&l.type!==Ls)return i.isLeaving=!0,p.afterLeave=()=>{i.isLeaving=!1,t.job.flags&8||t.update(),delete p.afterLeave,A=void 0},S_(s);a==="in-out"&&l.type!==Ls?p.delayLeave=(g,v,x)=>{const S=TM(i,A);S[String(A.key)]=A,g[yu]=()=>{v(),g[yu]=void 0,delete u.delayedLeave,A=void 0},u.delayedLeave=()=>{x(),delete u.delayedLeave,A=void 0}}:A=void 0}else A&&(A=void 0);return s}}};function SM(n){let e=n[0];if(n.length>1){for(const t of n)if(t.type!==Ls){e=t;break}}return e}const qB=GB;function TM(n,e){const{leavingVNodes:t}=n;let i=t.get(e.type);return i||(i=Object.create(null),t.set(e.type,i)),i}function bv(n,e,t,i,r){const{appear:s,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:u,onAfterEnter:A,onEnterCancelled:p,onBeforeLeave:g,onLeave:v,onAfterLeave:x,onLeaveCancelled:S,onBeforeAppear:T,onAppear:w,onAfterAppear:R,onAppearCancelled:E}=e,N=String(n.key),D=TM(t,n),B=(L,F)=>{L&&ma(L,i,9,F)},I=(L,F)=>{const V=F[1];B(L,F),an(L)?L.every(H=>H.length<=1)&&V():L.length<=1&&V()},O={mode:o,persisted:a,beforeEnter(L){let F=l;if(!t.isMounted)if(s)F=T||l;else return;L[yu]&&L[yu](!0);const V=D[N];V&&Mc(n,V)&&V.el[yu]&&V.el[yu](),B(F,[L])},enter(L){let F=u,V=A,H=p;if(!t.isMounted)if(s)F=w||u,V=R||A,H=E||p;else return;let Q=!1;const te=L[Up]=K=>{Q||(Q=!0,K?B(H,[L]):B(V,[L]),O.delayedLeave&&O.delayedLeave(),L[Up]=void 0)};F?I(F,[L,te]):te()},leave(L,F){const V=String(n.key);if(L[Up]&&L[Up](!0),t.isUnmounting)return F();B(g,[L]);let H=!1;const Q=L[yu]=te=>{H||(H=!0,F(),te?B(S,[L]):B(x,[L]),L[yu]=void 0,D[V]===n&&delete D[V])};D[V]=n,v?I(v,[L,Q]):Q()},clone(L){const F=bv(L,e,t,i,r);return r&&r(F),F}};return O}function S_(n){if(Qd(n))return n=Uu(n),n.children=null,n}function q5(n){if(!Qd(n))return vM(n.type)&&n.children?SM(n.children):n;const{shapeFlag:e,children:t}=n;if(t){if(e&16)return t[0];if(e&32&&xn(t.default))return t.default()}}function K0(n,e){n.shapeFlag&6&&n.component?(n.transition=e,K0(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function MM(n,e=!1,t){let i=[],r=0;for(let s=0;s<n.length;s++){let o=n[s];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===Di?(o.patchFlag&128&&r++,i=i.concat(MM(o.children,e,a))):(e||o.type!==Ls)&&i.push(a!=null?Uu(o,{key:a}):o)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function _t(n,e){return xn(n)?kr({name:n.name},e,{setup:n}):n}function dx(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function I1(n,e,t,i,r=!1){if(an(n)){n.forEach((x,S)=>I1(x,e&&(an(e)?e[S]:e),t,i,r));return}if(Tf(i)&&!r){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&I1(n,e,t,i.component.subTree);return}const s=i.shapeFlag&4?Xg(i.component):i.el,o=r?null:s,{i:a,r:l}=n,u=e&&e.r,A=a.refs===xi?a.refs={}:a.refs,p=a.setupState,g=Zn(p),v=p===xi?()=>!1:x=>li(g,x);if(u!=null&&u!==l&&(rr(u)?(A[u]=null,v(u)&&(p[u]=null)):Wr(u)&&(u.value=null)),xn(l))jd(l,a,12,[o,A]);else{const x=rr(l),S=Wr(l);if(x||S){const T=()=>{if(n.f){const w=x?v(l)?p[l]:A[l]:l.value;r?an(w)&&rx(w,s):an(w)?w.includes(s)||w.push(s):x?(A[l]=[s],v(l)&&(p[l]=A[l])):(l.value=[s],n.k&&(A[n.k]=l.value))}else x?(A[l]=o,v(l)&&(p[l]=o)):S&&(l.value=o,n.k&&(A[n.k]=o))};o?(T.id=-1,Ts(T,t)):T()}}}const z5=n=>n.nodeType===8;zg().requestIdleCallback;zg().cancelIdleCallback;function zB(n,e){if(z5(n)&&n.data==="["){let t=1,i=n.nextSibling;for(;i;){if(i.nodeType===1){if(e(i)===!1)break}else if(z5(i))if(i.data==="]"){if(--t===0)break}else i.data==="["&&t++;i=i.nextSibling}}else e(n)}const Tf=n=>!!n.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function T_(n){xn(n)&&(n={loader:n});const{loader:e,loadingComponent:t,errorComponent:i,delay:r=200,hydrate:s,timeout:o,suspensible:a=!0,onError:l}=n;let u=null,A,p=0;const g=()=>(p++,u=null,v()),v=()=>{let x;return u||(x=u=e().catch(S=>{if(S=S instanceof Error?S:new Error(String(S)),l)return new Promise((T,w)=>{l(S,()=>T(g()),()=>w(S),p+1)});throw S}).then(S=>x!==u&&u?u:(S&&(S.__esModule||S[Symbol.toStringTag]==="Module")&&(S=S.default),A=S,S)))};return _t({name:"AsyncComponentWrapper",__asyncLoader:v,__asyncHydrate(x,S,T){const w=s?()=>{const R=s(T,E=>zB(x,E));R&&(S.bum||(S.bum=[])).push(R)}:T;A?w():v().then(()=>!S.isUnmounted&&w())},get __asyncResolved(){return A},setup(){const x=Fr;if(dx(x),A)return()=>M_(A,x);const S=E=>{u=null,Xd(E,x,13,!i)};if(a&&x.suspense||Of)return v().then(E=>()=>M_(E,x)).catch(E=>(S(E),()=>i?vt(i,{error:E}):null));const T=Ln(!1),w=Ln(),R=Ln(!!r);return r&&setTimeout(()=>{R.value=!1},r),o!=null&&setTimeout(()=>{if(!T.value&&!w.value){const E=new Error(`Async component timed out after ${o}ms.`);S(E),w.value=E}},o),v().then(()=>{T.value=!0,x.parent&&Qd(x.parent.vnode)&&x.parent.update()}).catch(E=>{S(E),w.value=E}),()=>{if(T.value&&A)return M_(A,x);if(w.value&&i)return vt(i,{error:w.value});if(t&&!R.value)return vt(t)}}})}function M_(n,e){const{ref:t,props:i,children:r,ce:s}=e.vnode,o=vt(n,i,r);return o.ref=t,o.ce=s,delete e.vnode.ce,o}const Qd=n=>n.type.__isKeepAlive;function HB(n,e){EM(n,"a",e)}function $B(n,e){EM(n,"da",e)}function EM(n,e,t=Fr){const i=n.__wdc||(n.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return n()});if($g(e,i,t),t){let r=t.parent;for(;r&&r.parent;)Qd(r.parent.vnode)&&WB(i,e,t,r),r=r.parent}}function WB(n,e,t,i){const r=$g(e,n,i,!0);Yd(()=>{rx(i[e],r)},t)}function $g(n,e,t=Fr,i=!1){if(t){const r=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{Gu();const a=Kd(t),l=ma(e,t,n,o);return a(),qu(),l});return i?r.unshift(s):r.push(s),s}}const Ql=n=>(e,t=Fr)=>{(!Of||n==="sp")&&$g(n,(...i)=>e(...i),t)},jB=Ql("bm"),Yl=Ql("m"),XB=Ql("bu"),QB=Ql("u"),CM=Ql("bum"),Yd=Ql("um"),YB=Ql("sp"),ZB=Ql("rtg"),KB=Ql("rtc");function JB(n,e=Fr){$g("ec",n,e)}const eF="components";function RM(n,e){return nF(eF,n,!0,e)||n}const tF=Symbol.for("v-ndc");function nF(n,e,t=!0,i=!1){const r=Ur||Fr;if(r){const s=r.type;{const a=GF(s,!1);if(a&&(a===e||a===qo(e)||a===qg(qo(e))))return s}const o=H5(r[n]||s[n],e)||H5(r.appContext[n],e);return!o&&i?s:o}}function H5(n,e){return n&&(n[e]||n[qo(e)]||n[qg(qo(e))])}function Xc(n,e,t,i){let r;const s=t,o=an(n);if(o||rr(n)){const a=o&&wf(n);let l=!1;a&&(l=!Vo(n),n=Hg(n)),r=new Array(n.length);for(let u=0,A=n.length;u<A;u++)r[u]=e(l?us(n[u]):n[u],u,void 0,s)}else if(typeof n=="number"){r=new Array(n);for(let a=0;a<n;a++)r[a]=e(a+1,a,void 0,s)}else if(Ui(n))if(n[Symbol.iterator])r=Array.from(n,(a,l)=>e(a,l,void 0,s));else{const a=Object.keys(n);r=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const A=a[l];r[l]=e(n[A],A,l,s)}}else r=[];return r}function Ti(n,e,t={},i,r){if(Ur.ce||Ur.parent&&Tf(Ur.parent)&&Ur.parent.ce)return e!=="default"&&(t.name=e),lt(),Ya(Di,null,[vt("slot",t,i&&i())],64);let s=n[e];s&&s._c&&(s._d=!1),lt();const o=s&&NM(s(t)),a=t.key||o&&o.key,l=Ya(Di,{key:(a&&!Xl(a)?a:`_${e}`)+(!o&&i?"_fb":"")},o||(i?i():[]),o&&n._===1?64:-2);return l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),s&&s._c&&(s._d=!0),l}function NM(n){return n.some(e=>ed(e)?!(e.type===Ls||e.type===Di&&!NM(e.children)):!0)?n:null}const wv=n=>n?ZM(n)?Xg(n):wv(n.parent):null,D0=kr(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>wv(n.parent),$root:n=>wv(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>LM(n),$forceUpdate:n=>n.f||(n.f=()=>{Ax(n.update)}),$nextTick:n=>n.n||(n.n=AM.bind(n.proxy)),$watch:n=>wF.bind(n)}),E_=(n,e)=>n!==xi&&!n.__isScriptSetup&&li(n,e),iF={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=n;let u;if(e[0]!=="$"){const v=o[e];if(v!==void 0)switch(v){case 1:return i[e];case 2:return r[e];case 4:return t[e];case 3:return s[e]}else{if(E_(i,e))return o[e]=1,i[e];if(r!==xi&&li(r,e))return o[e]=2,r[e];if((u=n.propsOptions[0])&&li(u,e))return o[e]=3,s[e];if(t!==xi&&li(t,e))return o[e]=4,t[e];Sv&&(o[e]=0)}}const A=D0[e];let p,g;if(A)return e==="$attrs"&&ls(n.attrs,"get",""),A(n);if((p=a.__cssModules)&&(p=p[e]))return p;if(t!==xi&&li(t,e))return o[e]=4,t[e];if(g=l.config.globalProperties,li(g,e))return g[e]},set({_:n},e,t){const{data:i,setupState:r,ctx:s}=n;return E_(r,e)?(r[e]=t,!0):i!==xi&&li(i,e)?(i[e]=t,!0):li(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!t[o]||n!==xi&&li(n,o)||E_(e,o)||(a=s[0])&&li(a,o)||li(i,o)||li(D0,o)||li(r.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:li(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function $5(n){return an(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Sv=!0;function rF(n){const e=LM(n),t=n.proxy,i=n.ctx;Sv=!1,e.beforeCreate&&W5(e.beforeCreate,n,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:u,created:A,beforeMount:p,mounted:g,beforeUpdate:v,updated:x,activated:S,deactivated:T,beforeDestroy:w,beforeUnmount:R,destroyed:E,unmounted:N,render:D,renderTracked:B,renderTriggered:I,errorCaptured:O,serverPrefetch:L,expose:F,inheritAttrs:V,components:H,directives:Q,filters:te}=e;if(u&&sF(u,i,null),o)for(const Z in o){const J=o[Z];xn(J)&&(i[Z]=J.bind(t))}if(r){const Z=r.call(t,t);Ui(Z)&&(n.data=Fu(Z))}if(Sv=!0,s)for(const Z in s){const J=s[Z],fe=xn(J)?J.bind(t,t):xn(J.get)?J.get.bind(t,t):za,ge=!xn(J)&&xn(J.set)?J.set.bind(t):za,pe=er({get:fe,set:ge});Object.defineProperty(i,Z,{enumerable:!0,configurable:!0,get:()=>pe.value,set:Ae=>pe.value=Ae})}if(a)for(const Z in a)PM(a[Z],i,t,Z);if(l){const Z=xn(l)?l.call(t):l;Reflect.ownKeys(Z).forEach(J=>{px(J,Z[J])})}A&&W5(A,n,"c");function W(Z,J){an(J)?J.forEach(fe=>Z(fe.bind(t))):J&&Z(J.bind(t))}if(W(jB,p),W(Yl,g),W(XB,v),W(QB,x),W(HB,S),W($B,T),W(JB,O),W(KB,B),W(ZB,I),W(CM,R),W(Yd,N),W(YB,L),an(F))if(F.length){const Z=n.exposed||(n.exposed={});F.forEach(J=>{Object.defineProperty(Z,J,{get:()=>t[J],set:fe=>t[J]=fe})})}else n.exposed||(n.exposed={});D&&n.render===za&&(n.render=D),V!=null&&(n.inheritAttrs=V),H&&(n.components=H),Q&&(n.directives=Q),L&&dx(n)}function sF(n,e,t=za){an(n)&&(n=Tv(n));for(const i in n){const r=n[i];let s;Ui(r)?"default"in r?s=Ef(r.from||i,r.default,!0):s=Ef(r.from||i):s=Ef(r),Wr(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[i]=s}}function W5(n,e,t){ma(an(n)?n.map(i=>i.bind(e.proxy)):n.bind(e.proxy),e,t)}function PM(n,e,t,i){let r=i.includes(".")?$M(t,i):()=>t[i];if(rr(n)){const s=e[n];xn(s)&&jr(r,s)}else if(xn(n))jr(r,n.bind(t));else if(Ui(n))if(an(n))n.forEach(s=>PM(s,e,t,i));else{const s=xn(n.handler)?n.handler.bind(t):e[n.handler];xn(s)&&jr(r,s,n)}}function LM(n){const e=n.type,{mixins:t,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!t&&!i?l=e:(l={},r.length&&r.forEach(u=>B1(l,u,o,!0)),B1(l,e,o)),Ui(e)&&s.set(e,l),l}function B1(n,e,t,i=!1){const{mixins:r,extends:s}=e;s&&B1(n,s,t,!0),r&&r.forEach(o=>B1(n,o,t,!0));for(const o in e)if(!(i&&o==="expose")){const a=oF[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const oF={data:j5,props:X5,emits:X5,methods:v0,computed:v0,beforeCreate:bs,created:bs,beforeMount:bs,mounted:bs,beforeUpdate:bs,updated:bs,beforeDestroy:bs,beforeUnmount:bs,destroyed:bs,unmounted:bs,activated:bs,deactivated:bs,errorCaptured:bs,serverPrefetch:bs,components:v0,directives:v0,watch:lF,provide:j5,inject:aF};function j5(n,e){return e?n?function(){return kr(xn(n)?n.call(this,this):n,xn(e)?e.call(this,this):e)}:e:n}function aF(n,e){return v0(Tv(n),Tv(e))}function Tv(n){if(an(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function bs(n,e){return n?[...new Set([].concat(n,e))]:e}function v0(n,e){return n?kr(Object.create(null),n,e):e}function X5(n,e){return n?an(n)&&an(e)?[...new Set([...n,...e])]:kr(Object.create(null),$5(n),$5(e??{})):e}function lF(n,e){if(!n)return e;if(!e)return n;const t=kr(Object.create(null),n);for(const i in e)t[i]=bs(n[i],e[i]);return t}function DM(){return{app:null,config:{isNativeTag:HI,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uF=0;function cF(n,e){return function(i,r=null){xn(i)||(i=kr({},i)),r!=null&&!Ui(r)&&(r=null);const s=DM(),o=new WeakSet,a=[];let l=!1;const u=s.app={_uid:uF++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:zF,get config(){return s.config},set config(A){},use(A,...p){return o.has(A)||(A&&xn(A.install)?(o.add(A),A.install(u,...p)):xn(A)&&(o.add(A),A(u,...p))),u},mixin(A){return s.mixins.includes(A)||s.mixins.push(A),u},component(A,p){return p?(s.components[A]=p,u):s.components[A]},directive(A,p){return p?(s.directives[A]=p,u):s.directives[A]},mount(A,p,g){if(!l){const v=u._ceVNode||vt(i,r);return v.appContext=s,g===!0?g="svg":g===!1&&(g=void 0),n(v,A,g),l=!0,u._container=A,A.__vue_app__=u,Xg(v.component)}},onUnmount(A){a.push(A)},unmount(){l&&(ma(a,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(A,p){return s.provides[A]=p,u},runWithContext(A){const p=Mf;Mf=u;try{return A()}finally{Mf=p}}};return u}}let Mf=null;function px(n,e){if(Fr){let t=Fr.provides;const i=Fr.parent&&Fr.parent.provides;i===t&&(t=Fr.provides=Object.create(i)),t[n]=e}}function Ef(n,e,t=!1){const i=Fr||Ur;if(i||Mf){const r=Mf?Mf._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&n in r)return r[n];if(arguments.length>1)return t&&xn(e)?e.call(i&&i.proxy):e}}const IM={},BM=()=>Object.create(IM),FM=n=>Object.getPrototypeOf(n)===IM;function hF(n,e,t,i=!1){const r={},s=BM();n.propsDefaults=Object.create(null),UM(n,e,r,s);for(const o in n.propsOptions[0])o in r||(r[o]=void 0);t?n.props=i?r:SB(r):n.type.props?n.props=r:n.props=s,n.attrs=s}function fF(n,e,t,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=n,a=Zn(r),[l]=n.propsOptions;let u=!1;if((i||o>0)&&!(o&16)){if(o&8){const A=n.vnode.dynamicProps;for(let p=0;p<A.length;p++){let g=A[p];if(Wg(n.emitsOptions,g))continue;const v=e[g];if(l)if(li(s,g))v!==s[g]&&(s[g]=v,u=!0);else{const x=qo(g);r[x]=Mv(l,a,x,v,n,!1)}else v!==s[g]&&(s[g]=v,u=!0)}}}else{UM(n,e,r,s)&&(u=!0);let A;for(const p in a)(!e||!li(e,p)&&((A=uh(p))===p||!li(e,A)))&&(l?t&&(t[p]!==void 0||t[A]!==void 0)&&(r[p]=Mv(l,a,p,void 0,n,!0)):delete r[p]);if(s!==a)for(const p in s)(!e||!li(e,p))&&(delete s[p],u=!0)}u&&Ml(n.attrs,"set","")}function UM(n,e,t,i){const[r,s]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(R0(l))continue;const u=e[l];let A;r&&li(r,A=qo(l))?!s||!s.includes(A)?t[A]=u:(a||(a={}))[A]=u:Wg(n.emitsOptions,l)||(!(l in i)||u!==i[l])&&(i[l]=u,o=!0)}if(s){const l=Zn(t),u=a||xi;for(let A=0;A<s.length;A++){const p=s[A];t[p]=Mv(r,l,p,u[p],n,!li(u,p))}}return o}function Mv(n,e,t,i,r,s){const o=n[t];if(o!=null){const a=li(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&xn(l)){const{propsDefaults:u}=r;if(t in u)i=u[t];else{const A=Kd(r);i=u[t]=l.call(null,e),A()}}else i=l;r.ce&&r.ce._setProp(t,i)}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===uh(t))&&(i=!0))}return i}const AF=new WeakMap;function OM(n,e,t=!1){const i=t?AF:e.propsCache,r=i.get(n);if(r)return r;const s=n.props,o={},a=[];let l=!1;if(!xn(n)){const A=p=>{l=!0;const[g,v]=OM(p,e,!0);kr(o,g),v&&a.push(...v)};!t&&e.mixins.length&&e.mixins.forEach(A),n.extends&&A(n.extends),n.mixins&&n.mixins.forEach(A)}if(!s&&!l)return Ui(n)&&i.set(n,xf),xf;if(an(s))for(let A=0;A<s.length;A++){const p=qo(s[A]);Q5(p)&&(o[p]=xi)}else if(s)for(const A in s){const p=qo(A);if(Q5(p)){const g=s[A],v=o[p]=an(g)||xn(g)?{type:g}:kr({},g),x=v.type;let S=!1,T=!0;if(an(x))for(let w=0;w<x.length;++w){const R=x[w],E=xn(R)&&R.name;if(E==="Boolean"){S=!0;break}else E==="String"&&(T=!1)}else S=xn(x)&&x.name==="Boolean";v[0]=S,v[1]=T,(S||li(v,"default"))&&a.push(p)}}const u=[o,a];return Ui(n)&&i.set(n,u),u}function Q5(n){return n[0]!=="$"&&!R0(n)}const kM=n=>n[0]==="_"||n==="$stable",mx=n=>an(n)?n.map(Fa):[Fa(n)],dF=(n,e,t)=>{if(e._n)return e;const i=zn((...r)=>mx(e(...r)),t);return i._c=!1,i},VM=(n,e,t)=>{const i=n._ctx;for(const r in n){if(kM(r))continue;const s=n[r];if(xn(s))e[r]=dF(r,s,i);else if(s!=null){const o=mx(s);e[r]=()=>o}}},GM=(n,e)=>{const t=mx(e);n.slots.default=()=>t},qM=(n,e,t)=>{for(const i in e)(t||i!=="_")&&(n[i]=e[i])},pF=(n,e,t)=>{const i=n.slots=BM();if(n.vnode.shapeFlag&32){const r=e._;r?(qM(i,e,t),t&&$T(i,"_",r,!0)):VM(e,i)}else e&&GM(n,e)},mF=(n,e,t)=>{const{vnode:i,slots:r}=n;let s=!0,o=xi;if(i.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:qM(r,e,t):(s=!e.$stable,VM(e,r)),o=e}else e&&(GM(n,e),o={default:1});if(s)for(const a in r)!kM(a)&&o[a]==null&&delete r[a]},Ts=NF;function gF(n){return _F(n)}function _F(n,e){const t=zg();t.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:u,setElementText:A,parentNode:p,nextSibling:g,setScopeId:v=za,insertStaticContent:x}=n,S=(ue,ce,G,Ee=null,ye=null,we=null,Se=void 0,ze=null,Ne=!!ce.dynamicChildren)=>{if(ue===ce)return;ue&&!Mc(ue,ce)&&(Ee=Xe(ue),Ae(ue,ye,we,!0),ue=null),ce.patchFlag===-2&&(Ne=!1,ce.dynamicChildren=null);const{type:j,ref:q,shapeFlag:he}=ce;switch(j){case Zd:T(ue,ce,G,Ee);break;case Ls:w(ue,ce,G,Ee);break;case o1:ue==null&&R(ce,G,Ee,Se);break;case Di:H(ue,ce,G,Ee,ye,we,Se,ze,Ne);break;default:he&1?D(ue,ce,G,Ee,ye,we,Se,ze,Ne):he&6?Q(ue,ce,G,Ee,ye,we,Se,ze,Ne):(he&64||he&128)&&j.process(ue,ce,G,Ee,ye,we,Se,ze,Ne,ut)}q!=null&&ye&&I1(q,ue&&ue.ref,we,ce||ue,!ce)},T=(ue,ce,G,Ee)=>{if(ue==null)i(ce.el=a(ce.children),G,Ee);else{const ye=ce.el=ue.el;ce.children!==ue.children&&u(ye,ce.children)}},w=(ue,ce,G,Ee)=>{ue==null?i(ce.el=l(ce.children||""),G,Ee):ce.el=ue.el},R=(ue,ce,G,Ee)=>{[ue.el,ue.anchor]=x(ue.children,ce,G,Ee,ue.el,ue.anchor)},E=({el:ue,anchor:ce},G,Ee)=>{let ye;for(;ue&&ue!==ce;)ye=g(ue),i(ue,G,Ee),ue=ye;i(ce,G,Ee)},N=({el:ue,anchor:ce})=>{let G;for(;ue&&ue!==ce;)G=g(ue),r(ue),ue=G;r(ce)},D=(ue,ce,G,Ee,ye,we,Se,ze,Ne)=>{ce.type==="svg"?Se="svg":ce.type==="math"&&(Se="mathml"),ue==null?B(ce,G,Ee,ye,we,Se,ze,Ne):L(ue,ce,ye,we,Se,ze,Ne)},B=(ue,ce,G,Ee,ye,we,Se,ze)=>{let Ne,j;const{props:q,shapeFlag:he,transition:Me,dirs:Ue}=ue;if(Ne=ue.el=o(ue.type,we,q&&q.is,q),he&8?A(Ne,ue.children):he&16&&O(ue.children,Ne,null,Ee,ye,C_(ue,we),Se,ze),Ue&&tc(ue,null,Ee,"created"),I(Ne,ue,ue.scopeId,Se,Ee),q){for(const At in q)At!=="value"&&!R0(At)&&s(Ne,At,null,q[At],we,Ee);"value"in q&&s(Ne,"value",null,q.value,we),(j=q.onVnodeBeforeMount)&&Ma(j,Ee,ue)}Ue&&tc(ue,null,Ee,"beforeMount");const Be=vF(ye,Me);Be&&Me.beforeEnter(Ne),i(Ne,ce,G),((j=q&&q.onVnodeMounted)||Be||Ue)&&Ts(()=>{j&&Ma(j,Ee,ue),Be&&Me.enter(Ne),Ue&&tc(ue,null,Ee,"mounted")},ye)},I=(ue,ce,G,Ee,ye)=>{if(G&&v(ue,G),Ee)for(let we=0;we<Ee.length;we++)v(ue,Ee[we]);if(ye){let we=ye.subTree;if(ce===we||jM(we.type)&&(we.ssContent===ce||we.ssFallback===ce)){const Se=ye.vnode;I(ue,Se,Se.scopeId,Se.slotScopeIds,ye.parent)}}},O=(ue,ce,G,Ee,ye,we,Se,ze,Ne=0)=>{for(let j=Ne;j<ue.length;j++){const q=ue[j]=ze?xu(ue[j]):Fa(ue[j]);S(null,q,ce,G,Ee,ye,we,Se,ze)}},L=(ue,ce,G,Ee,ye,we,Se)=>{const ze=ce.el=ue.el;let{patchFlag:Ne,dynamicChildren:j,dirs:q}=ce;Ne|=ue.patchFlag&16;const he=ue.props||xi,Me=ce.props||xi;let Ue;if(G&&nc(G,!1),(Ue=Me.onVnodeBeforeUpdate)&&Ma(Ue,G,ce,ue),q&&tc(ce,ue,G,"beforeUpdate"),G&&nc(G,!0),(he.innerHTML&&Me.innerHTML==null||he.textContent&&Me.textContent==null)&&A(ze,""),j?F(ue.dynamicChildren,j,ze,G,Ee,C_(ce,ye),we):Se||J(ue,ce,ze,null,G,Ee,C_(ce,ye),we,!1),Ne>0){if(Ne&16)V(ze,he,Me,G,ye);else if(Ne&2&&he.class!==Me.class&&s(ze,"class",null,Me.class,ye),Ne&4&&s(ze,"style",he.style,Me.style,ye),Ne&8){const Be=ce.dynamicProps;for(let At=0;At<Be.length;At++){const tt=Be[At],Nt=he[tt],It=Me[tt];(It!==Nt||tt==="value")&&s(ze,tt,Nt,It,ye,G)}}Ne&1&&ue.children!==ce.children&&A(ze,ce.children)}else!Se&&j==null&&V(ze,he,Me,G,ye);((Ue=Me.onVnodeUpdated)||q)&&Ts(()=>{Ue&&Ma(Ue,G,ce,ue),q&&tc(ce,ue,G,"updated")},Ee)},F=(ue,ce,G,Ee,ye,we,Se)=>{for(let ze=0;ze<ce.length;ze++){const Ne=ue[ze],j=ce[ze],q=Ne.el&&(Ne.type===Di||!Mc(Ne,j)||Ne.shapeFlag&70)?p(Ne.el):G;S(Ne,j,q,null,Ee,ye,we,Se,!0)}},V=(ue,ce,G,Ee,ye)=>{if(ce!==G){if(ce!==xi)for(const we in ce)!R0(we)&&!(we in G)&&s(ue,we,ce[we],null,ye,Ee);for(const we in G){if(R0(we))continue;const Se=G[we],ze=ce[we];Se!==ze&&we!=="value"&&s(ue,we,ze,Se,ye,Ee)}"value"in G&&s(ue,"value",ce.value,G.value,ye)}},H=(ue,ce,G,Ee,ye,we,Se,ze,Ne)=>{const j=ce.el=ue?ue.el:a(""),q=ce.anchor=ue?ue.anchor:a("");let{patchFlag:he,dynamicChildren:Me,slotScopeIds:Ue}=ce;Ue&&(ze=ze?ze.concat(Ue):Ue),ue==null?(i(j,G,Ee),i(q,G,Ee),O(ce.children||[],G,q,ye,we,Se,ze,Ne)):he>0&&he&64&&Me&&ue.dynamicChildren?(F(ue.dynamicChildren,Me,G,ye,we,Se,ze),(ce.key!=null||ye&&ce===ye.subTree)&&gx(ue,ce,!0)):J(ue,ce,G,q,ye,we,Se,ze,Ne)},Q=(ue,ce,G,Ee,ye,we,Se,ze,Ne)=>{ce.slotScopeIds=ze,ue==null?ce.shapeFlag&512?ye.ctx.activate(ce,G,Ee,Se,Ne):te(ce,G,Ee,ye,we,Se,Ne):K(ue,ce,Ne)},te=(ue,ce,G,Ee,ye,we,Se)=>{const ze=ue.component=FF(ue,Ee,ye);if(Qd(ue)&&(ze.ctx.renderer=ut),UF(ze,!1,Se),ze.asyncDep){if(ye&&ye.registerDep(ze,W,Se),!ue.el){const Ne=ze.subTree=vt(Ls);w(null,Ne,ce,G)}}else W(ze,ue,ce,G,ye,we,Se)},K=(ue,ce,G)=>{const Ee=ce.component=ue.component;if(CF(ue,ce,G))if(Ee.asyncDep&&!Ee.asyncResolved){Z(Ee,ce,G);return}else Ee.next=ce,Ee.update();else ce.el=ue.el,Ee.vnode=ce},W=(ue,ce,G,Ee,ye,we,Se)=>{const ze=()=>{if(ue.isMounted){let{next:he,bu:Me,u:Ue,parent:Be,vnode:At}=ue;{const bt=zM(ue);if(bt){he&&(he.el=At.el,Z(ue,he,Se)),bt.asyncDep.then(()=>{ue.isUnmounted||ze()});return}}let tt=he,Nt;nc(ue,!1),he?(he.el=At.el,Z(ue,he,Se)):he=At,Me&&v_(Me),(Nt=he.props&&he.props.onVnodeBeforeUpdate)&&Ma(Nt,Be,he,At),nc(ue,!0);const It=Z5(ue),st=ue.subTree;ue.subTree=It,S(st,It,p(st.el),Xe(st),ue,ye,we),he.el=It.el,tt===null&&RF(ue,It.el),Ue&&Ts(Ue,ye),(Nt=he.props&&he.props.onVnodeUpdated)&&Ts(()=>Ma(Nt,Be,he,At),ye)}else{let he;const{el:Me,props:Ue}=ce,{bm:Be,m:At,parent:tt,root:Nt,type:It}=ue,st=Tf(ce);nc(ue,!1),Be&&v_(Be),!st&&(he=Ue&&Ue.onVnodeBeforeMount)&&Ma(he,tt,ce),nc(ue,!0);{Nt.ce&&Nt.ce._injectChildStyle(It);const bt=ue.subTree=Z5(ue);S(null,bt,G,Ee,ue,ye,we),ce.el=bt.el}if(At&&Ts(At,ye),!st&&(he=Ue&&Ue.onVnodeMounted)){const bt=ce;Ts(()=>Ma(he,tt,bt),ye)}(ce.shapeFlag&256||tt&&Tf(tt.vnode)&&tt.vnode.shapeFlag&256)&&ue.a&&Ts(ue.a,ye),ue.isMounted=!0,ce=G=Ee=null}};ue.scope.on();const Ne=ue.effect=new YT(ze);ue.scope.off();const j=ue.update=Ne.run.bind(Ne),q=ue.job=Ne.runIfDirty.bind(Ne);q.i=ue,q.id=ue.uid,Ne.scheduler=()=>Ax(q),nc(ue,!0),j()},Z=(ue,ce,G)=>{ce.component=ue;const Ee=ue.vnode.props;ue.vnode=ce,ue.next=null,fF(ue,ce.props,Ee,G),mF(ue,ce.children,G),Gu(),O5(ue),qu()},J=(ue,ce,G,Ee,ye,we,Se,ze,Ne=!1)=>{const j=ue&&ue.children,q=ue?ue.shapeFlag:0,he=ce.children,{patchFlag:Me,shapeFlag:Ue}=ce;if(Me>0){if(Me&128){ge(j,he,G,Ee,ye,we,Se,ze,Ne);return}else if(Me&256){fe(j,he,G,Ee,ye,we,Se,ze,Ne);return}}Ue&8?(q&16&&Ye(j,ye,we),he!==j&&A(G,he)):q&16?Ue&16?ge(j,he,G,Ee,ye,we,Se,ze,Ne):Ye(j,ye,we,!0):(q&8&&A(G,""),Ue&16&&O(he,G,Ee,ye,we,Se,ze,Ne))},fe=(ue,ce,G,Ee,ye,we,Se,ze,Ne)=>{ue=ue||xf,ce=ce||xf;const j=ue.length,q=ce.length,he=Math.min(j,q);let Me;for(Me=0;Me<he;Me++){const Ue=ce[Me]=Ne?xu(ce[Me]):Fa(ce[Me]);S(ue[Me],Ue,G,null,ye,we,Se,ze,Ne)}j>q?Ye(ue,ye,we,!0,!1,he):O(ce,G,Ee,ye,we,Se,ze,Ne,he)},ge=(ue,ce,G,Ee,ye,we,Se,ze,Ne)=>{let j=0;const q=ce.length;let he=ue.length-1,Me=q-1;for(;j<=he&&j<=Me;){const Ue=ue[j],Be=ce[j]=Ne?xu(ce[j]):Fa(ce[j]);if(Mc(Ue,Be))S(Ue,Be,G,null,ye,we,Se,ze,Ne);else break;j++}for(;j<=he&&j<=Me;){const Ue=ue[he],Be=ce[Me]=Ne?xu(ce[Me]):Fa(ce[Me]);if(Mc(Ue,Be))S(Ue,Be,G,null,ye,we,Se,ze,Ne);else break;he--,Me--}if(j>he){if(j<=Me){const Ue=Me+1,Be=Ue<q?ce[Ue].el:Ee;for(;j<=Me;)S(null,ce[j]=Ne?xu(ce[j]):Fa(ce[j]),G,Be,ye,we,Se,ze,Ne),j++}}else if(j>Me)for(;j<=he;)Ae(ue[j],ye,we,!0),j++;else{const Ue=j,Be=j,At=new Map;for(j=Be;j<=Me;j++){const wt=ce[j]=Ne?xu(ce[j]):Fa(ce[j]);wt.key!=null&&At.set(wt.key,j)}let tt,Nt=0;const It=Me-Be+1;let st=!1,bt=0;const Gt=new Array(It);for(j=0;j<It;j++)Gt[j]=0;for(j=Ue;j<=he;j++){const wt=ue[j];if(Nt>=It){Ae(wt,ye,we,!0);continue}let tn;if(wt.key!=null)tn=At.get(wt.key);else for(tt=Be;tt<=Me;tt++)if(Gt[tt-Be]===0&&Mc(wt,ce[tt])){tn=tt;break}tn===void 0?Ae(wt,ye,we,!0):(Gt[tn-Be]=j+1,tn>=bt?bt=tn:st=!0,S(wt,ce[tn],G,null,ye,we,Se,ze,Ne),Nt++)}const Zt=st?yF(Gt):xf;for(tt=Zt.length-1,j=It-1;j>=0;j--){const wt=Be+j,tn=ce[wt],Ot=wt+1<q?ce[wt+1].el:Ee;Gt[j]===0?S(null,tn,G,Ot,ye,we,Se,ze,Ne):st&&(tt<0||j!==Zt[tt]?pe(tn,G,Ot,2):tt--)}}},pe=(ue,ce,G,Ee,ye=null)=>{const{el:we,type:Se,transition:ze,children:Ne,shapeFlag:j}=ue;if(j&6){pe(ue.component.subTree,ce,G,Ee);return}if(j&128){ue.suspense.move(ce,G,Ee);return}if(j&64){Se.move(ue,ce,G,ut);return}if(Se===Di){i(we,ce,G);for(let he=0;he<Ne.length;he++)pe(Ne[he],ce,G,Ee);i(ue.anchor,ce,G);return}if(Se===o1){E(ue,ce,G);return}if(Ee!==2&&j&1&&ze)if(Ee===0)ze.beforeEnter(we),i(we,ce,G),Ts(()=>ze.enter(we),ye);else{const{leave:he,delayLeave:Me,afterLeave:Ue}=ze,Be=()=>i(we,ce,G),At=()=>{he(we,()=>{Be(),Ue&&Ue()})};Me?Me(we,Be,At):At()}else i(we,ce,G)},Ae=(ue,ce,G,Ee=!1,ye=!1)=>{const{type:we,props:Se,ref:ze,children:Ne,dynamicChildren:j,shapeFlag:q,patchFlag:he,dirs:Me,cacheIndex:Ue}=ue;if(he===-2&&(ye=!1),ze!=null&&I1(ze,null,G,ue,!0),Ue!=null&&(ce.renderCache[Ue]=void 0),q&256){ce.ctx.deactivate(ue);return}const Be=q&1&&Me,At=!Tf(ue);let tt;if(At&&(tt=Se&&Se.onVnodeBeforeUnmount)&&Ma(tt,ce,ue),q&6)Ve(ue.component,G,Ee);else{if(q&128){ue.suspense.unmount(G,Ee);return}Be&&tc(ue,null,ce,"beforeUnmount"),q&64?ue.type.remove(ue,ce,G,ut,Ee):j&&!j.hasOnce&&(we!==Di||he>0&&he&64)?Ye(j,ce,G,!1,!0):(we===Di&&he&384||!ye&&q&16)&&Ye(Ne,ce,G),Ee&&Fe(ue)}(At&&(tt=Se&&Se.onVnodeUnmounted)||Be)&&Ts(()=>{tt&&Ma(tt,ce,ue),Be&&tc(ue,null,ce,"unmounted")},G)},Fe=ue=>{const{type:ce,el:G,anchor:Ee,transition:ye}=ue;if(ce===Di){be(G,Ee);return}if(ce===o1){N(ue);return}const we=()=>{r(G),ye&&!ye.persisted&&ye.afterLeave&&ye.afterLeave()};if(ue.shapeFlag&1&&ye&&!ye.persisted){const{leave:Se,delayLeave:ze}=ye,Ne=()=>Se(G,we);ze?ze(ue.el,we,Ne):Ne()}else we()},be=(ue,ce)=>{let G;for(;ue!==ce;)G=g(ue),r(ue),ue=G;r(ce)},Ve=(ue,ce,G)=>{const{bum:Ee,scope:ye,job:we,subTree:Se,um:ze,m:Ne,a:j}=ue;Y5(Ne),Y5(j),Ee&&v_(Ee),ye.stop(),we&&(we.flags|=8,Ae(Se,ue,ce,G)),ze&&Ts(ze,ce),Ts(()=>{ue.isUnmounted=!0},ce),ce&&ce.pendingBranch&&!ce.isUnmounted&&ue.asyncDep&&!ue.asyncResolved&&ue.suspenseId===ce.pendingId&&(ce.deps--,ce.deps===0&&ce.resolve())},Ye=(ue,ce,G,Ee=!1,ye=!1,we=0)=>{for(let Se=we;Se<ue.length;Se++)Ae(ue[Se],ce,G,Ee,ye)},Xe=ue=>{if(ue.shapeFlag&6)return Xe(ue.component.subTree);if(ue.shapeFlag&128)return ue.suspense.next();const ce=g(ue.anchor||ue.el),G=ce&&ce[_M];return G?g(G):ce};let Tt=!1;const yt=(ue,ce,G)=>{ue==null?ce._vnode&&Ae(ce._vnode,null,null,!0):S(ce._vnode||null,ue,ce,null,null,null,G),ce._vnode=ue,Tt||(Tt=!0,O5(),pM(),Tt=!1)},ut={p:S,um:Ae,m:pe,r:Fe,mt:te,mc:O,pc:J,pbc:F,n:Xe,o:n};return{render:yt,hydrate:void 0,createApp:cF(yt)}}function C_({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function nc({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function vF(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function gx(n,e,t=!1){const i=n.children,r=e.children;if(an(i)&&an(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=xu(r[s]),a.el=o.el),!t&&a.patchFlag!==-2&&gx(o,a)),a.type===Zd&&(a.el=o.el)}}function yF(n){const e=n.slice(),t=[0];let i,r,s,o,a;const l=n.length;for(i=0;i<l;i++){const u=n[i];if(u!==0){if(r=t[t.length-1],n[r]<u){e[i]=r,t.push(i);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,n[t[a]]<u?s=a+1:o=a;u<n[t[s]]&&(s>0&&(e[i]=t[s-1]),t[s]=i)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function zM(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:zM(e)}function Y5(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const xF=Symbol.for("v-scx"),bF=()=>Ef(xF);function jr(n,e,t){return HM(n,e,t)}function HM(n,e,t=xi){const{immediate:i,deep:r,flush:s,once:o}=t,a=kr({},t),l=e&&i||!e&&s!=="post";let u;if(Of){if(s==="sync"){const v=bF();u=v.__watcherHandles||(v.__watcherHandles=[])}else if(!l){const v=()=>{};return v.stop=za,v.resume=za,v.pause=za,v}}const A=Fr;a.call=(v,x,S)=>ma(v,A,x,S);let p=!1;s==="post"?a.scheduler=v=>{Ts(v,A&&A.suspense)}:s!=="sync"&&(p=!0,a.scheduler=(v,x)=>{x?v():Ax(v)}),a.augmentJob=v=>{e&&(v.flags|=4),p&&(v.flags|=2,A&&(v.id=A.uid,v.i=A))};const g=IB(n,e,a);return Of&&(u?u.push(g):l&&g()),g}function wF(n,e,t){const i=this.proxy,r=rr(n)?n.includes(".")?$M(i,n):()=>i[n]:n.bind(i,i);let s;xn(e)?s=e:(s=e.handler,t=e);const o=Kd(this),a=HM(r,s.bind(i),t);return o(),a}function $M(n,e){const t=e.split(".");return()=>{let i=n;for(let r=0;r<t.length&&i;r++)i=i[t[r]];return i}}const SF=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${qo(e)}Modifiers`]||n[`${uh(e)}Modifiers`];function TF(n,e,...t){if(n.isUnmounted)return;const i=n.vnode.props||xi;let r=t;const s=e.startsWith("update:"),o=s&&SF(i,e.slice(7));o&&(o.trim&&(r=t.map(A=>rr(A)?A.trim():A)),o.number&&(r=t.map(QI)));let a,l=i[a=__(e)]||i[a=__(qo(e))];!l&&s&&(l=i[a=__(uh(e))]),l&&ma(l,n,6,r);const u=i[a+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,ma(u,n,6,r)}}function WM(n,e,t=!1){const i=e.emitsCache,r=i.get(n);if(r!==void 0)return r;const s=n.emits;let o={},a=!1;if(!xn(n)){const l=u=>{const A=WM(u,e,!0);A&&(a=!0,kr(o,A))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!s&&!a?(Ui(n)&&i.set(n,null),null):(an(s)?s.forEach(l=>o[l]=null):kr(o,s),Ui(n)&&i.set(n,o),o)}function Wg(n,e){return!n||!kg(e)?!1:(e=e.slice(2).replace(/Once$/,""),li(n,e[0].toLowerCase()+e.slice(1))||li(n,uh(e))||li(n,e))}function Z5(n){const{type:e,vnode:t,proxy:i,withProxy:r,propsOptions:[s],slots:o,attrs:a,emit:l,render:u,renderCache:A,props:p,data:g,setupState:v,ctx:x,inheritAttrs:S}=n,T=D1(n);let w,R;try{if(t.shapeFlag&4){const N=r||i,D=N;w=Fa(u.call(D,N,A,p,v,g,x)),R=a}else{const N=e;w=Fa(N.length>1?N(p,{attrs:a,slots:o,emit:l}):N(p,null)),R=e.props?a:MF(a)}}catch(N){I0.length=0,Xd(N,n,1),w=vt(Ls)}let E=w;if(R&&S!==!1){const N=Object.keys(R),{shapeFlag:D}=E;N.length&&D&7&&(s&&N.some(ix)&&(R=EF(R,s)),E=Uu(E,R,!1,!0))}return t.dirs&&(E=Uu(E,null,!1,!0),E.dirs=E.dirs?E.dirs.concat(t.dirs):t.dirs),t.transition&&K0(E,t.transition),w=E,D1(T),w}const MF=n=>{let e;for(const t in n)(t==="class"||t==="style"||kg(t))&&((e||(e={}))[t]=n[t]);return e},EF=(n,e)=>{const t={};for(const i in n)(!ix(i)||!(i.slice(9)in e))&&(t[i]=n[i]);return t};function CF(n,e,t){const{props:i,children:r,component:s}=n,{props:o,children:a,patchFlag:l}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return i?K5(i,o,u):!!o;if(l&8){const A=e.dynamicProps;for(let p=0;p<A.length;p++){const g=A[p];if(o[g]!==i[g]&&!Wg(u,g))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?K5(i,o,u):!0:!!o;return!1}function K5(n,e,t){const i=Object.keys(e);if(i.length!==Object.keys(n).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==n[s]&&!Wg(t,s))return!0}return!1}function RF({vnode:n,parent:e},t){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===n&&(i.el=n.el),i===n)(n=e.vnode).el=t,e=e.parent;else break}}const jM=n=>n.__isSuspense;function NF(n,e){e&&e.pendingBranch?an(n)?e.effects.push(...n):e.effects.push(n):UB(n)}const Di=Symbol.for("v-fgt"),Zd=Symbol.for("v-txt"),Ls=Symbol.for("v-cmt"),o1=Symbol.for("v-stc"),I0=[];let _o=null;function lt(n=!1){I0.push(_o=n?null:[])}function PF(){I0.pop(),_o=I0[I0.length-1]||null}let J0=1;function J5(n,e=!1){J0+=n,n<0&&_o&&e&&(_o.hasOnce=!0)}function XM(n){return n.dynamicChildren=J0>0?_o||xf:null,PF(),J0>0&&_o&&_o.push(n),n}function pt(n,e,t,i,r,s){return XM(ae(n,e,t,i,r,s,!0))}function Ya(n,e,t,i,r){return XM(vt(n,e,t,i,r,!0))}function ed(n){return n?n.__v_isVNode===!0:!1}function Mc(n,e){return n.type===e.type&&n.key===e.key}const QM=({key:n})=>n??null,a1=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?rr(n)||Wr(n)||xn(n)?{i:Ur,r:n,k:e,f:!!t}:n:null);function ae(n,e=null,t=null,i=0,r=null,s=n===Di?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&QM(e),ref:e&&a1(e),scopeId:gM,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Ur};return a?(_x(l,t),s&128&&n.normalize(l)):t&&(l.shapeFlag|=rr(t)?8:16),J0>0&&!o&&_o&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&_o.push(l),l}const vt=LF;function LF(n,e=null,t=null,i=0,r=null,s=!1){if((!n||n===tF)&&(n=Ls),ed(n)){const a=Uu(n,e,!0);return t&&_x(a,t),J0>0&&!s&&_o&&(a.shapeFlag&6?_o[_o.indexOf(n)]=a:_o.push(a)),a.patchFlag=-2,a}if(qF(n)&&(n=n.__vccOpts),e){e=DF(e);let{class:a,style:l}=e;a&&!rr(a)&&(e.class=On(a)),Ui(l)&&(fx(l)&&!an(l)&&(l=kr({},l)),e.style=pa(l))}const o=rr(n)?1:jM(n)?128:vM(n)?64:Ui(n)?4:xn(n)?2:0;return ae(n,e,t,i,r,o,s,!0)}function DF(n){return n?fx(n)||FM(n)?kr({},n):n:null}function Uu(n,e,t=!1,i=!1){const{props:r,ref:s,patchFlag:o,children:a,transition:l}=n,u=e?l1(r||{},e):r,A={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&QM(u),ref:e&&e.ref?t&&s?an(s)?s.concat(a1(e)):[s,a1(e)]:a1(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Di?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Uu(n.ssContent),ssFallback:n.ssFallback&&Uu(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&i&&K0(A,l.clone(A)),A}function Es(n=" ",e=0){return vt(Zd,null,n,e)}function jg(n,e){const t=vt(o1,null,n);return t.staticCount=e,t}function Ji(n="",e=!1){return e?(lt(),Ya(Ls,null,n)):vt(Ls,null,n)}function Fa(n){return n==null||typeof n=="boolean"?vt(Ls):an(n)?vt(Di,null,n.slice()):ed(n)?xu(n):vt(Zd,null,String(n))}function xu(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Uu(n)}function _x(n,e){let t=0;const{shapeFlag:i}=n;if(e==null)e=null;else if(an(e))t=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),_x(n,r()),r._c&&(r._d=!0));return}else{t=32;const r=e._;!r&&!FM(e)?e._ctx=Ur:r===3&&Ur&&(Ur.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else xn(e)?(e={default:e,_ctx:Ur},t=32):(e=String(e),i&64?(t=16,e=[Es(e)]):t=8);n.children=e,n.shapeFlag|=t}function l1(...n){const e={};for(let t=0;t<n.length;t++){const i=n[t];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=On([e.class,i.class]));else if(r==="style")e.style=pa([e.style,i.style]);else if(kg(r)){const s=e[r],o=i[r];o&&s!==o&&!(an(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function Ma(n,e,t,i=null){ma(n,e,7,[t,i])}const IF=DM();let BF=0;function FF(n,e,t){const i=n.type,r=(e?e.appContext:n.appContext)||IF,s={uid:BF++,vnode:n,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new iB(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:OM(i,r),emitsOptions:WM(i,r),emit:null,emitted:null,propsDefaults:xi,inheritAttrs:i.inheritAttrs,ctx:xi,data:xi,props:xi,attrs:xi,slots:xi,refs:xi,setupState:xi,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=TF.bind(null,s),n.ce&&n.ce(s),s}let Fr=null;const YM=()=>Fr||Ur;let F1,Ev;{const n=zg(),e=(t,i)=>{let r;return(r=n[t])||(r=n[t]=[]),r.push(i),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};F1=e("__VUE_INSTANCE_SETTERS__",t=>Fr=t),Ev=e("__VUE_SSR_SETTERS__",t=>Of=t)}const Kd=n=>{const e=Fr;return F1(n),n.scope.on(),()=>{n.scope.off(),F1(e)}},e8=()=>{Fr&&Fr.scope.off(),F1(null)};function ZM(n){return n.vnode.shapeFlag&4}let Of=!1;function UF(n,e=!1,t=!1){e&&Ev(e);const{props:i,children:r}=n.vnode,s=ZM(n);hF(n,i,s,e),pF(n,r,t);const o=s?OF(n,e):void 0;return e&&Ev(!1),o}function OF(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,iF);const{setup:i}=t;if(i){Gu();const r=n.setupContext=i.length>1?VF(n):null,s=Kd(n),o=jd(i,n,0,[n.props,r]),a=qT(o);if(qu(),s(),(a||n.sp)&&!Tf(n)&&dx(n),a){if(o.then(e8,e8),e)return o.then(l=>{t8(n,l)}).catch(l=>{Xd(l,n,0)});n.asyncDep=o}else t8(n,o)}else KM(n)}function t8(n,e,t){xn(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Ui(e)&&(n.setupState=hM(e)),KM(n)}function KM(n,e,t){const i=n.type;n.render||(n.render=i.render||za);{const r=Kd(n);Gu();try{rF(n)}finally{qu(),r()}}}const kF={get(n,e){return ls(n,"get",""),n[e]}};function VF(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,kF),slots:n.slots,emit:n.emit,expose:e}}function Xg(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(hM(TB(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in D0)return D0[t](n)},has(e,t){return t in e||t in D0}})):n.proxy}function GF(n,e=!0){return xn(n)?n.displayName||n.name:n.name||e&&n.__name}function qF(n){return xn(n)&&"__vccOpts"in n}const er=(n,e)=>LB(n,e,Of);function Ua(n,e,t){const i=arguments.length;return i===2?Ui(e)&&!an(e)?ed(e)?vt(n,null,[e]):vt(n,e):vt(n,null,e):(i>3?t=Array.prototype.slice.call(arguments,2):i===3&&ed(t)&&(t=[t]),vt(n,e,t))}const zF="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Cv;const n8=typeof window<"u"&&window.trustedTypes;if(n8)try{Cv=n8.createPolicy("vue",{createHTML:n=>n})}catch{}const JM=Cv?n=>Cv.createHTML(n):n=>n,HF="http://www.w3.org/2000/svg",$F="http://www.w3.org/1998/Math/MathML",yl=typeof document<"u"?document:null,i8=yl&&yl.createElement("template"),WF={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,i)=>{const r=e==="svg"?yl.createElementNS(HF,n):e==="mathml"?yl.createElementNS($F,n):t?yl.createElement(n,{is:t}):yl.createElement(n);return n==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:n=>yl.createTextNode(n),createComment:n=>yl.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>yl.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,i,r,s){const o=t?t.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),t),!(r===s||!(r=r.nextSibling)););else{i8.innerHTML=JM(i==="svg"?`<svg>${n}</svg>`:i==="mathml"?`<math>${n}</math>`:n);const a=i8.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},su="transition",VA="animation",td=Symbol("_vtc"),e7={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},jF=kr({},bM,e7),XF=n=>(n.displayName="Transition",n.props=jF,n),U1=XF((n,{slots:e})=>Ua(qB,QF(n),e)),ic=(n,e=[])=>{an(n)?n.forEach(t=>t(...e)):n&&n(...e)},r8=n=>n?an(n)?n.some(e=>e.length>1):n.length>1:!1;function QF(n){const e={};for(const H in n)H in e7||(e[H]=n[H]);if(n.css===!1)return e;const{name:t="v",type:i,duration:r,enterFromClass:s=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:u=o,appearToClass:A=a,leaveFromClass:p=`${t}-leave-from`,leaveActiveClass:g=`${t}-leave-active`,leaveToClass:v=`${t}-leave-to`}=n,x=YF(r),S=x&&x[0],T=x&&x[1],{onBeforeEnter:w,onEnter:R,onEnterCancelled:E,onLeave:N,onLeaveCancelled:D,onBeforeAppear:B=w,onAppear:I=R,onAppearCancelled:O=E}=e,L=(H,Q,te,K)=>{H._enterCancelled=K,rc(H,Q?A:a),rc(H,Q?u:o),te&&te()},F=(H,Q)=>{H._isLeaving=!1,rc(H,p),rc(H,v),rc(H,g),Q&&Q()},V=H=>(Q,te)=>{const K=H?I:R,W=()=>L(Q,H,te);ic(K,[Q,W]),s8(()=>{rc(Q,H?l:s),Al(Q,H?A:a),r8(K)||o8(Q,i,S,W)})};return kr(e,{onBeforeEnter(H){ic(w,[H]),Al(H,s),Al(H,o)},onBeforeAppear(H){ic(B,[H]),Al(H,l),Al(H,u)},onEnter:V(!1),onAppear:V(!0),onLeave(H,Q){H._isLeaving=!0;const te=()=>F(H,Q);Al(H,p),H._enterCancelled?(Al(H,g),u8()):(u8(),Al(H,g)),s8(()=>{H._isLeaving&&(rc(H,p),Al(H,v),r8(N)||o8(H,i,T,te))}),ic(N,[H,te])},onEnterCancelled(H){L(H,!1,void 0,!0),ic(E,[H])},onAppearCancelled(H){L(H,!0,void 0,!0),ic(O,[H])},onLeaveCancelled(H){F(H),ic(D,[H])}})}function YF(n){if(n==null)return null;if(Ui(n))return[R_(n.enter),R_(n.leave)];{const e=R_(n);return[e,e]}}function R_(n){return YI(n)}function Al(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[td]||(n[td]=new Set)).add(e)}function rc(n,e){e.split(/\s+/).forEach(i=>i&&n.classList.remove(i));const t=n[td];t&&(t.delete(e),t.size||(n[td]=void 0))}function s8(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let ZF=0;function o8(n,e,t,i){const r=n._endId=++ZF,s=()=>{r===n._endId&&i()};if(t!=null)return setTimeout(s,t);const{type:o,timeout:a,propCount:l}=KF(n,e);if(!o)return i();const u=o+"end";let A=0;const p=()=>{n.removeEventListener(u,g),s()},g=v=>{v.target===n&&++A>=l&&p()};setTimeout(()=>{A<l&&p()},a+1),n.addEventListener(u,g)}function KF(n,e){const t=window.getComputedStyle(n),i=x=>(t[x]||"").split(", "),r=i(`${su}Delay`),s=i(`${su}Duration`),o=a8(r,s),a=i(`${VA}Delay`),l=i(`${VA}Duration`),u=a8(a,l);let A=null,p=0,g=0;e===su?o>0&&(A=su,p=o,g=s.length):e===VA?u>0&&(A=VA,p=u,g=l.length):(p=Math.max(o,u),A=p>0?o>u?su:VA:null,g=A?A===su?s.length:l.length:0);const v=A===su&&/\b(transform|all)(,|$)/.test(i(`${su}Property`).toString());return{type:A,timeout:p,propCount:g,hasTransform:v}}function a8(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,i)=>l8(t)+l8(n[i])))}function l8(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function u8(){return document.body.offsetHeight}function JF(n,e,t){const i=n[td];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const O1=Symbol("_vod"),t7=Symbol("_vsh"),Rv={beforeMount(n,{value:e},{transition:t}){n[O1]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):GA(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:i}){!e!=!t&&(i?e?(i.beforeEnter(n),GA(n,!0),i.enter(n)):i.leave(n,()=>{GA(n,!1)}):GA(n,e))},beforeUnmount(n,{value:e}){GA(n,e)}};function GA(n,e){n.style.display=e?n[O1]:"none",n[t7]=!e}const eU=Symbol(""),tU=/(^|;)\s*display\s*:/;function nU(n,e,t){const i=n.style,r=rr(t);let s=!1;if(t&&!r){if(e)if(rr(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&u1(i,a,"")}else for(const o in e)t[o]==null&&u1(i,o,"");for(const o in t)o==="display"&&(s=!0),u1(i,o,t[o])}else if(r){if(e!==t){const o=i[eU];o&&(t+=";"+o),i.cssText=t,s=tU.test(t)}}else e&&n.removeAttribute("style");O1 in n&&(n[O1]=s?i.display:"",n[t7]&&(i.display="none"))}const c8=/\s*!important$/;function u1(n,e,t){if(an(t))t.forEach(i=>u1(n,e,i));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const i=iU(n,e);c8.test(t)?n.setProperty(uh(i),t.replace(c8,""),"important"):n[i]=t}}const h8=["Webkit","Moz","ms"],N_={};function iU(n,e){const t=N_[e];if(t)return t;let i=qo(e);if(i!=="filter"&&i in n)return N_[e]=i;i=qg(i);for(let r=0;r<h8.length;r++){const s=h8[r]+i;if(s in n)return N_[e]=s}return e}const f8="http://www.w3.org/1999/xlink";function A8(n,e,t,i,r,s=nB(e)){i&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(f8,e.slice(6,e.length)):n.setAttributeNS(f8,e,t):t==null||s&&!WT(t)?n.removeAttribute(e):n.setAttribute(e,s?"":Xl(t)?String(t):t)}function d8(n,e,t,i,r){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?JM(t):t);return}const s=n.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const a=s==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=WT(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(r||e)}function rU(n,e,t,i){n.addEventListener(e,t,i)}function sU(n,e,t,i){n.removeEventListener(e,t,i)}const p8=Symbol("_vei");function oU(n,e,t,i,r=null){const s=n[p8]||(n[p8]={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=aU(e);if(i){const u=s[e]=cU(i,r);rU(n,a,u,l)}else o&&(sU(n,a,o,l),s[e]=void 0)}}const m8=/(?:Once|Passive|Capture)$/;function aU(n){let e;if(m8.test(n)){e={};let i;for(;i=n.match(m8);)n=n.slice(0,n.length-i[0].length),e[i[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):uh(n.slice(2)),e]}let P_=0;const lU=Promise.resolve(),uU=()=>P_||(lU.then(()=>P_=0),P_=Date.now());function cU(n,e){const t=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=t.attached)return;ma(hU(i,t.value),e,5,[i])};return t.value=n,t.attached=uU(),t}function hU(n,e){if(an(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const g8=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,fU=(n,e,t,i,r,s)=>{const o=r==="svg";e==="class"?JF(n,i,o):e==="style"?nU(n,t,i):kg(e)?ix(e)||oU(n,e,t,i,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):AU(n,e,i,o))?(d8(n,e,i),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&A8(n,e,i,o,s,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!rr(i))?d8(n,qo(e),i,s,e):(e==="true-value"?n._trueValue=i:e==="false-value"&&(n._falseValue=i),A8(n,e,i,o))};function AU(n,e,t,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in n&&g8(e)&&xn(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=n.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return g8(e)&&rr(t)?!1:e in n}const dU=["ctrl","shift","alt","meta"],pU={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>dU.some(t=>n[`${t}Key`]&&!e.includes(t))},n7=(n,e)=>{const t=n._withMods||(n._withMods={}),i=e.join(".");return t[i]||(t[i]=(r,...s)=>{for(let o=0;o<e.length;o++){const a=pU[e[o]];if(a&&a(r,e))return}return n(r,...s)})},mU=kr({patchProp:fU},WF);let _8;function gU(){return _8||(_8=gF(mU))}const _U=(...n)=>{const e=gU().createApp(...n),{mount:t}=e;return e.mount=i=>{const r=yU(i);if(!r)return;const s=e._component;!xn(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=t(r,!1,vU(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function vU(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function yU(n){return rr(n)?document.querySelector(n):n}const xU="modulepreload",bU=function(n){return"https://nmdap.udn.com.tw/test/newspaceera/"+n},v8={},L_=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let o=function(u){return Promise.all(u.map(A=>Promise.resolve(A).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=o(t.map(u=>{if(u=bU(u),u in v8)return;v8[u]=!0;const A=u.endsWith(".css"),p=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const g=document.createElement("link");if(g.rel=A?"stylesheet":xU,A||(g.as="script"),g.crossOrigin="",g.href=u,l&&g.setAttribute("nonce",l),document.head.appendChild(g),A)return new Promise((v,x)=>{g.addEventListener("load",v),g.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var y8;const i7=typeof window<"u",wU=n=>typeof n=="string",B0=()=>{};i7&&((y8=window==null?void 0:window.navigator)!=null&&y8.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function r7(n,e){function t(...i){n(()=>e.apply(this,i),{fn:e,thisArg:this,args:i})}return t}function SU(n,e={}){let t,i;return s=>{const o=Ke(n),a=Ke(e.maxWait);if(t&&clearTimeout(t),o<=0||a!==void 0&&a<=0)return i&&(clearTimeout(i),i=null),s();a&&!i&&(i=setTimeout(()=>{t&&clearTimeout(t),i=null,s()},a)),t=setTimeout(()=>{i&&clearTimeout(i),i=null,s()},o)}}function TU(n,e=!0,t=!0){let i=0,r,s=!0;const o=()=>{r&&(clearTimeout(r),r=void 0)};return l=>{const u=Ke(n),A=Date.now()-i;if(o(),u<=0)return i=Date.now(),l();A>u&&(t||!s)?(i=Date.now(),l()):e&&(r=setTimeout(()=>{i=Date.now(),s=!0,o(),l()},u)),!t&&!r&&(r=setTimeout(()=>s=!0,u)),s=!1}}function s7(n){return QT()?(rB(n),!0):!1}function MU(n,e=200,t={}){return r7(SU(e,t),n)}function EU(n,e=200,t=!0,i=!0){return r7(TU(e,t,i),n)}function o7(n,e=!0){YM()?Yl(n):e?n():AM(n)}function k1(n){var e;const t=Ke(n);return(e=t==null?void 0:t.$el)!=null?e:t}const vx=i7?window:void 0;function kf(...n){let e,t,i,r;if(wU(n[0])?([t,i,r]=n,e=vx):[e,t,i,r]=n,!e)return B0;let s=B0;const o=jr(()=>k1(e),l=>{s(),l&&(l.addEventListener(t,i,r),s=()=>{l.removeEventListener(t,i,r),s=B0})},{immediate:!0,flush:"post"}),a=()=>{o(),s()};return s7(a),a}const x8=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},b8="__vueuse_ssr_handlers__";x8[b8]=x8[b8]||{};var w8=Object.getOwnPropertySymbols,CU=Object.prototype.hasOwnProperty,RU=Object.prototype.propertyIsEnumerable,NU=(n,e)=>{var t={};for(var i in n)CU.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&w8)for(var i of w8(n))e.indexOf(i)<0&&RU.call(n,i)&&(t[i]=n[i]);return t};function PU(n,e,t={}){const i=t,{window:r=vx}=i,s=NU(i,["window"]);let o;const a=r&&"ResizeObserver"in r,l=()=>{o&&(o.disconnect(),o=void 0)},u=jr(()=>k1(n),p=>{l(),a&&r&&p&&(o=new ResizeObserver(e),o.observe(p,s))},{immediate:!0,flush:"post"}),A=()=>{l(),u()};return s7(A),{isSupported:a,stop:A}}function a7(n,e={}){const{reset:t=!0,windowResize:i=!0,windowScroll:r=!0,immediate:s=!0}=e,o=Ln(0),a=Ln(0),l=Ln(0),u=Ln(0),A=Ln(0),p=Ln(0),g=Ln(0),v=Ln(0);function x(){const S=k1(n);if(!S){t&&(o.value=0,a.value=0,l.value=0,u.value=0,A.value=0,p.value=0,g.value=0,v.value=0);return}const T=S.getBoundingClientRect();o.value=T.height,a.value=T.bottom,l.value=T.left,u.value=T.right,A.value=T.top,p.value=T.width,g.value=T.x,v.value=T.y}return PU(n,x),jr(()=>k1(n),S=>!S&&x()),r&&kf("scroll",x,{passive:!0}),i&&kf("resize",x,{passive:!0}),o7(()=>{s&&x()}),{height:o,bottom:a,left:l,right:u,top:A,width:p,x:g,y:v,update:x}}function Qg(n,e={}){const{throttle:t=0,idle:i=200,onStop:r=B0,onScroll:s=B0,offset:o={left:0,right:0,top:0,bottom:0},eventListenerOptions:a={capture:!1,passive:!0}}=e,l=Ln(0),u=Ln(0),A=Ln(!1),p=Fu({left:!0,right:!1,top:!0,bottom:!1}),g=Fu({left:!1,right:!1,top:!1,bottom:!1});if(n){const v=MU(S=>{A.value=!1,g.left=!1,g.right=!1,g.top=!1,g.bottom=!1,r(S)},t+i),x=S=>{const T=S.target===document?S.target.documentElement:S.target,w=T.scrollLeft;g.left=w<l.value,g.right=w>l.value,p.left=w<=0+(o.left||0),p.right=w+T.clientWidth>=T.scrollWidth-(o.right||0),l.value=w;let R=T.scrollTop;S.target===document&&!R&&(R=document.body.scrollTop),g.top=R<u.value,g.bottom=R>u.value,p.top=R<=0+(o.top||0),p.bottom=R+T.clientHeight>=T.scrollHeight-(o.bottom||0),u.value=R,A.value=!0,v(S),s(S)};kf(n,"scroll",t?EU(x,t):x,a)}return{x:l,y:u,isScrolling:A,arrivedState:p,directions:g}}var S8;(function(n){n.UP="UP",n.RIGHT="RIGHT",n.DOWN="DOWN",n.LEFT="LEFT",n.NONE="NONE"})(S8||(S8={}));function l7(n={}){const{window:e=vx,initialWidth:t=1/0,initialHeight:i=1/0,listenOrientation:r=!0}=n,s=Ln(t),o=Ln(i),a=()=>{e&&(s.value=e.innerWidth,o.value=e.innerHeight)};return a(),o7(a),kf("resize",a,{passive:!0}),r&&kf("orientationchange",a,{passive:!0}),{width:s,height:o}}function T8(n){return n!==null&&typeof n=="object"&&"constructor"in n&&n.constructor===Object}function yx(n={},e={}){Object.keys(e).forEach(t=>{typeof n[t]>"u"?n[t]=e[t]:T8(e[t])&&T8(n[t])&&Object.keys(e[t]).length>0&&yx(n[t],e[t])})}const u7={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function Jd(){const n=typeof document<"u"?document:{};return yx(n,u7),n}const LU={document:u7,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(n){return typeof setTimeout>"u"?(n(),null):setTimeout(n,0)},cancelAnimationFrame(n){typeof setTimeout>"u"||clearTimeout(n)}};function _A(){const n=typeof window<"u"?window:{};return yx(n,LU),n}let ro;const c7=()=>{if(ro)return U5(ro);const n=s=>ro.hash=s,e=()=>ro.isShown=!ro.isDisabled&&!0,t=()=>ro.isShown=!ro.isDisabled&&!1,i=()=>ro.isDisabled=!1,r=()=>ro.isDisabled=!0;return ro=Fu({hash:Jd().location.hash,setHash:n,isScrolling:!1,isShown:!1,isDisabled:!1,show:e,hide:t,enable:i,disable:r}),Yl(()=>{ro.hash=document.location.hash}),kf("hashchange",()=>ro.hash=document.location.hash),U5(ro)},DU={class:"nmd-navigation nmd-navigation--side"},IU=_t({});({...IU});function h7(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var c1={exports:{}};/*!
  * vue-scrollto v2.20.0
  * (c) 2019 Randjelovic Igor
  * @license MIT
  */var BU=c1.exports,M8;function FU(){return M8||(M8=1,function(n,e){(function(t,i){n.exports=i()})(BU,function(){function t(pe){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(Ae){return typeof Ae}:t=function(Ae){return Ae&&typeof Symbol=="function"&&Ae.constructor===Symbol&&Ae!==Symbol.prototype?"symbol":typeof Ae},t(pe)}function i(){return i=Object.assign||function(pe){for(var Ae=1;Ae<arguments.length;Ae++){var Fe=arguments[Ae];for(var be in Fe)Object.prototype.hasOwnProperty.call(Fe,be)&&(pe[be]=Fe[be])}return pe},i.apply(this,arguments)}var r=4,s=.001,o=1e-7,a=10,l=11,u=1/(l-1),A=typeof Float32Array=="function";function p(pe,Ae){return 1-3*Ae+3*pe}function g(pe,Ae){return 3*Ae-6*pe}function v(pe){return 3*pe}function x(pe,Ae,Fe){return((p(Ae,Fe)*pe+g(Ae,Fe))*pe+v(Ae))*pe}function S(pe,Ae,Fe){return 3*p(Ae,Fe)*pe*pe+2*g(Ae,Fe)*pe+v(Ae)}function T(pe,Ae,Fe,be,Ve){var Ye,Xe,Tt=0;do Xe=Ae+(Fe-Ae)/2,Ye=x(Xe,be,Ve)-pe,Ye>0?Fe=Xe:Ae=Xe;while(Math.abs(Ye)>o&&++Tt<a);return Xe}function w(pe,Ae,Fe,be){for(var Ve=0;Ve<r;++Ve){var Ye=S(Ae,Fe,be);if(Ye===0)return Ae;var Xe=x(Ae,Fe,be)-pe;Ae-=Xe/Ye}return Ae}function R(pe){return pe}var E=function(Ae,Fe,be,Ve){if(!(0<=Ae&&Ae<=1&&0<=be&&be<=1))throw new Error("bezier x values must be in [0, 1] range");if(Ae===Fe&&be===Ve)return R;for(var Ye=A?new Float32Array(l):new Array(l),Xe=0;Xe<l;++Xe)Ye[Xe]=x(Xe*u,Ae,be);function Tt(yt){for(var ut=0,Ut=1,ue=l-1;Ut!==ue&&Ye[Ut]<=yt;++Ut)ut+=u;--Ut;var ce=(yt-Ye[Ut])/(Ye[Ut+1]-Ye[Ut]),G=ut+ce*u,Ee=S(G,Ae,be);return Ee>=s?w(yt,G,Ae,be):Ee===0?G:T(yt,ut,ut+u,Ae,be)}return function(ut){return ut===0?0:ut===1?1:x(Tt(ut),Fe,Ve)}},N={ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},D=!1;try{var B=Object.defineProperty({},"passive",{get:function(){D=!0}});window.addEventListener("test",null,B)}catch{}var I={$:function(Ae){return typeof Ae!="string"?Ae:document.querySelector(Ae)},on:function(Ae,Fe,be){var Ve=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{passive:!1};Fe instanceof Array||(Fe=[Fe]);for(var Ye=0;Ye<Fe.length;Ye++)Ae.addEventListener(Fe[Ye],be,D?Ve:!1)},off:function(Ae,Fe,be){Fe instanceof Array||(Fe=[Fe]);for(var Ve=0;Ve<Fe.length;Ve++)Ae.removeEventListener(Fe[Ve],be)},cumulativeOffset:function(Ae){var Fe=0,be=0;do Fe+=Ae.offsetTop||0,be+=Ae.offsetLeft||0,Ae=Ae.offsetParent;while(Ae);return{top:Fe,left:be}}},O=["mousedown","wheel","DOMMouseScroll","mousewheel","keyup","touchmove"],L={container:"body",duration:500,lazy:!0,easing:"ease",offset:0,force:!0,cancelable:!0,onStart:!1,onDone:!1,onCancel:!1,x:!1,y:!0};function F(pe){L=i({},L,pe)}var V=function(){var Ae,Fe,be,Ve,Ye,Xe,Tt,yt,ut,Ut,ue,ce,G,Ee,ye,we,Se,ze,Ne,j,q,he,Me,Ue=function(fn){yt&&(Me=fn,j=!0)},Be,At,tt,Nt;function It(Ot){var fn=Ot.scrollTop;return Ot.tagName.toLowerCase()==="body"&&(fn=fn||document.documentElement.scrollTop),fn}function st(Ot){var fn=Ot.scrollLeft;return Ot.tagName.toLowerCase()==="body"&&(fn=fn||document.documentElement.scrollLeft),fn}function bt(){q=I.cumulativeOffset(Fe),he=I.cumulativeOffset(Ae),ce&&(ye=he.left-q.left+Xe,ze=ye-Ee),G&&(Se=he.top-q.top+Xe,Ne=Se-we)}function Gt(Ot){if(j)return Zt();At||(At=Ot),Ye||bt(),tt=Ot-At,Nt=Math.min(tt/be,1),Nt=Be(Nt),wt(Fe,we+Ne*Nt,Ee+ze*Nt),tt<be?window.requestAnimationFrame(Gt):Zt()}function Zt(){j||wt(Fe,Se,ye),At=!1,I.off(Fe,O,Ue),j&&ue&&ue(Me,Ae),!j&&Ut&&Ut(Ae)}function wt(Ot,fn,ne){G&&(Ot.scrollTop=fn),ce&&(Ot.scrollLeft=ne),Ot.tagName.toLowerCase()==="body"&&(G&&(document.documentElement.scrollTop=fn),ce&&(document.documentElement.scrollLeft=ne))}function tn(Ot,fn){var ne=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(t(fn)==="object"?ne=fn:typeof fn=="number"&&(ne.duration=fn),Ae=I.$(Ot),!Ae)return console.warn("[vue-scrollto warn]: Trying to scroll to an element that is not on the page: "+Ot);if(Fe=I.$(ne.container||L.container),be=ne.hasOwnProperty("duration")?ne.duration:L.duration,Ye=ne.hasOwnProperty("lazy")?ne.lazy:L.lazy,Ve=ne.easing||L.easing,Xe=ne.hasOwnProperty("offset")?ne.offset:L.offset,Tt=ne.hasOwnProperty("force")?ne.force!==!1:L.force,yt=ne.hasOwnProperty("cancelable")?ne.cancelable!==!1:L.cancelable,ut=ne.onStart||L.onStart,Ut=ne.onDone||L.onDone,ue=ne.onCancel||L.onCancel,ce=ne.x===void 0?L.x:ne.x,G=ne.y===void 0?L.y:ne.y,typeof Xe=="function"&&(Xe=Xe(Ae,Fe)),Ee=st(Fe),we=It(Fe),bt(),j=!1,!Tt){var Rt=Fe.tagName.toLowerCase()==="body"?document.documentElement.clientHeight||window.innerHeight:Fe.offsetHeight,We=we,it=We+Rt,Pt=Se-Xe,Ct=Pt+Ae.offsetHeight;if(Pt>=We&&Ct<=it){Ut&&Ut(Ae);return}}if(ut&&ut(Ae),!Ne&&!ze){Ut&&Ut(Ae);return}return typeof Ve=="string"&&(Ve=N[Ve]||N.ease),Be=E.apply(E,Ve),I.on(Fe,O,Ue,{passive:!0}),window.requestAnimationFrame(Gt),function(){Me=null,j=!0}}return tn},H=V(),Q=[];function te(pe){for(var Ae=0;Ae<Q.length;++Ae)if(Q[Ae].el===pe)return Q.splice(Ae,1),!0;return!1}function K(pe){for(var Ae=0;Ae<Q.length;++Ae)if(Q[Ae].el===pe)return Q[Ae]}function W(pe){var Ae=K(pe);return Ae||(Q.push(Ae={el:pe,binding:{}}),Ae)}function Z(pe){var Ae=W(this).binding;if(Ae.value){if(pe.preventDefault(),typeof Ae.value=="string")return H(Ae.value);H(Ae.value.el||Ae.value.element,Ae.value)}}var J={bind:function(Ae,Fe){W(Ae).binding=Fe,I.on(Ae,"click",Z)},unbind:function(Ae){te(Ae),I.off(Ae,"click",Z)},update:function(Ae,Fe){W(Ae).binding=Fe}},fe={bind:J.bind,unbind:J.unbind,update:J.update,beforeMount:J.bind,unmounted:J.unbind,updated:J.update,scrollTo:H,bindings:Q},ge=function(Ae,Fe){Fe&&F(Fe),Ae.directive("scroll-to",fe);var be=Ae.config.globalProperties||Ae.prototype;be.$scrollTo=fe.scrollTo};return typeof window<"u"&&window.Vue&&(window.VueScrollTo=fe,window.VueScrollTo.setDefaults=F,window.VueScrollTo.scroller=V,window.Vue.use&&window.Vue.use(ge)),fe.install=ge,fe})}(c1)),c1.exports}var UU=FU();const Nv=h7(UU),OU=["href"],kU=_t({});({...kU});const Ar=(n,e)=>{const t=n.__vccOpts||n;for(const[i,r]of e)t[i]=r;return t},VU=_t({}),GU={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 40 40"};function qU(n,e,t,i,r,s){return lt(),pt("svg",GU,e[0]||(e[0]=[ae("g",{transform:"translate(10.766 22.833) rotate(-90)"},[ae("path",{d:"M0,0,9.233,9.233,0,18.466",fill:"none",stroke:"#cb2529","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1)]))}const f7=Ar(VU,[["render",qU]]),zU=_t({}),HU={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function $U(n,e,t,i,r,s){return lt(),pt("svg",HU,e[0]||(e[0]=[ae("g",{id:"close",transform:"translate(0 -4)"},[ae("rect",{width:"36",height:"36",transform:"translate(0 4)",fill:"none"}),ae("path",{d:"M15.316,16.816a1.5,1.5,0,0,1-1.061-.439L-1.061,1.061a1.5,1.5,0,0,1,0-2.121,1.5,1.5,0,0,1,2.121,0L16.377,14.256a1.5,1.5,0,0,1-1.061,2.561Z",transform:"translate(10.5 14.5)",fill:"#232323"}),ae("path",{d:"M0,16.816a1.5,1.5,0,0,1-1.061-.439,1.5,1.5,0,0,1,0-2.121L14.256-1.061a1.5,1.5,0,0,1,2.121,0,1.5,1.5,0,0,1,0,2.121L1.061,16.377A1.5,1.5,0,0,1,0,16.816Z",transform:"translate(10.5 14.5)",fill:"#232323"})],-1)]))}const A7=Ar(zU,[["render",$U]]),WU=_t({}),jU={width:"36",height:"36",viewBox:"0 0 36 36",xmlns:"http://www.w3.org/2000/svg"};function XU(n,e,t,i,r,s){return lt(),pt("svg",jU,e[0]||(e[0]=[ae("g",{transform:"translate(-32 -1)"},[ae("rect",{width:"36",height:"36",transform:"translate(32 1)",fill:"none"}),ae("g",{transform:"translate(38 7)"},[ae("path",{d:"M24,12A12,12,0,1,0,10.16,23.84v-8.4H7.04V12h3.04V9.36c0-3.04,1.76-4.64,4.56-4.64a19.409,19.409,0,0,1,2.72.24V7.92H15.84a1.7,1.7,0,0,0-1.92,1.84V12h3.36l-.56,3.44h-2.8v8.4A11.976,11.976,0,0,0,24,12Z"})])],-1)]))}const d7=Ar(WU,[["render",XU]]),QU=_t({}),YU={width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function ZU(n,e,t,i,r,s){return lt(),pt("svg",YU,e[0]||(e[0]=[ae("path",{d:"M16.8986 32.0645H5.625C5.02826 32.0645 4.45597 31.8274 4.03401 31.4055C3.61205 30.9836 3.375 30.4113 3.375 29.8146V9.00329C3.375 8.40659 3.61205 7.83432 4.03401 7.41239C4.45597 6.99046 5.02826 6.75342 5.625 6.75342H26.4375C27.0342 6.75342 27.6065 6.99046 28.0285 7.41239C28.4504 7.83432 28.6875 8.40659 28.6875 9.00329V29.8146C28.6875 30.4113 28.4504 30.9836 28.0285 31.4055C27.6065 31.8274 27.0342 32.0645 26.4375 32.0645H20.6483V23.1989H23.5834L24.0446 19.6789H20.6471V17.2502C20.6471 16.2209 20.9531 15.5347 22.4471 15.5347H24.3698V12.3848C23.4396 12.2873 22.5048 12.2408 21.5696 12.2454C20.9444 12.1936 20.3155 12.2784 19.7263 12.4939C19.1372 12.7094 18.602 13.0505 18.1577 13.4934C17.7135 13.9363 17.3709 14.4705 17.1537 15.059C16.9365 15.6475 16.8498 16.2762 16.8998 16.9015V19.6778H13.8375V23.1977H16.8964V32.0645H16.8986Z",fill:"#2B66D8"},null,-1)]))}const KU=Ar(QU,[["render",ZU]]),JU=_t({}),eO={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function tO(n,e,t,i,r,s){return lt(),pt("svg",eO,e[0]||(e[0]=[ae("rect",{width:"36",height:"36",fill:"none"},null,-1),ae("path",{d:"M3.241,21V11.605H0V7.875H3.241V4.934A4.565,4.565,0,0,1,8.189,0a27.964,27.964,0,0,1,2.967.148V3.486H9.119c-1.6,0-1.906.738-1.906,1.817V7.875h3.6l-.49,3.73H7.213V21",transform:"translate(12.422 7.5)",fill:"#232323"},null,-1)]))}const p7=Ar(JU,[["render",tO]]),nO=_t({}),iO={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function rO(n,e,t,i,r,s){return lt(),pt("svg",iO,e[0]||(e[0]=[jg('<g transform="translate(0 -1)"><rect width="36" height="36" transform="translate(0 1)" fill="none"></rect><g transform="translate(1.874 -1)"><path d="M15.063,1.5H0A1.5,1.5,0,0,1-1.5,0,1.5,1.5,0,0,1,0-1.5H15.063a1.5,1.5,0,0,1,1.5,1.5A1.5,1.5,0,0,1,15.063,1.5Z" transform="translate(8.126 27)" fill="#232323"></path><path d="M15.063,1.5H0A1.5,1.5,0,0,1-1.5,0,1.5,1.5,0,0,1,0-1.5H15.063a1.5,1.5,0,0,1,1.5,1.5A1.5,1.5,0,0,1,15.063,1.5Z" transform="translate(8.126 20)" fill="#232323"></path><path d="M15.063,1.5H0A1.5,1.5,0,0,1-1.5,0,1.5,1.5,0,0,1,0-1.5H15.063a1.5,1.5,0,0,1,1.5,1.5A1.5,1.5,0,0,1,15.063,1.5Z" transform="translate(8.126 13)" fill="#232323"></path></g></g>',1)]))}const m7=Ar(nO,[["render",rO]]),sO=_t({}),oO={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36",width:"36",height:"36"};function aO(n,e,t,i,r,s){return lt(),pt("svg",oO,e[0]||(e[0]=[jg('<g transform="translate(-32 -1)"><rect width="36" height="36" transform="translate(32 1)" fill="none"></rect><g transform="translate(38 7)"><path d="M12,2.1c3.2,0,3.6,0,4.88.078a7.583,7.583,0,0,1,2.24.389,4.006,4.006,0,0,1,1.36.856,3.876,3.876,0,0,1,.88,1.323,7.032,7.032,0,0,1,.4,2.18c.08,1.246.08,1.635.08,4.748s0,3.5-.08,4.748a7.032,7.032,0,0,1-.4,2.18,3.876,3.876,0,0,1-.88,1.323,4.006,4.006,0,0,1-1.36.856,7.583,7.583,0,0,1-2.24.389c-1.28.078-1.68.078-4.88.078s-3.6,0-4.88-.078a7.583,7.583,0,0,1-2.24-.389,4.006,4.006,0,0,1-1.36-.856A3.876,3.876,0,0,1,2.64,18.6a7.032,7.032,0,0,1-.4-2.18c-.08-1.246-.08-1.635-.08-4.748s0-3.5.08-4.748a7.032,7.032,0,0,1,.4-2.18,6.333,6.333,0,0,1,.88-1.323,4.006,4.006,0,0,1,1.36-.856A7.583,7.583,0,0,1,7.12,2.18C8.4,2.1,8.8,2.1,12,2.1M12,0C8.72,0,8.32,0,7.04.078A8.506,8.506,0,0,0,4.16.623,7.013,7.013,0,0,0,2,1.946a6.77,6.77,0,0,0-1.36,2.1,8.294,8.294,0,0,0-.56,2.8C0,8.1,0,8.485,0,11.677S0,15.257.08,16.5a7.893,7.893,0,0,0,.56,2.8A6.77,6.77,0,0,0,2,21.407,6.192,6.192,0,0,0,4.16,22.73a8.939,8.939,0,0,0,2.88.545c1.28.078,1.68.078,4.96.078s3.68,0,4.96-.078a8.505,8.505,0,0,0,2.88-.545A7.013,7.013,0,0,0,22,21.407a5.979,5.979,0,0,0,1.36-2.1,8.294,8.294,0,0,0,.56-2.8c.08-1.245.08-1.635.08-4.826S24,8.1,23.92,6.85a7.893,7.893,0,0,0-.56-2.8A6.77,6.77,0,0,0,22,1.946,6.192,6.192,0,0,0,19.84.623,8.939,8.939,0,0,0,16.96.078C15.68,0,15.28,0,12,0Z"></path><path d="M13.46,7.3a6,6,0,1,0,0,11.988,6,6,0,1,0,0-11.988Zm0,9.886a3.894,3.894,0,1,1,0-7.784,3.894,3.894,0,1,1,0,7.784Z" transform="translate(-1.46 -1.617)"></path><ellipse cx="1.44" cy="1.401" rx="1.44" ry="1.401" transform="translate(16.96 4.048)"></ellipse></g></g>',1)]))}const g7=Ar(sO,[["render",aO]]),lO=_t({}),uO={width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function cO(n,e,t,i,r,s){return lt(),pt("svg",uO,e[0]||(e[0]=[ae("path",{d:"M17.1945 32.3678C17.1217 32.3738 17.0485 32.3632 16.9803 32.3369C16.9121 32.3106 16.8507 32.2693 16.8008 32.216C16.6699 31.9651 16.6436 31.6727 16.7276 31.4026V31.3722C16.7648 31.1472 16.9357 30.1212 16.9357 30.1212C17.0255 29.6828 17.0093 29.2292 16.8885 28.7982C16.7276 28.4 16.101 28.1862 15.6004 28.0771C8.5185 27.1456 3.375 22.2204 3.375 16.3715C3.375 9.82739 9.936 4.50391 18 4.50391C26.064 4.50391 32.625 9.82739 32.625 16.3715C32.5661 19.1207 31.4419 21.7396 29.4896 23.6761C26.1178 27.079 22.2426 29.943 18 32.1676C17.7465 32.2845 17.4732 32.3524 17.1945 32.3678V32.3678ZM23.6554 13.2091C23.5814 13.2097 23.5105 13.2387 23.4574 13.2901L23.4495 13.298C23.399 13.3507 23.3708 13.4208 23.3708 13.4938V19.8657C23.3713 19.9397 23.4003 20.0106 23.4518 20.0637L23.4596 20.0716C23.5123 20.1228 23.5831 20.1511 23.6565 20.1504H27.7538C27.8291 20.1498 27.9011 20.1196 27.9544 20.0664C28.0076 20.0131 28.0378 19.9411 28.0384 19.8657V18.8431C28.0381 18.7678 28.008 18.6957 27.9546 18.6426C27.9013 18.5895 27.829 18.5596 27.7538 18.5596H24.9671V17.4785H27.7538C27.829 17.4785 27.9013 17.4487 27.9546 17.3955C28.008 17.3424 28.0381 17.2703 28.0384 17.195V16.1724C28.0378 16.0971 28.0076 16.025 27.9544 15.9718C27.9011 15.9185 27.8291 15.8883 27.7538 15.8878H24.9671V14.8078H27.7538C27.829 14.8078 27.9013 14.7779 27.9546 14.7248C28.008 14.6717 28.0381 14.5996 28.0384 14.5243V13.5039C28.0378 13.4286 28.0076 13.3565 27.9544 13.3033C27.9011 13.25 27.8291 13.2199 27.7538 13.2193L23.6554 13.2091ZM17.9032 16.0813L20.8282 20.0255C20.8483 20.0535 20.8731 20.0779 20.9014 20.0975L20.9216 20.1099H20.925L20.9385 20.1166H20.9846C21.0084 20.1235 21.033 20.1269 21.0578 20.1267H22.0804C22.1555 20.1265 22.2274 20.0965 22.2805 20.0434C22.3336 19.9903 22.3636 19.9183 22.3639 19.8432V13.4949C22.3636 13.4198 22.3336 13.3479 22.2805 13.2947C22.2274 13.2416 22.1555 13.2117 22.0804 13.2114H21.06C20.9849 13.2117 20.913 13.2416 20.8599 13.2947C20.8068 13.3479 20.7768 13.4198 20.7765 13.4949V17.2861L17.8582 13.3363L17.8459 13.3183L17.8369 13.307L17.8256 13.2958L17.8189 13.289L17.8087 13.2789H17.775L17.7593 13.2699H16.5949C16.5196 13.2699 16.4474 13.2997 16.394 13.3529C16.3407 13.406 16.3105 13.4781 16.3103 13.5534V19.8646C16.3105 19.9399 16.3407 20.012 16.394 20.0652C16.4474 20.1183 16.5196 20.1481 16.5949 20.1481H17.6175C17.6928 20.1481 17.765 20.1183 17.8184 20.0652C17.8717 20.012 17.9018 19.9399 17.9021 19.8646V16.0835L17.9032 16.0813ZM14.0018 13.2091C13.9265 13.2091 13.8542 13.239 13.8009 13.2921C13.7475 13.3452 13.7174 13.4173 13.7171 13.4926V19.8669C13.7174 19.9422 13.7475 20.0143 13.8009 20.0674C13.8542 20.1205 13.9265 20.1504 14.0018 20.1504H15.0244C15.0995 20.1501 15.1714 20.1201 15.2245 20.067C15.2776 20.0139 15.3076 19.942 15.3079 19.8669V13.4949C15.3076 13.4198 15.2776 13.3479 15.2245 13.2947C15.1714 13.2416 15.0995 13.2117 15.0244 13.2114L14.0018 13.2091ZM8.45663 13.2091C8.38133 13.2091 8.30911 13.239 8.25576 13.2921C8.20242 13.3452 8.1723 13.4173 8.172 13.4926V19.8646C8.1722 19.9382 8.20035 20.009 8.25075 20.0626L8.25863 20.0705C8.31159 20.1212 8.38216 20.1495 8.4555 20.1492H12.555C12.6305 20.1492 12.7029 20.1193 12.7563 20.0659C12.8096 20.0125 12.8396 19.9401 12.8396 19.8646V18.842C12.8393 18.7667 12.8092 18.6946 12.7559 18.6415C12.7025 18.5883 12.6303 18.5585 12.555 18.5585H9.76613V13.496C9.76583 13.4207 9.73571 13.3486 9.68236 13.2955C9.62902 13.2423 9.55679 13.2125 9.4815 13.2125L8.45663 13.2091Z",fill:"#10B82B"},null,-1)]))}const hO=Ar(lO,[["render",cO]]),fO=_t({}),AO={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function dO(n,e,t,i,r,s){return lt(),pt("svg",AO,e[0]||(e[0]=[jg('<g transform="translate(1472 -130)"><g transform="translate(-1472.223 131)"><rect width="36" height="36" transform="translate(0.223 -1)" fill="none"></rect><g transform="translate(7.595 6.875)"><path d="M23.837,12.217c0-4.755-4.768-8.623-10.628-8.623S2.583,7.463,2.583,12.217c0,4.262,3.781,7.834,8.888,8.509.346.074.817.229.936.524a2.186,2.186,0,0,1,.034.96s-.124.75-.151.91c-.046.268-.214,1.05.92.572a34.271,34.271,0,0,0,8.349-6.17h0A7.667,7.667,0,0,0,23.837,12.217ZM9.05,15.047H6.939a.558.558,0,0,1-.558-.558V10.266a.557.557,0,1,1,1.115,0v3.665H9.05a.557.557,0,0,1,0,1.115Zm2.184-.558a.557.557,0,1,1-1.114,0V10.266a.557.557,0,1,1,1.114,0Zm5.083,0a.557.557,0,0,1-1,.335l-2.164-2.946v2.612a.557.557,0,1,1-1.114,0V10.266a.557.557,0,0,1,.38-.529.568.568,0,0,1,.177-.029.561.561,0,0,1,.446.223L15.2,12.88V10.266a.557.557,0,1,1,1.115,0Zm3.417-2.668a.557.557,0,1,1,0,1.114H18.179v1h1.554a.557.557,0,1,1,0,1.115H17.622a.558.558,0,0,1-.557-.558V12.379h0V10.266a.558.558,0,0,1,.557-.557h2.111a.558.558,0,0,1,0,1.115H18.179v1h1.554Z" transform="translate(-2.583 -3.594)" fill="#232323"></path></g></g></g>',1)]))}const _7=Ar(fO,[["render",dO]]),pO=_t({}),mO={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36",width:"36",height:"36"};function gO(n,e,t,i,r,s){return lt(),pt("svg",mO,e[0]||(e[0]=[ae("g",{transform:"translate(-30 31)"},[ae("rect",{width:"36",height:"36",transform:"translate(30 -31)",fill:"none"}),ae("g",{"data-name":"line",transform:"translate(36 -25)"},[ae("path",{d:"M26.351,13.237c0-5.317-5.332-9.644-11.885-9.644S2.583,7.92,2.583,13.237c0,4.767,4.228,8.76,9.939,9.516.387.083.914.256,1.047.586a2.444,2.444,0,0,1,.038,1.074s-.139.839-.169,1.018c-.051.3-.239,1.175,1.029.64a38.324,38.324,0,0,0,9.337-6.9h0A8.574,8.574,0,0,0,26.351,13.237ZM9.815,16.4H7.454a.624.624,0,0,1-.624-.624V11.056a.623.623,0,1,1,1.246,0v4.1H9.815a.623.623,0,0,1,0,1.247Zm2.443-.624a.623.623,0,1,1-1.246,0V11.056a.623.623,0,1,1,1.246,0Zm5.684,0a.623.623,0,0,1-1.122.374L14.4,12.857v2.921a.623.623,0,1,1-1.246,0V11.056a.623.623,0,0,1,.425-.591.635.635,0,0,1,.2-.032.627.627,0,0,1,.5.25l2.42,3.3V11.056a.623.623,0,1,1,1.246,0Zm3.821-2.984a.623.623,0,1,1,0,1.246H20.024v1.115h1.738a.623.623,0,1,1,0,1.247H19.4a.624.624,0,0,1-.623-.624v-2.36h0v-2.36a.624.624,0,0,1,.623-.623h2.361a.623.623,0,0,1,0,1.247H20.024v1.115h1.738Z",transform:"translate(-2.583 -3.594)"})])],-1)]))}const v7=Ar(pO,[["render",gO]]),_O=_t({}),vO={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function yO(n,e,t,i,r,s){return lt(),pt("svg",vO,e[0]||(e[0]=[ae("g",{transform:"translate(5 -1)"},[ae("rect",{width:"36",height:"36",transform:"translate(-5 1)",fill:"none"}),ae("path",{d:"M13.285,12.078a3.608,3.608,0,0,0-2.257.789L7.161,10.449a3.644,3.644,0,0,0,0-1.573l3.868-2.418A3.617,3.617,0,1,0,9.748,4.41L5.88,6.827a3.623,3.623,0,1,0,0,5.669l3.868,2.418a3.624,3.624,0,1,0,3.537-2.837Z",transform:"translate(3 9)",fill:"var(--color, #222222)"})],-1)]))}const y7=Ar(_O,[["render",yO]]),xO=_t({}),bO={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function wO(n,e,t,i,r,s){return lt(),pt("svg",bO,e[0]||(e[0]=[ae("g",{transform:"translate(1472 -90)"},[ae("g",{transform:"translate(-1472 86)"},[ae("rect",{width:"36",height:"36",transform:"translate(0 4)",fill:"none"}),ae("path",{d:"M17.55,52.041c.012.174.012.348.012.521A11.328,11.328,0,0,1,6.156,63.969,11.329,11.329,0,0,1,0,62.169a8.292,8.292,0,0,0,.968.05,8.029,8.029,0,0,0,4.977-1.713A4.016,4.016,0,0,1,2.2,57.726a5.057,5.057,0,0,0,.757.062,4.24,4.24,0,0,0,1.055-.137A4.01,4.01,0,0,1,.794,53.717v-.05a4.038,4.038,0,0,0,1.812.509,4.015,4.015,0,0,1-1.241-5.362,11.4,11.4,0,0,0,8.266,4.2,4.526,4.526,0,0,1-.1-.918,4.013,4.013,0,0,1,6.938-2.743,7.892,7.892,0,0,0,2.544-.968,4,4,0,0,1-1.762,2.209,8.037,8.037,0,0,0,2.309-.621A8.617,8.617,0,0,1,17.55,52.041Z",transform:"translate(8.22 -34.025)",fill:"#232323"})])],-1)]))}const x7=Ar(xO,[["render",wO]]),SO=_t({}),TO={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"37",viewBox:"0 0 36 37",fill:"none"};function MO(n,e,t,i,r,s){return lt(),pt("svg",TO,e[0]||(e[0]=[ae("path",{d:"M23.2033 9.875H25.96L19.9375 16.7583L27.0225 26.125H21.475L17.13 20.4442L12.1583 26.125H9.39998L15.8417 18.7625L9.04498 9.875H14.7333L18.6608 15.0675L23.2033 9.875ZM22.2358 24.475H23.7633L13.9033 11.4383H12.2641L22.2358 24.475Z",fill:"#0F1419"},null,-1)]))}const b7=Ar(SO,[["render",MO]]),EO=_t({}),CO={width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function RO(n,e,t,i,r,s){return lt(),pt("svg",CO,e[0]||(e[0]=[ae("path",{d:"M30.6281 12.9022C30.6473 13.1722 30.6473 13.4421 30.6473 13.7121C30.6634 16.042 30.2164 18.3518 29.3321 20.5075C28.4479 22.6632 27.144 24.6218 25.4963 26.2694C23.8486 27.917 21.8899 29.2209 19.734 30.1052C17.578 30.9896 15.2678 31.4368 12.9375 31.421C9.54733 31.4303 6.22666 30.4601 3.375 28.627C3.87406 28.6821 4.37592 28.708 4.878 28.7046C7.67991 28.7118 10.4025 27.7751 12.6068 26.0456C11.3076 26.022 10.0483 25.5933 9.00473 24.8193C7.96116 24.0453 7.18546 22.9648 6.786 21.7286C7.17489 21.7902 7.56788 21.8226 7.96163 21.8253C8.51434 21.8238 9.06466 21.7528 9.59962 21.6138C8.19055 21.3278 6.92392 20.563 6.01484 19.4492C5.10575 18.3355 4.61026 16.9415 4.6125 15.5039V15.4263C5.47493 15.9064 6.43858 16.1762 7.425 16.2136C6.10402 15.3325 5.16908 13.9807 4.81095 12.4339C4.45283 10.8871 4.69852 9.26196 5.49787 7.89009C7.06151 9.81451 9.01225 11.3888 11.2236 12.511C13.4349 13.6331 15.8575 14.278 18.3341 14.4038C18.2342 13.9349 18.1826 13.457 18.18 12.9776C18.1812 11.7292 18.5575 10.5099 19.2602 9.47788C19.9628 8.44587 20.9593 7.6487 22.1205 7.18973C23.2817 6.73076 24.554 6.63117 25.7725 6.90387C26.991 7.17656 28.0994 7.80896 28.9541 8.71908C30.3482 8.45075 31.6851 7.94227 32.9051 7.21634C32.4407 8.65452 31.4675 9.87392 30.168 10.6459C31.4032 10.5055 32.6106 10.1813 33.75 9.68416C32.8977 10.9247 31.8423 12.0126 30.6281 12.9022V12.9022Z",fill:"#49ADE4"},null,-1)]))}const w7=Ar(EO,[["render",RO]]),NO=_t({}),PO={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36",fill:"none"};function LO(n,e,t,i,r,s){return lt(),pt("svg",PO,e[0]||(e[0]=[ae("path",{d:"M25.2847 6.625H29.144L20.7125 16.2617L30.6315 29.375H22.865L16.782 21.4218L9.82168 29.375H5.96001L14.9783 19.0675L5.46301 6.625H13.4267L18.9252 13.8945L25.2847 6.625ZM23.9302 27.065H26.0687L12.2647 8.81367H9.96985L23.9302 27.065Z",fill:"#0F1419"},null,-1)]))}const S7=Ar(NO,[["render",LO]]),DO=_t({}),IO={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function BO(n,e,t,i,r,s){return lt(),pt("svg",IO,e[0]||(e[0]=[ae("g",{transform:"translate(-30 -1)"},[ae("rect",{width:"36",height:"36",transform:"translate(30 1)",fill:"none"}),ae("path",{d:"M23.52,3.659A3.855,3.855,0,0,0,21.36.7C19.52,0,12,0,12,0S4.48,0,2.64.7A3.855,3.855,0,0,0,.48,3.659,62.241,62.241,0,0,0,0,11.677a62.241,62.241,0,0,0,.48,8.018,3.855,3.855,0,0,0,2.16,2.958c1.84.7,9.36.7,9.36.7s7.52,0,9.36-.7a3.855,3.855,0,0,0,2.16-2.958A62.241,62.241,0,0,0,24,11.677,62.241,62.241,0,0,0,23.52,3.659ZM8.72,16.114V7.239l8,4.437Z",transform:"translate(36 7)"})],-1)]))}const T7=Ar(DO,[["render",BO]]),FO={},UO={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none"};function OO(n,e){return lt(),pt("svg",UO,e[0]||(e[0]=[ae("path",{d:"M8.58984 16.58L13.1698 12L8.58984 7.41L9.99984 6L15.9998 12L9.99984 18L8.58984 16.58Z",fill:"currentColor"},null,-1)]))}const M7=Ar(FO,[["render",OO]]),kO=_t({}),VO={xmlns:"http://www.w3.org/2000/svg",width:"81",height:"15",viewBox:"0 0 180 32.1"};function GO(n,e,t,i,r,s){return lt(),pt("svg",VO,e[0]||(e[0]=[ae("path",{d:"M156.778,16.817c-.271-.131-5.423.824-6.788.913A19.8,19.8,0,0,1,139.5,15.3a19.777,19.777,0,0,1-6.032-5.312c-.391-.469-1.01-.835-1.321-1.366-.535-.932-.433-2.636-1.152-3.422l-.5-.311-.823-.065-.254.145c-1.372.706-1.942,2.9-2.9,4.023a46.225,46.225,0,0,1-8.1,7.07c-1.763,1.3-3.692,1.741-6.614,2.052a11.047,11.047,0,0,1-3.143.214,14.378,14.378,0,0,1-3.8-1.813c-.31-.253-.424-.681-.754-.913a1.652,1.652,0,0,0-1.648,0c-.828.46-1.258,1.85-1.4,2.876a9.273,9.273,0,0,0,.41,3.275,4.3,4.3,0,0,0,.412,1.743c1.641,2.219,6.122.778,8.6.307.559-.119,1.576-.563,2.314-.228.814.368.115,2.463-.082,2.96-.416,1.073-.6,3.61.48,4.147l.8.17c2.457.713,4.943-.223,7.486-.514a106.06,106.06,0,0,1,11.54-.25c2.474.264,4.557.366,6.976.776,1.288.222,3.632.89,5.292.375,2.57-.785.054-5.186,1.249-6.988l.073-.068c.817-.589,1.53.1,2.565.068a11.648,11.648,0,0,0,4.546-.989c.694-.422,1.295-1.422,1.9-1.958C155.965,20.987,158.092,17.43,156.778,16.817ZM126.03,14.4c.47-.465,1.342-1.457,2.065-1.6,2.053-.4,3.3,1.711,4.223,2.511l-.171.454c-1.466.182-5.91.971-7.278.308l-.243-.542C125.016,15.082,125.6,14.8,126.03,14.4Zm14.136,11.913-.494.61c-1.3.5-3.429.07-4.4-.05-2.024-.233-3.126.094-5.516,0a38.135,38.135,0,0,0-6.974.43,9.087,9.087,0,0,1-3.693-.083c-.852-.3-.431-1.877.071-2.271.8-.611,3.811-.585,5.209-.689,1.773-.121,3.769-.22,5.386-.179,3.225.073,7.775-.438,10,.943A1.076,1.076,0,0,1,140.166,26.308Zm-3.885-5.315c-3.143.214-6.339-.075-9.673.152-1.966.139-5.872.7-7.607.163h-.163c-1.343-.785.691-1.91,1.322-2.293l1.076-.448c.5-.027.938.778,1.326.839,1.5.263,3.469-.318,5.12-.16.449.047,6.259-.521,6.285-.527.479-.192.937-.985,1.408-1.064.657-.132,4.726,2.376,4.909,3.13C140.5,21.625,137.73,20.891,136.281,20.993Z",transform:"translate(-40.407 -2.081)",fill:"#cb2529"},null,-1),ae("path",{d:"M260.395,23.773a7.576,7.576,0,0,0-2.648.31,21.278,21.278,0,0,1-5.452.126,40.4,40.4,0,0,1-9.877-3.316,11.2,11.2,0,0,1-2.121-1.527l-.01-.743c.734-1.357,4.273-.353,5.9-.713a24.863,24.863,0,0,1,2.976-.616,8.223,8.223,0,0,0,2.38-.242c1.785-.889-.731-4.423-2.923-3.735-.913.29-1.512.892-2.281,1.123-1.417.422-5.3,1.274-3.8-.845a3.826,3.826,0,0,1,1.577-1.268,14.249,14.249,0,0,1,3.338-1.42A13.273,13.273,0,0,0,250,10.364a3.958,3.958,0,0,0,1.66-2.447c.073-1.238-2.633-1.014-4.054-.838a27,27,0,0,1-5.28.326c-1.729-.152-5.665-1.644-7.58-1.185-.43.1-.659.656-.959.9-.317.24-.973.469-1.048.892a11.6,11.6,0,0,0,.121,2.562c.1,1.429-.491.891-1.505.547a10.4,10.4,0,0,0-3.961-.125l-.442.094a12.357,12.357,0,0,1-3.343.243c-.533-.1-.658-.951-.627-.951.178-.521.146-1.5.692-1.711a3.882,3.882,0,0,1,1.065-.078c2.453-.172,4.242-.278,5.092-1.739.3-.514.14-1.615-.449-1.76-1.873-.492-3.863,1.291-5.64.631-1.314-.492-.447-2.126-.347-2.5.49-1.751-.553-2.173-2.4-2.042-1.384.1-1.179.356-1.721,1.115-.265.364-.553,3.463-.265,2.936-.835,1.483-4.173-.394-6.432.133-.647.159-1.152,1.311-1.583,1.72s-1.033.991-.6,1.7c.471.759,1.249.589,2.289.418,1.772-.286,6.6-.932,6.34.91-.089.686-.017,1.394-.776,1.553a42.924,42.924,0,0,1-9.067.078c-1.139-.106-2.169-.759-3.437-.634a3.879,3.879,0,0,0-1.922.819,8.485,8.485,0,0,0-1.657,2.447.887.887,0,0,0,.71,1.331c.677.04,1.33-.458,1.933-.542,2.354-.358,5.476-1.253,8.355-.733.554.1.913,1.094.63,1.62-.167.29-1.079.452-1.5.527-1.927.318-4.573-.656-5.969.417a2.215,2.215,0,0,0-.962,1.7l-.083.441c.113.436.828.6,1.5.575,1.1-.053,2.325-.442,3.421-.552,1.849-.174,3.426-.174,5.281-.182a8.961,8.961,0,0,1,2.292.049.927.927,0,0,1,.531.737,1.671,1.671,0,0,1-.254,1.478c-.6.662-7.207.4-8.8.509-2.547.179-3.512-.477-4.922.859-.552.5-.577.7-.076,1.247a2.805,2.805,0,0,0,1.321,1.025c2.21.535,5.974-.463,7.92-.732.6-.095,4.2-.569,4.571-.014a1.263,1.263,0,0,1-.081,1.093c-1.273,2.836-17.127.473-14.219,4.972a3.983,3.983,0,0,0,1.777,1.529c2.6.809,4.762-.619,6.414-1.088,3.025-.844,7-.631,8.79-2.441a4.2,4.2,0,0,0,.944-2.513c.052-.547.052-1.775.1-1.8.388-.106.532.033.943.026,2.71-.019,5.124.865,6.513-.65l.524-.5c1.181-2.794-6.445-.486-7.973-1.485.168-.723-.048-2.137.634-2.432,1.69-.773,6.71,1.235,7.649-.734a.939.939,0,0,0-.092-1.1c-.978-1.268-2.282-.673-3.613-1.445.055-.535.376-1.4,1.123-1.552,1.052-.209,1.975.1,2.992-.019.575-.08,1.44-.536,2.111-.391.834.171.714,4.1.6,4.993-.393,3-2.8,10.562-.629,12.86,1.012,1.09,3.865,1.031,3.328-.978-.284-1.075-.659-8,.4-8.448.607-.258.7-.1,1.2.067,1.144.414,2.062,1.71,2.833,2.5a23.92,23.92,0,0,0,5.3,3.638c.592.229,3.245,2.146,4.267,2.53,1.106.422,2.414-.175,3.146-.415,1.7-.592,4.484-3.053,5.777-4.133.451-.387.961-.715,1.388-1.123C260.517,24.835,261.306,23.975,260.395,23.773Zm-36.409-8.838a3.771,3.771,0,0,1-1.484.893c-.784.184-5.615.455-6.335.121-.641-.267.044-1.245.337-1.463a6.8,6.8,0,0,1,3.163-.686c.925-.047,1.979.007,2.908-.04C223.935,13.707,225.134,13.759,223.986,14.935Zm13.124,1.279c-.645.074-.637.1-.738-.272a34.2,34.2,0,0,1,.608-5.308,20.265,20.265,0,0,1,3.781-.409,1.871,1.871,0,0,1,1.417.346c-.279,1.319-1.34,2.2-1.74,3.419-.165.49.128.949-.165,1.314C239.951,15.707,237.722,16.144,237.11,16.214Z",transform:"translate(-80.821 -0.614)",fill:"#cb2529"},null,-1),ae("path",{d:"M47.809,20.369c.049-.7-.007-1.4.265-1.649.512-.509,1.574-.124,2.824.053.664.086,1.151.631,2.09.463,2.475-.423-2.288-5.6-2.45-6.8-.263-2.076,3.223-.533,3.579-1.926.513-2-1.41-2.876-2.1-3.841C51.083,5.315,49.256.092,47.231.254A3.486,3.486,0,0,0,46.1.742a13.112,13.112,0,0,0-3.666,3.514c-.371.462-.991.763-1.384,1.216-.536.612-2.086,3.533-2.7,3.685h-.7c-1.5-.292-2.966-7.344-5.488-7.768a2.69,2.69,0,0,0-1.565.235c-2.02.99-3.572,3.45-5.406,4.8-.375.284-.637.706-1.139.889a4.138,4.138,0,0,1-2.077.23l-.181-.392.087-.158c0-1.358.01-2.517-.868-3.049-1.257-.737-3.229-.188-4.8-.067a12.592,12.592,0,0,1-1.916-.253c-1.06-.07-2.172.276-3.4.161-1.63-.154-3.6-.193-5.311-.321-1.69-.109-2.573.05-3.408.889A9.747,9.747,0,0,0,1.22,5.392c-.52.756-.037,4.27.082,5.281a28.014,28.014,0,0,1-.347,5.287C.843,17.341.269,18.1.085,19.237A6.074,6.074,0,0,0,1.3,24.056l.443.32a3.237,3.237,0,0,0,1.3.074c.989-.111,15.019-3.091,12.373,0a4.2,4.2,0,0,1-1.39.969,15.672,15.672,0,0,1-3.311.473c-2.258.367-5.89.193-7.49,1.2l-.181.079a4.972,4.972,0,0,0-1.483,1.288c-.356.5-.931,3.553,0,3.838a3.623,3.623,0,0,0,1.483-.159,39.847,39.847,0,0,0,7.231-1.6c2.158-.576,4.306-.656,6.11-1.515a9.3,9.3,0,0,0,3.045-2.814,11.15,11.15,0,0,0,1.828-4.006c.077-.548-.166-1.231,0-1.754l.179-.25a3.731,3.731,0,0,1,1.829-.16c4.053.472.4,2.588-.439,3.446l-.433.65c-.958,1.941,1.516,5,2.873,3.672.991-.971.391-3.149.26-4.723l.079-.562a19.074,19.074,0,0,1,.268-2.324c.272-.892,2.818-.759,3.574-.715a11.085,11.085,0,0,1,3.223.315c1,.434-1,2.958-1.393,3.686-.476.888-1.319,2.333-.611,3.609.926,1.671,2.863.567,3.14-.885s-.271-2.954-.179-4.4a2.477,2.477,0,0,1,1.823-2.584,8.762,8.762,0,0,1,3.584.1c1.838.39-.545,2.766-.7,3.369a17.1,17.1,0,0,0-.44,5.6,1.872,1.872,0,0,0,2.62.646c1.493-1.01.365-6.407.09-8.017-.09-.477-.686-1.514-.263-2.155.31-.518,3.089-.244,3.925-.244-.923.023,1.256-.027,1.474,0,2.108.218.89,2.754.437,3.833-.591,1.43-1.667,7.085.61,7.534a3.674,3.674,0,0,0,1.3-.158,3.663,3.663,0,0,0,2.186-.871c1.525-1.2,2.054-3.363,3.574-4.577a7.938,7.938,0,0,0,1.446-1.118C56.447,21.084,47.581,23.827,47.809,20.369Zm-31.865-.722c-1.133.652-5.965.006-7.84.244-.6.068-1.514.638-2.36.4-.736-.226-.434-1.981.1-2.247,1.07-.553,3.341-.529,4.7-.646,1.406-.116,4.947.176,5.5.881C16.318,18.655,16.433,19.362,15.943,19.647Zm-.263-4.241a10.826,10.826,0,0,1-2.605,0,36.156,36.156,0,0,0-6.978.236c-.293-.389-.369-.448-.171-.956.282-.76.751-.873,1.663-1.045a27.758,27.758,0,0,1,3.826-.488c1.079-.026,4.406.29,4.795.813A.951.951,0,0,1,15.68,15.407Zm1.052-5.286-.523.636c-1.607.5-3.827-.255-5.582-.084-.905.09-2.326.658-3.484.326-.512-.157-.512-.95-.44-1.445.108-.649.3-1.291.885-1.443a78.658,78.658,0,0,1,8.964.65C17.04,8.957,16.91,9.705,16.733,10.121Zm8.086,3.9a4.655,4.655,0,0,1-2.42,2.51c-1.987.625-1.432-3.019-.786-3.209a4.328,4.328,0,0,1,1.739.155,2.591,2.591,0,0,1,1.486.493Zm4.723,2.67c-1.374.155-2.143.138-2.36-.331-.431-.925,1.112-2.852,2.185-2.959C32.155,13.114,33.6,16.212,29.542,16.688Zm-2.179-6.567c-.689-.283-.1-1.042.178-1.36.306-.383.7-.7,1.038-1.045a3.454,3.454,0,0,1,1.659-.962c.923-.12,2.471,1.473,2.269,2.325C32.371,9.654,28.35,10.5,27.363,10.121Zm11.588,4.718c-.493.568-1.028,2.14-1.925,2.245L36.776,17a1.419,1.419,0,0,1-.873-.473,11.135,11.135,0,0,1-.962-2.245c-.274-.575-1.425-1.117-1.308-1.931.149-.961,2.554-.961,3.659-1.04a8.523,8.523,0,0,1,3.059.484c.749.209,1.289.2,1.228.819S39.455,14.269,38.951,14.838Zm6.283-9.7c1.5-.273,3.327,1.348,3.044,2.486-.139.547-1.771.99-2.353,1.135-1.4.325-2.374.19-2.7-.165C42.418,7.688,44.6,5.267,45.234,5.14Zm2.135,9.909c-.1.387-.678.588-1.529.677-1.575.159-2.437.109-2.633-.391-.4-.979,1.276-2.934,1.677-2.983C45.632,12.255,47.645,14.018,47.369,15.049Z",transform:"translate(0 -0.25)",fill:"#cb2529"},null,-1)]))}const E7=Ar(kO,[["render",GO]]),qO=_t({}),zO=_t({...qO,__name:"index",setup(n){const e=_A(),t=Jd(),{y:i}=Qg(e,{throttle:100}),r=Ln(0);function s(){if(typeof e>"u"&&typeof t>"u")return;const o=t.body.scrollHeight-e.innerHeight,a=e.scrollY;r.value=+(a/o*100).toFixed(2)}return jr(i,()=>s()),(o,a)=>(lt(),pt("div",null,[ae("div",{class:"nmd-progressbar",style:pa({width:`${r.value}%`})},null,4)]))}}),HO={class:"nmd-header__left"},$O=["href"],WO={class:"nmd-header__subscribe"},jO=["href"],XO={class:"nmd-header__right"},QO=_t({components:{NmdLogo:E7}}),YO=_t({...QO,__name:"index",props:{theme:{default:"light"},customBg:{},utmString:{default:""}},setup(n){const e=n,t=_A(),i=Jd(),{y:r}=Qg(t,{throttle:100}),s=Ln(!0);px("isHeaderShown",s);const o=Ln(!0),a=er(()=>({transform:s.value?"unset":"translateY(-60px)"})),l=er(()=>({backgroundColor:o.value?"unset":e.customBg?e.customBg:e.theme==="dark"?"#232323":"#FFFFFF"})),u=er(()=>e.utmString!==""?`https://vip.udn.com/vip/index?from=${e.utmString}`:"https://vip.udn.com/"),A=er(()=>e.utmString!==""?`https://vip.udn.com/vip/order?from=${e.utmString}`:"https://vip.udn.com/vip/order?from=Newmedia");return jr(r,(p,g)=>{if(i.body.style.overflow!=="hidden"){if(p<=0)s.value=!0;else{const v=p>g;s.value=!v}o.value=r.value<=0}}),(p,g)=>(lt(),pt("div",{class:"nmd-header",style:pa(a.value)},[ae("div",{class:"nmd-header-nav",style:pa(l.value)},[ae("div",HO,[ae("a",{href:u.value,target:"_blank",rel:"noreferrer noopener",class:"nmd-header__logo","data-ga":"udn-logo"},[vt(Ke(E7))],8,$O),ae("div",WO,[ae("a",{href:A.value,class:On(["nmd-subscribe",{"nmd-header--dark":p.theme==="dark"}]),target:"_blank",rel:"noreferrer noopener","data-ga":"subscribe-top"},g[0]||(g[0]=[ae("span",null,"訂閱",-1),ae("span",null,"數位版",-1)]),10,jO)])]),ae("div",XO,[Ti(p.$slots,"default")])],4),g[1]||(g[1]=ae("div",{id:"header-teleport",class:"nmd-header-teleport"},null,-1))],4))}}),ZO={class:"nmd-share-buttons"},KO=["href","tabindex"],JO=["href","target","tabindex"],ek=["href","tabindex"],tk=_t({name:"NmdHeaderShare",components:{NmdIconFacebook:p7,NmdIconLineSmall:_7,NmdIconShare:y7,NmdIconTwitterSmall:x7,NmdIconTwitterSmallX:b7}}),nk=_t({...tk,props:{facebook:{default:()=>({href:"https://www.facebook.com/sharer/sharer.php?kid_directed_site=0&sdk=joey&u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&display=popup&ref=plugin&src=share_button"})},line:{default:()=>({href:"https://social-plugins.line.me/lineit/share?url=https%3A%2F%2Fline.me%2Fen",target:"_blank"})},twitter:{default:()=>({href:"https://twitter.com/intent/tweet?text=Hello%20world"})},theme:{default:"light"},twitterIcon:{default:"x"}},setup(n){const e=n,t=Ef("isHeaderShown"),i=Ln(!1);jr(()=>t==null?void 0:t.value,o=>{o||(i.value=!1)});const r=er(()=>({"nmd-share-buttons__share-button":!0,"nmd-share-buttons__share-button--shown":i.value})),s=er(()=>i.value?"0":"-1");return(o,a)=>(lt(),pt("div",ZO,[ae("a",{href:e.facebook.href,class:On(["nmd-share-button",r.value]),target:"_blank",rel:"noreferrer noopener",tabindex:s.value,"data-ga":"share-facebook-top"},[vt(Ke(p7),{class:"nmd-share-button__icon"})],10,KO),ae("a",{href:e.line.href,class:On(["nmd-share-button",r.value]),target:e.line.target||"_blank",rel:"noreferrer noopener",tabindex:s.value,"data-ga":"share-line-top"},[vt(Ke(_7),{class:"nmd-share-button__icon"})],10,JO),ae("a",{href:e.twitter.href,class:On(["nmd-share-button",r.value]),target:"_blank",rel:"noreferrer noopener",tabindex:s.value,"data-ga":"share-twitter-top"},[o.twitterIcon==="x"?(lt(),Ya(Ke(b7),{key:0,class:"nmd-share-button__icon"})):Ji("",!0),o.twitterIcon==="bird"?(lt(),Ya(Ke(x7),{key:1,class:"nmd-share-button__icon"})):Ji("",!0)],10,ek),ae("button",{class:On(["nmd-share-button nmd-share-buttons__toggler",{"nmd-share-buttons__toggler--on":i.value}])},[vt(Ke(y7),{class:On(["nmd-share-button__icon",{"nmd-share-button--dark":o.theme==="dark"}]),onClick:a[0]||(a[0]=l=>i.value=!i.value)},null,8,["class"])],2)]))}});let Ea;const C7=()=>Ea||(Ea=Fu({isShown:!1,isDisabled:!1,show:()=>Ea.isShown=!Ea.isDisabled&&!0,hide:()=>Ea.isShown=!Ea.isDisabled&&!1,enable:()=>Ea.isDisabled=!1,disable:()=>Ea.isDisabled=!0}),Ea),ik=_t({name:"NmdHamburger",components:{NmdIconHamburger:m7}}),rk=_t({...ik,props:{theme:{default:"light"}},setup(n){const e=C7(),t=_A(),i=Jd();jr(()=>e.isShown,o=>o?r():s());function r(){if(!i.body.style||!i.body.getBoundingClientRect)return;const{width:o,top:a}=i.body.getBoundingClientRect();i.body.style.overflow="hidden",i.body.style.position="fixed",i.body.style.width=`${o}px`,i.body.style.top=`${a}px`}function s(){if(!i.body.style||!i.body.getBoundingClientRect||!t.scroll)return;const{top:o}=i.body.getBoundingClientRect();i.body.style.removeProperty("overflow"),i.body.style.removeProperty("position"),i.body.style.removeProperty("width"),i.body.style.removeProperty("top"),t.scroll(0,-o)}return(o,a)=>(lt(),pt("button",{class:On(["nmd-hamburger",{"nmd-hamburger--dark":o.theme==="dark"}]),onClick:a[0]||(a[0]=l=>Ke(e).show())},[vt(Ke(m7))],2))}}),sk=_t({name:"NmdHeroTitle"});({...sk});const ok=_t({name:"NmdTitleA"});({...ok});const ak=_t({name:"NmdTitleB"});({...ak});const lk=_t({name:"NmdTitleC"});({...lk});const uk=_t({name:"NmdTitleH"});({...uk});const R7=_t({setup(n,{slots:e}){const t=ck(e);return()=>Ua("nav",Ua("ul",{class:["nmd-menu__list"]},t))}});function ck(n){n===void 0&&(n={});const e=[],t=(i,r)=>{Array.isArray(i)&&r==="default"&&i.forEach(s=>{typeof s.type=="symbol"&&s.children?t(s.children,"default"):s.type&&s.type.name==="NmdMenuItem"?e.push(s):s.type&&s.type.name==="NmdMenuGroup"&&e.push(Ua("li",{class:"nmd-menu__list-item"},s))})};return Object.keys(n).forEach(i=>{if(typeof n[i]!="function")return;const r=n[i]();t(r,i)}),e}const hk={class:"nmd-menu-container"},fk={class:"nmd-menu"},Ak=_t({name:"NmdMenu",components:{NmdIconClose:A7,NmdMenuList:R7}}),dk=_t({...Ak,setup(n){const e=C7();return(t,i)=>(lt(),Ya(U1,{name:"nmd-menu"},{default:zn(()=>[Ke(e).isShown?(lt(),pt("div",{key:0,class:"nmd-menu-wrapper",onClick:i[1]||(i[1]=n7(r=>Ke(e).hide(),["self"]))},[ae("div",hk,[ae("div",fk,[ae("button",{class:"nmd-menu__button",onClick:i[0]||(i[0]=r=>Ke(e).hide())},[vt(Ke(A7))]),vt(Ke(R7),null,{default:zn(()=>[Ti(t.$slots,"default")]),_:3}),i[2]||(i[2]=ae("a",{href:"https://vip.udn.com/vip/order?from=Newmedia",class:"nmd-subscribe nmd-menu__subscribe",target:"_blank",rel:"noreferrer noopener","data-ga":"subscribe-menu"}," 訂閱數位版 ",-1))])])])):Ji("",!0)]),_:3}))}}),pk={class:"nmd-menu__list-item"},mk=["href"],gk=_t({name:"NmdMenuItem"}),_k=_t({...gk,props:{to:{},isCurrent:{type:Boolean,default:!1}},setup(n){const e=n;return(t,i)=>(lt(),pt("li",pk,[ae("a",{href:e.to,target:"_blank",rel:"noopener",class:On(["nmd-menu__link",{"nmd-menu__link--isCurrent":e.isCurrent}]),"data-ga":"menu-item"},[Ti(t.$slots,"default")],10,mk)]))}}),vk=_t({name:"NmdShareFacebook",components:{NmdIconFacebookSquare:KU}}),yk={class:"nmd-share-button nmd-shares__nmd-share-button",target:"_blank",rel:"noreferrer noopener"};function xk(n,e,t,i,r,s){const o=RM("nmd-icon-facebook-square");return lt(),pt("a",yk,[vt(o)])}const N7=Ar(vk,[["render",xk]]),bk=_t({name:"NmdShareLine",components:{NmdIconLineColorful:hO}}),wk={class:"nmd-share-button nmd-shares__nmd-share-button",rel:"noreferrer noopener"};function Sk(n,e,t,i,r,s){const o=RM("nmd-icon-line-colorful");return lt(),pt("a",wk,[vt(o)])}const P7=Ar(bk,[["render",Sk]]),Tk={class:"nmd-share-button nmd-shares__nmd-share-button",target:"_blank",rel:"noreferrer noopener"},Mk=_t({name:"NmdShareTwitter",components:{NmdIconTwitter:w7,NmdIconTwitterX:S7}}),L7=_t({...Mk,props:{twitterIcon:{default:"x"}},setup(n){return(e,t)=>(lt(),pt("a",Tk,[e.twitterIcon==="x"?(lt(),Ya(Ke(S7),{key:0})):Ji("",!0),e.twitterIcon==="bird"?(lt(),Ya(Ke(w7),{key:1})):Ji("",!0)]))}}),Ek={class:"nmd-shares"},Ck=_t({name:"NmdShare",components:{NmdShareFacebook:N7,NmdShareLine:P7,NmdShareTwitter:L7}}),Rk=_t({...Ck,props:{facebook:{default:()=>({href:"https://www.facebook.com/sharer/sharer.php?kid_directed_site=0&sdk=joey&u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&display=popup&ref=plugin&src=share_button"})},line:{default:()=>({href:"https://social-plugins.line.me/lineit/share?url=https%3A%2F%2Fline.me%2Fen",target:"_blank"})},twitter:{default:()=>({href:"https://twitter.com/intent/tweet?text=Hello%20world"})},twitterIcon:{default:"x"}},setup(n){const e=n;return(t,i)=>(lt(),pt("div",Ek,[vt(Ke(N7),l1({"data-ga":"share-facebook-bottom"},e.facebook),null,16),vt(Ke(P7),l1({"data-ga":"share-line-bottom"},e.line),null,16),vt(Ke(L7),l1({"data-ga":"share-twitter-bottom"},e.twitter,{"twitter-icon":e.twitterIcon}),null,16,["twitter-icon"])]))}}),Nk={class:"nmd-series__list-item"},Pk=["href"],Lk={class:"nmd-series__content"},Dk={class:"nmd-series__img"},Ik=_t({name:"NmdSeriesItem"});({...Ik});const Bk=_t({setup(n,{slots:e}){const{上線日期:t,...i}=e,r=Object.entries(i).map(([s,o])=>{let a;return o()[0].type===Zd&&(a=o()[0].children.split(/([、\s])/).map(A=>{switch(A){case"、":case" ":return A;default:return Ua("span",A)}})),[Ua("div",{class:"author-grid__item"},Ua("span",s)),Ua("div",{class:"author-grid__item"},a)]});return()=>Ua("div",{class:"author-grid"},[r,t?[Ua("span",{class:"author-grid__item"}),t()[0]]:null])}}),Fk=_t({name:"NmdToTop",components:{NmdIconArrow:f7}}),Uk=_t({...Fk,props:{duration:{}},setup(n){const e=n,t=_A(),{y:i}=Qg(t,{throttle:100}),r=Ln(!0);jr(i,o=>r.value=o===0);const s=()=>{Number.isNaN(e.duration)&&Nv.scrollTo(t),Nv.scrollTo(t,{duration:e.duration})};return(o,a)=>(lt(),Ya(U1,{name:"nmd-to-top"},{default:zn(()=>[yv(ae("button",{class:"nmd-to-top","data-ga":"go-top",onClick:s},[vt(Ke(f7),{width:"40px",height:"40px"})],512),[[Rv,!r.value]])]),_:1}))}}),Ok={class:"nmd-footer"},kk={class:"nmd-footer__links"},Vk={href:"https://bit.ly/317wi2M",target:"_blank",rel:"noreferrer noopener","aria-label":"udn's facebook",title:"udn's facebook","data-ga":"udn-facebook"},Gk={href:"https://bit.ly/2Q6gas5",target:"_blank",rel:"noreferrer noopener","aria-label":"udn's instagram",title:"udn's instagram","data-ga":"udn-instagram"},qk={href:"https://bit.ly/3hchIwv",target:"_blank",rel:"noreferrer noopener","aria-label":"udn's youtube",title:"udn's youtube","data-ga":"udn-youtube"},zk={href:"https://bit.ly/2XP6XZq",target:"_blank",rel:"noreferrer noopener","aria-label":"udn's line",title:"udn's line","data-ga":"udn-line"},Hk={class:"nmd-footer__copyright"},$k=_t({components:{NmdIconFacebookCircle:d7,NmdIconInstagram:g7,NmdIconLine:v7,NmdIconYoutube:T7}}),Wk=_t({...$k,__name:"index",setup(n){const e=new Date().getFullYear();return(t,i)=>(lt(),pt("div",Ok,[ae("div",kk,[ae("a",Vk,[vt(Ke(d7))]),ae("a",Gk,[vt(Ke(g7))]),ae("a",qk,[vt(Ke(T7))]),ae("a",zk,[vt(Ke(v7))])]),i[0]||(i[0]=ae("div",{class:"nmd-footer__nav"},[ae("a",{class:"footer__link",href:"https://vip.udn.com?from=footer_Newmedia",target:"_blank",rel:"noreferrer noopener"},"聯合報數位版"),Es(" ︱ "),ae("a",{class:"footer__link",href:"http://www.udngroup.com/members/udn_privacy?from=footer_Newmedia",target:"_blank",rel:"noreferrer noopener"},"隱私政策"),Es(" ︱ "),ae("a",{class:"footer__link",href:"http://www.udngroup.com/members/service?from=footer_Newmedia",target:"_blank",rel:"noreferrer noopener"},"服務協議")],-1)),ae("div",Hk," 聯合報系著作權所有 © 2020-"+Lt(Ke(e))+" All Rights Reserved ",1)]))}}),jk=_t({});({...jk});const Xk={class:"nmd-quote"},Qk=["src"],Yk={class:"quote"},Zk={class:"quote-title"},Kk=_t({});({...Kk});const Jk={key:0,width:"56",height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},eV={key:1,width:"56",height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},tV={key:2,width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg"},nV={key:3,width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg"},iV={key:4,width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg"},rV={key:5,width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg"},sV={key:6,width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg"},oV={key:7,width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg"},aV=_t({});({...aV});const lV={class:"nmd-single-graphics"},uV=["src"],cV={class:"graphics-text"},hV=_t({});({...hV});const fV={class:"nmd-pair-graphics"},AV=["src"],dV=["src"],pV={class:"graphics-text"},mV=_t({});({...mV});const gV=_t({name:"NmdDigitalLogo"}),_V={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 181 20",fill:"none"};function vV(n,e,t,i,r,s){return lt(),pt("svg",_V,e[0]||(e[0]=[jg('<path d="M75.2998 9.18523C75.1248 9.10098 71.7924 9.69914 70.909 9.74969C68.0927 9.93503 65.8623 9.0757 64.1218 8.24165C62.4949 7.44972 61.3229 6.19442 60.2208 4.9307C59.9672 4.63584 59.5648 4.40837 59.3637 4.0798C59.0138 3.49849 59.0838 2.43697 58.6202 1.94833L58.2966 1.75456L57.7631 1.71243L57.5969 1.80511C56.7135 2.24319 56.3374 3.60801 55.7251 4.31569C54.2732 5.9838 52.3402 7.40759 50.486 8.72186C49.3489 9.53064 48.0982 9.80866 46.209 10.0024C45.6754 10.053 44.8882 10.2636 44.1798 10.1372C43.62 10.0361 42.1243 9.32002 41.722 9.00831C41.5208 8.84823 41.4509 8.58707 41.2322 8.44384C40.9436 8.24165 40.4625 8.28377 40.1651 8.44384C39.6316 8.73029 39.3517 9.59804 39.2555 10.2383C39.1418 11.005 39.4042 11.6874 39.5179 12.2771C39.5966 12.6731 39.5704 13.0859 39.789 13.3639C40.8474 14.7456 43.7512 13.8526 45.3518 13.5577C45.7104 13.4819 46.3751 13.2039 46.8475 13.4145C47.3722 13.6419 46.9174 14.9478 46.795 15.2595C46.5238 15.9251 46.4101 17.5089 47.1011 17.8459L47.6171 17.9554C49.209 18.402 50.8184 17.8206 52.4627 17.6353C53.9409 17.4668 58.9351 17.3826 59.9322 17.4752C61.5328 17.6437 62.8798 17.7027 64.4454 17.9554C65.2763 18.0902 66.7982 18.5115 67.874 18.1913C69.5358 17.7027 67.909 14.9562 68.6787 13.8357L68.7224 13.7936C69.2472 13.4229 69.7108 13.8526 70.3842 13.8357C71.2327 13.8189 72.7283 13.583 73.3231 13.2207C73.7691 12.9595 74.1627 12.3361 74.5563 11.9991C74.775 11.7969 76.1569 9.58119 75.2998 9.20208V9.18523ZM55.4103 7.67719C55.7164 7.39074 56.2762 6.76731 56.7485 6.68306C58.0779 6.43032 58.8826 7.75301 59.4774 8.25007L59.3637 8.53652C58.4191 8.64604 55.5415 9.1431 54.6581 8.73029L54.5006 8.3933C54.7543 8.11528 55.1304 7.93836 55.4103 7.68561V7.67719ZM64.5591 15.0994L64.2355 15.4785C63.3958 15.7903 62.0139 15.5207 61.3929 15.4448C60.0809 15.3016 59.3724 15.5038 57.8243 15.4448C56.3811 15.3943 54.7193 15.4954 53.3111 15.7144C52.6551 15.8155 51.5268 15.8829 50.9233 15.6639C50.3723 15.4785 50.6434 14.4928 50.967 14.2485C51.4831 13.8694 53.4336 13.8863 54.3344 13.8189C55.4802 13.743 56.7747 13.6841 57.8155 13.7093C59.906 13.7515 62.8448 13.4397 64.2792 14.2991C64.5329 14.4507 64.664 14.754 64.5503 15.0994H64.5591ZM62.0488 11.7885C60.0109 11.9233 57.9467 11.7379 55.7864 11.8812C54.5181 11.9654 51.9904 12.3193 50.8621 11.9823H50.7571C49.8912 11.4936 51.2032 10.7944 51.6143 10.55L52.314 10.272C52.6376 10.2552 52.9175 10.7607 53.1712 10.7944C54.142 10.9544 55.419 10.5922 56.4861 10.6933C56.7747 10.7185 60.5357 10.3647 60.5532 10.3647C60.8593 10.2467 61.1567 9.74969 61.4628 9.69914C61.8914 9.61489 64.5241 11.1819 64.6378 11.6537C64.7778 12.176 62.9847 11.7211 62.0488 11.7801V11.7885Z" fill="white" data-v-de8f7c19></path><path d="M116.199 14.4342C115.569 14.2994 114.948 14.5859 114.484 14.628C113.286 14.7544 111.983 14.8723 110.959 14.7038C108.545 14.2994 106.429 13.4485 104.566 12.6398C104.111 12.4376 103.28 11.7889 103.193 11.6878V11.2244C103.665 10.3819 105.948 11.0053 107.006 10.7779C107.645 10.6431 108.266 10.4577 108.93 10.3903C109.438 10.3482 110.102 10.4156 110.47 10.2387C111.624 9.68266 109.997 7.48378 108.58 7.91345C107.994 8.09037 107.601 8.46949 107.102 8.61271C106.184 8.87388 103.674 9.40464 104.644 8.08194C104.942 7.66913 105.178 7.55961 105.668 7.29001C106.271 6.96987 107.085 6.56548 107.828 6.40541C108.397 6.27061 109 6.28746 109.473 6.06842C109.901 5.86622 110.513 5.03217 110.548 4.54353C110.592 3.76845 108.843 3.91167 107.924 4.02119C106.936 4.12229 105.703 4.32449 104.505 4.22339C103.385 4.13072 100.84 3.19556 99.5977 3.48201C99.3179 3.54098 99.1692 3.89482 98.9767 4.03804C98.7756 4.18969 98.347 4.33291 98.2945 4.59408C98.2071 5.04902 98.3382 5.68088 98.3732 6.19479C98.4345 7.08782 98.0584 6.75083 97.4024 6.54021C96.7289 6.32116 95.7318 6.37171 94.8396 6.46438L94.551 6.52336C93.9912 6.59076 93.0729 6.79295 92.3906 6.675C92.0495 6.6076 91.9621 6.08527 91.9883 6.08527C92.102 5.7567 92.0845 5.15012 92.4344 5.01532C92.6355 4.94792 92.8454 4.98162 93.1253 4.96477C94.7085 4.85525 95.8717 4.78785 96.4228 3.87797C96.6152 3.55783 96.5102 2.87542 96.1341 2.78275C94.9184 2.47946 93.6326 3.5831 92.4868 3.17871C91.6384 2.87542 92.1982 1.85602 92.2594 1.62013C92.5743 0.524903 91.9008 0.263734 90.7026 0.347982C89.8104 0.406955 89.9416 0.567027 89.5918 1.04724C89.4168 1.27471 89.2332 3.20399 89.4168 2.87542C88.8745 3.80215 86.7142 2.6311 85.2535 2.95967C84.8337 3.06077 84.51 3.77687 84.2302 4.02962C83.9503 4.28236 83.5654 4.64463 83.8453 5.09114C84.1514 5.56293 84.65 5.46183 85.3235 5.35231C86.4693 5.17539 89.5918 4.771 89.4256 5.91677C89.3644 6.34644 89.4168 6.78453 88.927 6.88562C87.4751 7.16364 84.5625 7.05412 83.0581 6.93617C82.3234 6.86877 81.6587 6.46438 80.8365 6.54021C80.373 6.57391 79.8569 6.83507 79.5945 7.05412C79.1659 7.39954 78.7549 8.12407 78.5187 8.57901C78.335 8.92442 78.5187 9.37094 78.9735 9.40464C79.4108 9.42991 79.8307 9.11819 80.2243 9.06765C81.7462 8.84018 83.7666 8.28414 85.6296 8.61271C85.9882 8.67168 86.2244 9.29511 86.0407 9.62368C85.9357 9.8006 85.341 9.9017 85.0698 9.95225C83.8191 10.1544 82.1135 9.53943 81.2039 10.2134C80.819 10.4914 80.6616 10.7442 80.5829 11.2749L80.5304 11.553C80.6004 11.8226 81.0639 11.9237 81.5013 11.9152C82.2097 11.8815 83.0056 11.6372 83.7141 11.5698C84.9124 11.4603 85.927 11.4603 87.134 11.4603C87.5888 11.4603 88.2448 11.376 88.6209 11.494C88.8221 11.5614 88.9095 11.7383 88.962 11.9573C89.0495 12.2859 88.997 12.6566 88.7958 12.8757C88.411 13.2885 84.1339 13.1284 83.1019 13.1958C81.4575 13.3053 80.8278 12.9009 79.9181 13.735C79.5595 14.0467 79.542 14.1731 79.8657 14.5101C80.0843 14.746 80.338 15.0577 80.7228 15.1503C82.1485 15.4873 84.5888 14.8639 85.8483 14.6954C86.2419 14.6364 88.5684 14.3416 88.8046 14.687C88.9445 14.8892 88.8308 15.2093 88.7521 15.3694C87.9299 17.1386 77.6703 15.6643 79.5508 18.4697C79.7782 18.7983 80.2505 19.2953 80.6966 19.4217C82.3759 19.9272 83.7753 19.0342 84.8424 18.7477C86.8016 18.2254 89.3731 18.3518 90.5276 17.2228C90.895 16.8606 91.0962 16.2456 91.1399 15.6558C91.1749 15.3188 91.1749 14.5522 91.2011 14.5353C91.4548 14.4679 91.5422 14.5522 91.8134 14.5522C93.5627 14.5438 95.1283 15.0914 96.0292 14.1478L96.3703 13.8361C97.1312 12.0921 92.1982 13.5328 91.2099 12.9094C91.3148 12.4628 91.1749 11.5782 91.6209 11.3929C92.7143 10.9127 95.9592 12.1595 96.5715 10.938C96.7027 10.6768 96.6939 10.4662 96.5102 10.2471C95.8805 9.45519 95.0321 9.82588 94.1749 9.34566C94.2099 9.00867 94.4198 8.46948 94.9009 8.37681C95.5831 8.25044 96.1779 8.43579 96.8338 8.36839C97.2099 8.31784 97.7697 8.0314 98.1983 8.12407C98.7406 8.23359 98.6619 10.6768 98.5919 11.2328C98.3382 13.1031 96.7814 17.8126 98.1808 19.2448C98.8368 19.9272 100.682 19.8851 100.332 18.6382C100.149 17.9642 99.9039 13.6507 100.595 13.3727C100.988 13.2126 101.05 13.3137 101.373 13.4148C102.117 13.676 102.711 14.4764 103.21 14.9734C103.822 15.58 105.747 16.8859 106.639 17.2397C107.024 17.3829 108.738 18.5792 109.403 18.8151C110.12 19.0763 110.968 18.7056 111.44 18.554C112.543 18.1833 114.344 16.65 115.175 15.976C115.464 15.7317 115.796 15.5295 116.076 15.2767C116.269 15.1166 116.785 14.5775 116.19 14.4511L116.199 14.4342ZM92.6443 8.92442C92.4344 9.11819 92.0233 9.40464 91.6822 9.48046C91.1749 9.59841 88.0524 9.7669 87.5801 9.55628C87.169 9.38779 87.6063 8.7812 87.7987 8.64641C88.1748 8.35154 89.1807 8.24202 89.8454 8.21674C90.4402 8.19147 91.1224 8.21674 91.7259 8.19147C92.6093 8.15777 93.379 8.19147 92.6355 8.92442H92.6443ZM101.137 9.72478C100.717 9.77533 100.726 9.78375 100.656 9.55628C100.586 9.31196 100.962 6.27904 101.05 6.24534C101.434 6.07684 103.026 6.01787 103.499 5.9926C104.006 5.9589 104.163 6.05999 104.417 6.21164C104.233 7.03727 103.551 7.58488 103.289 8.34311C103.184 8.64641 103.367 8.93285 103.184 9.16032C102.974 9.41306 101.531 9.68266 101.137 9.72478Z" fill="white" data-v-de8f7c19></path><path d="M30.9461 12.5384C30.9811 12.1003 30.9461 11.6622 31.1211 11.5106C31.4534 11.1904 32.1357 11.4347 32.9491 11.5443C33.3777 11.5948 33.6925 11.9402 34.3048 11.8307C35.9054 11.5695 32.8266 8.34285 32.7217 7.59304C32.5555 6.29562 34.8033 7.26447 35.0395 6.39672C35.3719 5.14985 34.1299 4.60224 33.6838 4.00408C33.0628 3.1616 31.882 -0.0987971 30.57 0.00230044C30.3339 0.0275748 30.0278 0.196071 29.8353 0.305593C28.777 0.870054 28.1997 1.65356 27.465 2.49604C27.2289 2.78248 26.8266 2.96783 26.5729 3.25427C26.223 3.63339 25.2259 5.45314 24.8236 5.55424H24.3688C23.3979 5.3689 22.4533 0.979577 20.8177 0.709983C20.4329 0.642585 20.0305 0.743683 19.8031 0.853205C18.4999 1.46822 17.494 3.00153 16.3045 3.84401C16.0596 4.02093 15.8934 4.2821 15.5698 4.40004C15.185 4.54327 14.5552 4.62751 14.2229 4.54327L14.1092 4.29895L14.1616 4.19785C14.1616 3.35537 14.1616 2.63084 13.6019 2.30227C12.7884 1.83891 11.5115 2.18432 10.4969 2.26015C10.0071 2.28542 9.61346 2.12535 9.25486 2.10007C8.57263 2.05795 7.84667 2.26857 7.05074 2.20117C5.99242 2.1085 4.72418 2.08323 3.61337 1.99898C2.52006 1.93158 1.95154 2.03268 1.40926 2.55501C1.21684 2.74878 0.945695 2.9931 0.788258 3.20372C0.455892 3.67551 0.762019 5.86596 0.840737 6.49782C0.971935 7.52564 0.700794 8.75566 0.613329 9.79191C0.543357 10.6512 0.167258 11.1315 0.0535535 11.8307C-0.156362 13.0944 0.280962 14.1981 0.840737 14.8299L1.12937 15.0321C1.3043 15.0995 1.70664 15.1164 1.96903 15.0743C2.60753 15.0069 11.6864 13.145 9.97207 15.0743C9.76215 15.3102 9.38605 15.5461 9.07118 15.6808C8.46767 15.9252 7.68924 15.8578 6.92829 15.9757C5.46763 16.2032 3.11482 16.0937 2.08274 16.7255L1.96903 16.7761C1.63667 16.9446 1.21684 17.2984 1.00692 17.5764C0.779512 17.8881 0.403413 19.7921 1.00692 19.9691C1.33929 20.0702 1.73288 19.8932 1.96903 19.868C3.90201 19.691 5.13526 19.253 6.64841 18.8654C8.04784 18.5032 9.43853 18.4526 10.6018 17.9218C11.3015 17.5933 12.1587 16.7676 12.5698 16.1695C13.0246 15.5124 13.6281 14.5098 13.7506 13.6757C13.803 13.3303 13.6456 12.9091 13.7506 12.5805L13.8643 12.4205C14.0567 12.2857 14.6864 12.2857 15.045 12.3194C17.669 12.6142 15.2987 13.9285 14.7651 14.4677L14.4853 14.8721C13.8643 16.0852 15.4649 17.9892 16.3395 17.1636C16.978 16.557 16.5932 15.2006 16.5057 14.2234L16.5582 13.8695C16.6369 13.4146 16.5844 12.9175 16.7331 12.4205C16.908 11.8644 18.5524 11.9487 19.0422 11.9739C19.7506 12.0161 20.5728 11.9402 21.1238 12.1677C21.7711 12.4373 20.4766 14.0127 20.223 14.4677C19.9168 15.0237 19.3658 15.9252 19.8294 16.7171C20.4241 17.7618 21.6836 17.0709 21.8585 16.1695C22.0335 15.268 21.6836 14.3329 21.7448 13.4314C21.8061 12.5721 22.1297 12.0329 22.9256 11.8223C23.5116 11.6706 24.4213 11.7212 25.2434 11.8813C26.433 12.1256 24.8936 13.6083 24.7974 13.979C24.4125 15.4281 24.4213 17.2563 24.5087 17.4669C24.7186 17.9303 25.5583 18.2841 26.2056 17.8713C27.1677 17.2394 26.4417 13.8779 26.2668 12.8754C26.2056 12.5805 25.8207 11.9318 26.1006 11.5358C26.3018 11.2157 28.0948 11.3842 28.6371 11.3842C28.0423 11.401 29.4505 11.3674 29.5904 11.3842C30.9549 11.519 30.1677 13.1029 29.8703 13.7768C29.4855 14.6699 28.7945 18.1914 30.2639 18.4695C30.5788 18.5369 30.8937 18.3936 31.1036 18.3684C31.8383 18.2841 32.0832 18.1409 32.5205 17.8292C33.5089 17.0878 33.85 15.7314 34.8296 14.9732C35.022 14.8299 35.6605 14.4677 35.7655 14.2739C36.5002 12.9681 30.7712 14.6783 30.9112 12.53L30.9461 12.5384ZM10.3307 12.0919C9.59597 12.4963 6.47348 12.0919 5.25771 12.2435C4.87287 12.2857 4.27811 12.6395 3.72708 12.4963C3.25477 12.3531 3.44719 11.2578 3.7883 11.0978C4.47928 10.7523 5.94869 10.7692 6.83208 10.6934C7.74172 10.6175 10.0333 10.8029 10.3919 11.241C10.5668 11.4769 10.6455 11.915 10.3307 12.0919ZM10.1645 9.4465C9.62221 9.55602 8.93124 9.47177 8.47642 9.4465C6.99826 9.3454 5.2927 9.4128 3.96323 9.58972C3.77081 9.3454 3.72708 9.3117 3.84953 8.99156C4.03321 8.51977 4.33933 8.44395 4.92535 8.34285C5.59883 8.20805 6.63091 8.07326 7.4006 8.03956C8.10032 8.02271 10.252 8.21648 10.5056 8.54504C10.768 8.87361 10.5231 9.36225 10.1645 9.4465ZM10.8467 6.1524L10.5056 6.54837C9.46477 6.86008 8.03035 6.3883 6.89331 6.49782C6.30729 6.55679 5.38891 6.91063 4.63671 6.70001C4.30435 6.59892 4.30435 6.11028 4.34808 5.79856C4.41805 5.39417 4.5405 4.9982 4.9166 4.89711C5.24022 4.81286 10.4356 5.17513 10.7155 5.3015C11.0304 5.42787 10.9429 5.89123 10.8292 6.1524H10.8467ZM16.0771 8.57874C15.8147 9.20218 15.1762 9.93513 14.5115 10.1458C13.2258 10.5333 13.5844 8.26703 14.0042 8.14908C14.3628 8.03956 14.8614 8.21648 15.1325 8.24175C15.6136 8.30072 15.806 8.34285 16.0946 8.55347V8.58717L16.0771 8.57874ZM19.1209 10.2384C18.2288 10.3311 17.739 10.3227 17.5903 10.0362C17.3104 9.46335 18.3075 8.2586 19.0072 8.1912C20.809 8.01428 21.7448 9.94356 19.1209 10.2384ZM17.7127 6.14398C17.2666 5.96706 17.6515 5.49527 17.8264 5.29307C18.0276 5.05718 18.2812 4.85498 18.4999 4.64436C18.7186 4.42532 19.2084 4.08833 19.5757 4.0462C20.1705 3.97038 21.1763 4.96451 21.0451 5.49527C20.9577 5.85753 18.3512 6.37987 17.7215 6.14398H17.7127ZM25.2085 9.08423C24.8936 9.43807 24.5437 10.4153 23.9664 10.4827L23.8003 10.4322C23.5379 10.3648 23.3717 10.3058 23.2317 10.1373C22.8994 9.72451 22.8469 9.22745 22.6107 8.73881C22.4358 8.37655 21.6924 8.03956 21.7623 7.53407C21.8585 6.93591 23.4154 6.93591 24.1326 6.88536C24.9461 6.83481 25.5496 7.037 26.1093 7.18865C26.5904 7.31502 26.9403 7.3066 26.9053 7.70256C26.8703 8.09853 25.5321 8.73039 25.2085 9.08423ZM29.2756 3.04365C30.2464 2.87516 31.4272 3.88613 31.2435 4.59381C31.1561 4.93081 30.0977 5.20882 29.7216 5.3015C28.812 5.50369 28.1823 5.41944 27.9723 5.2004C27.4476 4.63594 28.8557 3.1279 29.2668 3.04365H29.2756ZM30.6575 9.21903C30.5875 9.46335 30.2202 9.58129 29.6692 9.64027C28.6458 9.74136 28.0948 9.70767 27.9636 9.39595C27.7099 8.78936 28.7858 7.56777 29.0482 7.53407C29.5292 7.47509 30.8324 8.57032 30.6575 9.21903Z" fill="white" data-v-de8f7c19></path><path d="M135.388 14.1954V14.5661L136.507 14.4987L136.49 15.1727L135.3 15.2401C135.134 16.0573 134.714 16.9166 133.612 17.7338C134.434 18.0877 135.186 18.4583 135.764 18.7785L135.143 19.3261C134.574 18.9723 133.787 18.5847 132.904 18.1972C131.749 18.8122 130.113 19.4188 127.726 19.8737C127.656 19.6799 127.472 19.4356 127.323 19.2755C129.475 18.8712 130.979 18.3741 132.046 17.8265C131.058 17.4221 129.991 17.0346 129.02 16.7818C129.335 16.4111 129.667 16.0067 129.991 15.5434L127.551 15.6697L127.437 14.9452C128.303 14.9115 129.344 14.8778 130.489 14.802C130.857 14.2881 131.189 13.7573 131.46 13.2434H128.303V10.539H131.88V9.67128H128.828V7.69145H127.656V6.98377H128.828V5.16401H131.88V3.85817H132.632V5.16401H135.869V6.98377H137.137V7.69145H135.869V9.67128H132.632V10.539H136.341V13.2434H132.352C132.099 13.7405 131.766 14.2544 131.452 14.7683C132.44 14.7177 133.525 14.6588 134.609 14.6082C134.627 14.465 134.627 14.3218 134.627 14.2038V13.6394H135.396V14.2038L135.388 14.1954ZM129.073 12.5863H131.863V11.2046H129.073V12.5863ZM129.606 5.82957V7.00062H131.863V5.82957H129.606ZM131.863 8.9973V7.6746H129.606V8.9973H131.863ZM130.927 15.4928C130.673 15.8298 130.454 16.15 130.21 16.4448C131.058 16.6891 131.95 17.0261 132.799 17.38C133.848 16.6891 134.285 15.9646 134.487 15.2906L130.927 15.4844V15.4928ZM132.615 5.838V7.00904H135.038V5.838H132.615ZM135.038 9.00572V7.68303H132.615V9.00572H135.038ZM132.615 11.213V12.5947H135.519V11.213H132.615ZM142.603 8.09584C142.253 10.7834 141.764 13.0833 140.933 14.9958C141.737 16.7818 142.787 18.1972 144.125 19.0481C143.924 19.1913 143.688 19.4525 143.539 19.6884C142.271 18.8206 141.283 17.5316 140.513 15.9056C139.682 17.5485 138.606 18.8796 137.154 19.9748C137.067 19.8147 136.787 19.4609 136.621 19.3008C138.178 18.2225 139.297 16.7734 140.093 14.9873C139.428 13.395 138.956 11.5584 138.606 9.59546C138.274 10.4969 137.889 11.3141 137.469 12.0049C137.32 11.8617 136.971 11.6006 136.769 11.4742C137.976 9.65443 138.737 6.8911 139.21 4.04351L140.032 4.16989C139.831 5.24826 139.595 6.30979 139.332 7.33761H143.924V8.11269H142.603V8.09584ZM139.096 8.12954C139.411 10.2357 139.848 12.2324 140.495 13.9679C141.116 12.2661 141.501 10.3031 141.781 8.09584H139.122L139.105 8.12954H139.096Z" fill="white" data-v-de8f7c19></path><path d="M151.35 4.12766C150.816 5.45035 150.143 6.74777 149.382 7.96937V19.8399H148.498V9.30891C147.799 10.303 147.064 11.2045 146.277 11.9459C146.207 11.769 145.909 11.3477 145.726 11.1876C147.632 9.40158 149.417 6.68037 150.501 3.90019L151.341 4.12766H151.35ZM162.423 18.2982V19.1154H150.93V18.2982H157.411C158.128 15.8718 158.915 11.9122 159.335 9.20781L160.254 9.38474C159.755 12.1481 158.95 15.8803 158.251 18.2982H162.423ZM161.6 8.00307H151.796V7.16901H161.6V8.00307ZM154.437 17.2703C154.253 15.4169 153.702 12.0722 153.081 9.56166L153.886 9.40158C154.525 11.9459 155.119 15.2231 155.32 17.026L154.437 17.2703ZM156.493 6.81517C156.326 6.07379 155.941 4.90274 155.609 4.00129L156.414 3.77382C156.746 4.67527 157.166 5.82947 157.332 6.57085L156.484 6.81517H156.493Z" fill="white" data-v-de8f7c19></path><path d="M169.271 4.28781H170.101V10.1093H166.244V11.1877C166.244 11.6258 166.244 12.106 166.227 12.5525H170.084V19.8568H169.262V13.3276H166.209C166.113 15.695 165.824 18.0708 164.958 20.0001C164.81 19.84 164.477 19.6294 164.259 19.5198C165.273 17.1103 165.413 13.9847 165.413 11.2046V3.84972H166.235V9.31741H169.262V4.28781H169.271ZM180.212 9.38481C179.714 12.3251 178.69 14.6587 177.326 16.4279C178.297 17.6495 179.513 18.5678 180.982 19.1323C180.781 19.3092 180.518 19.6294 180.361 19.84C178.927 19.225 177.755 18.2814 176.801 17.1188C175.717 18.3404 174.483 19.2418 173.163 19.8821C173.058 19.6715 172.795 19.3513 172.629 19.1913C173.95 18.6268 175.218 17.6917 176.268 16.4111C175.096 14.6924 174.3 12.5357 173.766 10.0419H173.084V11.3646C173.084 14.2291 172.883 17.4136 171.527 19.8568C171.361 19.7305 171.046 19.503 170.81 19.3935C172.078 17.0766 172.244 14.0016 172.244 11.3646V4.92809H180.247V5.72002H173.084V9.24159H179.513L179.679 9.20789L180.212 9.38481ZM174.553 10.0419C175.034 12.2155 175.752 14.1617 176.81 15.7371C177.93 14.2375 178.778 12.3251 179.233 10.0419H174.553Z" fill="white" data-v-de8f7c19></path>',6)]))}const yV=Ar(gV,[["render",vV],["__scopeId","data-v-de8f7c19"]]),xV=["href"],bV=["href"],wV=_t({name:"NmdDigitalHeader"});({...wV});const SV={class:"nmd-service","data-ga":"section-web_features"},TV={class:"nmd-service-container"},MV=_t({name:"NmdService"});({...MV});const EV={class:"nmd-service-arrow-circle"},CV={key:0,class:"nmd-service-svg",width:"43px",height:"43px",viewBox:"0 0 100 100"},RV=_t({name:"NmdServiceArrowCircle",components:{NmdIconArrowRight:M7}}),D7=_t({...RV,props:{hover:{type:Boolean,default:!0}},setup(n){return(e,t)=>(lt(),pt("span",EV,[vt(Ke(M7),{class:"nmd-service-arrow"}),e.hover?(lt(),pt("svg",CV,t[0]||(t[0]=[ae("circle",{class:"nmd-service-circle",cx:"50",cy:"50",r:"48","stroke-width":"3",fill:"none"},null,-1)]))):Ji("",!0)]))}}),NV={class:"nmd-service-list"},PV=["href"],LV={class:"nmd-service-card-header"},DV={class:"nmd-service-card-title"},IV={class:"nmd-service-card-content"},BV=[{title:"電子報",content:"新聞不漏接。訂閱電子報，最新報導、專欄、評論，直接寄到信箱。",href:"https://vip.udn.com/member/mynews/epaper"},{title:"我的追蹤",content:"最愛的新聞欄目、喜歡的記者觀點，透過「追蹤」功能節省查找時間。",href:"https://vip.udn.com/vip/story/122037/6208772"},{title:"好友試閱",content:"重要新聞不能只有我看到。透過「好友試閱」功能，讓親朋好友免費看。",href:"https://vip.udn.com/vip/story/122037/7480959"},{title:"閱讀紀錄",content:"新聞閱讀軌跡、看最多的新聞關鍵字，系統自動整理分析。",href:"https://vip.udn.com/vip/story/122037/8502671"},{title:"任務徽章",content:"達成閱讀目標、解鎖成就徽章，展現個人閱讀歷程。",href:"https://vip.udn.com/vip/story/122037/8357783"},{title:"電子書",content:"錯過精彩報導不用怕，聯合報數位版定期將精彩內容集結成電子書。",href:"https://reading.udn.com/store/store/store_search.do?k_type=b&k=%E8%81%AF%E5%90%88%E5%A0%B1%E6%96%B0%E8%81%9E%E9%83%A8"}],FV=_t({name:"NmdServiceList",components:{NmdServiceArrowCircle:D7}});({...FV});const UV="新太空時代：地緣角力、國安戰場、商業版圖 誰將搶占宇宙藍海? | 專題 | 聯合報",OV="2035年，太空經濟規模將達1.8兆美元，年均成長率遠高於全球GDP成長速度；美中每年發射上百顆國防衛星，地緣衝突延伸至宇宙。從經濟版圖到國安防線，太空儼然成為全球競逐新戰場，台灣憑藉半導體和資通訊產業基礎，積極搶灘全球供應鏈，每一步選擇，攸關國安與產業未來。",kV="https://vip.udn.com/newmedia/2025/newspaceera",xx={metaTitle:UV,metaDesc:OV,metaURL:kV};function VV(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}const GV=xx.metaTitle,qV=xx.metaDesc,zV=xx.metaURL,HV=encodeURI(GV),$V=encodeURI(qV),nd=encodeURI(zV),WV=`${HV}%0D%0A%0D%0A${$V}`,I7=VV()?`https://line.naver.jp/R/msg/text/?${nd}`:`https://social-plugins.line.me/lineit/share?url=${nd}`,B7=`https://www.facebook.com/dialog/share?app_id=1010324812347164&display=popup&href=${nd}&redirect_uri=${nd}`,F7=`https://twitter.com/intent/tweet/?text=${WV}%0D%0A%0D%0A${nd}`,jV="更多相關報導",XV="https://vip.udn.com/search/tagging/8799/%E8%A7%A3%E5%AF%86%E5%A4%AA%E7%A9%BA",QV="更多數位專題",YV="https://udn.com/newmedia/office/",Op={navbarMenu1Text:jV,navbarMenu1Link:XV,navbarMenu2Text:QV,navbarMenu2Link:YV},ZV={class:"ls-header"},KV={__name:"leo-navbar",setup(n){const e=[{title:Op.navbarMenu1Text,link:Op.navbarMenu1Link},{title:Op.navbarMenu2Text,link:Op.navbarMenu2Link}];return(t,i)=>(lt(),pt("div",ZV,[vt(Ke(zO)),vt(Ke(YO),null,{default:zn(()=>[vt(Ke(nk),{facebook:{href:Ke(B7)},line:{href:Ke(I7),target:"_blank"},twitter:{href:Ke(F7)}},null,8,["facebook","line","twitter"]),vt(Ke(rk))]),_:1}),vt(Ke(dk),null,{default:zn(()=>[(lt(),pt(Di,null,Xc(e,(r,s)=>vt(Ke(_k),{key:s,to:r.link},{default:zn(()=>[Es(Lt(r.title),1)]),_:2},1032,["to"])),64))]),_:1})]))}},JV="洪欣慈、林雨荷",eG="洪欣慈、林雨荷、許珮絨",tG="林澔一、黃仲裕、　路透、美聯社、　法新社、歐新社、聯合報系資料照",nG="薛羽涵、蘇韋豪",iG="楊若榆、周融聖",rG="范凌嘉、林秀姿、董谷音、潘如瑩",sG="聯合報新聞部",oG="2025.06",ou={editor1:JV,editor2:eG,editor3:tG,editor4:nG,editor5:iG,editor6:rG,editor7:sG,editor8:oG},aG={id:"editor",class:"leo-footer"},lG={class:"leo-footer__info"},uG={__name:"leo-footer",setup(n){const e=new Date().getFullYear();return(t,i)=>(lt(),pt("div",aG,[ae("div",lG,[vt(Ke(Bk),null,{統籌製作:zn(()=>[Es(Lt(Ke(ou).editor1),1)]),採訪撰稿:zn(()=>[Es(Lt(Ke(ou).editor2),1)]),影像:zn(()=>[Es(Lt(Ke(ou).editor3),1)]),視覺設計:zn(()=>[Es(Lt(Ke(ou).editor4),1)]),工程:zn(()=>[Es(Lt(Ke(ou).editor5),1)]),監製:zn(()=>[Es(Lt(Ke(ou).editor6),1)]),製作單位:zn(()=>[Es(Lt(Ke(ou).editor7),1)]),上線日期:zn(()=>[Es(Lt(Ke(ou).editor8),1)]),_:1}),vt(Ke(Rk),{facebook:{href:Ke(B7)},line:{href:Ke(I7),target:"_blank"},twitter:{href:Ke(F7)},"twitter-icon":"x"},null,8,["facebook","line","twitter"])]),vt(Ke(Uk)),vt(Ke(Wk),{year:Ke(e)},null,8,["year"])]))}};/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const ep="176",w1e={ROTATE:0,DOLLY:1,PAN:2},S1e={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},U7=0,Pv=1,O7=2,cG=0,bx=1,hG=2,co=3,Xs=0,_i=1,_r=2,vo=0,Fs=1,Qc=2,Vf=3,Gf=4,Cf=5,cs=100,wx=101,Sx=102,k7=103,V7=104,xl=200,Tx=201,Mx=202,Ex=203,id=204,rd=205,Cx=206,Rx=207,Nx=208,Px=209,Lx=210,fG=211,AG=212,dG=213,pG=214,sd=0,od=1,ad=2,Ou=3,ld=4,ud=5,cd=6,hd=7,tp=0,G7=1,q7=2,Qs=0,z7=1,H7=2,$7=3,W7=4,mG=5,j7=6,X7=7,Dx=300,ga=301,_a=302,Yc=303,Zc=304,Kc=306,Jc=1e3,qa=1001,eh=1002,Mi=1003,Ix=1004,Pl=1005,Tr=1006,Rf=1007,zs=1008,gG=1008,ji=1009,Uc=1010,Oc=1011,sa=1012,Ir=1013,bi=1014,lr=1015,Mr=1016,Yg=1017,Zg=1018,yo=1020,Kg=35902,Bx=1021,np=1022,ir=1023,xo=1026,bo=1027,ip=1028,vA=1029,Ll=1030,yA=1031,_G=1032,xA=1033,kc=33776,Nu=33777,Pu=33778,Lu=33779,fd=35840,Ad=35841,dd=35842,pd=35843,md=36196,qf=37492,zf=37496,Hf=37808,$f=37809,Wf=37810,jf=37811,Xf=37812,Qf=37813,Yf=37814,Zf=37815,Kf=37816,Jf=37817,eA=37818,tA=37819,nA=37820,iA=37821,Vc=36492,Lv=36494,Dv=36495,Fx=36283,gd=36284,_d=36285,vd=36286,vG=0,yG=1,E8=2,xG=3200,bG=3201,Ol=0,Q7=1,go="",Ht="srgb",ha="srgb-linear",V1="linear",oi="srgb",wG=0,bc=7680,SG=7681,TG=7682,MG=7683,EG=34055,CG=34056,RG=5386,NG=512,PG=513,LG=514,DG=515,IG=516,BG=517,FG=518,Iv=519,Ux=512,Jg=513,Ox=514,e2=515,kx=516,Vx=517,Gx=518,qx=519,G1=35044,cf=35048,C8="300 es",Is=2e3,Za=2001;class sl{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners;if(i===void 0)return;const r=i[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const i=t[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const rs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let R8=1234567;const F0=Math.PI/180,th=180/Math.PI;function Ha(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(rs[n&255]+rs[n>>8&255]+rs[n>>16&255]+rs[n>>24&255]+"-"+rs[e&255]+rs[e>>8&255]+"-"+rs[e>>16&15|64]+rs[e>>24&255]+"-"+rs[t&63|128]+rs[t>>8&255]+"-"+rs[t>>16&255]+rs[t>>24&255]+rs[i&255]+rs[i>>8&255]+rs[i>>16&255]+rs[i>>24&255]).toLowerCase()}function En(n,e,t){return Math.max(e,Math.min(t,n))}function zx(n,e){return(n%e+e)%e}function UG(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function OG(n,e,t){return n!==e?(t-n)/(e-n):0}function U0(n,e,t){return(1-t)*n+t*e}function kG(n,e,t,i){return U0(n,e,1-Math.exp(-t*i))}function VG(n,e=1){return e-Math.abs(zx(n,e*2)-e)}function GG(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function qG(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function zG(n,e){return n+Math.floor(Math.random()*(e-n+1))}function HG(n,e){return n+Math.random()*(e-n)}function $G(n){return n*(.5-Math.random())}function WG(n){n!==void 0&&(R8=n);let e=R8+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function jG(n){return n*F0}function XG(n){return n*th}function QG(n){return(n&n-1)===0&&n!==0}function YG(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function ZG(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function KG(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+i)/2),A=o((e+i)/2),p=s((e-i)/2),g=o((e-i)/2),v=s((i-e)/2),x=o((i-e)/2);switch(r){case"XYX":n.set(a*A,l*p,l*g,a*u);break;case"YZY":n.set(l*g,a*A,l*p,a*u);break;case"ZXZ":n.set(l*p,l*g,a*A,a*u);break;case"XZX":n.set(a*A,l*x,l*v,a*u);break;case"YXY":n.set(l*v,a*A,l*x,a*u);break;case"ZYZ":n.set(l*x,l*v,a*A,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Ds(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Cn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const Hx={DEG2RAD:F0,RAD2DEG:th,generateUUID:Ha,clamp:En,euclideanModulo:zx,mapLinear:UG,inverseLerp:OG,lerp:U0,damp:kG,pingpong:VG,smoothstep:GG,smootherstep:qG,randInt:zG,randFloat:HG,randFloatSpread:$G,seededRandom:WG,degToRad:jG,radToDeg:XG,isPowerOfTwo:QG,ceilPowerOfTwo:YG,floorPowerOfTwo:ZG,setQuaternionFromProperEuler:KG,normalize:Cn,denormalize:Ds};class at{constructor(e=0,t=0){at.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=En(this.x,e.x,t.x),this.y=En(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=En(this.x,e,t),this.y=En(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(En(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(En(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class dn{constructor(e,t,i,r,s,o,a,l,u){dn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u)}set(e,t,i,r,s,o,a,l,u){const A=this.elements;return A[0]=e,A[1]=r,A[2]=a,A[3]=t,A[4]=s,A[5]=l,A[6]=i,A[7]=o,A[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],u=i[1],A=i[4],p=i[7],g=i[2],v=i[5],x=i[8],S=r[0],T=r[3],w=r[6],R=r[1],E=r[4],N=r[7],D=r[2],B=r[5],I=r[8];return s[0]=o*S+a*R+l*D,s[3]=o*T+a*E+l*B,s[6]=o*w+a*N+l*I,s[1]=u*S+A*R+p*D,s[4]=u*T+A*E+p*B,s[7]=u*w+A*N+p*I,s[2]=g*S+v*R+x*D,s[5]=g*T+v*E+x*B,s[8]=g*w+v*N+x*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],A=e[8];return t*o*A-t*a*u-i*s*A+i*a*l+r*s*u-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],A=e[8],p=A*o-a*u,g=a*l-A*s,v=u*s-o*l,x=t*p+i*g+r*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const S=1/x;return e[0]=p*S,e[1]=(r*u-A*i)*S,e[2]=(a*i-r*o)*S,e[3]=g*S,e[4]=(A*t-r*l)*S,e[5]=(r*s-a*t)*S,e[6]=v*S,e[7]=(i*l-u*t)*S,e[8]=(o*t-i*s)*S,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(i*l,i*u,-i*(l*o+u*a)+o+e,-r*u,r*l,-r*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(D_.makeScale(e,t)),this}rotate(e){return this.premultiply(D_.makeRotation(-e)),this}translate(e,t){return this.premultiply(D_.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const D_=new dn;function $x(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function yd(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Y7(){const n=yd("canvas");return n.style.display="block",n}const N8={};function fa(n){n in N8||(N8[n]=!0,console.warn(n))}function JG(n,e,t){return new Promise(function(i,r){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:i()}}setTimeout(s,t)})}function eq(n){const e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function tq(n){const e=n.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const P8=new dn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),L8=new dn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function nq(){const n={enabled:!0,workingColorSpace:ha,spaces:{},convert:function(r,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===oi&&(r.r=Dl(r.r),r.g=Dl(r.g),r.b=Dl(r.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===oi&&(r.r=Nf(r.r),r.g=Nf(r.g),r.b=Nf(r.b))),r},fromWorkingColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},toWorkingColorSpace:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===go?V1:this.spaces[r].transfer},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,o){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[ha]:{primaries:e,whitePoint:i,transfer:V1,toXYZ:P8,fromXYZ:L8,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Ht},outputColorSpaceConfig:{drawingBufferColorSpace:Ht}},[Ht]:{primaries:e,whitePoint:i,transfer:oi,toXYZ:P8,fromXYZ:L8,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Ht}}}),n}const Rn=nq();function Dl(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Nf(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Mh;class iq{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Mh===void 0&&(Mh=yd("canvas")),Mh.width=e.width,Mh.height=e.height;const r=Mh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=Mh}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=yd("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Dl(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Dl(t[i]/255)*255):t[i]=Dl(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let rq=0;class Wx{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:rq++}),this.uuid=Ha(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(I_(r[o].image)):s.push(I_(r[o]))}else s=I_(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function I_(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?iq.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let sq=0;class vr extends sl{constructor(e=vr.DEFAULT_IMAGE,t=vr.DEFAULT_MAPPING,i=qa,r=qa,s=Tr,o=zs,a=ir,l=ji,u=vr.DEFAULT_ANISOTROPY,A=go){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:sq++}),this.uuid=Ha(),this.name="",this.source=new Wx(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new at(0,0),this.repeat=new at(1,1),this.center=new at(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new dn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=A,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Dx)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Jc:e.x=e.x-Math.floor(e.x);break;case qa:e.x=e.x<0?0:1;break;case eh:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Jc:e.y=e.y-Math.floor(e.y);break;case qa:e.y=e.y<0?0:1;break;case eh:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}vr.DEFAULT_IMAGE=null;vr.DEFAULT_MAPPING=Dx;vr.DEFAULT_ANISOTROPY=1;class $t{constructor(e=0,t=0,i=0,r=1){$t.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,u=l[0],A=l[4],p=l[8],g=l[1],v=l[5],x=l[9],S=l[2],T=l[6],w=l[10];if(Math.abs(A-g)<.01&&Math.abs(p-S)<.01&&Math.abs(x-T)<.01){if(Math.abs(A+g)<.1&&Math.abs(p+S)<.1&&Math.abs(x+T)<.1&&Math.abs(u+v+w-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const E=(u+1)/2,N=(v+1)/2,D=(w+1)/2,B=(A+g)/4,I=(p+S)/4,O=(x+T)/4;return E>N&&E>D?E<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(E),r=B/i,s=I/i):N>D?N<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(N),i=B/r,s=O/r):D<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(D),i=I/s,r=O/s),this.set(i,r,s,t),this}let R=Math.sqrt((T-x)*(T-x)+(p-S)*(p-S)+(g-A)*(g-A));return Math.abs(R)<.001&&(R=1),this.x=(T-x)/R,this.y=(p-S)/R,this.z=(g-A)/R,this.w=Math.acos((u+v+w-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=En(this.x,e.x,t.x),this.y=En(this.y,e.y,t.y),this.z=En(this.z,e.z,t.z),this.w=En(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=En(this.x,e,t),this.y=En(this.y,e,t),this.z=En(this.z,e,t),this.w=En(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(En(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ol extends sl{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=i.depth?i.depth:1,this.scissor=new $t(0,0,e,t),this.scissorTest=!1,this.viewport=new $t(0,0,e,t);const r={width:e,height:t,depth:this.depth};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Tr,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},i);const s=new vr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const o=i.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,i=e.textures.length;t<i;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new Wx(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class nh extends ol{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class t2 extends vr{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Mi,this.minFilter=Mi,this.wrapR=qa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class oq extends vr{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Mi,this.minFilter=Mi,this.wrapR=qa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class bA{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],u=i[r+1],A=i[r+2],p=i[r+3];const g=s[o+0],v=s[o+1],x=s[o+2],S=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=A,e[t+3]=p;return}if(a===1){e[t+0]=g,e[t+1]=v,e[t+2]=x,e[t+3]=S;return}if(p!==S||l!==g||u!==v||A!==x){let T=1-a;const w=l*g+u*v+A*x+p*S,R=w>=0?1:-1,E=1-w*w;if(E>Number.EPSILON){const D=Math.sqrt(E),B=Math.atan2(D,w*R);T=Math.sin(T*B)/D,a=Math.sin(a*B)/D}const N=a*R;if(l=l*T+g*N,u=u*T+v*N,A=A*T+x*N,p=p*T+S*N,T===1-a){const D=1/Math.sqrt(l*l+u*u+A*A+p*p);l*=D,u*=D,A*=D,p*=D}}e[t]=l,e[t+1]=u,e[t+2]=A,e[t+3]=p}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],u=i[r+2],A=i[r+3],p=s[o],g=s[o+1],v=s[o+2],x=s[o+3];return e[t]=a*x+A*p+l*v-u*g,e[t+1]=l*x+A*g+u*p-a*v,e[t+2]=u*x+A*v+a*g-l*p,e[t+3]=A*x-a*p-l*g-u*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(i/2),A=a(r/2),p=a(s/2),g=l(i/2),v=l(r/2),x=l(s/2);switch(o){case"XYZ":this._x=g*A*p+u*v*x,this._y=u*v*p-g*A*x,this._z=u*A*x+g*v*p,this._w=u*A*p-g*v*x;break;case"YXZ":this._x=g*A*p+u*v*x,this._y=u*v*p-g*A*x,this._z=u*A*x-g*v*p,this._w=u*A*p+g*v*x;break;case"ZXY":this._x=g*A*p-u*v*x,this._y=u*v*p+g*A*x,this._z=u*A*x+g*v*p,this._w=u*A*p-g*v*x;break;case"ZYX":this._x=g*A*p-u*v*x,this._y=u*v*p+g*A*x,this._z=u*A*x-g*v*p,this._w=u*A*p+g*v*x;break;case"YZX":this._x=g*A*p+u*v*x,this._y=u*v*p+g*A*x,this._z=u*A*x-g*v*p,this._w=u*A*p-g*v*x;break;case"XZY":this._x=g*A*p-u*v*x,this._y=u*v*p-g*A*x,this._z=u*A*x+g*v*p,this._w=u*A*p+g*v*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],A=t[6],p=t[10],g=i+a+p;if(g>0){const v=.5/Math.sqrt(g+1);this._w=.25/v,this._x=(A-l)*v,this._y=(s-u)*v,this._z=(o-r)*v}else if(i>a&&i>p){const v=2*Math.sqrt(1+i-a-p);this._w=(A-l)/v,this._x=.25*v,this._y=(r+o)/v,this._z=(s+u)/v}else if(a>p){const v=2*Math.sqrt(1+a-i-p);this._w=(s-u)/v,this._x=(r+o)/v,this._y=.25*v,this._z=(l+A)/v}else{const v=2*Math.sqrt(1+p-i-a);this._w=(o-r)/v,this._x=(s+u)/v,this._y=(l+A)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(En(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,A=t._w;return this._x=i*A+o*a+r*u-s*l,this._y=r*A+o*l+s*a-i*u,this._z=s*A+o*u+i*l-r*a,this._w=o*A-i*a-r*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*i+t*this._x,this._y=v*r+t*this._y,this._z=v*s+t*this._z,this.normalize(),this}const u=Math.sqrt(l),A=Math.atan2(u,a),p=Math.sin((1-t)*A)/u,g=Math.sin(t*A)/u;return this._w=o*p+this._w*g,this._x=i*p+this._x*g,this._y=r*p+this._y*g,this._z=s*p+this._z*g,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ie{constructor(e=0,t=0,i=0){ie.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(D8.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(D8.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*r-a*i),A=2*(a*t-s*r),p=2*(s*i-o*t);return this.x=t+l*u+o*p-a*A,this.y=i+l*A+a*u-s*p,this.z=r+l*p+s*A-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=En(this.x,e.x,t.x),this.y=En(this.y,e.y,t.y),this.z=En(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=En(this.x,e,t),this.y=En(this.y,e,t),this.z=En(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(En(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return B_.copy(this).projectOnVector(e),this.sub(B_)}reflect(e){return this.sub(B_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(En(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const B_=new ie,D8=new bA;class zu{constructor(e=new ie(1/0,1/0,1/0),t=new ie(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Xo.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Xo.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Xo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Xo):Xo.fromBufferAttribute(s,o),Xo.applyMatrix4(e.matrixWorld),this.expandByPoint(Xo);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),kp.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),kp.copy(i.boundingBox)),kp.applyMatrix4(e.matrixWorld),this.union(kp)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Xo),Xo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(qA),Vp.subVectors(this.max,qA),Eh.subVectors(e.a,qA),Ch.subVectors(e.b,qA),Rh.subVectors(e.c,qA),au.subVectors(Ch,Eh),lu.subVectors(Rh,Ch),sc.subVectors(Eh,Rh);let t=[0,-au.z,au.y,0,-lu.z,lu.y,0,-sc.z,sc.y,au.z,0,-au.x,lu.z,0,-lu.x,sc.z,0,-sc.x,-au.y,au.x,0,-lu.y,lu.x,0,-sc.y,sc.x,0];return!F_(t,Eh,Ch,Rh,Vp)||(t=[1,0,0,0,1,0,0,0,1],!F_(t,Eh,Ch,Rh,Vp))?!1:(Gp.crossVectors(au,lu),t=[Gp.x,Gp.y,Gp.z],F_(t,Eh,Ch,Rh,Vp))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Xo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Xo).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(dl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),dl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),dl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),dl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),dl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),dl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),dl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),dl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(dl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const dl=[new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie],Xo=new ie,kp=new zu,Eh=new ie,Ch=new ie,Rh=new ie,au=new ie,lu=new ie,sc=new ie,qA=new ie,Vp=new ie,Gp=new ie,oc=new ie;function F_(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){oc.fromArray(n,s);const a=r.x*Math.abs(oc.x)+r.y*Math.abs(oc.y)+r.z*Math.abs(oc.z),l=e.dot(oc),u=t.dot(oc),A=i.dot(oc);if(Math.max(-Math.max(l,u,A),Math.min(l,u,A))>a)return!1}return!0}const aq=new zu,zA=new ie,U_=new ie;class Hu{constructor(e=new ie,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):aq.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;zA.subVectors(e,this.center);const t=zA.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(zA,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(U_.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(zA.copy(e.center).add(U_)),this.expandByPoint(zA.copy(e.center).sub(U_))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const pl=new ie,O_=new ie,qp=new ie,uu=new ie,k_=new ie,zp=new ie,V_=new ie;class n2{constructor(e=new ie,t=new ie(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,pl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=pl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(pl.copy(this.origin).addScaledVector(this.direction,t),pl.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){O_.copy(e).add(t).multiplyScalar(.5),qp.copy(t).sub(e).normalize(),uu.copy(this.origin).sub(O_);const s=e.distanceTo(t)*.5,o=-this.direction.dot(qp),a=uu.dot(this.direction),l=-uu.dot(qp),u=uu.lengthSq(),A=Math.abs(1-o*o);let p,g,v,x;if(A>0)if(p=o*l-a,g=o*a-l,x=s*A,p>=0)if(g>=-x)if(g<=x){const S=1/A;p*=S,g*=S,v=p*(p+o*g+2*a)+g*(o*p+g+2*l)+u}else g=s,p=Math.max(0,-(o*g+a)),v=-p*p+g*(g+2*l)+u;else g=-s,p=Math.max(0,-(o*g+a)),v=-p*p+g*(g+2*l)+u;else g<=-x?(p=Math.max(0,-(-o*s+a)),g=p>0?-s:Math.min(Math.max(-s,-l),s),v=-p*p+g*(g+2*l)+u):g<=x?(p=0,g=Math.min(Math.max(-s,-l),s),v=g*(g+2*l)+u):(p=Math.max(0,-(o*s+a)),g=p>0?s:Math.min(Math.max(-s,-l),s),v=-p*p+g*(g+2*l)+u);else g=o>0?-s:s,p=Math.max(0,-(o*g+a)),v=-p*p+g*(g+2*l)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,p),r&&r.copy(O_).addScaledVector(qp,g),v}intersectSphere(e,t){pl.subVectors(e.center,this.origin);const i=pl.dot(this.direction),r=pl.dot(pl)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const u=1/this.direction.x,A=1/this.direction.y,p=1/this.direction.z,g=this.origin;return u>=0?(i=(e.min.x-g.x)*u,r=(e.max.x-g.x)*u):(i=(e.max.x-g.x)*u,r=(e.min.x-g.x)*u),A>=0?(s=(e.min.y-g.y)*A,o=(e.max.y-g.y)*A):(s=(e.max.y-g.y)*A,o=(e.min.y-g.y)*A),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),p>=0?(a=(e.min.z-g.z)*p,l=(e.max.z-g.z)*p):(a=(e.max.z-g.z)*p,l=(e.min.z-g.z)*p),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,pl)!==null}intersectTriangle(e,t,i,r,s){k_.subVectors(t,e),zp.subVectors(i,e),V_.crossVectors(k_,zp);let o=this.direction.dot(V_),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;uu.subVectors(this.origin,e);const l=a*this.direction.dot(zp.crossVectors(uu,zp));if(l<0)return null;const u=a*this.direction.dot(k_.cross(uu));if(u<0||l+u>o)return null;const A=-a*uu.dot(V_);return A<0?null:this.at(A/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class en{constructor(e,t,i,r,s,o,a,l,u,A,p,g,v,x,S,T){en.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u,A,p,g,v,x,S,T)}set(e,t,i,r,s,o,a,l,u,A,p,g,v,x,S,T){const w=this.elements;return w[0]=e,w[4]=t,w[8]=i,w[12]=r,w[1]=s,w[5]=o,w[9]=a,w[13]=l,w[2]=u,w[6]=A,w[10]=p,w[14]=g,w[3]=v,w[7]=x,w[11]=S,w[15]=T,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new en().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Nh.setFromMatrixColumn(e,0).length(),s=1/Nh.setFromMatrixColumn(e,1).length(),o=1/Nh.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),A=Math.cos(s),p=Math.sin(s);if(e.order==="XYZ"){const g=o*A,v=o*p,x=a*A,S=a*p;t[0]=l*A,t[4]=-l*p,t[8]=u,t[1]=v+x*u,t[5]=g-S*u,t[9]=-a*l,t[2]=S-g*u,t[6]=x+v*u,t[10]=o*l}else if(e.order==="YXZ"){const g=l*A,v=l*p,x=u*A,S=u*p;t[0]=g+S*a,t[4]=x*a-v,t[8]=o*u,t[1]=o*p,t[5]=o*A,t[9]=-a,t[2]=v*a-x,t[6]=S+g*a,t[10]=o*l}else if(e.order==="ZXY"){const g=l*A,v=l*p,x=u*A,S=u*p;t[0]=g-S*a,t[4]=-o*p,t[8]=x+v*a,t[1]=v+x*a,t[5]=o*A,t[9]=S-g*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const g=o*A,v=o*p,x=a*A,S=a*p;t[0]=l*A,t[4]=x*u-v,t[8]=g*u+S,t[1]=l*p,t[5]=S*u+g,t[9]=v*u-x,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const g=o*l,v=o*u,x=a*l,S=a*u;t[0]=l*A,t[4]=S-g*p,t[8]=x*p+v,t[1]=p,t[5]=o*A,t[9]=-a*A,t[2]=-u*A,t[6]=v*p+x,t[10]=g-S*p}else if(e.order==="XZY"){const g=o*l,v=o*u,x=a*l,S=a*u;t[0]=l*A,t[4]=-p,t[8]=u*A,t[1]=g*p+S,t[5]=o*A,t[9]=v*p-x,t[2]=x*p-v,t[6]=a*A,t[10]=S*p+g}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(lq,e,uq)}lookAt(e,t,i){const r=this.elements;return so.subVectors(e,t),so.lengthSq()===0&&(so.z=1),so.normalize(),cu.crossVectors(i,so),cu.lengthSq()===0&&(Math.abs(i.z)===1?so.x+=1e-4:so.z+=1e-4,so.normalize(),cu.crossVectors(i,so)),cu.normalize(),Hp.crossVectors(so,cu),r[0]=cu.x,r[4]=Hp.x,r[8]=so.x,r[1]=cu.y,r[5]=Hp.y,r[9]=so.y,r[2]=cu.z,r[6]=Hp.z,r[10]=so.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],u=i[12],A=i[1],p=i[5],g=i[9],v=i[13],x=i[2],S=i[6],T=i[10],w=i[14],R=i[3],E=i[7],N=i[11],D=i[15],B=r[0],I=r[4],O=r[8],L=r[12],F=r[1],V=r[5],H=r[9],Q=r[13],te=r[2],K=r[6],W=r[10],Z=r[14],J=r[3],fe=r[7],ge=r[11],pe=r[15];return s[0]=o*B+a*F+l*te+u*J,s[4]=o*I+a*V+l*K+u*fe,s[8]=o*O+a*H+l*W+u*ge,s[12]=o*L+a*Q+l*Z+u*pe,s[1]=A*B+p*F+g*te+v*J,s[5]=A*I+p*V+g*K+v*fe,s[9]=A*O+p*H+g*W+v*ge,s[13]=A*L+p*Q+g*Z+v*pe,s[2]=x*B+S*F+T*te+w*J,s[6]=x*I+S*V+T*K+w*fe,s[10]=x*O+S*H+T*W+w*ge,s[14]=x*L+S*Q+T*Z+w*pe,s[3]=R*B+E*F+N*te+D*J,s[7]=R*I+E*V+N*K+D*fe,s[11]=R*O+E*H+N*W+D*ge,s[15]=R*L+E*Q+N*Z+D*pe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],A=e[2],p=e[6],g=e[10],v=e[14],x=e[3],S=e[7],T=e[11],w=e[15];return x*(+s*l*p-r*u*p-s*a*g+i*u*g+r*a*v-i*l*v)+S*(+t*l*v-t*u*g+s*o*g-r*o*v+r*u*A-s*l*A)+T*(+t*u*p-t*a*v-s*o*p+i*o*v+s*a*A-i*u*A)+w*(-r*a*A-t*l*p+t*a*g+r*o*p-i*o*g+i*l*A)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],A=e[8],p=e[9],g=e[10],v=e[11],x=e[12],S=e[13],T=e[14],w=e[15],R=p*T*u-S*g*u+S*l*v-a*T*v-p*l*w+a*g*w,E=x*g*u-A*T*u-x*l*v+o*T*v+A*l*w-o*g*w,N=A*S*u-x*p*u+x*a*v-o*S*v-A*a*w+o*p*w,D=x*p*l-A*S*l-x*a*g+o*S*g+A*a*T-o*p*T,B=t*R+i*E+r*N+s*D;if(B===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/B;return e[0]=R*I,e[1]=(S*g*s-p*T*s-S*r*v+i*T*v+p*r*w-i*g*w)*I,e[2]=(a*T*s-S*l*s+S*r*u-i*T*u-a*r*w+i*l*w)*I,e[3]=(p*l*s-a*g*s-p*r*u+i*g*u+a*r*v-i*l*v)*I,e[4]=E*I,e[5]=(A*T*s-x*g*s+x*r*v-t*T*v-A*r*w+t*g*w)*I,e[6]=(x*l*s-o*T*s-x*r*u+t*T*u+o*r*w-t*l*w)*I,e[7]=(o*g*s-A*l*s+A*r*u-t*g*u-o*r*v+t*l*v)*I,e[8]=N*I,e[9]=(x*p*s-A*S*s-x*i*v+t*S*v+A*i*w-t*p*w)*I,e[10]=(o*S*s-x*a*s+x*i*u-t*S*u-o*i*w+t*a*w)*I,e[11]=(A*a*s-o*p*s-A*i*u+t*p*u+o*i*v-t*a*v)*I,e[12]=D*I,e[13]=(A*S*r-x*p*r+x*i*g-t*S*g-A*i*T+t*p*T)*I,e[14]=(x*a*r-o*S*r-x*i*l+t*S*l+o*i*T-t*a*T)*I,e[15]=(o*p*r-A*a*r+A*i*l-t*p*l-o*i*g+t*a*g)*I,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,u=s*o,A=s*a;return this.set(u*o+i,u*a-r*l,u*l+r*a,0,u*a+r*l,A*a+i,A*l-r*o,0,u*l-r*a,A*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,A=o+o,p=a+a,g=s*u,v=s*A,x=s*p,S=o*A,T=o*p,w=a*p,R=l*u,E=l*A,N=l*p,D=i.x,B=i.y,I=i.z;return r[0]=(1-(S+w))*D,r[1]=(v+N)*D,r[2]=(x-E)*D,r[3]=0,r[4]=(v-N)*B,r[5]=(1-(g+w))*B,r[6]=(T+R)*B,r[7]=0,r[8]=(x+E)*I,r[9]=(T-R)*I,r[10]=(1-(g+S))*I,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Nh.set(r[0],r[1],r[2]).length();const o=Nh.set(r[4],r[5],r[6]).length(),a=Nh.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Qo.copy(this);const u=1/s,A=1/o,p=1/a;return Qo.elements[0]*=u,Qo.elements[1]*=u,Qo.elements[2]*=u,Qo.elements[4]*=A,Qo.elements[5]*=A,Qo.elements[6]*=A,Qo.elements[8]*=p,Qo.elements[9]*=p,Qo.elements[10]*=p,t.setFromRotationMatrix(Qo),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Is){const l=this.elements,u=2*s/(t-e),A=2*s/(i-r),p=(t+e)/(t-e),g=(i+r)/(i-r);let v,x;if(a===Is)v=-(o+s)/(o-s),x=-2*o*s/(o-s);else if(a===Za)v=-o/(o-s),x=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=p,l[12]=0,l[1]=0,l[5]=A,l[9]=g,l[13]=0,l[2]=0,l[6]=0,l[10]=v,l[14]=x,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Is){const l=this.elements,u=1/(t-e),A=1/(i-r),p=1/(o-s),g=(t+e)*u,v=(i+r)*A;let x,S;if(a===Is)x=(o+s)*p,S=-2*p;else if(a===Za)x=s*p,S=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-g,l[1]=0,l[5]=2*A,l[9]=0,l[13]=-v,l[2]=0,l[6]=0,l[10]=S,l[14]=-x,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Nh=new ie,Qo=new en,lq=new ie(0,0,0),uq=new ie(1,1,1),cu=new ie,Hp=new ie,so=new ie,I8=new en,B8=new bA;class Qr{constructor(e=0,t=0,i=0,r=Qr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],u=r[5],A=r[9],p=r[2],g=r[6],v=r[10];switch(t){case"XYZ":this._y=Math.asin(En(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-A,v),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(g,u),this._z=0);break;case"YXZ":this._x=Math.asin(-En(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(a,v),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(En(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-p,v),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-En(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(g,v),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(En(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-A,u),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(a,v));break;case"XZY":this._z=Math.asin(-En(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(g,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-A,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return I8.makeRotationFromQuaternion(e),this.setFromRotationMatrix(I8,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return B8.setFromEuler(this),this.setFromQuaternion(B8,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Qr.DEFAULT_ORDER="XYZ";class jx{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let cq=0;const F8=new ie,Ph=new bA,ml=new en,$p=new ie,HA=new ie,hq=new ie,fq=new bA,U8=new ie(1,0,0),O8=new ie(0,1,0),k8=new ie(0,0,1),V8={type:"added"},Aq={type:"removed"},Lh={type:"childadded",child:null},G_={type:"childremoved",child:null};class Ci extends sl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:cq++}),this.uuid=Ha(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ci.DEFAULT_UP.clone();const e=new ie,t=new Qr,i=new bA,r=new ie(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new en},normalMatrix:{value:new dn}}),this.matrix=new en,this.matrixWorld=new en,this.matrixAutoUpdate=Ci.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ci.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new jx,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ph.setFromAxisAngle(e,t),this.quaternion.multiply(Ph),this}rotateOnWorldAxis(e,t){return Ph.setFromAxisAngle(e,t),this.quaternion.premultiply(Ph),this}rotateX(e){return this.rotateOnAxis(U8,e)}rotateY(e){return this.rotateOnAxis(O8,e)}rotateZ(e){return this.rotateOnAxis(k8,e)}translateOnAxis(e,t){return F8.copy(e).applyQuaternion(this.quaternion),this.position.add(F8.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(U8,e)}translateY(e){return this.translateOnAxis(O8,e)}translateZ(e){return this.translateOnAxis(k8,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ml.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?$p.copy(e):$p.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),HA.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ml.lookAt(HA,$p,this.up):ml.lookAt($p,HA,this.up),this.quaternion.setFromRotationMatrix(ml),r&&(ml.extractRotation(r.matrixWorld),Ph.setFromRotationMatrix(ml),this.quaternion.premultiply(Ph.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(V8),Lh.child=e,this.dispatchEvent(Lh),Lh.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Aq),G_.child=e,this.dispatchEvent(G_),G_.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ml.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ml.multiply(e.parent.matrixWorld)),e.applyMatrix4(ml),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(V8),Lh.child=e,this.dispatchEvent(Lh),Lh.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(HA,e,hq),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(HA,fq,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(a=>({...a,boundingBox:a.boundingBox?{min:a.boundingBox.min.toArray(),max:a.boundingBox.max.toArray()}:void 0,boundingSphere:a.boundingSphere?{radius:a.boundingSphere.radius,center:a.boundingSphere.center.toArray()}:void 0})),r.instanceInfo=this._instanceInfo.map(a=>({...a})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,A=l.length;u<A;u++){const p=l[u];s(e.shapes,p)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),A=o(e.images),p=o(e.shapes),g=o(e.skeletons),v=o(e.animations),x=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),A.length>0&&(i.images=A),p.length>0&&(i.shapes=p),g.length>0&&(i.skeletons=g),v.length>0&&(i.animations=v),x.length>0&&(i.nodes=x)}return i.object=r,i;function o(a){const l=[];for(const u in a){const A=a[u];delete A.metadata,l.push(A)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Ci.DEFAULT_UP=new ie(0,1,0);Ci.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ci.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Yo=new ie,gl=new ie,q_=new ie,_l=new ie,Dh=new ie,Ih=new ie,G8=new ie,z_=new ie,H_=new ie,$_=new ie,W_=new $t,j_=new $t,X_=new $t;class Bo{constructor(e=new ie,t=new ie,i=new ie){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Yo.subVectors(e,t),r.cross(Yo);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Yo.subVectors(r,t),gl.subVectors(i,t),q_.subVectors(e,t);const o=Yo.dot(Yo),a=Yo.dot(gl),l=Yo.dot(q_),u=gl.dot(gl),A=gl.dot(q_),p=o*u-a*a;if(p===0)return s.set(0,0,0),null;const g=1/p,v=(u*l-a*A)*g,x=(o*A-a*l)*g;return s.set(1-v-x,x,v)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,_l)===null?!1:_l.x>=0&&_l.y>=0&&_l.x+_l.y<=1}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,_l)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,_l.x),l.addScaledVector(o,_l.y),l.addScaledVector(a,_l.z),l)}static getInterpolatedAttribute(e,t,i,r,s,o){return W_.setScalar(0),j_.setScalar(0),X_.setScalar(0),W_.fromBufferAttribute(e,t),j_.fromBufferAttribute(e,i),X_.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(W_,s.x),o.addScaledVector(j_,s.y),o.addScaledVector(X_,s.z),o}static isFrontFacing(e,t,i,r){return Yo.subVectors(i,t),gl.subVectors(e,t),Yo.cross(gl).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Yo.subVectors(this.c,this.b),gl.subVectors(this.a,this.b),Yo.cross(gl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Bo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Bo.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return Bo.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Bo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Bo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Dh.subVectors(r,i),Ih.subVectors(s,i),z_.subVectors(e,i);const l=Dh.dot(z_),u=Ih.dot(z_);if(l<=0&&u<=0)return t.copy(i);H_.subVectors(e,r);const A=Dh.dot(H_),p=Ih.dot(H_);if(A>=0&&p<=A)return t.copy(r);const g=l*p-A*u;if(g<=0&&l>=0&&A<=0)return o=l/(l-A),t.copy(i).addScaledVector(Dh,o);$_.subVectors(e,s);const v=Dh.dot($_),x=Ih.dot($_);if(x>=0&&v<=x)return t.copy(s);const S=v*u-l*x;if(S<=0&&u>=0&&x<=0)return a=u/(u-x),t.copy(i).addScaledVector(Ih,a);const T=A*x-v*p;if(T<=0&&p-A>=0&&v-x>=0)return G8.subVectors(s,r),a=(p-A)/(p-A+(v-x)),t.copy(r).addScaledVector(G8,a);const w=1/(T+S+g);return o=S*w,a=g*w,t.copy(i).addScaledVector(Dh,o).addScaledVector(Ih,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Z7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},hu={h:0,s:0,l:0},Wp={h:0,s:0,l:0};function Q_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let Ft=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ht){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Rn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Rn.workingColorSpace){return this.r=e,this.g=t,this.b=i,Rn.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Rn.workingColorSpace){if(e=zx(e,1),t=En(t,0,1),i=En(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=Q_(o,s,e+1/3),this.g=Q_(o,s,e),this.b=Q_(o,s,e-1/3)}return Rn.toWorkingColorSpace(this,r),this}setStyle(e,t=Ht){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ht){const i=Z7[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Dl(e.r),this.g=Dl(e.g),this.b=Dl(e.b),this}copyLinearToSRGB(e){return this.r=Nf(e.r),this.g=Nf(e.g),this.b=Nf(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ht){return Rn.fromWorkingColorSpace(ss.copy(this),e),Math.round(En(ss.r*255,0,255))*65536+Math.round(En(ss.g*255,0,255))*256+Math.round(En(ss.b*255,0,255))}getHexString(e=Ht){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Rn.workingColorSpace){Rn.fromWorkingColorSpace(ss.copy(this),t);const i=ss.r,r=ss.g,s=ss.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,u;const A=(a+o)/2;if(a===o)l=0,u=0;else{const p=o-a;switch(u=A<=.5?p/(o+a):p/(2-o-a),o){case i:l=(r-s)/p+(r<s?6:0);break;case r:l=(s-i)/p+2;break;case s:l=(i-r)/p+4;break}l/=6}return e.h=l,e.s=u,e.l=A,e}getRGB(e,t=Rn.workingColorSpace){return Rn.fromWorkingColorSpace(ss.copy(this),t),e.r=ss.r,e.g=ss.g,e.b=ss.b,e}getStyle(e=Ht){Rn.fromWorkingColorSpace(ss.copy(this),e);const t=ss.r,i=ss.g,r=ss.b;return e!==Ht?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(hu),this.setHSL(hu.h+e,hu.s+t,hu.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(hu),e.getHSL(Wp);const i=U0(hu.h,Wp.h,t),r=U0(hu.s,Wp.s,t),s=U0(hu.l,Wp.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const ss=new Ft;Ft.NAMES=Z7;let dq=0;class ds extends sl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:dq++}),this.uuid=Ha(),this.name="",this.type="Material",this.blending=Fs,this.side=Xs,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=id,this.blendDst=rd,this.blendEquation=cs,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ft(0,0,0),this.blendAlpha=0,this.depthFunc=Ou,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Iv,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=bc,this.stencilZFail=bc,this.stencilZPass=bc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Fs&&(i.blending=this.blending),this.side!==Xs&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==id&&(i.blendSrc=this.blendSrc),this.blendDst!==rd&&(i.blendDst=this.blendDst),this.blendEquation!==cs&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Ou&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Iv&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==bc&&(i.stencilFail=this.stencilFail),this.stencilZFail!==bc&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==bc&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class ia extends ds{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Qr,this.combine=tp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Cl=pq();function pq(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):u<-14?(i[l]=1024>>-u-14,i[l|256]=1024>>-u-14|32768,r[l]=-u-1,r[l|256]=-u-1):u<=15?(i[l]=u+15<<10,i[l|256]=u+15<<10|32768,r[l]=13,r[l|256]=13):u<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,A=0;for(;(u&8388608)===0;)u<<=1,A-=8388608;u&=-8388609,A+=947912704,s[l]=u|A}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function oo(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=En(n,-65504,65504),Cl.floatView[0]=n;const e=Cl.uint32View[0],t=e>>23&511;return Cl.baseTable[t]+((e&8388607)>>Cl.shiftTable[t])}function jp(n){const e=n>>10;return Cl.uint32View[0]=Cl.mantissaTable[Cl.offsetTable[e]+(n&1023)]+Cl.exponentTable[e],Cl.floatView[0]}const pr=new ie,Xp=new at;let mq=0;class Gi{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:mq++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=G1,this.updateRanges=[],this.gpuType=lr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Xp.fromBufferAttribute(this,t),Xp.applyMatrix3(e),this.setXY(t,Xp.x,Xp.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)pr.fromBufferAttribute(this,t),pr.applyMatrix3(e),this.setXYZ(t,pr.x,pr.y,pr.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)pr.fromBufferAttribute(this,t),pr.applyMatrix4(e),this.setXYZ(t,pr.x,pr.y,pr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)pr.fromBufferAttribute(this,t),pr.applyNormalMatrix(e),this.setXYZ(t,pr.x,pr.y,pr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)pr.fromBufferAttribute(this,t),pr.transformDirection(e),this.setXYZ(t,pr.x,pr.y,pr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Ds(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Cn(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ds(t,this.array)),t}setX(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ds(t,this.array)),t}setY(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ds(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ds(t,this.array)),t}setW(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Cn(t,this.array),i=Cn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Cn(t,this.array),i=Cn(i,this.array),r=Cn(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Cn(t,this.array),i=Cn(i,this.array),r=Cn(r,this.array),s=Cn(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==G1&&(e.usage=this.usage),e}}class Xx extends Gi{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class Qx extends Gi{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class K7 extends Gi{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=jp(this.array[e*this.itemSize]);return this.normalized&&(t=Ds(t,this.array)),t}setX(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize]=oo(t),this}getY(e){let t=jp(this.array[e*this.itemSize+1]);return this.normalized&&(t=Ds(t,this.array)),t}setY(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize+1]=oo(t),this}getZ(e){let t=jp(this.array[e*this.itemSize+2]);return this.normalized&&(t=Ds(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize+2]=oo(t),this}getW(e){let t=jp(this.array[e*this.itemSize+3]);return this.normalized&&(t=Ds(t,this.array)),t}setW(e,t){return this.normalized&&(t=Cn(t,this.array)),this.array[e*this.itemSize+3]=oo(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Cn(t,this.array),i=Cn(i,this.array)),this.array[e+0]=oo(t),this.array[e+1]=oo(i),this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Cn(t,this.array),i=Cn(i,this.array),r=Cn(r,this.array)),this.array[e+0]=oo(t),this.array[e+1]=oo(i),this.array[e+2]=oo(r),this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Cn(t,this.array),i=Cn(i,this.array),r=Cn(r,this.array),s=Cn(s,this.array)),this.array[e+0]=oo(t),this.array[e+1]=oo(i),this.array[e+2]=oo(r),this.array[e+3]=oo(s),this}}class ei extends Gi{constructor(e,t,i){super(new Float32Array(e),t,i)}}let gq=0;const No=new en,Y_=new Ci,Bh=new ie,ao=new zu,$A=new zu,Nr=new ie;class Ai extends sl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:gq++}),this.uuid=Ha(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new($x(e)?Qx:Xx)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new dn().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return No.makeRotationFromQuaternion(e),this.applyMatrix4(No),this}rotateX(e){return No.makeRotationX(e),this.applyMatrix4(No),this}rotateY(e){return No.makeRotationY(e),this.applyMatrix4(No),this}rotateZ(e){return No.makeRotationZ(e),this.applyMatrix4(No),this}translate(e,t,i){return No.makeTranslation(e,t,i),this.applyMatrix4(No),this}scale(e,t,i){return No.makeScale(e,t,i),this.applyMatrix4(No),this}lookAt(e){return Y_.lookAt(e),Y_.updateMatrix(),this.applyMatrix4(Y_.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Bh).negate(),this.translate(Bh.x,Bh.y,Bh.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new ei(i,3))}else{const i=Math.min(e.length,t.count);for(let r=0;r<i;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new zu);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ie(-1/0,-1/0,-1/0),new ie(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];ao.setFromBufferAttribute(s),this.morphTargetsRelative?(Nr.addVectors(this.boundingBox.min,ao.min),this.boundingBox.expandByPoint(Nr),Nr.addVectors(this.boundingBox.max,ao.max),this.boundingBox.expandByPoint(Nr)):(this.boundingBox.expandByPoint(ao.min),this.boundingBox.expandByPoint(ao.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Hu);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ie,1/0);return}if(e){const i=this.boundingSphere.center;if(ao.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];$A.setFromBufferAttribute(a),this.morphTargetsRelative?(Nr.addVectors(ao.min,$A.min),ao.expandByPoint(Nr),Nr.addVectors(ao.max,$A.max),ao.expandByPoint(Nr)):(ao.expandByPoint($A.min),ao.expandByPoint($A.max))}ao.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Nr.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Nr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,A=a.count;u<A;u++)Nr.fromBufferAttribute(a,u),l&&(Bh.fromBufferAttribute(e,u),Nr.add(Bh)),r=Math.max(r,i.distanceToSquared(Nr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Gi(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let O=0;O<i.count;O++)a[O]=new ie,l[O]=new ie;const u=new ie,A=new ie,p=new ie,g=new at,v=new at,x=new at,S=new ie,T=new ie;function w(O,L,F){u.fromBufferAttribute(i,O),A.fromBufferAttribute(i,L),p.fromBufferAttribute(i,F),g.fromBufferAttribute(s,O),v.fromBufferAttribute(s,L),x.fromBufferAttribute(s,F),A.sub(u),p.sub(u),v.sub(g),x.sub(g);const V=1/(v.x*x.y-x.x*v.y);isFinite(V)&&(S.copy(A).multiplyScalar(x.y).addScaledVector(p,-v.y).multiplyScalar(V),T.copy(p).multiplyScalar(v.x).addScaledVector(A,-x.x).multiplyScalar(V),a[O].add(S),a[L].add(S),a[F].add(S),l[O].add(T),l[L].add(T),l[F].add(T))}let R=this.groups;R.length===0&&(R=[{start:0,count:e.count}]);for(let O=0,L=R.length;O<L;++O){const F=R[O],V=F.start,H=F.count;for(let Q=V,te=V+H;Q<te;Q+=3)w(e.getX(Q+0),e.getX(Q+1),e.getX(Q+2))}const E=new ie,N=new ie,D=new ie,B=new ie;function I(O){D.fromBufferAttribute(r,O),B.copy(D);const L=a[O];E.copy(L),E.sub(D.multiplyScalar(D.dot(L))).normalize(),N.crossVectors(B,L);const V=N.dot(l[O])<0?-1:1;o.setXYZW(O,E.x,E.y,E.z,V)}for(let O=0,L=R.length;O<L;++O){const F=R[O],V=F.start,H=F.count;for(let Q=V,te=V+H;Q<te;Q+=3)I(e.getX(Q+0)),I(e.getX(Q+1)),I(e.getX(Q+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Gi(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let g=0,v=i.count;g<v;g++)i.setXYZ(g,0,0,0);const r=new ie,s=new ie,o=new ie,a=new ie,l=new ie,u=new ie,A=new ie,p=new ie;if(e)for(let g=0,v=e.count;g<v;g+=3){const x=e.getX(g+0),S=e.getX(g+1),T=e.getX(g+2);r.fromBufferAttribute(t,x),s.fromBufferAttribute(t,S),o.fromBufferAttribute(t,T),A.subVectors(o,s),p.subVectors(r,s),A.cross(p),a.fromBufferAttribute(i,x),l.fromBufferAttribute(i,S),u.fromBufferAttribute(i,T),a.add(A),l.add(A),u.add(A),i.setXYZ(x,a.x,a.y,a.z),i.setXYZ(S,l.x,l.y,l.z),i.setXYZ(T,u.x,u.y,u.z)}else for(let g=0,v=t.count;g<v;g+=3)r.fromBufferAttribute(t,g+0),s.fromBufferAttribute(t,g+1),o.fromBufferAttribute(t,g+2),A.subVectors(o,s),p.subVectors(r,s),A.cross(p),i.setXYZ(g+0,A.x,A.y,A.z),i.setXYZ(g+1,A.x,A.y,A.z),i.setXYZ(g+2,A.x,A.y,A.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Nr.fromBufferAttribute(e,t),Nr.normalize(),e.setXYZ(t,Nr.x,Nr.y,Nr.z)}toNonIndexed(){function e(a,l){const u=a.array,A=a.itemSize,p=a.normalized,g=new u.constructor(l.length*A);let v=0,x=0;for(let S=0,T=l.length;S<T;S++){a.isInterleavedBufferAttribute?v=l[S]*a.data.stride+a.offset:v=l[S]*A;for(let w=0;w<A;w++)g[x++]=u[v++]}return new Gi(g,A,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ai,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let A=0,p=u.length;A<p;A++){const g=u[A],v=e(g,i);l.push(v)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],A=[];for(let p=0,g=u.length;p<g;p++){const v=u[p];A.push(v.toJSON(e.data))}A.length>0&&(r[l]=A,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const r=e.attributes;for(const u in r){const A=r[u];this.setAttribute(u,A.clone(t))}const s=e.morphAttributes;for(const u in s){const A=[],p=s[u];for(let g=0,v=p.length;g<v;g++)A.push(p[g].clone(t));this.morphAttributes[u]=A}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,A=o.length;u<A;u++){const p=o[u];this.addGroup(p.start,p.count,p.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const q8=new en,ac=new n2,Qp=new Hu,z8=new ie,Yp=new ie,Zp=new ie,Kp=new ie,Z_=new ie,Jp=new ie,H8=new ie,em=new ie;class Jn extends Ci{constructor(e=new Ai,t=new ia){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){Jp.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const A=a[l],p=s[l];A!==0&&(Z_.fromBufferAttribute(p,e),o?Jp.addScaledVector(Z_,A):Jp.addScaledVector(Z_.sub(t),A))}t.add(Jp)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Qp.copy(i.boundingSphere),Qp.applyMatrix4(s),ac.copy(e.ray).recast(e.near),!(Qp.containsPoint(ac.origin)===!1&&(ac.intersectSphere(Qp,z8)===null||ac.origin.distanceToSquared(z8)>(e.far-e.near)**2))&&(q8.copy(s).invert(),ac.copy(e.ray).applyMatrix4(q8),!(i.boundingBox!==null&&ac.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,ac)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,A=s.attributes.uv1,p=s.attributes.normal,g=s.groups,v=s.drawRange;if(a!==null)if(Array.isArray(o))for(let x=0,S=g.length;x<S;x++){const T=g[x],w=o[T.materialIndex],R=Math.max(T.start,v.start),E=Math.min(a.count,Math.min(T.start+T.count,v.start+v.count));for(let N=R,D=E;N<D;N+=3){const B=a.getX(N),I=a.getX(N+1),O=a.getX(N+2);r=tm(this,w,e,i,u,A,p,B,I,O),r&&(r.faceIndex=Math.floor(N/3),r.face.materialIndex=T.materialIndex,t.push(r))}}else{const x=Math.max(0,v.start),S=Math.min(a.count,v.start+v.count);for(let T=x,w=S;T<w;T+=3){const R=a.getX(T),E=a.getX(T+1),N=a.getX(T+2);r=tm(this,o,e,i,u,A,p,R,E,N),r&&(r.faceIndex=Math.floor(T/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let x=0,S=g.length;x<S;x++){const T=g[x],w=o[T.materialIndex],R=Math.max(T.start,v.start),E=Math.min(l.count,Math.min(T.start+T.count,v.start+v.count));for(let N=R,D=E;N<D;N+=3){const B=N,I=N+1,O=N+2;r=tm(this,w,e,i,u,A,p,B,I,O),r&&(r.faceIndex=Math.floor(N/3),r.face.materialIndex=T.materialIndex,t.push(r))}}else{const x=Math.max(0,v.start),S=Math.min(l.count,v.start+v.count);for(let T=x,w=S;T<w;T+=3){const R=T,E=T+1,N=T+2;r=tm(this,o,e,i,u,A,p,R,E,N),r&&(r.faceIndex=Math.floor(T/3),t.push(r))}}}}function _q(n,e,t,i,r,s,o,a){let l;if(e.side===_i?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Xs,a),l===null)return null;em.copy(a),em.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(em);return u<t.near||u>t.far?null:{distance:u,point:em.clone(),object:n}}function tm(n,e,t,i,r,s,o,a,l,u){n.getVertexPosition(a,Yp),n.getVertexPosition(l,Zp),n.getVertexPosition(u,Kp);const A=_q(n,e,t,i,Yp,Zp,Kp,H8);if(A){const p=new ie;Bo.getBarycoord(H8,Yp,Zp,Kp,p),r&&(A.uv=Bo.getInterpolatedAttribute(r,a,l,u,p,new at)),s&&(A.uv1=Bo.getInterpolatedAttribute(s,a,l,u,p,new at)),o&&(A.normal=Bo.getInterpolatedAttribute(o,a,l,u,p,new ie),A.normal.dot(i.direction)>0&&A.normal.multiplyScalar(-1));const g={a,b:l,c:u,normal:new ie,materialIndex:0};Bo.getNormal(Yp,Zp,Kp,g.normal),A.face=g,A.barycoord=p}return A}class $u extends Ai{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],A=[],p=[];let g=0,v=0;x("z","y","x",-1,-1,i,t,e,o,s,0),x("z","y","x",1,-1,i,t,-e,o,s,1),x("x","z","y",1,1,e,i,t,r,o,2),x("x","z","y",1,-1,e,i,-t,r,o,3),x("x","y","z",1,-1,e,t,i,r,s,4),x("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new ei(u,3)),this.setAttribute("normal",new ei(A,3)),this.setAttribute("uv",new ei(p,2));function x(S,T,w,R,E,N,D,B,I,O,L){const F=N/I,V=D/O,H=N/2,Q=D/2,te=B/2,K=I+1,W=O+1;let Z=0,J=0;const fe=new ie;for(let ge=0;ge<W;ge++){const pe=ge*V-Q;for(let Ae=0;Ae<K;Ae++){const Fe=Ae*F-H;fe[S]=Fe*R,fe[T]=pe*E,fe[w]=te,u.push(fe.x,fe.y,fe.z),fe[S]=0,fe[T]=0,fe[w]=B>0?1:-1,A.push(fe.x,fe.y,fe.z),p.push(Ae/I),p.push(1-ge/O),Z+=1}}for(let ge=0;ge<O;ge++)for(let pe=0;pe<I;pe++){const Ae=g+pe+K*ge,Fe=g+pe+K*(ge+1),be=g+(pe+1)+K*(ge+1),Ve=g+(pe+1)+K*ge;l.push(Ae,Fe,Ve),l.push(Fe,be,Ve),J+=6}a.addGroup(v,J,L),v+=J,g+=Z}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $u(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function rA(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function ws(n){const e={};for(let t=0;t<n.length;t++){const i=rA(n[t]);for(const r in i)e[r]=i[r]}return e}function vq(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function J7(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Rn.workingColorSpace}const Yx={clone:rA,merge:ws};var yq=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,xq=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class zo extends ds{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=yq,this.fragmentShader=xq,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=rA(e.uniforms),this.uniformsGroups=vq(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class rp extends Ci{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new en,this.projectionMatrix=new en,this.projectionMatrixInverse=new en,this.coordinateSystem=Is}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const fu=new ie,$8=new at,W8=new at;class Br extends rp{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=th*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(F0*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return th*2*Math.atan(Math.tan(F0*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){fu.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(fu.x,fu.y).multiplyScalar(-e/fu.z),fu.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(fu.x,fu.y).multiplyScalar(-e/fu.z)}getViewSize(e,t){return this.getViewBounds(e,$8,W8),t.subVectors(W8,$8)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(F0*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/u,r*=o.width/l,i*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Fh=-90,Uh=1;class eE extends Ci{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Br(Fh,Uh,e,t);r.layers=this.layers,this.add(r);const s=new Br(Fh,Uh,e,t);s.layers=this.layers,this.add(s);const o=new Br(Fh,Uh,e,t);o.layers=this.layers,this.add(o);const a=new Br(Fh,Uh,e,t);a.layers=this.layers,this.add(a);const l=new Br(Fh,Uh,e,t);l.layers=this.layers,this.add(l);const u=new Br(Fh,Uh,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===Is)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Za)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,A]=this.children,p=e.getRenderTarget(),g=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),x=e.xr.enabled;e.xr.enabled=!1;const S=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,u),i.texture.generateMipmaps=S,e.setRenderTarget(i,5,r),e.render(t,A),e.setRenderTarget(p,g,v),e.xr.enabled=x,i.texture.needsPMREMUpdate=!0}}class i2 extends vr{constructor(e=[],t=ga,i,r,s,o,a,l,u,A){super(e,t,i,r,s,o,a,l,u,A),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class tE extends nh{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new i2(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Tr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new $u(5,5,5),s=new zo({name:"CubemapFromEquirect",uniforms:rA(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:_i,blending:vo});s.uniforms.tEquirect.value=t;const o=new Jn(r,s),a=t.minFilter;return t.minFilter===zs&&(t.minFilter=Tr),new eE(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,i=!0,r=!0){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}let Bs=class extends Ci{constructor(){super(),this.isGroup=!0,this.type="Group"}};const bq={type:"move"};class h1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Bs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Bs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ie),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Bs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ie),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const S of e.hand.values()){const T=t.getJointPose(S,i),w=this._getHandJoint(u,S);T!==null&&(w.matrix.fromArray(T.transform.matrix),w.matrix.decompose(w.position,w.rotation,w.scale),w.matrixWorldNeedsUpdate=!0,w.jointRadius=T.radius),w.visible=T!==null}const A=u.joints["index-finger-tip"],p=u.joints["thumb-tip"],g=A.position.distanceTo(p.position),v=.02,x=.005;u.inputState.pinching&&g>v+x?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&g<=v-x&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(bq)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new Bs;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class r2 extends Ci{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Qr,this.environmentIntensity=1,this.environmentRotation=new Qr,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class s2{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=G1,this.updateRanges=[],this.version=0,this.uuid=Ha()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ha()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ha()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ys=new ie;class Uo{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ys.fromBufferAttribute(this,t),ys.applyMatrix4(e),this.setXYZ(t,ys.x,ys.y,ys.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ys.fromBufferAttribute(this,t),ys.applyNormalMatrix(e),this.setXYZ(t,ys.x,ys.y,ys.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ys.fromBufferAttribute(this,t),ys.transformDirection(e),this.setXYZ(t,ys.x,ys.y,ys.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Ds(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Cn(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=Cn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Cn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Cn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Cn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Ds(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Ds(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Ds(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Ds(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Cn(t,this.array),i=Cn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Cn(t,this.array),i=Cn(i,this.array),r=Cn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Cn(t,this.array),i=Cn(i,this.array),r=Cn(r,this.array),s=Cn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Gi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Uo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Zx extends ds{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ft(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Oh;const WA=new ie,kh=new ie,Vh=new ie,Gh=new at,jA=new at,nE=new en,nm=new ie,XA=new ie,im=new ie,j8=new at,K_=new at,X8=new at;class wq extends Ci{constructor(e=new Zx){if(super(),this.isSprite=!0,this.type="Sprite",Oh===void 0){Oh=new Ai;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new s2(t,5);Oh.setIndex([0,1,2,0,2,3]),Oh.setAttribute("position",new Uo(i,3,0,!1)),Oh.setAttribute("uv",new Uo(i,2,3,!1))}this.geometry=Oh,this.material=e,this.center=new at(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),kh.setFromMatrixScale(this.matrixWorld),nE.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Vh.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&kh.multiplyScalar(-Vh.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;rm(nm.set(-.5,-.5,0),Vh,o,kh,r,s),rm(XA.set(.5,-.5,0),Vh,o,kh,r,s),rm(im.set(.5,.5,0),Vh,o,kh,r,s),j8.set(0,0),K_.set(1,0),X8.set(1,1);let a=e.ray.intersectTriangle(nm,XA,im,!1,WA);if(a===null&&(rm(XA.set(-.5,.5,0),Vh,o,kh,r,s),K_.set(0,1),a=e.ray.intersectTriangle(nm,im,XA,!1,WA),a===null))return;const l=e.ray.origin.distanceTo(WA);l<e.near||l>e.far||t.push({distance:l,point:WA.clone(),uv:Bo.getInterpolation(WA,nm,XA,im,j8,K_,X8,new at),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function rm(n,e,t,i,r,s){Gh.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(jA.x=s*Gh.x-r*Gh.y,jA.y=r*Gh.x+s*Gh.y):jA.copy(Gh),n.copy(e),n.x+=jA.x,n.y+=jA.y,n.applyMatrix4(nE)}class Sq extends vr{constructor(e=null,t=1,i=1,r,s,o,a,l,u=Mi,A=Mi,p,g){super(null,o,a,l,u,A,r,s,p,g),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Du extends Gi{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const J_=new ie,Tq=new ie,Mq=new dn;class bl{constructor(e=new ie(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=J_.subVectors(i,t).cross(Tq.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(J_),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Mq.getNormalMatrix(e),r=this.coplanarPoint(J_).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const lc=new Hu,sm=new ie;class wA{constructor(e=new bl,t=new bl,i=new bl,r=new bl,s=new bl,o=new bl){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Is){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],u=r[4],A=r[5],p=r[6],g=r[7],v=r[8],x=r[9],S=r[10],T=r[11],w=r[12],R=r[13],E=r[14],N=r[15];if(i[0].setComponents(l-s,g-u,T-v,N-w).normalize(),i[1].setComponents(l+s,g+u,T+v,N+w).normalize(),i[2].setComponents(l+o,g+A,T+x,N+R).normalize(),i[3].setComponents(l-o,g-A,T-x,N-R).normalize(),i[4].setComponents(l-a,g-p,T-S,N-E).normalize(),t===Is)i[5].setComponents(l+a,g+p,T+S,N+E).normalize();else if(t===Za)i[5].setComponents(a,p,S,E).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),lc.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),lc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(lc)}intersectsSprite(e){return lc.center.set(0,0,0),lc.radius=.7071067811865476,lc.applyMatrix4(e.matrixWorld),this.intersectsSphere(lc)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(sm.x=r.normal.x>0?e.max.x:e.min.x,sm.y=r.normal.y>0?e.max.y:e.min.y,sm.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(sm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Ca=new en,Ra=new wA;class Kx{constructor(){this.coordinateSystem=Is}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(Ca.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ra.setFromProjectionMatrix(Ca,this.coordinateSystem),Ra.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(Ca.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ra.setFromProjectionMatrix(Ca,this.coordinateSystem),Ra.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(Ca.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ra.setFromProjectionMatrix(Ca,this.coordinateSystem),Ra.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(Ca.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ra.setFromProjectionMatrix(Ca,this.coordinateSystem),Ra.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(Ca.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ra.setFromProjectionMatrix(Ca,this.coordinateSystem),Ra.containsPoint(e))return!0}return!1}clone(){return new Kx}}class SA extends ds{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ft(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const q1=new ie,z1=new ie,Q8=new en,QA=new n2,om=new Hu,e3=new ie,Y8=new ie;class o2 extends Ci{constructor(e=new Ai,t=new SA){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)q1.fromBufferAttribute(t,r-1),z1.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=q1.distanceTo(z1);e.setAttribute("lineDistance",new ei(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),om.copy(i.boundingSphere),om.applyMatrix4(r),om.radius+=s,e.ray.intersectsSphere(om)===!1)return;Q8.copy(r).invert(),QA.copy(e.ray).applyMatrix4(Q8);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=this.isLineSegments?2:1,A=i.index,g=i.attributes.position;if(A!==null){const v=Math.max(0,o.start),x=Math.min(A.count,o.start+o.count);for(let S=v,T=x-1;S<T;S+=u){const w=A.getX(S),R=A.getX(S+1),E=am(this,e,QA,l,w,R,S);E&&t.push(E)}if(this.isLineLoop){const S=A.getX(x-1),T=A.getX(v),w=am(this,e,QA,l,S,T,x-1);w&&t.push(w)}}else{const v=Math.max(0,o.start),x=Math.min(g.count,o.start+o.count);for(let S=v,T=x-1;S<T;S+=u){const w=am(this,e,QA,l,S,S+1,S);w&&t.push(w)}if(this.isLineLoop){const S=am(this,e,QA,l,x-1,v,x-1);S&&t.push(S)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function am(n,e,t,i,r,s,o){const a=n.geometry.attributes.position;if(q1.fromBufferAttribute(a,r),z1.fromBufferAttribute(a,s),t.distanceSqToSegment(q1,z1,e3,Y8)>i)return;e3.applyMatrix4(n.matrixWorld);const u=e.ray.origin.distanceTo(e3);if(!(u<e.near||u>e.far))return{distance:u,point:Y8.clone().applyMatrix4(n.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:n}}const Z8=new ie,K8=new ie;class iE extends o2{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)Z8.fromBufferAttribute(t,r),K8.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+Z8.distanceTo(K8);e.setAttribute("lineDistance",new ei(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Jx extends ds{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ft(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const J8=new en,Bv=new n2,lm=new Hu,um=new ie;class Eq extends Ci{constructor(e=new Ai,t=new Jx){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),lm.copy(i.boundingSphere),lm.applyMatrix4(r),lm.radius+=s,e.ray.intersectsSphere(lm)===!1)return;J8.copy(r).invert(),Bv.copy(e.ray).applyMatrix4(J8);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=i.index,p=i.attributes.position;if(u!==null){const g=Math.max(0,o.start),v=Math.min(u.count,o.start+o.count);for(let x=g,S=v;x<S;x++){const T=u.getX(x);um.fromBufferAttribute(p,T),e6(um,T,l,r,e,t,this)}}else{const g=Math.max(0,o.start),v=Math.min(p.count,o.start+o.count);for(let x=g,S=v;x<S;x++)um.fromBufferAttribute(p,x),e6(um,x,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function e6(n,e,t,i,r,s,o){const a=Bv.distanceSqToPoint(n);if(a<t){const l=new ie;Bv.closestPointToPoint(n,l),l.applyMatrix4(i);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class rE extends vr{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Mi,this.minFilter=Mi,this.generateMipmaps=!1,this.needsUpdate=!0}}class Cq extends vr{constructor(e,t,i,r,s,o,a,l,u){super(e,t,i,r,s,o,a,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ys extends vr{constructor(e,t,i=bi,r,s,o,a=Mi,l=Mi,u,A=xo){if(A!==xo&&A!==bo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,r,s,o,a,l,A,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Wx(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class sE extends Ys{constructor(e=1,t=1,i=1){super(e,t),this.isDepthArrayTexture=!0,this.image={width:e,height:t,depth:i},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class a2 extends Ai{constructor(e=1,t=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],u=new ie,A=new at;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let p=0,g=3;p<=t;p++,g+=3){const v=i+p/t*r;u.x=e*Math.cos(v),u.y=e*Math.sin(v),o.push(u.x,u.y,u.z),a.push(0,0,1),A.x=(o[g]/e+1)/2,A.y=(o[g+1]/e+1)/2,l.push(A.x,A.y)}for(let p=1;p<=t;p++)s.push(p,p+1,0);this.setIndex(s),this.setAttribute("position",new ei(o,3)),this.setAttribute("normal",new ei(a,3)),this.setAttribute("uv",new ei(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new a2(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class l2 extends Ai{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const u=this;r=Math.floor(r),s=Math.floor(s);const A=[],p=[],g=[],v=[];let x=0;const S=[],T=i/2;let w=0;R(),o===!1&&(e>0&&E(!0),t>0&&E(!1)),this.setIndex(A),this.setAttribute("position",new ei(p,3)),this.setAttribute("normal",new ei(g,3)),this.setAttribute("uv",new ei(v,2));function R(){const N=new ie,D=new ie;let B=0;const I=(t-e)/i;for(let O=0;O<=s;O++){const L=[],F=O/s,V=F*(t-e)+e;for(let H=0;H<=r;H++){const Q=H/r,te=Q*l+a,K=Math.sin(te),W=Math.cos(te);D.x=V*K,D.y=-F*i+T,D.z=V*W,p.push(D.x,D.y,D.z),N.set(K,I,W).normalize(),g.push(N.x,N.y,N.z),v.push(Q,1-F),L.push(x++)}S.push(L)}for(let O=0;O<r;O++)for(let L=0;L<s;L++){const F=S[L][O],V=S[L+1][O],H=S[L+1][O+1],Q=S[L][O+1];(e>0||L!==0)&&(A.push(F,V,Q),B+=3),(t>0||L!==s-1)&&(A.push(V,H,Q),B+=3)}u.addGroup(w,B,0),w+=B}function E(N){const D=x,B=new at,I=new ie;let O=0;const L=N===!0?e:t,F=N===!0?1:-1;for(let H=1;H<=r;H++)p.push(0,T*F,0),g.push(0,F,0),v.push(.5,.5),x++;const V=x;for(let H=0;H<=r;H++){const te=H/r*l+a,K=Math.cos(te),W=Math.sin(te);I.x=L*W,I.y=T*F,I.z=L*K,p.push(I.x,I.y,I.z),g.push(0,F,0),B.x=K*.5+.5,B.y=W*.5*F+.5,v.push(B.x,B.y),x++}for(let H=0;H<r;H++){const Q=D+H,te=V+H;N===!0?A.push(te,te+1,Q):A.push(te+1,te,Q),O+=3}u.addGroup(w,O,N===!0?1:2),w+=O}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new l2(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class xa{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const i=this.getLengths();let r=0;const s=i.length;let o;t?o=t:o=e*i[s-1];let a=0,l=s-1,u;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),u=i[r]-o,u<0)a=r+1;else if(u>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const A=i[r],g=i[r+1]-A,v=(o-A)/g;return(r+v)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new at:new ie);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t=!1){const i=new ie,r=[],s=[],o=[],a=new ie,l=new en;for(let v=0;v<=e;v++){const x=v/e;r[v]=this.getTangentAt(x,new ie)}s[0]=new ie,o[0]=new ie;let u=Number.MAX_VALUE;const A=Math.abs(r[0].x),p=Math.abs(r[0].y),g=Math.abs(r[0].z);A<=u&&(u=A,i.set(1,0,0)),p<=u&&(u=p,i.set(0,1,0)),g<=u&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let v=1;v<=e;v++){if(s[v]=s[v-1].clone(),o[v]=o[v-1].clone(),a.crossVectors(r[v-1],r[v]),a.length()>Number.EPSILON){a.normalize();const x=Math.acos(En(r[v-1].dot(r[v]),-1,1));s[v].applyMatrix4(l.makeRotationAxis(a,x))}o[v].crossVectors(r[v],s[v])}if(t===!0){let v=Math.acos(En(s[0].dot(s[e]),-1,1));v/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(v=-v);for(let x=1;x<=e;x++)s[x].applyMatrix4(l.makeRotationAxis(r[x],v*x)),o[x].crossVectors(r[x],s[x])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class e4 extends xa{constructor(e=0,t=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new at){const i=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const A=Math.cos(this.aRotation),p=Math.sin(this.aRotation),g=l-this.aX,v=u-this.aY;l=g*A-v*p+this.aX,u=g*p+v*A+this.aY}return i.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Rq extends e4{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function t4(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){r(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,A,p){let g=(o-s)/u-(a-s)/(u+A)+(a-o)/A,v=(a-o)/A-(l-o)/(A+p)+(l-a)/p;g*=A,v*=A,r(o,a,g,v)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+i*a}}}const cm=new ie,t3=new t4,n3=new t4,i3=new t4;class Nq extends xa{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new ie){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let u,A;this.closed||a>0?u=r[(a-1)%s]:(cm.subVectors(r[0],r[1]).add(r[0]),u=cm);const p=r[a%s],g=r[(a+1)%s];if(this.closed||a+2<s?A=r[(a+2)%s]:(cm.subVectors(r[s-1],r[s-2]).add(r[s-1]),A=cm),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let x=Math.pow(u.distanceToSquared(p),v),S=Math.pow(p.distanceToSquared(g),v),T=Math.pow(g.distanceToSquared(A),v);S<1e-4&&(S=1),x<1e-4&&(x=S),T<1e-4&&(T=S),t3.initNonuniformCatmullRom(u.x,p.x,g.x,A.x,x,S,T),n3.initNonuniformCatmullRom(u.y,p.y,g.y,A.y,x,S,T),i3.initNonuniformCatmullRom(u.z,p.z,g.z,A.z,x,S,T)}else this.curveType==="catmullrom"&&(t3.initCatmullRom(u.x,p.x,g.x,A.x,this.tension),n3.initCatmullRom(u.y,p.y,g.y,A.y,this.tension),i3.initCatmullRom(u.z,p.z,g.z,A.z,this.tension));return i.set(t3.calc(l),n3.calc(l),i3.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new ie().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function t6(n,e,t,i,r){const s=(i-e)*.5,o=(r-t)*.5,a=n*n,l=n*a;return(2*t-2*i+s+o)*l+(-3*t+3*i-2*s-o)*a+s*n+t}function Pq(n,e){const t=1-n;return t*t*e}function Lq(n,e){return 2*(1-n)*n*e}function Dq(n,e){return n*n*e}function O0(n,e,t,i){return Pq(n,e)+Lq(n,t)+Dq(n,i)}function Iq(n,e){const t=1-n;return t*t*t*e}function Bq(n,e){const t=1-n;return 3*t*t*n*e}function Fq(n,e){return 3*(1-n)*n*n*e}function Uq(n,e){return n*n*n*e}function k0(n,e,t,i,r){return Iq(n,e)+Bq(n,t)+Fq(n,i)+Uq(n,r)}class oE extends xa{constructor(e=new at,t=new at,i=new at,r=new at){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new at){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(k0(e,r.x,s.x,o.x,a.x),k0(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class aE extends xa{constructor(e=new ie,t=new ie,i=new ie,r=new ie){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new ie){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(k0(e,r.x,s.x,o.x,a.x),k0(e,r.y,s.y,o.y,a.y),k0(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class lE extends xa{constructor(e=new at,t=new at){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new at){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new at){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Oq extends xa{constructor(e=new ie,t=new ie){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ie){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ie){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class uE extends xa{constructor(e=new at,t=new at,i=new at){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new at){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(O0(e,r.x,s.x,o.x),O0(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class cE extends xa{constructor(e=new ie,t=new ie,i=new ie){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new ie){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(O0(e,r.x,s.x,o.x),O0(e,r.y,s.y,o.y),O0(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class hE extends xa{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new at){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],u=r[o],A=r[o>r.length-2?r.length-1:o+1],p=r[o>r.length-3?r.length-1:o+2];return i.set(t6(a,l.x,u.x,A.x,p.x),t6(a,l.y,u.y,A.y,p.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new at().fromArray(r))}return this}}var H1=Object.freeze({__proto__:null,ArcCurve:Rq,CatmullRomCurve3:Nq,CubicBezierCurve:oE,CubicBezierCurve3:aE,EllipseCurve:e4,LineCurve:lE,LineCurve3:Oq,QuadraticBezierCurve:uE,QuadraticBezierCurve3:cE,SplineCurve:hE});class kq extends xa{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new H1[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),u=l===0?0:1-o/l;return a.getPointAt(u,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let u=0;u<l.length;u++){const A=l[u];i&&i.equals(A)||(t.push(A),i=A)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new H1[r.type]().fromJSON(r))}return this}}let Fv=class extends kq{constructor(e){super(),this.type="Path",this.currentPoint=new at,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new lE(this.currentPoint.clone(),new at(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new uE(this.currentPoint.clone(),new at(e,t),new at(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new oE(this.currentPoint.clone(),new at(e,t),new at(i,r),new at(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new hE(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){const u=this.currentPoint.x,A=this.currentPoint.y;return this.absellipse(e+u,t+A,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const u=new e4(e,t,i,r,s,o,a,l);if(this.curves.length>0){const p=u.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(u);const A=u.getPoint(1);return this.currentPoint.copy(A),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};class f1 extends Fv{constructor(e){super(e),this.uuid=Ha(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new Fv().fromJSON(r))}return this}}function Vq(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=fE(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u;if(i&&(s=$q(n,e,s,t)),n.length>80*t){a=1/0,l=1/0;let A=-1/0,p=-1/0;for(let g=t;g<r;g+=t){const v=n[g],x=n[g+1];v<a&&(a=v),x<l&&(l=x),v>A&&(A=v),x>p&&(p=x)}u=Math.max(A-a,p-l),u=u!==0?32767/u:0}return xd(s,o,t,a,l,u,0),o}function fE(n,e,t,i,r){let s;if(r===nz(n,e,t,i)>0)for(let o=e;o<t;o+=i)s=n6(o/i|0,n[o],n[o+1],s);else for(let o=t-i;o>=e;o-=i)s=n6(o/i|0,n[o],n[o+1],s);return s&&sA(s,s.next)&&(wd(s),s=s.next),s}function ih(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(sA(t,t.next)||$i(t.prev,t,t.next)===0)){if(wd(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function xd(n,e,t,i,r,s,o){if(!n)return;!o&&s&&Yq(n,i,r,s);let a=n;for(;n.prev!==n.next;){const l=n.prev,u=n.next;if(s?qq(n,i,r,s):Gq(n)){e.push(l.i,n.i,u.i),wd(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=zq(ih(n),e),xd(n,e,t,i,r,s,2)):o===2&&Hq(n,e,t,i,r,s):xd(ih(n),e,t,i,r,s,1);break}}}function Gq(n){const e=n.prev,t=n,i=n.next;if($i(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,A=Math.min(r,s,o),p=Math.min(a,l,u),g=Math.max(r,s,o),v=Math.max(a,l,u);let x=i.next;for(;x!==e;){if(x.x>=A&&x.x<=g&&x.y>=p&&x.y<=v&&y0(r,a,s,l,o,u,x.x,x.y)&&$i(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function qq(n,e,t,i){const r=n.prev,s=n,o=n.next;if($i(r,s,o)>=0)return!1;const a=r.x,l=s.x,u=o.x,A=r.y,p=s.y,g=o.y,v=Math.min(a,l,u),x=Math.min(A,p,g),S=Math.max(a,l,u),T=Math.max(A,p,g),w=Uv(v,x,e,t,i),R=Uv(S,T,e,t,i);let E=n.prevZ,N=n.nextZ;for(;E&&E.z>=w&&N&&N.z<=R;){if(E.x>=v&&E.x<=S&&E.y>=x&&E.y<=T&&E!==r&&E!==o&&y0(a,A,l,p,u,g,E.x,E.y)&&$i(E.prev,E,E.next)>=0||(E=E.prevZ,N.x>=v&&N.x<=S&&N.y>=x&&N.y<=T&&N!==r&&N!==o&&y0(a,A,l,p,u,g,N.x,N.y)&&$i(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;E&&E.z>=w;){if(E.x>=v&&E.x<=S&&E.y>=x&&E.y<=T&&E!==r&&E!==o&&y0(a,A,l,p,u,g,E.x,E.y)&&$i(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;N&&N.z<=R;){if(N.x>=v&&N.x<=S&&N.y>=x&&N.y<=T&&N!==r&&N!==o&&y0(a,A,l,p,u,g,N.x,N.y)&&$i(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function zq(n,e){let t=n;do{const i=t.prev,r=t.next.next;!sA(i,r)&&dE(i,t,t.next,r)&&bd(i,r)&&bd(r,i)&&(e.push(i.i,t.i,r.i),wd(t),wd(t.next),t=n=r),t=t.next}while(t!==n);return ih(t)}function Hq(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Jq(o,a)){let l=pE(o,a);o=ih(o,o.next),l=ih(l,l.next),xd(o,e,t,i,r,s,0),xd(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function $q(n,e,t,i){const r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,u=fE(n,a,l,i,!1);u===u.next&&(u.steiner=!0),r.push(Kq(u))}r.sort(Wq);for(let s=0;s<r.length;s++)t=jq(r[s],t);return t}function Wq(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const i=(n.next.y-n.y)/(n.next.x-n.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=i-r}return t}function jq(n,e){const t=Xq(n,e);if(!t)return e;const i=pE(t,n);return ih(i,i.next),ih(t,t.next)}function Xq(n,e){let t=e;const i=n.x,r=n.y;let s=-1/0,o;if(sA(n,t))return t;do{if(sA(n,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const p=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=i&&p>s&&(s=p,o=t.x<t.next.x?t:t.next,p===i))return o}t=t.next}while(t!==e);if(!o)return null;const a=o,l=o.x,u=o.y;let A=1/0;t=o;do{if(i>=t.x&&t.x>=l&&i!==t.x&&AE(r<u?i:s,r,l,u,r<u?s:i,r,t.x,t.y)){const p=Math.abs(r-t.y)/(i-t.x);bd(t,n)&&(p<A||p===A&&(t.x>o.x||t.x===o.x&&Qq(o,t)))&&(o=t,A=p)}t=t.next}while(t!==a);return o}function Qq(n,e){return $i(n.prev,n,e.prev)<0&&$i(e.next,n,n.next)<0}function Yq(n,e,t,i){let r=n;do r.z===0&&(r.z=Uv(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,Zq(r)}function Zq(n){let e,t=1;do{let i=n,r;n=null;let s=null;for(e=0;i;){e++;let o=i,a=0;for(let u=0;u<t&&(a++,o=o.nextZ,!!o);u++);let l=t;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||i.z<=o.z)?(r=i,i=i.nextZ,a--):(r=o,o=o.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;i=o}s.nextZ=null,t*=2}while(e>1);return n}function Uv(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function Kq(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function AE(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function y0(n,e,t,i,r,s,o,a){return!(n===o&&e===a)&&AE(n,e,t,i,r,s,o,a)}function Jq(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!ez(n,e)&&(bd(n,e)&&bd(e,n)&&tz(n,e)&&($i(n.prev,n,e.prev)||$i(n,e.prev,e))||sA(n,e)&&$i(n.prev,n,n.next)>0&&$i(e.prev,e,e.next)>0)}function $i(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function sA(n,e){return n.x===e.x&&n.y===e.y}function dE(n,e,t,i){const r=fm($i(n,e,t)),s=fm($i(n,e,i)),o=fm($i(t,i,n)),a=fm($i(t,i,e));return!!(r!==s&&o!==a||r===0&&hm(n,t,e)||s===0&&hm(n,i,e)||o===0&&hm(t,n,i)||a===0&&hm(t,e,i))}function hm(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function fm(n){return n>0?1:n<0?-1:0}function ez(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&dE(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function bd(n,e){return $i(n.prev,n,n.next)<0?$i(n,e,n.next)>=0&&$i(n,n.prev,e)>=0:$i(n,e,n.prev)<0||$i(n,n.next,e)<0}function tz(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function pE(n,e){const t=Ov(n.i,n.x,n.y),i=Ov(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function n6(n,e,t,i){const r=Ov(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function wd(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Ov(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function nz(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}class iz{static triangulate(e,t,i=2){return Vq(e,t,i)}}class Pc{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return Pc.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];i6(e),r6(i,e);let o=e.length;t.forEach(i6);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,r6(i,t[l]);const a=iz.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function i6(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function r6(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class n4 extends Ai{constructor(e=new f1([new at(.5,.5),new at(-.5,.5),new at(-.5,-.5),new at(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];o(u)}this.setAttribute("position",new ei(r,3)),this.setAttribute("uv",new ei(s,2)),this.computeVertexNormals();function o(a){const l=[],u=t.curveSegments!==void 0?t.curveSegments:12,A=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1;let g=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.bevelThickness!==void 0?t.bevelThickness:.2,x=t.bevelSize!==void 0?t.bevelSize:v-.1,S=t.bevelOffset!==void 0?t.bevelOffset:0,T=t.bevelSegments!==void 0?t.bevelSegments:3;const w=t.extrudePath,R=t.UVGenerator!==void 0?t.UVGenerator:rz;let E,N=!1,D,B,I,O;w&&(E=w.getSpacedPoints(A),N=!0,g=!1,D=w.computeFrenetFrames(A,!1),B=new ie,I=new ie,O=new ie),g||(T=0,v=0,x=0,S=0);const L=a.extractPoints(u);let F=L.shape;const V=L.holes;if(!Pc.isClockWise(F)){F=F.reverse();for(let G=0,Ee=V.length;G<Ee;G++){const ye=V[G];Pc.isClockWise(ye)&&(V[G]=ye.reverse())}}function Q(G){const ye=10000000000000001e-36;let we=G[0];for(let Se=1;Se<=G.length;Se++){const ze=Se%G.length,Ne=G[ze],j=Ne.x-we.x,q=Ne.y-we.y,he=j*j+q*q,Me=Math.max(Math.abs(Ne.x),Math.abs(Ne.y),Math.abs(we.x),Math.abs(we.y)),Ue=ye*Me*Me;if(he<=Ue){G.splice(ze,1),Se--;continue}we=Ne}}Q(F),V.forEach(Q);const te=V.length,K=F;for(let G=0;G<te;G++){const Ee=V[G];F=F.concat(Ee)}function W(G,Ee,ye){return Ee||console.error("THREE.ExtrudeGeometry: vec does not exist"),G.clone().addScaledVector(Ee,ye)}const Z=F.length;function J(G,Ee,ye){let we,Se,ze;const Ne=G.x-Ee.x,j=G.y-Ee.y,q=ye.x-G.x,he=ye.y-G.y,Me=Ne*Ne+j*j,Ue=Ne*he-j*q;if(Math.abs(Ue)>Number.EPSILON){const Be=Math.sqrt(Me),At=Math.sqrt(q*q+he*he),tt=Ee.x-j/Be,Nt=Ee.y+Ne/Be,It=ye.x-he/At,st=ye.y+q/At,bt=((It-tt)*he-(st-Nt)*q)/(Ne*he-j*q);we=tt+Ne*bt-G.x,Se=Nt+j*bt-G.y;const Gt=we*we+Se*Se;if(Gt<=2)return new at(we,Se);ze=Math.sqrt(Gt/2)}else{let Be=!1;Ne>Number.EPSILON?q>Number.EPSILON&&(Be=!0):Ne<-Number.EPSILON?q<-Number.EPSILON&&(Be=!0):Math.sign(j)===Math.sign(he)&&(Be=!0),Be?(we=-j,Se=Ne,ze=Math.sqrt(Me)):(we=Ne,Se=j,ze=Math.sqrt(Me/2))}return new at(we/ze,Se/ze)}const fe=[];for(let G=0,Ee=K.length,ye=Ee-1,we=G+1;G<Ee;G++,ye++,we++)ye===Ee&&(ye=0),we===Ee&&(we=0),fe[G]=J(K[G],K[ye],K[we]);const ge=[];let pe,Ae=fe.concat();for(let G=0,Ee=te;G<Ee;G++){const ye=V[G];pe=[];for(let we=0,Se=ye.length,ze=Se-1,Ne=we+1;we<Se;we++,ze++,Ne++)ze===Se&&(ze=0),Ne===Se&&(Ne=0),pe[we]=J(ye[we],ye[ze],ye[Ne]);ge.push(pe),Ae=Ae.concat(pe)}let Fe;if(T===0)Fe=Pc.triangulateShape(K,V);else{const G=[],Ee=[];for(let ye=0;ye<T;ye++){const we=ye/T,Se=v*Math.cos(we*Math.PI/2),ze=x*Math.sin(we*Math.PI/2)+S;for(let Ne=0,j=K.length;Ne<j;Ne++){const q=W(K[Ne],fe[Ne],ze);yt(q.x,q.y,-Se),we===0&&G.push(q)}for(let Ne=0,j=te;Ne<j;Ne++){const q=V[Ne];pe=ge[Ne];const he=[];for(let Me=0,Ue=q.length;Me<Ue;Me++){const Be=W(q[Me],pe[Me],ze);yt(Be.x,Be.y,-Se),we===0&&he.push(Be)}we===0&&Ee.push(he)}}Fe=Pc.triangulateShape(G,Ee)}const be=Fe.length,Ve=x+S;for(let G=0;G<Z;G++){const Ee=g?W(F[G],Ae[G],Ve):F[G];N?(I.copy(D.normals[0]).multiplyScalar(Ee.x),B.copy(D.binormals[0]).multiplyScalar(Ee.y),O.copy(E[0]).add(I).add(B),yt(O.x,O.y,O.z)):yt(Ee.x,Ee.y,0)}for(let G=1;G<=A;G++)for(let Ee=0;Ee<Z;Ee++){const ye=g?W(F[Ee],Ae[Ee],Ve):F[Ee];N?(I.copy(D.normals[G]).multiplyScalar(ye.x),B.copy(D.binormals[G]).multiplyScalar(ye.y),O.copy(E[G]).add(I).add(B),yt(O.x,O.y,O.z)):yt(ye.x,ye.y,p/A*G)}for(let G=T-1;G>=0;G--){const Ee=G/T,ye=v*Math.cos(Ee*Math.PI/2),we=x*Math.sin(Ee*Math.PI/2)+S;for(let Se=0,ze=K.length;Se<ze;Se++){const Ne=W(K[Se],fe[Se],we);yt(Ne.x,Ne.y,p+ye)}for(let Se=0,ze=V.length;Se<ze;Se++){const Ne=V[Se];pe=ge[Se];for(let j=0,q=Ne.length;j<q;j++){const he=W(Ne[j],pe[j],we);N?yt(he.x,he.y+E[A-1].y,E[A-1].x+ye):yt(he.x,he.y,p+ye)}}}Ye(),Xe();function Ye(){const G=r.length/3;if(g){let Ee=0,ye=Z*Ee;for(let we=0;we<be;we++){const Se=Fe[we];ut(Se[2]+ye,Se[1]+ye,Se[0]+ye)}Ee=A+T*2,ye=Z*Ee;for(let we=0;we<be;we++){const Se=Fe[we];ut(Se[0]+ye,Se[1]+ye,Se[2]+ye)}}else{for(let Ee=0;Ee<be;Ee++){const ye=Fe[Ee];ut(ye[2],ye[1],ye[0])}for(let Ee=0;Ee<be;Ee++){const ye=Fe[Ee];ut(ye[0]+Z*A,ye[1]+Z*A,ye[2]+Z*A)}}i.addGroup(G,r.length/3-G,0)}function Xe(){const G=r.length/3;let Ee=0;Tt(K,Ee),Ee+=K.length;for(let ye=0,we=V.length;ye<we;ye++){const Se=V[ye];Tt(Se,Ee),Ee+=Se.length}i.addGroup(G,r.length/3-G,1)}function Tt(G,Ee){let ye=G.length;for(;--ye>=0;){const we=ye;let Se=ye-1;Se<0&&(Se=G.length-1);for(let ze=0,Ne=A+T*2;ze<Ne;ze++){const j=Z*ze,q=Z*(ze+1),he=Ee+we+j,Me=Ee+Se+j,Ue=Ee+Se+q,Be=Ee+we+q;Ut(he,Me,Ue,Be)}}}function yt(G,Ee,ye){l.push(G),l.push(Ee),l.push(ye)}function ut(G,Ee,ye){ue(G),ue(Ee),ue(ye);const we=r.length/3,Se=R.generateTopUV(i,r,we-3,we-2,we-1);ce(Se[0]),ce(Se[1]),ce(Se[2])}function Ut(G,Ee,ye,we){ue(G),ue(Ee),ue(we),ue(Ee),ue(ye),ue(we);const Se=r.length/3,ze=R.generateSideWallUV(i,r,Se-6,Se-3,Se-2,Se-1);ce(ze[0]),ce(ze[1]),ce(ze[3]),ce(ze[1]),ce(ze[2]),ce(ze[3])}function ue(G){r.push(l[G*3+0]),r.push(l[G*3+1]),r.push(l[G*3+2])}function ce(G){s.push(G.x),s.push(G.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return sz(t,i,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new H1[r.type]().fromJSON(r)),new n4(i,e.options)}}const rz={generateTopUV:function(n,e,t,i,r){const s=e[t*3],o=e[t*3+1],a=e[i*3],l=e[i*3+1],u=e[r*3],A=e[r*3+1];return[new at(s,o),new at(a,l),new at(u,A)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],u=e[i*3],A=e[i*3+1],p=e[i*3+2],g=e[r*3],v=e[r*3+1],x=e[r*3+2],S=e[s*3],T=e[s*3+1],w=e[s*3+2];return Math.abs(a-A)<Math.abs(o-u)?[new at(o,1-l),new at(u,1-p),new at(g,1-x),new at(S,1-w)]:[new at(a,1-l),new at(A,1-p),new at(v,1-x),new at(T,1-w)]}};function sz(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const s=n[i];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class sp extends Ai{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),u=a+1,A=l+1,p=e/a,g=t/l,v=[],x=[],S=[],T=[];for(let w=0;w<A;w++){const R=w*g-o;for(let E=0;E<u;E++){const N=E*p-s;x.push(N,-R,0),S.push(0,0,1),T.push(E/a),T.push(1-w/l)}}for(let w=0;w<l;w++)for(let R=0;R<a;R++){const E=R+u*w,N=R+u*(w+1),D=R+1+u*(w+1),B=R+1+u*w;v.push(E,N,B),v.push(N,D,B)}this.setIndex(v),this.setAttribute("position",new ei(x,3)),this.setAttribute("normal",new ei(S,3)),this.setAttribute("uv",new ei(T,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sp(e.width,e.height,e.widthSegments,e.heightSegments)}}class al extends Ai{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let u=0;const A=[],p=new ie,g=new ie,v=[],x=[],S=[],T=[];for(let w=0;w<=i;w++){const R=[],E=w/i;let N=0;w===0&&o===0?N=.5/t:w===i&&l===Math.PI&&(N=-.5/t);for(let D=0;D<=t;D++){const B=D/t;p.x=-e*Math.cos(r+B*s)*Math.sin(o+E*a),p.y=e*Math.cos(o+E*a),p.z=e*Math.sin(r+B*s)*Math.sin(o+E*a),x.push(p.x,p.y,p.z),g.copy(p).normalize(),S.push(g.x,g.y,g.z),T.push(B+N,1-E),R.push(u++)}A.push(R)}for(let w=0;w<i;w++)for(let R=0;R<t;R++){const E=A[w][R+1],N=A[w][R],D=A[w+1][R],B=A[w+1][R+1];(w!==0||o>0)&&v.push(E,N,B),(w!==i-1||l<Math.PI)&&v.push(N,D,B)}this.setIndex(v),this.setAttribute("position",new ei(x,3)),this.setAttribute("normal",new ei(S,3)),this.setAttribute("uv",new ei(T,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new al(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class i4 extends Ai{constructor(e=new cE(new ie(-1,-1,0),new ie(-1,1,0),new ie(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new ie,l=new ie,u=new at;let A=new ie;const p=[],g=[],v=[],x=[];S(),this.setIndex(x),this.setAttribute("position",new ei(p,3)),this.setAttribute("normal",new ei(g,3)),this.setAttribute("uv",new ei(v,2));function S(){for(let E=0;E<t;E++)T(E);T(s===!1?t:0),R(),w()}function T(E){A=e.getPointAt(E/t,A);const N=o.normals[E],D=o.binormals[E];for(let B=0;B<=r;B++){const I=B/r*Math.PI*2,O=Math.sin(I),L=-Math.cos(I);l.x=L*N.x+O*D.x,l.y=L*N.y+O*D.y,l.z=L*N.z+O*D.z,l.normalize(),g.push(l.x,l.y,l.z),a.x=A.x+i*l.x,a.y=A.y+i*l.y,a.z=A.z+i*l.z,p.push(a.x,a.y,a.z)}}function w(){for(let E=1;E<=t;E++)for(let N=1;N<=r;N++){const D=(r+1)*(E-1)+(N-1),B=(r+1)*E+(N-1),I=(r+1)*E+N,O=(r+1)*(E-1)+N;x.push(D,B,O),x.push(B,I,O)}}function R(){for(let E=0;E<=t;E++)for(let N=0;N<=r;N++)u.x=E/t,u.y=N/r,v.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new i4(new H1[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class oz extends Ai{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new ie,s=new ie;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,A=l.length;u<A;++u){const p=l[u],g=p.start,v=p.count;for(let x=g,S=g+v;x<S;x+=3)for(let T=0;T<3;T++){const w=a.getX(x+T),R=a.getX(x+(T+1)%3);r.fromBufferAttribute(o,w),s.fromBufferAttribute(o,R),s6(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let u=0;u<3;u++){const A=3*a+u,p=3*a+(u+1)%3;r.fromBufferAttribute(o,A),s.fromBufferAttribute(o,p),s6(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new ei(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function s6(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}class az extends ds{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ft(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class mE extends ds{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Ft(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ol,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Qr,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class lz extends mE{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new at(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return En(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ft(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ft(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ft(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class gE extends ds{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ft(16777215),this.specular=new Ft(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ol,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Qr,this.combine=tp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uz extends ds{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ft(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ol,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class cz extends ds{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ol,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class ll extends ds{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ol,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Qr,this.combine=tp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class hz extends ds{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=xG,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class fz extends ds{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Az extends ds{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ft(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ol,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class dz extends SA{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const o6={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class pz{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(A){a++,s===!1&&r.onStart!==void 0&&r.onStart(A,o,a),s=!0},this.itemEnd=function(A){o++,r.onProgress!==void 0&&r.onProgress(A,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(A){r.onError!==void 0&&r.onError(A)},this.resolveURL=function(A){return l?l(A):A},this.setURLModifier=function(A){return l=A,this},this.addHandler=function(A,p){return u.push(A,p),this},this.removeHandler=function(A){const p=u.indexOf(A);return p!==-1&&u.splice(p,2),this},this.getHandler=function(A){for(let p=0,g=u.length;p<g;p+=2){const v=u[p],x=u[p+1];if(v.global&&(v.lastIndex=0),v.test(A))return x}return null}}}const mz=new pz;class r4{constructor(e){this.manager=e!==void 0?e:mz,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}r4.DEFAULT_MATERIAL_NAME="__DEFAULT";class gz extends r4{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=o6.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=yd("img");function l(){A(),o6.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(p){A(),r&&r(p),s.manager.itemError(e),s.manager.itemEnd(e)}function A(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class _E extends r4{constructor(e){super(e)}load(e,t,i,r){const s=new vr,o=new gz(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class ch extends Ci{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ft(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class _z extends ch{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ci.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ft(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const r3=new en,a6=new ie,l6=new ie;class s4{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new at(512,512),this.mapType=ji,this.map=null,this.mapPass=null,this.matrix=new en,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new wA,this._frameExtents=new at(1,1),this._viewportCount=1,this._viewports=[new $t(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;a6.setFromMatrixPosition(e.matrixWorld),t.position.copy(a6),l6.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(l6),t.updateMatrixWorld(),r3.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r3),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(r3)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class vz extends s4{constructor(){super(new Br(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=th*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class vE extends ch{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ci.DEFAULT_UP),this.updateMatrix(),this.target=new Ci,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new vz}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const u6=new en,YA=new ie,s3=new ie;class yz extends s4{constructor(){super(new Br(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new at(4,2),this._viewportCount=6,this._viewports=[new $t(2,1,1,1),new $t(0,1,1,1),new $t(3,1,1,1),new $t(1,1,1,1),new $t(3,0,1,1),new $t(1,0,1,1)],this._cubeDirections=[new ie(1,0,0),new ie(-1,0,0),new ie(0,0,1),new ie(0,0,-1),new ie(0,1,0),new ie(0,-1,0)],this._cubeUps=[new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,0,1),new ie(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),YA.setFromMatrixPosition(e.matrixWorld),i.position.copy(YA),s3.copy(i.position),s3.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(s3),i.updateMatrixWorld(),r.makeTranslation(-YA.x,-YA.y,-YA.z),u6.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(u6)}}class xz extends ch{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new yz}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class u2 extends rp{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,A=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=A*this.view.offsetY,l=a-A*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class bz extends s4{constructor(){super(new u2(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class yE extends ch{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ci.DEFAULT_UP),this.updateMatrix(),this.target=new Ci,this.shadow=new bz}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class xE extends ch{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class wz extends ch{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Sz{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ie)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],1.092548*(i*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(i*s)),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*i),t.addScaledVector(o[4],2*.429043*i*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class Tz extends ch{constructor(e=new Sz,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Mz extends Ai{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class bE extends Br{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class Ez extends ol{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isRenderTargetArray=!0,this.depth=i,this.texture=new t2(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class $1 extends s2{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}const c6=new en;class C1e{constructor(e,t,i=0,r=1/0){this.ray=new n2(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new jx,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return c6.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(c6),this}intersectObject(e,t=!0,i=[]){return kv(e,this,i,t),i.sort(h6),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)kv(e[r],this,i,t);return i.sort(h6),i}}function h6(n,e){return n.distance-e.distance}function kv(n,e,t,i){let r=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(r=!1),r===!0&&i===!0){const s=n.children;for(let o=0,a=s.length;o<a;o++)kv(s[o],e,t,!0)}}class R1e{constructor(e=1,t=0,i=0){this.radius=e,this.phi=t,this.theta=i}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=En(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(En(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class c2{constructor(e,t,i,r){c2.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let i=0;i<4;i++)this.elements[i]=e[i+t];return this}set(e,t,i,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=i,s[3]=r,this}}const f6=new ie,Am=new ie;class Cz{constructor(e=new ie,t=new ie){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){f6.subVectors(e,this.start),Am.subVectors(this.end,this.start);const i=Am.dot(Am);let s=Am.dot(f6)/i;return t&&(s=En(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class Rz{constructor(){this.type="ShapePath",this.color=new Ft,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Fv,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(w){const R=[];for(let E=0,N=w.length;E<N;E++){const D=w[E],B=new f1;B.curves=D.curves,R.push(B)}return R}function i(w,R){const E=R.length;let N=!1;for(let D=E-1,B=0;B<E;D=B++){let I=R[D],O=R[B],L=O.x-I.x,F=O.y-I.y;if(Math.abs(F)>Number.EPSILON){if(F<0&&(I=R[B],L=-L,O=R[D],F=-F),w.y<I.y||w.y>O.y)continue;if(w.y===I.y){if(w.x===I.x)return!0}else{const V=F*(w.x-I.x)-L*(w.y-I.y);if(V===0)return!0;if(V<0)continue;N=!N}}else{if(w.y!==I.y)continue;if(O.x<=w.x&&w.x<=I.x||I.x<=w.x&&w.x<=O.x)return!0}}return N}const r=Pc.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const u=[];if(s.length===1)return a=s[0],l=new f1,l.curves=a.curves,u.push(l),u;let A=!r(s[0].getPoints());A=e?!A:A;const p=[],g=[];let v=[],x=0,S;g[x]=void 0,v[x]=[];for(let w=0,R=s.length;w<R;w++)a=s[w],S=a.getPoints(),o=r(S),o=e?!o:o,o?(!A&&g[x]&&x++,g[x]={s:new f1,p:S},g[x].s.curves=a.curves,A&&x++,v[x]=[]):v[x].push({h:a,p:S[0]});if(!g[0])return t(s);if(g.length>1){let w=!1,R=0;for(let E=0,N=g.length;E<N;E++)p[E]=[];for(let E=0,N=g.length;E<N;E++){const D=v[E];for(let B=0;B<D.length;B++){const I=D[B];let O=!0;for(let L=0;L<g.length;L++)i(I.p,g[L].p)&&(E!==L&&R++,O?(O=!1,p[L].push(I)):w=!0);O&&p[E].push(I)}}R>0&&w===!1&&(v=p)}let T;for(let w=0,R=g.length;w<R;w++){l=g[w].s,u.push(l),T=v[w];for(let E=0,N=T.length;E<N;E++)l.holes.push(T[E].h)}return u}}class N1e extends sl{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function A6(n,e,t,i){const r=Nz(i);switch(t){case Bx:return n*e;case ip:return n*e/r.components*r.byteLength;case vA:return n*e/r.components*r.byteLength;case Ll:return n*e*2/r.components*r.byteLength;case yA:return n*e*2/r.components*r.byteLength;case np:return n*e*3/r.components*r.byteLength;case ir:return n*e*4/r.components*r.byteLength;case xA:return n*e*4/r.components*r.byteLength;case kc:case Nu:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Pu:case Lu:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Ad:case pd:return Math.max(n,16)*Math.max(e,8)/4;case fd:case dd:return Math.max(n,8)*Math.max(e,8)/2;case md:case qf:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case zf:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Hf:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case $f:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case Wf:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case jf:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case Xf:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case Qf:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case Yf:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case Zf:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case Kf:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case Jf:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case eA:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case tA:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case nA:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case iA:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case Vc:case Lv:case Dv:return Math.ceil(n/4)*Math.ceil(e/4)*16;case Fx:case gd:return Math.ceil(n/4)*Math.ceil(e/4)*8;case _d:case vd:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Nz(n){switch(n){case ji:case Uc:return{byteLength:1,components:1};case sa:case Oc:case Mr:return{byteLength:2,components:1};case Yg:case Zg:return{byteLength:2,components:4};case bi:case Ir:case lr:return{byteLength:4,components:1};case Kg:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ep}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ep);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function wE(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function Pz(n){const e=new WeakMap;function t(a,l){const u=a.array,A=a.usage,p=u.byteLength,g=n.createBuffer();n.bindBuffer(l,g),n.bufferData(l,u,A),a.onUploadCallback();let v;if(u instanceof Float32Array)v=n.FLOAT;else if(u instanceof Uint16Array)a.isFloat16BufferAttribute?v=n.HALF_FLOAT:v=n.UNSIGNED_SHORT;else if(u instanceof Int16Array)v=n.SHORT;else if(u instanceof Uint32Array)v=n.UNSIGNED_INT;else if(u instanceof Int32Array)v=n.INT;else if(u instanceof Int8Array)v=n.BYTE;else if(u instanceof Uint8Array)v=n.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)v=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:g,type:v,bytesPerElement:u.BYTES_PER_ELEMENT,version:a.version,size:p}}function i(a,l,u){const A=l.array,p=l.updateRanges;if(n.bindBuffer(u,a),p.length===0)n.bufferSubData(u,0,A);else{p.sort((v,x)=>v.start-x.start);let g=0;for(let v=1;v<p.length;v++){const x=p[g],S=p[v];S.start<=x.start+x.count+1?x.count=Math.max(x.count,S.start+S.count-x.start):(++g,p[g]=S)}p.length=g+1;for(let v=0,x=p.length;v<x;v++){const S=p[v];n.bufferSubData(u,S.start*A.BYTES_PER_ELEMENT,A,S.start,S.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(n.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const A=e.get(a);(!A||A.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const u=e.get(a);if(u===void 0)e.set(a,t(a,l));else if(u.version<a.version){if(u.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(u.buffer,a,l),u.version=a.version}}return{get:r,remove:s,update:o}}var Lz=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Dz=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Iz=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Bz=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Fz=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Uz=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Oz=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,kz=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Vz=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Gz=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,qz=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,zz=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Hz=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,$z=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Wz=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,jz=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Xz=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Qz=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Yz=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Zz=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Kz=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Jz=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,eH=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,tH=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,nH=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,iH=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,rH=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,sH=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,oH=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,aH=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,lH="gl_FragColor = linearToOutputTexel( gl_FragColor );",uH=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,cH=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,hH=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,fH=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,AH=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,dH=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,pH=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,mH=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,gH=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,_H=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,vH=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,yH=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,xH=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,bH=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,wH=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,SH=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,TH=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,MH=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,EH=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,CH=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,RH=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,NH=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,PH=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,LH=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,DH=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,IH=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,BH=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,FH=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,UH=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,OH=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,kH=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,VH=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,GH=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,qH=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,zH=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,HH=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,$H=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,WH=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,jH=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,XH=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,QH=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,YH=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,ZH=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,KH=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,JH=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,e$=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,t$=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,n$=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,i$=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,r$=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,s$=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,o$=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,a$=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,l$=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,u$=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,c$=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,h$=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,f$=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,A$=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,d$=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,p$=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,m$=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,g$=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,_$=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,v$=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,y$=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,x$=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,b$=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,w$=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,S$=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,T$=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,M$=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,E$=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,C$=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,R$=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,N$=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const P$=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,L$=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,D$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,I$=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,B$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,F$=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,U$=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,O$=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,k$=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,V$=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,G$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,q$=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,z$=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,H$=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$$=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,W$=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,j$=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,X$=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Q$=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Y$=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Z$=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,K$=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,J$=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,eW=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,tW=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,nW=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iW=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,rW=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sW=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,oW=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,aW=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lW=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,uW=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,cW=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Pn={alphahash_fragment:Lz,alphahash_pars_fragment:Dz,alphamap_fragment:Iz,alphamap_pars_fragment:Bz,alphatest_fragment:Fz,alphatest_pars_fragment:Uz,aomap_fragment:Oz,aomap_pars_fragment:kz,batching_pars_vertex:Vz,batching_vertex:Gz,begin_vertex:qz,beginnormal_vertex:zz,bsdfs:Hz,iridescence_fragment:$z,bumpmap_pars_fragment:Wz,clipping_planes_fragment:jz,clipping_planes_pars_fragment:Xz,clipping_planes_pars_vertex:Qz,clipping_planes_vertex:Yz,color_fragment:Zz,color_pars_fragment:Kz,color_pars_vertex:Jz,color_vertex:eH,common:tH,cube_uv_reflection_fragment:nH,defaultnormal_vertex:iH,displacementmap_pars_vertex:rH,displacementmap_vertex:sH,emissivemap_fragment:oH,emissivemap_pars_fragment:aH,colorspace_fragment:lH,colorspace_pars_fragment:uH,envmap_fragment:cH,envmap_common_pars_fragment:hH,envmap_pars_fragment:fH,envmap_pars_vertex:AH,envmap_physical_pars_fragment:SH,envmap_vertex:dH,fog_vertex:pH,fog_pars_vertex:mH,fog_fragment:gH,fog_pars_fragment:_H,gradientmap_pars_fragment:vH,lightmap_pars_fragment:yH,lights_lambert_fragment:xH,lights_lambert_pars_fragment:bH,lights_pars_begin:wH,lights_toon_fragment:TH,lights_toon_pars_fragment:MH,lights_phong_fragment:EH,lights_phong_pars_fragment:CH,lights_physical_fragment:RH,lights_physical_pars_fragment:NH,lights_fragment_begin:PH,lights_fragment_maps:LH,lights_fragment_end:DH,logdepthbuf_fragment:IH,logdepthbuf_pars_fragment:BH,logdepthbuf_pars_vertex:FH,logdepthbuf_vertex:UH,map_fragment:OH,map_pars_fragment:kH,map_particle_fragment:VH,map_particle_pars_fragment:GH,metalnessmap_fragment:qH,metalnessmap_pars_fragment:zH,morphinstance_vertex:HH,morphcolor_vertex:$H,morphnormal_vertex:WH,morphtarget_pars_vertex:jH,morphtarget_vertex:XH,normal_fragment_begin:QH,normal_fragment_maps:YH,normal_pars_fragment:ZH,normal_pars_vertex:KH,normal_vertex:JH,normalmap_pars_fragment:e$,clearcoat_normal_fragment_begin:t$,clearcoat_normal_fragment_maps:n$,clearcoat_pars_fragment:i$,iridescence_pars_fragment:r$,opaque_fragment:s$,packing:o$,premultiplied_alpha_fragment:a$,project_vertex:l$,dithering_fragment:u$,dithering_pars_fragment:c$,roughnessmap_fragment:h$,roughnessmap_pars_fragment:f$,shadowmap_pars_fragment:A$,shadowmap_pars_vertex:d$,shadowmap_vertex:p$,shadowmask_pars_fragment:m$,skinbase_vertex:g$,skinning_pars_vertex:_$,skinning_vertex:v$,skinnormal_vertex:y$,specularmap_fragment:x$,specularmap_pars_fragment:b$,tonemapping_fragment:w$,tonemapping_pars_fragment:S$,transmission_fragment:T$,transmission_pars_fragment:M$,uv_pars_fragment:E$,uv_pars_vertex:C$,uv_vertex:R$,worldpos_vertex:N$,background_vert:P$,background_frag:L$,backgroundCube_vert:D$,backgroundCube_frag:I$,cube_vert:B$,cube_frag:F$,depth_vert:U$,depth_frag:O$,distanceRGBA_vert:k$,distanceRGBA_frag:V$,equirect_vert:G$,equirect_frag:q$,linedashed_vert:z$,linedashed_frag:H$,meshbasic_vert:$$,meshbasic_frag:W$,meshlambert_vert:j$,meshlambert_frag:X$,meshmatcap_vert:Q$,meshmatcap_frag:Y$,meshnormal_vert:Z$,meshnormal_frag:K$,meshphong_vert:J$,meshphong_frag:eW,meshphysical_vert:tW,meshphysical_frag:nW,meshtoon_vert:iW,meshtoon_frag:rW,points_vert:sW,points_frag:oW,shadow_vert:aW,shadow_frag:lW,sprite_vert:uW,sprite_frag:cW},Mt={common:{diffuse:{value:new Ft(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new dn},alphaMap:{value:null},alphaMapTransform:{value:new dn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new dn}},envmap:{envMap:{value:null},envMapRotation:{value:new dn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new dn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new dn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new dn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new dn},normalScale:{value:new at(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new dn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new dn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new dn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new dn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ft(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ft(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new dn},alphaTest:{value:0},uvTransform:{value:new dn}},sprite:{diffuse:{value:new Ft(16777215)},opacity:{value:1},center:{value:new at(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new dn},alphaMap:{value:null},alphaMapTransform:{value:new dn},alphaTest:{value:0}}},Gs={basic:{uniforms:ws([Mt.common,Mt.specularmap,Mt.envmap,Mt.aomap,Mt.lightmap,Mt.fog]),vertexShader:Pn.meshbasic_vert,fragmentShader:Pn.meshbasic_frag},lambert:{uniforms:ws([Mt.common,Mt.specularmap,Mt.envmap,Mt.aomap,Mt.lightmap,Mt.emissivemap,Mt.bumpmap,Mt.normalmap,Mt.displacementmap,Mt.fog,Mt.lights,{emissive:{value:new Ft(0)}}]),vertexShader:Pn.meshlambert_vert,fragmentShader:Pn.meshlambert_frag},phong:{uniforms:ws([Mt.common,Mt.specularmap,Mt.envmap,Mt.aomap,Mt.lightmap,Mt.emissivemap,Mt.bumpmap,Mt.normalmap,Mt.displacementmap,Mt.fog,Mt.lights,{emissive:{value:new Ft(0)},specular:{value:new Ft(1118481)},shininess:{value:30}}]),vertexShader:Pn.meshphong_vert,fragmentShader:Pn.meshphong_frag},standard:{uniforms:ws([Mt.common,Mt.envmap,Mt.aomap,Mt.lightmap,Mt.emissivemap,Mt.bumpmap,Mt.normalmap,Mt.displacementmap,Mt.roughnessmap,Mt.metalnessmap,Mt.fog,Mt.lights,{emissive:{value:new Ft(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pn.meshphysical_vert,fragmentShader:Pn.meshphysical_frag},toon:{uniforms:ws([Mt.common,Mt.aomap,Mt.lightmap,Mt.emissivemap,Mt.bumpmap,Mt.normalmap,Mt.displacementmap,Mt.gradientmap,Mt.fog,Mt.lights,{emissive:{value:new Ft(0)}}]),vertexShader:Pn.meshtoon_vert,fragmentShader:Pn.meshtoon_frag},matcap:{uniforms:ws([Mt.common,Mt.bumpmap,Mt.normalmap,Mt.displacementmap,Mt.fog,{matcap:{value:null}}]),vertexShader:Pn.meshmatcap_vert,fragmentShader:Pn.meshmatcap_frag},points:{uniforms:ws([Mt.points,Mt.fog]),vertexShader:Pn.points_vert,fragmentShader:Pn.points_frag},dashed:{uniforms:ws([Mt.common,Mt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pn.linedashed_vert,fragmentShader:Pn.linedashed_frag},depth:{uniforms:ws([Mt.common,Mt.displacementmap]),vertexShader:Pn.depth_vert,fragmentShader:Pn.depth_frag},normal:{uniforms:ws([Mt.common,Mt.bumpmap,Mt.normalmap,Mt.displacementmap,{opacity:{value:1}}]),vertexShader:Pn.meshnormal_vert,fragmentShader:Pn.meshnormal_frag},sprite:{uniforms:ws([Mt.sprite,Mt.fog]),vertexShader:Pn.sprite_vert,fragmentShader:Pn.sprite_frag},background:{uniforms:{uvTransform:{value:new dn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pn.background_vert,fragmentShader:Pn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new dn}},vertexShader:Pn.backgroundCube_vert,fragmentShader:Pn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pn.cube_vert,fragmentShader:Pn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pn.equirect_vert,fragmentShader:Pn.equirect_frag},distanceRGBA:{uniforms:ws([Mt.common,Mt.displacementmap,{referencePosition:{value:new ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pn.distanceRGBA_vert,fragmentShader:Pn.distanceRGBA_frag},shadow:{uniforms:ws([Mt.lights,Mt.fog,{color:{value:new Ft(0)},opacity:{value:1}}]),vertexShader:Pn.shadow_vert,fragmentShader:Pn.shadow_frag}};Gs.physical={uniforms:ws([Gs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new dn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new dn},clearcoatNormalScale:{value:new at(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new dn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new dn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new dn},sheen:{value:0},sheenColor:{value:new Ft(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new dn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new dn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new dn},transmissionSamplerSize:{value:new at},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new dn},attenuationDistance:{value:0},attenuationColor:{value:new Ft(0)},specularColor:{value:new Ft(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new dn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new dn},anisotropyVector:{value:new at},anisotropyMap:{value:null},anisotropyMapTransform:{value:new dn}}]),vertexShader:Pn.meshphysical_vert,fragmentShader:Pn.meshphysical_frag};const dm={r:0,b:0,g:0},uc=new Qr,hW=new en;function fW(n,e,t,i,r,s,o){const a=new Ft(0);let l=s===!0?0:1,u,A,p=null,g=0,v=null;function x(E){let N=E.isScene===!0?E.background:null;return N&&N.isTexture&&(N=(E.backgroundBlurriness>0?t:e).get(N)),N}function S(E){let N=!1;const D=x(E);D===null?w(a,l):D&&D.isColor&&(w(D,1),N=!0);const B=n.xr.getEnvironmentBlendMode();B==="additive"?i.buffers.color.setClear(0,0,0,1,o):B==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||N)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function T(E,N){const D=x(N);D&&(D.isCubeTexture||D.mapping===Kc)?(A===void 0&&(A=new Jn(new $u(1,1,1),new zo({name:"BackgroundCubeMaterial",uniforms:rA(Gs.backgroundCube.uniforms),vertexShader:Gs.backgroundCube.vertexShader,fragmentShader:Gs.backgroundCube.fragmentShader,side:_i,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),A.geometry.deleteAttribute("normal"),A.geometry.deleteAttribute("uv"),A.onBeforeRender=function(B,I,O){this.matrixWorld.copyPosition(O.matrixWorld)},Object.defineProperty(A.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(A)),uc.copy(N.backgroundRotation),uc.x*=-1,uc.y*=-1,uc.z*=-1,D.isCubeTexture&&D.isRenderTargetTexture===!1&&(uc.y*=-1,uc.z*=-1),A.material.uniforms.envMap.value=D,A.material.uniforms.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,A.material.uniforms.backgroundBlurriness.value=N.backgroundBlurriness,A.material.uniforms.backgroundIntensity.value=N.backgroundIntensity,A.material.uniforms.backgroundRotation.value.setFromMatrix4(hW.makeRotationFromEuler(uc)),A.material.toneMapped=Rn.getTransfer(D.colorSpace)!==oi,(p!==D||g!==D.version||v!==n.toneMapping)&&(A.material.needsUpdate=!0,p=D,g=D.version,v=n.toneMapping),A.layers.enableAll(),E.unshift(A,A.geometry,A.material,0,0,null)):D&&D.isTexture&&(u===void 0&&(u=new Jn(new sp(2,2),new zo({name:"BackgroundMaterial",uniforms:rA(Gs.background.uniforms),vertexShader:Gs.background.vertexShader,fragmentShader:Gs.background.fragmentShader,side:Xs,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=D,u.material.uniforms.backgroundIntensity.value=N.backgroundIntensity,u.material.toneMapped=Rn.getTransfer(D.colorSpace)!==oi,D.matrixAutoUpdate===!0&&D.updateMatrix(),u.material.uniforms.uvTransform.value.copy(D.matrix),(p!==D||g!==D.version||v!==n.toneMapping)&&(u.material.needsUpdate=!0,p=D,g=D.version,v=n.toneMapping),u.layers.enableAll(),E.unshift(u,u.geometry,u.material,0,0,null))}function w(E,N){E.getRGB(dm,J7(n)),i.buffers.color.setClear(dm.r,dm.g,dm.b,N,o)}function R(){A!==void 0&&(A.geometry.dispose(),A.material.dispose(),A=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return a},setClearColor:function(E,N=1){a.set(E),l=N,w(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(E){l=E,w(a,l)},render:S,addToRenderList:T,dispose:R}}function AW(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=g(null);let s=r,o=!1;function a(F,V,H,Q,te){let K=!1;const W=p(Q,H,V);s!==W&&(s=W,u(s.object)),K=v(F,Q,H,te),K&&x(F,Q,H,te),te!==null&&e.update(te,n.ELEMENT_ARRAY_BUFFER),(K||o)&&(o=!1,N(F,V,H,Q),te!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(te).buffer))}function l(){return n.createVertexArray()}function u(F){return n.bindVertexArray(F)}function A(F){return n.deleteVertexArray(F)}function p(F,V,H){const Q=H.wireframe===!0;let te=i[F.id];te===void 0&&(te={},i[F.id]=te);let K=te[V.id];K===void 0&&(K={},te[V.id]=K);let W=K[Q];return W===void 0&&(W=g(l()),K[Q]=W),W}function g(F){const V=[],H=[],Q=[];for(let te=0;te<t;te++)V[te]=0,H[te]=0,Q[te]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:H,attributeDivisors:Q,object:F,attributes:{},index:null}}function v(F,V,H,Q){const te=s.attributes,K=V.attributes;let W=0;const Z=H.getAttributes();for(const J in Z)if(Z[J].location>=0){const ge=te[J];let pe=K[J];if(pe===void 0&&(J==="instanceMatrix"&&F.instanceMatrix&&(pe=F.instanceMatrix),J==="instanceColor"&&F.instanceColor&&(pe=F.instanceColor)),ge===void 0||ge.attribute!==pe||pe&&ge.data!==pe.data)return!0;W++}return s.attributesNum!==W||s.index!==Q}function x(F,V,H,Q){const te={},K=V.attributes;let W=0;const Z=H.getAttributes();for(const J in Z)if(Z[J].location>=0){let ge=K[J];ge===void 0&&(J==="instanceMatrix"&&F.instanceMatrix&&(ge=F.instanceMatrix),J==="instanceColor"&&F.instanceColor&&(ge=F.instanceColor));const pe={};pe.attribute=ge,ge&&ge.data&&(pe.data=ge.data),te[J]=pe,W++}s.attributes=te,s.attributesNum=W,s.index=Q}function S(){const F=s.newAttributes;for(let V=0,H=F.length;V<H;V++)F[V]=0}function T(F){w(F,0)}function w(F,V){const H=s.newAttributes,Q=s.enabledAttributes,te=s.attributeDivisors;H[F]=1,Q[F]===0&&(n.enableVertexAttribArray(F),Q[F]=1),te[F]!==V&&(n.vertexAttribDivisor(F,V),te[F]=V)}function R(){const F=s.newAttributes,V=s.enabledAttributes;for(let H=0,Q=V.length;H<Q;H++)V[H]!==F[H]&&(n.disableVertexAttribArray(H),V[H]=0)}function E(F,V,H,Q,te,K,W){W===!0?n.vertexAttribIPointer(F,V,H,te,K):n.vertexAttribPointer(F,V,H,Q,te,K)}function N(F,V,H,Q){S();const te=Q.attributes,K=H.getAttributes(),W=V.defaultAttributeValues;for(const Z in K){const J=K[Z];if(J.location>=0){let fe=te[Z];if(fe===void 0&&(Z==="instanceMatrix"&&F.instanceMatrix&&(fe=F.instanceMatrix),Z==="instanceColor"&&F.instanceColor&&(fe=F.instanceColor)),fe!==void 0){const ge=fe.normalized,pe=fe.itemSize,Ae=e.get(fe);if(Ae===void 0)continue;const Fe=Ae.buffer,be=Ae.type,Ve=Ae.bytesPerElement,Ye=be===n.INT||be===n.UNSIGNED_INT||fe.gpuType===Ir;if(fe.isInterleavedBufferAttribute){const Xe=fe.data,Tt=Xe.stride,yt=fe.offset;if(Xe.isInstancedInterleavedBuffer){for(let ut=0;ut<J.locationSize;ut++)w(J.location+ut,Xe.meshPerAttribute);F.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=Xe.meshPerAttribute*Xe.count)}else for(let ut=0;ut<J.locationSize;ut++)T(J.location+ut);n.bindBuffer(n.ARRAY_BUFFER,Fe);for(let ut=0;ut<J.locationSize;ut++)E(J.location+ut,pe/J.locationSize,be,ge,Tt*Ve,(yt+pe/J.locationSize*ut)*Ve,Ye)}else{if(fe.isInstancedBufferAttribute){for(let Xe=0;Xe<J.locationSize;Xe++)w(J.location+Xe,fe.meshPerAttribute);F.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let Xe=0;Xe<J.locationSize;Xe++)T(J.location+Xe);n.bindBuffer(n.ARRAY_BUFFER,Fe);for(let Xe=0;Xe<J.locationSize;Xe++)E(J.location+Xe,pe/J.locationSize,be,ge,pe*Ve,pe/J.locationSize*Xe*Ve,Ye)}}else if(W!==void 0){const ge=W[Z];if(ge!==void 0)switch(ge.length){case 2:n.vertexAttrib2fv(J.location,ge);break;case 3:n.vertexAttrib3fv(J.location,ge);break;case 4:n.vertexAttrib4fv(J.location,ge);break;default:n.vertexAttrib1fv(J.location,ge)}}}}R()}function D(){O();for(const F in i){const V=i[F];for(const H in V){const Q=V[H];for(const te in Q)A(Q[te].object),delete Q[te];delete V[H]}delete i[F]}}function B(F){if(i[F.id]===void 0)return;const V=i[F.id];for(const H in V){const Q=V[H];for(const te in Q)A(Q[te].object),delete Q[te];delete V[H]}delete i[F.id]}function I(F){for(const V in i){const H=i[V];if(H[F.id]===void 0)continue;const Q=H[F.id];for(const te in Q)A(Q[te].object),delete Q[te];delete H[F.id]}}function O(){L(),o=!0,s!==r&&(s=r,u(s.object))}function L(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:O,resetDefaultState:L,dispose:D,releaseStatesOfGeometry:B,releaseStatesOfProgram:I,initAttributes:S,enableAttribute:T,disableUnusedAttributes:R}}function dW(n,e,t){let i;function r(u){i=u}function s(u,A){n.drawArrays(i,u,A),t.update(A,i,1)}function o(u,A,p){p!==0&&(n.drawArraysInstanced(i,u,A,p),t.update(A,i,p))}function a(u,A,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,u,0,A,0,p);let v=0;for(let x=0;x<p;x++)v+=A[x];t.update(v,i,1)}function l(u,A,p,g){if(p===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let x=0;x<u.length;x++)o(u[x],A[x],g[x]);else{v.multiDrawArraysInstancedWEBGL(i,u,0,A,0,g,0,p);let x=0;for(let S=0;S<p;S++)x+=A[S]*g[S];t.update(x,i,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function pW(n,e,t,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const I=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(I){return!(I!==ir&&i.convert(I)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(I){const O=I===Mr&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==ji&&i.convert(I)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==lr&&!O)}function l(I){if(I==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=t.precision!==void 0?t.precision:"highp";const A=l(u);A!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",A,"instead."),u=A);const p=t.logarithmicDepthBuffer===!0,g=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),v=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),x=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),S=n.getParameter(n.MAX_TEXTURE_SIZE),T=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),w=n.getParameter(n.MAX_VERTEX_ATTRIBS),R=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),E=n.getParameter(n.MAX_VARYING_VECTORS),N=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),D=x>0,B=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:u,logarithmicDepthBuffer:p,reverseDepthBuffer:g,maxTextures:v,maxVertexTextures:x,maxTextureSize:S,maxCubemapSize:T,maxAttributes:w,maxVertexUniforms:R,maxVaryings:E,maxFragmentUniforms:N,vertexTextures:D,maxSamples:B}}function mW(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new bl,a=new dn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(p,g){const v=p.length!==0||g||i!==0||r;return r=g,i=p.length,v},this.beginShadows=function(){s=!0,A(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(p,g){t=A(p,g,0)},this.setState=function(p,g,v){const x=p.clippingPlanes,S=p.clipIntersection,T=p.clipShadows,w=n.get(p);if(!r||x===null||x.length===0||s&&!T)s?A(null):u();else{const R=s?0:i,E=R*4;let N=w.clippingState||null;l.value=N,N=A(x,g,E,v);for(let D=0;D!==E;++D)N[D]=t[D];w.clippingState=N,this.numIntersection=S?this.numPlanes:0,this.numPlanes+=R}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function A(p,g,v,x){const S=p!==null?p.length:0;let T=null;if(S!==0){if(T=l.value,x!==!0||T===null){const w=v+S*4,R=g.matrixWorldInverse;a.getNormalMatrix(R),(T===null||T.length<w)&&(T=new Float32Array(w));for(let E=0,N=v;E!==S;++E,N+=4)o.copy(p[E]).applyMatrix4(R,a),o.normal.toArray(T,N),T[N+3]=o.constant}l.value=T,l.needsUpdate=!0}return e.numPlanes=S,e.numIntersection=0,T}}function gW(n){let e=new WeakMap;function t(o,a){return a===Yc?o.mapping=ga:a===Zc&&(o.mapping=_a),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===Yc||a===Zc)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new tE(l.height);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",r),t(u.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}const hf=4,d6=[.125,.215,.35,.446,.526,.582],Ec=20,o3=new u2,p6=new Ft;let a3=null,l3=0,u3=0,c3=!1;const wc=(1+Math.sqrt(5))/2,qh=1/wc,m6=[new ie(-wc,qh,0),new ie(wc,qh,0),new ie(-qh,0,wc),new ie(qh,0,wc),new ie(0,wc,-qh),new ie(0,wc,qh),new ie(-1,1,-1),new ie(1,1,-1),new ie(-1,1,1),new ie(1,1,1)],_W=new ie;let g6=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100,s={}){const{size:o=256,position:a=_W}=s;a3=this._renderer.getRenderTarget(),l3=this._renderer.getActiveCubeFace(),u3=this._renderer.getActiveMipmapLevel(),c3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,i,r,l,a),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=y6(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=v6(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(a3,l3,u3),this._renderer.xr.enabled=c3,e.scissorTest=!1,pm(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ga||e.mapping===_a?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),a3=this._renderer.getRenderTarget(),l3=this._renderer.getActiveCubeFace(),u3=this._renderer.getActiveMipmapLevel(),c3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Tr,minFilter:Tr,generateMipmaps:!1,type:Mr,format:ir,colorSpace:ha,depthBuffer:!1},r=_6(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_6(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=vW(s)),this._blurMaterial=yW(s,e,t)}return r}_compileMaterial(e){const t=new Jn(this._lodPlanes[0],e);this._renderer.compile(t,o3)}_sceneToCubeUV(e,t,i,r,s){const l=new Br(90,1,t,i),u=[1,-1,1,1,1,1],A=[1,1,1,-1,-1,-1],p=this._renderer,g=p.autoClear,v=p.toneMapping;p.getClearColor(p6),p.toneMapping=Qs,p.autoClear=!1;const x=new ia({name:"PMREM.Background",side:_i,depthWrite:!1,depthTest:!1}),S=new Jn(new $u,x);let T=!1;const w=e.background;w?w.isColor&&(x.color.copy(w),e.background=null,T=!0):(x.color.copy(p6),T=!0);for(let R=0;R<6;R++){const E=R%3;E===0?(l.up.set(0,u[R],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+A[R],s.y,s.z)):E===1?(l.up.set(0,0,u[R]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+A[R],s.z)):(l.up.set(0,u[R],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+A[R]));const N=this._cubeSize;pm(r,E*N,R>2?N:0,N,N),p.setRenderTarget(r),T&&p.render(S,l),p.render(e,l)}S.geometry.dispose(),S.material.dispose(),p.toneMapping=v,p.autoClear=g,e.background=w}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===ga||e.mapping===_a;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=y6()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=v6());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Jn(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;pm(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,o3)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=m6[(r-s-1)%m6.length];this._blur(e,s-1,s,o,a)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const A=3,p=new Jn(this._lodPlanes[r],u),g=u.uniforms,v=this._sizeLods[i]-1,x=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*Ec-1),S=s/x,T=isFinite(s)?1+Math.floor(A*S):Ec;T>Ec&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${T} samples when the maximum is set to ${Ec}`);const w=[];let R=0;for(let I=0;I<Ec;++I){const O=I/S,L=Math.exp(-O*O/2);w.push(L),I===0?R+=L:I<T&&(R+=2*L)}for(let I=0;I<w.length;I++)w[I]=w[I]/R;g.envMap.value=e.texture,g.samples.value=T,g.weights.value=w,g.latitudinal.value=o==="latitudinal",a&&(g.poleAxis.value=a);const{_lodMax:E}=this;g.dTheta.value=x,g.mipInt.value=E-i;const N=this._sizeLods[r],D=3*N*(r>E-hf?r-E+hf:0),B=4*(this._cubeSize-N);pm(t,D,B,3*N,2*N),l.setRenderTarget(t),l.render(p,o3)}};function vW(n){const e=[],t=[],i=[];let r=n;const s=n-hf+1+d6.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-hf?l=d6[o-n+hf-1]:o===0&&(l=0),i.push(l);const u=1/(a-2),A=-u,p=1+u,g=[A,A,p,A,p,p,A,A,p,p,A,p],v=6,x=6,S=3,T=2,w=1,R=new Float32Array(S*x*v),E=new Float32Array(T*x*v),N=new Float32Array(w*x*v);for(let B=0;B<v;B++){const I=B%3*2/3-1,O=B>2?0:-1,L=[I,O,0,I+2/3,O,0,I+2/3,O+1,0,I,O,0,I+2/3,O+1,0,I,O+1,0];R.set(L,S*x*B),E.set(g,T*x*B);const F=[B,B,B,B,B,B];N.set(F,w*x*B)}const D=new Ai;D.setAttribute("position",new Gi(R,S)),D.setAttribute("uv",new Gi(E,T)),D.setAttribute("faceIndex",new Gi(N,w)),e.push(D),r>hf&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function _6(n,e,t){const i=new nh(n,e,t);return i.texture.mapping=Kc,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function pm(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function yW(n,e,t){const i=new Float32Array(Ec),r=new ie(0,1,0);return new zo({name:"SphericalGaussianBlur",defines:{n:Ec,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:o4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:vo,depthTest:!1,depthWrite:!1})}function v6(){return new zo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:o4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:vo,depthTest:!1,depthWrite:!1})}function y6(){return new zo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:o4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:vo,depthTest:!1,depthWrite:!1})}function o4(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function xW(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,u=l===Yc||l===Zc,A=l===ga||l===_a;if(u||A){let p=e.get(a);const g=p!==void 0?p.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==g)return t===null&&(t=new g6(n)),p=u?t.fromEquirectangular(a,p):t.fromCubemap(a,p),p.texture.pmremVersion=a.pmremVersion,e.set(a,p),p.texture;if(p!==void 0)return p.texture;{const v=a.image;return u&&v&&v.height>0||A&&v&&r(v)?(t===null&&(t=new g6(n)),p=u?t.fromEquirectangular(a):t.fromCubemap(a),p.texture.pmremVersion=a.pmremVersion,e.set(a,p),a.addEventListener("dispose",s),p.texture):null}}}return a}function r(a){let l=0;const u=6;for(let A=0;A<u;A++)a[A]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function bW(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const r=t(i);return r===null&&fa("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function wW(n,e,t,i){const r={},s=new WeakMap;function o(p){const g=p.target;g.index!==null&&e.remove(g.index);for(const x in g.attributes)e.remove(g.attributes[x]);g.removeEventListener("dispose",o),delete r[g.id];const v=s.get(g);v&&(e.remove(v),s.delete(g)),i.releaseStatesOfGeometry(g),g.isInstancedBufferGeometry===!0&&delete g._maxInstanceCount,t.memory.geometries--}function a(p,g){return r[g.id]===!0||(g.addEventListener("dispose",o),r[g.id]=!0,t.memory.geometries++),g}function l(p){const g=p.attributes;for(const v in g)e.update(g[v],n.ARRAY_BUFFER)}function u(p){const g=[],v=p.index,x=p.attributes.position;let S=0;if(v!==null){const R=v.array;S=v.version;for(let E=0,N=R.length;E<N;E+=3){const D=R[E+0],B=R[E+1],I=R[E+2];g.push(D,B,B,I,I,D)}}else if(x!==void 0){const R=x.array;S=x.version;for(let E=0,N=R.length/3-1;E<N;E+=3){const D=E+0,B=E+1,I=E+2;g.push(D,B,B,I,I,D)}}else return;const T=new($x(g)?Qx:Xx)(g,1);T.version=S;const w=s.get(p);w&&e.remove(w),s.set(p,T)}function A(p){const g=s.get(p);if(g){const v=p.index;v!==null&&g.version<v.version&&u(p)}else u(p);return s.get(p)}return{get:a,update:l,getWireframeAttribute:A}}function SW(n,e,t){let i;function r(g){i=g}let s,o;function a(g){s=g.type,o=g.bytesPerElement}function l(g,v){n.drawElements(i,v,s,g*o),t.update(v,i,1)}function u(g,v,x){x!==0&&(n.drawElementsInstanced(i,v,s,g*o,x),t.update(v,i,x))}function A(g,v,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,v,0,s,g,0,x);let T=0;for(let w=0;w<x;w++)T+=v[w];t.update(T,i,1)}function p(g,v,x,S){if(x===0)return;const T=e.get("WEBGL_multi_draw");if(T===null)for(let w=0;w<g.length;w++)u(g[w]/o,v[w],S[w]);else{T.multiDrawElementsInstancedWEBGL(i,v,0,s,g,0,S,0,x);let w=0;for(let R=0;R<x;R++)w+=v[R]*S[R];t.update(w,i,1)}}this.setMode=r,this.setIndex=a,this.render=l,this.renderInstances=u,this.renderMultiDraw=A,this.renderMultiDrawInstances=p}function TW(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function MW(n,e,t){const i=new WeakMap,r=new $t;function s(o,a,l){const u=o.morphTargetInfluences,A=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,p=A!==void 0?A.length:0;let g=i.get(a);if(g===void 0||g.count!==p){let L=function(){I.dispose(),i.delete(a),a.removeEventListener("dispose",L)};g!==void 0&&g.texture.dispose();const v=a.morphAttributes.position!==void 0,x=a.morphAttributes.normal!==void 0,S=a.morphAttributes.color!==void 0,T=a.morphAttributes.position||[],w=a.morphAttributes.normal||[],R=a.morphAttributes.color||[];let E=0;v===!0&&(E=1),x===!0&&(E=2),S===!0&&(E=3);let N=a.attributes.position.count*E,D=1;N>e.maxTextureSize&&(D=Math.ceil(N/e.maxTextureSize),N=e.maxTextureSize);const B=new Float32Array(N*D*4*p),I=new t2(B,N,D,p);I.type=lr,I.needsUpdate=!0;const O=E*4;for(let F=0;F<p;F++){const V=T[F],H=w[F],Q=R[F],te=N*D*4*F;for(let K=0;K<V.count;K++){const W=K*O;v===!0&&(r.fromBufferAttribute(V,K),B[te+W+0]=r.x,B[te+W+1]=r.y,B[te+W+2]=r.z,B[te+W+3]=0),x===!0&&(r.fromBufferAttribute(H,K),B[te+W+4]=r.x,B[te+W+5]=r.y,B[te+W+6]=r.z,B[te+W+7]=0),S===!0&&(r.fromBufferAttribute(Q,K),B[te+W+8]=r.x,B[te+W+9]=r.y,B[te+W+10]=r.z,B[te+W+11]=Q.itemSize===4?r.w:1)}}g={count:p,texture:I,size:new at(N,D)},i.set(a,g),a.addEventListener("dispose",L)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(n,"morphTexture",o.morphTexture,t);else{let v=0;for(let S=0;S<u.length;S++)v+=u[S];const x=a.morphTargetsRelative?1:1-v;l.getUniforms().setValue(n,"morphTargetBaseInfluence",x),l.getUniforms().setValue(n,"morphTargetInfluences",u)}l.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}return{update:s}}function EW(n,e,t,i){let r=new WeakMap;function s(l){const u=i.render.frame,A=l.geometry,p=e.get(l,A);if(r.get(p)!==u&&(e.update(p),r.set(p,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,u))),l.isSkinnedMesh){const g=l.skeleton;r.get(g)!==u&&(g.update(),r.set(g,u))}return p}function o(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}const SE=new vr,x6=new Ys(1,1),TE=new t2,ME=new oq,EE=new i2,b6=[],w6=[],S6=new Float32Array(16),T6=new Float32Array(9),M6=new Float32Array(4);function TA(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=b6[r];if(s===void 0&&(s=new Float32Array(r),b6[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Er(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Cr(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function h2(n,e){let t=w6[e];t===void 0&&(t=new Int32Array(e),w6[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function CW(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function RW(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Er(t,e))return;n.uniform2fv(this.addr,e),Cr(t,e)}}function NW(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Er(t,e))return;n.uniform3fv(this.addr,e),Cr(t,e)}}function PW(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Er(t,e))return;n.uniform4fv(this.addr,e),Cr(t,e)}}function LW(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Er(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Cr(t,e)}else{if(Er(t,i))return;M6.set(i),n.uniformMatrix2fv(this.addr,!1,M6),Cr(t,i)}}function DW(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Er(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Cr(t,e)}else{if(Er(t,i))return;T6.set(i),n.uniformMatrix3fv(this.addr,!1,T6),Cr(t,i)}}function IW(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Er(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Cr(t,e)}else{if(Er(t,i))return;S6.set(i),n.uniformMatrix4fv(this.addr,!1,S6),Cr(t,i)}}function BW(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function FW(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Er(t,e))return;n.uniform2iv(this.addr,e),Cr(t,e)}}function UW(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Er(t,e))return;n.uniform3iv(this.addr,e),Cr(t,e)}}function OW(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Er(t,e))return;n.uniform4iv(this.addr,e),Cr(t,e)}}function kW(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function VW(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Er(t,e))return;n.uniform2uiv(this.addr,e),Cr(t,e)}}function GW(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Er(t,e))return;n.uniform3uiv(this.addr,e),Cr(t,e)}}function qW(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Er(t,e))return;n.uniform4uiv(this.addr,e),Cr(t,e)}}function zW(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);let s;this.type===n.SAMPLER_2D_SHADOW?(x6.compareFunction=e2,s=x6):s=SE,t.setTexture2D(e||s,r)}function HW(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||ME,r)}function $W(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||EE,r)}function WW(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||TE,r)}function jW(n){switch(n){case 5126:return CW;case 35664:return RW;case 35665:return NW;case 35666:return PW;case 35674:return LW;case 35675:return DW;case 35676:return IW;case 5124:case 35670:return BW;case 35667:case 35671:return FW;case 35668:case 35672:return UW;case 35669:case 35673:return OW;case 5125:return kW;case 36294:return VW;case 36295:return GW;case 36296:return qW;case 35678:case 36198:case 36298:case 36306:case 35682:return zW;case 35679:case 36299:case 36307:return HW;case 35680:case 36300:case 36308:case 36293:return $W;case 36289:case 36303:case 36311:case 36292:return WW}}function XW(n,e){n.uniform1fv(this.addr,e)}function QW(n,e){const t=TA(e,this.size,2);n.uniform2fv(this.addr,t)}function YW(n,e){const t=TA(e,this.size,3);n.uniform3fv(this.addr,t)}function ZW(n,e){const t=TA(e,this.size,4);n.uniform4fv(this.addr,t)}function KW(n,e){const t=TA(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function JW(n,e){const t=TA(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function ej(n,e){const t=TA(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function tj(n,e){n.uniform1iv(this.addr,e)}function nj(n,e){n.uniform2iv(this.addr,e)}function ij(n,e){n.uniform3iv(this.addr,e)}function rj(n,e){n.uniform4iv(this.addr,e)}function sj(n,e){n.uniform1uiv(this.addr,e)}function oj(n,e){n.uniform2uiv(this.addr,e)}function aj(n,e){n.uniform3uiv(this.addr,e)}function lj(n,e){n.uniform4uiv(this.addr,e)}function uj(n,e,t){const i=this.cache,r=e.length,s=h2(t,r);Er(i,s)||(n.uniform1iv(this.addr,s),Cr(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||SE,s[o])}function cj(n,e,t){const i=this.cache,r=e.length,s=h2(t,r);Er(i,s)||(n.uniform1iv(this.addr,s),Cr(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||ME,s[o])}function hj(n,e,t){const i=this.cache,r=e.length,s=h2(t,r);Er(i,s)||(n.uniform1iv(this.addr,s),Cr(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||EE,s[o])}function fj(n,e,t){const i=this.cache,r=e.length,s=h2(t,r);Er(i,s)||(n.uniform1iv(this.addr,s),Cr(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||TE,s[o])}function Aj(n){switch(n){case 5126:return XW;case 35664:return QW;case 35665:return YW;case 35666:return ZW;case 35674:return KW;case 35675:return JW;case 35676:return ej;case 5124:case 35670:return tj;case 35667:case 35671:return nj;case 35668:case 35672:return ij;case 35669:case 35673:return rj;case 5125:return sj;case 36294:return oj;case 36295:return aj;case 36296:return lj;case 35678:case 36198:case 36298:case 36306:case 35682:return uj;case 35679:case 36299:case 36307:return cj;case 35680:case 36300:case 36308:case 36293:return hj;case 36289:case 36303:case 36311:case 36292:return fj}}class dj{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=jW(t.type)}}class pj{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=Aj(t.type)}}class mj{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const h3=/(\w+)(\])?(\[|\.)?/g;function E6(n,e){n.seq.push(e),n.map[e.id]=e}function gj(n,e,t){const i=n.name,r=i.length;for(h3.lastIndex=0;;){const s=h3.exec(i),o=h3.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===r){E6(t,u===void 0?new dj(a,n,e):new pj(a,n,e));break}else{let p=t.map[a];p===void 0&&(p=new mj(a),E6(t,p)),t=p}}}class A1{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);gj(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function C6(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const _j=37297;let vj=0;function yj(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}const R6=new dn;function xj(n){Rn._getMatrix(R6,Rn.workingColorSpace,n);const e=`mat3( ${R6.elements.map(t=>t.toFixed(4))} )`;switch(Rn.getTransfer(n)){case V1:return[e,"LinearTransferOETF"];case oi:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function N6(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+yj(n.getShaderSource(e),o)}else return r}function bj(n,e){const t=xj(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function wj(n,e){let t;switch(e){case z7:t="Linear";break;case H7:t="Reinhard";break;case $7:t="Cineon";break;case W7:t="ACESFilmic";break;case j7:t="AgX";break;case X7:t="Neutral";break;case mG:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const mm=new ie;function Sj(){Rn.getLuminanceCoefficients(mm);const n=mm.x.toFixed(4),e=mm.y.toFixed(4),t=mm.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Tj(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(x0).join(`
`)}function Mj(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function Ej(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function x0(n){return n!==""}function P6(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function L6(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Cj=/^[ \t]*#include +<([\w\d./]+)>/gm;function Vv(n){return n.replace(Cj,Nj)}const Rj=new Map;function Nj(n,e){let t=Pn[e];if(t===void 0){const i=Rj.get(e);if(i!==void 0)t=Pn[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return Vv(t)}const Pj=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function D6(n){return n.replace(Pj,Lj)}function Lj(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function I6(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Dj(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===bx?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===hG?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===co&&(e="SHADOWMAP_TYPE_VSM"),e}function Ij(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case ga:case _a:e="ENVMAP_TYPE_CUBE";break;case Kc:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Bj(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case _a:e="ENVMAP_MODE_REFRACTION";break}return e}function Fj(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case tp:e="ENVMAP_BLENDING_MULTIPLY";break;case G7:e="ENVMAP_BLENDING_MIX";break;case q7:e="ENVMAP_BLENDING_ADD";break}return e}function Uj(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function Oj(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=Dj(t),u=Ij(t),A=Bj(t),p=Fj(t),g=Uj(t),v=Tj(t),x=Mj(s),S=r.createProgram();let T,w,R=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(T=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(x0).join(`
`),T.length>0&&(T+=`
`),w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(x0).join(`
`),w.length>0&&(w+=`
`)):(T=[I6(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+A:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(x0).join(`
`),w=[I6(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+A:"",t.envMap?"#define "+p:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Qs?"#define TONE_MAPPING":"",t.toneMapping!==Qs?Pn.tonemapping_pars_fragment:"",t.toneMapping!==Qs?wj("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Pn.colorspace_pars_fragment,bj("linearToOutputTexel",t.outputColorSpace),Sj(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(x0).join(`
`)),o=Vv(o),o=P6(o,t),o=L6(o,t),a=Vv(a),a=P6(a,t),a=L6(a,t),o=D6(o),a=D6(a),t.isRawShaderMaterial!==!0&&(R=`#version 300 es
`,T=[v,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+T,w=["#define varying in",t.glslVersion===C8?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===C8?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);const E=R+T+o,N=R+w+a,D=C6(r,r.VERTEX_SHADER,E),B=C6(r,r.FRAGMENT_SHADER,N);r.attachShader(S,D),r.attachShader(S,B),t.index0AttributeName!==void 0?r.bindAttribLocation(S,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(S,0,"position"),r.linkProgram(S);function I(V){if(n.debug.checkShaderErrors){const H=r.getProgramInfoLog(S).trim(),Q=r.getShaderInfoLog(D).trim(),te=r.getShaderInfoLog(B).trim();let K=!0,W=!0;if(r.getProgramParameter(S,r.LINK_STATUS)===!1)if(K=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,S,D,B);else{const Z=N6(r,D,"vertex"),J=N6(r,B,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(S,r.VALIDATE_STATUS)+`

Material Name: `+V.name+`
Material Type: `+V.type+`

Program Info Log: `+H+`
`+Z+`
`+J)}else H!==""?console.warn("THREE.WebGLProgram: Program Info Log:",H):(Q===""||te==="")&&(W=!1);W&&(V.diagnostics={runnable:K,programLog:H,vertexShader:{log:Q,prefix:T},fragmentShader:{log:te,prefix:w}})}r.deleteShader(D),r.deleteShader(B),O=new A1(r,S),L=Ej(r,S)}let O;this.getUniforms=function(){return O===void 0&&I(this),O};let L;this.getAttributes=function(){return L===void 0&&I(this),L};let F=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return F===!1&&(F=r.getProgramParameter(S,_j)),F},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(S),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=vj++,this.cacheKey=e,this.usedTimes=1,this.program=S,this.vertexShader=D,this.fragmentShader=B,this}let kj=0;class Vj{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new Gj(e),t.set(e,i)),i}}class Gj{constructor(e){this.id=kj++,this.code=e,this.usedTimes=0}}function qj(n,e,t,i,r,s,o){const a=new jx,l=new Vj,u=new Set,A=[],p=r.logarithmicDepthBuffer,g=r.vertexTextures;let v=r.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function S(L){return u.add(L),L===0?"uv":`uv${L}`}function T(L,F,V,H,Q){const te=H.fog,K=Q.geometry,W=L.isMeshStandardMaterial?H.environment:null,Z=(L.isMeshStandardMaterial?t:e).get(L.envMap||W),J=Z&&Z.mapping===Kc?Z.image.height:null,fe=x[L.type];L.precision!==null&&(v=r.getMaxPrecision(L.precision),v!==L.precision&&console.warn("THREE.WebGLProgram.getParameters:",L.precision,"not supported, using",v,"instead."));const ge=K.morphAttributes.position||K.morphAttributes.normal||K.morphAttributes.color,pe=ge!==void 0?ge.length:0;let Ae=0;K.morphAttributes.position!==void 0&&(Ae=1),K.morphAttributes.normal!==void 0&&(Ae=2),K.morphAttributes.color!==void 0&&(Ae=3);let Fe,be,Ve,Ye;if(fe){const Hn=Gs[fe];Fe=Hn.vertexShader,be=Hn.fragmentShader}else Fe=L.vertexShader,be=L.fragmentShader,l.update(L),Ve=l.getVertexShaderID(L),Ye=l.getFragmentShaderID(L);const Xe=n.getRenderTarget(),Tt=n.state.buffers.depth.getReversed(),yt=Q.isInstancedMesh===!0,ut=Q.isBatchedMesh===!0,Ut=!!L.map,ue=!!L.matcap,ce=!!Z,G=!!L.aoMap,Ee=!!L.lightMap,ye=!!L.bumpMap,we=!!L.normalMap,Se=!!L.displacementMap,ze=!!L.emissiveMap,Ne=!!L.metalnessMap,j=!!L.roughnessMap,q=L.anisotropy>0,he=L.clearcoat>0,Me=L.dispersion>0,Ue=L.iridescence>0,Be=L.sheen>0,At=L.transmission>0,tt=q&&!!L.anisotropyMap,Nt=he&&!!L.clearcoatMap,It=he&&!!L.clearcoatNormalMap,st=he&&!!L.clearcoatRoughnessMap,bt=Ue&&!!L.iridescenceMap,Gt=Ue&&!!L.iridescenceThicknessMap,Zt=Be&&!!L.sheenColorMap,wt=Be&&!!L.sheenRoughnessMap,tn=!!L.specularMap,Ot=!!L.specularColorMap,fn=!!L.specularIntensityMap,ne=At&&!!L.transmissionMap,Rt=At&&!!L.thicknessMap,We=!!L.gradientMap,it=!!L.alphaMap,Pt=L.alphaTest>0,Ct=!!L.alphaHash,wn=!!L.extensions;let Ri=Qs;L.toneMapped&&(Xe===null||Xe.isXRRenderTarget===!0)&&(Ri=n.toneMapping);const xr={shaderID:fe,shaderType:L.type,shaderName:L.name,vertexShader:Fe,fragmentShader:be,defines:L.defines,customVertexShaderID:Ve,customFragmentShaderID:Ye,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:v,batching:ut,batchingColor:ut&&Q._colorsTexture!==null,instancing:yt,instancingColor:yt&&Q.instanceColor!==null,instancingMorph:yt&&Q.morphTexture!==null,supportsVertexTextures:g,outputColorSpace:Xe===null?n.outputColorSpace:Xe.isXRRenderTarget===!0?Xe.texture.colorSpace:ha,alphaToCoverage:!!L.alphaToCoverage,map:Ut,matcap:ue,envMap:ce,envMapMode:ce&&Z.mapping,envMapCubeUVHeight:J,aoMap:G,lightMap:Ee,bumpMap:ye,normalMap:we,displacementMap:g&&Se,emissiveMap:ze,normalMapObjectSpace:we&&L.normalMapType===Q7,normalMapTangentSpace:we&&L.normalMapType===Ol,metalnessMap:Ne,roughnessMap:j,anisotropy:q,anisotropyMap:tt,clearcoat:he,clearcoatMap:Nt,clearcoatNormalMap:It,clearcoatRoughnessMap:st,dispersion:Me,iridescence:Ue,iridescenceMap:bt,iridescenceThicknessMap:Gt,sheen:Be,sheenColorMap:Zt,sheenRoughnessMap:wt,specularMap:tn,specularColorMap:Ot,specularIntensityMap:fn,transmission:At,transmissionMap:ne,thicknessMap:Rt,gradientMap:We,opaque:L.transparent===!1&&L.blending===Fs&&L.alphaToCoverage===!1,alphaMap:it,alphaTest:Pt,alphaHash:Ct,combine:L.combine,mapUv:Ut&&S(L.map.channel),aoMapUv:G&&S(L.aoMap.channel),lightMapUv:Ee&&S(L.lightMap.channel),bumpMapUv:ye&&S(L.bumpMap.channel),normalMapUv:we&&S(L.normalMap.channel),displacementMapUv:Se&&S(L.displacementMap.channel),emissiveMapUv:ze&&S(L.emissiveMap.channel),metalnessMapUv:Ne&&S(L.metalnessMap.channel),roughnessMapUv:j&&S(L.roughnessMap.channel),anisotropyMapUv:tt&&S(L.anisotropyMap.channel),clearcoatMapUv:Nt&&S(L.clearcoatMap.channel),clearcoatNormalMapUv:It&&S(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:st&&S(L.clearcoatRoughnessMap.channel),iridescenceMapUv:bt&&S(L.iridescenceMap.channel),iridescenceThicknessMapUv:Gt&&S(L.iridescenceThicknessMap.channel),sheenColorMapUv:Zt&&S(L.sheenColorMap.channel),sheenRoughnessMapUv:wt&&S(L.sheenRoughnessMap.channel),specularMapUv:tn&&S(L.specularMap.channel),specularColorMapUv:Ot&&S(L.specularColorMap.channel),specularIntensityMapUv:fn&&S(L.specularIntensityMap.channel),transmissionMapUv:ne&&S(L.transmissionMap.channel),thicknessMapUv:Rt&&S(L.thicknessMap.channel),alphaMapUv:it&&S(L.alphaMap.channel),vertexTangents:!!K.attributes.tangent&&(we||q),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!K.attributes.color&&K.attributes.color.itemSize===4,pointsUvs:Q.isPoints===!0&&!!K.attributes.uv&&(Ut||it),fog:!!te,useFog:L.fog===!0,fogExp2:!!te&&te.isFogExp2,flatShading:L.flatShading===!0,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:p,reverseDepthBuffer:Tt,skinning:Q.isSkinnedMesh===!0,morphTargets:K.morphAttributes.position!==void 0,morphNormals:K.morphAttributes.normal!==void 0,morphColors:K.morphAttributes.color!==void 0,morphTargetsCount:pe,morphTextureStride:Ae,numDirLights:F.directional.length,numPointLights:F.point.length,numSpotLights:F.spot.length,numSpotLightMaps:F.spotLightMap.length,numRectAreaLights:F.rectArea.length,numHemiLights:F.hemi.length,numDirLightShadows:F.directionalShadowMap.length,numPointLightShadows:F.pointShadowMap.length,numSpotLightShadows:F.spotShadowMap.length,numSpotLightShadowsWithMaps:F.numSpotLightShadowsWithMaps,numLightProbes:F.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:L.dithering,shadowMapEnabled:n.shadowMap.enabled&&V.length>0,shadowMapType:n.shadowMap.type,toneMapping:Ri,decodeVideoTexture:Ut&&L.map.isVideoTexture===!0&&Rn.getTransfer(L.map.colorSpace)===oi,decodeVideoTextureEmissive:ze&&L.emissiveMap.isVideoTexture===!0&&Rn.getTransfer(L.emissiveMap.colorSpace)===oi,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===_r,flipSided:L.side===_i,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:wn&&L.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(wn&&L.extensions.multiDraw===!0||ut)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return xr.vertexUv1s=u.has(1),xr.vertexUv2s=u.has(2),xr.vertexUv3s=u.has(3),u.clear(),xr}function w(L){const F=[];if(L.shaderID?F.push(L.shaderID):(F.push(L.customVertexShaderID),F.push(L.customFragmentShaderID)),L.defines!==void 0)for(const V in L.defines)F.push(V),F.push(L.defines[V]);return L.isRawShaderMaterial===!1&&(R(F,L),E(F,L),F.push(n.outputColorSpace)),F.push(L.customProgramCacheKey),F.join()}function R(L,F){L.push(F.precision),L.push(F.outputColorSpace),L.push(F.envMapMode),L.push(F.envMapCubeUVHeight),L.push(F.mapUv),L.push(F.alphaMapUv),L.push(F.lightMapUv),L.push(F.aoMapUv),L.push(F.bumpMapUv),L.push(F.normalMapUv),L.push(F.displacementMapUv),L.push(F.emissiveMapUv),L.push(F.metalnessMapUv),L.push(F.roughnessMapUv),L.push(F.anisotropyMapUv),L.push(F.clearcoatMapUv),L.push(F.clearcoatNormalMapUv),L.push(F.clearcoatRoughnessMapUv),L.push(F.iridescenceMapUv),L.push(F.iridescenceThicknessMapUv),L.push(F.sheenColorMapUv),L.push(F.sheenRoughnessMapUv),L.push(F.specularMapUv),L.push(F.specularColorMapUv),L.push(F.specularIntensityMapUv),L.push(F.transmissionMapUv),L.push(F.thicknessMapUv),L.push(F.combine),L.push(F.fogExp2),L.push(F.sizeAttenuation),L.push(F.morphTargetsCount),L.push(F.morphAttributeCount),L.push(F.numDirLights),L.push(F.numPointLights),L.push(F.numSpotLights),L.push(F.numSpotLightMaps),L.push(F.numHemiLights),L.push(F.numRectAreaLights),L.push(F.numDirLightShadows),L.push(F.numPointLightShadows),L.push(F.numSpotLightShadows),L.push(F.numSpotLightShadowsWithMaps),L.push(F.numLightProbes),L.push(F.shadowMapType),L.push(F.toneMapping),L.push(F.numClippingPlanes),L.push(F.numClipIntersection),L.push(F.depthPacking)}function E(L,F){a.disableAll(),F.supportsVertexTextures&&a.enable(0),F.instancing&&a.enable(1),F.instancingColor&&a.enable(2),F.instancingMorph&&a.enable(3),F.matcap&&a.enable(4),F.envMap&&a.enable(5),F.normalMapObjectSpace&&a.enable(6),F.normalMapTangentSpace&&a.enable(7),F.clearcoat&&a.enable(8),F.iridescence&&a.enable(9),F.alphaTest&&a.enable(10),F.vertexColors&&a.enable(11),F.vertexAlphas&&a.enable(12),F.vertexUv1s&&a.enable(13),F.vertexUv2s&&a.enable(14),F.vertexUv3s&&a.enable(15),F.vertexTangents&&a.enable(16),F.anisotropy&&a.enable(17),F.alphaHash&&a.enable(18),F.batching&&a.enable(19),F.dispersion&&a.enable(20),F.batchingColor&&a.enable(21),L.push(a.mask),a.disableAll(),F.fog&&a.enable(0),F.useFog&&a.enable(1),F.flatShading&&a.enable(2),F.logarithmicDepthBuffer&&a.enable(3),F.reverseDepthBuffer&&a.enable(4),F.skinning&&a.enable(5),F.morphTargets&&a.enable(6),F.morphNormals&&a.enable(7),F.morphColors&&a.enable(8),F.premultipliedAlpha&&a.enable(9),F.shadowMapEnabled&&a.enable(10),F.doubleSided&&a.enable(11),F.flipSided&&a.enable(12),F.useDepthPacking&&a.enable(13),F.dithering&&a.enable(14),F.transmission&&a.enable(15),F.sheen&&a.enable(16),F.opaque&&a.enable(17),F.pointsUvs&&a.enable(18),F.decodeVideoTexture&&a.enable(19),F.decodeVideoTextureEmissive&&a.enable(20),F.alphaToCoverage&&a.enable(21),L.push(a.mask)}function N(L){const F=x[L.type];let V;if(F){const H=Gs[F];V=Yx.clone(H.uniforms)}else V=L.uniforms;return V}function D(L,F){let V;for(let H=0,Q=A.length;H<Q;H++){const te=A[H];if(te.cacheKey===F){V=te,++V.usedTimes;break}}return V===void 0&&(V=new Oj(n,F,L,s),A.push(V)),V}function B(L){if(--L.usedTimes===0){const F=A.indexOf(L);A[F]=A[A.length-1],A.pop(),L.destroy()}}function I(L){l.remove(L)}function O(){l.dispose()}return{getParameters:T,getProgramCacheKey:w,getUniforms:N,acquireProgram:D,releaseProgram:B,releaseShaderCache:I,programs:A,dispose:O}}function zj(){let n=new WeakMap;function e(o){return n.has(o)}function t(o){let a=n.get(o);return a===void 0&&(a={},n.set(o,a)),a}function i(o){n.delete(o)}function r(o,a,l){n.get(o)[a]=l}function s(){n=new WeakMap}return{has:e,get:t,remove:i,update:r,dispose:s}}function Hj(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function B6(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function F6(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(p,g,v,x,S,T){let w=n[e];return w===void 0?(w={id:p.id,object:p,geometry:g,material:v,groupOrder:x,renderOrder:p.renderOrder,z:S,group:T},n[e]=w):(w.id=p.id,w.object=p,w.geometry=g,w.material=v,w.groupOrder=x,w.renderOrder=p.renderOrder,w.z=S,w.group=T),e++,w}function a(p,g,v,x,S,T){const w=o(p,g,v,x,S,T);v.transmission>0?i.push(w):v.transparent===!0?r.push(w):t.push(w)}function l(p,g,v,x,S,T){const w=o(p,g,v,x,S,T);v.transmission>0?i.unshift(w):v.transparent===!0?r.unshift(w):t.unshift(w)}function u(p,g){t.length>1&&t.sort(p||Hj),i.length>1&&i.sort(g||B6),r.length>1&&r.sort(g||B6)}function A(){for(let p=e,g=n.length;p<g;p++){const v=n[p];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:A,sort:u}}function $j(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new F6,n.set(i,[o])):r>=s.length?(o=new F6,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function Wj(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ie,color:new Ft};break;case"SpotLight":t={position:new ie,direction:new ie,color:new Ft,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ie,color:new Ft,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ie,skyColor:new Ft,groundColor:new Ft};break;case"RectAreaLight":t={color:new Ft,position:new ie,halfWidth:new ie,halfHeight:new ie};break}return n[e.id]=t,t}}}function jj(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new at};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new at};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new at,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let Xj=0;function Qj(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function Yj(n){const e=new Wj,t=jj(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new ie);const r=new ie,s=new en,o=new en;function a(u){let A=0,p=0,g=0;for(let L=0;L<9;L++)i.probe[L].set(0,0,0);let v=0,x=0,S=0,T=0,w=0,R=0,E=0,N=0,D=0,B=0,I=0;u.sort(Qj);for(let L=0,F=u.length;L<F;L++){const V=u[L],H=V.color,Q=V.intensity,te=V.distance,K=V.shadow&&V.shadow.map?V.shadow.map.texture:null;if(V.isAmbientLight)A+=H.r*Q,p+=H.g*Q,g+=H.b*Q;else if(V.isLightProbe){for(let W=0;W<9;W++)i.probe[W].addScaledVector(V.sh.coefficients[W],Q);I++}else if(V.isDirectionalLight){const W=e.get(V);if(W.color.copy(V.color).multiplyScalar(V.intensity),V.castShadow){const Z=V.shadow,J=t.get(V);J.shadowIntensity=Z.intensity,J.shadowBias=Z.bias,J.shadowNormalBias=Z.normalBias,J.shadowRadius=Z.radius,J.shadowMapSize=Z.mapSize,i.directionalShadow[v]=J,i.directionalShadowMap[v]=K,i.directionalShadowMatrix[v]=V.shadow.matrix,R++}i.directional[v]=W,v++}else if(V.isSpotLight){const W=e.get(V);W.position.setFromMatrixPosition(V.matrixWorld),W.color.copy(H).multiplyScalar(Q),W.distance=te,W.coneCos=Math.cos(V.angle),W.penumbraCos=Math.cos(V.angle*(1-V.penumbra)),W.decay=V.decay,i.spot[S]=W;const Z=V.shadow;if(V.map&&(i.spotLightMap[D]=V.map,D++,Z.updateMatrices(V),V.castShadow&&B++),i.spotLightMatrix[S]=Z.matrix,V.castShadow){const J=t.get(V);J.shadowIntensity=Z.intensity,J.shadowBias=Z.bias,J.shadowNormalBias=Z.normalBias,J.shadowRadius=Z.radius,J.shadowMapSize=Z.mapSize,i.spotShadow[S]=J,i.spotShadowMap[S]=K,N++}S++}else if(V.isRectAreaLight){const W=e.get(V);W.color.copy(H).multiplyScalar(Q),W.halfWidth.set(V.width*.5,0,0),W.halfHeight.set(0,V.height*.5,0),i.rectArea[T]=W,T++}else if(V.isPointLight){const W=e.get(V);if(W.color.copy(V.color).multiplyScalar(V.intensity),W.distance=V.distance,W.decay=V.decay,V.castShadow){const Z=V.shadow,J=t.get(V);J.shadowIntensity=Z.intensity,J.shadowBias=Z.bias,J.shadowNormalBias=Z.normalBias,J.shadowRadius=Z.radius,J.shadowMapSize=Z.mapSize,J.shadowCameraNear=Z.camera.near,J.shadowCameraFar=Z.camera.far,i.pointShadow[x]=J,i.pointShadowMap[x]=K,i.pointShadowMatrix[x]=V.shadow.matrix,E++}i.point[x]=W,x++}else if(V.isHemisphereLight){const W=e.get(V);W.skyColor.copy(V.color).multiplyScalar(Q),W.groundColor.copy(V.groundColor).multiplyScalar(Q),i.hemi[w]=W,w++}}T>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Mt.LTC_FLOAT_1,i.rectAreaLTC2=Mt.LTC_FLOAT_2):(i.rectAreaLTC1=Mt.LTC_HALF_1,i.rectAreaLTC2=Mt.LTC_HALF_2)),i.ambient[0]=A,i.ambient[1]=p,i.ambient[2]=g;const O=i.hash;(O.directionalLength!==v||O.pointLength!==x||O.spotLength!==S||O.rectAreaLength!==T||O.hemiLength!==w||O.numDirectionalShadows!==R||O.numPointShadows!==E||O.numSpotShadows!==N||O.numSpotMaps!==D||O.numLightProbes!==I)&&(i.directional.length=v,i.spot.length=S,i.rectArea.length=T,i.point.length=x,i.hemi.length=w,i.directionalShadow.length=R,i.directionalShadowMap.length=R,i.pointShadow.length=E,i.pointShadowMap.length=E,i.spotShadow.length=N,i.spotShadowMap.length=N,i.directionalShadowMatrix.length=R,i.pointShadowMatrix.length=E,i.spotLightMatrix.length=N+D-B,i.spotLightMap.length=D,i.numSpotLightShadowsWithMaps=B,i.numLightProbes=I,O.directionalLength=v,O.pointLength=x,O.spotLength=S,O.rectAreaLength=T,O.hemiLength=w,O.numDirectionalShadows=R,O.numPointShadows=E,O.numSpotShadows=N,O.numSpotMaps=D,O.numLightProbes=I,i.version=Xj++)}function l(u,A){let p=0,g=0,v=0,x=0,S=0;const T=A.matrixWorldInverse;for(let w=0,R=u.length;w<R;w++){const E=u[w];if(E.isDirectionalLight){const N=i.directional[p];N.direction.setFromMatrixPosition(E.matrixWorld),r.setFromMatrixPosition(E.target.matrixWorld),N.direction.sub(r),N.direction.transformDirection(T),p++}else if(E.isSpotLight){const N=i.spot[v];N.position.setFromMatrixPosition(E.matrixWorld),N.position.applyMatrix4(T),N.direction.setFromMatrixPosition(E.matrixWorld),r.setFromMatrixPosition(E.target.matrixWorld),N.direction.sub(r),N.direction.transformDirection(T),v++}else if(E.isRectAreaLight){const N=i.rectArea[x];N.position.setFromMatrixPosition(E.matrixWorld),N.position.applyMatrix4(T),o.identity(),s.copy(E.matrixWorld),s.premultiply(T),o.extractRotation(s),N.halfWidth.set(E.width*.5,0,0),N.halfHeight.set(0,E.height*.5,0),N.halfWidth.applyMatrix4(o),N.halfHeight.applyMatrix4(o),x++}else if(E.isPointLight){const N=i.point[g];N.position.setFromMatrixPosition(E.matrixWorld),N.position.applyMatrix4(T),g++}else if(E.isHemisphereLight){const N=i.hemi[S];N.direction.setFromMatrixPosition(E.matrixWorld),N.direction.transformDirection(T),S++}}}return{setup:a,setupView:l,state:i}}function U6(n){const e=new Yj(n),t=[],i=[];function r(A){u.camera=A,t.length=0,i.length=0}function s(A){t.push(A)}function o(A){i.push(A)}function a(){e.setup(t)}function l(A){e.setupView(t,A)}const u={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:u,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function Zj(n){let e=new WeakMap;function t(r,s=0){const o=e.get(r);let a;return o===void 0?(a=new U6(n),e.set(r,[a])):s>=o.length?(a=new U6(n),o.push(a)):a=o[s],a}function i(){e=new WeakMap}return{get:t,dispose:i}}const Kj=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Jj=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function eX(n,e,t){let i=new wA;const r=new at,s=new at,o=new $t,a=new hz({depthPacking:bG}),l=new fz,u={},A=t.maxTextureSize,p={[Xs]:_i,[_i]:Xs,[_r]:_r},g=new zo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new at},radius:{value:4}},vertexShader:Kj,fragmentShader:Jj}),v=g.clone();v.defines.HORIZONTAL_PASS=1;const x=new Ai;x.setAttribute("position",new Gi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const S=new Jn(x,g),T=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=bx;let w=this.type;this.render=function(B,I,O){if(T.enabled===!1||T.autoUpdate===!1&&T.needsUpdate===!1||B.length===0)return;const L=n.getRenderTarget(),F=n.getActiveCubeFace(),V=n.getActiveMipmapLevel(),H=n.state;H.setBlending(vo),H.buffers.color.setClear(1,1,1,1),H.buffers.depth.setTest(!0),H.setScissorTest(!1);const Q=w!==co&&this.type===co,te=w===co&&this.type!==co;for(let K=0,W=B.length;K<W;K++){const Z=B[K],J=Z.shadow;if(J===void 0){console.warn("THREE.WebGLShadowMap:",Z,"has no shadow.");continue}if(J.autoUpdate===!1&&J.needsUpdate===!1)continue;r.copy(J.mapSize);const fe=J.getFrameExtents();if(r.multiply(fe),s.copy(J.mapSize),(r.x>A||r.y>A)&&(r.x>A&&(s.x=Math.floor(A/fe.x),r.x=s.x*fe.x,J.mapSize.x=s.x),r.y>A&&(s.y=Math.floor(A/fe.y),r.y=s.y*fe.y,J.mapSize.y=s.y)),J.map===null||Q===!0||te===!0){const pe=this.type!==co?{minFilter:Mi,magFilter:Mi}:{};J.map!==null&&J.map.dispose(),J.map=new nh(r.x,r.y,pe),J.map.texture.name=Z.name+".shadowMap",J.camera.updateProjectionMatrix()}n.setRenderTarget(J.map),n.clear();const ge=J.getViewportCount();for(let pe=0;pe<ge;pe++){const Ae=J.getViewport(pe);o.set(s.x*Ae.x,s.y*Ae.y,s.x*Ae.z,s.y*Ae.w),H.viewport(o),J.updateMatrices(Z,pe),i=J.getFrustum(),N(I,O,J.camera,Z,this.type)}J.isPointLightShadow!==!0&&this.type===co&&R(J,O),J.needsUpdate=!1}w=this.type,T.needsUpdate=!1,n.setRenderTarget(L,F,V)};function R(B,I){const O=e.update(S);g.defines.VSM_SAMPLES!==B.blurSamples&&(g.defines.VSM_SAMPLES=B.blurSamples,v.defines.VSM_SAMPLES=B.blurSamples,g.needsUpdate=!0,v.needsUpdate=!0),B.mapPass===null&&(B.mapPass=new nh(r.x,r.y)),g.uniforms.shadow_pass.value=B.map.texture,g.uniforms.resolution.value=B.mapSize,g.uniforms.radius.value=B.radius,n.setRenderTarget(B.mapPass),n.clear(),n.renderBufferDirect(I,null,O,g,S,null),v.uniforms.shadow_pass.value=B.mapPass.texture,v.uniforms.resolution.value=B.mapSize,v.uniforms.radius.value=B.radius,n.setRenderTarget(B.map),n.clear(),n.renderBufferDirect(I,null,O,v,S,null)}function E(B,I,O,L){let F=null;const V=O.isPointLight===!0?B.customDistanceMaterial:B.customDepthMaterial;if(V!==void 0)F=V;else if(F=O.isPointLight===!0?l:a,n.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0||I.alphaToCoverage===!0){const H=F.uuid,Q=I.uuid;let te=u[H];te===void 0&&(te={},u[H]=te);let K=te[Q];K===void 0&&(K=F.clone(),te[Q]=K,I.addEventListener("dispose",D)),F=K}if(F.visible=I.visible,F.wireframe=I.wireframe,L===co?F.side=I.shadowSide!==null?I.shadowSide:I.side:F.side=I.shadowSide!==null?I.shadowSide:p[I.side],F.alphaMap=I.alphaMap,F.alphaTest=I.alphaToCoverage===!0?.5:I.alphaTest,F.map=I.map,F.clipShadows=I.clipShadows,F.clippingPlanes=I.clippingPlanes,F.clipIntersection=I.clipIntersection,F.displacementMap=I.displacementMap,F.displacementScale=I.displacementScale,F.displacementBias=I.displacementBias,F.wireframeLinewidth=I.wireframeLinewidth,F.linewidth=I.linewidth,O.isPointLight===!0&&F.isMeshDistanceMaterial===!0){const H=n.properties.get(F);H.light=O}return F}function N(B,I,O,L,F){if(B.visible===!1)return;if(B.layers.test(I.layers)&&(B.isMesh||B.isLine||B.isPoints)&&(B.castShadow||B.receiveShadow&&F===co)&&(!B.frustumCulled||i.intersectsObject(B))){B.modelViewMatrix.multiplyMatrices(O.matrixWorldInverse,B.matrixWorld);const Q=e.update(B),te=B.material;if(Array.isArray(te)){const K=Q.groups;for(let W=0,Z=K.length;W<Z;W++){const J=K[W],fe=te[J.materialIndex];if(fe&&fe.visible){const ge=E(B,fe,L,F);B.onBeforeShadow(n,B,I,O,Q,ge,J),n.renderBufferDirect(O,null,Q,ge,B,J),B.onAfterShadow(n,B,I,O,Q,ge,J)}}}else if(te.visible){const K=E(B,te,L,F);B.onBeforeShadow(n,B,I,O,Q,K,null),n.renderBufferDirect(O,null,Q,K,B,null),B.onAfterShadow(n,B,I,O,Q,K,null)}}const H=B.children;for(let Q=0,te=H.length;Q<te;Q++)N(H[Q],I,O,L,F)}function D(B){B.target.removeEventListener("dispose",D);for(const O in u){const L=u[O],F=B.target.uuid;F in L&&(L[F].dispose(),delete L[F])}}}const tX={[sd]:od,[ad]:cd,[ld]:hd,[Ou]:ud,[od]:sd,[cd]:ad,[hd]:ld,[ud]:Ou};function nX(n,e){function t(){let ne=!1;const Rt=new $t;let We=null;const it=new $t(0,0,0,0);return{setMask:function(Pt){We!==Pt&&!ne&&(n.colorMask(Pt,Pt,Pt,Pt),We=Pt)},setLocked:function(Pt){ne=Pt},setClear:function(Pt,Ct,wn,Ri,xr){xr===!0&&(Pt*=Ri,Ct*=Ri,wn*=Ri),Rt.set(Pt,Ct,wn,Ri),it.equals(Rt)===!1&&(n.clearColor(Pt,Ct,wn,Ri),it.copy(Rt))},reset:function(){ne=!1,We=null,it.set(-1,0,0,0)}}}function i(){let ne=!1,Rt=!1,We=null,it=null,Pt=null;return{setReversed:function(Ct){if(Rt!==Ct){const wn=e.get("EXT_clip_control");Ct?wn.clipControlEXT(wn.LOWER_LEFT_EXT,wn.ZERO_TO_ONE_EXT):wn.clipControlEXT(wn.LOWER_LEFT_EXT,wn.NEGATIVE_ONE_TO_ONE_EXT),Rt=Ct;const Ri=Pt;Pt=null,this.setClear(Ri)}},getReversed:function(){return Rt},setTest:function(Ct){Ct?Xe(n.DEPTH_TEST):Tt(n.DEPTH_TEST)},setMask:function(Ct){We!==Ct&&!ne&&(n.depthMask(Ct),We=Ct)},setFunc:function(Ct){if(Rt&&(Ct=tX[Ct]),it!==Ct){switch(Ct){case sd:n.depthFunc(n.NEVER);break;case od:n.depthFunc(n.ALWAYS);break;case ad:n.depthFunc(n.LESS);break;case Ou:n.depthFunc(n.LEQUAL);break;case ld:n.depthFunc(n.EQUAL);break;case ud:n.depthFunc(n.GEQUAL);break;case cd:n.depthFunc(n.GREATER);break;case hd:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}it=Ct}},setLocked:function(Ct){ne=Ct},setClear:function(Ct){Pt!==Ct&&(Rt&&(Ct=1-Ct),n.clearDepth(Ct),Pt=Ct)},reset:function(){ne=!1,We=null,it=null,Pt=null,Rt=!1}}}function r(){let ne=!1,Rt=null,We=null,it=null,Pt=null,Ct=null,wn=null,Ri=null,xr=null;return{setTest:function(Hn){ne||(Hn?Xe(n.STENCIL_TEST):Tt(n.STENCIL_TEST))},setMask:function(Hn){Rt!==Hn&&!ne&&(n.stencilMask(Hn),Rt=Hn)},setFunc:function(Hn,gs,Jr){(We!==Hn||it!==gs||Pt!==Jr)&&(n.stencilFunc(Hn,gs,Jr),We=Hn,it=gs,Pt=Jr)},setOp:function(Hn,gs,Jr){(Ct!==Hn||wn!==gs||Ri!==Jr)&&(n.stencilOp(Hn,gs,Jr),Ct=Hn,wn=gs,Ri=Jr)},setLocked:function(Hn){ne=Hn},setClear:function(Hn){xr!==Hn&&(n.clearStencil(Hn),xr=Hn)},reset:function(){ne=!1,Rt=null,We=null,it=null,Pt=null,Ct=null,wn=null,Ri=null,xr=null}}}const s=new t,o=new i,a=new r,l=new WeakMap,u=new WeakMap;let A={},p={},g=new WeakMap,v=[],x=null,S=!1,T=null,w=null,R=null,E=null,N=null,D=null,B=null,I=new Ft(0,0,0),O=0,L=!1,F=null,V=null,H=null,Q=null,te=null;const K=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,Z=0;const J=n.getParameter(n.VERSION);J.indexOf("WebGL")!==-1?(Z=parseFloat(/^WebGL (\d)/.exec(J)[1]),W=Z>=1):J.indexOf("OpenGL ES")!==-1&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(J)[1]),W=Z>=2);let fe=null,ge={};const pe=n.getParameter(n.SCISSOR_BOX),Ae=n.getParameter(n.VIEWPORT),Fe=new $t().fromArray(pe),be=new $t().fromArray(Ae);function Ve(ne,Rt,We,it){const Pt=new Uint8Array(4),Ct=n.createTexture();n.bindTexture(ne,Ct),n.texParameteri(ne,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ne,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let wn=0;wn<We;wn++)ne===n.TEXTURE_3D||ne===n.TEXTURE_2D_ARRAY?n.texImage3D(Rt,0,n.RGBA,1,1,it,0,n.RGBA,n.UNSIGNED_BYTE,Pt):n.texImage2D(Rt+wn,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Pt);return Ct}const Ye={};Ye[n.TEXTURE_2D]=Ve(n.TEXTURE_2D,n.TEXTURE_2D,1),Ye[n.TEXTURE_CUBE_MAP]=Ve(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ye[n.TEXTURE_2D_ARRAY]=Ve(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ye[n.TEXTURE_3D]=Ve(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),Xe(n.DEPTH_TEST),o.setFunc(Ou),ye(!1),we(Pv),Xe(n.CULL_FACE),G(vo);function Xe(ne){A[ne]!==!0&&(n.enable(ne),A[ne]=!0)}function Tt(ne){A[ne]!==!1&&(n.disable(ne),A[ne]=!1)}function yt(ne,Rt){return p[ne]!==Rt?(n.bindFramebuffer(ne,Rt),p[ne]=Rt,ne===n.DRAW_FRAMEBUFFER&&(p[n.FRAMEBUFFER]=Rt),ne===n.FRAMEBUFFER&&(p[n.DRAW_FRAMEBUFFER]=Rt),!0):!1}function ut(ne,Rt){let We=v,it=!1;if(ne){We=g.get(Rt),We===void 0&&(We=[],g.set(Rt,We));const Pt=ne.textures;if(We.length!==Pt.length||We[0]!==n.COLOR_ATTACHMENT0){for(let Ct=0,wn=Pt.length;Ct<wn;Ct++)We[Ct]=n.COLOR_ATTACHMENT0+Ct;We.length=Pt.length,it=!0}}else We[0]!==n.BACK&&(We[0]=n.BACK,it=!0);it&&n.drawBuffers(We)}function Ut(ne){return x!==ne?(n.useProgram(ne),x=ne,!0):!1}const ue={[cs]:n.FUNC_ADD,[wx]:n.FUNC_SUBTRACT,[Sx]:n.FUNC_REVERSE_SUBTRACT};ue[k7]=n.MIN,ue[V7]=n.MAX;const ce={[xl]:n.ZERO,[Tx]:n.ONE,[Mx]:n.SRC_COLOR,[id]:n.SRC_ALPHA,[Lx]:n.SRC_ALPHA_SATURATE,[Nx]:n.DST_COLOR,[Cx]:n.DST_ALPHA,[Ex]:n.ONE_MINUS_SRC_COLOR,[rd]:n.ONE_MINUS_SRC_ALPHA,[Px]:n.ONE_MINUS_DST_COLOR,[Rx]:n.ONE_MINUS_DST_ALPHA,[fG]:n.CONSTANT_COLOR,[AG]:n.ONE_MINUS_CONSTANT_COLOR,[dG]:n.CONSTANT_ALPHA,[pG]:n.ONE_MINUS_CONSTANT_ALPHA};function G(ne,Rt,We,it,Pt,Ct,wn,Ri,xr,Hn){if(ne===vo){S===!0&&(Tt(n.BLEND),S=!1);return}if(S===!1&&(Xe(n.BLEND),S=!0),ne!==Cf){if(ne!==T||Hn!==L){if((w!==cs||N!==cs)&&(n.blendEquation(n.FUNC_ADD),w=cs,N=cs),Hn)switch(ne){case Fs:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Qc:n.blendFunc(n.ONE,n.ONE);break;case Vf:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Gf:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ne);break}else switch(ne){case Fs:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Qc:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case Vf:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Gf:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ne);break}R=null,E=null,D=null,B=null,I.set(0,0,0),O=0,T=ne,L=Hn}return}Pt=Pt||Rt,Ct=Ct||We,wn=wn||it,(Rt!==w||Pt!==N)&&(n.blendEquationSeparate(ue[Rt],ue[Pt]),w=Rt,N=Pt),(We!==R||it!==E||Ct!==D||wn!==B)&&(n.blendFuncSeparate(ce[We],ce[it],ce[Ct],ce[wn]),R=We,E=it,D=Ct,B=wn),(Ri.equals(I)===!1||xr!==O)&&(n.blendColor(Ri.r,Ri.g,Ri.b,xr),I.copy(Ri),O=xr),T=ne,L=!1}function Ee(ne,Rt){ne.side===_r?Tt(n.CULL_FACE):Xe(n.CULL_FACE);let We=ne.side===_i;Rt&&(We=!We),ye(We),ne.blending===Fs&&ne.transparent===!1?G(vo):G(ne.blending,ne.blendEquation,ne.blendSrc,ne.blendDst,ne.blendEquationAlpha,ne.blendSrcAlpha,ne.blendDstAlpha,ne.blendColor,ne.blendAlpha,ne.premultipliedAlpha),o.setFunc(ne.depthFunc),o.setTest(ne.depthTest),o.setMask(ne.depthWrite),s.setMask(ne.colorWrite);const it=ne.stencilWrite;a.setTest(it),it&&(a.setMask(ne.stencilWriteMask),a.setFunc(ne.stencilFunc,ne.stencilRef,ne.stencilFuncMask),a.setOp(ne.stencilFail,ne.stencilZFail,ne.stencilZPass)),ze(ne.polygonOffset,ne.polygonOffsetFactor,ne.polygonOffsetUnits),ne.alphaToCoverage===!0?Xe(n.SAMPLE_ALPHA_TO_COVERAGE):Tt(n.SAMPLE_ALPHA_TO_COVERAGE)}function ye(ne){F!==ne&&(ne?n.frontFace(n.CW):n.frontFace(n.CCW),F=ne)}function we(ne){ne!==U7?(Xe(n.CULL_FACE),ne!==V&&(ne===Pv?n.cullFace(n.BACK):ne===O7?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Tt(n.CULL_FACE),V=ne}function Se(ne){ne!==H&&(W&&n.lineWidth(ne),H=ne)}function ze(ne,Rt,We){ne?(Xe(n.POLYGON_OFFSET_FILL),(Q!==Rt||te!==We)&&(n.polygonOffset(Rt,We),Q=Rt,te=We)):Tt(n.POLYGON_OFFSET_FILL)}function Ne(ne){ne?Xe(n.SCISSOR_TEST):Tt(n.SCISSOR_TEST)}function j(ne){ne===void 0&&(ne=n.TEXTURE0+K-1),fe!==ne&&(n.activeTexture(ne),fe=ne)}function q(ne,Rt,We){We===void 0&&(fe===null?We=n.TEXTURE0+K-1:We=fe);let it=ge[We];it===void 0&&(it={type:void 0,texture:void 0},ge[We]=it),(it.type!==ne||it.texture!==Rt)&&(fe!==We&&(n.activeTexture(We),fe=We),n.bindTexture(ne,Rt||Ye[ne]),it.type=ne,it.texture=Rt)}function he(){const ne=ge[fe];ne!==void 0&&ne.type!==void 0&&(n.bindTexture(ne.type,null),ne.type=void 0,ne.texture=void 0)}function Me(){try{n.compressedTexImage2D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Ue(){try{n.compressedTexImage3D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Be(){try{n.texSubImage2D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function At(){try{n.texSubImage3D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function tt(){try{n.compressedTexSubImage2D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Nt(){try{n.compressedTexSubImage3D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function It(){try{n.texStorage2D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function st(){try{n.texStorage3D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function bt(){try{n.texImage2D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Gt(){try{n.texImage3D(...arguments)}catch(ne){console.error("THREE.WebGLState:",ne)}}function Zt(ne){Fe.equals(ne)===!1&&(n.scissor(ne.x,ne.y,ne.z,ne.w),Fe.copy(ne))}function wt(ne){be.equals(ne)===!1&&(n.viewport(ne.x,ne.y,ne.z,ne.w),be.copy(ne))}function tn(ne,Rt){let We=u.get(Rt);We===void 0&&(We=new WeakMap,u.set(Rt,We));let it=We.get(ne);it===void 0&&(it=n.getUniformBlockIndex(Rt,ne.name),We.set(ne,it))}function Ot(ne,Rt){const it=u.get(Rt).get(ne);l.get(Rt)!==it&&(n.uniformBlockBinding(Rt,it,ne.__bindingPointIndex),l.set(Rt,it))}function fn(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),o.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),A={},fe=null,ge={},p={},g=new WeakMap,v=[],x=null,S=!1,T=null,w=null,R=null,E=null,N=null,D=null,B=null,I=new Ft(0,0,0),O=0,L=!1,F=null,V=null,H=null,Q=null,te=null,Fe.set(0,0,n.canvas.width,n.canvas.height),be.set(0,0,n.canvas.width,n.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:Xe,disable:Tt,bindFramebuffer:yt,drawBuffers:ut,useProgram:Ut,setBlending:G,setMaterial:Ee,setFlipSided:ye,setCullFace:we,setLineWidth:Se,setPolygonOffset:ze,setScissorTest:Ne,activeTexture:j,bindTexture:q,unbindTexture:he,compressedTexImage2D:Me,compressedTexImage3D:Ue,texImage2D:bt,texImage3D:Gt,updateUBOMapping:tn,uniformBlockBinding:Ot,texStorage2D:It,texStorage3D:st,texSubImage2D:Be,texSubImage3D:At,compressedTexSubImage2D:tt,compressedTexSubImage3D:Nt,scissor:Zt,viewport:wt,reset:fn}}function iX(n,e,t,i,r,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new at,A=new WeakMap;let p;const g=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(j,q){return v?new OffscreenCanvas(j,q):yd("canvas")}function S(j,q,he){let Me=1;const Ue=Ne(j);if((Ue.width>he||Ue.height>he)&&(Me=he/Math.max(Ue.width,Ue.height)),Me<1)if(typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&j instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&j instanceof ImageBitmap||typeof VideoFrame<"u"&&j instanceof VideoFrame){const Be=Math.floor(Me*Ue.width),At=Math.floor(Me*Ue.height);p===void 0&&(p=x(Be,At));const tt=q?x(Be,At):p;return tt.width=Be,tt.height=At,tt.getContext("2d").drawImage(j,0,0,Be,At),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ue.width+"x"+Ue.height+") to ("+Be+"x"+At+")."),tt}else return"data"in j&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ue.width+"x"+Ue.height+")."),j;return j}function T(j){return j.generateMipmaps}function w(j){n.generateMipmap(j)}function R(j){return j.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:j.isWebGL3DRenderTarget?n.TEXTURE_3D:j.isWebGLArrayRenderTarget||j.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function E(j,q,he,Me,Ue=!1){if(j!==null){if(n[j]!==void 0)return n[j];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+j+"'")}let Be=q;if(q===n.RED&&(he===n.FLOAT&&(Be=n.R32F),he===n.HALF_FLOAT&&(Be=n.R16F),he===n.UNSIGNED_BYTE&&(Be=n.R8)),q===n.RED_INTEGER&&(he===n.UNSIGNED_BYTE&&(Be=n.R8UI),he===n.UNSIGNED_SHORT&&(Be=n.R16UI),he===n.UNSIGNED_INT&&(Be=n.R32UI),he===n.BYTE&&(Be=n.R8I),he===n.SHORT&&(Be=n.R16I),he===n.INT&&(Be=n.R32I)),q===n.RG&&(he===n.FLOAT&&(Be=n.RG32F),he===n.HALF_FLOAT&&(Be=n.RG16F),he===n.UNSIGNED_BYTE&&(Be=n.RG8)),q===n.RG_INTEGER&&(he===n.UNSIGNED_BYTE&&(Be=n.RG8UI),he===n.UNSIGNED_SHORT&&(Be=n.RG16UI),he===n.UNSIGNED_INT&&(Be=n.RG32UI),he===n.BYTE&&(Be=n.RG8I),he===n.SHORT&&(Be=n.RG16I),he===n.INT&&(Be=n.RG32I)),q===n.RGB_INTEGER&&(he===n.UNSIGNED_BYTE&&(Be=n.RGB8UI),he===n.UNSIGNED_SHORT&&(Be=n.RGB16UI),he===n.UNSIGNED_INT&&(Be=n.RGB32UI),he===n.BYTE&&(Be=n.RGB8I),he===n.SHORT&&(Be=n.RGB16I),he===n.INT&&(Be=n.RGB32I)),q===n.RGBA_INTEGER&&(he===n.UNSIGNED_BYTE&&(Be=n.RGBA8UI),he===n.UNSIGNED_SHORT&&(Be=n.RGBA16UI),he===n.UNSIGNED_INT&&(Be=n.RGBA32UI),he===n.BYTE&&(Be=n.RGBA8I),he===n.SHORT&&(Be=n.RGBA16I),he===n.INT&&(Be=n.RGBA32I)),q===n.RGB&&he===n.UNSIGNED_INT_5_9_9_9_REV&&(Be=n.RGB9_E5),q===n.RGBA){const At=Ue?V1:Rn.getTransfer(Me);he===n.FLOAT&&(Be=n.RGBA32F),he===n.HALF_FLOAT&&(Be=n.RGBA16F),he===n.UNSIGNED_BYTE&&(Be=At===oi?n.SRGB8_ALPHA8:n.RGBA8),he===n.UNSIGNED_SHORT_4_4_4_4&&(Be=n.RGBA4),he===n.UNSIGNED_SHORT_5_5_5_1&&(Be=n.RGB5_A1)}return(Be===n.R16F||Be===n.R32F||Be===n.RG16F||Be===n.RG32F||Be===n.RGBA16F||Be===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Be}function N(j,q){let he;return j?q===null||q===bi||q===yo?he=n.DEPTH24_STENCIL8:q===lr?he=n.DEPTH32F_STENCIL8:q===sa&&(he=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):q===null||q===bi||q===yo?he=n.DEPTH_COMPONENT24:q===lr?he=n.DEPTH_COMPONENT32F:q===sa&&(he=n.DEPTH_COMPONENT16),he}function D(j,q){return T(j)===!0||j.isFramebufferTexture&&j.minFilter!==Mi&&j.minFilter!==Tr?Math.log2(Math.max(q.width,q.height))+1:j.mipmaps!==void 0&&j.mipmaps.length>0?j.mipmaps.length:j.isCompressedTexture&&Array.isArray(j.image)?q.mipmaps.length:1}function B(j){const q=j.target;q.removeEventListener("dispose",B),O(q),q.isVideoTexture&&A.delete(q)}function I(j){const q=j.target;q.removeEventListener("dispose",I),F(q)}function O(j){const q=i.get(j);if(q.__webglInit===void 0)return;const he=j.source,Me=g.get(he);if(Me){const Ue=Me[q.__cacheKey];Ue.usedTimes--,Ue.usedTimes===0&&L(j),Object.keys(Me).length===0&&g.delete(he)}i.remove(j)}function L(j){const q=i.get(j);n.deleteTexture(q.__webglTexture);const he=j.source,Me=g.get(he);delete Me[q.__cacheKey],o.memory.textures--}function F(j){const q=i.get(j);if(j.depthTexture&&(j.depthTexture.dispose(),i.remove(j.depthTexture)),j.isWebGLCubeRenderTarget)for(let Me=0;Me<6;Me++){if(Array.isArray(q.__webglFramebuffer[Me]))for(let Ue=0;Ue<q.__webglFramebuffer[Me].length;Ue++)n.deleteFramebuffer(q.__webglFramebuffer[Me][Ue]);else n.deleteFramebuffer(q.__webglFramebuffer[Me]);q.__webglDepthbuffer&&n.deleteRenderbuffer(q.__webglDepthbuffer[Me])}else{if(Array.isArray(q.__webglFramebuffer))for(let Me=0;Me<q.__webglFramebuffer.length;Me++)n.deleteFramebuffer(q.__webglFramebuffer[Me]);else n.deleteFramebuffer(q.__webglFramebuffer);if(q.__webglDepthbuffer&&n.deleteRenderbuffer(q.__webglDepthbuffer),q.__webglMultisampledFramebuffer&&n.deleteFramebuffer(q.__webglMultisampledFramebuffer),q.__webglColorRenderbuffer)for(let Me=0;Me<q.__webglColorRenderbuffer.length;Me++)q.__webglColorRenderbuffer[Me]&&n.deleteRenderbuffer(q.__webglColorRenderbuffer[Me]);q.__webglDepthRenderbuffer&&n.deleteRenderbuffer(q.__webglDepthRenderbuffer)}const he=j.textures;for(let Me=0,Ue=he.length;Me<Ue;Me++){const Be=i.get(he[Me]);Be.__webglTexture&&(n.deleteTexture(Be.__webglTexture),o.memory.textures--),i.remove(he[Me])}i.remove(j)}let V=0;function H(){V=0}function Q(){const j=V;return j>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+j+" texture units while this GPU supports only "+r.maxTextures),V+=1,j}function te(j){const q=[];return q.push(j.wrapS),q.push(j.wrapT),q.push(j.wrapR||0),q.push(j.magFilter),q.push(j.minFilter),q.push(j.anisotropy),q.push(j.internalFormat),q.push(j.format),q.push(j.type),q.push(j.generateMipmaps),q.push(j.premultiplyAlpha),q.push(j.flipY),q.push(j.unpackAlignment),q.push(j.colorSpace),q.join()}function K(j,q){const he=i.get(j);if(j.isVideoTexture&&Se(j),j.isRenderTargetTexture===!1&&j.version>0&&he.__version!==j.version){const Me=j.image;if(Me===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Me.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{be(he,j,q);return}}t.bindTexture(n.TEXTURE_2D,he.__webglTexture,n.TEXTURE0+q)}function W(j,q){const he=i.get(j);if(j.version>0&&he.__version!==j.version){be(he,j,q);return}t.bindTexture(n.TEXTURE_2D_ARRAY,he.__webglTexture,n.TEXTURE0+q)}function Z(j,q){const he=i.get(j);if(j.version>0&&he.__version!==j.version){be(he,j,q);return}t.bindTexture(n.TEXTURE_3D,he.__webglTexture,n.TEXTURE0+q)}function J(j,q){const he=i.get(j);if(j.version>0&&he.__version!==j.version){Ve(he,j,q);return}t.bindTexture(n.TEXTURE_CUBE_MAP,he.__webglTexture,n.TEXTURE0+q)}const fe={[Jc]:n.REPEAT,[qa]:n.CLAMP_TO_EDGE,[eh]:n.MIRRORED_REPEAT},ge={[Mi]:n.NEAREST,[Ix]:n.NEAREST_MIPMAP_NEAREST,[Pl]:n.NEAREST_MIPMAP_LINEAR,[Tr]:n.LINEAR,[Rf]:n.LINEAR_MIPMAP_NEAREST,[zs]:n.LINEAR_MIPMAP_LINEAR},pe={[Ux]:n.NEVER,[qx]:n.ALWAYS,[Jg]:n.LESS,[e2]:n.LEQUAL,[Ox]:n.EQUAL,[Gx]:n.GEQUAL,[kx]:n.GREATER,[Vx]:n.NOTEQUAL};function Ae(j,q){if(q.type===lr&&e.has("OES_texture_float_linear")===!1&&(q.magFilter===Tr||q.magFilter===Rf||q.magFilter===Pl||q.magFilter===zs||q.minFilter===Tr||q.minFilter===Rf||q.minFilter===Pl||q.minFilter===zs)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(j,n.TEXTURE_WRAP_S,fe[q.wrapS]),n.texParameteri(j,n.TEXTURE_WRAP_T,fe[q.wrapT]),(j===n.TEXTURE_3D||j===n.TEXTURE_2D_ARRAY)&&n.texParameteri(j,n.TEXTURE_WRAP_R,fe[q.wrapR]),n.texParameteri(j,n.TEXTURE_MAG_FILTER,ge[q.magFilter]),n.texParameteri(j,n.TEXTURE_MIN_FILTER,ge[q.minFilter]),q.compareFunction&&(n.texParameteri(j,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(j,n.TEXTURE_COMPARE_FUNC,pe[q.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(q.magFilter===Mi||q.minFilter!==Pl&&q.minFilter!==zs||q.type===lr&&e.has("OES_texture_float_linear")===!1)return;if(q.anisotropy>1||i.get(q).__currentAnisotropy){const he=e.get("EXT_texture_filter_anisotropic");n.texParameterf(j,he.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(q.anisotropy,r.getMaxAnisotropy())),i.get(q).__currentAnisotropy=q.anisotropy}}}function Fe(j,q){let he=!1;j.__webglInit===void 0&&(j.__webglInit=!0,q.addEventListener("dispose",B));const Me=q.source;let Ue=g.get(Me);Ue===void 0&&(Ue={},g.set(Me,Ue));const Be=te(q);if(Be!==j.__cacheKey){Ue[Be]===void 0&&(Ue[Be]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,he=!0),Ue[Be].usedTimes++;const At=Ue[j.__cacheKey];At!==void 0&&(Ue[j.__cacheKey].usedTimes--,At.usedTimes===0&&L(q)),j.__cacheKey=Be,j.__webglTexture=Ue[Be].texture}return he}function be(j,q,he){let Me=n.TEXTURE_2D;(q.isDataArrayTexture||q.isCompressedArrayTexture)&&(Me=n.TEXTURE_2D_ARRAY),q.isData3DTexture&&(Me=n.TEXTURE_3D);const Ue=Fe(j,q),Be=q.source;t.bindTexture(Me,j.__webglTexture,n.TEXTURE0+he);const At=i.get(Be);if(Be.version!==At.__version||Ue===!0){t.activeTexture(n.TEXTURE0+he);const tt=Rn.getPrimaries(Rn.workingColorSpace),Nt=q.colorSpace===go?null:Rn.getPrimaries(q.colorSpace),It=q.colorSpace===go||tt===Nt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,q.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,q.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,It);let st=S(q.image,!1,r.maxTextureSize);st=ze(q,st);const bt=s.convert(q.format,q.colorSpace),Gt=s.convert(q.type);let Zt=E(q.internalFormat,bt,Gt,q.colorSpace,q.isVideoTexture);Ae(Me,q);let wt;const tn=q.mipmaps,Ot=q.isVideoTexture!==!0,fn=At.__version===void 0||Ue===!0,ne=Be.dataReady,Rt=D(q,st);if(q.isDepthTexture)Zt=N(q.format===bo,q.type),fn&&(Ot?t.texStorage2D(n.TEXTURE_2D,1,Zt,st.width,st.height):t.texImage2D(n.TEXTURE_2D,0,Zt,st.width,st.height,0,bt,Gt,null));else if(q.isDataTexture)if(tn.length>0){Ot&&fn&&t.texStorage2D(n.TEXTURE_2D,Rt,Zt,tn[0].width,tn[0].height);for(let We=0,it=tn.length;We<it;We++)wt=tn[We],Ot?ne&&t.texSubImage2D(n.TEXTURE_2D,We,0,0,wt.width,wt.height,bt,Gt,wt.data):t.texImage2D(n.TEXTURE_2D,We,Zt,wt.width,wt.height,0,bt,Gt,wt.data);q.generateMipmaps=!1}else Ot?(fn&&t.texStorage2D(n.TEXTURE_2D,Rt,Zt,st.width,st.height),ne&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,st.width,st.height,bt,Gt,st.data)):t.texImage2D(n.TEXTURE_2D,0,Zt,st.width,st.height,0,bt,Gt,st.data);else if(q.isCompressedTexture)if(q.isCompressedArrayTexture){Ot&&fn&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Rt,Zt,tn[0].width,tn[0].height,st.depth);for(let We=0,it=tn.length;We<it;We++)if(wt=tn[We],q.format!==ir)if(bt!==null)if(Ot){if(ne)if(q.layerUpdates.size>0){const Pt=A6(wt.width,wt.height,q.format,q.type);for(const Ct of q.layerUpdates){const wn=wt.data.subarray(Ct*Pt/wt.data.BYTES_PER_ELEMENT,(Ct+1)*Pt/wt.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,We,0,0,Ct,wt.width,wt.height,1,bt,wn)}q.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,We,0,0,0,wt.width,wt.height,st.depth,bt,wt.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,We,Zt,wt.width,wt.height,st.depth,0,wt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ot?ne&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,We,0,0,0,wt.width,wt.height,st.depth,bt,Gt,wt.data):t.texImage3D(n.TEXTURE_2D_ARRAY,We,Zt,wt.width,wt.height,st.depth,0,bt,Gt,wt.data)}else{Ot&&fn&&t.texStorage2D(n.TEXTURE_2D,Rt,Zt,tn[0].width,tn[0].height);for(let We=0,it=tn.length;We<it;We++)wt=tn[We],q.format!==ir?bt!==null?Ot?ne&&t.compressedTexSubImage2D(n.TEXTURE_2D,We,0,0,wt.width,wt.height,bt,wt.data):t.compressedTexImage2D(n.TEXTURE_2D,We,Zt,wt.width,wt.height,0,wt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ot?ne&&t.texSubImage2D(n.TEXTURE_2D,We,0,0,wt.width,wt.height,bt,Gt,wt.data):t.texImage2D(n.TEXTURE_2D,We,Zt,wt.width,wt.height,0,bt,Gt,wt.data)}else if(q.isDataArrayTexture)if(Ot){if(fn&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Rt,Zt,st.width,st.height,st.depth),ne)if(q.layerUpdates.size>0){const We=A6(st.width,st.height,q.format,q.type);for(const it of q.layerUpdates){const Pt=st.data.subarray(it*We/st.data.BYTES_PER_ELEMENT,(it+1)*We/st.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,it,st.width,st.height,1,bt,Gt,Pt)}q.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,st.width,st.height,st.depth,bt,Gt,st.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,Zt,st.width,st.height,st.depth,0,bt,Gt,st.data);else if(q.isData3DTexture)Ot?(fn&&t.texStorage3D(n.TEXTURE_3D,Rt,Zt,st.width,st.height,st.depth),ne&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,st.width,st.height,st.depth,bt,Gt,st.data)):t.texImage3D(n.TEXTURE_3D,0,Zt,st.width,st.height,st.depth,0,bt,Gt,st.data);else if(q.isFramebufferTexture){if(fn)if(Ot)t.texStorage2D(n.TEXTURE_2D,Rt,Zt,st.width,st.height);else{let We=st.width,it=st.height;for(let Pt=0;Pt<Rt;Pt++)t.texImage2D(n.TEXTURE_2D,Pt,Zt,We,it,0,bt,Gt,null),We>>=1,it>>=1}}else if(tn.length>0){if(Ot&&fn){const We=Ne(tn[0]);t.texStorage2D(n.TEXTURE_2D,Rt,Zt,We.width,We.height)}for(let We=0,it=tn.length;We<it;We++)wt=tn[We],Ot?ne&&t.texSubImage2D(n.TEXTURE_2D,We,0,0,bt,Gt,wt):t.texImage2D(n.TEXTURE_2D,We,Zt,bt,Gt,wt);q.generateMipmaps=!1}else if(Ot){if(fn){const We=Ne(st);t.texStorage2D(n.TEXTURE_2D,Rt,Zt,We.width,We.height)}ne&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,bt,Gt,st)}else t.texImage2D(n.TEXTURE_2D,0,Zt,bt,Gt,st);T(q)&&w(Me),At.__version=Be.version,q.onUpdate&&q.onUpdate(q)}j.__version=q.version}function Ve(j,q,he){if(q.image.length!==6)return;const Me=Fe(j,q),Ue=q.source;t.bindTexture(n.TEXTURE_CUBE_MAP,j.__webglTexture,n.TEXTURE0+he);const Be=i.get(Ue);if(Ue.version!==Be.__version||Me===!0){t.activeTexture(n.TEXTURE0+he);const At=Rn.getPrimaries(Rn.workingColorSpace),tt=q.colorSpace===go?null:Rn.getPrimaries(q.colorSpace),Nt=q.colorSpace===go||At===tt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,q.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,q.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Nt);const It=q.isCompressedTexture||q.image[0].isCompressedTexture,st=q.image[0]&&q.image[0].isDataTexture,bt=[];for(let it=0;it<6;it++)!It&&!st?bt[it]=S(q.image[it],!0,r.maxCubemapSize):bt[it]=st?q.image[it].image:q.image[it],bt[it]=ze(q,bt[it]);const Gt=bt[0],Zt=s.convert(q.format,q.colorSpace),wt=s.convert(q.type),tn=E(q.internalFormat,Zt,wt,q.colorSpace),Ot=q.isVideoTexture!==!0,fn=Be.__version===void 0||Me===!0,ne=Ue.dataReady;let Rt=D(q,Gt);Ae(n.TEXTURE_CUBE_MAP,q);let We;if(It){Ot&&fn&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Rt,tn,Gt.width,Gt.height);for(let it=0;it<6;it++){We=bt[it].mipmaps;for(let Pt=0;Pt<We.length;Pt++){const Ct=We[Pt];q.format!==ir?Zt!==null?Ot?ne&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,Pt,0,0,Ct.width,Ct.height,Zt,Ct.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,Pt,tn,Ct.width,Ct.height,0,Ct.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ot?ne&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,Pt,0,0,Ct.width,Ct.height,Zt,wt,Ct.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,Pt,tn,Ct.width,Ct.height,0,Zt,wt,Ct.data)}}}else{if(We=q.mipmaps,Ot&&fn){We.length>0&&Rt++;const it=Ne(bt[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Rt,tn,it.width,it.height)}for(let it=0;it<6;it++)if(st){Ot?ne&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,0,0,bt[it].width,bt[it].height,Zt,wt,bt[it].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,tn,bt[it].width,bt[it].height,0,Zt,wt,bt[it].data);for(let Pt=0;Pt<We.length;Pt++){const wn=We[Pt].image[it].image;Ot?ne&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,Pt+1,0,0,wn.width,wn.height,Zt,wt,wn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,Pt+1,tn,wn.width,wn.height,0,Zt,wt,wn.data)}}else{Ot?ne&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,0,0,Zt,wt,bt[it]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,tn,Zt,wt,bt[it]);for(let Pt=0;Pt<We.length;Pt++){const Ct=We[Pt];Ot?ne&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,Pt+1,0,0,Zt,wt,Ct.image[it]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+it,Pt+1,tn,Zt,wt,Ct.image[it])}}}T(q)&&w(n.TEXTURE_CUBE_MAP),Be.__version=Ue.version,q.onUpdate&&q.onUpdate(q)}j.__version=q.version}function Ye(j,q,he,Me,Ue,Be){const At=s.convert(he.format,he.colorSpace),tt=s.convert(he.type),Nt=E(he.internalFormat,At,tt,he.colorSpace),It=i.get(q),st=i.get(he);if(st.__renderTarget=q,!It.__hasExternalTextures){const bt=Math.max(1,q.width>>Be),Gt=Math.max(1,q.height>>Be);Ue===n.TEXTURE_3D||Ue===n.TEXTURE_2D_ARRAY?t.texImage3D(Ue,Be,Nt,bt,Gt,q.depth,0,At,tt,null):t.texImage2D(Ue,Be,Nt,bt,Gt,0,At,tt,null)}t.bindFramebuffer(n.FRAMEBUFFER,j),we(q)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Me,Ue,st.__webglTexture,0,ye(q)):(Ue===n.TEXTURE_2D||Ue>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Ue<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Me,Ue,st.__webglTexture,Be),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Xe(j,q,he){if(n.bindRenderbuffer(n.RENDERBUFFER,j),q.depthBuffer){const Me=q.depthTexture,Ue=Me&&Me.isDepthTexture?Me.type:null,Be=N(q.stencilBuffer,Ue),At=q.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,tt=ye(q);we(q)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,tt,Be,q.width,q.height):he?n.renderbufferStorageMultisample(n.RENDERBUFFER,tt,Be,q.width,q.height):n.renderbufferStorage(n.RENDERBUFFER,Be,q.width,q.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,At,n.RENDERBUFFER,j)}else{const Me=q.textures;for(let Ue=0;Ue<Me.length;Ue++){const Be=Me[Ue],At=s.convert(Be.format,Be.colorSpace),tt=s.convert(Be.type),Nt=E(Be.internalFormat,At,tt,Be.colorSpace),It=ye(q);he&&we(q)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,It,Nt,q.width,q.height):we(q)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,It,Nt,q.width,q.height):n.renderbufferStorage(n.RENDERBUFFER,Nt,q.width,q.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Tt(j,q){if(q&&q.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,j),!(q.depthTexture&&q.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Me=i.get(q.depthTexture);Me.__renderTarget=q,(!Me.__webglTexture||q.depthTexture.image.width!==q.width||q.depthTexture.image.height!==q.height)&&(q.depthTexture.image.width=q.width,q.depthTexture.image.height=q.height,q.depthTexture.needsUpdate=!0),K(q.depthTexture,0);const Ue=Me.__webglTexture,Be=ye(q);if(q.depthTexture.format===xo)we(q)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ue,0,Be):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ue,0);else if(q.depthTexture.format===bo)we(q)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ue,0,Be):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ue,0);else throw new Error("Unknown depthTexture format")}function yt(j){const q=i.get(j),he=j.isWebGLCubeRenderTarget===!0;if(q.__boundDepthTexture!==j.depthTexture){const Me=j.depthTexture;if(q.__depthDisposeCallback&&q.__depthDisposeCallback(),Me){const Ue=()=>{delete q.__boundDepthTexture,delete q.__depthDisposeCallback,Me.removeEventListener("dispose",Ue)};Me.addEventListener("dispose",Ue),q.__depthDisposeCallback=Ue}q.__boundDepthTexture=Me}if(j.depthTexture&&!q.__autoAllocateDepthBuffer){if(he)throw new Error("target.depthTexture not supported in Cube render targets");const Me=j.texture.mipmaps;Me&&Me.length>0?Tt(q.__webglFramebuffer[0],j):Tt(q.__webglFramebuffer,j)}else if(he){q.__webglDepthbuffer=[];for(let Me=0;Me<6;Me++)if(t.bindFramebuffer(n.FRAMEBUFFER,q.__webglFramebuffer[Me]),q.__webglDepthbuffer[Me]===void 0)q.__webglDepthbuffer[Me]=n.createRenderbuffer(),Xe(q.__webglDepthbuffer[Me],j,!1);else{const Ue=j.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Be=q.__webglDepthbuffer[Me];n.bindRenderbuffer(n.RENDERBUFFER,Be),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ue,n.RENDERBUFFER,Be)}}else{const Me=j.texture.mipmaps;if(Me&&Me.length>0?t.bindFramebuffer(n.FRAMEBUFFER,q.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,q.__webglFramebuffer),q.__webglDepthbuffer===void 0)q.__webglDepthbuffer=n.createRenderbuffer(),Xe(q.__webglDepthbuffer,j,!1);else{const Ue=j.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Be=q.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,Be),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ue,n.RENDERBUFFER,Be)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function ut(j,q,he){const Me=i.get(j);q!==void 0&&Ye(Me.__webglFramebuffer,j,j.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),he!==void 0&&yt(j)}function Ut(j){const q=j.texture,he=i.get(j),Me=i.get(q);j.addEventListener("dispose",I);const Ue=j.textures,Be=j.isWebGLCubeRenderTarget===!0,At=Ue.length>1;if(At||(Me.__webglTexture===void 0&&(Me.__webglTexture=n.createTexture()),Me.__version=q.version,o.memory.textures++),Be){he.__webglFramebuffer=[];for(let tt=0;tt<6;tt++)if(q.mipmaps&&q.mipmaps.length>0){he.__webglFramebuffer[tt]=[];for(let Nt=0;Nt<q.mipmaps.length;Nt++)he.__webglFramebuffer[tt][Nt]=n.createFramebuffer()}else he.__webglFramebuffer[tt]=n.createFramebuffer()}else{if(q.mipmaps&&q.mipmaps.length>0){he.__webglFramebuffer=[];for(let tt=0;tt<q.mipmaps.length;tt++)he.__webglFramebuffer[tt]=n.createFramebuffer()}else he.__webglFramebuffer=n.createFramebuffer();if(At)for(let tt=0,Nt=Ue.length;tt<Nt;tt++){const It=i.get(Ue[tt]);It.__webglTexture===void 0&&(It.__webglTexture=n.createTexture(),o.memory.textures++)}if(j.samples>0&&we(j)===!1){he.__webglMultisampledFramebuffer=n.createFramebuffer(),he.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,he.__webglMultisampledFramebuffer);for(let tt=0;tt<Ue.length;tt++){const Nt=Ue[tt];he.__webglColorRenderbuffer[tt]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,he.__webglColorRenderbuffer[tt]);const It=s.convert(Nt.format,Nt.colorSpace),st=s.convert(Nt.type),bt=E(Nt.internalFormat,It,st,Nt.colorSpace,j.isXRRenderTarget===!0),Gt=ye(j);n.renderbufferStorageMultisample(n.RENDERBUFFER,Gt,bt,j.width,j.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+tt,n.RENDERBUFFER,he.__webglColorRenderbuffer[tt])}n.bindRenderbuffer(n.RENDERBUFFER,null),j.depthBuffer&&(he.__webglDepthRenderbuffer=n.createRenderbuffer(),Xe(he.__webglDepthRenderbuffer,j,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Be){t.bindTexture(n.TEXTURE_CUBE_MAP,Me.__webglTexture),Ae(n.TEXTURE_CUBE_MAP,q);for(let tt=0;tt<6;tt++)if(q.mipmaps&&q.mipmaps.length>0)for(let Nt=0;Nt<q.mipmaps.length;Nt++)Ye(he.__webglFramebuffer[tt][Nt],j,q,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,Nt);else Ye(he.__webglFramebuffer[tt],j,q,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,0);T(q)&&w(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(At){for(let tt=0,Nt=Ue.length;tt<Nt;tt++){const It=Ue[tt],st=i.get(It);t.bindTexture(n.TEXTURE_2D,st.__webglTexture),Ae(n.TEXTURE_2D,It),Ye(he.__webglFramebuffer,j,It,n.COLOR_ATTACHMENT0+tt,n.TEXTURE_2D,0),T(It)&&w(n.TEXTURE_2D)}t.unbindTexture()}else{let tt=n.TEXTURE_2D;if((j.isWebGL3DRenderTarget||j.isWebGLArrayRenderTarget)&&(tt=j.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(tt,Me.__webglTexture),Ae(tt,q),q.mipmaps&&q.mipmaps.length>0)for(let Nt=0;Nt<q.mipmaps.length;Nt++)Ye(he.__webglFramebuffer[Nt],j,q,n.COLOR_ATTACHMENT0,tt,Nt);else Ye(he.__webglFramebuffer,j,q,n.COLOR_ATTACHMENT0,tt,0);T(q)&&w(tt),t.unbindTexture()}j.depthBuffer&&yt(j)}function ue(j){const q=j.textures;for(let he=0,Me=q.length;he<Me;he++){const Ue=q[he];if(T(Ue)){const Be=R(j),At=i.get(Ue).__webglTexture;t.bindTexture(Be,At),w(Be),t.unbindTexture()}}}const ce=[],G=[];function Ee(j){if(j.samples>0){if(we(j)===!1){const q=j.textures,he=j.width,Me=j.height;let Ue=n.COLOR_BUFFER_BIT;const Be=j.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,At=i.get(j),tt=q.length>1;if(tt)for(let It=0;It<q.length;It++)t.bindFramebuffer(n.FRAMEBUFFER,At.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+It,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,At.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+It,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,At.__webglMultisampledFramebuffer);const Nt=j.texture.mipmaps;Nt&&Nt.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,At.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,At.__webglFramebuffer);for(let It=0;It<q.length;It++){if(j.resolveDepthBuffer&&(j.depthBuffer&&(Ue|=n.DEPTH_BUFFER_BIT),j.stencilBuffer&&j.resolveStencilBuffer&&(Ue|=n.STENCIL_BUFFER_BIT)),tt){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,At.__webglColorRenderbuffer[It]);const st=i.get(q[It]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,st,0)}n.blitFramebuffer(0,0,he,Me,0,0,he,Me,Ue,n.NEAREST),l===!0&&(ce.length=0,G.length=0,ce.push(n.COLOR_ATTACHMENT0+It),j.depthBuffer&&j.resolveDepthBuffer===!1&&(ce.push(Be),G.push(Be),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,G)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ce))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),tt)for(let It=0;It<q.length;It++){t.bindFramebuffer(n.FRAMEBUFFER,At.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+It,n.RENDERBUFFER,At.__webglColorRenderbuffer[It]);const st=i.get(q[It]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,At.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+It,n.TEXTURE_2D,st,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,At.__webglMultisampledFramebuffer)}else if(j.depthBuffer&&j.resolveDepthBuffer===!1&&l){const q=j.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[q])}}}function ye(j){return Math.min(r.maxSamples,j.samples)}function we(j){const q=i.get(j);return j.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&q.__useRenderToTexture!==!1}function Se(j){const q=o.render.frame;A.get(j)!==q&&(A.set(j,q),j.update())}function ze(j,q){const he=j.colorSpace,Me=j.format,Ue=j.type;return j.isCompressedTexture===!0||j.isVideoTexture===!0||he!==ha&&he!==go&&(Rn.getTransfer(he)===oi?(Me!==ir||Ue!==ji)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",he)),q}function Ne(j){return typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement?(u.width=j.naturalWidth||j.width,u.height=j.naturalHeight||j.height):typeof VideoFrame<"u"&&j instanceof VideoFrame?(u.width=j.displayWidth,u.height=j.displayHeight):(u.width=j.width,u.height=j.height),u}this.allocateTextureUnit=Q,this.resetTextureUnits=H,this.setTexture2D=K,this.setTexture2DArray=W,this.setTexture3D=Z,this.setTextureCube=J,this.rebindTextures=ut,this.setupRenderTarget=Ut,this.updateRenderTargetMipmap=ue,this.updateMultisampleRenderTarget=Ee,this.setupDepthRenderbuffer=yt,this.setupFrameBufferTexture=Ye,this.useMultisampledRTT=we}function rX(n,e){function t(i,r=go){let s;const o=Rn.getTransfer(r);if(i===ji)return n.UNSIGNED_BYTE;if(i===Yg)return n.UNSIGNED_SHORT_4_4_4_4;if(i===Zg)return n.UNSIGNED_SHORT_5_5_5_1;if(i===Kg)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===Uc)return n.BYTE;if(i===Oc)return n.SHORT;if(i===sa)return n.UNSIGNED_SHORT;if(i===Ir)return n.INT;if(i===bi)return n.UNSIGNED_INT;if(i===lr)return n.FLOAT;if(i===Mr)return n.HALF_FLOAT;if(i===Bx)return n.ALPHA;if(i===np)return n.RGB;if(i===ir)return n.RGBA;if(i===xo)return n.DEPTH_COMPONENT;if(i===bo)return n.DEPTH_STENCIL;if(i===ip)return n.RED;if(i===vA)return n.RED_INTEGER;if(i===Ll)return n.RG;if(i===yA)return n.RG_INTEGER;if(i===xA)return n.RGBA_INTEGER;if(i===kc||i===Nu||i===Pu||i===Lu)if(o===oi)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===kc)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Nu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Pu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Lu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===kc)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Nu)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Pu)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Lu)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===fd||i===Ad||i===dd||i===pd)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===fd)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Ad)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===dd)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===pd)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===md||i===qf||i===zf)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===md||i===qf)return o===oi?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===zf)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===Hf||i===$f||i===Wf||i===jf||i===Xf||i===Qf||i===Yf||i===Zf||i===Kf||i===Jf||i===eA||i===tA||i===nA||i===iA)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===Hf)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===$f)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===Wf)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===jf)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===Xf)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===Qf)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===Yf)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===Zf)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===Kf)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===Jf)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===eA)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===tA)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===nA)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===iA)return o===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===Vc||i===Lv||i===Dv)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===Vc)return o===oi?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===Lv)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===Dv)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===Fx||i===gd||i===_d||i===vd)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===Vc)return s.COMPRESSED_RED_RGTC1_EXT;if(i===gd)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===_d)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===vd)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===yo?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}const sX=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,oX=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class aX{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(this.texture===null){const r=new vr,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!==i.depthNear||t.depthFar!==i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,i=new zo({vertexShader:sX,fragmentShader:oX,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Jn(new sp(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class lX extends sl{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,u=null,A=null,p=null,g=null,v=null,x=null;const S=new aX,T=t.getContextAttributes();let w=null,R=null;const E=[],N=[],D=new at;let B=null;const I=new Br;I.viewport=new $t;const O=new Br;O.viewport=new $t;const L=[I,O],F=new bE;let V=null,H=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(be){let Ve=E[be];return Ve===void 0&&(Ve=new h1,E[be]=Ve),Ve.getTargetRaySpace()},this.getControllerGrip=function(be){let Ve=E[be];return Ve===void 0&&(Ve=new h1,E[be]=Ve),Ve.getGripSpace()},this.getHand=function(be){let Ve=E[be];return Ve===void 0&&(Ve=new h1,E[be]=Ve),Ve.getHandSpace()};function Q(be){const Ve=N.indexOf(be.inputSource);if(Ve===-1)return;const Ye=E[Ve];Ye!==void 0&&(Ye.update(be.inputSource,be.frame,u||o),Ye.dispatchEvent({type:be.type,data:be.inputSource}))}function te(){r.removeEventListener("select",Q),r.removeEventListener("selectstart",Q),r.removeEventListener("selectend",Q),r.removeEventListener("squeeze",Q),r.removeEventListener("squeezestart",Q),r.removeEventListener("squeezeend",Q),r.removeEventListener("end",te),r.removeEventListener("inputsourceschange",K);for(let be=0;be<E.length;be++){const Ve=N[be];Ve!==null&&(N[be]=null,E[be].disconnect(Ve))}V=null,H=null,S.reset(),e.setRenderTarget(w),v=null,g=null,p=null,r=null,R=null,Fe.stop(),i.isPresenting=!1,e.setPixelRatio(B),e.setSize(D.width,D.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(be){s=be,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(be){a=be,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(be){u=be},this.getBaseLayer=function(){return g!==null?g:v},this.getBinding=function(){return p},this.getFrame=function(){return x},this.getSession=function(){return r},this.setSession=async function(be){if(r=be,r!==null){if(w=e.getRenderTarget(),r.addEventListener("select",Q),r.addEventListener("selectstart",Q),r.addEventListener("selectend",Q),r.addEventListener("squeeze",Q),r.addEventListener("squeezestart",Q),r.addEventListener("squeezeend",Q),r.addEventListener("end",te),r.addEventListener("inputsourceschange",K),T.xrCompatible!==!0&&await t.makeXRCompatible(),B=e.getPixelRatio(),e.getSize(D),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ye=null,Xe=null,Tt=null;T.depth&&(Tt=T.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ye=T.stencil?bo:xo,Xe=T.stencil?yo:bi);const yt={colorFormat:t.RGBA8,depthFormat:Tt,scaleFactor:s};p=new XRWebGLBinding(r,t),g=p.createProjectionLayer(yt),r.updateRenderState({layers:[g]}),e.setPixelRatio(1),e.setSize(g.textureWidth,g.textureHeight,!1),R=new nh(g.textureWidth,g.textureHeight,{format:ir,type:ji,depthTexture:new Ys(g.textureWidth,g.textureHeight,Xe,void 0,void 0,void 0,void 0,void 0,void 0,Ye),stencilBuffer:T.stencil,colorSpace:e.outputColorSpace,samples:T.antialias?4:0,resolveDepthBuffer:g.ignoreDepthValues===!1,resolveStencilBuffer:g.ignoreDepthValues===!1})}else{const Ye={antialias:T.antialias,alpha:!0,depth:T.depth,stencil:T.stencil,framebufferScaleFactor:s};v=new XRWebGLLayer(r,t,Ye),r.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),R=new nh(v.framebufferWidth,v.framebufferHeight,{format:ir,type:ji,colorSpace:e.outputColorSpace,stencilBuffer:T.stencil,resolveDepthBuffer:v.ignoreDepthValues===!1,resolveStencilBuffer:v.ignoreDepthValues===!1})}R.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await r.requestReferenceSpace(a),Fe.setContext(r),Fe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return S.getDepthTexture()};function K(be){for(let Ve=0;Ve<be.removed.length;Ve++){const Ye=be.removed[Ve],Xe=N.indexOf(Ye);Xe>=0&&(N[Xe]=null,E[Xe].disconnect(Ye))}for(let Ve=0;Ve<be.added.length;Ve++){const Ye=be.added[Ve];let Xe=N.indexOf(Ye);if(Xe===-1){for(let yt=0;yt<E.length;yt++)if(yt>=N.length){N.push(Ye),Xe=yt;break}else if(N[yt]===null){N[yt]=Ye,Xe=yt;break}if(Xe===-1)break}const Tt=E[Xe];Tt&&Tt.connect(Ye)}}const W=new ie,Z=new ie;function J(be,Ve,Ye){W.setFromMatrixPosition(Ve.matrixWorld),Z.setFromMatrixPosition(Ye.matrixWorld);const Xe=W.distanceTo(Z),Tt=Ve.projectionMatrix.elements,yt=Ye.projectionMatrix.elements,ut=Tt[14]/(Tt[10]-1),Ut=Tt[14]/(Tt[10]+1),ue=(Tt[9]+1)/Tt[5],ce=(Tt[9]-1)/Tt[5],G=(Tt[8]-1)/Tt[0],Ee=(yt[8]+1)/yt[0],ye=ut*G,we=ut*Ee,Se=Xe/(-G+Ee),ze=Se*-G;if(Ve.matrixWorld.decompose(be.position,be.quaternion,be.scale),be.translateX(ze),be.translateZ(Se),be.matrixWorld.compose(be.position,be.quaternion,be.scale),be.matrixWorldInverse.copy(be.matrixWorld).invert(),Tt[10]===-1)be.projectionMatrix.copy(Ve.projectionMatrix),be.projectionMatrixInverse.copy(Ve.projectionMatrixInverse);else{const Ne=ut+Se,j=Ut+Se,q=ye-ze,he=we+(Xe-ze),Me=ue*Ut/j*Ne,Ue=ce*Ut/j*Ne;be.projectionMatrix.makePerspective(q,he,Me,Ue,Ne,j),be.projectionMatrixInverse.copy(be.projectionMatrix).invert()}}function fe(be,Ve){Ve===null?be.matrixWorld.copy(be.matrix):be.matrixWorld.multiplyMatrices(Ve.matrixWorld,be.matrix),be.matrixWorldInverse.copy(be.matrixWorld).invert()}this.updateCamera=function(be){if(r===null)return;let Ve=be.near,Ye=be.far;S.texture!==null&&(S.depthNear>0&&(Ve=S.depthNear),S.depthFar>0&&(Ye=S.depthFar)),F.near=O.near=I.near=Ve,F.far=O.far=I.far=Ye,(V!==F.near||H!==F.far)&&(r.updateRenderState({depthNear:F.near,depthFar:F.far}),V=F.near,H=F.far),I.layers.mask=be.layers.mask|2,O.layers.mask=be.layers.mask|4,F.layers.mask=I.layers.mask|O.layers.mask;const Xe=be.parent,Tt=F.cameras;fe(F,Xe);for(let yt=0;yt<Tt.length;yt++)fe(Tt[yt],Xe);Tt.length===2?J(F,I,O):F.projectionMatrix.copy(I.projectionMatrix),ge(be,F,Xe)};function ge(be,Ve,Ye){Ye===null?be.matrix.copy(Ve.matrixWorld):(be.matrix.copy(Ye.matrixWorld),be.matrix.invert(),be.matrix.multiply(Ve.matrixWorld)),be.matrix.decompose(be.position,be.quaternion,be.scale),be.updateMatrixWorld(!0),be.projectionMatrix.copy(Ve.projectionMatrix),be.projectionMatrixInverse.copy(Ve.projectionMatrixInverse),be.isPerspectiveCamera&&(be.fov=th*2*Math.atan(1/be.projectionMatrix.elements[5]),be.zoom=1)}this.getCamera=function(){return F},this.getFoveation=function(){if(!(g===null&&v===null))return l},this.setFoveation=function(be){l=be,g!==null&&(g.fixedFoveation=be),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=be)},this.hasDepthSensing=function(){return S.texture!==null},this.getDepthSensingMesh=function(){return S.getMesh(F)};let pe=null;function Ae(be,Ve){if(A=Ve.getViewerPose(u||o),x=Ve,A!==null){const Ye=A.views;v!==null&&(e.setRenderTargetFramebuffer(R,v.framebuffer),e.setRenderTarget(R));let Xe=!1;Ye.length!==F.cameras.length&&(F.cameras.length=0,Xe=!0);for(let ut=0;ut<Ye.length;ut++){const Ut=Ye[ut];let ue=null;if(v!==null)ue=v.getViewport(Ut);else{const G=p.getViewSubImage(g,Ut);ue=G.viewport,ut===0&&(e.setRenderTargetTextures(R,G.colorTexture,G.depthStencilTexture),e.setRenderTarget(R))}let ce=L[ut];ce===void 0&&(ce=new Br,ce.layers.enable(ut),ce.viewport=new $t,L[ut]=ce),ce.matrix.fromArray(Ut.transform.matrix),ce.matrix.decompose(ce.position,ce.quaternion,ce.scale),ce.projectionMatrix.fromArray(Ut.projectionMatrix),ce.projectionMatrixInverse.copy(ce.projectionMatrix).invert(),ce.viewport.set(ue.x,ue.y,ue.width,ue.height),ut===0&&(F.matrix.copy(ce.matrix),F.matrix.decompose(F.position,F.quaternion,F.scale)),Xe===!0&&F.cameras.push(ce)}const Tt=r.enabledFeatures;if(Tt&&Tt.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&p){const ut=p.getDepthInformation(Ye[0]);ut&&ut.isValid&&ut.texture&&S.init(e,ut,r.renderState)}}for(let Ye=0;Ye<E.length;Ye++){const Xe=N[Ye],Tt=E[Ye];Xe!==null&&Tt!==void 0&&Tt.update(Xe,Ve,u||o)}pe&&pe(be,Ve),Ve.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Ve}),x=null}const Fe=new wE;Fe.setAnimationLoop(Ae),this.setAnimationLoop=function(be){pe=be},this.dispose=function(){}}}const cc=new Qr,uX=new en;function cX(n,e){function t(T,w){T.matrixAutoUpdate===!0&&T.updateMatrix(),w.value.copy(T.matrix)}function i(T,w){w.color.getRGB(T.fogColor.value,J7(n)),w.isFog?(T.fogNear.value=w.near,T.fogFar.value=w.far):w.isFogExp2&&(T.fogDensity.value=w.density)}function r(T,w,R,E,N){w.isMeshBasicMaterial||w.isMeshLambertMaterial?s(T,w):w.isMeshToonMaterial?(s(T,w),p(T,w)):w.isMeshPhongMaterial?(s(T,w),A(T,w)):w.isMeshStandardMaterial?(s(T,w),g(T,w),w.isMeshPhysicalMaterial&&v(T,w,N)):w.isMeshMatcapMaterial?(s(T,w),x(T,w)):w.isMeshDepthMaterial?s(T,w):w.isMeshDistanceMaterial?(s(T,w),S(T,w)):w.isMeshNormalMaterial?s(T,w):w.isLineBasicMaterial?(o(T,w),w.isLineDashedMaterial&&a(T,w)):w.isPointsMaterial?l(T,w,R,E):w.isSpriteMaterial?u(T,w):w.isShadowMaterial?(T.color.value.copy(w.color),T.opacity.value=w.opacity):w.isShaderMaterial&&(w.uniformsNeedUpdate=!1)}function s(T,w){T.opacity.value=w.opacity,w.color&&T.diffuse.value.copy(w.color),w.emissive&&T.emissive.value.copy(w.emissive).multiplyScalar(w.emissiveIntensity),w.map&&(T.map.value=w.map,t(w.map,T.mapTransform)),w.alphaMap&&(T.alphaMap.value=w.alphaMap,t(w.alphaMap,T.alphaMapTransform)),w.bumpMap&&(T.bumpMap.value=w.bumpMap,t(w.bumpMap,T.bumpMapTransform),T.bumpScale.value=w.bumpScale,w.side===_i&&(T.bumpScale.value*=-1)),w.normalMap&&(T.normalMap.value=w.normalMap,t(w.normalMap,T.normalMapTransform),T.normalScale.value.copy(w.normalScale),w.side===_i&&T.normalScale.value.negate()),w.displacementMap&&(T.displacementMap.value=w.displacementMap,t(w.displacementMap,T.displacementMapTransform),T.displacementScale.value=w.displacementScale,T.displacementBias.value=w.displacementBias),w.emissiveMap&&(T.emissiveMap.value=w.emissiveMap,t(w.emissiveMap,T.emissiveMapTransform)),w.specularMap&&(T.specularMap.value=w.specularMap,t(w.specularMap,T.specularMapTransform)),w.alphaTest>0&&(T.alphaTest.value=w.alphaTest);const R=e.get(w),E=R.envMap,N=R.envMapRotation;E&&(T.envMap.value=E,cc.copy(N),cc.x*=-1,cc.y*=-1,cc.z*=-1,E.isCubeTexture&&E.isRenderTargetTexture===!1&&(cc.y*=-1,cc.z*=-1),T.envMapRotation.value.setFromMatrix4(uX.makeRotationFromEuler(cc)),T.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,T.reflectivity.value=w.reflectivity,T.ior.value=w.ior,T.refractionRatio.value=w.refractionRatio),w.lightMap&&(T.lightMap.value=w.lightMap,T.lightMapIntensity.value=w.lightMapIntensity,t(w.lightMap,T.lightMapTransform)),w.aoMap&&(T.aoMap.value=w.aoMap,T.aoMapIntensity.value=w.aoMapIntensity,t(w.aoMap,T.aoMapTransform))}function o(T,w){T.diffuse.value.copy(w.color),T.opacity.value=w.opacity,w.map&&(T.map.value=w.map,t(w.map,T.mapTransform))}function a(T,w){T.dashSize.value=w.dashSize,T.totalSize.value=w.dashSize+w.gapSize,T.scale.value=w.scale}function l(T,w,R,E){T.diffuse.value.copy(w.color),T.opacity.value=w.opacity,T.size.value=w.size*R,T.scale.value=E*.5,w.map&&(T.map.value=w.map,t(w.map,T.uvTransform)),w.alphaMap&&(T.alphaMap.value=w.alphaMap,t(w.alphaMap,T.alphaMapTransform)),w.alphaTest>0&&(T.alphaTest.value=w.alphaTest)}function u(T,w){T.diffuse.value.copy(w.color),T.opacity.value=w.opacity,T.rotation.value=w.rotation,w.map&&(T.map.value=w.map,t(w.map,T.mapTransform)),w.alphaMap&&(T.alphaMap.value=w.alphaMap,t(w.alphaMap,T.alphaMapTransform)),w.alphaTest>0&&(T.alphaTest.value=w.alphaTest)}function A(T,w){T.specular.value.copy(w.specular),T.shininess.value=Math.max(w.shininess,1e-4)}function p(T,w){w.gradientMap&&(T.gradientMap.value=w.gradientMap)}function g(T,w){T.metalness.value=w.metalness,w.metalnessMap&&(T.metalnessMap.value=w.metalnessMap,t(w.metalnessMap,T.metalnessMapTransform)),T.roughness.value=w.roughness,w.roughnessMap&&(T.roughnessMap.value=w.roughnessMap,t(w.roughnessMap,T.roughnessMapTransform)),w.envMap&&(T.envMapIntensity.value=w.envMapIntensity)}function v(T,w,R){T.ior.value=w.ior,w.sheen>0&&(T.sheenColor.value.copy(w.sheenColor).multiplyScalar(w.sheen),T.sheenRoughness.value=w.sheenRoughness,w.sheenColorMap&&(T.sheenColorMap.value=w.sheenColorMap,t(w.sheenColorMap,T.sheenColorMapTransform)),w.sheenRoughnessMap&&(T.sheenRoughnessMap.value=w.sheenRoughnessMap,t(w.sheenRoughnessMap,T.sheenRoughnessMapTransform))),w.clearcoat>0&&(T.clearcoat.value=w.clearcoat,T.clearcoatRoughness.value=w.clearcoatRoughness,w.clearcoatMap&&(T.clearcoatMap.value=w.clearcoatMap,t(w.clearcoatMap,T.clearcoatMapTransform)),w.clearcoatRoughnessMap&&(T.clearcoatRoughnessMap.value=w.clearcoatRoughnessMap,t(w.clearcoatRoughnessMap,T.clearcoatRoughnessMapTransform)),w.clearcoatNormalMap&&(T.clearcoatNormalMap.value=w.clearcoatNormalMap,t(w.clearcoatNormalMap,T.clearcoatNormalMapTransform),T.clearcoatNormalScale.value.copy(w.clearcoatNormalScale),w.side===_i&&T.clearcoatNormalScale.value.negate())),w.dispersion>0&&(T.dispersion.value=w.dispersion),w.iridescence>0&&(T.iridescence.value=w.iridescence,T.iridescenceIOR.value=w.iridescenceIOR,T.iridescenceThicknessMinimum.value=w.iridescenceThicknessRange[0],T.iridescenceThicknessMaximum.value=w.iridescenceThicknessRange[1],w.iridescenceMap&&(T.iridescenceMap.value=w.iridescenceMap,t(w.iridescenceMap,T.iridescenceMapTransform)),w.iridescenceThicknessMap&&(T.iridescenceThicknessMap.value=w.iridescenceThicknessMap,t(w.iridescenceThicknessMap,T.iridescenceThicknessMapTransform))),w.transmission>0&&(T.transmission.value=w.transmission,T.transmissionSamplerMap.value=R.texture,T.transmissionSamplerSize.value.set(R.width,R.height),w.transmissionMap&&(T.transmissionMap.value=w.transmissionMap,t(w.transmissionMap,T.transmissionMapTransform)),T.thickness.value=w.thickness,w.thicknessMap&&(T.thicknessMap.value=w.thicknessMap,t(w.thicknessMap,T.thicknessMapTransform)),T.attenuationDistance.value=w.attenuationDistance,T.attenuationColor.value.copy(w.attenuationColor)),w.anisotropy>0&&(T.anisotropyVector.value.set(w.anisotropy*Math.cos(w.anisotropyRotation),w.anisotropy*Math.sin(w.anisotropyRotation)),w.anisotropyMap&&(T.anisotropyMap.value=w.anisotropyMap,t(w.anisotropyMap,T.anisotropyMapTransform))),T.specularIntensity.value=w.specularIntensity,T.specularColor.value.copy(w.specularColor),w.specularColorMap&&(T.specularColorMap.value=w.specularColorMap,t(w.specularColorMap,T.specularColorMapTransform)),w.specularIntensityMap&&(T.specularIntensityMap.value=w.specularIntensityMap,t(w.specularIntensityMap,T.specularIntensityMapTransform))}function x(T,w){w.matcap&&(T.matcap.value=w.matcap)}function S(T,w){const R=e.get(w).light;T.referencePosition.value.setFromMatrixPosition(R.matrixWorld),T.nearDistance.value=R.shadow.camera.near,T.farDistance.value=R.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function hX(n,e,t,i){let r={},s={},o=[];const a=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function l(R,E){const N=E.program;i.uniformBlockBinding(R,N)}function u(R,E){let N=r[R.id];N===void 0&&(x(R),N=A(R),r[R.id]=N,R.addEventListener("dispose",T));const D=E.program;i.updateUBOMapping(R,D);const B=e.render.frame;s[R.id]!==B&&(g(R),s[R.id]=B)}function A(R){const E=p();R.__bindingPointIndex=E;const N=n.createBuffer(),D=R.__size,B=R.usage;return n.bindBuffer(n.UNIFORM_BUFFER,N),n.bufferData(n.UNIFORM_BUFFER,D,B),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,E,N),N}function p(){for(let R=0;R<a;R++)if(o.indexOf(R)===-1)return o.push(R),R;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function g(R){const E=r[R.id],N=R.uniforms,D=R.__cache;n.bindBuffer(n.UNIFORM_BUFFER,E);for(let B=0,I=N.length;B<I;B++){const O=Array.isArray(N[B])?N[B]:[N[B]];for(let L=0,F=O.length;L<F;L++){const V=O[L];if(v(V,B,L,D)===!0){const H=V.__offset,Q=Array.isArray(V.value)?V.value:[V.value];let te=0;for(let K=0;K<Q.length;K++){const W=Q[K],Z=S(W);typeof W=="number"||typeof W=="boolean"?(V.__data[0]=W,n.bufferSubData(n.UNIFORM_BUFFER,H+te,V.__data)):W.isMatrix3?(V.__data[0]=W.elements[0],V.__data[1]=W.elements[1],V.__data[2]=W.elements[2],V.__data[3]=0,V.__data[4]=W.elements[3],V.__data[5]=W.elements[4],V.__data[6]=W.elements[5],V.__data[7]=0,V.__data[8]=W.elements[6],V.__data[9]=W.elements[7],V.__data[10]=W.elements[8],V.__data[11]=0):(W.toArray(V.__data,te),te+=Z.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,H,V.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function v(R,E,N,D){const B=R.value,I=E+"_"+N;if(D[I]===void 0)return typeof B=="number"||typeof B=="boolean"?D[I]=B:D[I]=B.clone(),!0;{const O=D[I];if(typeof B=="number"||typeof B=="boolean"){if(O!==B)return D[I]=B,!0}else if(O.equals(B)===!1)return O.copy(B),!0}return!1}function x(R){const E=R.uniforms;let N=0;const D=16;for(let I=0,O=E.length;I<O;I++){const L=Array.isArray(E[I])?E[I]:[E[I]];for(let F=0,V=L.length;F<V;F++){const H=L[F],Q=Array.isArray(H.value)?H.value:[H.value];for(let te=0,K=Q.length;te<K;te++){const W=Q[te],Z=S(W),J=N%D,fe=J%Z.boundary,ge=J+fe;N+=fe,ge!==0&&D-ge<Z.storage&&(N+=D-ge),H.__data=new Float32Array(Z.storage/Float32Array.BYTES_PER_ELEMENT),H.__offset=N,N+=Z.storage}}}const B=N%D;return B>0&&(N+=D-B),R.__size=N,R.__cache={},this}function S(R){const E={boundary:0,storage:0};return typeof R=="number"||typeof R=="boolean"?(E.boundary=4,E.storage=4):R.isVector2?(E.boundary=8,E.storage=8):R.isVector3||R.isColor?(E.boundary=16,E.storage=12):R.isVector4?(E.boundary=16,E.storage=16):R.isMatrix3?(E.boundary=48,E.storage=48):R.isMatrix4?(E.boundary=64,E.storage=64):R.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",R),E}function T(R){const E=R.target;E.removeEventListener("dispose",T);const N=o.indexOf(E.__bindingPointIndex);o.splice(N,1),n.deleteBuffer(r[E.id]),delete r[E.id],delete s[E.id]}function w(){for(const R in r)n.deleteBuffer(r[R]);o=[],r={},s={}}return{bind:l,update:u,dispose:w}}class fX{constructor(e={}){const{canvas:t=Y7(),context:i=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:A="default",failIfMajorPerformanceCaveat:p=!1,reverseDepthBuffer:g=!1}=e;this.isWebGLRenderer=!0;let v;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");v=i.getContextAttributes().alpha}else v=o;const x=new Uint32Array(4),S=new Int32Array(4);let T=null,w=null;const R=[],E=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Qs,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const N=this;let D=!1;this._outputColorSpace=Ht;let B=0,I=0,O=null,L=-1,F=null;const V=new $t,H=new $t;let Q=null;const te=new Ft(0);let K=0,W=t.width,Z=t.height,J=1,fe=null,ge=null;const pe=new $t(0,0,W,Z),Ae=new $t(0,0,W,Z);let Fe=!1;const be=new wA;let Ve=!1,Ye=!1;const Xe=new en,Tt=new en,yt=new ie,ut=new $t,Ut={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ue=!1;function ce(){return O===null?J:1}let G=i;function Ee(ee,Ce){return t.getContext(ee,Ce)}try{const ee={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:A,failIfMajorPerformanceCaveat:p};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${ep}`),t.addEventListener("webglcontextlost",it,!1),t.addEventListener("webglcontextrestored",Pt,!1),t.addEventListener("webglcontextcreationerror",Ct,!1),G===null){const Ce="webgl2";if(G=Ee(Ce,ee),G===null)throw Ee(Ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ee){throw console.error("THREE.WebGLRenderer: "+ee.message),ee}let ye,we,Se,ze,Ne,j,q,he,Me,Ue,Be,At,tt,Nt,It,st,bt,Gt,Zt,wt,tn,Ot,fn,ne;function Rt(){ye=new bW(G),ye.init(),Ot=new rX(G,ye),we=new pW(G,ye,e,Ot),Se=new nX(G,ye),we.reverseDepthBuffer&&g&&Se.buffers.depth.setReversed(!0),ze=new TW(G),Ne=new zj,j=new iX(G,ye,Se,Ne,we,Ot,ze),q=new gW(N),he=new xW(N),Me=new Pz(G),fn=new AW(G,Me),Ue=new wW(G,Me,ze,fn),Be=new EW(G,Ue,Me,ze),Zt=new MW(G,we,j),st=new mW(Ne),At=new qj(N,q,he,ye,we,fn,st),tt=new cX(N,Ne),Nt=new $j,It=new Zj(ye),Gt=new fW(N,q,he,Se,Be,v,l),bt=new eX(N,Be,we),ne=new hX(G,ze,we,Se),wt=new dW(G,ye,ze),tn=new SW(G,ye,ze),ze.programs=At.programs,N.capabilities=we,N.extensions=ye,N.properties=Ne,N.renderLists=Nt,N.shadowMap=bt,N.state=Se,N.info=ze}Rt();const We=new lX(N,G);this.xr=We,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){const ee=ye.get("WEBGL_lose_context");ee&&ee.loseContext()},this.forceContextRestore=function(){const ee=ye.get("WEBGL_lose_context");ee&&ee.restoreContext()},this.getPixelRatio=function(){return J},this.setPixelRatio=function(ee){ee!==void 0&&(J=ee,this.setSize(W,Z,!1))},this.getSize=function(ee){return ee.set(W,Z)},this.setSize=function(ee,Ce,qe=!0){if(We.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}W=ee,Z=Ce,t.width=Math.floor(ee*J),t.height=Math.floor(Ce*J),qe===!0&&(t.style.width=ee+"px",t.style.height=Ce+"px"),this.setViewport(0,0,ee,Ce)},this.getDrawingBufferSize=function(ee){return ee.set(W*J,Z*J).floor()},this.setDrawingBufferSize=function(ee,Ce,qe){W=ee,Z=Ce,J=qe,t.width=Math.floor(ee*qe),t.height=Math.floor(Ce*qe),this.setViewport(0,0,ee,Ce)},this.getCurrentViewport=function(ee){return ee.copy(V)},this.getViewport=function(ee){return ee.copy(pe)},this.setViewport=function(ee,Ce,qe,ke){ee.isVector4?pe.set(ee.x,ee.y,ee.z,ee.w):pe.set(ee,Ce,qe,ke),Se.viewport(V.copy(pe).multiplyScalar(J).round())},this.getScissor=function(ee){return ee.copy(Ae)},this.setScissor=function(ee,Ce,qe,ke){ee.isVector4?Ae.set(ee.x,ee.y,ee.z,ee.w):Ae.set(ee,Ce,qe,ke),Se.scissor(H.copy(Ae).multiplyScalar(J).round())},this.getScissorTest=function(){return Fe},this.setScissorTest=function(ee){Se.setScissorTest(Fe=ee)},this.setOpaqueSort=function(ee){fe=ee},this.setTransparentSort=function(ee){ge=ee},this.getClearColor=function(ee){return ee.copy(Gt.getClearColor())},this.setClearColor=function(){Gt.setClearColor(...arguments)},this.getClearAlpha=function(){return Gt.getClearAlpha()},this.setClearAlpha=function(){Gt.setClearAlpha(...arguments)},this.clear=function(ee=!0,Ce=!0,qe=!0){let ke=0;if(ee){let De=!1;if(O!==null){const mt=O.texture.format;De=mt===xA||mt===yA||mt===vA}if(De){const mt=O.texture.type,St=mt===ji||mt===bi||mt===sa||mt===yo||mt===Yg||mt===Zg,et=Gt.getClearColor(),X=Gt.getClearAlpha(),ft=et.r,sn=et.g,Yt=et.b;St?(x[0]=ft,x[1]=sn,x[2]=Yt,x[3]=X,G.clearBufferuiv(G.COLOR,0,x)):(S[0]=ft,S[1]=sn,S[2]=Yt,S[3]=X,G.clearBufferiv(G.COLOR,0,S))}else ke|=G.COLOR_BUFFER_BIT}Ce&&(ke|=G.DEPTH_BUFFER_BIT),qe&&(ke|=G.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),G.clear(ke)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",it,!1),t.removeEventListener("webglcontextrestored",Pt,!1),t.removeEventListener("webglcontextcreationerror",Ct,!1),Gt.dispose(),Nt.dispose(),It.dispose(),Ne.dispose(),q.dispose(),he.dispose(),Be.dispose(),fn.dispose(),ne.dispose(),At.dispose(),We.dispose(),We.removeEventListener("sessionstart",Ge),We.removeEventListener("sessionend",Ze),xt.stop()};function it(ee){ee.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function Pt(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1;const ee=ze.autoReset,Ce=bt.enabled,qe=bt.autoUpdate,ke=bt.needsUpdate,De=bt.type;Rt(),ze.autoReset=ee,bt.enabled=Ce,bt.autoUpdate=qe,bt.needsUpdate=ke,bt.type=De}function Ct(ee){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ee.statusMessage)}function wn(ee){const Ce=ee.target;Ce.removeEventListener("dispose",wn),Ri(Ce)}function Ri(ee){xr(ee),Ne.remove(ee)}function xr(ee){const Ce=Ne.get(ee).programs;Ce!==void 0&&(Ce.forEach(function(qe){At.releaseProgram(qe)}),ee.isShaderMaterial&&At.releaseShaderCache(ee))}this.renderBufferDirect=function(ee,Ce,qe,ke,De,mt){Ce===null&&(Ce=Ut);const St=De.isMesh&&De.matrixWorld.determinant()<0,et=wa(ee,Ce,qe,ke,De);Se.setMaterial(ke,St);let X=qe.index,ft=1;if(ke.wireframe===!0){if(X=Ue.getWireframeAttribute(qe),X===void 0)return;ft=2}const sn=qe.drawRange,Yt=qe.attributes.position;let qn=sn.start*ft,Qn=(sn.start+sn.count)*ft;mt!==null&&(qn=Math.max(qn,mt.start*ft),Qn=Math.min(Qn,(mt.start+mt.count)*ft)),X!==null?(qn=Math.max(qn,0),Qn=Math.min(Qn,X.count)):Yt!=null&&(qn=Math.max(qn,0),Qn=Math.min(Qn,Yt.count));const Xi=Qn-qn;if(Xi<0||Xi===1/0)return;fn.setup(De,ke,et,qe,X);let z,Wn=wt;if(X!==null&&(z=Me.get(X),Wn=tn,Wn.setIndex(z)),De.isMesh)ke.wireframe===!0?(Se.setLineWidth(ke.wireframeLinewidth*ce()),Wn.setMode(G.LINES)):Wn.setMode(G.TRIANGLES);else if(De.isLine){let Kt=ke.linewidth;Kt===void 0&&(Kt=1),Se.setLineWidth(Kt*ce()),De.isLineSegments?Wn.setMode(G.LINES):De.isLineLoop?Wn.setMode(G.LINE_LOOP):Wn.setMode(G.LINE_STRIP)}else De.isPoints?Wn.setMode(G.POINTS):De.isSprite&&Wn.setMode(G.TRIANGLES);if(De.isBatchedMesh)if(De._multiDrawInstances!==null)fa("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Wn.renderMultiDrawInstances(De._multiDrawStarts,De._multiDrawCounts,De._multiDrawCount,De._multiDrawInstances);else if(ye.get("WEBGL_multi_draw"))Wn.renderMultiDraw(De._multiDrawStarts,De._multiDrawCounts,De._multiDrawCount);else{const Kt=De._multiDrawStarts,br=De._multiDrawCounts,Yn=De._multiDrawCount,no=X?Me.get(X).bytesPerElement:1,Kl=Ne.get(ke).currentProgram.getUniforms();for(let es=0;es<Yn;es++)Kl.setValue(G,"_gl_DrawID",es),Wn.render(Kt[es]/no,br[es])}else if(De.isInstancedMesh)Wn.renderInstances(qn,Xi,De.count);else if(qe.isInstancedBufferGeometry){const Kt=qe._maxInstanceCount!==void 0?qe._maxInstanceCount:1/0,br=Math.min(qe.instanceCount,Kt);Wn.renderInstances(qn,Xi,br)}else Wn.render(qn,Xi)};function Hn(ee,Ce,qe){ee.transparent===!0&&ee.side===_r&&ee.forceSinglePass===!1?(ee.side=_i,ee.needsUpdate=!0,zi(ee,Ce,qe),ee.side=Xs,ee.needsUpdate=!0,zi(ee,Ce,qe),ee.side=_r):zi(ee,Ce,qe)}this.compile=function(ee,Ce,qe=null){qe===null&&(qe=ee),w=It.get(qe),w.init(Ce),E.push(w),qe.traverseVisible(function(De){De.isLight&&De.layers.test(Ce.layers)&&(w.pushLight(De),De.castShadow&&w.pushShadow(De))}),ee!==qe&&ee.traverseVisible(function(De){De.isLight&&De.layers.test(Ce.layers)&&(w.pushLight(De),De.castShadow&&w.pushShadow(De))}),w.setupLights();const ke=new Set;return ee.traverse(function(De){if(!(De.isMesh||De.isPoints||De.isLine||De.isSprite))return;const mt=De.material;if(mt)if(Array.isArray(mt))for(let St=0;St<mt.length;St++){const et=mt[St];Hn(et,qe,De),ke.add(et)}else Hn(mt,qe,De),ke.add(mt)}),w=E.pop(),ke},this.compileAsync=function(ee,Ce,qe=null){const ke=this.compile(ee,Ce,qe);return new Promise(De=>{function mt(){if(ke.forEach(function(St){Ne.get(St).currentProgram.isReady()&&ke.delete(St)}),ke.size===0){De(ee);return}setTimeout(mt,10)}ye.get("KHR_parallel_shader_compile")!==null?mt():setTimeout(mt,10)})};let gs=null;function Jr(ee){gs&&gs(ee)}function Ge(){xt.stop()}function Ze(){xt.start()}const xt=new wE;xt.setAnimationLoop(Jr),typeof self<"u"&&xt.setContext(self),this.setAnimationLoop=function(ee){gs=ee,We.setAnimationLoop(ee),ee===null?xt.stop():xt.start()},We.addEventListener("sessionstart",Ge),We.addEventListener("sessionend",Ze),this.render=function(ee,Ce){if(Ce!==void 0&&Ce.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(D===!0)return;if(ee.matrixWorldAutoUpdate===!0&&ee.updateMatrixWorld(),Ce.parent===null&&Ce.matrixWorldAutoUpdate===!0&&Ce.updateMatrixWorld(),We.enabled===!0&&We.isPresenting===!0&&(We.cameraAutoUpdate===!0&&We.updateCamera(Ce),Ce=We.getCamera()),ee.isScene===!0&&ee.onBeforeRender(N,ee,Ce,O),w=It.get(ee,E.length),w.init(Ce),E.push(w),Tt.multiplyMatrices(Ce.projectionMatrix,Ce.matrixWorldInverse),be.setFromProjectionMatrix(Tt),Ye=this.localClippingEnabled,Ve=st.init(this.clippingPlanes,Ye),T=Nt.get(ee,R.length),T.init(),R.push(T),We.enabled===!0&&We.isPresenting===!0){const mt=N.xr.getDepthSensingMesh();mt!==null&&nt(mt,Ce,-1/0,N.sortObjects)}nt(ee,Ce,0,N.sortObjects),T.finish(),N.sortObjects===!0&&T.sort(fe,ge),ue=We.enabled===!1||We.isPresenting===!1||We.hasDepthSensing()===!1,ue&&Gt.addToRenderList(T,ee),this.info.render.frame++,Ve===!0&&st.beginShadows();const qe=w.state.shadowsArray;bt.render(qe,ee,Ce),Ve===!0&&st.endShadows(),this.info.autoReset===!0&&this.info.reset();const ke=T.opaque,De=T.transmissive;if(w.setupLights(),Ce.isArrayCamera){const mt=Ce.cameras;if(De.length>0)for(let St=0,et=mt.length;St<et;St++){const X=mt[St];$(ke,De,ee,X)}ue&&Gt.render(ee);for(let St=0,et=mt.length;St<et;St++){const X=mt[St];h(T,ee,X,X.viewport)}}else De.length>0&&$(ke,De,ee,Ce),ue&&Gt.render(ee),h(T,ee,Ce);O!==null&&I===0&&(j.updateMultisampleRenderTarget(O),j.updateRenderTargetMipmap(O)),ee.isScene===!0&&ee.onAfterRender(N,ee,Ce),fn.resetDefaultState(),L=-1,F=null,E.pop(),E.length>0?(w=E[E.length-1],Ve===!0&&st.setGlobalState(N.clippingPlanes,w.state.camera)):w=null,R.pop(),R.length>0?T=R[R.length-1]:T=null};function nt(ee,Ce,qe,ke){if(ee.visible===!1)return;if(ee.layers.test(Ce.layers)){if(ee.isGroup)qe=ee.renderOrder;else if(ee.isLOD)ee.autoUpdate===!0&&ee.update(Ce);else if(ee.isLight)w.pushLight(ee),ee.castShadow&&w.pushShadow(ee);else if(ee.isSprite){if(!ee.frustumCulled||be.intersectsSprite(ee)){ke&&ut.setFromMatrixPosition(ee.matrixWorld).applyMatrix4(Tt);const St=Be.update(ee),et=ee.material;et.visible&&T.push(ee,St,et,qe,ut.z,null)}}else if((ee.isMesh||ee.isLine||ee.isPoints)&&(!ee.frustumCulled||be.intersectsObject(ee))){const St=Be.update(ee),et=ee.material;if(ke&&(ee.boundingSphere!==void 0?(ee.boundingSphere===null&&ee.computeBoundingSphere(),ut.copy(ee.boundingSphere.center)):(St.boundingSphere===null&&St.computeBoundingSphere(),ut.copy(St.boundingSphere.center)),ut.applyMatrix4(ee.matrixWorld).applyMatrix4(Tt)),Array.isArray(et)){const X=St.groups;for(let ft=0,sn=X.length;ft<sn;ft++){const Yt=X[ft],qn=et[Yt.materialIndex];qn&&qn.visible&&T.push(ee,St,qn,qe,ut.z,Yt)}}else et.visible&&T.push(ee,St,et,qe,ut.z,null)}}const mt=ee.children;for(let St=0,et=mt.length;St<et;St++)nt(mt[St],Ce,qe,ke)}function h(ee,Ce,qe,ke){const De=ee.opaque,mt=ee.transmissive,St=ee.transparent;w.setupLightsView(qe),Ve===!0&&st.setGlobalState(N.clippingPlanes,qe),ke&&Se.viewport(V.copy(ke)),De.length>0&&Dn(De,Ce,qe),mt.length>0&&Dn(mt,Ce,qe),St.length>0&&Dn(St,Ce,qe),Se.buffers.depth.setTest(!0),Se.buffers.depth.setMask(!0),Se.buffers.color.setMask(!0),Se.setPolygonOffset(!1)}function $(ee,Ce,qe,ke){if((qe.isScene===!0?qe.overrideMaterial:null)!==null)return;w.state.transmissionRenderTarget[ke.id]===void 0&&(w.state.transmissionRenderTarget[ke.id]=new nh(1,1,{generateMipmaps:!0,type:ye.has("EXT_color_buffer_half_float")||ye.has("EXT_color_buffer_float")?Mr:ji,minFilter:zs,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Rn.workingColorSpace}));const mt=w.state.transmissionRenderTarget[ke.id],St=ke.viewport||V;mt.setSize(St.z*N.transmissionResolutionScale,St.w*N.transmissionResolutionScale);const et=N.getRenderTarget();N.setRenderTarget(mt),N.getClearColor(te),K=N.getClearAlpha(),K<1&&N.setClearColor(16777215,.5),N.clear(),ue&&Gt.render(qe);const X=N.toneMapping;N.toneMapping=Qs;const ft=ke.viewport;if(ke.viewport!==void 0&&(ke.viewport=void 0),w.setupLightsView(ke),Ve===!0&&st.setGlobalState(N.clippingPlanes,ke),Dn(ee,qe,ke),j.updateMultisampleRenderTarget(mt),j.updateRenderTargetMipmap(mt),ye.has("WEBGL_multisampled_render_to_texture")===!1){let sn=!1;for(let Yt=0,qn=Ce.length;Yt<qn;Yt++){const Qn=Ce[Yt],Xi=Qn.object,z=Qn.geometry,Wn=Qn.material,Kt=Qn.group;if(Wn.side===_r&&Xi.layers.test(ke.layers)){const br=Wn.side;Wn.side=_i,Wn.needsUpdate=!0,jn(Xi,qe,ke,z,Wn,Kt),Wn.side=br,Wn.needsUpdate=!0,sn=!0}}sn===!0&&(j.updateMultisampleRenderTarget(mt),j.updateRenderTargetMipmap(mt))}N.setRenderTarget(et),N.setClearColor(te,K),ft!==void 0&&(ke.viewport=ft),N.toneMapping=X}function Dn(ee,Ce,qe){const ke=Ce.isScene===!0?Ce.overrideMaterial:null;for(let De=0,mt=ee.length;De<mt;De++){const St=ee[De],et=St.object,X=St.geometry,ft=St.group;let sn=St.material;sn.allowOverride===!0&&ke!==null&&(sn=ke),et.layers.test(qe.layers)&&jn(et,Ce,qe,X,sn,ft)}}function jn(ee,Ce,qe,ke,De,mt){ee.onBeforeRender(N,Ce,qe,ke,De,mt),ee.modelViewMatrix.multiplyMatrices(qe.matrixWorldInverse,ee.matrixWorld),ee.normalMatrix.getNormalMatrix(ee.modelViewMatrix),De.onBeforeRender(N,Ce,qe,ke,ee,mt),De.transparent===!0&&De.side===_r&&De.forceSinglePass===!1?(De.side=_i,De.needsUpdate=!0,N.renderBufferDirect(qe,Ce,ke,De,ee,mt),De.side=Xs,De.needsUpdate=!0,N.renderBufferDirect(qe,Ce,ke,De,ee,mt),De.side=_r):N.renderBufferDirect(qe,Ce,ke,De,ee,mt),ee.onAfterRender(N,Ce,qe,ke,De,mt)}function zi(ee,Ce,qe){Ce.isScene!==!0&&(Ce=Ut);const ke=Ne.get(ee),De=w.state.lights,mt=w.state.shadowsArray,St=De.state.version,et=At.getParameters(ee,De.state,mt,Ce,qe),X=At.getProgramCacheKey(et);let ft=ke.programs;ke.environment=ee.isMeshStandardMaterial?Ce.environment:null,ke.fog=Ce.fog,ke.envMap=(ee.isMeshStandardMaterial?he:q).get(ee.envMap||ke.environment),ke.envMapRotation=ke.environment!==null&&ee.envMap===null?Ce.environmentRotation:ee.envMapRotation,ft===void 0&&(ee.addEventListener("dispose",wn),ft=new Map,ke.programs=ft);let sn=ft.get(X);if(sn!==void 0){if(ke.currentProgram===sn&&ke.lightsStateVersion===St)return Un(ee,et),sn}else et.uniforms=At.getUniforms(ee),ee.onBeforeCompile(et,N),sn=At.acquireProgram(et,X),ft.set(X,sn),ke.uniforms=et.uniforms;const Yt=ke.uniforms;return(!ee.isShaderMaterial&&!ee.isRawShaderMaterial||ee.clipping===!0)&&(Yt.clippingPlanes=st.uniform),Un(ee,et),ke.needsLights=Sn(ee),ke.lightsStateVersion=St,ke.needsLights&&(Yt.ambientLightColor.value=De.state.ambient,Yt.lightProbe.value=De.state.probe,Yt.directionalLights.value=De.state.directional,Yt.directionalLightShadows.value=De.state.directionalShadow,Yt.spotLights.value=De.state.spot,Yt.spotLightShadows.value=De.state.spotShadow,Yt.rectAreaLights.value=De.state.rectArea,Yt.ltc_1.value=De.state.rectAreaLTC1,Yt.ltc_2.value=De.state.rectAreaLTC2,Yt.pointLights.value=De.state.point,Yt.pointLightShadows.value=De.state.pointShadow,Yt.hemisphereLights.value=De.state.hemi,Yt.directionalShadowMap.value=De.state.directionalShadowMap,Yt.directionalShadowMatrix.value=De.state.directionalShadowMatrix,Yt.spotShadowMap.value=De.state.spotShadowMap,Yt.spotLightMatrix.value=De.state.spotLightMatrix,Yt.spotLightMap.value=De.state.spotLightMap,Yt.pointShadowMap.value=De.state.pointShadowMap,Yt.pointShadowMatrix.value=De.state.pointShadowMatrix),ke.currentProgram=sn,ke.uniformsList=null,sn}function _n(ee){if(ee.uniformsList===null){const Ce=ee.currentProgram.getUniforms();ee.uniformsList=A1.seqWithValue(Ce.seq,ee.uniforms)}return ee.uniformsList}function Un(ee,Ce){const qe=Ne.get(ee);qe.outputColorSpace=Ce.outputColorSpace,qe.batching=Ce.batching,qe.batchingColor=Ce.batchingColor,qe.instancing=Ce.instancing,qe.instancingColor=Ce.instancingColor,qe.instancingMorph=Ce.instancingMorph,qe.skinning=Ce.skinning,qe.morphTargets=Ce.morphTargets,qe.morphNormals=Ce.morphNormals,qe.morphColors=Ce.morphColors,qe.morphTargetsCount=Ce.morphTargetsCount,qe.numClippingPlanes=Ce.numClippingPlanes,qe.numIntersection=Ce.numClipIntersection,qe.vertexAlphas=Ce.vertexAlphas,qe.vertexTangents=Ce.vertexTangents,qe.toneMapping=Ce.toneMapping}function wa(ee,Ce,qe,ke,De){Ce.isScene!==!0&&(Ce=Ut),j.resetTextureUnits();const mt=Ce.fog,St=ke.isMeshStandardMaterial?Ce.environment:null,et=O===null?N.outputColorSpace:O.isXRRenderTarget===!0?O.texture.colorSpace:ha,X=(ke.isMeshStandardMaterial?he:q).get(ke.envMap||St),ft=ke.vertexColors===!0&&!!qe.attributes.color&&qe.attributes.color.itemSize===4,sn=!!qe.attributes.tangent&&(!!ke.normalMap||ke.anisotropy>0),Yt=!!qe.morphAttributes.position,qn=!!qe.morphAttributes.normal,Qn=!!qe.morphAttributes.color;let Xi=Qs;ke.toneMapped&&(O===null||O.isXRRenderTarget===!0)&&(Xi=N.toneMapping);const z=qe.morphAttributes.position||qe.morphAttributes.normal||qe.morphAttributes.color,Wn=z!==void 0?z.length:0,Kt=Ne.get(ke),br=w.state.lights;if(Ve===!0&&(Ye===!0||ee!==F)){const wr=ee===F&&ke.id===L;st.setState(ke,ee,wr)}let Yn=!1;ke.version===Kt.__version?(Kt.needsLights&&Kt.lightsStateVersion!==br.state.version||Kt.outputColorSpace!==et||De.isBatchedMesh&&Kt.batching===!1||!De.isBatchedMesh&&Kt.batching===!0||De.isBatchedMesh&&Kt.batchingColor===!0&&De.colorTexture===null||De.isBatchedMesh&&Kt.batchingColor===!1&&De.colorTexture!==null||De.isInstancedMesh&&Kt.instancing===!1||!De.isInstancedMesh&&Kt.instancing===!0||De.isSkinnedMesh&&Kt.skinning===!1||!De.isSkinnedMesh&&Kt.skinning===!0||De.isInstancedMesh&&Kt.instancingColor===!0&&De.instanceColor===null||De.isInstancedMesh&&Kt.instancingColor===!1&&De.instanceColor!==null||De.isInstancedMesh&&Kt.instancingMorph===!0&&De.morphTexture===null||De.isInstancedMesh&&Kt.instancingMorph===!1&&De.morphTexture!==null||Kt.envMap!==X||ke.fog===!0&&Kt.fog!==mt||Kt.numClippingPlanes!==void 0&&(Kt.numClippingPlanes!==st.numPlanes||Kt.numIntersection!==st.numIntersection)||Kt.vertexAlphas!==ft||Kt.vertexTangents!==sn||Kt.morphTargets!==Yt||Kt.morphNormals!==qn||Kt.morphColors!==Qn||Kt.toneMapping!==Xi||Kt.morphTargetsCount!==Wn)&&(Yn=!0):(Yn=!0,Kt.__version=ke.version);let no=Kt.currentProgram;Yn===!0&&(no=zi(ke,Ce,De));let Kl=!1,es=!1,Jl=!1;const vi=no.getUniforms(),Qi=Kt.uniforms;if(Se.useProgram(no.program)&&(Kl=!0,es=!0,Jl=!0),ke.id!==L&&(L=ke.id,es=!0),Kl||F!==ee){Se.buffers.depth.getReversed()?(Xe.copy(ee.projectionMatrix),eq(Xe),tq(Xe),vi.setValue(G,"projectionMatrix",Xe)):vi.setValue(G,"projectionMatrix",ee.projectionMatrix),vi.setValue(G,"viewMatrix",ee.matrixWorldInverse);const ts=vi.map.cameraPosition;ts!==void 0&&ts.setValue(G,yt.setFromMatrixPosition(ee.matrixWorld)),we.logarithmicDepthBuffer&&vi.setValue(G,"logDepthBufFC",2/(Math.log(ee.far+1)/Math.LN2)),(ke.isMeshPhongMaterial||ke.isMeshToonMaterial||ke.isMeshLambertMaterial||ke.isMeshBasicMaterial||ke.isMeshStandardMaterial||ke.isShaderMaterial)&&vi.setValue(G,"isOrthographic",ee.isOrthographicCamera===!0),F!==ee&&(F=ee,es=!0,Jl=!0)}if(De.isSkinnedMesh){vi.setOptional(G,De,"bindMatrix"),vi.setOptional(G,De,"bindMatrixInverse");const wr=De.skeleton;wr&&(wr.boneTexture===null&&wr.computeBoneTexture(),vi.setValue(G,"boneTexture",wr.boneTexture,j))}De.isBatchedMesh&&(vi.setOptional(G,De,"batchingTexture"),vi.setValue(G,"batchingTexture",De._matricesTexture,j),vi.setOptional(G,De,"batchingIdTexture"),vi.setValue(G,"batchingIdTexture",De._indirectTexture,j),vi.setOptional(G,De,"batchingColorTexture"),De._colorsTexture!==null&&vi.setValue(G,"batchingColorTexture",De._colorsTexture,j));const ti=qe.morphAttributes;if((ti.position!==void 0||ti.normal!==void 0||ti.color!==void 0)&&Zt.update(De,qe,no),(es||Kt.receiveShadow!==De.receiveShadow)&&(Kt.receiveShadow=De.receiveShadow,vi.setValue(G,"receiveShadow",De.receiveShadow)),ke.isMeshGouraudMaterial&&ke.envMap!==null&&(Qi.envMap.value=X,Qi.flipEnvMap.value=X.isCubeTexture&&X.isRenderTargetTexture===!1?-1:1),ke.isMeshStandardMaterial&&ke.envMap===null&&Ce.environment!==null&&(Qi.envMapIntensity.value=Ce.environmentIntensity),es&&(vi.setValue(G,"toneMappingExposure",N.toneMappingExposure),Kt.needsLights&&$n(Qi,Jl),mt&&ke.fog===!0&&tt.refreshFogUniforms(Qi,mt),tt.refreshMaterialUniforms(Qi,ke,J,Z,w.state.transmissionRenderTarget[ee.id]),A1.upload(G,_n(Kt),Qi,j)),ke.isShaderMaterial&&ke.uniformsNeedUpdate===!0&&(A1.upload(G,_n(Kt),Qi,j),ke.uniformsNeedUpdate=!1),ke.isSpriteMaterial&&vi.setValue(G,"center",De.center),vi.setValue(G,"modelViewMatrix",De.modelViewMatrix),vi.setValue(G,"normalMatrix",De.normalMatrix),vi.setValue(G,"modelMatrix",De.matrixWorld),ke.isShaderMaterial||ke.isRawShaderMaterial){const wr=ke.uniformsGroups;for(let ts=0,NA=wr.length;ts<NA;ts++){const Sa=wr[ts];ne.update(Sa,no),ne.bind(Sa,no)}}return no}function $n(ee,Ce){ee.ambientLightColor.needsUpdate=Ce,ee.lightProbe.needsUpdate=Ce,ee.directionalLights.needsUpdate=Ce,ee.directionalLightShadows.needsUpdate=Ce,ee.pointLights.needsUpdate=Ce,ee.pointLightShadows.needsUpdate=Ce,ee.spotLights.needsUpdate=Ce,ee.spotLightShadows.needsUpdate=Ce,ee.rectAreaLights.needsUpdate=Ce,ee.hemisphereLights.needsUpdate=Ce}function Sn(ee){return ee.isMeshLambertMaterial||ee.isMeshToonMaterial||ee.isMeshPhongMaterial||ee.isMeshStandardMaterial||ee.isShadowMaterial||ee.isShaderMaterial&&ee.lights===!0}this.getActiveCubeFace=function(){return B},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return O},this.setRenderTargetTextures=function(ee,Ce,qe){const ke=Ne.get(ee);ke.__autoAllocateDepthBuffer=ee.resolveDepthBuffer===!1,ke.__autoAllocateDepthBuffer===!1&&(ke.__useRenderToTexture=!1),Ne.get(ee.texture).__webglTexture=Ce,Ne.get(ee.depthTexture).__webglTexture=ke.__autoAllocateDepthBuffer?void 0:qe,ke.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(ee,Ce){const qe=Ne.get(ee);qe.__webglFramebuffer=Ce,qe.__useDefaultFramebuffer=Ce===void 0};const Os=G.createFramebuffer();this.setRenderTarget=function(ee,Ce=0,qe=0){O=ee,B=Ce,I=qe;let ke=!0,De=null,mt=!1,St=!1;if(ee){const X=Ne.get(ee);if(X.__useDefaultFramebuffer!==void 0)Se.bindFramebuffer(G.FRAMEBUFFER,null),ke=!1;else if(X.__webglFramebuffer===void 0)j.setupRenderTarget(ee);else if(X.__hasExternalTextures)j.rebindTextures(ee,Ne.get(ee.texture).__webglTexture,Ne.get(ee.depthTexture).__webglTexture);else if(ee.depthBuffer){const Yt=ee.depthTexture;if(X.__boundDepthTexture!==Yt){if(Yt!==null&&Ne.has(Yt)&&(ee.width!==Yt.image.width||ee.height!==Yt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");j.setupDepthRenderbuffer(ee)}}const ft=ee.texture;(ft.isData3DTexture||ft.isDataArrayTexture||ft.isCompressedArrayTexture)&&(St=!0);const sn=Ne.get(ee).__webglFramebuffer;ee.isWebGLCubeRenderTarget?(Array.isArray(sn[Ce])?De=sn[Ce][qe]:De=sn[Ce],mt=!0):ee.samples>0&&j.useMultisampledRTT(ee)===!1?De=Ne.get(ee).__webglMultisampledFramebuffer:Array.isArray(sn)?De=sn[qe]:De=sn,V.copy(ee.viewport),H.copy(ee.scissor),Q=ee.scissorTest}else V.copy(pe).multiplyScalar(J).floor(),H.copy(Ae).multiplyScalar(J).floor(),Q=Fe;if(qe!==0&&(De=Os),Se.bindFramebuffer(G.FRAMEBUFFER,De)&&ke&&Se.drawBuffers(ee,De),Se.viewport(V),Se.scissor(H),Se.setScissorTest(Q),mt){const X=Ne.get(ee.texture);G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,X.__webglTexture,qe)}else if(St){const X=Ne.get(ee.texture),ft=Ce;G.framebufferTextureLayer(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,X.__webglTexture,qe,ft)}else if(ee!==null&&qe!==0){const X=Ne.get(ee.texture);G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,X.__webglTexture,qe)}L=-1},this.readRenderTargetPixels=function(ee,Ce,qe,ke,De,mt,St){if(!(ee&&ee.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let et=Ne.get(ee).__webglFramebuffer;if(ee.isWebGLCubeRenderTarget&&St!==void 0&&(et=et[St]),et){Se.bindFramebuffer(G.FRAMEBUFFER,et);try{const X=ee.texture,ft=X.format,sn=X.type;if(!we.textureFormatReadable(ft)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!we.textureTypeReadable(sn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ce>=0&&Ce<=ee.width-ke&&qe>=0&&qe<=ee.height-De&&G.readPixels(Ce,qe,ke,De,Ot.convert(ft),Ot.convert(sn),mt)}finally{const X=O!==null?Ne.get(O).__webglFramebuffer:null;Se.bindFramebuffer(G.FRAMEBUFFER,X)}}},this.readRenderTargetPixelsAsync=async function(ee,Ce,qe,ke,De,mt,St){if(!(ee&&ee.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let et=Ne.get(ee).__webglFramebuffer;if(ee.isWebGLCubeRenderTarget&&St!==void 0&&(et=et[St]),et)if(Ce>=0&&Ce<=ee.width-ke&&qe>=0&&qe<=ee.height-De){Se.bindFramebuffer(G.FRAMEBUFFER,et);const X=ee.texture,ft=X.format,sn=X.type;if(!we.textureFormatReadable(ft))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!we.textureTypeReadable(sn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Yt=G.createBuffer();G.bindBuffer(G.PIXEL_PACK_BUFFER,Yt),G.bufferData(G.PIXEL_PACK_BUFFER,mt.byteLength,G.STREAM_READ),G.readPixels(Ce,qe,ke,De,Ot.convert(ft),Ot.convert(sn),0);const qn=O!==null?Ne.get(O).__webglFramebuffer:null;Se.bindFramebuffer(G.FRAMEBUFFER,qn);const Qn=G.fenceSync(G.SYNC_GPU_COMMANDS_COMPLETE,0);return G.flush(),await JG(G,Qn,4),G.bindBuffer(G.PIXEL_PACK_BUFFER,Yt),G.getBufferSubData(G.PIXEL_PACK_BUFFER,0,mt),G.deleteBuffer(Yt),G.deleteSync(Qn),mt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(ee,Ce=null,qe=0){const ke=Math.pow(2,-qe),De=Math.floor(ee.image.width*ke),mt=Math.floor(ee.image.height*ke),St=Ce!==null?Ce.x:0,et=Ce!==null?Ce.y:0;j.setTexture2D(ee,0),G.copyTexSubImage2D(G.TEXTURE_2D,qe,0,0,St,et,De,mt),Se.unbindTexture()};const gh=G.createFramebuffer(),W2=G.createFramebuffer();this.copyTextureToTexture=function(ee,Ce,qe=null,ke=null,De=0,mt=null){mt===null&&(De!==0?(fa("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),mt=De,De=0):mt=0);let St,et,X,ft,sn,Yt,qn,Qn,Xi;const z=ee.isCompressedTexture?ee.mipmaps[mt]:ee.image;if(qe!==null)St=qe.max.x-qe.min.x,et=qe.max.y-qe.min.y,X=qe.isBox3?qe.max.z-qe.min.z:1,ft=qe.min.x,sn=qe.min.y,Yt=qe.isBox3?qe.min.z:0;else{const ti=Math.pow(2,-De);St=Math.floor(z.width*ti),et=Math.floor(z.height*ti),ee.isDataArrayTexture?X=z.depth:ee.isData3DTexture?X=Math.floor(z.depth*ti):X=1,ft=0,sn=0,Yt=0}ke!==null?(qn=ke.x,Qn=ke.y,Xi=ke.z):(qn=0,Qn=0,Xi=0);const Wn=Ot.convert(Ce.format),Kt=Ot.convert(Ce.type);let br;Ce.isData3DTexture?(j.setTexture3D(Ce,0),br=G.TEXTURE_3D):Ce.isDataArrayTexture||Ce.isCompressedArrayTexture?(j.setTexture2DArray(Ce,0),br=G.TEXTURE_2D_ARRAY):(j.setTexture2D(Ce,0),br=G.TEXTURE_2D),G.pixelStorei(G.UNPACK_FLIP_Y_WEBGL,Ce.flipY),G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ce.premultiplyAlpha),G.pixelStorei(G.UNPACK_ALIGNMENT,Ce.unpackAlignment);const Yn=G.getParameter(G.UNPACK_ROW_LENGTH),no=G.getParameter(G.UNPACK_IMAGE_HEIGHT),Kl=G.getParameter(G.UNPACK_SKIP_PIXELS),es=G.getParameter(G.UNPACK_SKIP_ROWS),Jl=G.getParameter(G.UNPACK_SKIP_IMAGES);G.pixelStorei(G.UNPACK_ROW_LENGTH,z.width),G.pixelStorei(G.UNPACK_IMAGE_HEIGHT,z.height),G.pixelStorei(G.UNPACK_SKIP_PIXELS,ft),G.pixelStorei(G.UNPACK_SKIP_ROWS,sn),G.pixelStorei(G.UNPACK_SKIP_IMAGES,Yt);const vi=ee.isDataArrayTexture||ee.isData3DTexture,Qi=Ce.isDataArrayTexture||Ce.isData3DTexture;if(ee.isDepthTexture){const ti=Ne.get(ee),wr=Ne.get(Ce),ts=Ne.get(ti.__renderTarget),NA=Ne.get(wr.__renderTarget);Se.bindFramebuffer(G.READ_FRAMEBUFFER,ts.__webglFramebuffer),Se.bindFramebuffer(G.DRAW_FRAMEBUFFER,NA.__webglFramebuffer);for(let Sa=0;Sa<X;Sa++)vi&&(G.framebufferTextureLayer(G.READ_FRAMEBUFFER,G.COLOR_ATTACHMENT0,Ne.get(ee).__webglTexture,De,Yt+Sa),G.framebufferTextureLayer(G.DRAW_FRAMEBUFFER,G.COLOR_ATTACHMENT0,Ne.get(Ce).__webglTexture,mt,Xi+Sa)),G.blitFramebuffer(ft,sn,St,et,qn,Qn,St,et,G.DEPTH_BUFFER_BIT,G.NEAREST);Se.bindFramebuffer(G.READ_FRAMEBUFFER,null),Se.bindFramebuffer(G.DRAW_FRAMEBUFFER,null)}else if(De!==0||ee.isRenderTargetTexture||Ne.has(ee)){const ti=Ne.get(ee),wr=Ne.get(Ce);Se.bindFramebuffer(G.READ_FRAMEBUFFER,gh),Se.bindFramebuffer(G.DRAW_FRAMEBUFFER,W2);for(let ts=0;ts<X;ts++)vi?G.framebufferTextureLayer(G.READ_FRAMEBUFFER,G.COLOR_ATTACHMENT0,ti.__webglTexture,De,Yt+ts):G.framebufferTexture2D(G.READ_FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,ti.__webglTexture,De),Qi?G.framebufferTextureLayer(G.DRAW_FRAMEBUFFER,G.COLOR_ATTACHMENT0,wr.__webglTexture,mt,Xi+ts):G.framebufferTexture2D(G.DRAW_FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,wr.__webglTexture,mt),De!==0?G.blitFramebuffer(ft,sn,St,et,qn,Qn,St,et,G.COLOR_BUFFER_BIT,G.NEAREST):Qi?G.copyTexSubImage3D(br,mt,qn,Qn,Xi+ts,ft,sn,St,et):G.copyTexSubImage2D(br,mt,qn,Qn,ft,sn,St,et);Se.bindFramebuffer(G.READ_FRAMEBUFFER,null),Se.bindFramebuffer(G.DRAW_FRAMEBUFFER,null)}else Qi?ee.isDataTexture||ee.isData3DTexture?G.texSubImage3D(br,mt,qn,Qn,Xi,St,et,X,Wn,Kt,z.data):Ce.isCompressedArrayTexture?G.compressedTexSubImage3D(br,mt,qn,Qn,Xi,St,et,X,Wn,z.data):G.texSubImage3D(br,mt,qn,Qn,Xi,St,et,X,Wn,Kt,z):ee.isDataTexture?G.texSubImage2D(G.TEXTURE_2D,mt,qn,Qn,St,et,Wn,Kt,z.data):ee.isCompressedTexture?G.compressedTexSubImage2D(G.TEXTURE_2D,mt,qn,Qn,z.width,z.height,Wn,z.data):G.texSubImage2D(G.TEXTURE_2D,mt,qn,Qn,St,et,Wn,Kt,z);G.pixelStorei(G.UNPACK_ROW_LENGTH,Yn),G.pixelStorei(G.UNPACK_IMAGE_HEIGHT,no),G.pixelStorei(G.UNPACK_SKIP_PIXELS,Kl),G.pixelStorei(G.UNPACK_SKIP_ROWS,es),G.pixelStorei(G.UNPACK_SKIP_IMAGES,Jl),mt===0&&Ce.generateMipmaps&&G.generateMipmap(br),Se.unbindTexture()},this.copyTextureToTexture3D=function(ee,Ce,qe=null,ke=null,De=0){return fa('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(ee,Ce,qe,ke,De)},this.initRenderTarget=function(ee){Ne.get(ee).__webglFramebuffer===void 0&&j.setupRenderTarget(ee)},this.initTexture=function(ee){ee.isCubeTexture?j.setTextureCube(ee,0):ee.isData3DTexture?j.setTexture3D(ee,0):ee.isDataArrayTexture||ee.isCompressedArrayTexture?j.setTexture2DArray(ee,0):j.setTexture2D(ee,0),Se.unbindTexture()},this.resetState=function(){B=0,I=0,O=null,Se.reset(),fn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Is}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Rn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Rn._getUnpackColorSpace()}}function Gv(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var AX=typeof global=="object"&&global&&global.Object===Object&&global,dX=typeof self=="object"&&self&&self.Object===Object&&self,CE=AX||dX||Function("return this")(),f3=function(){return CE.Date.now()},pX=/\s/;function mX(n){for(var e=n.length;e--&&pX.test(n.charAt(e)););return e}var gX=/^\s+/;function _X(n){return n&&n.slice(0,mX(n)+1).replace(gX,"")}var W1=CE.Symbol,RE=Object.prototype,vX=RE.hasOwnProperty,yX=RE.toString,ZA=W1?W1.toStringTag:void 0;function xX(n){var e=vX.call(n,ZA),t=n[ZA];try{n[ZA]=void 0;var i=!0}catch{}var r=yX.call(n);return i&&(e?n[ZA]=t:delete n[ZA]),r}var bX=Object.prototype,wX=bX.toString;function SX(n){return wX.call(n)}var TX="[object Null]",MX="[object Undefined]",O6=W1?W1.toStringTag:void 0;function EX(n){return n==null?n===void 0?MX:TX:O6&&O6 in Object(n)?xX(n):SX(n)}function CX(n){return n!=null&&typeof n=="object"}var RX="[object Symbol]";function NX(n){return typeof n=="symbol"||CX(n)&&EX(n)==RX}var k6=NaN,PX=/^[-+]0x[0-9a-f]+$/i,LX=/^0b[01]+$/i,DX=/^0o[0-7]+$/i,IX=parseInt;function V6(n){if(typeof n=="number")return n;if(NX(n))return k6;if(Gv(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=Gv(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=_X(n);var t=LX.test(n);return t||DX.test(n)?IX(n.slice(2),t?2:8):PX.test(n)?k6:+n}var BX="Expected a function",FX=Math.max,UX=Math.min;function OX(n,e,t){var i,r,s,o,a,l,u=0,A=!1,p=!1,g=!0;if(typeof n!="function")throw new TypeError(BX);e=V6(e)||0,Gv(t)&&(A=!!t.leading,p="maxWait"in t,s=p?FX(V6(t.maxWait)||0,e):s,g="trailing"in t?!!t.trailing:g);function v(B){var I=i,O=r;return i=r=void 0,u=B,o=n.apply(O,I),o}function x(B){return u=B,a=setTimeout(w,e),A?v(B):o}function S(B){var I=B-l,O=B-u,L=e-I;return p?UX(L,s-O):L}function T(B){var I=B-l,O=B-u;return l===void 0||I>=e||I<0||p&&O>=s}function w(){var B=f3();if(T(B))return R(B);a=setTimeout(w,S(B))}function R(B){return a=void 0,g&&i?v(B):(i=r=void 0,o)}function E(){a!==void 0&&clearTimeout(a),u=0,i=l=r=a=void 0}function N(){return a===void 0?o:R(f3())}function D(){var B=f3(),I=T(B);if(i=arguments,r=this,l=B,I){if(a===void 0)return x(l);if(p)return clearTimeout(a),a=setTimeout(w,e),v(l)}return a===void 0&&(a=setTimeout(w,e)),o}return D.cancel=E,D.flush=N,D}function G6(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function kX(n){if(Array.isArray(n))return n}function VX(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function GX(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function qX(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function zX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HX(n,e){return kX(n)||qX(n,e)||$X(n,e)||zX()}function $X(n,e){if(n){if(typeof n=="string")return G6(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?G6(n,e):void 0}}var WX=GX(function n(e,t){var i=t.default,r=i===void 0?null:i,s=t.triggerUpdate,o=s===void 0?!0:s,a=t.onChange,l=a===void 0?function(u,A){}:a;VX(this,n),this.name=e,this.defaultVal=r,this.triggerUpdate=o,this.onChange=l});function ms(n){var e=n.stateInit,t=e===void 0?function(){return{}}:e,i=n.props,r=i===void 0?{}:i,s=n.methods,o=s===void 0?{}:s,a=n.aliases,l=a===void 0?{}:a,u=n.init,A=u===void 0?function(){}:u,p=n.update,g=p===void 0?function(){}:p,v=Object.keys(r).map(function(x){return new WX(x,r[x])});return function x(){for(var S=arguments.length,T=new Array(S),w=0;w<S;w++)T[w]=arguments[w];var R=!!(this instanceof x&&this.constructor),E=R?T.shift():void 0,N=T[0],D=N===void 0?{}:N,B=Object.assign({},t instanceof Function?t(D):t,{initialised:!1}),I={};function O(V){return L(V,D),F(),O}var L=function(H,Q){A.call(O,H,B,Q),B.initialised=!0},F=OX(function(){B.initialised&&(g.call(O,B,I),I={})},1);return v.forEach(function(V){O[V.name]=H(V);function H(Q){var te=Q.name,K=Q.triggerUpdate,W=K===void 0?!1:K,Z=Q.onChange,J=Z===void 0?function(pe,Ae){}:Z,fe=Q.defaultVal,ge=fe===void 0?null:fe;return function(pe){var Ae=B[te];if(!arguments.length)return Ae;var Fe=pe===void 0?ge:pe;return B[te]=Fe,J.call(O,Fe,B,Ae),!I.hasOwnProperty(te)&&(I[te]=Ae),W&&F(),O}}}),Object.keys(o).forEach(function(V){O[V]=function(){for(var H,Q=arguments.length,te=new Array(Q),K=0;K<Q;K++)te[K]=arguments[K];return(H=o[V]).call.apply(H,[O,B].concat(te))}}),Object.entries(l).forEach(function(V){var H=HX(V,2),Q=H[0],te=H[1];return O[Q]=O[te]}),O.resetProps=function(){return v.forEach(function(V){O[V.name](V.defaultVal)}),O},O.resetProps(),B._rerender=F,R&&E&&O(E),O}}var Xr=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return n},Out:function(n){return n},InOut:function(n){return n}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(n){var e=1.70158;return n===1?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return n===0?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-Xr.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?Xr.Bounce.In(n*2)*.5:Xr.Bounce.Out(n*2-1)*.5+.5}}),generatePow:function(n){return n===void 0&&(n=4),n=n<Number.EPSILON?Number.EPSILON:n,n=n>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(e*2,n)/2:(1-Math.pow(2-e*2,n))/2+.5}}}}),b0=function(){return performance.now()},NE=function(){function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var r=0,s=t;r<s.length;r++){var o=s[r];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},n.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,r=e;i<r.length;i++){var s=r[i];s._group=void 0,delete this._tweens[s.getId()],delete this._tweensAddedDuringUpdate[s.getId()]}},n.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},n.prototype.update=function(e,t){e===void 0&&(e=b0()),t===void 0&&(t=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]],o=!t;s&&s.update(e,o)===!1&&!t&&this.remove(s)}i=Object.keys(this._tweensAddedDuringUpdate)}},n}(),qv={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=qv.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n}}},PE=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),zv=new NE,wo=function(){function n(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Xr.Linear.None,this._interpolationFunction=qv.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=PE.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof t=="object"?(this._group=t,t.add(this)):t===!0&&(this._group=zv,zv.add(this))}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(e===void 0&&(e=b0()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var o in i){var a=e[o],l=Array.isArray(a),u=l?"array":typeof a,A=!l&&Array.isArray(i[o]);if(!(u==="undefined"||u==="function")){if(A){var p=i[o];if(p.length===0)continue;for(var g=[a],v=0,x=p.length;v<x;v+=1){var S=this._handleRelativeValue(a,p[v]);if(isNaN(S)){A=!1,console.warn("Found invalid interpolation list. Skipping.");break}g.push(S)}A&&(i[o]=g)}if((u==="object"||l)&&a&&!A){t[o]=l?[]:{};var T=a;for(var w in T)t[o][w]=T[w];r[o]=l?[]:{};var p=i[o];if(!this._isDynamic){var R={};for(var w in p)R[w]=p[w];i[o]=p=R}this._setupProperties(T,t[o],p,r[o],s)}else(typeof t[o]>"u"||s)&&(t[o]=a),l||(t[o]*=1),A?r[o]=i[o].slice().reverse():r[o]=t[o]||0}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},n.prototype.pause=function(e){return e===void 0&&(e=b0()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},n.prototype.resume=function(e){return e===void 0&&(e=b0()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},n.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},n.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return e===void 0&&(e=Xr.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return e===void 0&&(e=qv.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var i=this,r;if(e===void 0&&(e=b0()),t===void 0&&(t=n.autoStartOnUpdate),this._isPaused)return!0;var s;if(!this._goToEnd&&!this._isPlaying)if(t)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,a=this._duration+((r=this._repeatDelayTime)!==null&&r!==void 0?r:this._delayTime),l=this._duration+this._repeat*a,u=function(){if(i._duration===0||o>l)return 1;var S=Math.trunc(o/a),T=o-S*a,w=Math.min(T/i._duration,1);return w===0&&o===i._duration?1:w},A=u(),p=this._easingFunction(A);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,p),this._onUpdateCallback&&this._onUpdateCallback(this._object,A),this._duration===0||o>=this._duration)if(this._repeat>0){var g=Math.min(Math.trunc((o-this._duration)/a)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=g);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*g,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var v=0,x=this._chainedTweens.length;v<x;v++)this._chainedTweens[v].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(t[s]!==void 0){var o=t[s]||0,a=i[s],l=Array.isArray(e[s]),u=Array.isArray(a),A=!l&&u;A?e[s]=this._interpolationFunction(a,r):typeof a=="object"&&a?this._updateProperties(e[s],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(e[s]=o+(a-o)*r))}},n.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},n.autoStartOnUpdate=!1,n}();PE.nextId;var Ka=zv;Ka.getAll.bind(Ka);Ka.removeAll.bind(Ka);Ka.add.bind(Ka);Ka.remove.bind(Ka);Ka.update.bind(Ka);function jX(n){const e=+this._x.call(null,n),t=+this._y.call(null,n),i=+this._z.call(null,n);return LE(this.cover(e,t,i),e,t,i,n)}function LE(n,e,t,i,r){if(isNaN(e)||isNaN(t)||isNaN(i))return n;var s,o=n._root,a={data:r},l=n._x0,u=n._y0,A=n._z0,p=n._x1,g=n._y1,v=n._z1,x,S,T,w,R,E,N,D,B,I,O;if(!o)return n._root=a,n;for(;o.length;)if((N=e>=(x=(l+p)/2))?l=x:p=x,(D=t>=(S=(u+g)/2))?u=S:g=S,(B=i>=(T=(A+v)/2))?A=T:v=T,s=o,!(o=o[I=B<<2|D<<1|N]))return s[I]=a,n;if(w=+n._x.call(null,o.data),R=+n._y.call(null,o.data),E=+n._z.call(null,o.data),e===w&&t===R&&i===E)return a.next=o,s?s[I]=a:n._root=a,n;do s=s?s[I]=new Array(8):n._root=new Array(8),(N=e>=(x=(l+p)/2))?l=x:p=x,(D=t>=(S=(u+g)/2))?u=S:g=S,(B=i>=(T=(A+v)/2))?A=T:v=T;while((I=B<<2|D<<1|N)===(O=(E>=T)<<2|(R>=S)<<1|w>=x));return s[O]=o,s[I]=a,n}function XX(n){Array.isArray(n)||(n=Array.from(n));const e=n.length,t=new Float64Array(e),i=new Float64Array(e),r=new Float64Array(e);let s=1/0,o=1/0,a=1/0,l=-1/0,u=-1/0,A=-1/0;for(let p=0,g,v,x,S;p<e;++p)isNaN(v=+this._x.call(null,g=n[p]))||isNaN(x=+this._y.call(null,g))||isNaN(S=+this._z.call(null,g))||(t[p]=v,i[p]=x,r[p]=S,v<s&&(s=v),v>l&&(l=v),x<o&&(o=x),x>u&&(u=x),S<a&&(a=S),S>A&&(A=S));if(s>l||o>u||a>A)return this;this.cover(s,o,a).cover(l,u,A);for(let p=0;p<e;++p)LE(this,t[p],i[p],r[p],n[p]);return this}function QX(n,e,t){if(isNaN(n=+n)||isNaN(e=+e)||isNaN(t=+t))return this;var i=this._x0,r=this._y0,s=this._z0,o=this._x1,a=this._y1,l=this._z1;if(isNaN(i))o=(i=Math.floor(n))+1,a=(r=Math.floor(e))+1,l=(s=Math.floor(t))+1;else{for(var u=o-i||1,A=this._root,p,g;i>n||n>=o||r>e||e>=a||s>t||t>=l;)switch(g=(t<s)<<2|(e<r)<<1|n<i,p=new Array(8),p[g]=A,A=p,u*=2,g){case 0:o=i+u,a=r+u,l=s+u;break;case 1:i=o-u,a=r+u,l=s+u;break;case 2:o=i+u,r=a-u,l=s+u;break;case 3:i=o-u,r=a-u,l=s+u;break;case 4:o=i+u,a=r+u,s=l-u;break;case 5:i=o-u,a=r+u,s=l-u;break;case 6:o=i+u,r=a-u,s=l-u;break;case 7:i=o-u,r=a-u,s=l-u;break}this._root&&this._root.length&&(this._root=A)}return this._x0=i,this._y0=r,this._z0=s,this._x1=o,this._y1=a,this._z1=l,this}function YX(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function ZX(n){return arguments.length?this.cover(+n[0][0],+n[0][1],+n[0][2]).cover(+n[1][0],+n[1][1],+n[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function yi(n,e,t,i,r,s,o){this.node=n,this.x0=e,this.y0=t,this.z0=i,this.x1=r,this.y1=s,this.z1=o}function KX(n,e,t,i){var r,s=this._x0,o=this._y0,a=this._z0,l,u,A,p,g,v,x=this._x1,S=this._y1,T=this._z1,w=[],R=this._root,E,N;for(R&&w.push(new yi(R,s,o,a,x,S,T)),i==null?i=1/0:(s=n-i,o=e-i,a=t-i,x=n+i,S=e+i,T=t+i,i*=i);E=w.pop();)if(!(!(R=E.node)||(l=E.x0)>x||(u=E.y0)>S||(A=E.z0)>T||(p=E.x1)<s||(g=E.y1)<o||(v=E.z1)<a))if(R.length){var D=(l+p)/2,B=(u+g)/2,I=(A+v)/2;w.push(new yi(R[7],D,B,I,p,g,v),new yi(R[6],l,B,I,D,g,v),new yi(R[5],D,u,I,p,B,v),new yi(R[4],l,u,I,D,B,v),new yi(R[3],D,B,A,p,g,I),new yi(R[2],l,B,A,D,g,I),new yi(R[1],D,u,A,p,B,I),new yi(R[0],l,u,A,D,B,I)),(N=(t>=I)<<2|(e>=B)<<1|n>=D)&&(E=w[w.length-1],w[w.length-1]=w[w.length-1-N],w[w.length-1-N]=E)}else{var O=n-+this._x.call(null,R.data),L=e-+this._y.call(null,R.data),F=t-+this._z.call(null,R.data),V=O*O+L*L+F*F;if(V<i){var H=Math.sqrt(i=V);s=n-H,o=e-H,a=t-H,x=n+H,S=e+H,T=t+H,r=R.data}}return r}const JX=(n,e,t,i,r,s)=>Math.sqrt((n-i)**2+(e-r)**2+(t-s)**2);function eQ(n,e,t,i){const r=[],s=n-i,o=e-i,a=t-i,l=n+i,u=e+i,A=t+i;return this.visit((p,g,v,x,S,T,w)=>{if(!p.length)do{const R=p.data;JX(n,e,t,this._x(R),this._y(R),this._z(R))<=i&&r.push(R)}while(p=p.next);return g>l||v>u||x>A||S<s||T<o||w<a}),r}function tQ(n){if(isNaN(g=+this._x.call(null,n))||isNaN(v=+this._y.call(null,n))||isNaN(x=+this._z.call(null,n)))return this;var e,t=this._root,i,r,s,o=this._x0,a=this._y0,l=this._z0,u=this._x1,A=this._y1,p=this._z1,g,v,x,S,T,w,R,E,N,D,B;if(!t)return this;if(t.length)for(;;){if((R=g>=(S=(o+u)/2))?o=S:u=S,(E=v>=(T=(a+A)/2))?a=T:A=T,(N=x>=(w=(l+p)/2))?l=w:p=w,e=t,!(t=t[D=N<<2|E<<1|R]))return this;if(!t.length)break;(e[D+1&7]||e[D+2&7]||e[D+3&7]||e[D+4&7]||e[D+5&7]||e[D+6&7]||e[D+7&7])&&(i=e,B=D)}for(;t.data!==n;)if(r=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,r?(s?r.next=s:delete r.next,this):e?(s?e[D]=s:delete e[D],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(i?i[B]=t:this._root=t),this):(this._root=s,this)}function nQ(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function iQ(){return this._root}function rQ(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function sQ(n){var e=[],t,i=this._root,r,s,o,a,l,u,A;for(i&&e.push(new yi(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!n(i=t.node,s=t.x0,o=t.y0,a=t.z0,l=t.x1,u=t.y1,A=t.z1)&&i.length){var p=(s+l)/2,g=(o+u)/2,v=(a+A)/2;(r=i[7])&&e.push(new yi(r,p,g,v,l,u,A)),(r=i[6])&&e.push(new yi(r,s,g,v,p,u,A)),(r=i[5])&&e.push(new yi(r,p,o,v,l,g,A)),(r=i[4])&&e.push(new yi(r,s,o,v,p,g,A)),(r=i[3])&&e.push(new yi(r,p,g,a,l,u,v)),(r=i[2])&&e.push(new yi(r,s,g,a,p,u,v)),(r=i[1])&&e.push(new yi(r,p,o,a,l,g,v)),(r=i[0])&&e.push(new yi(r,s,o,a,p,g,v))}return this}function oQ(n){var e=[],t=[],i;for(this._root&&e.push(new yi(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=e.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,l=i.z0,u=i.x1,A=i.y1,p=i.z1,g=(o+u)/2,v=(a+A)/2,x=(l+p)/2;(s=r[0])&&e.push(new yi(s,o,a,l,g,v,x)),(s=r[1])&&e.push(new yi(s,g,a,l,u,v,x)),(s=r[2])&&e.push(new yi(s,o,v,l,g,A,x)),(s=r[3])&&e.push(new yi(s,g,v,l,u,A,x)),(s=r[4])&&e.push(new yi(s,o,a,x,g,v,p)),(s=r[5])&&e.push(new yi(s,g,a,x,u,v,p)),(s=r[6])&&e.push(new yi(s,o,v,x,g,A,p)),(s=r[7])&&e.push(new yi(s,g,v,x,u,A,p))}t.push(i)}for(;i=t.pop();)n(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function aQ(n){return n[0]}function lQ(n){return arguments.length?(this._x=n,this):this._x}function uQ(n){return n[1]}function cQ(n){return arguments.length?(this._y=n,this):this._y}function hQ(n){return n[2]}function fQ(n){return arguments.length?(this._z=n,this):this._z}function DE(n,e,t,i){var r=new a4(e??aQ,t??uQ,i??hQ,NaN,NaN,NaN,NaN,NaN,NaN);return n==null?r:r.addAll(n)}function a4(n,e,t,i,r,s,o,a,l){this._x=n,this._y=e,this._z=t,this._x0=i,this._y0=r,this._z0=s,this._x1=o,this._y1=a,this._z1=l,this._root=void 0}function q6(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var Yr=DE.prototype=a4.prototype;Yr.copy=function(){var n=new a4(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,i;if(!e)return n;if(!e.length)return n._root=q6(e),n;for(t=[{source:e,target:n._root=new Array(8)}];e=t.pop();)for(var r=0;r<8;++r)(i=e.source[r])&&(i.length?t.push({source:i,target:e.target[r]=new Array(8)}):e.target[r]=q6(i));return n};Yr.add=jX;Yr.addAll=XX;Yr.cover=QX;Yr.data=YX;Yr.extent=ZX;Yr.find=KX;Yr.findAllWithinRadius=eQ;Yr.remove=tQ;Yr.removeAll=nQ;Yr.root=iQ;Yr.size=rQ;Yr.visit=sQ;Yr.visitAfter=oQ;Yr.x=lQ;Yr.y=cQ;Yr.z=fQ;function d1(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function AQ(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function IE(n){let e,t,i;n.length!==2?(e=d1,t=(a,l)=>d1(n(a),l),i=(a,l)=>n(a)-l):(e=n===d1||n===AQ?n:dQ,t=n,i=n);function r(a,l,u=0,A=a.length){if(u<A){if(e(l,l)!==0)return A;do{const p=u+A>>>1;t(a[p],l)<0?u=p+1:A=p}while(u<A)}return u}function s(a,l,u=0,A=a.length){if(u<A){if(e(l,l)!==0)return A;do{const p=u+A>>>1;t(a[p],l)<=0?u=p+1:A=p}while(u<A)}return u}function o(a,l,u=0,A=a.length){const p=r(a,l,u,A-1);return p>u&&i(a[p-1],l)>-i(a[p],l)?p-1:p}return{left:r,center:o,right:s}}function dQ(){return 0}function pQ(n){return n===null?NaN:+n}const mQ=IE(d1),BE=mQ.right;IE(pQ).center;function j1(n,e){let t,i;if(e===void 0)for(const r of n)r!=null&&(t===void 0?r>=r&&(t=i=r):(t>r&&(t=r),i<r&&(i=r)));else{let r=-1;for(let s of n)(s=e(s,++r,n))!=null&&(t===void 0?s>=s&&(t=i=s):(t>s&&(t=s),i<s&&(i=s)))}return[t,i]}class Il{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=t[r],o=e+s,a=Math.abs(e)<Math.abs(s)?e-(o-s):s-(o-e);a&&(t[i++]=a),e=o}return t[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let t=this._n,i,r,s,o=0;if(t>0){for(o=e[--t];t>0&&(i=o,r=e[--t],o=i+r,s=r-(o-i),!s););t>0&&(s<0&&e[t-1]<0||s>0&&e[t-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}const gQ=Math.sqrt(50),_Q=Math.sqrt(10),vQ=Math.sqrt(2);function X1(n,e,t){const i=(e-n)/Math.max(0,t),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=gQ?10:s>=_Q?5:s>=vQ?2:1;let a,l,u;return r<0?(u=Math.pow(10,-r)/o,a=Math.round(n*u),l=Math.round(e*u),a/u<n&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,r)*o,a=Math.round(n/u),l=Math.round(e/u),a*u<n&&++a,l*u>e&&--l),l<a&&.5<=t&&t<2?X1(n,e,t*2):[a,l,u]}function yQ(n,e,t){if(e=+e,n=+n,t=+t,!(t>0))return[];if(n===e)return[n];const i=e<n,[r,s,o]=i?X1(e,n,t):X1(n,e,t);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(i)if(o<0)for(let u=0;u<a;++u)l[u]=(s-u)/-o;else for(let u=0;u<a;++u)l[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)l[u]=(r+u)/-o;else for(let u=0;u<a;++u)l[u]=(r+u)*o;return l}function Hv(n,e,t){return e=+e,n=+n,t=+t,X1(n,e,t)[2]}function xQ(n,e,t){e=+e,n=+n,t=+t;const i=e<n,r=i?Hv(e,n,t):Hv(n,e,t);return(i?-1:1)*(r<0?1/-r:r)}function bQ(n,e){let t;for(const i of n)i!=null&&(t<i||t===void 0&&i>=i)&&(t=i);return t}function wQ(n,e){let t=0,i=0;if(e===void 0)for(let r of n)r!=null&&(r=+r)>=r&&(++t,i+=r);else{let r=-1;for(let s of n)(s=e(s,++r,n))!=null&&(s=+s)>=s&&(++t,i+=s)}if(t)return i/t}function*SQ(n){for(const e of n)yield*e}function Sd(n){return Array.from(SQ(n))}function ff(n,e,t){n=+n,e=+e,t=(r=arguments.length)<2?(e=n,n=0,1):r<3?1:+t;for(var i=-1,r=Math.max(0,Math.ceil((e-n)/t))|0,s=new Array(r);++i<r;)s[i]=n+i*t;return s}function TQ(n,e){let t=0;for(let i of n)(i=+i)&&(t+=i);return t}function FE(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}function l4(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function UE(n,e){var t=Object.create(n.prototype);for(var i in e)t[i]=e[i];return t}function op(){}var Td=.7,Q1=1/Td,Pf="\\s*([+-]?\\d+)\\s*",Md="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$a="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",MQ=/^#([0-9a-f]{3,8})$/,EQ=new RegExp(`^rgb\\(${Pf},${Pf},${Pf}\\)$`),CQ=new RegExp(`^rgb\\(${$a},${$a},${$a}\\)$`),RQ=new RegExp(`^rgba\\(${Pf},${Pf},${Pf},${Md}\\)$`),NQ=new RegExp(`^rgba\\(${$a},${$a},${$a},${Md}\\)$`),PQ=new RegExp(`^hsl\\(${Md},${$a},${$a}\\)$`),LQ=new RegExp(`^hsla\\(${Md},${$a},${$a},${Md}\\)$`),z6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};l4(op,rh,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:H6,formatHex:H6,formatHex8:DQ,formatHsl:IQ,formatRgb:$6,toString:$6});function H6(){return this.rgb().formatHex()}function DQ(){return this.rgb().formatHex8()}function IQ(){return OE(this).formatHsl()}function $6(){return this.rgb().formatRgb()}function rh(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=MQ.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?W6(e):t===3?new Hs(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?gm(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?gm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=EQ.exec(n))?new Hs(e[1],e[2],e[3],1):(e=CQ.exec(n))?new Hs(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=RQ.exec(n))?gm(e[1],e[2],e[3],e[4]):(e=NQ.exec(n))?gm(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=PQ.exec(n))?Q6(e[1],e[2]/100,e[3]/100,1):(e=LQ.exec(n))?Q6(e[1],e[2]/100,e[3]/100,e[4]):z6.hasOwnProperty(n)?W6(z6[n]):n==="transparent"?new Hs(NaN,NaN,NaN,0):null}function W6(n){return new Hs(n>>16&255,n>>8&255,n&255,1)}function gm(n,e,t,i){return i<=0&&(n=e=t=NaN),new Hs(n,e,t,i)}function BQ(n){return n instanceof op||(n=rh(n)),n?(n=n.rgb(),new Hs(n.r,n.g,n.b,n.opacity)):new Hs}function $v(n,e,t,i){return arguments.length===1?BQ(n):new Hs(n,e,t,i??1)}function Hs(n,e,t,i){this.r=+n,this.g=+e,this.b=+t,this.opacity=+i}l4(Hs,$v,UE(op,{brighter(n){return n=n==null?Q1:Math.pow(Q1,n),new Hs(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?Td:Math.pow(Td,n),new Hs(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new Hs(Gc(this.r),Gc(this.g),Gc(this.b),Y1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:j6,formatHex:j6,formatHex8:FQ,formatRgb:X6,toString:X6}));function j6(){return`#${Lc(this.r)}${Lc(this.g)}${Lc(this.b)}`}function FQ(){return`#${Lc(this.r)}${Lc(this.g)}${Lc(this.b)}${Lc((isNaN(this.opacity)?1:this.opacity)*255)}`}function X6(){const n=Y1(this.opacity);return`${n===1?"rgb(":"rgba("}${Gc(this.r)}, ${Gc(this.g)}, ${Gc(this.b)}${n===1?")":`, ${n})`}`}function Y1(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Gc(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function Lc(n){return n=Gc(n),(n<16?"0":"")+n.toString(16)}function Q6(n,e,t,i){return i<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new ra(n,e,t,i)}function OE(n){if(n instanceof ra)return new ra(n.h,n.s,n.l,n.opacity);if(n instanceof op||(n=rh(n)),!n)return new ra;if(n instanceof ra)return n;n=n.rgb();var e=n.r/255,t=n.g/255,i=n.b/255,r=Math.min(e,t,i),s=Math.max(e,t,i),o=NaN,a=s-r,l=(s+r)/2;return a?(e===s?o=(t-i)/a+(t<i)*6:t===s?o=(i-e)/a+2:o=(e-t)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new ra(o,a,l,n.opacity)}function UQ(n,e,t,i){return arguments.length===1?OE(n):new ra(n,e,t,i??1)}function ra(n,e,t,i){this.h=+n,this.s=+e,this.l=+t,this.opacity=+i}l4(ra,UQ,UE(op,{brighter(n){return n=n==null?Q1:Math.pow(Q1,n),new ra(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Td:Math.pow(Td,n),new ra(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*e,r=2*t-i;return new Hs(A3(n>=240?n-240:n+120,r,i),A3(n,r,i),A3(n<120?n+240:n-120,r,i),this.opacity)},clamp(){return new ra(Y6(this.h),_m(this.s),_m(this.l),Y1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Y1(this.opacity);return`${n===1?"hsl(":"hsla("}${Y6(this.h)}, ${_m(this.s)*100}%, ${_m(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Y6(n){return n=(n||0)%360,n<0?n+360:n}function _m(n){return Math.max(0,Math.min(1,n||0))}function A3(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const u4=n=>()=>n;function OQ(n,e){return function(t){return n+t*e}}function kQ(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(i){return Math.pow(n+i*e,t)}}function VQ(n){return(n=+n)==1?kE:function(e,t){return t-e?kQ(e,t,n):u4(isNaN(e)?t:e)}}function kE(n,e){var t=e-n;return t?OQ(n,t):u4(isNaN(n)?e:n)}const Z6=function n(e){var t=VQ(e);function i(r,s){var o=t((r=$v(r)).r,(s=$v(s)).r),a=t(r.g,s.g),l=t(r.b,s.b),u=kE(r.opacity,s.opacity);return function(A){return r.r=o(A),r.g=a(A),r.b=l(A),r.opacity=u(A),r+""}}return i.gamma=n,i}(1);function VE(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,i=e.slice(),r;return function(s){for(r=0;r<t;++r)i[r]=n[r]*(1-s)+e[r]*s;return i}}function GE(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function GQ(n,e){return(GE(e)?VE:qE)(n,e)}function qE(n,e){var t=e?e.length:0,i=n?Math.min(t,n.length):0,r=new Array(i),s=new Array(t),o;for(o=0;o<i;++o)r[o]=c4(n[o],e[o]);for(;o<t;++o)s[o]=e[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function qQ(n,e){var t=new Date;return n=+n,e=+e,function(i){return t.setTime(n*(1-i)+e*i),t}}function Ed(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function zQ(n,e){var t={},i={},r;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in n?t[r]=c4(n[r],e[r]):i[r]=e[r];return function(s){for(r in t)i[r]=t[r](s);return i}}var Wv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,d3=new RegExp(Wv.source,"g");function HQ(n){return function(){return n}}function $Q(n){return function(e){return n(e)+""}}function WQ(n,e){var t=Wv.lastIndex=d3.lastIndex=0,i,r,s,o=-1,a=[],l=[];for(n=n+"",e=e+"";(i=Wv.exec(n))&&(r=d3.exec(e));)(s=r.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:Ed(i,r)})),t=d3.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?$Q(l[0].x):HQ(e):(e=l.length,function(u){for(var A=0,p;A<e;++A)a[(p=l[A]).i]=p.x(u);return a.join("")})}function c4(n,e){var t=typeof e,i;return e==null||t==="boolean"?u4(e):(t==="number"?Ed:t==="string"?(i=rh(e))?(e=i,Z6):WQ:e instanceof rh?Z6:e instanceof Date?qQ:GE(e)?VE:Array.isArray(e)?qE:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?zQ:Ed)(n,e)}function jQ(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}function XQ(n){return function(){return n}}function QQ(n){return+n}var K6=[0,1];function Af(n){return n}function jv(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:XQ(isNaN(e)?NaN:.5)}function YQ(n,e){var t;return n>e&&(t=n,n=e,e=t),function(i){return Math.max(n,Math.min(e,i))}}function ZQ(n,e,t){var i=n[0],r=n[1],s=e[0],o=e[1];return r<i?(i=jv(r,i),s=t(o,s)):(i=jv(i,r),s=t(s,o)),function(a){return s(i(a))}}function KQ(n,e,t){var i=Math.min(n.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=jv(n[o],n[o+1]),s[o]=t(e[o],e[o+1]);return function(a){var l=BE(n,a,1,i)-1;return s[l](r[l](a))}}function JQ(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function eY(){var n=K6,e=K6,t=c4,i,r,s,o=Af,a,l,u;function A(){var g=Math.min(n.length,e.length);return o!==Af&&(o=YQ(n[0],n[g-1])),a=g>2?KQ:ZQ,l=u=null,p}function p(g){return g==null||isNaN(g=+g)?s:(l||(l=a(n.map(i),e,t)))(i(o(g)))}return p.invert=function(g){return o(r((u||(u=a(e,n.map(i),Ed)))(g)))},p.domain=function(g){return arguments.length?(n=Array.from(g,QQ),A()):n.slice()},p.range=function(g){return arguments.length?(e=Array.from(g),A()):e.slice()},p.rangeRound=function(g){return e=Array.from(g),t=jQ,A()},p.clamp=function(g){return arguments.length?(o=g?!0:Af,A()):o!==Af},p.interpolate=function(g){return arguments.length?(t=g,A()):t},p.unknown=function(g){return arguments.length?(s=g,p):s},function(g,v){return i=g,r=v,A()}}function tY(){return eY()(Af,Af)}function nY(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Z1(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,i=n.slice(0,t);return[i.length>1?i[0]+i.slice(2):i,+n.slice(t+1)]}function oA(n){return n=Z1(Math.abs(n)),n?n[1]:NaN}function iY(n,e){return function(t,i){for(var r=t.length,s=[],o=0,a=n[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=n[o=(o+1)%n.length];return s.reverse().join(e)}}function rY(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var sY=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function K1(n){if(!(e=sY.exec(n)))throw new Error("invalid format: "+n);var e;return new h4({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}K1.prototype=h4.prototype;function h4(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}h4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function oY(n){e:for(var e=n.length,t=1,i=-1,r;t<e;++t)switch(n[t]){case".":i=r=t;break;case"0":i===0&&(i=t),r=t;break;default:if(!+n[t])break e;i>0&&(i=0);break}return i>0?n.slice(0,i)+n.slice(r+1):n}var zE;function aY(n,e){var t=Z1(n,e);if(!t)return n+"";var i=t[0],r=t[1],s=r-(zE=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Z1(n,Math.max(0,e+s-1))[0]}function J6(n,e){var t=Z1(n,e);if(!t)return n+"";var i=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const ew={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:nY,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>J6(n*100,e),r:J6,s:aY,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function tw(n){return n}var nw=Array.prototype.map,iw=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function lY(n){var e=n.grouping===void 0||n.thousands===void 0?tw:iY(nw.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",i=n.currency===void 0?"":n.currency[1]+"",r=n.decimal===void 0?".":n.decimal+"",s=n.numerals===void 0?tw:rY(nw.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"−":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function u(p){p=K1(p);var g=p.fill,v=p.align,x=p.sign,S=p.symbol,T=p.zero,w=p.width,R=p.comma,E=p.precision,N=p.trim,D=p.type;D==="n"?(R=!0,D="g"):ew[D]||(E===void 0&&(E=12),N=!0,D="g"),(T||g==="0"&&v==="=")&&(T=!0,g="0",v="=");var B=S==="$"?t:S==="#"&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",I=S==="$"?i:/[%p]/.test(D)?o:"",O=ew[D],L=/[defgprs%]/.test(D);E=E===void 0?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function F(V){var H=B,Q=I,te,K,W;if(D==="c")Q=O(V)+Q,V="";else{V=+V;var Z=V<0||1/V<0;if(V=isNaN(V)?l:O(Math.abs(V),E),N&&(V=oY(V)),Z&&+V==0&&x!=="+"&&(Z=!1),H=(Z?x==="("?x:a:x==="-"||x==="("?"":x)+H,Q=(D==="s"?iw[8+zE/3]:"")+Q+(Z&&x==="("?")":""),L){for(te=-1,K=V.length;++te<K;)if(W=V.charCodeAt(te),48>W||W>57){Q=(W===46?r+V.slice(te+1):V.slice(te))+Q,V=V.slice(0,te);break}}}R&&!T&&(V=e(V,1/0));var J=H.length+V.length+Q.length,fe=J<w?new Array(w-J+1).join(g):"";switch(R&&T&&(V=e(fe+V,fe.length?w-Q.length:1/0),fe=""),v){case"<":V=H+V+Q+fe;break;case"=":V=H+fe+V+Q;break;case"^":V=fe.slice(0,J=fe.length>>1)+H+V+Q+fe.slice(J);break;default:V=fe+H+V+Q;break}return s(V)}return F.toString=function(){return p+""},F}function A(p,g){var v=u((p=K1(p),p.type="f",p)),x=Math.max(-8,Math.min(8,Math.floor(oA(g)/3)))*3,S=Math.pow(10,-x),T=iw[8+x/3];return function(w){return v(S*w)+T}}return{format:u,formatPrefix:A}}var vm,HE,$E;uY({thousands:",",grouping:[3],currency:["$",""]});function uY(n){return vm=lY(n),HE=vm.format,$E=vm.formatPrefix,vm}function cY(n){return Math.max(0,-oA(Math.abs(n)))}function hY(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(oA(e)/3)))*3-oA(Math.abs(n)))}function fY(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,oA(e)-oA(n))+1}function AY(n,e,t,i){var r=xQ(n,e,t),s;switch(i=K1(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(e));return i.precision==null&&!isNaN(s=hY(r,o))&&(i.precision=s),$E(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=fY(r,Math.max(Math.abs(n),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=cY(r))&&(i.precision=s-(i.type==="%")*2);break}}return HE(i)}function WE(n){var e=n.domain;return n.ticks=function(t){var i=e();return yQ(i[0],i[i.length-1],t??10)},n.tickFormat=function(t,i){var r=e();return AY(r[0],r[r.length-1],t??10,i)},n.nice=function(t){t==null&&(t=10);var i=e(),r=0,s=i.length-1,o=i[r],a=i[s],l,u,A=10;for(a<o&&(u=o,o=a,a=u,u=r,r=s,s=u);A-- >0;){if(u=Hv(o,a,t),u===l)return i[r]=o,i[s]=a,e(i);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;l=u}return n},n}function kl(){var n=tY();return n.copy=function(){return JQ(n,kl())},FE.apply(n,arguments),WE(n)}function jE(){var n=0,e=1,t=1,i=[.5],r=[0,1],s;function o(l){return l!=null&&l<=l?r[BE(i,l,0,t)]:s}function a(){var l=-1;for(i=new Array(t);++l<t;)i[l]=((l+1)*e-(l-t)*n)/(t+1);return o}return o.domain=function(l){return arguments.length?([n,e]=l,n=+n,e=+e,a()):[n,e]},o.range=function(l){return arguments.length?(t=(r=Array.from(l)).length-1,a()):r.slice()},o.invertExtent=function(l){var u=r.indexOf(l);return u<0?[NaN,NaN]:u<1?[n,i[0]]:u>=t?[i[t-1],e]:[i[u-1],i[u]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return i.slice()},o.copy=function(){return jE().domain([n,e]).range(r).unknown(s)},FE.apply(WE(o),arguments)}var Vn=1e-6,Xv=1e-12,Xn=Math.PI,$s=Xn/2,J1=Xn/4,So=Xn*2,Ki=180/Xn,pn=Xn/180,gi=Math.abs,f4=Math.atan,Ho=Math.atan2,Tn=Math.cos,ym=Math.ceil,dY=Math.exp,Qv=Math.hypot,pY=Math.log,on=Math.sin,mY=Math.sign||function(n){return n>0?1:n<0?-1:0},Vl=Math.sqrt,gY=Math.tan;function _Y(n){return n>1?0:n<-1?Xn:Math.acos(n)}function Gl(n){return n>1?$s:n<-1?-$s:Math.asin(n)}function rw(n){return(n=on(n/2))*n}function hs(){}function eg(n,e){n&&ow.hasOwnProperty(n.type)&&ow[n.type](n,e)}var sw={Feature:function(n,e){eg(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,i=-1,r=t.length;++i<r;)eg(t[i].geometry,e)}},ow={Sphere:function(n,e){e.sphere()},Point:function(n,e){n=n.coordinates,e.point(n[0],n[1],n[2])},MultiPoint:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)n=t[i],e.point(n[0],n[1],n[2])},LineString:function(n,e){Yv(n.coordinates,e,0)},MultiLineString:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)Yv(t[i],e,0)},Polygon:function(n,e){aw(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)aw(t[i],e)},GeometryCollection:function(n,e){for(var t=n.geometries,i=-1,r=t.length;++i<r;)eg(t[i],e)}};function Yv(n,e,t){var i=-1,r=n.length-t,s;for(e.lineStart();++i<r;)s=n[i],e.point(s[0],s[1],s[2]);e.lineEnd()}function aw(n,e){var t=-1,i=n.length;for(e.polygonStart();++t<i;)Yv(n[t],e,1);e.polygonEnd()}function f2(n,e){n&&sw.hasOwnProperty(n.type)?sw[n.type](n,e):eg(n,e)}var tg=new Il,lw=new Il,XE,QE,Zv,Kv,Jv,ql={point:hs,lineStart:hs,lineEnd:hs,polygonStart:function(){tg=new Il,ql.lineStart=vY,ql.lineEnd=yY},polygonEnd:function(){var n=+tg;lw.add(n<0?So+n:n),this.lineStart=this.lineEnd=this.point=hs},sphere:function(){lw.add(So)}};function vY(){ql.point=xY}function yY(){YE(XE,QE)}function xY(n,e){ql.point=YE,XE=n,QE=e,n*=pn,e*=pn,Zv=n,Kv=Tn(e=e/2+J1),Jv=on(e)}function YE(n,e){n*=pn,e*=pn,e=e/2+J1;var t=n-Zv,i=t>=0?1:-1,r=i*t,s=Tn(e),o=on(e),a=Jv*o,l=Kv*s+a*Tn(r),u=a*i*on(r);tg.add(Ho(u,l)),Zv=n,Kv=s,Jv=o}function ng(n){return[Ho(n[1],n[0]),Gl(n[2])]}function sh(n){var e=n[0],t=n[1],i=Tn(t);return[i*Tn(e),i*on(e),on(t)]}function xm(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function aA(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function p3(n,e){n[0]+=e[0],n[1]+=e[1],n[2]+=e[2]}function bm(n,e){return[n[0]*e,n[1]*e,n[2]*e]}function ig(n){var e=Vl(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=e,n[1]/=e,n[2]/=e}var Hi,qs,Yi,po,Sc,ZE,KE,Lf,V0,bu,zl,wl={point:ey,lineStart:uw,lineEnd:cw,polygonStart:function(){wl.point=e9,wl.lineStart=bY,wl.lineEnd=wY,V0=new Il,ql.polygonStart()},polygonEnd:function(){ql.polygonEnd(),wl.point=ey,wl.lineStart=uw,wl.lineEnd=cw,tg<0?(Hi=-(Yi=180),qs=-(po=90)):V0>Vn?po=90:V0<-1e-6&&(qs=-90),zl[0]=Hi,zl[1]=Yi},sphere:function(){Hi=-(Yi=180),qs=-(po=90)}};function ey(n,e){bu.push(zl=[Hi=n,Yi=n]),e<qs&&(qs=e),e>po&&(po=e)}function JE(n,e){var t=sh([n*pn,e*pn]);if(Lf){var i=aA(Lf,t),r=[i[1],-i[0],0],s=aA(r,i);ig(s),s=ng(s);var o=n-Sc,a=o>0?1:-1,l=s[0]*Ki*a,u,A=gi(o)>180;A^(a*Sc<l&&l<a*n)?(u=s[1]*Ki,u>po&&(po=u)):(l=(l+360)%360-180,A^(a*Sc<l&&l<a*n)?(u=-s[1]*Ki,u<qs&&(qs=u)):(e<qs&&(qs=e),e>po&&(po=e))),A?n<Sc?ho(Hi,n)>ho(Hi,Yi)&&(Yi=n):ho(n,Yi)>ho(Hi,Yi)&&(Hi=n):Yi>=Hi?(n<Hi&&(Hi=n),n>Yi&&(Yi=n)):n>Sc?ho(Hi,n)>ho(Hi,Yi)&&(Yi=n):ho(n,Yi)>ho(Hi,Yi)&&(Hi=n)}else bu.push(zl=[Hi=n,Yi=n]);e<qs&&(qs=e),e>po&&(po=e),Lf=t,Sc=n}function uw(){wl.point=JE}function cw(){zl[0]=Hi,zl[1]=Yi,wl.point=ey,Lf=null}function e9(n,e){if(Lf){var t=n-Sc;V0.add(gi(t)>180?t+(t>0?360:-360):t)}else ZE=n,KE=e;ql.point(n,e),JE(n,e)}function bY(){ql.lineStart()}function wY(){e9(ZE,KE),ql.lineEnd(),gi(V0)>Vn&&(Hi=-(Yi=180)),zl[0]=Hi,zl[1]=Yi,Lf=null}function ho(n,e){return(e-=n)<0?e+360:e}function SY(n,e){return n[0]-e[0]}function hw(n,e){return n[0]<=n[1]?n[0]<=e&&e<=n[1]:e<n[0]||n[1]<e}function t9(n){var e,t,i,r,s,o,a;if(po=Yi=-(Hi=qs=1/0),bu=[],f2(n,wl),t=bu.length){for(bu.sort(SY),e=1,i=bu[0],s=[i];e<t;++e)r=bu[e],hw(i,r[0])||hw(i,r[1])?(ho(i[0],r[1])>ho(i[0],i[1])&&(i[1]=r[1]),ho(r[0],i[1])>ho(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,t=s.length-1,e=0,i=s[t];e<=t;i=r,++e)r=s[e],(a=ho(i[1],r[0]))>o&&(o=a,Hi=r[0],Yi=i[1])}return bu=zl=null,Hi===1/0||qs===1/0?[[NaN,NaN],[NaN,NaN]]:[[Hi,qs],[Yi,po]]}var w0,rg,sg,og,ag,lg,ug,cg,ty,ny,iy,n9,i9,Rs,Ns,Ps,oa={sphere:hs,point:A4,lineStart:fw,lineEnd:Aw,polygonStart:function(){oa.lineStart=EY,oa.lineEnd=CY},polygonEnd:function(){oa.lineStart=fw,oa.lineEnd=Aw}};function A4(n,e){n*=pn,e*=pn;var t=Tn(e);ap(t*Tn(n),t*on(n),on(e))}function ap(n,e,t){++w0,sg+=(n-sg)/w0,og+=(e-og)/w0,ag+=(t-ag)/w0}function fw(){oa.point=TY}function TY(n,e){n*=pn,e*=pn;var t=Tn(e);Rs=t*Tn(n),Ns=t*on(n),Ps=on(e),oa.point=MY,ap(Rs,Ns,Ps)}function MY(n,e){n*=pn,e*=pn;var t=Tn(e),i=t*Tn(n),r=t*on(n),s=on(e),o=Ho(Vl((o=Ns*s-Ps*r)*o+(o=Ps*i-Rs*s)*o+(o=Rs*r-Ns*i)*o),Rs*i+Ns*r+Ps*s);rg+=o,lg+=o*(Rs+(Rs=i)),ug+=o*(Ns+(Ns=r)),cg+=o*(Ps+(Ps=s)),ap(Rs,Ns,Ps)}function Aw(){oa.point=A4}function EY(){oa.point=RY}function CY(){r9(n9,i9),oa.point=A4}function RY(n,e){n9=n,i9=e,n*=pn,e*=pn,oa.point=r9;var t=Tn(e);Rs=t*Tn(n),Ns=t*on(n),Ps=on(e),ap(Rs,Ns,Ps)}function r9(n,e){n*=pn,e*=pn;var t=Tn(e),i=t*Tn(n),r=t*on(n),s=on(e),o=Ns*s-Ps*r,a=Ps*i-Rs*s,l=Rs*r-Ns*i,u=Qv(o,a,l),A=Gl(u),p=u&&-A/u;ty.add(p*o),ny.add(p*a),iy.add(p*l),rg+=A,lg+=A*(Rs+(Rs=i)),ug+=A*(Ns+(Ns=r)),cg+=A*(Ps+(Ps=s)),ap(Rs,Ns,Ps)}function dw(n){w0=rg=sg=og=ag=lg=ug=cg=0,ty=new Il,ny=new Il,iy=new Il,f2(n,oa);var e=+ty,t=+ny,i=+iy,r=Qv(e,t,i);return r<Xv&&(e=lg,t=ug,i=cg,rg<Vn&&(e=sg,t=og,i=ag),r=Qv(e,t,i),r<Xv)?[NaN,NaN]:[Ho(t,e)*Ki,Gl(i/r)*Ki]}function ry(n,e){function t(i,r){return i=n(i,r),e(i[0],i[1])}return n.invert&&e.invert&&(t.invert=function(i,r){return i=e.invert(i,r),i&&n.invert(i[0],i[1])}),t}function sy(n,e){return gi(n)>Xn&&(n-=Math.round(n/So)*So),[n,e]}sy.invert=sy;function s9(n,e,t){return(n%=So)?e||t?ry(mw(n),gw(e,t)):mw(n):e||t?gw(e,t):sy}function pw(n){return function(e,t){return e+=n,gi(e)>Xn&&(e-=Math.round(e/So)*So),[e,t]}}function mw(n){var e=pw(n);return e.invert=pw(-n),e}function gw(n,e){var t=Tn(n),i=on(n),r=Tn(e),s=on(e);function o(a,l){var u=Tn(l),A=Tn(a)*u,p=on(a)*u,g=on(l),v=g*t+A*i;return[Ho(p*r-v*s,A*t-g*i),Gl(v*r+p*s)]}return o.invert=function(a,l){var u=Tn(l),A=Tn(a)*u,p=on(a)*u,g=on(l),v=g*r-p*s;return[Ho(p*r+g*s,A*t+v*i),Gl(v*t-A*i)]},o}function NY(n){n=s9(n[0]*pn,n[1]*pn,n.length>2?n[2]*pn:0);function e(t){return t=n(t[0]*pn,t[1]*pn),t[0]*=Ki,t[1]*=Ki,t}return e.invert=function(t){return t=n.invert(t[0]*pn,t[1]*pn),t[0]*=Ki,t[1]*=Ki,t},e}function PY(n,e,t,i,r,s){if(t){var o=Tn(e),a=on(e),l=i*t;r==null?(r=e+i*So,s=e-l/2):(r=_w(o,r),s=_w(o,s),(i>0?r<s:r>s)&&(r+=i*So));for(var u,A=r;i>0?A>s:A<s;A-=l)u=ng([o,-a*Tn(A),-a*on(A)]),n.point(u[0],u[1])}}function _w(n,e){e=sh(e),e[0]-=n,ig(e);var t=_Y(-e[1]);return((-e[2]<0?-t:t)+So-Vn)%So}function o9(){var n=[],e;return{point:function(t,i,r){e.push([t,i,r])},lineStart:function(){n.push(e=[])},lineEnd:hs,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var t=n;return n=[],e=null,t}}}function p1(n,e){return gi(n[0]-e[0])<Vn&&gi(n[1]-e[1])<Vn}function wm(n,e,t,i){this.x=n,this.z=e,this.o=t,this.e=i,this.v=!1,this.n=this.p=null}function a9(n,e,t,i,r){var s=[],o=[],a,l;if(n.forEach(function(x){if(!((S=x.length-1)<=0)){var S,T=x[0],w=x[S],R;if(p1(T,w)){if(!T[2]&&!w[2]){for(r.lineStart(),a=0;a<S;++a)r.point((T=x[a])[0],T[1]);r.lineEnd();return}w[0]+=2*Vn}s.push(R=new wm(T,x,null,!0)),o.push(R.o=new wm(T,null,R,!1)),s.push(R=new wm(w,x,null,!1)),o.push(R.o=new wm(w,null,R,!0))}}),!!s.length){for(o.sort(e),vw(s),vw(o),a=0,l=o.length;a<l;++a)o[a].e=t=!t;for(var u=s[0],A,p;;){for(var g=u,v=!0;g.v;)if((g=g.n)===u)return;A=g.z,r.lineStart();do{if(g.v=g.o.v=!0,g.e){if(v)for(a=0,l=A.length;a<l;++a)r.point((p=A[a])[0],p[1]);else i(g.x,g.n.x,1,r);g=g.n}else{if(v)for(A=g.p.z,a=A.length-1;a>=0;--a)r.point((p=A[a])[0],p[1]);else i(g.x,g.p.x,-1,r);g=g.p}g=g.o,A=g.z,v=!v}while(!g.v);r.lineEnd()}}}function vw(n){if(e=n.length){for(var e,t=0,i=n[0],r;++t<e;)i.n=r=n[t],r.p=i,i=r;i.n=r=n[0],r.p=i}}function m3(n){return gi(n[0])<=Xn?n[0]:mY(n[0])*((gi(n[0])+Xn)%So-Xn)}function l9(n,e){var t=m3(e),i=e[1],r=on(i),s=[on(t),-Tn(t),0],o=0,a=0,l=new Il;r===1?i=$s+Vn:r===-1&&(i=-$s-Vn);for(var u=0,A=n.length;u<A;++u)if(g=(p=n[u]).length)for(var p,g,v=p[g-1],x=m3(v),S=v[1]/2+J1,T=on(S),w=Tn(S),R=0;R<g;++R,x=N,T=B,w=I,v=E){var E=p[R],N=m3(E),D=E[1]/2+J1,B=on(D),I=Tn(D),O=N-x,L=O>=0?1:-1,F=L*O,V=F>Xn,H=T*B;if(l.add(Ho(H*L*on(F),w*I+H*Tn(F))),o+=V?O+L*So:O,V^x>=t^N>=t){var Q=aA(sh(v),sh(E));ig(Q);var te=aA(s,Q);ig(te);var K=(V^O>=0?-1:1)*Gl(te[2]);(i>K||i===K&&(Q[0]||Q[1]))&&(a+=V^O>=0?1:-1)}}return(o<-1e-6||o<Vn&&l<-1e-12)^a&1}function u9(n,e,t,i){return function(r){var s=e(r),o=o9(),a=e(o),l=!1,u,A,p,g={point:v,lineStart:S,lineEnd:T,polygonStart:function(){g.point=w,g.lineStart=R,g.lineEnd=E,A=[],u=[]},polygonEnd:function(){g.point=v,g.lineStart=S,g.lineEnd=T,A=Sd(A);var N=l9(u,i);A.length?(l||(r.polygonStart(),l=!0),a9(A,DY,N,t,r)):N&&(l||(r.polygonStart(),l=!0),r.lineStart(),t(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),A=u=null},sphere:function(){r.polygonStart(),r.lineStart(),t(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function v(N,D){n(N,D)&&r.point(N,D)}function x(N,D){s.point(N,D)}function S(){g.point=x,s.lineStart()}function T(){g.point=v,s.lineEnd()}function w(N,D){p.push([N,D]),a.point(N,D)}function R(){a.lineStart(),p=[]}function E(){w(p[0][0],p[0][1]),a.lineEnd();var N=a.clean(),D=o.result(),B,I=D.length,O,L,F;if(p.pop(),u.push(p),p=null,!!I){if(N&1){if(L=D[0],(O=L.length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),B=0;B<O;++B)r.point((F=L[B])[0],F[1]);r.lineEnd()}return}I>1&&N&2&&D.push(D.pop().concat(D.shift())),A.push(D.filter(LY))}}return g}}function LY(n){return n.length>1}function DY(n,e){return((n=n.x)[0]<0?n[1]-$s-Vn:$s-n[1])-((e=e.x)[0]<0?e[1]-$s-Vn:$s-e[1])}const yw=u9(function(){return!0},IY,FY,[-Xn,-$s]);function IY(n){var e=NaN,t=NaN,i=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(s,o){var a=s>0?Xn:-Xn,l=gi(s-e);gi(l-Xn)<Vn?(n.point(e,t=(t+o)/2>0?$s:-$s),n.point(i,t),n.lineEnd(),n.lineStart(),n.point(a,t),n.point(s,t),r=0):i!==a&&l>=Xn&&(gi(e-i)<Vn&&(e-=i*Vn),gi(s-a)<Vn&&(s-=a*Vn),t=BY(e,t,s,o),n.point(i,t),n.lineEnd(),n.lineStart(),n.point(a,t),r=0),n.point(e=s,t=o),i=a},lineEnd:function(){n.lineEnd(),e=t=NaN},clean:function(){return 2-r}}}function BY(n,e,t,i){var r,s,o=on(n-t);return gi(o)>Vn?f4((on(e)*(s=Tn(i))*on(t)-on(i)*(r=Tn(e))*on(n))/(r*s*o)):(e+i)/2}function FY(n,e,t,i){var r;if(n==null)r=t*$s,i.point(-Xn,r),i.point(0,r),i.point(Xn,r),i.point(Xn,0),i.point(Xn,-r),i.point(0,-r),i.point(-Xn,-r),i.point(-Xn,0),i.point(-Xn,r);else if(gi(n[0]-e[0])>Vn){var s=n[0]<e[0]?Xn:-Xn;r=t*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(e[0],e[1])}function UY(n){var e=Tn(n),t=2*pn,i=e>0,r=gi(e)>Vn;function s(A,p,g,v){PY(v,n,t,g,A,p)}function o(A,p){return Tn(A)*Tn(p)>e}function a(A){var p,g,v,x,S;return{lineStart:function(){x=v=!1,S=1},point:function(T,w){var R=[T,w],E,N=o(T,w),D=i?N?0:u(T,w):N?u(T+(T<0?Xn:-Xn),w):0;if(!p&&(x=v=N)&&A.lineStart(),N!==v&&(E=l(p,R),(!E||p1(p,E)||p1(R,E))&&(R[2]=1)),N!==v)S=0,N?(A.lineStart(),E=l(R,p),A.point(E[0],E[1])):(E=l(p,R),A.point(E[0],E[1],2),A.lineEnd()),p=E;else if(r&&p&&i^N){var B;!(D&g)&&(B=l(R,p,!0))&&(S=0,i?(A.lineStart(),A.point(B[0][0],B[0][1]),A.point(B[1][0],B[1][1]),A.lineEnd()):(A.point(B[1][0],B[1][1]),A.lineEnd(),A.lineStart(),A.point(B[0][0],B[0][1],3)))}N&&(!p||!p1(p,R))&&A.point(R[0],R[1]),p=R,v=N,g=D},lineEnd:function(){v&&A.lineEnd(),p=null},clean:function(){return S|(x&&v)<<1}}}function l(A,p,g){var v=sh(A),x=sh(p),S=[1,0,0],T=aA(v,x),w=xm(T,T),R=T[0],E=w-R*R;if(!E)return!g&&A;var N=e*w/E,D=-e*R/E,B=aA(S,T),I=bm(S,N),O=bm(T,D);p3(I,O);var L=B,F=xm(I,L),V=xm(L,L),H=F*F-V*(xm(I,I)-1);if(!(H<0)){var Q=Vl(H),te=bm(L,(-F-Q)/V);if(p3(te,I),te=ng(te),!g)return te;var K=A[0],W=p[0],Z=A[1],J=p[1],fe;W<K&&(fe=K,K=W,W=fe);var ge=W-K,pe=gi(ge-Xn)<Vn,Ae=pe||ge<Vn;if(!pe&&J<Z&&(fe=Z,Z=J,J=fe),Ae?pe?Z+J>0^te[1]<(gi(te[0]-K)<Vn?Z:J):Z<=te[1]&&te[1]<=J:ge>Xn^(K<=te[0]&&te[0]<=W)){var Fe=bm(L,(-F+Q)/V);return p3(Fe,I),[te,ng(Fe)]}}}function u(A,p){var g=i?n:Xn-n,v=0;return A<-g?v|=1:A>g&&(v|=2),p<-g?v|=4:p>g&&(v|=8),v}return u9(o,a,s,i?[0,-n]:[-Xn,n-Xn])}function OY(n,e,t,i,r,s){var o=n[0],a=n[1],l=e[0],u=e[1],A=0,p=1,g=l-o,v=u-a,x;if(x=t-o,!(!g&&x>0)){if(x/=g,g<0){if(x<A)return;x<p&&(p=x)}else if(g>0){if(x>p)return;x>A&&(A=x)}if(x=r-o,!(!g&&x<0)){if(x/=g,g<0){if(x>p)return;x>A&&(A=x)}else if(g>0){if(x<A)return;x<p&&(p=x)}if(x=i-a,!(!v&&x>0)){if(x/=v,v<0){if(x<A)return;x<p&&(p=x)}else if(v>0){if(x>p)return;x>A&&(A=x)}if(x=s-a,!(!v&&x<0)){if(x/=v,v<0){if(x>p)return;x>A&&(A=x)}else if(v>0){if(x<A)return;x<p&&(p=x)}return A>0&&(n[0]=o+A*g,n[1]=a+A*v),p<1&&(e[0]=o+p*g,e[1]=a+p*v),!0}}}}}var Sm=1e9,Tm=-1e9;function kY(n,e,t,i){function r(u,A){return n<=u&&u<=t&&e<=A&&A<=i}function s(u,A,p,g){var v=0,x=0;if(u==null||(v=o(u,p))!==(x=o(A,p))||l(u,A)<0^p>0)do g.point(v===0||v===3?n:t,v>1?i:e);while((v=(v+p+4)%4)!==x);else g.point(A[0],A[1])}function o(u,A){return gi(u[0]-n)<Vn?A>0?0:3:gi(u[0]-t)<Vn?A>0?2:1:gi(u[1]-e)<Vn?A>0?1:0:A>0?3:2}function a(u,A){return l(u.x,A.x)}function l(u,A){var p=o(u,1),g=o(A,1);return p!==g?p-g:p===0?A[1]-u[1]:p===1?u[0]-A[0]:p===2?u[1]-A[1]:A[0]-u[0]}return function(u){var A=u,p=o9(),g,v,x,S,T,w,R,E,N,D,B,I={point:O,lineStart:H,lineEnd:Q,polygonStart:F,polygonEnd:V};function O(K,W){r(K,W)&&A.point(K,W)}function L(){for(var K=0,W=0,Z=v.length;W<Z;++W)for(var J=v[W],fe=1,ge=J.length,pe=J[0],Ae,Fe,be=pe[0],Ve=pe[1];fe<ge;++fe)Ae=be,Fe=Ve,pe=J[fe],be=pe[0],Ve=pe[1],Fe<=i?Ve>i&&(be-Ae)*(i-Fe)>(Ve-Fe)*(n-Ae)&&++K:Ve<=i&&(be-Ae)*(i-Fe)<(Ve-Fe)*(n-Ae)&&--K;return K}function F(){A=p,g=[],v=[],B=!0}function V(){var K=L(),W=B&&K,Z=(g=Sd(g)).length;(W||Z)&&(u.polygonStart(),W&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),Z&&a9(g,a,K,s,u),u.polygonEnd()),A=u,g=v=x=null}function H(){I.point=te,v&&v.push(x=[]),D=!0,N=!1,R=E=NaN}function Q(){g&&(te(S,T),w&&N&&p.rejoin(),g.push(p.result())),I.point=O,N&&A.lineEnd()}function te(K,W){var Z=r(K,W);if(v&&x.push([K,W]),D)S=K,T=W,w=Z,D=!1,Z&&(A.lineStart(),A.point(K,W));else if(Z&&N)A.point(K,W);else{var J=[R=Math.max(Tm,Math.min(Sm,R)),E=Math.max(Tm,Math.min(Sm,E))],fe=[K=Math.max(Tm,Math.min(Sm,K)),W=Math.max(Tm,Math.min(Sm,W))];OY(J,fe,n,e,t,i)?(N||(A.lineStart(),A.point(J[0],J[1])),A.point(fe[0],fe[1]),Z||A.lineEnd(),B=!1):Z&&(A.lineStart(),A.point(K,W),B=!1)}R=K,E=W,N=Z}return I}}var oy,ay,m1,g1,lA={sphere:hs,point:hs,lineStart:VY,lineEnd:hs,polygonStart:hs,polygonEnd:hs};function VY(){lA.point=qY,lA.lineEnd=GY}function GY(){lA.point=lA.lineEnd=hs}function qY(n,e){n*=pn,e*=pn,ay=n,m1=on(e),g1=Tn(e),lA.point=zY}function zY(n,e){n*=pn,e*=pn;var t=on(e),i=Tn(e),r=gi(n-ay),s=Tn(r),o=on(r),a=i*o,l=g1*t-m1*i*s,u=m1*t+g1*i*s;oy.add(Ho(Vl(a*a+l*l),u)),ay=n,m1=t,g1=i}function HY(n){return oy=new Il,f2(n,lA),+oy}var ly=[null,null],$Y={type:"LineString",coordinates:ly};function ku(n,e){return ly[0]=n,ly[1]=e,HY($Y)}var xw={Feature:function(n,e){return hg(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,i=-1,r=t.length;++i<r;)if(hg(t[i].geometry,e))return!0;return!1}},bw={Sphere:function(){return!0},Point:function(n,e){return ww(n.coordinates,e)},MultiPoint:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)if(ww(t[i],e))return!0;return!1},LineString:function(n,e){return Sw(n.coordinates,e)},MultiLineString:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)if(Sw(t[i],e))return!0;return!1},Polygon:function(n,e){return Tw(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)if(Tw(t[i],e))return!0;return!1},GeometryCollection:function(n,e){for(var t=n.geometries,i=-1,r=t.length;++i<r;)if(hg(t[i],e))return!0;return!1}};function hg(n,e){return n&&bw.hasOwnProperty(n.type)?bw[n.type](n,e):!1}function ww(n,e){return ku(n,e)===0}function Sw(n,e){for(var t,i,r,s=0,o=n.length;s<o;s++){if(i=ku(n[s],e),i===0||s>0&&(r=ku(n[s],n[s-1]),r>0&&t<=r&&i<=r&&(t+i-r)*(1-Math.pow((t-i)/r,2))<Xv*r))return!0;t=i}return!1}function Tw(n,e){return!!l9(n.map(WY),c9(e))}function WY(n){return n=n.map(c9),n.pop(),n}function c9(n){return[n[0]*pn,n[1]*pn]}function jY(n,e){return(n&&xw.hasOwnProperty(n.type)?xw[n.type]:hg)(n,e)}function Mw(n,e,t){var i=ff(n,e-Vn,t).concat(e);return function(r){return i.map(function(s){return[r,s]})}}function Ew(n,e,t){var i=ff(n,e-Vn,t).concat(e);return function(r){return i.map(function(s){return[s,r]})}}function XY(){var n,e,t,i,r,s,o,a,l=10,u=l,A=90,p=360,g,v,x,S,T=2.5;function w(){return{type:"MultiLineString",coordinates:R()}}function R(){return ff(ym(i/A)*A,t,A).map(x).concat(ff(ym(a/p)*p,o,p).map(S)).concat(ff(ym(e/l)*l,n,l).filter(function(E){return gi(E%A)>Vn}).map(g)).concat(ff(ym(s/u)*u,r,u).filter(function(E){return gi(E%p)>Vn}).map(v))}return w.lines=function(){return R().map(function(E){return{type:"LineString",coordinates:E}})},w.outline=function(){return{type:"Polygon",coordinates:[x(i).concat(S(o).slice(1),x(t).reverse().slice(1),S(a).reverse().slice(1))]}},w.extent=function(E){return arguments.length?w.extentMajor(E).extentMinor(E):w.extentMinor()},w.extentMajor=function(E){return arguments.length?(i=+E[0][0],t=+E[1][0],a=+E[0][1],o=+E[1][1],i>t&&(E=i,i=t,t=E),a>o&&(E=a,a=o,o=E),w.precision(T)):[[i,a],[t,o]]},w.extentMinor=function(E){return arguments.length?(e=+E[0][0],n=+E[1][0],s=+E[0][1],r=+E[1][1],e>n&&(E=e,e=n,n=E),s>r&&(E=s,s=r,r=E),w.precision(T)):[[e,s],[n,r]]},w.step=function(E){return arguments.length?w.stepMajor(E).stepMinor(E):w.stepMinor()},w.stepMajor=function(E){return arguments.length?(A=+E[0],p=+E[1],w):[A,p]},w.stepMinor=function(E){return arguments.length?(l=+E[0],u=+E[1],w):[l,u]},w.precision=function(E){return arguments.length?(T=+E,g=Mw(s,r,90),v=Ew(e,n,T),x=Mw(a,o,90),S=Ew(i,t,T),w):T},w.extentMajor([[-180,-90+Vn],[180,90-Vn]]).extentMinor([[-180,-80-Vn],[180,80+Vn]])}function QY(){return XY()()}function d4(n,e){var t=n[0]*pn,i=n[1]*pn,r=e[0]*pn,s=e[1]*pn,o=Tn(i),a=on(i),l=Tn(s),u=on(s),A=o*Tn(t),p=o*on(t),g=l*Tn(r),v=l*on(r),x=2*Gl(Vl(rw(s-i)+o*l*rw(r-t))),S=on(x),T=x?function(w){var R=on(w*=x)/S,E=on(x-w)/S,N=E*A+R*g,D=E*p+R*v,B=E*a+R*u;return[Ho(D,N)*Ki,Ho(B,Vl(N*N+D*D))*Ki]}:function(){return[t*Ki,i*Ki]};return T.distance=x,T}const Cw=n=>n;var uA=1/0,fg=uA,Cd=-uA,Ag=Cd,Rw={point:YY,lineStart:hs,lineEnd:hs,polygonStart:hs,polygonEnd:hs,result:function(){var n=[[uA,fg],[Cd,Ag]];return Cd=Ag=-(fg=uA=1/0),n}};function YY(n,e){n<uA&&(uA=n),n>Cd&&(Cd=n),e<fg&&(fg=e),e>Ag&&(Ag=e)}function p4(n){return function(e){var t=new uy;for(var i in n)t[i]=n[i];return t.stream=e,t}}function uy(){}uy.prototype={constructor:uy,point:function(n,e){this.stream.point(n,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function m4(n,e,t){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),i!=null&&n.clipExtent(null),f2(t,n.stream(Rw)),e(Rw.result()),i!=null&&n.clipExtent(i),n}function h9(n,e,t){return m4(n,function(i){var r=e[1][0]-e[0][0],s=e[1][1]-e[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+e[0][0]+(r-o*(i[1][0]+i[0][0]))/2,l=+e[0][1]+(s-o*(i[1][1]+i[0][1]))/2;n.scale(150*o).translate([a,l])},t)}function ZY(n,e,t){return h9(n,[[0,0],e],t)}function KY(n,e,t){return m4(n,function(i){var r=+e,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];n.scale(150*s).translate([o,a])},t)}function JY(n,e,t){return m4(n,function(i){var r=+e,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;n.scale(150*s).translate([o,a])},t)}var Nw=16,eZ=Tn(30*pn);function Pw(n,e){return+e?nZ(n,e):tZ(n)}function tZ(n){return p4({point:function(e,t){e=n(e,t),this.stream.point(e[0],e[1])}})}function nZ(n,e){function t(i,r,s,o,a,l,u,A,p,g,v,x,S,T){var w=u-i,R=A-r,E=w*w+R*R;if(E>4*e&&S--){var N=o+g,D=a+v,B=l+x,I=Vl(N*N+D*D+B*B),O=Gl(B/=I),L=gi(gi(B)-1)<Vn||gi(s-p)<Vn?(s+p)/2:Ho(D,N),F=n(L,O),V=F[0],H=F[1],Q=V-i,te=H-r,K=R*Q-w*te;(K*K/E>e||gi((w*Q+R*te)/E-.5)>.3||o*g+a*v+l*x<eZ)&&(t(i,r,s,o,a,l,V,H,L,N/=I,D/=I,B,S,T),T.point(V,H),t(V,H,L,N,D,B,u,A,p,g,v,x,S,T))}}return function(i){var r,s,o,a,l,u,A,p,g,v,x,S,T={point:w,lineStart:R,lineEnd:N,polygonStart:function(){i.polygonStart(),T.lineStart=D},polygonEnd:function(){i.polygonEnd(),T.lineStart=R}};function w(O,L){O=n(O,L),i.point(O[0],O[1])}function R(){p=NaN,T.point=E,i.lineStart()}function E(O,L){var F=sh([O,L]),V=n(O,L);t(p,g,A,v,x,S,p=V[0],g=V[1],A=O,v=F[0],x=F[1],S=F[2],Nw,i),i.point(p,g)}function N(){T.point=w,i.lineEnd()}function D(){R(),T.point=B,T.lineEnd=I}function B(O,L){E(r=O,L),s=p,o=g,a=v,l=x,u=S,T.point=E}function I(){t(p,g,A,v,x,S,s,o,r,a,l,u,Nw,i),T.lineEnd=N,N()}return T}}var iZ=p4({point:function(n,e){this.stream.point(n*pn,e*pn)}});function rZ(n){return p4({point:function(e,t){var i=n(e,t);return this.stream.point(i[0],i[1])}})}function sZ(n,e,t,i,r){function s(o,a){return o*=i,a*=r,[e+n*o,t-n*a]}return s.invert=function(o,a){return[(o-e)/n*i,(t-a)/n*r]},s}function Lw(n,e,t,i,r,s){if(!s)return sZ(n,e,t,i,r);var o=Tn(s),a=on(s),l=o*n,u=a*n,A=o/n,p=a/n,g=(a*t-o*e)/n,v=(a*e+o*t)/n;function x(S,T){return S*=i,T*=r,[l*S-u*T+e,t-u*S-l*T]}return x.invert=function(S,T){return[i*(A*S-p*T+g),r*(v-p*S-A*T)]},x}function oZ(n){return aZ(function(){return n})()}function aZ(n){var e,t=150,i=480,r=250,s=0,o=0,a=0,l=0,u=0,A,p=0,g=1,v=1,x=null,S=yw,T=null,w,R,E,N=Cw,D=.5,B,I,O,L,F;function V(K){return O(K[0]*pn,K[1]*pn)}function H(K){return K=O.invert(K[0],K[1]),K&&[K[0]*Ki,K[1]*Ki]}V.stream=function(K){return L&&F===K?L:L=iZ(rZ(A)(S(B(N(F=K)))))},V.preclip=function(K){return arguments.length?(S=K,x=void 0,te()):S},V.postclip=function(K){return arguments.length?(N=K,T=w=R=E=null,te()):N},V.clipAngle=function(K){return arguments.length?(S=+K?UY(x=K*pn):(x=null,yw),te()):x*Ki},V.clipExtent=function(K){return arguments.length?(N=K==null?(T=w=R=E=null,Cw):kY(T=+K[0][0],w=+K[0][1],R=+K[1][0],E=+K[1][1]),te()):T==null?null:[[T,w],[R,E]]},V.scale=function(K){return arguments.length?(t=+K,Q()):t},V.translate=function(K){return arguments.length?(i=+K[0],r=+K[1],Q()):[i,r]},V.center=function(K){return arguments.length?(s=K[0]%360*pn,o=K[1]%360*pn,Q()):[s*Ki,o*Ki]},V.rotate=function(K){return arguments.length?(a=K[0]%360*pn,l=K[1]%360*pn,u=K.length>2?K[2]%360*pn:0,Q()):[a*Ki,l*Ki,u*Ki]},V.angle=function(K){return arguments.length?(p=K%360*pn,Q()):p*Ki},V.reflectX=function(K){return arguments.length?(g=K?-1:1,Q()):g<0},V.reflectY=function(K){return arguments.length?(v=K?-1:1,Q()):v<0},V.precision=function(K){return arguments.length?(B=Pw(I,D=K*K),te()):Vl(D)},V.fitExtent=function(K,W){return h9(V,K,W)},V.fitSize=function(K,W){return ZY(V,K,W)},V.fitWidth=function(K,W){return KY(V,K,W)},V.fitHeight=function(K,W){return JY(V,K,W)};function Q(){var K=Lw(t,0,0,g,v,p).apply(null,e(s,o)),W=Lw(t,i-K[0],r-K[1],g,v,p);return A=s9(a,l,u),I=ry(e,W),O=ry(A,I),B=Pw(I,D),te()}function te(){return L=F=null,V}return function(){return e=n.apply(this,arguments),V.invert=e.invert&&H,Q()}}function lZ(n){return function(e,t){var i=Vl(e*e+t*t),r=n(i),s=on(r),o=Tn(r);return[Ho(e*s,i*o),Gl(i&&t*s/i)]}}function g4(n,e){return[n,pY(gY(($s+e)/2))]}g4.invert=function(n,e){return[n,2*f4(dY(e))-$s]};function f9(n,e){var t=Tn(e),i=1+Tn(n)*t;return[t*on(n)/i,on(e)/i]}f9.invert=lZ(function(n){return 2*f4(n)});function uZ(){return oZ(f9).scale(250).clipAngle(142)}function cy(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function cZ(n){if(Array.isArray(n))return n}function hZ(n){if(Array.isArray(n))return cy(n)}function G0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function fZ(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function AZ(n,e,t){return e=dg(e),wZ(n,d9()?Reflect.construct(e,[],dg(n).constructor):e.apply(n,t))}function A9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dZ(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Bn(n,e){return n.get(G0(n,e))}function Au(n,e,t){A9(n,e),e.set(n,t)}function du(n,e,t){return n.set(G0(n,e),t),t}function pZ(n,e){A9(n,e),e.add(n)}function mZ(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,m9(i.key),i)}}function gZ(n,e,t){return mZ(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function zh(n,e,t){return(e=m9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dg(n){return dg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dg(n)}function _Z(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&hy(n,e)}function d9(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(d9=function(){return!!n})()}function vZ(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function yZ(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function xZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wZ(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fZ(n)}function hy(n,e){return hy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},hy(n,e)}function _1(n,e){return cZ(n)||yZ(n,e)||g9(n,e)||xZ()}function p9(n){return hZ(n)||vZ(n)||g9(n)||bZ()}function SZ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function m9(n){var e=SZ(n,"string");return typeof e=="symbol"?e:e+""}function g9(n,e){if(n){if(typeof n=="string")return cy(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?cy(n,e):void 0}}var _9=function(e){e instanceof Array?e.forEach(_9):(e.map&&e.map.dispose(),e.dispose())},v9=function(e){e.geometry&&e.geometry.dispose(),e.material&&_9(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(v9)},Dw=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),v9(t)}};function y9(n,e,t){var i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180;return{x:t*Math.sin(i)*Math.cos(r),y:t*Math.cos(i),z:t*Math.sin(i)*Math.sin(r)}}function TZ(n){var e=n.x,t=n.y,i=n.z,r=Math.sqrt(e*e+t*t+i*i),s=Math.acos(t/r),o=Math.atan2(i,e);return{lat:90-s*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),r}}function hc(n){return n*Math.PI/180}var x9=function(e){return 1-(g4(0,(.5-e)*Math.PI)[1]/Math.PI+1)/2},g3=function(e){return Math.max(0,Math.min(1,x9(e)))},Iw=function(e){return .5-g4.invert(0,(2*(1-e)-1)*Math.PI)[1]/Math.PI},MZ=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=kl().domain([1,0]).range([t,i]).clamp(!0),s=kl().domain([g3(t),g3(i)]).range([1,0]).clamp(!0),o=function(p){return s(g3(r(p)))},a=e.array,l=0,u=a.length;l<u;l+=2)a[l+1]=o(a[l+1]);e.needsUpdate=!0},Bw=function(e,t,i,r){var s=Math.pow(2,e),o=Math.max(0,Math.min(s-1,Math.floor((i+180)*s/360))),a=(90-r)/180;t&&(a=Math.max(0,Math.min(1,x9(a))));var l=Math.floor(a*s);return[o,l]},fy=function(e,t){for(var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=[],l=Math.pow(2,e),u=360/l,A=180/l,p=s===void 0?l-1:s,g=o===void 0?l-1:o,v=i,x=Math.min(l-1,p);v<=x;v++)for(var S=r,T=Math.min(l-1,g);S<=T;S++){var w=S,R=A;if(t){w=S===0?S:Iw(S/l)*l;var E=S+1===l?S+1:Iw((S+1)/l)*l;R=(E-w)*180/l}var N=-180+(v+.5)*u,D=90-(w*180/l+R/2),B=R;a.push({x:v,y:S,lng:N,lat:D,latLen:B})}return a},EZ=6,CZ=7,RZ=3,NZ=90,Oa=new WeakMap,Su=new WeakMap,_3=new WeakMap,Mm=new WeakMap,Po=new WeakMap,pg=new WeakMap,Df=new WeakMap,fc=new WeakMap,Em=new WeakSet,PZ=function(n){function e(t){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.tileUrl,o=r.minLevel,a=o===void 0?0:o,l=r.maxLevel,u=l===void 0?17:l,A=r.mercatorProjection,p=A===void 0?!0:A;return dZ(this,e),i=AZ(this,e),pZ(i,Em),Au(i,Oa,void 0),Au(i,Su,void 0),Au(i,_3,void 0),Au(i,Mm,void 0),Au(i,Po,{}),Au(i,pg,void 0),Au(i,Df,void 0),Au(i,fc,void 0),zh(i,"minLevel",void 0),zh(i,"maxLevel",void 0),zh(i,"thresholds",p9(new Array(30)).map(function(g,v){return 8/Math.pow(2,v)})),zh(i,"curvatureResolution",5),zh(i,"tileMargin",0),zh(i,"clearTiles",function(){Object.values(Bn(Po,i)).forEach(function(g){g.forEach(function(v){v.obj&&(i.remove(v.obj),Dw(v.obj),delete v.obj)})}),du(Po,i,{})}),du(Oa,i,t),i.tileUrl=s,du(Su,i,p),i.minLevel=a,i.maxLevel=u,i.level=0,i.add(du(fc,i,new Jn(new al(Bn(Oa,i)*.99,180,90),new ia({color:0})))),Bn(fc,i).visible=!1,Bn(fc,i).material.polygonOffset=!0,Bn(fc,i).material.polygonOffsetUnits=3,Bn(fc,i).material.polygonOffsetFactor=1,i}return _Z(e,n),gZ(e,[{key:"tileUrl",get:function(){return Bn(_3,this)},set:function(i){du(_3,this,i),this.updatePov(Bn(Df,this))}},{key:"level",get:function(){return Bn(Mm,this)},set:function(i){var r=this;Bn(Po,this)[i]||G0(Em,this,LZ).call(this,i);var s=Bn(Mm,this);if(du(Mm,this,i),!(i===s||s===void 0)){if(Bn(fc,this).visible=i>0,Bn(Po,this)[i].forEach(function(a){return a.obj&&(a.obj.material.depthWrite=!0)}),s<i&&Bn(Po,this)[s].forEach(function(a){return a.obj&&(a.obj.material.depthWrite=!1)}),s>i)for(var o=i+1;o<=s;o++)Bn(Po,this)[o]&&Bn(Po,this)[o].forEach(function(a){a.obj&&(r.remove(a.obj),Dw(a.obj),delete a.obj)});G0(Em,this,Fw).call(this)}}},{key:"updatePov",value:function(i){var r=this;if(!(!i||!(i instanceof rp))){du(Df,this,i);var s;if(du(pg,this,function(A){if(!A.hullPnts){var p=360/Math.pow(2,r.level),g=A.lng,v=A.lat,x=A.latLen,S=g-p/2,T=g+p/2,w=v-x/2,R=v+x/2;A.hullPnts=[[v,g],[w,S],[R,S],[w,T],[R,T]].map(function(E){var N=_1(E,2),D=N[0],B=N[1];return y9(D,B,Bn(Oa,r))}).map(function(E){var N=E.x,D=E.y,B=E.z;return new ie(N,D,B)})}return s||(s=new wA,i.updateMatrix(),i.updateMatrixWorld(),s.setFromProjectionMatrix(new en().multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse))),A.hullPnts.some(function(E){return s.containsPoint(E.clone().applyMatrix4(r.matrixWorld))})}),this.tileUrl){var o=i.position.clone(),a=o.distanceTo(this.getWorldPosition(new ie)),l=(a-Bn(Oa,this))/Bn(Oa,this),u=this.thresholds.findIndex(function(A){return A&&A<=l});this.level=Math.min(this.maxLevel,Math.max(this.minLevel,u<0?this.thresholds.length:u)),G0(Em,this,Fw).call(this)}}}}])}(Bs);function LZ(n){var e=this;if(n>CZ){Bn(Po,this)[n]=[];return}var t=Bn(Po,this)[n]=fy(n,Bn(Su,this));t.forEach(function(i){return i.centroid=y9(i.lat,i.lng,Bn(Oa,e))}),t.octree=DE().x(function(i){return i.centroid.x}).y(function(i){return i.centroid.y}).z(function(i){return i.centroid.z}).addAll(t)}function Fw(){var n=this;if(!(!this.tileUrl||this.level===void 0||!Bn(Po,this).hasOwnProperty(this.level))&&!(!Bn(pg,this)&&this.level>EZ)){var e=Bn(Po,this)[this.level];if(Bn(Df,this)){var t=this.worldToLocal(Bn(Df,this).position.clone());if(e.octree){var i,r=this.worldToLocal(Bn(Df,this).position.clone()),s=(r.length()-Bn(Oa,this))*RZ;e=(i=e.octree).findAllWithinRadius.apply(i,p9(r).concat([s]))}else{var o=TZ(t),a=(o.r/Bn(Oa,this)-1)*NZ,l=a/Math.cos(hc(o.lat)),u=[o.lng-l,o.lng+l],A=[o.lat+a,o.lat-a],p=Bw(this.level,Bn(Su,this),u[0],A[0]),g=_1(p,2),v=g[0],x=g[1],S=Bw(this.level,Bn(Su,this),u[1],A[1]),T=_1(S,2),w=T[0],R=T[1];!e.record&&(e.record={});var E=e.record;if(!E.hasOwnProperty("".concat(Math.round((v+w)/2),"_").concat(Math.round((x+R)/2))))e=fy(this.level,Bn(Su,this),v,x,w,R).map(function(O){var L="".concat(O.x,"_").concat(O.y);return E.hasOwnProperty(L)?E[L]:(E[L]=O,e.push(O),O)});else{for(var N=[],D=v;D<=w;D++)for(var B=x;B<=R;B++){var I="".concat(D,"_").concat(B);E.hasOwnProperty(I)||(E[I]=fy(this.level,Bn(Su,this),D,B,D,B)[0],e.push(E[I])),N.push(E[I])}e=N}}}e.filter(function(O){return!O.obj}).filter(Bn(pg,this)||function(){return!0}).forEach(function(O){var L=O.x,F=O.y,V=O.lng,H=O.lat,Q=O.latLen,te=360/Math.pow(2,n.level);if(!O.obj){var K=te*(1-n.tileMargin),W=Q*(1-n.tileMargin),Z=hc(V),J=hc(-H),fe=new Jn(new al(Bn(Oa,n),Math.ceil(K/n.curvatureResolution),Math.ceil(W/n.curvatureResolution),hc(90-K/2)+Z,hc(K),hc(90-W/2)+J,hc(W)),new ll);if(Bn(Su,n)){var ge=[H+Q/2,H-Q/2].map(function(be){return .5-be/180}),pe=_1(ge,2),Ae=pe[0],Fe=pe[1];MZ(fe.geometry.attributes.uv,Ae,Fe)}O.obj=fe}O.loading||(O.loading=!0,new _E().load(n.tileUrl(L,F,n.level),function(be){var Ve=O.obj;Ve&&(be.colorSpace=Ht,Ve.material.map=be,Ve.material.color=null,Ve.material.needsUpdate=!0,n.add(Ve)),O.loading=!1}))})}}function DZ(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=b9(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u;if(i&&(s=OZ(n,e,s,t)),n.length>80*t){a=1/0,l=1/0;let A=-1/0,p=-1/0;for(let g=t;g<r;g+=t){const v=n[g],x=n[g+1];v<a&&(a=v),x<l&&(l=x),v>A&&(A=v),x>p&&(p=x)}u=Math.max(A-a,p-l),u=u!==0?32767/u:0}return Rd(s,o,t,a,l,u,0),o}function b9(n,e,t,i,r){let s;if(r===QZ(n,e,t,i)>0)for(let o=e;o<t;o+=i)s=Uw(o/i|0,n[o],n[o+1],s);else for(let o=t-i;o>=e;o-=i)s=Uw(o/i|0,n[o],n[o+1],s);return s&&cA(s,s.next)&&(Pd(s),s=s.next),s}function oh(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(cA(t,t.next)||Wi(t.prev,t,t.next)===0)){if(Pd(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Rd(n,e,t,i,r,s,o){if(!n)return;!o&&s&&zZ(n,i,r,s);let a=n;for(;n.prev!==n.next;){const l=n.prev,u=n.next;if(s?BZ(n,i,r,s):IZ(n)){e.push(l.i,n.i,u.i),Pd(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=FZ(oh(n),e),Rd(n,e,t,i,r,s,2)):o===2&&UZ(n,e,t,i,r,s):Rd(oh(n),e,t,i,r,s,1);break}}}function IZ(n){const e=n.prev,t=n,i=n.next;if(Wi(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,A=Math.min(r,s,o),p=Math.min(a,l,u),g=Math.max(r,s,o),v=Math.max(a,l,u);let x=i.next;for(;x!==e;){if(x.x>=A&&x.x<=g&&x.y>=p&&x.y<=v&&S0(r,a,s,l,o,u,x.x,x.y)&&Wi(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function BZ(n,e,t,i){const r=n.prev,s=n,o=n.next;if(Wi(r,s,o)>=0)return!1;const a=r.x,l=s.x,u=o.x,A=r.y,p=s.y,g=o.y,v=Math.min(a,l,u),x=Math.min(A,p,g),S=Math.max(a,l,u),T=Math.max(A,p,g),w=Ay(v,x,e,t,i),R=Ay(S,T,e,t,i);let E=n.prevZ,N=n.nextZ;for(;E&&E.z>=w&&N&&N.z<=R;){if(E.x>=v&&E.x<=S&&E.y>=x&&E.y<=T&&E!==r&&E!==o&&S0(a,A,l,p,u,g,E.x,E.y)&&Wi(E.prev,E,E.next)>=0||(E=E.prevZ,N.x>=v&&N.x<=S&&N.y>=x&&N.y<=T&&N!==r&&N!==o&&S0(a,A,l,p,u,g,N.x,N.y)&&Wi(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;E&&E.z>=w;){if(E.x>=v&&E.x<=S&&E.y>=x&&E.y<=T&&E!==r&&E!==o&&S0(a,A,l,p,u,g,E.x,E.y)&&Wi(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;N&&N.z<=R;){if(N.x>=v&&N.x<=S&&N.y>=x&&N.y<=T&&N!==r&&N!==o&&S0(a,A,l,p,u,g,N.x,N.y)&&Wi(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function FZ(n,e){let t=n;do{const i=t.prev,r=t.next.next;!cA(i,r)&&S9(i,t,t.next,r)&&Nd(i,r)&&Nd(r,i)&&(e.push(i.i,t.i,r.i),Pd(t),Pd(t.next),t=n=r),t=t.next}while(t!==n);return oh(t)}function UZ(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&WZ(o,a)){let l=T9(o,a);o=oh(o,o.next),l=oh(l,l.next),Rd(o,e,t,i,r,s,0),Rd(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function OZ(n,e,t,i){const r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,u=b9(n,a,l,i,!1);u===u.next&&(u.steiner=!0),r.push($Z(u))}r.sort(kZ);for(let s=0;s<r.length;s++)t=VZ(r[s],t);return t}function kZ(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const i=(n.next.y-n.y)/(n.next.x-n.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=i-r}return t}function VZ(n,e){const t=GZ(n,e);if(!t)return e;const i=T9(t,n);return oh(i,i.next),oh(t,t.next)}function GZ(n,e){let t=e;const i=n.x,r=n.y;let s=-1/0,o;if(cA(n,t))return t;do{if(cA(n,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const p=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=i&&p>s&&(s=p,o=t.x<t.next.x?t:t.next,p===i))return o}t=t.next}while(t!==e);if(!o)return null;const a=o,l=o.x,u=o.y;let A=1/0;t=o;do{if(i>=t.x&&t.x>=l&&i!==t.x&&w9(r<u?i:s,r,l,u,r<u?s:i,r,t.x,t.y)){const p=Math.abs(r-t.y)/(i-t.x);Nd(t,n)&&(p<A||p===A&&(t.x>o.x||t.x===o.x&&qZ(o,t)))&&(o=t,A=p)}t=t.next}while(t!==a);return o}function qZ(n,e){return Wi(n.prev,n,e.prev)<0&&Wi(e.next,n,n.next)<0}function zZ(n,e,t,i){let r=n;do r.z===0&&(r.z=Ay(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,HZ(r)}function HZ(n){let e,t=1;do{let i=n,r;n=null;let s=null;for(e=0;i;){e++;let o=i,a=0;for(let u=0;u<t&&(a++,o=o.nextZ,!!o);u++);let l=t;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||i.z<=o.z)?(r=i,i=i.nextZ,a--):(r=o,o=o.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;i=o}s.nextZ=null,t*=2}while(e>1);return n}function Ay(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function $Z(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function w9(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function S0(n,e,t,i,r,s,o,a){return!(n===o&&e===a)&&w9(n,e,t,i,r,s,o,a)}function WZ(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!jZ(n,e)&&(Nd(n,e)&&Nd(e,n)&&XZ(n,e)&&(Wi(n.prev,n,e.prev)||Wi(n,e.prev,e))||cA(n,e)&&Wi(n.prev,n,n.next)>0&&Wi(e.prev,e,e.next)>0)}function Wi(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function cA(n,e){return n.x===e.x&&n.y===e.y}function S9(n,e,t,i){const r=Rm(Wi(n,e,t)),s=Rm(Wi(n,e,i)),o=Rm(Wi(t,i,n)),a=Rm(Wi(t,i,e));return!!(r!==s&&o!==a||r===0&&Cm(n,t,e)||s===0&&Cm(n,i,e)||o===0&&Cm(t,n,i)||a===0&&Cm(t,e,i))}function Cm(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Rm(n){return n>0?1:n<0?-1:0}function jZ(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&S9(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Nd(n,e){return Wi(n.prev,n,n.next)<0?Wi(n,e,n.next)>=0&&Wi(n,n.prev,e)>=0:Wi(n,e,n.prev)<0||Wi(n,n.next,e)<0}function XZ(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function T9(n,e){const t=dy(n.i,n.x,n.y),i=dy(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function Uw(n,e,t,i){const r=dy(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Pd(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function dy(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function QZ(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}function mg(n){const e=[],t=[],i=n[0][0].length;let r=0,s=0;for(const o of n){for(const a of o)for(let l=0;l<i;l++)e.push(a[l]);s&&(r+=s,t.push(r)),s=o.length}return{vertices:e,holes:t,dimensions:i}}function py(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function YZ(n){if(Array.isArray(n))return n}function ZZ(n){if(Array.isArray(n))return py(n)}function KZ(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function JZ(n,e,t){return e=gg(e),lK(n,M9()?Reflect.construct(e,[],gg(n).constructor):e.apply(n,t))}function eK(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function tK(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function nK(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=_4(n))||e){t&&(n=t);var i=0,r=function(){};return{s:r,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){t=t.call(n)},n:function(){var l=t.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||t.return==null||t.return()}finally{if(a)throw s}}}}function gg(n){return gg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gg(n)}function iK(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&my(n,e)}function M9(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(M9=function(){return!!n})()}function rK(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function sK(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function oK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lK(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KZ(n)}function my(n,e){return my=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},my(n,e)}function KA(n,e){return YZ(n)||sK(n,e)||_4(n,e)||oK()}function uK(n){return ZZ(n)||rK(n)||_4(n)||aK()}function _4(n,e){if(n){if(typeof n=="string")return py(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?py(n,e):void 0}}var Ow=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=[],r=null;return e.forEach(function(s){if(r){var o=ku(s,r)*180/Math.PI;if(o>t)for(var a=d4(r,s),l=r.length>2||s.length>2?Ed(r[2]||0,s[2]||0):null,u=l?function(g){return[].concat(uK(a(g)),[l(g)])}:a,A=1/Math.ceil(o/t),p=A;p<1;)i.push(u(p)),p+=A}i.push(r=s)}),i},gy=typeof window<"u"&&window.THREE?window.THREE:{BufferGeometry:Ai,Float32BufferAttribute:ei},cK=new gy.BufferGeometry().setAttribute?"setAttribute":"addAttribute",E9=function(n){function e(t){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;eK(this,e),i=JZ(this,e),i.type="GeoJsonGeometry",i.parameters={geoJson:t,radius:r,resolution:s};var o=({Point:A,MultiPoint:p,LineString:g,MultiLineString:v,Polygon:x,MultiPolygon:S}[t.type]||function(){return[]})(t.coordinates,r),a=[],l=[],u=0;o.forEach(function(T){var w=a.length;JA({indices:a,vertices:l},T),i.addGroup(w,a.length-w,u++)}),a.length&&i.setIndex(a),l.length&&i[cK]("position",new gy.Float32BufferAttribute(l,3));function A(T,w){var R=v3(T[1],T[0],w+(T[2]||0)),E=[];return[{vertices:R,indices:E}]}function p(T,w){var R={vertices:[],indices:[]};return T.map(function(E){return A(E,w)}).forEach(function(E){var N=KA(E,1),D=N[0];JA(R,D)}),[R]}function g(T,w){for(var R=Ow(T,s).map(function(O){var L=KA(O,3),F=L[0],V=L[1],H=L[2],Q=H===void 0?0:H;return v3(V,F,w+Q)}),E=mg([R]),N=E.vertices,D=Math.round(N.length/3),B=[],I=1;I<D;I++)B.push(I-1,I);return[{vertices:N,indices:B}]}function v(T,w){var R={vertices:[],indices:[]};return T.map(function(E){return g(E,w)}).forEach(function(E){var N=KA(E,1),D=N[0];JA(R,D)}),[R]}function x(T,w){for(var R=T.map(function(K){return Ow(K,s).map(function(W){var Z=KA(W,3),J=Z[0],fe=Z[1],ge=Z[2],pe=ge===void 0?0:ge;return v3(fe,J,w+pe)})}),E=mg(R),N=E.vertices,D=E.holes,B=D[0]||1/0,I=N.slice(0,B*3),O=N.slice(B*3),L=new Set(D),F=Math.round(N.length/3),V=[],H=[],Q=1;Q<F;Q++)L.has(Q)||(Q<B?V.push(Q-1,Q):H.push(Q-1-B,Q-B));var te=[{indices:V,vertices:I}];return D.length&&te.push({indices:H,vertices:O}),te}function S(T,w){var R={vertices:[],indices:[]},E={vertices:[],indices:[]};T.map(function(D){return x(D,w)}).forEach(function(D){var B=KA(D,2),I=B[0],O=B[1];JA(R,I),O&&JA(E,O)});var N=[R];return E.vertices.length&&N.push(E),N}return i}return iK(e,n),tK(e)}(gy.BufferGeometry);function JA(n,e){var t=Math.round(n.vertices.length/3);kw(n.vertices,e.vertices),kw(n.indices,e.indices.map(function(i){return i+t}))}function kw(n,e){var t=nK(e),i;try{for(t.s();!(i=t.n()).done;){var r=i.value;n.push(r)}}catch(s){t.e(s)}finally{t.f()}}function v3(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180;return[t*Math.sin(i)*Math.cos(r),t*Math.cos(i),t*Math.sin(i)*Math.sin(r)]}function hK(n,e,t=!0){if(!e||!e.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!n.hasAttribute("position")||!n.hasAttribute("normal")||!n.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function i(o){if(o.normalized||o.isInterleavedBufferAttribute){const a=new Float32Array(o.count*o.itemSize);for(let l=0,u=0;l<o.count;l++)a[u++]=o.getX(l),a[u++]=o.getY(l),o.itemSize>2&&(a[u++]=o.getZ(l));return a}return o.array instanceof Float32Array?o.array:new Float32Array(o.array)}const r=n.index?n.toNonIndexed():n,s=e.generateTangents(i(r.attributes.position),i(r.attributes.normal),i(r.attributes.uv));if(t)for(let o=3;o<s.length;o+=4)s[o]*=-1;return r.setAttribute("tangent",new Gi(s,4)),n!==r&&n.copy(r),n}function fK(n,e=!1){const t=n[0].index!==null,i=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),s={},o={},a=n[0].morphTargetsRelative,l=new Ai;let u=0;for(let A=0;A<n.length;++A){const p=n[A];let g=0;if(t!==(p.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const v in p.attributes){if(!i.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+'. All geometries must have compatible attributes; make sure "'+v+'" attribute exists among all geometries, or in none of them.'),null;s[v]===void 0&&(s[v]=[]),s[v].push(p.attributes[v]),g++}if(g!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+". Make sure all geometries have the same number of attributes."),null;if(a!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const v in p.morphAttributes){if(!r.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+".  .morphAttributes must be consistent throughout all geometries."),null;o[v]===void 0&&(o[v]=[]),o[v].push(p.morphAttributes[v])}if(e){let v;if(t)v=p.index.count;else if(p.attributes.position!==void 0)v=p.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,v,A),u+=v}}if(t){let A=0;const p=[];for(let g=0;g<n.length;++g){const v=n[g].index;for(let x=0;x<v.count;++x)p.push(v.getX(x)+A);A+=n[g].attributes.position.count}l.setIndex(p)}for(const A in s){const p=_y(s[A]);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+A+" attribute."),null;l.setAttribute(A,p)}for(const A in o){const p=o[A][0].length;if(p===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[A]=[];for(let g=0;g<p;++g){const v=[];for(let S=0;S<o[A].length;++S)v.push(o[A][S][g]);const x=_y(v);if(!x)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+A+" morphAttribute."),null;l.morphAttributes[A].push(x)}}return l}function _y(n){let e,t,i,r=-1,s=0;for(let u=0;u<n.length;++u){const A=n[u];if(e===void 0&&(e=A.array.constructor),e!==A.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=A.itemSize),t!==A.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=A.normalized),i!==A.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(r===-1&&(r=A.gpuType),r!==A.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=A.count*t}const o=new e(s),a=new Gi(o,t,i);let l=0;for(let u=0;u<n.length;++u){const A=n[u];if(A.isInterleavedBufferAttribute){const p=l/t;for(let g=0,v=A.count;g<v;g++)for(let x=0;x<t;x++){const S=A.getComponent(g,x);a.setComponent(g+p,x,S)}}else o.set(A.array,l);l+=A.count*t}return r!==void 0&&(a.gpuType=r),a}function AK(n){return n.isInstancedInterleavedBufferAttribute||n.isInterleavedBufferAttribute?_g(n):n.isInstancedBufferAttribute?new Du().copy(n):new Gi().copy(n)}function dK(n){let e,t=0,i=0;for(let u=0,A=n.length;u<A;++u){const p=n[u];if(e===void 0&&(e=p.array.constructor),e!==p.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;t+=p.array.length,i+=p.itemSize}const r=new s2(new e(t),i);let s=0;const o=[],a=["getX","getY","getZ","getW"],l=["setX","setY","setZ","setW"];for(let u=0,A=n.length;u<A;u++){const p=n[u],g=p.itemSize,v=p.count,x=new Uo(r,g,s,p.normalized);o.push(x),s+=g;for(let S=0;S<v;S++)for(let T=0;T<g;T++)x[l[T]](S,p[a[T]](S))}return o}function _g(n){const e=n.data.array.constructor,t=n.count,i=n.itemSize,r=n.normalized,s=new e(t*i);let o;n.isInstancedInterleavedBufferAttribute?o=new Du(s,i,r,n.meshPerAttribute):o=new Gi(s,i,r);for(let a=0;a<t;a++)o.setX(a,n.getX(a)),i>=2&&o.setY(a,n.getY(a)),i>=3&&o.setZ(a,n.getZ(a)),i>=4&&o.setW(a,n.getW(a));return o}function pK(n){const e=n.attributes,t=n.morphTargets,i=new Map;for(const r in e){const s=e[r];s.isInterleavedBufferAttribute&&(i.has(s)||i.set(s,_g(s)),e[r]=i.get(s))}for(const r in t){const s=t[r];s.isInterleavedBufferAttribute&&(i.has(s)||i.set(s,_g(s)),t[r]=i.get(s))}}function mK(n){let e=0;for(const i in n.attributes){const r=n.getAttribute(i);e+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}const t=n.getIndex();return e+=t?t.count*t.itemSize*t.array.BYTES_PER_ELEMENT:0,e}function gK(n,e=1e-4){e=Math.max(e,Number.EPSILON);const t={},i=n.getIndex(),r=n.getAttribute("position"),s=i?i.count:r.count;let o=0;const a=Object.keys(n.attributes),l={},u={},A=[],p=["getX","getY","getZ","getW"],g=["setX","setY","setZ","setW"];for(let R=0,E=a.length;R<E;R++){const N=a[R],D=n.attributes[N];l[N]=new D.constructor(new D.array.constructor(D.count*D.itemSize),D.itemSize,D.normalized);const B=n.morphAttributes[N];B&&(u[N]||(u[N]=[]),B.forEach((I,O)=>{const L=new I.array.constructor(I.count*I.itemSize);u[N][O]=new I.constructor(L,I.itemSize,I.normalized)}))}const v=e*.5,x=Math.log10(1/e),S=Math.pow(10,x),T=v*S;for(let R=0;R<s;R++){const E=i?i.getX(R):R;let N="";for(let D=0,B=a.length;D<B;D++){const I=a[D],O=n.getAttribute(I),L=O.itemSize;for(let F=0;F<L;F++)N+=`${~~(O[p[F]](E)*S+T)},`}if(N in t)A.push(t[N]);else{for(let D=0,B=a.length;D<B;D++){const I=a[D],O=n.getAttribute(I),L=n.morphAttributes[I],F=O.itemSize,V=l[I],H=u[I];for(let Q=0;Q<F;Q++){const te=p[Q],K=g[Q];if(V[K](o,O[te](E)),L)for(let W=0,Z=L.length;W<Z;W++)H[W][K](o,L[W][te](E))}}t[N]=o,A.push(o),o++}}const w=n.clone();for(const R in n.attributes){const E=l[R];if(w.setAttribute(R,new E.constructor(E.array.slice(0,o*E.itemSize),E.itemSize,E.normalized)),R in u)for(let N=0;N<u[R].length;N++){const D=u[R][N];w.morphAttributes[R][N]=new D.constructor(D.array.slice(0,o*D.itemSize),D.itemSize,D.normalized)}}return w.setIndex(A),w}function _K(n,e){if(e===vG)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===E8||e===yG){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(e===E8)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}function vK(n){const e=new ie,t=new ie,i=new ie,r=new ie,s=new ie,o=new ie,a=new ie,l=new ie,u=new ie;function A(fe,ge,pe,Ae,Fe,be,Ve,Ye){e.fromBufferAttribute(ge,Fe),t.fromBufferAttribute(ge,be),i.fromBufferAttribute(ge,Ve);const Xe=fe.morphTargetInfluences;if(pe&&Xe){a.set(0,0,0),l.set(0,0,0),u.set(0,0,0);for(let Tt=0,yt=pe.length;Tt<yt;Tt++){const ut=Xe[Tt],Ut=pe[Tt];ut!==0&&(r.fromBufferAttribute(Ut,Fe),s.fromBufferAttribute(Ut,be),o.fromBufferAttribute(Ut,Ve),Ae?(a.addScaledVector(r,ut),l.addScaledVector(s,ut),u.addScaledVector(o,ut)):(a.addScaledVector(r.sub(e),ut),l.addScaledVector(s.sub(t),ut),u.addScaledVector(o.sub(i),ut)))}e.add(a),t.add(l),i.add(u)}fe.isSkinnedMesh&&(fe.applyBoneTransform(Fe,e),fe.applyBoneTransform(be,t),fe.applyBoneTransform(Ve,i)),Ye[Fe*3+0]=e.x,Ye[Fe*3+1]=e.y,Ye[Fe*3+2]=e.z,Ye[be*3+0]=t.x,Ye[be*3+1]=t.y,Ye[be*3+2]=t.z,Ye[Ve*3+0]=i.x,Ye[Ve*3+1]=i.y,Ye[Ve*3+2]=i.z}const p=n.geometry,g=n.material;let v,x,S;const T=p.index,w=p.attributes.position,R=p.morphAttributes.position,E=p.morphTargetsRelative,N=p.attributes.normal,D=p.morphAttributes.position,B=p.groups,I=p.drawRange;let O,L,F,V,H,Q,te;const K=new Float32Array(w.count*w.itemSize),W=new Float32Array(N.count*N.itemSize);if(T!==null)if(Array.isArray(g))for(O=0,F=B.length;O<F;O++)for(H=B[O],Q=Math.max(H.start,I.start),te=Math.min(H.start+H.count,I.start+I.count),L=Q,V=te;L<V;L+=3)v=T.getX(L),x=T.getX(L+1),S=T.getX(L+2),A(n,w,R,E,v,x,S,K),A(n,N,D,E,v,x,S,W);else for(Q=Math.max(0,I.start),te=Math.min(T.count,I.start+I.count),O=Q,F=te;O<F;O+=3)v=T.getX(O),x=T.getX(O+1),S=T.getX(O+2),A(n,w,R,E,v,x,S,K),A(n,N,D,E,v,x,S,W);else if(Array.isArray(g))for(O=0,F=B.length;O<F;O++)for(H=B[O],Q=Math.max(H.start,I.start),te=Math.min(H.start+H.count,I.start+I.count),L=Q,V=te;L<V;L+=3)v=L,x=L+1,S=L+2,A(n,w,R,E,v,x,S,K),A(n,N,D,E,v,x,S,W);else for(Q=Math.max(0,I.start),te=Math.min(w.count,I.start+I.count),O=Q,F=te;O<F;O+=3)v=O,x=O+1,S=O+2,A(n,w,R,E,v,x,S,K),A(n,N,D,E,v,x,S,W);const Z=new ei(K,3),J=new ei(W,3);return{positionAttribute:w,normalAttribute:N,morphedPositionAttribute:Z,morphedNormalAttribute:J}}function yK(n){if(n.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),n;let e=n.groups;if(e=e.sort((o,a)=>o.materialIndex!==a.materialIndex?o.materialIndex-a.materialIndex:o.start-a.start),n.getIndex()===null){const o=n.getAttribute("position"),a=[];for(let l=0;l<o.count;l+=3)a.push(l,l+1,l+2);n.setIndex(a)}const t=n.getIndex(),i=[];for(let o=0;o<e.length;o++){const a=e[o],l=a.start,u=l+a.count;for(let A=l;A<u;A++)i.push(t.getX(A))}n.dispose(),n.setIndex(i);let r=0;for(let o=0;o<e.length;o++){const a=e[o];a.start=r,r+=a.count}let s=e[0];n.groups=[s];for(let o=1;o<e.length;o++){const a=e[o];s.materialIndex===a.materialIndex?s.count+=a.count:(s=a,n.groups.push(s))}return n}function xK(n,e=Math.PI/3){const t=Math.cos(e),i=(1+1e-10)*100,r=[new ie,new ie,new ie],s=new ie,o=new ie,a=new ie,l=new ie;function u(S){const T=~~(S.x*i),w=~~(S.y*i),R=~~(S.z*i);return`${T},${w},${R}`}const A=n.index?n.toNonIndexed():n,p=A.attributes.position,g={};for(let S=0,T=p.count/3;S<T;S++){const w=3*S,R=r[0].fromBufferAttribute(p,w+0),E=r[1].fromBufferAttribute(p,w+1),N=r[2].fromBufferAttribute(p,w+2);s.subVectors(N,E),o.subVectors(R,E);const D=new ie().crossVectors(s,o).normalize();for(let B=0;B<3;B++){const I=r[B],O=u(I);O in g||(g[O]=[]),g[O].push(D)}}const v=new Float32Array(p.count*3),x=new Gi(v,3,!1);for(let S=0,T=p.count/3;S<T;S++){const w=3*S,R=r[0].fromBufferAttribute(p,w+0),E=r[1].fromBufferAttribute(p,w+1),N=r[2].fromBufferAttribute(p,w+2);s.subVectors(N,E),o.subVectors(R,E),a.crossVectors(s,o).normalize();for(let D=0;D<3;D++){const B=r[D],I=u(B),O=g[I];l.set(0,0,0);for(let L=0,F=O.length;L<F;L++){const V=O[L];a.dot(V)>t&&l.add(V)}l.normalize(),x.setXYZ(w+D,l.x,l.y,l.z)}}return A.setAttribute("normal",x),A}const v4=Object.freeze(Object.defineProperty({__proto__:null,computeMikkTSpaceTangents:hK,computeMorphedAttributes:vK,deepCloneAttribute:AK,deinterleaveAttribute:_g,deinterleaveGeometry:pK,estimateBytesUsed:mK,interleaveAttributes:dK,mergeAttributes:_y,mergeGeometries:fK,mergeGroups:yK,mergeVertices:gK,toCreasedNormals:xK,toTrianglesDrawMode:_K},Symbol.toStringTag,{value:"Module"}));var ot=function(n){return typeof n=="function"?n:typeof n=="string"?function(e){return e[n]}:function(e){return n}};function vg(n){"@babel/helpers - typeof";return vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vg(n)}var bK=/^\s+/,wK=/\s+$/;function Wt(n,e){if(n=n||"",e=e||{},n instanceof Wt)return n;if(!(this instanceof Wt))return new Wt(n,e);var t=SK(n);this._originalInput=n,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}Wt.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),t,i,r,s,o,a;return t=e.r/255,i=e.g/255,r=e.b/255,t<=.03928?s=t/12.92:s=Math.pow((t+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),.2126*s+.7152*o+.0722*a},setAlpha:function(e){return this._a=C9(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=Gw(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=Gw(this._r,this._g,this._b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.v*100);return this._a==1?"hsv("+t+", "+i+"%, "+r+"%)":"hsva("+t+", "+i+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=Vw(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=Vw(this._r,this._g,this._b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.l*100);return this._a==1?"hsl("+t+", "+i+"%, "+r+"%)":"hsla("+t+", "+i+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return qw(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return CK(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Vi(this._r,255)*100)+"%",g:Math.round(Vi(this._g,255)*100)+"%",b:Math.round(Vi(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Vi(this._r,255)*100)+"%, "+Math.round(Vi(this._g,255)*100)+"%, "+Math.round(Vi(this._b,255)*100)+"%)":"rgba("+Math.round(Vi(this._r,255)*100)+"%, "+Math.round(Vi(this._g,255)*100)+"%, "+Math.round(Vi(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:VK[qw(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+zw(this._r,this._g,this._b,this._a),i=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var s=Wt(e);i="#"+zw(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){var t=!!e;e=e||this._format;var i=!1,r=this._a<1&&this._a>=0,s=!t&&r&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return Wt(this.toString())},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(LK,arguments)},brighten:function(){return this._applyModification(DK,arguments)},darken:function(){return this._applyModification(IK,arguments)},desaturate:function(){return this._applyModification(RK,arguments)},saturate:function(){return this._applyModification(NK,arguments)},greyscale:function(){return this._applyModification(PK,arguments)},spin:function(){return this._applyModification(BK,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(OK,arguments)},complement:function(){return this._applyCombination(FK,arguments)},monochromatic:function(){return this._applyCombination(kK,arguments)},splitcomplement:function(){return this._applyCombination(UK,arguments)},triad:function(){return this._applyCombination(Hw,[3])},tetrad:function(){return this._applyCombination(Hw,[4])}};Wt.fromRatio=function(n,e){if(vg(n)=="object"){var t={};for(var i in n)n.hasOwnProperty(i)&&(i==="a"?t[i]=n[i]:t[i]=T0(n[i]));n=t}return Wt(n,e)};function SK(n){var e={r:0,g:0,b:0},t=1,i=null,r=null,s=null,o=!1,a=!1;return typeof n=="string"&&(n=HK(n)),vg(n)=="object"&&(vl(n.r)&&vl(n.g)&&vl(n.b)?(e=TK(n.r,n.g,n.b),o=!0,a=String(n.r).substr(-1)==="%"?"prgb":"rgb"):vl(n.h)&&vl(n.s)&&vl(n.v)?(i=T0(n.s),r=T0(n.v),e=EK(n.h,i,r),o=!0,a="hsv"):vl(n.h)&&vl(n.s)&&vl(n.l)&&(i=T0(n.s),s=T0(n.l),e=MK(n.h,i,s),o=!0,a="hsl"),n.hasOwnProperty("a")&&(t=n.a)),t=C9(t),{ok:o,format:n.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}function TK(n,e,t){return{r:Vi(n,255)*255,g:Vi(e,255)*255,b:Vi(t,255)*255}}function Vw(n,e,t){n=Vi(n,255),e=Vi(e,255),t=Vi(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s,o,a=(i+r)/2;if(i==r)s=o=0;else{var l=i-r;switch(o=a>.5?l/(2-i-r):l/(i+r),i){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,l:a}}function MK(n,e,t){var i,r,s;n=Vi(n,360),e=Vi(e,100),t=Vi(t,100);function o(u,A,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?u+(A-u)*6*p:p<1/2?A:p<2/3?u+(A-u)*(2/3-p)*6:u}if(e===0)i=r=s=t;else{var a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;i=o(l,a,n+1/3),r=o(l,a,n),s=o(l,a,n-1/3)}return{r:i*255,g:r*255,b:s*255}}function Gw(n,e,t){n=Vi(n,255),e=Vi(e,255),t=Vi(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s,o,a=i,l=i-r;if(o=i===0?0:l/i,i==r)s=0;else{switch(i){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,v:a}}function EK(n,e,t){n=Vi(n,360)*6,e=Vi(e,100),t=Vi(t,100);var i=Math.floor(n),r=n-i,s=t*(1-e),o=t*(1-r*e),a=t*(1-(1-r)*e),l=i%6,u=[t,o,s,s,a,t][l],A=[a,t,t,o,s,s][l],p=[s,s,a,t,t,o][l];return{r:u*255,g:A*255,b:p*255}}function qw(n,e,t,i){var r=[aa(Math.round(n).toString(16)),aa(Math.round(e).toString(16)),aa(Math.round(t).toString(16))];return i&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function CK(n,e,t,i,r){var s=[aa(Math.round(n).toString(16)),aa(Math.round(e).toString(16)),aa(Math.round(t).toString(16)),aa(R9(i))];return r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function zw(n,e,t,i){var r=[aa(R9(i)),aa(Math.round(n).toString(16)),aa(Math.round(e).toString(16)),aa(Math.round(t).toString(16))];return r.join("")}Wt.equals=function(n,e){return!n||!e?!1:Wt(n).toRgbString()==Wt(e).toRgbString()};Wt.random=function(){return Wt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function RK(n,e){e=e===0?0:e||10;var t=Wt(n).toHsl();return t.s-=e/100,t.s=A2(t.s),Wt(t)}function NK(n,e){e=e===0?0:e||10;var t=Wt(n).toHsl();return t.s+=e/100,t.s=A2(t.s),Wt(t)}function PK(n){return Wt(n).desaturate(100)}function LK(n,e){e=e===0?0:e||10;var t=Wt(n).toHsl();return t.l+=e/100,t.l=A2(t.l),Wt(t)}function DK(n,e){e=e===0?0:e||10;var t=Wt(n).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),Wt(t)}function IK(n,e){e=e===0?0:e||10;var t=Wt(n).toHsl();return t.l-=e/100,t.l=A2(t.l),Wt(t)}function BK(n,e){var t=Wt(n).toHsl(),i=(t.h+e)%360;return t.h=i<0?360+i:i,Wt(t)}function FK(n){var e=Wt(n).toHsl();return e.h=(e.h+180)%360,Wt(e)}function Hw(n,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=Wt(n).toHsl(),i=[Wt(n)],r=360/e,s=1;s<e;s++)i.push(Wt({h:(t.h+s*r)%360,s:t.s,l:t.l}));return i}function UK(n){var e=Wt(n).toHsl(),t=e.h;return[Wt(n),Wt({h:(t+72)%360,s:e.s,l:e.l}),Wt({h:(t+216)%360,s:e.s,l:e.l})]}function OK(n,e,t){e=e||6,t=t||30;var i=Wt(n).toHsl(),r=360/t,s=[Wt(n)];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,s.push(Wt(i));return s}function kK(n,e){e=e||6;for(var t=Wt(n).toHsv(),i=t.h,r=t.s,s=t.v,o=[],a=1/e;e--;)o.push(Wt({h:i,s:r,v:s})),s=(s+a)%1;return o}Wt.mix=function(n,e,t){t=t===0?0:t||50;var i=Wt(n).toRgb(),r=Wt(e).toRgb(),s=t/100,o={r:(r.r-i.r)*s+i.r,g:(r.g-i.g)*s+i.g,b:(r.b-i.b)*s+i.b,a:(r.a-i.a)*s+i.a};return Wt(o)};Wt.readability=function(n,e){var t=Wt(n),i=Wt(e);return(Math.max(t.getLuminance(),i.getLuminance())+.05)/(Math.min(t.getLuminance(),i.getLuminance())+.05)};Wt.isReadable=function(n,e,t){var i=Wt.readability(n,e),r,s;switch(s=!1,r=$K(t),r.level+r.size){case"AAsmall":case"AAAlarge":s=i>=4.5;break;case"AAlarge":s=i>=3;break;case"AAAsmall":s=i>=7;break}return s};Wt.mostReadable=function(n,e,t){var i=null,r=0,s,o,a,l;t=t||{},o=t.includeFallbackColors,a=t.level,l=t.size;for(var u=0;u<e.length;u++)s=Wt.readability(n,e[u]),s>r&&(r=s,i=Wt(e[u]));return Wt.isReadable(n,i,{level:a,size:l})||!o?i:(t.includeFallbackColors=!1,Wt.mostReadable(n,["#fff","#000"],t))};var vy=Wt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},VK=Wt.hexNames=GK(vy);function GK(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function C9(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function Vi(n,e){qK(n)&&(n="100%");var t=zK(n);return n=Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(n*e,10)/100),Math.abs(n-e)<1e-6?1:n%e/parseFloat(e)}function A2(n){return Math.min(1,Math.max(0,n))}function uo(n){return parseInt(n,16)}function qK(n){return typeof n=="string"&&n.indexOf(".")!=-1&&parseFloat(n)===1}function zK(n){return typeof n=="string"&&n.indexOf("%")!=-1}function aa(n){return n.length==1?"0"+n:""+n}function T0(n){return n<=1&&(n=n*100+"%"),n}function R9(n){return Math.round(parseFloat(n)*255).toString(16)}function $w(n){return uo(n)/255}var ta=function(){var n="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+n+")",i="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function vl(n){return!!ta.CSS_UNIT.exec(n)}function HK(n){n=n.replace(bK,"").replace(wK,"").toLowerCase();var e=!1;if(vy[n])n=vy[n],e=!0;else if(n=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=ta.rgb.exec(n))?{r:t[1],g:t[2],b:t[3]}:(t=ta.rgba.exec(n))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=ta.hsl.exec(n))?{h:t[1],s:t[2],l:t[3]}:(t=ta.hsla.exec(n))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=ta.hsv.exec(n))?{h:t[1],s:t[2],v:t[3]}:(t=ta.hsva.exec(n))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=ta.hex8.exec(n))?{r:uo(t[1]),g:uo(t[2]),b:uo(t[3]),a:$w(t[4]),format:e?"name":"hex8"}:(t=ta.hex6.exec(n))?{r:uo(t[1]),g:uo(t[2]),b:uo(t[3]),format:e?"name":"hex"}:(t=ta.hex4.exec(n))?{r:uo(t[1]+""+t[1]),g:uo(t[2]+""+t[2]),b:uo(t[3]+""+t[3]),a:$w(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=ta.hex3.exec(n))?{r:uo(t[1]+""+t[1]),g:uo(t[2]+""+t[2]),b:uo(t[3]+""+t[3]),format:e?"name":"hex"}:!1}function $K(n){var e,t;return n=n||{level:"AA",size:"small"},e=(n.level||"AA").toUpperCase(),t=(n.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}function yy(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function WK(n){if(Array.isArray(n))return n}function jK(n){if(Array.isArray(n))return yy(n)}function N9(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function XK(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QK(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function os(n,e){return n.get(N9(n,e))}function Hh(n,e,t){XK(n,e),e.set(n,t)}function Nm(n,e,t){return n.set(N9(n,e),t),t}function YK(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,sJ(i.key),i)}}function ZK(n,e,t){return e&&YK(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function KK(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function JK(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function eJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nJ(n,e){return WK(n)||JK(n,e)||P9(n,e)||eJ()}function iJ(n){return jK(n)||KK(n)||P9(n)||tJ()}function rJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function sJ(n){var e=rJ(n,"string");return typeof e=="symbol"?e:e+""}function P9(n,e){if(n){if(typeof n=="string")return yy(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?yy(n,e):void 0}}var $h=new WeakMap,e0=new WeakMap,Wh=new WeakMap,y3=new WeakMap,x3=new WeakMap,b3=new WeakMap,oJ=function(){function n(){QK(this,n),Hh(this,$h,new Map),Hh(this,e0,new Map),Hh(this,Wh,function(e){return e}),Hh(this,y3,function(){return{}}),Hh(this,x3,function(){}),Hh(this,b3,function(){})}return ZK(n,[{key:"getObj",value:function(t){return os($h,this).get(os(Wh,this).call(this,t))}},{key:"getData",value:function(t){return os(e0,this).get(t)}},{key:"entries",value:function(){return iJ(os(e0,this).entries()).map(function(t){var i=nJ(t,2),r=i[0],s=i[1];return[s,r]})}},{key:"id",value:function(t){return Nm(Wh,this,ot(t)),this}},{key:"onCreateObj",value:function(t){return Nm(y3,this,t),this}},{key:"onUpdateObj",value:function(t){return Nm(x3,this,t),this}},{key:"onRemoveObj",value:function(t){return Nm(b3,this,t),this}},{key:"digest",value:function(t){var i=this;t.filter(function(s){return!os($h,i).has(os(Wh,i).call(i,s))}).forEach(function(s){var o=os(y3,i).call(i,s);os($h,i).set(os(Wh,i).call(i,s),o),os(e0,i).set(o,s)});var r=new Map(t.map(function(s){return[os(Wh,i).call(i,s),s]}));return os($h,this).forEach(function(s,o){r.has(o)?os(x3,i).call(i,s,r.get(o)):(os(b3,i).call(i,s,o),os($h,i).delete(o),os(e0,i).delete(s))}),this}},{key:"clear",value:function(){return this.digest([]),this}}])}(),v1={exports:{}},aJ=v1.exports,Ww;function lJ(){return Ww||(Ww=1,function(n,e){(function(t,i){n.exports=i()})(aJ,function(){return function(t){function i(s){if(r[s])return r[s].exports;var o=r[s]={exports:{},id:s,loaded:!1};return t[s].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var r={};return i.m=t,i.c=r,i.p="",i(0)}([function(t,i,r){var s=r(1),o=function(){function a(l,u,A){l===void 0&&(l=NaN),u===void 0&&(u=NaN),A===void 0&&(A=!1),this._minFPS=u,this._maxFPS=l,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new s.default,this._onPause=new s.default,this._onTick=new s.default,this._onTickOncePerFrame=new s.default,A||this.resume()}return a.prototype.updateOnce=function(l){l(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},a.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},a.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(a.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"timeScale",{get:function(){return this._timeScale},set:function(l){this._timeScale!==l&&(this._timeScale=l)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),a.prototype.animateOnce=function(){var l=this;this._animationFrameHandle=window.requestAnimationFrame(function(){return l.onFrame()})},a.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},a.prototype.update=function(l,u){u===void 0&&(u=!0),this._currentTick++,this._currentTime+=l,this._tickDeltaTime=l,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),u&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.getTimer=function(){return Date.now()},a}();Object.defineProperty(i,"__esModule",{value:!0}),i.default=o},function(t,i,r){(function(s,o){t.exports=o()})(this,function(){return function(s){function o(l){if(a[l])return a[l].exports;var u=a[l]={exports:{},id:l,loaded:!1};return s[l].call(u.exports,u,u.exports,o),u.loaded=!0,u.exports}var a={};return o.m=s,o.c=a,o.p="",o(0)}([function(s,o){var a=function(){function l(){this.functions=[]}return l.prototype.add=function(u){return this.functions.indexOf(u)===-1&&(this.functions.push(u),!0)},l.prototype.remove=function(u){var A=this.functions.indexOf(u);return A>-1&&(this.functions.splice(A,1),!0)},l.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},l.prototype.dispatch=function(){for(var u=[],A=0;A<arguments.length;A++)u[A]=arguments[A];var p=this.functions.concat();p.forEach(function(g){g.apply(void 0,u)})},Object.defineProperty(l.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),l}();Object.defineProperty(o,"__esModule",{value:!0}),o.default=a}])})}])})}(v1)),v1.exports}var uJ=lJ();const hA=h7(uJ),Bl=11102230246251565e-32,as=134217729,cJ=(3+8*Bl)*Bl;function w3(n,e,t,i,r){let s,o,a,l,u=e[0],A=i[0],p=0,g=0;A>u==A>-u?(s=u,u=e[++p]):(s=A,A=i[++g]);let v=0;if(p<n&&g<t)for(A>u==A>-u?(o=u+s,a=s-(o-u),u=e[++p]):(o=A+s,a=s-(o-A),A=i[++g]),s=o,a!==0&&(r[v++]=a);p<n&&g<t;)A>u==A>-u?(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=e[++p]):(o=s+A,l=o-s,a=s-(o-l)+(A-l),A=i[++g]),s=o,a!==0&&(r[v++]=a);for(;p<n;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=e[++p],s=o,a!==0&&(r[v++]=a);for(;g<t;)o=s+A,l=o-s,a=s-(o-l)+(A-l),A=i[++g],s=o,a!==0&&(r[v++]=a);return(s!==0||v===0)&&(r[v++]=s),v}function hJ(n,e){let t=e[0];for(let i=1;i<n;i++)t+=e[i];return t}function lp(n){return new Float64Array(n)}const fJ=(3+16*Bl)*Bl,AJ=(2+12*Bl)*Bl,dJ=(9+64*Bl)*Bl*Bl,jh=lp(4),jw=lp(8),Xw=lp(12),Qw=lp(16),xs=lp(4);function pJ(n,e,t,i,r,s,o){let a,l,u,A,p,g,v,x,S,T,w,R,E,N,D,B,I,O;const L=n-r,F=t-r,V=e-s,H=i-s;N=L*H,g=as*L,v=g-(g-L),x=L-v,g=as*H,S=g-(g-H),T=H-S,D=x*T-(N-v*S-x*S-v*T),B=V*F,g=as*V,v=g-(g-V),x=V-v,g=as*F,S=g-(g-F),T=F-S,I=x*T-(B-v*S-x*S-v*T),w=D-I,p=D-w,jh[0]=D-(w+p)+(p-I),R=N+w,p=R-N,E=N-(R-p)+(w-p),w=E-B,p=E-w,jh[1]=E-(w+p)+(p-B),O=R+w,p=O-R,jh[2]=R-(O-p)+(w-p),jh[3]=O;let Q=hJ(4,jh),te=AJ*o;if(Q>=te||-Q>=te||(p=n-L,a=n-(L+p)+(p-r),p=t-F,u=t-(F+p)+(p-r),p=e-V,l=e-(V+p)+(p-s),p=i-H,A=i-(H+p)+(p-s),a===0&&l===0&&u===0&&A===0)||(te=dJ*o+cJ*Math.abs(Q),Q+=L*A+H*a-(V*u+F*l),Q>=te||-Q>=te))return Q;N=a*H,g=as*a,v=g-(g-a),x=a-v,g=as*H,S=g-(g-H),T=H-S,D=x*T-(N-v*S-x*S-v*T),B=l*F,g=as*l,v=g-(g-l),x=l-v,g=as*F,S=g-(g-F),T=F-S,I=x*T-(B-v*S-x*S-v*T),w=D-I,p=D-w,xs[0]=D-(w+p)+(p-I),R=N+w,p=R-N,E=N-(R-p)+(w-p),w=E-B,p=E-w,xs[1]=E-(w+p)+(p-B),O=R+w,p=O-R,xs[2]=R-(O-p)+(w-p),xs[3]=O;const K=w3(4,jh,4,xs,jw);N=L*A,g=as*L,v=g-(g-L),x=L-v,g=as*A,S=g-(g-A),T=A-S,D=x*T-(N-v*S-x*S-v*T),B=V*u,g=as*V,v=g-(g-V),x=V-v,g=as*u,S=g-(g-u),T=u-S,I=x*T-(B-v*S-x*S-v*T),w=D-I,p=D-w,xs[0]=D-(w+p)+(p-I),R=N+w,p=R-N,E=N-(R-p)+(w-p),w=E-B,p=E-w,xs[1]=E-(w+p)+(p-B),O=R+w,p=O-R,xs[2]=R-(O-p)+(w-p),xs[3]=O;const W=w3(K,jw,4,xs,Xw);N=a*A,g=as*a,v=g-(g-a),x=a-v,g=as*A,S=g-(g-A),T=A-S,D=x*T-(N-v*S-x*S-v*T),B=l*u,g=as*l,v=g-(g-l),x=l-v,g=as*u,S=g-(g-u),T=u-S,I=x*T-(B-v*S-x*S-v*T),w=D-I,p=D-w,xs[0]=D-(w+p)+(p-I),R=N+w,p=R-N,E=N-(R-p)+(w-p),w=E-B,p=E-w,xs[1]=E-(w+p)+(p-B),O=R+w,p=O-R,xs[2]=R-(O-p)+(w-p),xs[3]=O;const Z=w3(W,Xw,4,xs,Qw);return Qw[Z-1]}function M0(n,e,t,i,r,s){const o=(e-s)*(t-r),a=(n-r)*(i-s),l=o-a,u=Math.abs(o+a);return Math.abs(l)>=fJ*u?l:-pJ(n,e,t,i,r,s,u)}const Yw=Math.pow(2,-52),Pm=new Uint32Array(512);class Ld{static from(e,t=yJ,i=xJ){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=e[o];s[2*o]=t(a),s[2*o+1]=i(a)}return new Ld(s)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const i=Math.max(2*t-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=e.length>>1;let a=1/0,l=1/0,u=-1/0,A=-1/0;for(let L=0;L<o;L++){const F=e[2*L],V=e[2*L+1];F<a&&(a=F),V<l&&(l=V),F>u&&(u=F),V>A&&(A=V),this._ids[L]=L}const p=(a+u)/2,g=(l+A)/2;let v,x,S;for(let L=0,F=1/0;L<o;L++){const V=S3(p,g,e[2*L],e[2*L+1]);V<F&&(v=L,F=V)}const T=e[2*v],w=e[2*v+1];for(let L=0,F=1/0;L<o;L++){if(L===v)continue;const V=S3(T,w,e[2*L],e[2*L+1]);V<F&&V>0&&(x=L,F=V)}let R=e[2*x],E=e[2*x+1],N=1/0;for(let L=0;L<o;L++){if(L===v||L===x)continue;const F=_J(T,w,R,E,e[2*L],e[2*L+1]);F<N&&(S=L,N=F)}let D=e[2*S],B=e[2*S+1];if(N===1/0){for(let V=0;V<o;V++)this._dists[V]=e[2*V]-e[0]||e[2*V+1]-e[1];df(this._ids,this._dists,0,o-1);const L=new Uint32Array(o);let F=0;for(let V=0,H=-1/0;V<o;V++){const Q=this._ids[V],te=this._dists[Q];te>H&&(L[F++]=Q,H=te)}this.hull=L.subarray(0,F),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(M0(T,w,R,E,D,B)<0){const L=x,F=R,V=E;x=S,R=D,E=B,S=L,D=F,B=V}const I=vJ(T,w,R,E,D,B);this._cx=I.x,this._cy=I.y;for(let L=0;L<o;L++)this._dists[L]=S3(e[2*L],e[2*L+1],I.x,I.y);df(this._ids,this._dists,0,o-1),this._hullStart=v;let O=3;i[v]=t[S]=x,i[x]=t[v]=S,i[S]=t[x]=v,r[v]=0,r[x]=1,r[S]=2,s.fill(-1),s[this._hashKey(T,w)]=v,s[this._hashKey(R,E)]=x,s[this._hashKey(D,B)]=S,this.trianglesLen=0,this._addTriangle(v,x,S,-1,-1,-1);for(let L=0,F,V;L<this._ids.length;L++){const H=this._ids[L],Q=e[2*H],te=e[2*H+1];if(L>0&&Math.abs(Q-F)<=Yw&&Math.abs(te-V)<=Yw||(F=Q,V=te,H===v||H===x||H===S))continue;let K=0;for(let ge=0,pe=this._hashKey(Q,te);ge<this._hashSize&&(K=s[(pe+ge)%this._hashSize],!(K!==-1&&K!==i[K]));ge++);K=t[K];let W=K,Z;for(;Z=i[W],M0(Q,te,e[2*W],e[2*W+1],e[2*Z],e[2*Z+1])>=0;)if(W=Z,W===K){W=-1;break}if(W===-1)continue;let J=this._addTriangle(W,H,i[W],-1,-1,r[W]);r[H]=this._legalize(J+2),r[W]=J,O++;let fe=i[W];for(;Z=i[fe],M0(Q,te,e[2*fe],e[2*fe+1],e[2*Z],e[2*Z+1])<0;)J=this._addTriangle(fe,H,Z,r[H],-1,r[fe]),r[H]=this._legalize(J+2),i[fe]=fe,O--,fe=Z;if(W===K)for(;Z=t[W],M0(Q,te,e[2*Z],e[2*Z+1],e[2*W],e[2*W+1])<0;)J=this._addTriangle(Z,H,W,-1,r[W],r[Z]),this._legalize(J+2),r[Z]=J,i[W]=W,O--,W=Z;this._hullStart=t[H]=W,i[W]=t[fe]=H,i[H]=fe,s[this._hashKey(Q,te)]=H,s[this._hashKey(e[2*W],e[2*W+1])]=W}this.hull=new Uint32Array(O);for(let L=0,F=this._hullStart;L<O;L++)this.hull[L]=F,F=i[F];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(mJ(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[e],l=e-e%3;if(o=l+(e+2)%3,a===-1){if(s===0)break;e=Pm[--s];continue}const u=a-a%3,A=l+(e+1)%3,p=u+(a+2)%3,g=t[o],v=t[e],x=t[A],S=t[p];if(gJ(r[2*g],r[2*g+1],r[2*v],r[2*v+1],r[2*x],r[2*x+1],r[2*S],r[2*S+1])){t[e]=S,t[a]=g;const w=i[p];if(w===-1){let E=this._hullStart;do{if(this._hullTri[E]===p){this._hullTri[E]=e;break}E=this._hullPrev[E]}while(E!==this._hullStart)}this._link(e,w),this._link(a,i[o]),this._link(o,p);const R=u+(a+1)%3;s<Pm.length&&(Pm[s++]=R)}else{if(s===0)break;e=Pm[--s]}}return o}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function mJ(n,e){const t=n/(Math.abs(n)+Math.abs(e));return(e>0?3-t:1+t)/4}function S3(n,e,t,i){const r=n-t,s=e-i;return r*r+s*s}function gJ(n,e,t,i,r,s,o,a){const l=n-o,u=e-a,A=t-o,p=i-a,g=r-o,v=s-a,x=l*l+u*u,S=A*A+p*p,T=g*g+v*v;return l*(p*T-S*v)-u*(A*T-S*g)+x*(A*v-p*g)<0}function _J(n,e,t,i,r,s){const o=t-n,a=i-e,l=r-n,u=s-e,A=o*o+a*a,p=l*l+u*u,g=.5/(o*u-a*l),v=(u*A-a*p)*g,x=(o*p-l*A)*g;return v*v+x*x}function vJ(n,e,t,i,r,s){const o=t-n,a=i-e,l=r-n,u=s-e,A=o*o+a*a,p=l*l+u*u,g=.5/(o*u-a*l),v=n+(u*A-a*p)*g,x=e+(o*p-l*A)*g;return{x:v,y:x}}function df(n,e,t,i){if(i-t<=20)for(let r=t+1;r<=i;r++){const s=n[r],o=e[s];let a=r-1;for(;a>=t&&e[n[a]]>o;)n[a+1]=n[a--];n[a+1]=s}else{const r=t+i>>1;let s=t+1,o=i;t0(n,r,s),e[n[t]]>e[n[i]]&&t0(n,t,i),e[n[s]]>e[n[i]]&&t0(n,s,i),e[n[t]]>e[n[s]]&&t0(n,t,s);const a=n[s],l=e[a];for(;;){do s++;while(e[n[s]]<l);do o--;while(e[n[o]]>l);if(o<s)break;t0(n,s,o)}n[t+1]=n[o],n[o]=a,i-s+1>=o-t?(df(n,e,s,i),df(n,e,t,o-1)):(df(n,e,t,o-1),df(n,e,s,i))}}function t0(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function yJ(n){return n[0]}function xJ(n){return n[1]}function bJ(n,e){var t,i,r=0,s,o,a,l,u,A,p,g=n[0],v=n[1],x=e.length;for(t=0;t<x;t++){i=0;var S=e[t],T=S.length-1;if(A=S[0],A[0]!==S[T][0]&&A[1]!==S[T][1])throw new Error("First and last coordinates in a ring must be the same");for(o=A[0]-g,a=A[1]-v,i;i<T;i++){if(p=S[i+1],l=p[0]-g,u=p[1]-v,a===0&&u===0){if(l<=0&&o>=0||o<=0&&l>=0)return 0}else if(u>=0&&a<=0||u<=0&&a>=0){if(s=M0(o,l,a,u,0,0),s===0)return 0;(s>0&&u>0&&a<=0||s<0&&u<=0&&a>0)&&r++}A=p,a=u,o=l}}return r%2!==0}function wJ(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function SJ(n){return n.type==="Feature"?n.geometry:n}function TJ(n,e,t={}){if(!n)throw new Error("point is required");if(!e)throw new Error("polygon is required");const i=wJ(n),r=SJ(e),s=r.type,o=e.bbox;let a=r.coordinates;if(o&&MJ(i,o)===!1)return!1;s==="Polygon"&&(a=[a]);let l=!1;for(var u=0;u<a.length;++u){const A=bJ(i,a[u]);if(A===0)return!t.ignoreBoundary;A&&(l=!0)}return l}function MJ(n,e){return e[0]<=n[0]&&e[1]<=n[1]&&e[2]>=n[0]&&e[3]>=n[1]}var EJ=TJ;const Zw=1e-6;class Dc{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,i){e=+e,t=+t,i=+i;const r=e+i,s=t;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>Zw||Math.abs(this._y1-s)>Zw)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${e-i},${t}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(e,t,i,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class xy{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class CJ{constructor(e,[t,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(t=+t))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=r,this.xmin=t,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:i},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let S=0,T=0,w=i.length,R,E;S<w;S+=3,T+=2){const N=i[S]*2,D=i[S+1]*2,B=i[S+2]*2,I=e[N],O=e[N+1],L=e[D],F=e[D+1],V=e[B],H=e[B+1],Q=L-I,te=F-O,K=V-I,W=H-O,Z=(Q*W-te*K)*2;if(Math.abs(Z)<1e-9){if(s===void 0){s=o=0;for(const fe of t)s+=e[fe*2],o+=e[fe*2+1];s/=t.length,o/=t.length}const J=1e9*Math.sign((s-I)*W-(o-O)*K);R=(I+V)/2-J*W,E=(O+H)/2+J*K}else{const J=1/Z,fe=Q*Q+te*te,ge=K*K+W*W;R=I+(W*fe-te*ge)*J,E=O+(Q*ge-K*fe)*J}a[T]=R,a[T+1]=E}let l=t[t.length-1],u,A=l*4,p,g=e[2*l],v,x=e[2*l+1];r.fill(0);for(let S=0;S<t.length;++S)l=t[S],u=A,p=g,v=x,A=l*4,g=e[2*l],x=e[2*l+1],r[u+2]=r[A]=v-x,r[u+3]=r[A+1]=g-p}render(e){const t=e==null?e=new Dc:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let A=0,p=i.length;A<p;++A){const g=i[A];if(g<A)continue;const v=Math.floor(A/3)*2,x=Math.floor(g/3)*2,S=o[v],T=o[v+1],w=o[x],R=o[x+1];this._renderSegment(S,T,w,R,e)}let l,u=s[s.length-1];for(let A=0;A<s.length;++A){l=u,u=s[A];const p=Math.floor(r[u]/3)*2,g=o[p],v=o[p+1],x=l*4,S=this._project(g,v,a[x+2],a[x+3]);S&&this._renderSegment(g,v,S[0],S[1],e)}return t&&t.value()}renderBounds(e){const t=e==null?e=new Dc:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const i=t==null?t=new Dc:void 0,r=this._clip(e);if(r===null||!r.length)return;t.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&t.lineTo(r[o],r[o+1]);return t.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,i=e.length/2;t<i;++t){const r=this.cellPolygon(t);r&&(r.index=t,yield r)}}cellPolygon(e){const t=new xy;return this.renderCell(e,t),t.value()}_renderSegment(e,t,i,r,s){let o;const a=this._regioncode(e,t),l=this._regioncode(i,r);a===0&&l===0?(s.moveTo(e,t),s.lineTo(i,r)):(o=this._clipSegment(e,t,i,r,a,l))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(e,t,i){return t=+t,t!==t||(i=+i,i!==i)?!1:this.delaunay._step(e,t,i)===e}*neighbors(e){const t=this._clip(e);if(t)for(const i of this.delaunay.neighbors(e)){const r=this._clip(i);if(r){e:for(let s=0,o=t.length;s<o;s+=2)for(let a=0,l=r.length;a<l;a+=2)if(t[s]===r[a]&&t[s+1]===r[a+1]&&t[(s+2)%o]===r[(a+l-2)%l]&&t[(s+3)%o]===r[(a+l-1)%l]){yield i;break e}}}}_cell(e){const{circumcenters:t,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[e];if(o===-1)return null;const a=[];let l=o;do{const u=Math.floor(l/3);if(a.push(t[u*2],t[u*2+1]),l=l%3===2?l-2:l+1,s[l]!==e)break;l=r[l]}while(l!==o&&l!==-1);return a}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(t===null)return null;const{vectors:i}=this,r=e*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(e,t,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(e,t))}_clipFinite(e,t){const i=t.length;let r=null,s,o,a=t[i-2],l=t[i-1],u,A=this._regioncode(a,l),p,g=0;for(let v=0;v<i;v+=2)if(s=a,o=l,a=t[v],l=t[v+1],u=A,A=this._regioncode(a,l),u===0&&A===0)p=g,g=0,r?r.push(a,l):r=[a,l];else{let x,S,T,w,R;if(u===0){if((x=this._clipSegment(s,o,a,l,u,A))===null)continue;[S,T,w,R]=x}else{if((x=this._clipSegment(a,l,s,o,A,u))===null)continue;[w,R,S,T]=x,p=g,g=this._edgecode(S,T),p&&g&&this._edge(e,p,g,r,r.length),r?r.push(S,T):r=[S,T]}p=g,g=this._edgecode(w,R),p&&g&&this._edge(e,p,g,r,r.length),r?r.push(w,R):r=[w,R]}if(r)p=g,g=this._edgecode(r[0],r[1]),p&&g&&this._edge(e,p,g,r,r.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(e,t,i,r,s,o){const a=s<o;for(a&&([e,t,i,r,s,o]=[i,r,e,t,o,s]);;){if(s===0&&o===0)return a?[i,r,e,t]:[e,t,i,r];if(s&o)return null;let l,u,A=s||o;A&8?(l=e+(i-e)*(this.ymax-t)/(r-t),u=this.ymax):A&4?(l=e+(i-e)*(this.ymin-t)/(r-t),u=this.ymin):A&2?(u=t+(r-t)*(this.xmax-e)/(i-e),l=this.xmax):(u=t+(r-t)*(this.xmin-e)/(i-e),l=this.xmin),s?(e=l,t=u,s=this._regioncode(e,t)):(i=l,r=u,o=this._regioncode(i,r))}}_clipInfinite(e,t,i,r,s,o){let a=Array.from(t),l;if((l=this._project(a[0],a[1],i,r))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(l[0],l[1]),a=this._clipFinite(e,a))for(let u=0,A=a.length,p,g=this._edgecode(a[A-2],a[A-1]);u<A;u+=2)p=g,g=this._edgecode(a[u],a[u+1]),p&&g&&(u=this._edge(e,p,g,a,u),A=a.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(e,t,i,r,s){for(;t!==i;){let o,a;switch(t){case 5:t=4;continue;case 4:t=6,o=this.xmax,a=this.ymin;break;case 6:t=2;continue;case 2:t=10,o=this.xmax,a=this.ymax;break;case 10:t=8;continue;case 8:t=9,o=this.xmin,a=this.ymax;break;case 9:t=1;continue;case 1:t=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(e,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(e,t,i,r){let s=1/0,o,a,l;if(r<0){if(t<=this.ymin)return null;(o=(this.ymin-t)/r)<s&&(l=this.ymin,a=e+(s=o)*i)}else if(r>0){if(t>=this.ymax)return null;(o=(this.ymax-t)/r)<s&&(l=this.ymax,a=e+(s=o)*i)}if(i>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/i)<s&&(a=this.xmax,l=t+(s=o)*r)}else if(i<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/i)<s&&(a=this.xmin,l=t+(s=o)*r)}return[a,l]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const i=(t+2)%e.length,r=(t+4)%e.length;(e[t]===e[i]&&e[i]===e[r]||e[t+1]===e[i+1]&&e[i+1]===e[r+1])&&(e.splice(i,2),t-=2)}e.length||(e=null)}return e}}const RJ=2*Math.PI,Xh=Math.pow;function NJ(n){return n[0]}function PJ(n){return n[1]}function LJ(n){const{triangles:e,coords:t}=n;for(let i=0;i<e.length;i+=3){const r=2*e[i],s=2*e[i+1],o=2*e[i+2];if((t[o]-t[r])*(t[s+1]-t[r+1])-(t[s]-t[r])*(t[o+1]-t[r+1])>1e-10)return!1}return!0}function DJ(n,e,t){return[n+Math.sin(n+e)*t,e+Math.cos(n-e)*t]}class y4{static from(e,t=NJ,i=PJ,r){return new y4("length"in e?IJ(e,t,i,r):Float64Array.from(BJ(e,t,i,r)))}constructor(e){this._delaunator=new Ld(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&LJ(e)){this.collinear=Int32Array.from({length:t.length/2},(g,v)=>v).sort((g,v)=>t[2*g]-t[2*v]||t[2*g+1]-t[2*v+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],A=[t[2*l],t[2*l+1],t[2*u],t[2*u+1]],p=1e-8*Math.hypot(A[3]-A[1],A[2]-A[0]);for(let g=0,v=t.length/2;g<v;++g){const x=DJ(t[2*g],t[2*g+1],p);t[2*g]=x[0],t[2*g+1]=x[1]}this._delaunator=new Ld(t)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=i.length;l<u;++l){const A=s[l%3===2?l-2:l+1];(i[l]===-1||o[A]===-1)&&(o[A]=l)}for(let l=0,u=r.length;l<u;++l)a[r[l]]=l;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(e){return new CJ(this,e)}*neighbors(e){const{inedges:t,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const p=a.indexOf(e);p>0&&(yield a[p-1]),p<a.length-1&&(yield a[p+1]);return}const l=t[e];if(l===-1)return;let u=l,A=-1;do{if(yield A=o[u],u=u%3===2?u-2:u+1,o[u]!==e)return;if(u=s[u],u===-1){const p=i[(r[e]+1)%i.length];p!==A&&(yield p);return}}while(u!==l)}find(e,t,i=0){if(e=+e,e!==e||(t=+t,t!==t))return-1;const r=i;let s;for(;(s=this._step(i,e,t))>=0&&s!==i&&s!==r;)i=s;return s}_step(e,t,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:l,points:u}=this;if(r[e]===-1||!u.length)return(e+1)%(u.length>>1);let A=e,p=Xh(t-u[e*2],2)+Xh(i-u[e*2+1],2);const g=r[e];let v=g;do{let x=l[v];const S=Xh(t-u[x*2],2)+Xh(i-u[x*2+1],2);if(S<p&&(p=S,A=x),v=v%3===2?v-2:v+1,l[v]!==e)break;if(v=a[v],v===-1){if(v=s[(o[e]+1)%s.length],v!==x&&Xh(t-u[v*2],2)+Xh(i-u[v*2+1],2)<p)return v;break}}while(v!==g);return A}render(e){const t=e==null?e=new Dc:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l<o)continue;const u=s[o]*2,A=s[l]*2;e.moveTo(i[u],i[u+1]),e.lineTo(i[A],i[A+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){t===void 0&&(!e||typeof e.moveTo!="function")&&(t=e,e=null),t=t==null?2:+t;const i=e==null?e=new Dc:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],l=r[s+1];e.moveTo(a+t,l),e.arc(a,l,t,0,RJ)}return i&&i.value()}renderHull(e){const t=e==null?e=new Dc:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;e.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const l=2*i[a];e.lineTo(r[l],r[l+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new xy;return this.renderHull(e),e.value()}renderTriangle(e,t){const i=t==null?t=new Dc:void 0,{points:r,triangles:s}=this,o=s[e*=3]*2,a=s[e+1]*2,l=s[e+2]*2;return t.moveTo(r[o],r[o+1]),t.lineTo(r[a],r[a+1]),t.lineTo(r[l],r[l+1]),t.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,i=e.length/3;t<i;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new xy;return this.renderTriangle(e,t),t.value()}}function IJ(n,e,t,i){const r=n.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=n[o];s[o*2]=e.call(i,a,o,n),s[o*2+1]=t.call(i,a,o,n)}return s}function*BJ(n,e,t,i){let r=0;for(const s of n)yield e.call(i,s,r,n),yield t.call(i,s,r,n),++r}const x4=Math.PI,Kw=x4/2,Jw=180/x4,eS=x4/180,FJ=Math.atan2,tS=Math.cos,UJ=Math.max,OJ=Math.min,nS=Math.sin,kJ=Math.sign||function(n){return n>0?1:n<0?-1:0},L9=Math.sqrt;function VJ(n){return n>1?Kw:n<-1?-Kw:Math.asin(n)}function D9(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function fo(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function yg(n,e){return[n[0]+e[0],n[1]+e[1],n[2]+e[2]]}function xg(n){var e=L9(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);return[n[0]/e,n[1]/e,n[2]/e]}function b4(n){return[FJ(n[1],n[0])*Jw,VJ(UJ(-1,OJ(1,n[2])))*Jw]}function Wa(n){const e=n[0]*eS,t=n[1]*eS,i=tS(t);return[i*tS(e),i*nS(e),nS(t)]}function w4(n){return n=n.map(e=>Wa(e)),D9(n[0],fo(n[2],n[1]))}function GJ(n){const e=zJ(n),t=$J(e),i=HJ(t,n),r=jJ(t,n.length),s=qJ(r,n),o=WJ(t,n),{polygons:a,centers:l}=XJ(o,t,n),u=QJ(a),A=ZJ(t,n),p=YJ(i,t);return{delaunay:e,edges:i,triangles:t,centers:l,neighbors:r,polygons:a,mesh:u,hull:A,urquhart:p,find:s}}function qJ(n,e){function t(i,r){let s=i[0]-r[0],o=i[1]-r[1],a=i[2]-r[2];return s*s+o*o+a*a}return function(r,s,o){o===void 0&&(o=0);let a,l,u=o;const A=Wa([r,s]);do a=o,o=null,l=t(A,Wa(e[a])),n[a].forEach(p=>{let g=t(A,Wa(e[p]));if(g<l){l=g,o=p,u=p;return}});while(o!==null);return u}}function zJ(n){if(n.length<2)return{};let e=0;for(;isNaN(n[e][0]+n[e][1])&&e++<n.length;);const t=NY(n[e]),i=uZ().translate([0,0]).scale(1).rotate(t.invert([180,0]));n=n.map(i);const r=[];let s=1;for(let p=0,g=n.length;p<g;p++){let v=n[p][0]**2+n[p][1]**2;!isFinite(v)||v>1e32?r.push(p):v>s&&(s=v)}const o=1e6*L9(s);r.forEach(p=>n[p]=[o,0]),n.push([0,o]),n.push([-o,0]),n.push([0,-o]);const a=y4.from(n);a.projection=i;const{triangles:l,halfedges:u,inedges:A}=a;for(let p=0,g=u.length;p<g;p++)if(u[p]<0){const v=p%3==2?p-2:p+1,x=p%3==0?p+2:p-1,S=u[v],T=u[x];u[S]=T,u[T]=S,u[v]=u[x]=-1,l[p]=l[v]=l[x]=e,A[l[S]]=S%3==0?S+2:S-1,A[l[T]]=T%3==0?T+2:T-1,p+=2-p%3}else l[p]>n.length-3-1&&(l[p]=e);return a}function HJ(n,e){const t=new Set;return e.length===2?[[0,1]]:(n.forEach(i=>{if(i[0]!==i[1]&&!(w4(i.map(r=>e[r]))<0))for(let r=0,s;r<3;r++)s=(r+1)%3,t.add(j1([i[r],i[s]]).join("-"))}),Array.from(t,i=>i.split("-").map(Number)))}function $J(n){const{triangles:e}=n;if(!e)return[];const t=[];for(let i=0,r=e.length/3;i<r;i++){const s=e[3*i],o=e[3*i+1],a=e[3*i+2];s!==o&&o!==a&&t.push([s,a,o])}return t}function WJ(n,e){return n.map(t=>{const i=t.map(s=>e[s]).map(Wa),r=yg(yg(fo(i[1],i[0]),fo(i[2],i[1])),fo(i[0],i[2]));return b4(xg(r))})}function jJ(n,e){const t=[];return n.forEach(i=>{for(let r=0;r<3;r++){const s=i[r],o=i[(r+1)%3];t[s]=t[s]||[],t[s].push(o)}}),n.length===0&&(e===2?(t[0]=[1],t[1]=[0]):e===1&&(t[0]=[])),t}function XJ(n,e,t){const i=[],r=n.slice();if(e.length===0){if(t.length<2)return{polygons:i,centers:r};if(t.length===2){const a=Wa(t[0]),l=Wa(t[1]),u=xg(yg(a,l)),A=xg(fo(a,l)),p=fo(u,A),g=[u,fo(u,p),fo(fo(u,p),p),fo(fo(fo(u,p),p),p)].map(b4).map(o);return i.push(g),i.push(g.slice().reverse()),{polygons:i,centers:r}}}e.forEach((a,l)=>{for(let u=0;u<3;u++){const A=a[u],p=a[(u+1)%3],g=a[(u+2)%3];i[A]=i[A]||[],i[A].push([p,g,l,[A,p,g]])}});const s=i.map(a=>{const l=[a[0][2]];let u=a[0][1];for(let A=1;A<a.length;A++)for(let p=0;p<a.length;p++)if(a[p][0]==u){u=a[p][1],l.push(a[p][2]);break}if(l.length>2)return l;if(l.length==2){const A=iS(t[a[0][3][0]],t[a[0][3][1]],r[l[0]]),p=iS(t[a[0][3][2]],t[a[0][3][0]],r[l[0]]),g=o(A),v=o(p);return[l[0],v,l[1],g]}});function o(a){let l=-1;return r.slice(e.length,1/0).forEach((u,A)=>{u[0]===a[0]&&u[1]===a[1]&&(l=A+e.length)}),l<0&&(l=r.length,r.push(a)),l}return{polygons:s,centers:r}}function iS(n,e,t){n=Wa(n),e=Wa(e),t=Wa(t);const i=kJ(D9(fo(e,n),t));return b4(xg(yg(n,e)).map(r=>i*r))}function QJ(n){const e=[];return n.forEach(t=>{if(!t)return;let i=t[t.length-1];for(let r of t)r>i&&e.push([i,r]),i=r}),e}function YJ(n,e){return function(t){const i=new Map,r=new Map;return n.forEach((s,o)=>{const a=s.join("-");i.set(a,t[o]),r.set(a,!0)}),e.forEach(s=>{let o=0,a=-1;for(let l=0;l<3;l++){let u=j1([s[l],s[(l+1)%3]]).join("-");i.get(u)>o&&(o=i.get(u),a=u)}r.set(a,!1)}),n.map(s=>r.get(s.join("-")))}}function ZJ(n,e){const t=new Set,i=[];n.map(a=>{if(!(w4(a.map(l=>e[l>e.length?0:l]))>1e-12))for(let l=0;l<3;l++){let u=[a[l],a[(l+1)%3]],A=`${u[0]}-${u[1]}`;t.has(A)?t.delete(A):t.add(`${u[1]}-${u[0]}`)}});const r=new Map;let s;if(t.forEach(a=>{a=a.split("-").map(Number),r.set(a[0],a[1]),s=a[0]}),s===void 0)return i;let o=s;do{i.push(o);let a=r.get(o);r.set(o,-1),o=a}while(o>-1&&o!==s);return i}function KJ(n){const e=function(t){if(e.delaunay=null,e._data=t,typeof e._data=="object"&&e._data.type==="FeatureCollection"&&(e._data=e._data.features),typeof e._data=="object"){const i=e._data.map(r=>[e._vx(r),e._vy(r),r]).filter(r=>isFinite(r[0]+r[1]));e.points=i.map(r=>[r[0],r[1]]),e.valid=i.map(r=>r[2]),e.delaunay=GJ(e.points)}return e};return e._vx=function(t){if(typeof t=="object"&&"type"in t)return dw(t)[0];if(0 in t)return t[0]},e._vy=function(t){if(typeof t=="object"&&"type"in t)return dw(t)[1];if(1 in t)return t[1]},e.x=function(t){return t?(e._vx=t,e):e._vx},e.y=function(t){return t?(e._vy=t,e):e._vy},e.polygons=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const i={type:"FeatureCollection",features:[]};return e.valid.length===0||(e.delaunay.polygons.forEach((r,s)=>i.features.push({type:"Feature",geometry:r?{type:"Polygon",coordinates:[[...r,r[0]].map(o=>e.delaunay.centers[o])]}:null,properties:{site:e.valid[s],sitecoordinates:e.points[s],neighbours:e.delaunay.neighbors[s]}})),e.valid.length===1&&i.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:e.valid[0],sitecoordinates:e.points[0],neighbours:[]}})),i},e.triangles=function(t){return t!==void 0&&e(t),e.delaunay?{type:"FeatureCollection",features:e.delaunay.triangles.map((i,r)=>(i=i.map(s=>e.points[s]),i.center=e.delaunay.centers[r],i)).filter(i=>w4(i)>0).map(i=>({type:"Feature",properties:{circumcenter:i.center},geometry:{type:"Polygon",coordinates:[[...i,i[0]]]}}))}:!1},e.links=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const i=e.delaunay.edges.map(s=>ku(e.points[s[0]],e.points[s[1]])),r=e.delaunay.urquhart(i);return{type:"FeatureCollection",features:e.delaunay.edges.map((s,o)=>({type:"Feature",properties:{source:e.valid[s[0]],target:e.valid[s[1]],length:i[o],urquhart:!!r[o]},geometry:{type:"LineString",coordinates:[e.points[s[0]],e.points[s[1]]]}}))}},e.mesh=function(t){return t!==void 0&&e(t),e.delaunay?{type:"MultiLineString",coordinates:e.delaunay.edges.map(i=>[e.points[i[0]],e.points[i[1]]])}:!1},e.cellMesh=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const{centers:i,polygons:r}=e.delaunay,s=[];for(const o of r)if(o)for(let a=o.length,l=o[a-1],u=o[0],A=0;A<a;l=u,u=o[++A])u>l&&s.push([i[l],i[u]]);return{type:"MultiLineString",coordinates:s}},e._found=void 0,e.find=function(t,i,r){if(e._found=e.delaunay.find(t,i,e._found),!r||ku([t,i],e.points[e._found])<r)return e._found},e.hull=function(t){t!==void 0&&e(t);const i=e.delaunay.hull,r=e.points;return i.length===0?null:{type:"Polygon",coordinates:[[...i.map(s=>r[s]),r[i[0]]]]}},n?e(n):e}function by(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function JJ(n){if(Array.isArray(n))return n}function eee(n){if(Array.isArray(n))return by(n)}function tee(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function nee(n,e,t){return e=bg(e),cee(n,I9()?Reflect.construct(e,[],bg(n).constructor):e.apply(n,t))}function iee(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function ree(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function bg(n){return bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bg(n)}function see(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&wy(n,e)}function I9(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(I9=function(){return!!n})()}function oee(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function aee(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function lee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cee(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tee(n)}function wy(n,e){return wy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},wy(n,e)}function ka(n,e){return JJ(n)||aee(n,e)||B9(n,e)||lee()}function T3(n){return eee(n)||oee(n)||B9(n)||uee()}function B9(n,e){if(n){if(typeof n=="string")return by(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?by(n,e):void 0}}function hee(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.resolution,i=t===void 0?1/0:t,r=fee(n,i),s=Sd(r),o=Aee(n,i),a=[].concat(T3(s),T3(o)),l={type:"Polygon",coordinates:n},u=t9(l),A=ka(u,2),p=ka(A[0],2),g=p[0],v=p[1],x=ka(A[1],2),S=x[0],T=x[1],w=g>S||T>=89||v<=-89,R=[];if(w){var E=KJ(a).triangles(),N=new Map(a.map(function(Z,J){var fe=ka(Z,2),ge=fe[0],pe=fe[1];return["".concat(ge,"-").concat(pe),J]}));E.features.forEach(function(Z){var J,fe=Z.geometry.coordinates[0].slice(0,3).reverse(),ge=[];if(fe.forEach(function(Ae){var Fe=ka(Ae,2),be=Fe[0],Ve=Fe[1],Ye="".concat(be,"-").concat(Ve);N.has(Ye)&&ge.push(N.get(Ye))}),ge.length===3){if(ge.some(function(Ae){return Ae<s.length})){var pe=Z.properties.circumcenter;if(!Sy(pe,l,w))return}(J=R).push.apply(J,ge)}})}else if(o.length)for(var L=Ld.from(a),F=function(J){var fe,ge=[2,1,0].map(function(Fe){return L.triangles[J+Fe]}),pe=ge.map(function(Fe){return a[Fe]});if(ge.some(function(Fe){return Fe<s.length})){var Ae=[0,1].map(function(Fe){return wQ(pe,function(be){return be[Fe]})});if(!Sy(Ae,l,w))return 1}(fe=R).push.apply(fe,T3(ge))},V=0,H=L.triangles.length;V<H;V+=3)F(V);else{var D=mg(r),B=D.vertices,I=D.holes,O=I===void 0?[]:I;R=DZ(B,O,2)}var Q=kl(j1(a,function(Z){return Z[0]}),[0,1]),te=kl(j1(a,function(Z){return Z[1]}),[0,1]),K=a.map(function(Z){var J=ka(Z,2),fe=J[0],ge=J[1];return[Q(fe),te(ge)]}),W={points:a,indices:R,uvs:K};return{contour:r,triangles:W}}function fee(n,e){return n.map(function(t){var i=[],r;return t.forEach(function(s){if(r){var o=ku(s,r)*180/Math.PI;if(o>e)for(var a=d4(r,s),l=1/Math.ceil(o/e),u=l;u<1;)i.push(a(u)),u+=l}i.push(r=s)}),i})}function Aee(n,e){var t={type:"Polygon",coordinates:n},i=t9(t),r=ka(i,2),s=ka(r[0],2),o=s[0],a=s[1],l=ka(r[1],2),u=l[0],A=l[1];if(Math.min(Math.abs(u-o),Math.abs(A-a))<e)return[];var p=o>u||A>=89||a<=-89;return dee(e,{minLng:o,maxLng:u,minLat:a,maxLat:A}).filter(function(g){return Sy(g,t,p)})}function dee(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.minLng,i=e.maxLng,r=e.minLat,s=e.maxLat,o=Math.round(Math.pow(360/n,2)/Math.PI),a=(1+Math.sqrt(5))/2,l=function(w){return w/a*360%360-180},u=function(w){return Math.acos(2*w/o-1)/Math.PI*180-90},A=function(w){return o*(Math.cos((w+90)*Math.PI/180)+1)/2},p=[s!==void 0?Math.ceil(A(s)):0,r!==void 0?Math.floor(A(r)):o-1],g=t===void 0&&i===void 0?function(){return!0}:t===void 0?function(T){return T<=i}:i===void 0?function(T){return T>=t}:i>=t?function(T){return T>=t&&T<=i}:function(T){return T>=t||T<=i},v=[],x=p[0];x<=p[1];x++){var S=l(x);g(S)&&v.push([S,u(x)])}return v}function Sy(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?jY(e,n):EJ(n,e)}var y1=window.THREE?window.THREE:{BufferGeometry:Ai,Float32BufferAttribute:ei},rS=new y1.BufferGeometry().setAttribute?"setAttribute":"addAttribute",S4=function(n){function e(t,i,r,s,o,a,l){var u;iee(this,e),u=nee(this,e),u.type="ConicPolygonGeometry",u.parameters={polygonGeoJson:t,bottomHeight:i,topHeight:r,closedBottom:s,closedTop:o,includeSides:a,curvatureResolution:l},i=i||0,r=r||1,s=s!==void 0?s:!0,o=o!==void 0?o:!0,a=a!==void 0?a:!0,l=l||5;var A=hee(t,{resolution:l}),p=A.contour,g=A.triangles,v=Sd(g.uvs),x=[],S=[],T=[],w=0,R=function(I){var O=Math.round(x.length/3),L=T.length;x=x.concat(I.vertices),S=S.concat(I.uvs),T=T.concat(O?I.indices.map(function(F){return F+O}):I.indices),u.addGroup(L,T.length-L,w++)};a&&R(N()),s&&R(D(i,!1)),o&&R(D(r,!0)),u.setIndex(T),u[rS]("position",new y1.Float32BufferAttribute(x,3)),u[rS]("uv",new y1.Float32BufferAttribute(S,2)),u.computeVertexNormals();function E(B,I){var O=typeof I=="function"?I:function(){return I},L=B.map(function(F){return F.map(function(V){var H=ka(V,2),Q=H[0],te=H[1];return pee(te,Q,O(Q,te))})});return mg(L)}function N(){for(var B=E(p,i),I=B.vertices,O=B.holes,L=E(p,r),F=L.vertices,V=Sd([F,I]),H=Math.round(F.length/3),Q=new Set(O),te=0,K=[],W=0;W<H;W++){var Z=W+1;if(Z===H)Z=te;else if(Q.has(Z)){var J=Z;Z=te,te=J}K.push(W,W+H,Z+H),K.push(Z+H,Z,W)}for(var fe=[],ge=1;ge>=0;ge--)for(var pe=0;pe<H;pe+=1)fe.push(pe/(H-1),ge);return{indices:K,vertices:V,uvs:fe}}function D(B){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{indices:I?g.indices:g.indices.slice().reverse(),vertices:E([g.points],B).vertices,uvs:v}}return u}return see(e,n),ree(e)}(y1.BufferGeometry);function pee(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180;return[t*Math.sin(i)*Math.cos(r),t*Math.cos(i),t*Math.sin(i)*Math.sin(r)]}function Ty(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function mee(n){if(Array.isArray(n))return n}function gee(n){if(Array.isArray(n))return Ty(n)}function _ee(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function vee(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function yee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bee(n,e){if(n==null)return{};var t,i,r=wee(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function wee(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.includes(i))continue;t[i]=n[i]}return t}function See(n,e){return mee(n)||vee(n,e)||F9(n,e)||yee()}function Tee(n){return gee(n)||_ee(n)||F9(n)||xee()}function Mee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function Eee(n){var e=Mee(n,"string");return typeof e=="symbol"?e:e+""}function F9(n,e){if(n){if(typeof n=="string")return Ty(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ty(n,e):void 0}}var Cee=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(a){return{keyAccessor:a,isProp:!(a instanceof Function)}}),s=n.reduce(function(a,l){var u=a,A=l;return r.forEach(function(p,g){var v=p.keyAccessor,x=p.isProp,S;if(x){var T=A,w=T[v],R=bee(T,[v].map(Eee));S=w,A=R}else S=v(A,g);g+1<r.length?(u.hasOwnProperty(S)||(u[S]={}),u=u[S]):t?(u.hasOwnProperty(S)||(u[S]=[]),u[S].push(A)):u[S]=A}),a},{});t instanceof Function&&function a(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;u===r.length?Object.keys(l).forEach(function(A){return l[A]=t(l[A])}):Object.values(l).forEach(function(A){return a(A,u+1)})}(s);var o=s;return i&&(o=[],function a(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];u.length===r.length?o.push({keys:u,vals:l}):Object.entries(l).forEach(function(A){var p=See(A,2),g=p[0],v=p[1];return a(v,[].concat(Tee(u),[g]))})}(s),e instanceof Array&&e.length===0&&o.length===1&&(o[0].keys=[])),o},kn=function(n){n=n||{};var e=typeof n<"u"?n:{},t={},i;for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);var r="";function s(Ge){return e.locateFile?e.locateFile(Ge,r):r+Ge}var o;typeof document<"u"&&document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",o=function(Ze,xt,nt){var h=new XMLHttpRequest;h.open("GET",Ze,!0),h.responseType="arraybuffer",h.onload=function(){if(h.status==200||h.status==0&&h.response){xt(h.response);return}var Dn=tn(Ze);if(Dn){xt(Dn.buffer);return}nt()},h.onerror=nt,h.send(null)};var a=e.print||console.log.bind(console),l=e.printErr||console.warn.bind(console);for(i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);t=null,e.arguments&&e.arguments;var u=0,A=function(Ge){u=Ge},p=function(){return u},g=8;function v(Ge,Ze,xt,nt){switch(xt=xt||"i8",xt.charAt(xt.length-1)==="*"&&(xt="i32"),xt){case"i1":H[Ge>>0]=Ze;break;case"i8":H[Ge>>0]=Ze;break;case"i16":te[Ge>>1]=Ze;break;case"i32":K[Ge>>2]=Ze;break;case"i64":Ue=[Ze>>>0,(Me=Ze,+ce(Me)>=1?Me>0?(ye(+Ee(Me/4294967296),4294967295)|0)>>>0:~~+G((Me-+(~~Me>>>0))/4294967296)>>>0:0)],K[Ge>>2]=Ue[0],K[Ge+4>>2]=Ue[1];break;case"float":W[Ge>>2]=Ze;break;case"double":Z[Ge>>3]=Ze;break;default:Jr("invalid type for setValue: "+xt)}}function x(Ge,Ze,xt){switch(Ze=Ze||"i8",Ze.charAt(Ze.length-1)==="*"&&(Ze="i32"),Ze){case"i1":return H[Ge>>0];case"i8":return H[Ge>>0];case"i16":return te[Ge>>1];case"i32":return K[Ge>>2];case"i64":return K[Ge>>2];case"float":return W[Ge>>2];case"double":return Z[Ge>>3];default:Jr("invalid type for getValue: "+Ze)}return null}var S=!1;function T(Ge,Ze){Ge||Jr("Assertion failed: "+Ze)}function w(Ge){var Ze=e["_"+Ge];return T(Ze,"Cannot call unknown function "+Ge+", make sure it is exported"),Ze}function R(Ge,Ze,xt,nt,h){var $={string:function(Sn){var Os=0;if(Sn!=null&&Sn!==0){var gh=(Sn.length<<2)+1;Os=We(gh),O(Sn,Os,gh)}return Os},array:function(Sn){var Os=We(Sn.length);return L(Sn,Os),Os}};function Dn(Sn){return Ze==="string"?B(Sn):Ze==="boolean"?!!Sn:Sn}var jn=w(Ge),zi=[],_n=0;if(nt)for(var Un=0;Un<nt.length;Un++){var wa=$[xt[Un]];wa?(_n===0&&(_n=Pt()),zi[Un]=wa(nt[Un])):zi[Un]=nt[Un]}var $n=jn.apply(null,zi);return $n=Dn($n),_n!==0&&it(_n),$n}function E(Ge,Ze,xt,nt){xt=xt||[];var h=xt.every(function(Dn){return Dn==="number"}),$=Ze!=="string";return $&&h&&!nt?w(Ge):function(){return R(Ge,Ze,xt,arguments)}}var N=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function D(Ge,Ze,xt){for(var nt=Ze+xt,h=Ze;Ge[h]&&!(h>=nt);)++h;if(h-Ze>16&&Ge.subarray&&N)return N.decode(Ge.subarray(Ze,h));for(var $="";Ze<h;){var Dn=Ge[Ze++];if(!(Dn&128)){$+=String.fromCharCode(Dn);continue}var jn=Ge[Ze++]&63;if((Dn&224)==192){$+=String.fromCharCode((Dn&31)<<6|jn);continue}var zi=Ge[Ze++]&63;if((Dn&240)==224?Dn=(Dn&15)<<12|jn<<6|zi:Dn=(Dn&7)<<18|jn<<12|zi<<6|Ge[Ze++]&63,Dn<65536)$+=String.fromCharCode(Dn);else{var _n=Dn-65536;$+=String.fromCharCode(55296|_n>>10,56320|_n&1023)}}return $}function B(Ge,Ze){return Ge?D(Q,Ge,Ze):""}function I(Ge,Ze,xt,nt){if(!(nt>0))return 0;for(var h=xt,$=xt+nt-1,Dn=0;Dn<Ge.length;++Dn){var jn=Ge.charCodeAt(Dn);if(jn>=55296&&jn<=57343){var zi=Ge.charCodeAt(++Dn);jn=65536+((jn&1023)<<10)|zi&1023}if(jn<=127){if(xt>=$)break;Ze[xt++]=jn}else if(jn<=2047){if(xt+1>=$)break;Ze[xt++]=192|jn>>6,Ze[xt++]=128|jn&63}else if(jn<=65535){if(xt+2>=$)break;Ze[xt++]=224|jn>>12,Ze[xt++]=128|jn>>6&63,Ze[xt++]=128|jn&63}else{if(xt+3>=$)break;Ze[xt++]=240|jn>>18,Ze[xt++]=128|jn>>12&63,Ze[xt++]=128|jn>>6&63,Ze[xt++]=128|jn&63}}return Ze[xt]=0,xt-h}function O(Ge,Ze,xt){return I(Ge,Q,Ze,xt)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function L(Ge,Ze){H.set(Ge,Ze)}function F(Ge,Ze){return Ge%Ze>0&&(Ge+=Ze-Ge%Ze),Ge}var V,H,Q,te,K,W,Z;function J(Ge){V=Ge,e.HEAP8=H=new Int8Array(Ge),e.HEAP16=te=new Int16Array(Ge),e.HEAP32=K=new Int32Array(Ge),e.HEAPU8=Q=new Uint8Array(Ge),e.HEAPU16=new Uint16Array(Ge),e.HEAPU32=new Uint32Array(Ge),e.HEAPF32=W=new Float32Array(Ge),e.HEAPF64=Z=new Float64Array(Ge)}var fe=5271520,ge=28608,pe=e.TOTAL_MEMORY||33554432;e.buffer?V=e.buffer:V=new ArrayBuffer(pe),pe=V.byteLength,J(V),K[ge>>2]=fe;function Ae(Ge){for(;Ge.length>0;){var Ze=Ge.shift();if(typeof Ze=="function"){Ze();continue}var xt=Ze.func;typeof xt=="number"?Ze.arg===void 0?e.dynCall_v(xt):e.dynCall_vi(xt,Ze.arg):xt(Ze.arg===void 0?null:Ze.arg)}}var Fe=[],be=[],Ve=[],Ye=[];function Xe(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Ut(e.preRun.shift());Ae(Fe)}function Tt(){Ae(be)}function yt(){Ae(Ve)}function ut(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)ue(e.postRun.shift());Ae(Ye)}function Ut(Ge){Fe.unshift(Ge)}function ue(Ge){Ye.unshift(Ge)}var ce=Math.abs,G=Math.ceil,Ee=Math.floor,ye=Math.min,we=0,Se=null;function ze(Ge){we++,e.monitorRunDependencies&&e.monitorRunDependencies(we)}function Ne(Ge){if(we--,e.monitorRunDependencies&&e.monitorRunDependencies(we),we==0&&Se){var Ze=Se;Se=null,Ze()}}e.preloadedImages={},e.preloadedAudios={};var j=null,q="data:application/octet-stream;base64,";function he(Ge){return String.prototype.startsWith?Ge.startsWith(q):Ge.indexOf(q)===0}var Me,Ue;j="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Be=28624;function At(Ge,Ze,xt,nt){Jr("Assertion failed: "+B(Ge)+", at: "+[Ze?B(Ze):"unknown filename",xt,nt?B(nt):"unknown function"])}function tt(){return H.length}function Nt(Ge,Ze,xt){Q.set(Q.subarray(Ze,Ze+xt),Ge)}function It(Ge){return e.___errno_location&&(K[e.___errno_location()>>2]=Ge),Ge}function st(Ge){Jr("OOM")}function bt(Ge){try{var Ze=new ArrayBuffer(Ge);return Ze.byteLength!=Ge?void 0:(new Int8Array(Ze).set(H),Rt(Ze),J(Ze),1)}catch{}}function Gt(Ge){var Ze=tt(),xt=16777216,nt=2147483648-xt;if(Ge>nt)return!1;for(var h=16777216,$=Math.max(Ze,h);$<Ge;)$<=536870912?$=F(2*$,xt):$=Math.min(F((3*$+2147483648)/4,xt),nt);var Dn=bt($);return!!Dn}var Zt=typeof atob=="function"?atob:function(Ge){var Ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",xt="",nt,h,$,Dn,jn,zi,_n,Un=0;Ge=Ge.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Dn=Ze.indexOf(Ge.charAt(Un++)),jn=Ze.indexOf(Ge.charAt(Un++)),zi=Ze.indexOf(Ge.charAt(Un++)),_n=Ze.indexOf(Ge.charAt(Un++)),nt=Dn<<2|jn>>4,h=(jn&15)<<4|zi>>2,$=(zi&3)<<6|_n,xt=xt+String.fromCharCode(nt),zi!==64&&(xt=xt+String.fromCharCode(h)),_n!==64&&(xt=xt+String.fromCharCode($));while(Un<Ge.length);return xt};function wt(Ge){try{for(var Ze=Zt(Ge),xt=new Uint8Array(Ze.length),nt=0;nt<Ze.length;++nt)xt[nt]=Ze.charCodeAt(nt);return xt}catch{throw new Error("Converting base64 string to bytes failed.")}}function tn(Ge){if(he(Ge))return wt(Ge.slice(q.length))}var Ot={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},fn={b:A,c:p,d:At,e:It,f:tt,g:Nt,h:Gt,i:st,o:Be,p:ge},ne=function(Ge,Ze,xt){"almost asm";var nt=new Ge.Int8Array(xt),h=new Ge.Int32Array(xt);new Ge.Uint8Array(xt),new Ge.Float32Array(xt);var $=new Ge.Float64Array(xt),Dn=Ze.o|0,jn=Ze.p|0,zi=Ge.Math.floor,_n=Ge.Math.abs,Un=Ge.Math.sqrt,wa=Ge.Math.pow,$n=Ge.Math.cos,Sn=Ge.Math.sin,Os=Ge.Math.tan,gh=Ge.Math.acos,W2=Ge.Math.asin,ee=Ge.Math.atan,Ce=Ge.Math.atan2,qe=Ge.Math.ceil,ke=Ge.Math.imul,De=Ge.Math.min,mt=Ge.Math.max,St=Ge.Math.clz32,et=Ze.b,X=Ze.c,ft=Ze.d,sn=Ze.e,Yt=Ze.f,qn=Ze.g,Qn=Ze.h,Xi=Ze.i,z=28640;function Wn(c){return nt=new Int8Array(c),h=new Int32Array(c),$=new Float64Array(c),xt=c,!0}function Kt(c){c=c|0;var f=0;return f=z,z=z+c|0,z=z+15&-16,f|0}function br(){return z|0}function Yn(c){c=c|0,z=c}function no(c,f){c=c|0,z=c}function Kl(c,f){c=c|0,f=f|0;var d=0,m=0,_=0;return(c|0)<0?(f=2,f|0):(c|0)>13780509?(f=f_(15,f)|0,f|0):(d=((c|0)<0)<<31>>31,_=is(c|0,d|0,3,0)|0,m=X()|0,d=Qt(c|0,d|0,1,0)|0,d=is(_|0,m|0,d|0,X()|0)|0,d=Qt(d|0,X()|0,1,0)|0,c=X()|0,h[f>>2]=d,h[f+4>>2]=c,f=0,f|0)}function es(c,f,d,m){return c=c|0,f=f|0,d=d|0,m=m|0,Jl(c,f,d,m,0)|0}function Jl(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0;if(C=z,z=z+16|0,b=C,!(vi(c,f,d,m,_)|0))return m=0,z=C,m|0;do if((d|0)>=0){if((d|0)>13780509){if(y=f_(15,b)|0,y|0)break;M=b,b=h[M>>2]|0,M=h[M+4>>2]|0}else y=((d|0)<0)<<31>>31,P=is(d|0,y|0,3,0)|0,M=X()|0,y=Qt(d|0,y|0,1,0)|0,y=is(P|0,M|0,y|0,X()|0)|0,y=Qt(y|0,X()|0,1,0)|0,M=X()|0,h[b>>2]=y,h[b+4>>2]=M,b=y;if(ec(m|0,0,b<<3|0)|0,_|0){ec(_|0,0,b<<2|0)|0,y=Qi(c,f,d,m,_,b,M,0)|0;break}y=Co(b,4)|0,y?(P=Qi(c,f,d,m,y,b,M,0)|0,Jt(y),y=P):y=13}else y=2;while(!1);return P=y,z=C,P|0}function vi(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0;if(me=z,z=z+16|0,se=me,oe=me+8|0,le=se,h[le>>2]=c,h[le+4>>2]=f,(d|0)<0)return oe=2,z=me,oe|0;if(y=m,h[y>>2]=c,h[y+4>>2]=f,y=(_|0)!=0,y&&(h[_>>2]=0),di(c,f)|0)return oe=9,z=me,oe|0;h[oe>>2]=0;e:do if((d|0)>=1)if(y)for(k=1,P=0,Y=0,le=1,y=c;;){if(!(P|Y)){if(y=ti(y,f,4,oe,se)|0,y|0)break e;if(f=se,y=h[f>>2]|0,f=h[f+4>>2]|0,di(y,f)|0){y=9;break e}}if(y=ti(y,f,h[26800+(Y<<2)>>2]|0,oe,se)|0,y|0)break e;if(f=se,y=h[f>>2]|0,f=h[f+4>>2]|0,c=m+(k<<3)|0,h[c>>2]=y,h[c+4>>2]=f,h[_+(k<<2)>>2]=le,c=P+1|0,b=(c|0)==(le|0),M=Y+1|0,C=(M|0)==6,di(y,f)|0){y=9;break e}if(le=le+(C&b&1)|0,(le|0)>(d|0)){y=0;break}else k=k+1|0,P=b?0:c,Y=b?C?0:M:Y}else for(k=1,P=0,Y=0,le=1,y=c;;){if(!(P|Y)){if(y=ti(y,f,4,oe,se)|0,y|0)break e;if(f=se,y=h[f>>2]|0,f=h[f+4>>2]|0,di(y,f)|0){y=9;break e}}if(y=ti(y,f,h[26800+(Y<<2)>>2]|0,oe,se)|0,y|0)break e;if(f=se,y=h[f>>2]|0,f=h[f+4>>2]|0,c=m+(k<<3)|0,h[c>>2]=y,h[c+4>>2]=f,c=P+1|0,b=(c|0)==(le|0),M=Y+1|0,C=(M|0)==6,di(y,f)|0){y=9;break e}if(le=le+(C&b&1)|0,(le|0)>(d|0)){y=0;break}else k=k+1|0,P=b?0:c,Y=b?C?0:M:Y}else y=0;while(!1);return oe=y,z=me,oe|0}function Qi(c,f,d,m,_,y,b,M){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0,y=y|0,b=b|0,M=M|0;var C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0;if(me=z,z=z+16|0,se=me+8|0,oe=me,C=wh(c|0,f|0,y|0,b|0)|0,k=X()|0,Y=m+(C<<3)|0,Te=Y,Oe=h[Te>>2]|0,Te=h[Te+4>>2]|0,P=(Oe|0)==(c|0)&(Te|0)==(f|0),!((Oe|0)==0&(Te|0)==0|P))do C=Qt(C|0,k|0,1,0)|0,C=bh(C|0,X()|0,y|0,b|0)|0,k=X()|0,Y=m+(C<<3)|0,Oe=Y,Te=h[Oe>>2]|0,Oe=h[Oe+4>>2]|0,P=(Te|0)==(c|0)&(Oe|0)==(f|0);while(!((Te|0)==0&(Oe|0)==0|P));if(C=_+(C<<2)|0,P&&(h[C>>2]|0)<=(M|0)||(Oe=Y,h[Oe>>2]=c,h[Oe+4>>2]=f,h[C>>2]=M,(M|0)>=(d|0)))return Oe=0,z=me,Oe|0;switch(P=M+1|0,h[se>>2]=0,C=ti(c,f,2,se,oe)|0,C|0){case 9:{le=9;break}case 0:{C=oe,C=Qi(h[C>>2]|0,h[C+4>>2]|0,d,m,_,y,b,P)|0,C||(le=9);break}}e:do if((le|0)==9){switch(h[se>>2]=0,C=ti(c,f,3,se,oe)|0,C|0){case 9:break;case 0:{if(C=oe,C=Qi(h[C>>2]|0,h[C+4>>2]|0,d,m,_,y,b,P)|0,C|0)break e;break}default:break e}switch(h[se>>2]=0,C=ti(c,f,1,se,oe)|0,C|0){case 9:break;case 0:{if(C=oe,C=Qi(h[C>>2]|0,h[C+4>>2]|0,d,m,_,y,b,P)|0,C|0)break e;break}default:break e}switch(h[se>>2]=0,C=ti(c,f,5,se,oe)|0,C|0){case 9:break;case 0:{if(C=oe,C=Qi(h[C>>2]|0,h[C+4>>2]|0,d,m,_,y,b,P)|0,C|0)break e;break}default:break e}switch(h[se>>2]=0,C=ti(c,f,4,se,oe)|0,C|0){case 9:break;case 0:{if(C=oe,C=Qi(h[C>>2]|0,h[C+4>>2]|0,d,m,_,y,b,P)|0,C|0)break e;break}default:break e}switch(h[se>>2]=0,C=ti(c,f,6,se,oe)|0,C|0){case 9:break;case 0:{if(C=oe,C=Qi(h[C>>2]|0,h[C+4>>2]|0,d,m,_,y,b,P)|0,C|0)break e;break}default:break e}return Oe=0,z=me,Oe|0}while(!1);return Oe=C,z=me,Oe|0}function ti(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0;if(d>>>0>6)return _=1,_|0;if(Y=(h[m>>2]|0)%6|0,h[m>>2]=Y,(Y|0)>0){y=0;do d=Zu(d)|0,y=y+1|0;while((y|0)<(h[m>>2]|0))}if(Y=rt(c|0,f|0,45)|0,X()|0,k=Y&127,k>>>0>121)return _=5,_|0;C=ks(c,f)|0,y=rt(c|0,f|0,52)|0,X()|0,y=y&15;e:do if(!y)P=8;else{for(;;){if(b=(15-y|0)*3|0,M=rt(c|0,f|0,b|0)|0,X()|0,M=M&7,(M|0)==7){f=5;break}if(oe=(Mo(y)|0)==0,y=y+-1|0,le=dt(7,0,b|0)|0,f=f&~(X()|0),se=dt(h[(oe?432:16)+(M*28|0)+(d<<2)>>2]|0,0,b|0)|0,b=X()|0,d=h[(oe?640:224)+(M*28|0)+(d<<2)>>2]|0,c=se|c&~le,f=b|f,!d){d=0;break e}if(!y){P=8;break e}}return f|0}while(!1);(P|0)==8&&(oe=h[848+(k*28|0)+(d<<2)>>2]|0,se=dt(oe|0,0,45)|0,c=se|c,f=X()|0|f&-1040385,d=h[4272+(k*28|0)+(d<<2)>>2]|0,(oe&127|0)==127&&(oe=dt(h[848+(k*28|0)+20>>2]|0,0,45)|0,f=X()|0|f&-1040385,d=h[4272+(k*28|0)+20>>2]|0,c=Ku(oe|c,f)|0,f=X()|0,h[m>>2]=(h[m>>2]|0)+1)),M=rt(c|0,f|0,45)|0,X()|0,M=M&127;e:do if(Ni(M)|0){t:do if((ks(c,f)|0)==1){if((k|0)!=(M|0))if(Xb(M,h[7696+(k*28|0)>>2]|0)|0){c=o_(c,f)|0,b=1,f=X()|0;break}else ft(27795,26864,436,26872);switch(C|0){case 3:{c=Ku(c,f)|0,f=X()|0,h[m>>2]=(h[m>>2]|0)+1,b=0;break t}case 5:{c=o_(c,f)|0,f=X()|0,h[m>>2]=(h[m>>2]|0)+5,b=0;break t}case 0:return oe=9,oe|0;default:return oe=1,oe|0}}else b=0;while(!1);if((d|0)>0){y=0;do c=s_(c,f)|0,f=X()|0,y=y+1|0;while((y|0)!=(d|0))}if((k|0)!=(M|0)){if(!(j2(M)|0)){if((b|0)!=0|(ks(c,f)|0)!=5)break;h[m>>2]=(h[m>>2]|0)+1;break}switch(Y&127){case 8:case 118:break e}(ks(c,f)|0)!=3&&(h[m>>2]=(h[m>>2]|0)+1)}}else if((d|0)>0){y=0;do c=Ku(c,f)|0,f=X()|0,y=y+1|0;while((y|0)!=(d|0))}while(!1);return h[m>>2]=((h[m>>2]|0)+d|0)%6|0,oe=_,h[oe>>2]=c,h[oe+4>>2]=f,oe=0,oe|0}function wr(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0;for(M=z,z=z+16|0,y=M,b=M+8|0,_=(di(c,f)|0)==0,_=_?1:2;;){if(h[b>>2]=0,P=(ti(c,f,_,b,y)|0)==0,C=y,P&((h[C>>2]|0)==(d|0)?(h[C+4>>2]|0)==(m|0):0)){c=4;break}if(_=_+1|0,_>>>0>=7){_=7,c=4;break}}return(c|0)==4?(z=M,_|0):0}function ts(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0;if(oe=z,z=z+16|0,le=oe,se=oe+8|0,Y=le,h[Y>>2]=c,h[Y+4>>2]=f,!d)return se=m,h[se>>2]=c,h[se+4>>2]=f,se=0,z=oe,se|0;h[se>>2]=0;e:do if(di(c,f)|0)c=9;else{if(y=(d|0)>0,y){_=0,Y=c;do{if(c=ti(Y,f,4,se,le)|0,c|0)break e;if(f=le,Y=h[f>>2]|0,f=h[f+4>>2]|0,_=_+1|0,di(Y,f)|0){c=9;break e}}while((_|0)<(d|0));if(k=m,h[k>>2]=Y,h[k+4>>2]=f,k=d+-1|0,y){P=0,c=1;do{if(_=26800+(P<<2)|0,(P|0)==5)for(b=h[_>>2]|0,y=0,_=c;;){if(c=le,c=ti(h[c>>2]|0,h[c+4>>2]|0,b,se,le)|0,c|0)break e;if((y|0)!=(k|0))if(C=le,M=h[C>>2]|0,C=h[C+4>>2]|0,c=m+(_<<3)|0,h[c>>2]=M,h[c+4>>2]=C,!(di(M,C)|0))c=_+1|0;else{c=9;break e}else c=_;if(y=y+1|0,(y|0)>=(d|0))break;_=c}else for(b=le,C=h[_>>2]|0,M=0,_=c,y=h[b>>2]|0,b=h[b+4>>2]|0;;){if(c=ti(y,b,C,se,le)|0,c|0)break e;if(b=le,y=h[b>>2]|0,b=h[b+4>>2]|0,c=m+(_<<3)|0,h[c>>2]=y,h[c+4>>2]=b,c=_+1|0,di(y,b)|0){c=9;break e}if(M=M+1|0,(M|0)>=(d|0))break;_=c}P=P+1|0}while(P>>>0<6);c=le,b=Y,_=h[c>>2]|0,y=f,c=h[c+4>>2]|0}else b=Y,_=Y,y=f,c=f}else b=m,h[b>>2]=c,h[b+4>>2]=f,b=c,_=c,y=f,c=f;c=(b|0)==(_|0)&(y|0)==(c|0)?0:9}while(!1);return se=c,z=oe,se|0}function NA(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0;if(M=z,z=z+48|0,_=M+16|0,y=M+8|0,b=M,d=FA(d)|0,d|0)return b=d,z=M,b|0;if(P=c,C=h[P+4>>2]|0,d=y,h[d>>2]=h[P>>2],h[d+4>>2]=C,v5(y,_),d=Kb(_,f,b)|0,!d){if(f=h[y>>2]|0,y=h[c+8>>2]|0,(y|0)>0){_=h[c+12>>2]|0,d=0;do f=(h[_+(d<<3)>>2]|0)+f|0,d=d+1|0;while((d|0)<(y|0))}d=b,_=h[d>>2]|0,d=h[d+4>>2]|0,y=((f|0)<0)<<31>>31,(d|0)<(y|0)|(d|0)==(y|0)&_>>>0<f>>>0?(d=b,h[d>>2]=f,h[d+4>>2]=y,d=y):f=_,C=Qt(f|0,d|0,12,0)|0,P=X()|0,d=b,h[d>>2]=C,h[d+4>>2]=P,d=m,h[d>>2]=C,h[d+4>>2]=P,d=0}return P=d,z=M,P|0}function Sa(c,f,d,m,_,y,b){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0,y=y|0,b=b|0;var M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0,ht=0,kt=0,Dt=0,ln=0,An=0,Nn=0,nn=0,Vt=0,ct=0,Mn=0,ci=0,vn=0,hi=0,vs=0,D5=0;if(ci=z,z=z+64|0,nn=ci+48|0,Vt=ci+32|0,ct=ci+24|0,ht=ci+8|0,kt=ci,C=h[c>>2]|0,(C|0)<=0)return Mn=0,z=ci,Mn|0;for(Dt=c+4|0,ln=nn+8|0,An=Vt+8|0,Nn=ht+8|0,M=0,Pe=0;;){P=h[Dt>>2]|0,Ie=P+(Pe<<4)|0,h[nn>>2]=h[Ie>>2],h[nn+4>>2]=h[Ie+4>>2],h[nn+8>>2]=h[Ie+8>>2],h[nn+12>>2]=h[Ie+12>>2],(Pe|0)==(C+-1|0)?(h[Vt>>2]=h[P>>2],h[Vt+4>>2]=h[P+4>>2],h[Vt+8>>2]=h[P+8>>2],h[Vt+12>>2]=h[P+12>>2]):(Ie=P+(Pe+1<<4)|0,h[Vt>>2]=h[Ie>>2],h[Vt+4>>2]=h[Ie+4>>2],h[Vt+8>>2]=h[Ie+8>>2],h[Vt+12>>2]=h[Ie+12>>2]),C=yD(nn,Vt,m,ct)|0;e:do if(C)P=0,M=C;else if(C=ct,P=h[C>>2]|0,C=h[C+4>>2]|0,(C|0)>0|(C|0)==0&P>>>0>0){Oe=0,Ie=0;t:for(;;){if(hi=1/(+(P>>>0)+4294967296*+(C|0)),D5=+$[nn>>3],C=Gr(P|0,C|0,Oe|0,Ie|0)|0,vs=+(C>>>0)+4294967296*+(X()|0),vn=+(Oe>>>0)+4294967296*+(Ie|0),$[ht>>3]=hi*(D5*vs)+hi*(+$[Vt>>3]*vn),$[Nn>>3]=hi*(+$[ln>>3]*vs)+hi*(+$[An>>3]*vn),C=a_(ht,m,kt)|0,C|0){M=C;break}Te=kt,me=h[Te>>2]|0,Te=h[Te+4>>2]|0,le=wh(me|0,Te|0,f|0,d|0)|0,k=X()|0,C=b+(le<<3)|0,Y=C,P=h[Y>>2]|0,Y=h[Y+4>>2]|0;n:do if((P|0)==0&(Y|0)==0)_e=C,Mn=16;else for(se=0,oe=0;;){if((se|0)>(d|0)|(se|0)==(d|0)&oe>>>0>f>>>0){M=1;break t}if((P|0)==(me|0)&(Y|0)==(Te|0))break n;if(C=Qt(le|0,k|0,1,0)|0,le=bh(C|0,X()|0,f|0,d|0)|0,k=X()|0,oe=Qt(oe|0,se|0,1,0)|0,se=X()|0,C=b+(le<<3)|0,Y=C,P=h[Y>>2]|0,Y=h[Y+4>>2]|0,(P|0)==0&(Y|0)==0){_e=C,Mn=16;break}}while(!1);if((Mn|0)==16&&(Mn=0,!((me|0)==0&(Te|0)==0))&&(oe=_e,h[oe>>2]=me,h[oe+4>>2]=Te,oe=y+(h[_>>2]<<3)|0,h[oe>>2]=me,h[oe+4>>2]=Te,oe=_,oe=Qt(h[oe>>2]|0,h[oe+4>>2]|0,1,0)|0,me=X()|0,Te=_,h[Te>>2]=oe,h[Te+4>>2]=me),Oe=Qt(Oe|0,Ie|0,1,0)|0,Ie=X()|0,C=ct,P=h[C>>2]|0,C=h[C+4>>2]|0,!((C|0)>(Ie|0)|(C|0)==(Ie|0)&P>>>0>Oe>>>0)){P=1;break e}}P=0}else P=1;while(!1);if(Pe=Pe+1|0,!P){Mn=21;break}if(C=h[c>>2]|0,(Pe|0)>=(C|0)){M=0,Mn=21;break}}return(Mn|0)==21?(z=ci,M|0):0}function uD(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0,ht=0,kt=0,Dt=0,ln=0,An=0,Nn=0,nn=0,Vt=0,ct=0,Mn=0,ci=0,vn=0,hi=0,vs=0;if(vs=z,z=z+112|0,Mn=vs+80|0,C=vs+72|0,ci=vs,vn=vs+56|0,_=FA(d)|0,_|0)return hi=_,z=vs,hi|0;if(P=c+8|0,hi=Ta((h[P>>2]<<5)+32|0)|0,!hi)return hi=13,z=vs,hi|0;if(p_(c,hi),_=FA(d)|0,!_){if(Vt=c,ct=h[Vt+4>>2]|0,_=C,h[_>>2]=h[Vt>>2],h[_+4>>2]=ct,v5(C,Mn),_=Kb(Mn,f,ci)|0,_)Vt=0,ct=0;else{if(_=h[C>>2]|0,y=h[P>>2]|0,(y|0)>0){b=h[c+12>>2]|0,d=0;do _=(h[b+(d<<3)>>2]|0)+_|0,d=d+1|0;while((d|0)!=(y|0));d=_}else d=_;_=ci,y=h[_>>2]|0,_=h[_+4>>2]|0,b=((d|0)<0)<<31>>31,(_|0)<(b|0)|(_|0)==(b|0)&y>>>0<d>>>0?(_=ci,h[_>>2]=d,h[_+4>>2]=b,_=b):d=y,Vt=Qt(d|0,_|0,12,0)|0,ct=X()|0,_=ci,h[_>>2]=Vt,h[_+4>>2]=ct,_=0}if(!_){if(d=Co(Vt,8)|0,!d)return Jt(hi),hi=13,z=vs,hi|0;if(M=Co(Vt,8)|0,!M)return Jt(hi),Jt(d),hi=13,z=vs,hi|0;Nn=Mn,h[Nn>>2]=0,h[Nn+4>>2]=0,Nn=c,nn=h[Nn+4>>2]|0,_=C,h[_>>2]=h[Nn>>2],h[_+4>>2]=nn,_=Sa(C,Vt,ct,f,Mn,d,M)|0;e:do if(_)Jt(d),Jt(M),Jt(hi);else{t:do if((h[P>>2]|0)>0){for(b=c+12|0,y=0;_=Sa((h[b>>2]|0)+(y<<3)|0,Vt,ct,f,Mn,d,M)|0,y=y+1|0,!(_|0);)if((y|0)>=(h[P>>2]|0))break t;Jt(d),Jt(M),Jt(hi);break e}while(!1);(ct|0)>0|(ct|0)==0&Vt>>>0>0&&ec(M|0,0,Vt<<3|0)|0,nn=Mn,Nn=h[nn+4>>2]|0;t:do if((Nn|0)>0|(Nn|0)==0&(h[nn>>2]|0)>>>0>0){Dt=d,ln=M,An=d,Nn=M,nn=d,_=d,_e=d,ht=M,kt=M,d=M;n:for(;;){for(Te=0,Oe=0,Ie=0,Pe=0,y=0,b=0;;){M=ci,C=M+56|0;do h[M>>2]=0,M=M+4|0;while((M|0)<(C|0));if(f=Dt+(Te<<3)|0,P=h[f>>2]|0,f=h[f+4>>2]|0,vi(P,f,1,ci,0)|0){M=ci,C=M+56|0;do h[M>>2]=0,M=M+4|0;while((M|0)<(C|0));M=Co(7,4)|0,M|0&&(Qi(P,f,1,ci,M,7,0,0)|0,Jt(M))}for(me=0;;){oe=ci+(me<<3)|0,se=h[oe>>2]|0,oe=h[oe+4>>2]|0;i:do if((se|0)==0&(oe|0)==0)M=y,C=b;else{if(k=wh(se|0,oe|0,Vt|0,ct|0)|0,P=X()|0,M=m+(k<<3)|0,f=M,C=h[f>>2]|0,f=h[f+4>>2]|0,!((C|0)==0&(f|0)==0)){Y=0,le=0;do{if((Y|0)>(ct|0)|(Y|0)==(ct|0)&le>>>0>Vt>>>0)break n;if((C|0)==(se|0)&(f|0)==(oe|0)){M=y,C=b;break i}M=Qt(k|0,P|0,1,0)|0,k=bh(M|0,X()|0,Vt|0,ct|0)|0,P=X()|0,le=Qt(le|0,Y|0,1,0)|0,Y=X()|0,M=m+(k<<3)|0,f=M,C=h[f>>2]|0,f=h[f+4>>2]|0}while(!((C|0)==0&(f|0)==0))}if((se|0)==0&(oe|0)==0){M=y,C=b;break}Ju(se,oe,vn)|0,m_(c,hi,vn)|0&&(le=Qt(y|0,b|0,1,0)|0,b=X()|0,Y=M,h[Y>>2]=se,h[Y+4>>2]=oe,y=ln+(y<<3)|0,h[y>>2]=se,h[y+4>>2]=oe,y=le),M=y,C=b}while(!1);if(me=me+1|0,me>>>0>=7)break;y=M,b=C}if(Te=Qt(Te|0,Oe|0,1,0)|0,Oe=X()|0,Ie=Qt(Ie|0,Pe|0,1,0)|0,Pe=X()|0,b=Mn,y=h[b>>2]|0,b=h[b+4>>2]|0,(Pe|0)<(b|0)|(Pe|0)==(b|0)&Ie>>>0<y>>>0)y=M,b=C;else break}if((b|0)>0|(b|0)==0&y>>>0>0){y=0,b=0;do Pe=Dt+(y<<3)|0,h[Pe>>2]=0,h[Pe+4>>2]=0,y=Qt(y|0,b|0,1,0)|0,b=X()|0,Pe=Mn,Ie=h[Pe+4>>2]|0;while((b|0)<(Ie|0)|((b|0)==(Ie|0)?y>>>0<(h[Pe>>2]|0)>>>0:0))}if(Pe=Mn,h[Pe>>2]=M,h[Pe+4>>2]=C,(C|0)>0|(C|0)==0&M>>>0>0)me=d,Te=kt,Oe=nn,Ie=ht,Pe=ln,d=_e,kt=_,ht=An,_e=me,_=Te,nn=Nn,Nn=Oe,An=Ie,ln=Dt,Dt=Pe;else break t}Jt(An),Jt(Nn),Jt(hi),_=1;break e}else _=M;while(!1);Jt(hi),Jt(d),Jt(_),_=0}while(!1);return hi=_,z=vs,hi|0}}return Jt(hi),hi=_,z=vs,hi|0}function cD(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0;if(k=z,z=z+176|0,C=k,(f|0)<1)return S5(d,0,0),P=0,z=k,P|0;for(M=c,M=rt(h[M>>2]|0,h[M+4>>2]|0,52)|0,X()|0,S5(d,(f|0)>6?f:6,M&15),M=0;m=c+(M<<3)|0,m=yh(h[m>>2]|0,h[m+4>>2]|0,C)|0,!(m|0);){if(m=h[C>>2]|0,(m|0)>0){b=0;do y=C+8+(b<<4)|0,b=b+1|0,m=C+8+(((b|0)%(m|0)|0)<<4)|0,_=OI(d,m,y)|0,_?E5(d,_)|0:UI(d,y,m)|0,m=h[C>>2]|0;while((b|0)<(m|0))}if(M=M+1|0,(M|0)>=(f|0)){m=0,P=13;break}}return(P|0)==13?(z=k,m|0):(T5(d),P=m,z=k,P|0)}function hD(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0;if(y=z,z=z+32|0,m=y,_=y+16|0,c=cD(c,f,_)|0,c|0)return d=c,z=y,d|0;if(h[d>>2]=0,h[d+4>>2]=0,h[d+8>>2]=0,c=M5(_)|0,c|0)do{f=fI(d)|0;do AI(f,c)|0,b=c+16|0,h[m>>2]=h[b>>2],h[m+4>>2]=h[b+4>>2],h[m+8>>2]=h[b+8>>2],h[m+12>>2]=h[b+12>>2],E5(_,c)|0,c=kI(_,m)|0;while((c|0)!=0);c=M5(_)|0}while((c|0)!=0);return T5(_),c=dI(d)|0,c?(p5(d),b=c,z=y,b|0):(b=0,z=y,b|0)}function Ni(c){return c=c|0,c>>>0>121?(c=0,c|0):(c=h[7696+(c*28|0)+16>>2]|0,c|0)}function j2(c){return c=c|0,(c|0)==4|(c|0)==117|0}function jb(c){return c=c|0,h[11120+((h[c>>2]|0)*216|0)+((h[c+4>>2]|0)*72|0)+((h[c+8>>2]|0)*24|0)+(h[c+12>>2]<<3)>>2]|0}function fD(c){return c=c|0,h[11120+((h[c>>2]|0)*216|0)+((h[c+4>>2]|0)*72|0)+((h[c+8>>2]|0)*24|0)+(h[c+12>>2]<<3)+4>>2]|0}function AD(c,f){c=c|0,f=f|0,c=7696+(c*28|0)|0,h[f>>2]=h[c>>2],h[f+4>>2]=h[c+4>>2],h[f+8>>2]=h[c+8>>2],h[f+12>>2]=h[c+12>>2]}function dD(c,f){c=c|0,f=f|0;var d=0,m=0;if(f>>>0>20)return f=-1,f|0;do if((h[11120+(f*216|0)>>2]|0)!=(c|0))if((h[11120+(f*216|0)+8>>2]|0)!=(c|0))if((h[11120+(f*216|0)+16>>2]|0)!=(c|0))if((h[11120+(f*216|0)+24>>2]|0)!=(c|0))if((h[11120+(f*216|0)+32>>2]|0)!=(c|0))if((h[11120+(f*216|0)+40>>2]|0)!=(c|0))if((h[11120+(f*216|0)+48>>2]|0)!=(c|0))if((h[11120+(f*216|0)+56>>2]|0)!=(c|0))if((h[11120+(f*216|0)+64>>2]|0)!=(c|0))if((h[11120+(f*216|0)+72>>2]|0)!=(c|0))if((h[11120+(f*216|0)+80>>2]|0)!=(c|0))if((h[11120+(f*216|0)+88>>2]|0)!=(c|0))if((h[11120+(f*216|0)+96>>2]|0)!=(c|0))if((h[11120+(f*216|0)+104>>2]|0)!=(c|0))if((h[11120+(f*216|0)+112>>2]|0)!=(c|0))if((h[11120+(f*216|0)+120>>2]|0)!=(c|0))if((h[11120+(f*216|0)+128>>2]|0)!=(c|0))if((h[11120+(f*216|0)+136>>2]|0)==(c|0))c=2,d=1,m=2;else{if((h[11120+(f*216|0)+144>>2]|0)==(c|0)){c=0,d=2,m=0;break}if((h[11120+(f*216|0)+152>>2]|0)==(c|0)){c=0,d=2,m=1;break}if((h[11120+(f*216|0)+160>>2]|0)==(c|0)){c=0,d=2,m=2;break}if((h[11120+(f*216|0)+168>>2]|0)==(c|0)){c=1,d=2,m=0;break}if((h[11120+(f*216|0)+176>>2]|0)==(c|0)){c=1,d=2,m=1;break}if((h[11120+(f*216|0)+184>>2]|0)==(c|0)){c=1,d=2,m=2;break}if((h[11120+(f*216|0)+192>>2]|0)==(c|0)){c=2,d=2,m=0;break}if((h[11120+(f*216|0)+200>>2]|0)==(c|0)){c=2,d=2,m=1;break}if((h[11120+(f*216|0)+208>>2]|0)==(c|0)){c=2,d=2,m=2;break}else c=-1;return c|0}else c=2,d=1,m=1;else c=2,d=1,m=0;else c=1,d=1,m=2;else c=1,d=1,m=1;else c=1,d=1,m=0;else c=0,d=1,m=2;else c=0,d=1,m=1;else c=0,d=1,m=0;else c=2,d=0,m=2;else c=2,d=0,m=1;else c=2,d=0,m=0;else c=1,d=0,m=2;else c=1,d=0,m=1;else c=1,d=0,m=0;else c=0,d=0,m=2;else c=0,d=0,m=1;else c=0,d=0,m=0;while(!1);return f=h[11120+(f*216|0)+(d*72|0)+(c*24|0)+(m<<3)+4>>2]|0,f|0}function Xb(c,f){return c=c|0,f=f|0,(h[7696+(c*28|0)+20>>2]|0)==(f|0)?(f=1,f|0):(f=(h[7696+(c*28|0)+24>>2]|0)==(f|0),f|0)}function X2(c,f){return c=c|0,f=f|0,h[848+(c*28|0)+(f<<2)>>2]|0}function Q2(c,f){return c=c|0,f=f|0,(h[848+(c*28|0)>>2]|0)==(f|0)?(f=0,f|0):(h[848+(c*28|0)+4>>2]|0)==(f|0)?(f=1,f|0):(h[848+(c*28|0)+8>>2]|0)==(f|0)?(f=2,f|0):(h[848+(c*28|0)+12>>2]|0)==(f|0)?(f=3,f|0):(h[848+(c*28|0)+16>>2]|0)==(f|0)?(f=4,f|0):(h[848+(c*28|0)+20>>2]|0)==(f|0)?(f=5,f|0):((h[848+(c*28|0)+24>>2]|0)==(f|0)?6:7)|0}function pD(){return 122}function mD(c){c=c|0;var f=0,d=0,m=0;f=0;do dt(f|0,0,45)|0,m=X()|0|134225919,d=c+(f<<3)|0,h[d>>2]=-1,h[d+4>>2]=m,f=f+1|0;while((f|0)!=122);return 0}function gD(c){c=c|0;var f=0,d=0,m=0;return m=+$[c+16>>3],d=+$[c+24>>3],f=m-d,+(m<d?f+6.283185307179586:f)}function Qb(c){return c=c|0,+$[c+16>>3]<+$[c+24>>3]|0}function _D(c){return c=c|0,+(+$[c>>3]-+$[c+8>>3])}function Y2(c,f){c=c|0,f=f|0;var d=0,m=0,_=0;return d=+$[f>>3],!(d>=+$[c+8>>3])||!(d<=+$[c>>3])?(f=0,f|0):(m=+$[c+16>>3],d=+$[c+24>>3],_=+$[f+8>>3],f=_>=d,c=_<=m&1,m<d?f&&(c=1):f||(c=0),f=(c|0)!=0,f|0)}function Z2(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0;return+$[c>>3]<+$[f+8>>3]||+$[c+8>>3]>+$[f>>3]?(m=0,m|0):(y=+$[c+16>>3],d=c+24|0,k=+$[d>>3],b=y<k,m=f+16|0,P=+$[m>>3],_=f+24|0,C=+$[_>>3],M=P<C,f=k-P<C-y,c=b?M|f?1:2:0,f=M?b?1:f?2:1:0,y=+io(y,c),y<+io(+$[_>>3],f)||(k=+io(+$[d>>3],c),k>+io(+$[m>>3],f))?(M=0,M|0):(M=1,M|0))}function vD(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0;y=+$[c+16>>3],C=+$[c+24>>3],c=y<C,M=+$[f+16>>3],b=+$[f+24>>3],_=M<b,f=C-M<b-y,h[d>>2]=c?_|f?1:2:0,h[m>>2]=_?c?1:f?2:1:0}function Yb(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0;return+$[c>>3]<+$[f>>3]||+$[c+8>>3]>+$[f+8>>3]?(m=0,m|0):(m=c+16|0,C=+$[m>>3],y=+$[c+24>>3],b=C<y,d=f+16|0,k=+$[d>>3],_=f+24|0,P=+$[_>>3],M=k<P,f=y-k<P-C,c=b?M|f?1:2:0,f=M?b?1:f?2:1:0,y=+io(y,c),y<=+io(+$[_>>3],f)?(k=+io(+$[m>>3],c),M=k>=+io(+$[d>>3],f),M|0):(M=0,M|0))}function Zb(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0;_=z,z=z+176|0,m=_,h[m>>2]=4,M=+$[f>>3],$[m+8>>3]=M,y=+$[f+16>>3],$[m+16>>3]=y,$[m+24>>3]=M,M=+$[f+24>>3],$[m+32>>3]=M,b=+$[f+8>>3],$[m+40>>3]=b,$[m+48>>3]=M,$[m+56>>3]=b,$[m+64>>3]=y,f=m+72|0,d=f+96|0;do h[f>>2]=0,f=f+4|0;while((f|0)<(d|0));Sh(c|0,m|0,168)|0,z=_}function Kb(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0;oe=z,z=z+288|0,k=oe+264|0,Y=oe+96|0,P=oe,M=P,C=M+96|0;do h[M>>2]=0,M=M+4|0;while((M|0)<(C|0));return f=u_(f,P)|0,f|0?(se=f,z=oe,se|0):(C=P,P=h[C>>2]|0,C=h[C+4>>2]|0,Ju(P,C,k)|0,yh(P,C,Y)|0,b=+IA(k,Y+8|0),$[k>>3]=+$[c>>3],C=k+8|0,$[C>>3]=+$[c+16>>3],$[Y>>3]=+$[c+8>>3],P=Y+8|0,$[P>>3]=+$[c+24>>3],_=+IA(k,Y),Te=+$[C>>3]-+$[P>>3],y=+_n(+Te),me=+$[k>>3]-+$[Y>>3],m=+_n(+me),!(Te==0|me==0)&&(Te=+P5(+y,+m),Te=+qe(+(_*_/+Pp(+(Te/+Pp(+y,+m)),3)/(b*(b*2.59807621135)*.8))),$[Dn>>3]=Te,le=~~Te>>>0,se=+_n(Te)>=1?Te>0?~~+De(+zi(Te/4294967296),4294967295)>>>0:~~+qe((Te-+(~~Te>>>0))/4294967296)>>>0:0,(h[Dn+4>>2]&2146435072|0)!=2146435072)?(Y=(le|0)==0&(se|0)==0,f=d,h[f>>2]=Y?1:le,h[f+4>>2]=Y?0:se,f=0):f=1,se=f,z=oe,se|0)}function yD(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0;P=z,z=z+288|0,b=P+264|0,M=P+96|0,C=P,_=C,y=_+96|0;do h[_>>2]=0,_=_+4|0;while((_|0)<(y|0));return d=u_(d,C)|0,d|0?(m=d,z=P,m|0):(d=C,_=h[d>>2]|0,d=h[d+4>>2]|0,Ju(_,d,b)|0,yh(_,d,M)|0,k=+IA(b,M+8|0),k=+qe(+(+IA(c,f)/(k*2))),$[Dn>>3]=k,d=~~k>>>0,_=+_n(k)>=1?k>0?~~+De(+zi(k/4294967296),4294967295)>>>0:~~+qe((k-+(~~k>>>0))/4294967296)>>>0:0,(h[Dn+4>>2]&2146435072|0)==2146435072?(m=1,z=P,m|0):(C=(d|0)==0&(_|0)==0,h[m>>2]=C?1:d,h[m+4>>2]=C?0:_,m=0,z=P,m|0))}function xD(c,f){c=c|0,f=+f;var d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0;y=c+16|0,b=+$[y>>3],d=c+24|0,_=+$[d>>3],m=b-_,m=b<_?m+6.283185307179586:m,P=+$[c>>3],M=c+8|0,C=+$[M>>3],k=P-C,m=(m*f-m)*.5,f=(k*f-k)*.5,P=P+f,$[c>>3]=P>1.5707963267948966?1.5707963267948966:P,f=C-f,$[M>>3]=f<-1.5707963267948966?-1.5707963267948966:f,f=b+m,f=f>3.141592653589793?f+-6.283185307179586:f,$[y>>3]=f<-3.141592653589793?f+6.283185307179586:f,f=_-m,f=f>3.141592653589793?f+-6.283185307179586:f,$[d>>3]=f<-3.141592653589793?f+6.283185307179586:f}function bD(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0,h[c>>2]=f,h[c+4>>2]=d,h[c+8>>2]=m}function wD(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0;Y=f+8|0,h[Y>>2]=0,C=+$[c>>3],b=+_n(+C),P=+$[c+8>>3],M=+_n(+P)*1.1547005383792515,b=b+M*.5,d=~~b,c=~~M,b=b-+(d|0),M=M-+(c|0);do if(b<.5)if(b<.3333333333333333)if(h[f>>2]=d,M<(b+1)*.5){h[f+4>>2]=c;break}else{c=c+1|0,h[f+4>>2]=c;break}else if(le=1-b,c=(!(M<le)&1)+c|0,h[f+4>>2]=c,le<=M&M<b*2){d=d+1|0,h[f>>2]=d;break}else{h[f>>2]=d;break}else{if(!(b<.6666666666666666))if(d=d+1|0,h[f>>2]=d,M<b*.5){h[f+4>>2]=c;break}else{c=c+1|0,h[f+4>>2]=c;break}if(M<1-b){if(h[f+4>>2]=c,b*2+-1<M){h[f>>2]=d;break}}else c=c+1|0,h[f+4>>2]=c;d=d+1|0,h[f>>2]=d}while(!1);do if(C<0)if(c&1){k=(c+1|0)/2|0,k=Gr(d|0,((d|0)<0)<<31>>31|0,k|0,((k|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-((+(k>>>0)+4294967296*+(X()|0))*2+1)),h[f>>2]=d;break}else{k=(c|0)/2|0,k=Gr(d|0,((d|0)<0)<<31>>31|0,k|0,((k|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-(+(k>>>0)+4294967296*+(X()|0))*2),h[f>>2]=d;break}while(!1);k=f+4|0,P<0&&(d=d-((c<<1|1|0)/2|0)|0,h[f>>2]=d,c=0-c|0,h[k>>2]=c),m=c-d|0,(d|0)<0?(_=0-d|0,h[k>>2]=m,h[Y>>2]=_,h[f>>2]=0,c=m,d=0):_=0,(c|0)<0&&(d=d-c|0,h[f>>2]=d,_=_-c|0,h[Y>>2]=_,h[k>>2]=0,c=0),y=d-_|0,m=c-_|0,(_|0)<0&&(h[f>>2]=y,h[k>>2]=m,h[Y>>2]=0,c=m,d=y,_=0),m=(c|0)<(d|0)?c:d,m=(_|0)<(m|0)?_:m,!((m|0)<=0)&&(h[f>>2]=d-m,h[k>>2]=c-m,h[Y>>2]=_-m)}function ns(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0;f=h[c>>2]|0,b=c+4|0,d=h[b>>2]|0,(f|0)<0&&(d=d-f|0,h[b>>2]=d,y=c+8|0,h[y>>2]=(h[y>>2]|0)-f,h[c>>2]=0,f=0),(d|0)<0?(f=f-d|0,h[c>>2]=f,y=c+8|0,_=(h[y>>2]|0)-d|0,h[y>>2]=_,h[b>>2]=0,d=0):(_=c+8|0,y=_,_=h[_>>2]|0),(_|0)<0&&(f=f-_|0,h[c>>2]=f,d=d-_|0,h[b>>2]=d,h[y>>2]=0,_=0),m=(d|0)<(f|0)?d:f,m=(_|0)<(m|0)?_:m,!((m|0)<=0)&&(h[c>>2]=f-m,h[b>>2]=d-m,h[y>>2]=_-m)}function Qu(c,f){c=c|0,f=f|0;var d=0,m=0;m=h[c+8>>2]|0,d=+((h[c+4>>2]|0)-m|0),$[f>>3]=+((h[c>>2]|0)-m|0)-d*.5,$[f+8>>3]=d*.8660254037844386}function _s(c,f,d){c=c|0,f=f|0,d=d|0,h[d>>2]=(h[f>>2]|0)+(h[c>>2]|0),h[d+4>>2]=(h[f+4>>2]|0)+(h[c+4>>2]|0),h[d+8>>2]=(h[f+8>>2]|0)+(h[c+8>>2]|0)}function K2(c,f,d){c=c|0,f=f|0,d=d|0,h[d>>2]=(h[c>>2]|0)-(h[f>>2]|0),h[d+4>>2]=(h[c+4>>2]|0)-(h[f+4>>2]|0),h[d+8>>2]=(h[c+8>>2]|0)-(h[f+8>>2]|0)}function Jb(c,f){c=c|0,f=f|0;var d=0,m=0;d=ke(h[c>>2]|0,f)|0,h[c>>2]=d,d=c+4|0,m=ke(h[d>>2]|0,f)|0,h[d>>2]=m,c=c+8|0,f=ke(h[c>>2]|0,f)|0,h[c>>2]=f}function Tp(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;b=h[c>>2]|0,M=(b|0)<0,m=(h[c+4>>2]|0)-(M?b:0)|0,y=(m|0)<0,_=(y?0-m|0:0)+((h[c+8>>2]|0)-(M?b:0))|0,d=(_|0)<0,c=d?0:_,f=(y?0:m)-(d?_:0)|0,_=(M?0:b)-(y?m:0)-(d?_:0)|0,d=(f|0)<(_|0)?f:_,d=(c|0)<(d|0)?c:d,m=(d|0)>0,c=c-(m?d:0)|0,f=f-(m?d:0)|0;e:do switch(_-(m?d:0)|0){case 0:switch(f|0){case 0:return M=(c|0)==0?0:(c|0)==1?1:7,M|0;case 1:return M=(c|0)==0?2:(c|0)==1?3:7,M|0;default:break e}case 1:switch(f|0){case 0:return M=(c|0)==0?4:(c|0)==1?5:7,M|0;case 1:{if(!c)c=6;else break e;return c|0}default:break e}}while(!1);return M=7,M|0}function SD(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0;if(C=c+8|0,b=h[C>>2]|0,M=(h[c>>2]|0)-b|0,P=c+4|0,b=(h[P>>2]|0)-b|0,M>>>0>715827881|b>>>0>715827881){if(m=(M|0)>0,_=2147483647-M|0,y=-2147483648-M|0,(m?(_|0)<(M|0):(y|0)>(M|0))||(d=M<<1,m?(2147483647-d|0)<(M|0):(-2147483648-d|0)>(M|0))||((b|0)>0?(2147483647-b|0)<(b|0):(-2147483648-b|0)>(b|0))||(f=M*3|0,d=b<<1,(m?(_|0)<(d|0):(y|0)>(d|0))||((M|0)>-1?(f|-2147483648|0)>=(b|0):(f^-2147483648|0)<(b|0))))return P=1,P|0}else d=b<<1,f=M*3|0;return m=nu(+(f-b|0)*.14285714285714285)|0,h[c>>2]=m,_=nu(+(d+M|0)*.14285714285714285)|0,h[P>>2]=_,h[C>>2]=0,d=(_|0)<(m|0),f=d?m:_,d=d?_:m,(d|0)<0&&(((d|0)==-2147483648||((f|0)>0?(2147483647-f|0)<(d|0):(-2147483648-f|0)>(d|0)))&&ft(27795,26892,354,26903),((f|0)>-1?(f|-2147483648|0)>=(d|0):(f^-2147483648|0)<(d|0))&&ft(27795,26892,354,26903)),f=_-m|0,(m|0)<0?(d=0-m|0,h[P>>2]=f,h[C>>2]=d,h[c>>2]=0,m=0):(f=_,d=0),(f|0)<0&&(m=m-f|0,h[c>>2]=m,d=d-f|0,h[C>>2]=d,h[P>>2]=0,f=0),y=m-d|0,_=f-d|0,(d|0)<0?(h[c>>2]=y,h[P>>2]=_,h[C>>2]=0,f=_,_=y,d=0):_=m,m=(f|0)<(_|0)?f:_,m=(d|0)<(m|0)?d:m,(m|0)<=0?(P=0,P|0):(h[c>>2]=_-m,h[P>>2]=f-m,h[C>>2]=d-m,P=0,P|0)}function TD(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0,C=0;if(b=c+8|0,_=h[b>>2]|0,y=(h[c>>2]|0)-_|0,M=c+4|0,_=(h[M>>2]|0)-_|0,y>>>0>715827881|_>>>0>715827881){if(d=(y|0)>0,(d?(2147483647-y|0)<(y|0):(-2147483648-y|0)>(y|0))||(f=y<<1,m=(_|0)>0,m?(2147483647-_|0)<(_|0):(-2147483648-_|0)>(_|0)))return M=1,M|0;if(C=_<<1,(m?(2147483647-C|0)<(_|0):(-2147483648-C|0)>(_|0))||(d?(2147483647-f|0)<(_|0):(-2147483648-f|0)>(_|0))||(d=_*3|0,(_|0)>-1?(d|-2147483648|0)>=(y|0):(d^-2147483648|0)<(y|0)))return C=1,C|0}else d=_*3|0,f=y<<1;return m=nu(+(f+_|0)*.14285714285714285)|0,h[c>>2]=m,_=nu(+(d-y|0)*.14285714285714285)|0,h[M>>2]=_,h[b>>2]=0,d=(_|0)<(m|0),f=d?m:_,d=d?_:m,(d|0)<0&&(((d|0)==-2147483648||((f|0)>0?(2147483647-f|0)<(d|0):(-2147483648-f|0)>(d|0)))&&ft(27795,26892,402,26917),((f|0)>-1?(f|-2147483648|0)>=(d|0):(f^-2147483648|0)<(d|0))&&ft(27795,26892,402,26917)),f=_-m|0,(m|0)<0?(d=0-m|0,h[M>>2]=f,h[b>>2]=d,h[c>>2]=0,m=0):(f=_,d=0),(f|0)<0&&(m=m-f|0,h[c>>2]=m,d=d-f|0,h[b>>2]=d,h[M>>2]=0,f=0),y=m-d|0,_=f-d|0,(d|0)<0?(h[c>>2]=y,h[M>>2]=_,h[b>>2]=0,f=_,_=y,d=0):_=m,m=(f|0)<(_|0)?f:_,m=(d|0)<(m|0)?d:m,(m|0)<=0?(C=0,C|0):(h[c>>2]=_-m,h[M>>2]=f-m,h[b>>2]=d-m,C=0,C|0)}function MD(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;b=c+8|0,d=h[b>>2]|0,f=(h[c>>2]|0)-d|0,M=c+4|0,d=(h[M>>2]|0)-d|0,m=nu(+((f*3|0)-d|0)*.14285714285714285)|0,h[c>>2]=m,f=nu(+((d<<1)+f|0)*.14285714285714285)|0,h[M>>2]=f,h[b>>2]=0,d=f-m|0,(m|0)<0?(y=0-m|0,h[M>>2]=d,h[b>>2]=y,h[c>>2]=0,f=d,m=0,d=y):d=0,(f|0)<0&&(m=m-f|0,h[c>>2]=m,d=d-f|0,h[b>>2]=d,h[M>>2]=0,f=0),y=m-d|0,_=f-d|0,(d|0)<0?(h[c>>2]=y,h[M>>2]=_,h[b>>2]=0,f=_,_=y,d=0):_=m,m=(f|0)<(_|0)?f:_,m=(d|0)<(m|0)?d:m,!((m|0)<=0)&&(h[c>>2]=_-m,h[M>>2]=f-m,h[b>>2]=d-m)}function e5(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;b=c+8|0,d=h[b>>2]|0,f=(h[c>>2]|0)-d|0,M=c+4|0,d=(h[M>>2]|0)-d|0,m=nu(+((f<<1)+d|0)*.14285714285714285)|0,h[c>>2]=m,f=nu(+((d*3|0)-f|0)*.14285714285714285)|0,h[M>>2]=f,h[b>>2]=0,d=f-m|0,(m|0)<0?(y=0-m|0,h[M>>2]=d,h[b>>2]=y,h[c>>2]=0,f=d,m=0,d=y):d=0,(f|0)<0&&(m=m-f|0,h[c>>2]=m,d=d-f|0,h[b>>2]=d,h[M>>2]=0,f=0),y=m-d|0,_=f-d|0,(d|0)<0?(h[c>>2]=y,h[M>>2]=_,h[b>>2]=0,f=_,_=y,d=0):_=m,m=(f|0)<(_|0)?f:_,m=(d|0)<(m|0)?d:m,!((m|0)<=0)&&(h[c>>2]=_-m,h[M>>2]=f-m,h[b>>2]=d-m)}function Mp(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;f=h[c>>2]|0,b=c+4|0,d=h[b>>2]|0,M=c+8|0,m=h[M>>2]|0,_=d+(f*3|0)|0,h[c>>2]=_,d=m+(d*3|0)|0,h[b>>2]=d,f=(m*3|0)+f|0,h[M>>2]=f,m=d-_|0,(_|0)<0?(f=f-_|0,h[b>>2]=m,h[M>>2]=f,h[c>>2]=0,d=m,m=0):m=_,(d|0)<0&&(m=m-d|0,h[c>>2]=m,f=f-d|0,h[M>>2]=f,h[b>>2]=0,d=0),y=m-f|0,_=d-f|0,(f|0)<0?(h[c>>2]=y,h[b>>2]=_,h[M>>2]=0,m=y,f=0):_=d,d=(_|0)<(m|0)?_:m,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(h[c>>2]=m-d,h[b>>2]=_-d,h[M>>2]=f-d)}function Yu(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;_=h[c>>2]|0,b=c+4|0,f=h[b>>2]|0,M=c+8|0,d=h[M>>2]|0,m=(f*3|0)+_|0,_=d+(_*3|0)|0,h[c>>2]=_,h[b>>2]=m,f=(d*3|0)+f|0,h[M>>2]=f,d=m-_|0,(_|0)<0?(f=f-_|0,h[b>>2]=d,h[M>>2]=f,h[c>>2]=0,_=0):d=m,(d|0)<0&&(_=_-d|0,h[c>>2]=_,f=f-d|0,h[M>>2]=f,h[b>>2]=0,d=0),y=_-f|0,m=d-f|0,(f|0)<0?(h[c>>2]=y,h[b>>2]=m,h[M>>2]=0,_=y,f=0):m=d,d=(m|0)<(_|0)?m:_,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(h[c>>2]=_-d,h[b>>2]=m-d,h[M>>2]=f-d)}function t5(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0;(f+-1|0)>>>0>=6||(_=(h[15440+(f*12|0)>>2]|0)+(h[c>>2]|0)|0,h[c>>2]=_,M=c+4|0,m=(h[15440+(f*12|0)+4>>2]|0)+(h[M>>2]|0)|0,h[M>>2]=m,b=c+8|0,f=(h[15440+(f*12|0)+8>>2]|0)+(h[b>>2]|0)|0,h[b>>2]=f,d=m-_|0,(_|0)<0?(f=f-_|0,h[M>>2]=d,h[b>>2]=f,h[c>>2]=0,m=0):(d=m,m=_),(d|0)<0&&(m=m-d|0,h[c>>2]=m,f=f-d|0,h[b>>2]=f,h[M>>2]=0,d=0),y=m-f|0,_=d-f|0,(f|0)<0?(h[c>>2]=y,h[M>>2]=_,h[b>>2]=0,m=y,f=0):_=d,d=(_|0)<(m|0)?_:m,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(h[c>>2]=m-d,h[M>>2]=_-d,h[b>>2]=f-d))}function n5(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;_=h[c>>2]|0,b=c+4|0,f=h[b>>2]|0,M=c+8|0,d=h[M>>2]|0,m=f+_|0,_=d+_|0,h[c>>2]=_,h[b>>2]=m,f=d+f|0,h[M>>2]=f,d=m-_|0,(_|0)<0?(f=f-_|0,h[b>>2]=d,h[M>>2]=f,h[c>>2]=0,m=0):(d=m,m=_),(d|0)<0&&(m=m-d|0,h[c>>2]=m,f=f-d|0,h[M>>2]=f,h[b>>2]=0,d=0),y=m-f|0,_=d-f|0,(f|0)<0?(h[c>>2]=y,h[b>>2]=_,h[M>>2]=0,m=y,f=0):_=d,d=(_|0)<(m|0)?_:m,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(h[c>>2]=m-d,h[b>>2]=_-d,h[M>>2]=f-d)}function Ep(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;f=h[c>>2]|0,b=c+4|0,m=h[b>>2]|0,M=c+8|0,d=h[M>>2]|0,_=m+f|0,h[c>>2]=_,m=d+m|0,h[b>>2]=m,f=d+f|0,h[M>>2]=f,d=m-_|0,(_|0)<0?(f=f-_|0,h[b>>2]=d,h[M>>2]=f,h[c>>2]=0,m=0):(d=m,m=_),(d|0)<0&&(m=m-d|0,h[c>>2]=m,f=f-d|0,h[M>>2]=f,h[b>>2]=0,d=0),y=m-f|0,_=d-f|0,(f|0)<0?(h[c>>2]=y,h[b>>2]=_,h[M>>2]=0,m=y,f=0):_=d,d=(_|0)<(m|0)?_:m,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(h[c>>2]=m-d,h[b>>2]=_-d,h[M>>2]=f-d)}function Zu(c){switch(c=c|0,c|0){case 1:{c=5;break}case 5:{c=4;break}case 4:{c=6;break}case 6:{c=2;break}case 2:{c=3;break}case 3:{c=1;break}}return c|0}function eu(c){switch(c=c|0,c|0){case 1:{c=3;break}case 3:{c=2;break}case 2:{c=6;break}case 6:{c=4;break}case 4:{c=5;break}case 5:{c=1;break}}return c|0}function i5(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;f=h[c>>2]|0,b=c+4|0,d=h[b>>2]|0,M=c+8|0,m=h[M>>2]|0,_=d+(f<<1)|0,h[c>>2]=_,d=m+(d<<1)|0,h[b>>2]=d,f=(m<<1)+f|0,h[M>>2]=f,m=d-_|0,(_|0)<0?(f=f-_|0,h[b>>2]=m,h[M>>2]=f,h[c>>2]=0,d=m,m=0):m=_,(d|0)<0&&(m=m-d|0,h[c>>2]=m,f=f-d|0,h[M>>2]=f,h[b>>2]=0,d=0),y=m-f|0,_=d-f|0,(f|0)<0?(h[c>>2]=y,h[b>>2]=_,h[M>>2]=0,m=y,f=0):_=d,d=(_|0)<(m|0)?_:m,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(h[c>>2]=m-d,h[b>>2]=_-d,h[M>>2]=f-d)}function r5(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;_=h[c>>2]|0,b=c+4|0,f=h[b>>2]|0,M=c+8|0,d=h[M>>2]|0,m=(f<<1)+_|0,_=d+(_<<1)|0,h[c>>2]=_,h[b>>2]=m,f=(d<<1)+f|0,h[M>>2]=f,d=m-_|0,(_|0)<0?(f=f-_|0,h[b>>2]=d,h[M>>2]=f,h[c>>2]=0,_=0):d=m,(d|0)<0&&(_=_-d|0,h[c>>2]=_,f=f-d|0,h[M>>2]=f,h[b>>2]=0,d=0),y=_-f|0,m=d-f|0,(f|0)<0?(h[c>>2]=y,h[b>>2]=m,h[M>>2]=0,_=y,f=0):m=d,d=(m|0)<(_|0)?m:_,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(h[c>>2]=_-d,h[b>>2]=m-d,h[M>>2]=f-d)}function J2(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0;return b=(h[c>>2]|0)-(h[f>>2]|0)|0,M=(b|0)<0,m=(h[c+4>>2]|0)-(h[f+4>>2]|0)-(M?b:0)|0,y=(m|0)<0,_=(M?0-b|0:0)+(h[c+8>>2]|0)-(h[f+8>>2]|0)+(y?0-m|0:0)|0,c=(_|0)<0,f=c?0:_,d=(y?0:m)-(c?_:0)|0,_=(M?0:b)-(y?m:0)-(c?_:0)|0,c=(d|0)<(_|0)?d:_,c=(f|0)<(c|0)?f:c,m=(c|0)>0,f=f-(m?c:0)|0,d=d-(m?c:0)|0,c=_-(m?c:0)|0,c=(c|0)>-1?c:0-c|0,d=(d|0)>-1?d:0-d|0,f=(f|0)>-1?f:0-f|0,f=(d|0)>(f|0)?d:f,((c|0)>(f|0)?c:f)|0}function ED(c,f){c=c|0,f=f|0;var d=0;d=h[c+8>>2]|0,h[f>>2]=(h[c>>2]|0)-d,h[f+4>>2]=(h[c+4>>2]|0)-d}function CD(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0;return m=h[c>>2]|0,h[f>>2]=m,_=h[c+4>>2]|0,b=f+4|0,h[b>>2]=_,M=f+8|0,h[M>>2]=0,d=(_|0)<(m|0),c=d?m:_,d=d?_:m,(d|0)<0&&((d|0)==-2147483648||((c|0)>0?(2147483647-c|0)<(d|0):(-2147483648-c|0)>(d|0))||((c|0)>-1?(c|-2147483648|0)>=(d|0):(c^-2147483648|0)<(d|0)))?(f=1,f|0):(c=_-m|0,(m|0)<0?(d=0-m|0,h[b>>2]=c,h[M>>2]=d,h[f>>2]=0,m=0):(c=_,d=0),(c|0)<0&&(m=m-c|0,h[f>>2]=m,d=d-c|0,h[M>>2]=d,h[b>>2]=0,c=0),y=m-d|0,_=c-d|0,(d|0)<0?(h[f>>2]=y,h[b>>2]=_,h[M>>2]=0,c=_,_=y,d=0):_=m,m=(c|0)<(_|0)?c:_,m=(d|0)<(m|0)?d:m,(m|0)<=0?(f=0,f|0):(h[f>>2]=_-m,h[b>>2]=c-m,h[M>>2]=d-m,f=0,f|0))}function s5(c){c=c|0;var f=0,d=0,m=0,_=0;f=c+8|0,_=h[f>>2]|0,d=_-(h[c>>2]|0)|0,h[c>>2]=d,m=c+4|0,c=(h[m>>2]|0)-_|0,h[m>>2]=c,h[f>>2]=0-(c+d)}function RD(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;d=h[c>>2]|0,f=0-d|0,h[c>>2]=f,b=c+8|0,h[b>>2]=0,M=c+4|0,m=h[M>>2]|0,_=m+d|0,(d|0)>0?(h[M>>2]=_,h[b>>2]=d,h[c>>2]=0,f=0,m=_):d=0,(m|0)<0?(y=f-m|0,h[c>>2]=y,d=d-m|0,h[b>>2]=d,h[M>>2]=0,_=y-d|0,f=0-d|0,(d|0)<0?(h[c>>2]=_,h[M>>2]=f,h[b>>2]=0,m=f,d=0):(m=0,_=y)):_=f,f=(m|0)<(_|0)?m:_,f=(d|0)<(f|0)?d:f,!((f|0)<=0)&&(h[c>>2]=_-f,h[M>>2]=m-f,h[b>>2]=d-f)}function ND(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0,k=0,Y=0;if(Y=z,z=z+64|0,k=Y,M=Y+56|0,!(!0&(f&2013265920|0)==134217728&(!0&(m&2013265920|0)==134217728)))return _=5,z=Y,_|0;if((c|0)==(d|0)&(f|0)==(m|0))return h[_>>2]=0,_=0,z=Y,_|0;if(b=rt(c|0,f|0,52)|0,X()|0,b=b&15,P=rt(d|0,m|0,52)|0,X()|0,(b|0)!=(P&15|0))return _=12,z=Y,_|0;if(y=b+-1|0,b>>>0>1){r_(c,f,y,k)|0,r_(d,m,y,M)|0,P=k,C=h[P>>2]|0,P=h[P+4>>2]|0;e:do if((C|0)==(h[M>>2]|0)&&(P|0)==(h[M+4>>2]|0)){b=(b^15)*3|0,y=rt(c|0,f|0,b|0)|0,X()|0,y=y&7,b=rt(d|0,m|0,b|0)|0,X()|0,b=b&7;do if((y|0)==0|(b|0)==0)h[_>>2]=1,y=0;else if((y|0)==7)y=5;else{if((y|0)==1|(b|0)==1&&di(C,P)|0){y=5;break}if((h[15536+(y<<2)>>2]|0)!=(b|0)&&(h[15568+(y<<2)>>2]|0)!=(b|0))break e;h[_>>2]=1,y=0}while(!1);return _=y,z=Y,_|0}while(!1)}y=k,b=y+56|0;do h[y>>2]=0,y=y+4|0;while((y|0)<(b|0));return es(c,f,1,k)|0,f=k,!((h[f>>2]|0)==(d|0)&&(h[f+4>>2]|0)==(m|0))&&(f=k+8|0,!((h[f>>2]|0)==(d|0)&&(h[f+4>>2]|0)==(m|0)))&&(f=k+16|0,!((h[f>>2]|0)==(d|0)&&(h[f+4>>2]|0)==(m|0)))&&(f=k+24|0,!((h[f>>2]|0)==(d|0)&&(h[f+4>>2]|0)==(m|0)))&&(f=k+32|0,!((h[f>>2]|0)==(d|0)&&(h[f+4>>2]|0)==(m|0)))&&(f=k+40|0,!((h[f>>2]|0)==(d|0)&&(h[f+4>>2]|0)==(m|0)))?(y=k+48|0,y=((h[y>>2]|0)==(d|0)?(h[y+4>>2]|0)==(m|0):0)&1):y=1,h[_>>2]=y,_=0,z=Y,_|0}function PD(c,f,d,m,_){return c=c|0,f=f|0,d=d|0,m=m|0,_=_|0,d=wr(c,f,d,m)|0,(d|0)==7?(_=11,_|0):(m=dt(d|0,0,56)|0,f=f&-2130706433|(X()|0)|268435456,h[_>>2]=c|m,h[_+4>>2]=f,_=0,_|0)}function LD(c,f,d){return c=c|0,f=f|0,d=d|0,!0&(f&2013265920|0)==268435456?(h[d>>2]=c,h[d+4>>2]=f&-2130706433|134217728,d=0,d|0):(d=6,d|0)}function DD(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0;return _=z,z=z+16|0,m=_,h[m>>2]=0,!0&(f&2013265920|0)==268435456?(y=rt(c|0,f|0,56)|0,X()|0,m=ti(c,f&-2130706433|134217728,y&7,m,d)|0,z=_,m|0):(m=6,z=_,m|0)}function ID(c,f){c=c|0,f=f|0;var d=0;switch(d=rt(c|0,f|0,56)|0,X()|0,d&7){case 0:case 7:return d=0,d|0}return d=f&-2130706433|134217728,!(!0&(f&2013265920|0)==268435456)||!0&(f&117440512|0)==16777216&(di(c,d)|0)!=0?(d=0,d|0):(d=n_(c,d)|0,d|0)}function BD(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0;return _=z,z=z+16|0,m=_,!0&(f&2013265920|0)==268435456?(y=f&-2130706433|134217728,b=d,h[b>>2]=c,h[b+4>>2]=y,h[m>>2]=0,f=rt(c|0,f|0,56)|0,X()|0,m=ti(c,y,f&7,m,d+8|0)|0,z=_,m|0):(m=6,z=_,m|0)}function FD(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0;return _=(di(c,f)|0)==0,f=f&-2130706433,m=d,h[m>>2]=_?c:0,h[m+4>>2]=_?f|285212672:0,m=d+8|0,h[m>>2]=c,h[m+4>>2]=f|301989888,m=d+16|0,h[m>>2]=c,h[m+4>>2]=f|318767104,m=d+24|0,h[m>>2]=c,h[m+4>>2]=f|335544320,m=d+32|0,h[m>>2]=c,h[m+4>>2]=f|352321536,d=d+40|0,h[d>>2]=c,h[d+4>>2]=f|369098752,0}function Cp(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0;return b=z,z=z+16|0,_=b,y=f&-2130706433|134217728,!0&(f&2013265920|0)==268435456?(m=rt(c|0,f|0,56)|0,X()|0,m=DI(c,y,m&7)|0,(m|0)==-1?(h[d>>2]=0,y=6,z=b,y|0):(vh(c,y,_)|0&&ft(27795,26932,282,26947),f=rt(c|0,f|0,52)|0,X()|0,f=f&15,di(c,y)|0?e_(_,f,m,2,d):t_(_,f,m,2,d),y=0,z=b,y|0)):(y=6,z=b,y|0)}function UD(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0;m=z,z=z+16|0,_=m,OD(c,f,d,_),wD(_,d+4|0),z=m}function OD(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0;if(M=z,z=z+16|0,C=M,kD(c,d,C),y=+gh(+(1-+$[C>>3]*.5)),y<1e-16){h[m>>2]=0,h[m+4>>2]=0,h[m+8>>2]=0,h[m+12>>2]=0,z=M;return}if(C=h[d>>2]|0,_=+$[15920+(C*24|0)>>3],_=+DA(_-+DA(+nI(15600+(C<<4)|0,c))),Mo(f)|0?b=+DA(_+-.3334731722518321):b=_,_=+Os(+y)*2.618033988749896,(f|0)>0){c=0;do _=_*2.6457513110645907,c=c+1|0;while((c|0)!=(f|0))}y=+$n(+b)*_,$[m>>3]=y,b=+Sn(+b)*_,$[m+8>>3]=b,z=M}function kD(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0;if(y=z,z=z+32|0,_=y,LI(c,_),h[f>>2]=0,$[d>>3]=5,m=+dr(16400,_),m<+$[d>>3]&&(h[f>>2]=0,$[d>>3]=m),m=+dr(16424,_),m<+$[d>>3]&&(h[f>>2]=1,$[d>>3]=m),m=+dr(16448,_),m<+$[d>>3]&&(h[f>>2]=2,$[d>>3]=m),m=+dr(16472,_),m<+$[d>>3]&&(h[f>>2]=3,$[d>>3]=m),m=+dr(16496,_),m<+$[d>>3]&&(h[f>>2]=4,$[d>>3]=m),m=+dr(16520,_),m<+$[d>>3]&&(h[f>>2]=5,$[d>>3]=m),m=+dr(16544,_),m<+$[d>>3]&&(h[f>>2]=6,$[d>>3]=m),m=+dr(16568,_),m<+$[d>>3]&&(h[f>>2]=7,$[d>>3]=m),m=+dr(16592,_),m<+$[d>>3]&&(h[f>>2]=8,$[d>>3]=m),m=+dr(16616,_),m<+$[d>>3]&&(h[f>>2]=9,$[d>>3]=m),m=+dr(16640,_),m<+$[d>>3]&&(h[f>>2]=10,$[d>>3]=m),m=+dr(16664,_),m<+$[d>>3]&&(h[f>>2]=11,$[d>>3]=m),m=+dr(16688,_),m<+$[d>>3]&&(h[f>>2]=12,$[d>>3]=m),m=+dr(16712,_),m<+$[d>>3]&&(h[f>>2]=13,$[d>>3]=m),m=+dr(16736,_),m<+$[d>>3]&&(h[f>>2]=14,$[d>>3]=m),m=+dr(16760,_),m<+$[d>>3]&&(h[f>>2]=15,$[d>>3]=m),m=+dr(16784,_),m<+$[d>>3]&&(h[f>>2]=16,$[d>>3]=m),m=+dr(16808,_),m<+$[d>>3]&&(h[f>>2]=17,$[d>>3]=m),m=+dr(16832,_),m<+$[d>>3]&&(h[f>>2]=18,$[d>>3]=m),m=+dr(16856,_),!(m<+$[d>>3])){z=y;return}h[f>>2]=19,$[d>>3]=m,z=y}function PA(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0;if(y=+PI(c),y<1e-16){f=15600+(f<<4)|0,h[_>>2]=h[f>>2],h[_+4>>2]=h[f+4>>2],h[_+8>>2]=h[f+8>>2],h[_+12>>2]=h[f+12>>2];return}if(b=+Ce(+ +$[c+8>>3],+ +$[c>>3]),(d|0)>0){c=0;do y=y*.37796447300922725,c=c+1|0;while((c|0)!=(d|0))}M=y*.3333333333333333,m?(d=(Mo(d)|0)==0,y=+ee(+((d?M:M*.37796447300922725)*.381966011250105))):(y=+ee(+(y*.381966011250105)),Mo(d)|0&&(b=+DA(b+.3334731722518321))),iI(15600+(f<<4)|0,+DA(+$[15920+(f*24|0)>>3]-b),y,_)}function VD(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0;m=z,z=z+16|0,_=m,Qu(c+4|0,_),PA(_,h[c>>2]|0,f,0,d),z=m}function e_(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0,ht=0,kt=0,Dt=0,ln=0,An=0,Nn=0,nn=0,Vt=0,ct=0,Mn=0,ci=0,vn=0;if(Mn=z,z=z+272|0,y=Mn+256|0,Ie=Mn+240|0,nn=Mn,Vt=Mn+224|0,ct=Mn+208|0,Pe=Mn+176|0,_e=Mn+160|0,ht=Mn+192|0,kt=Mn+144|0,Dt=Mn+128|0,ln=Mn+112|0,An=Mn+96|0,Nn=Mn+80|0,h[y>>2]=f,h[Ie>>2]=h[c>>2],h[Ie+4>>2]=h[c+4>>2],h[Ie+8>>2]=h[c+8>>2],h[Ie+12>>2]=h[c+12>>2],o5(Ie,y,nn),h[_>>2]=0,Ie=m+d+((m|0)==5&1)|0,(Ie|0)<=(d|0)){z=Mn;return}C=h[y>>2]|0,P=Vt+4|0,k=Pe+4|0,Y=d+5|0,le=16880+(C<<2)|0,se=16960+(C<<2)|0,oe=Dt+8|0,me=ln+8|0,Te=An+8|0,Oe=ct+4|0,M=d;e:for(;;){b=nn+(((M|0)%5|0)<<4)|0,h[ct>>2]=h[b>>2],h[ct+4>>2]=h[b+4>>2],h[ct+8>>2]=h[b+8>>2],h[ct+12>>2]=h[b+12>>2];do;while((_h(ct,C,0,1)|0)==2);if((M|0)>(d|0)&(Mo(f)|0)!=0){if(h[Pe>>2]=h[ct>>2],h[Pe+4>>2]=h[ct+4>>2],h[Pe+8>>2]=h[ct+8>>2],h[Pe+12>>2]=h[ct+12>>2],Qu(P,_e),m=h[Pe>>2]|0,y=h[17040+(m*80|0)+(h[Vt>>2]<<2)>>2]|0,h[Pe>>2]=h[18640+(m*80|0)+(y*20|0)>>2],b=h[18640+(m*80|0)+(y*20|0)+16>>2]|0,(b|0)>0){c=0;do n5(k),c=c+1|0;while((c|0)<(b|0))}switch(b=18640+(m*80|0)+(y*20|0)+4|0,h[ht>>2]=h[b>>2],h[ht+4>>2]=h[b+4>>2],h[ht+8>>2]=h[b+8>>2],Jb(ht,(h[le>>2]|0)*3|0),_s(k,ht,k),ns(k),Qu(k,kt),ci=+(h[se>>2]|0),$[Dt>>3]=ci*3,$[oe>>3]=0,vn=ci*-1.5,$[ln>>3]=vn,$[me>>3]=ci*2.598076211353316,$[An>>3]=vn,$[Te>>3]=ci*-2.598076211353316,h[17040+((h[Pe>>2]|0)*80|0)+(h[ct>>2]<<2)>>2]|0){case 1:{c=ln,m=Dt;break}case 3:{c=An,m=ln;break}case 2:{c=Dt,m=An;break}default:{c=12;break e}}b5(_e,kt,m,c,Nn),PA(Nn,h[Pe>>2]|0,C,1,_+8+(h[_>>2]<<4)|0),h[_>>2]=(h[_>>2]|0)+1}if((M|0)<(Y|0)&&(Qu(Oe,Pe),PA(Pe,h[ct>>2]|0,C,1,_+8+(h[_>>2]<<4)|0),h[_>>2]=(h[_>>2]|0)+1),h[Vt>>2]=h[ct>>2],h[Vt+4>>2]=h[ct+4>>2],h[Vt+8>>2]=h[ct+8>>2],h[Vt+12>>2]=h[ct+12>>2],M=M+1|0,(M|0)>=(Ie|0)){c=3;break}}if((c|0)==3){z=Mn;return}else(c|0)==12&&ft(26970,27017,572,27027)}function o5(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0;C=z,z=z+128|0,m=C+64|0,_=C,y=m,b=20240,M=y+60|0;do h[y>>2]=h[b>>2],y=y+4|0,b=b+4|0;while((y|0)<(M|0));y=_,b=20304,M=y+60|0;do h[y>>2]=h[b>>2],y=y+4|0,b=b+4|0;while((y|0)<(M|0));M=(Mo(h[f>>2]|0)|0)==0,m=M?m:_,_=c+4|0,i5(_),r5(_),Mo(h[f>>2]|0)|0&&(Yu(_),h[f>>2]=(h[f>>2]|0)+1),h[d>>2]=h[c>>2],f=d+4|0,_s(_,m,f),ns(f),h[d+16>>2]=h[c>>2],f=d+20|0,_s(_,m+12|0,f),ns(f),h[d+32>>2]=h[c>>2],f=d+36|0,_s(_,m+24|0,f),ns(f),h[d+48>>2]=h[c>>2],f=d+52|0,_s(_,m+36|0,f),ns(f),h[d+64>>2]=h[c>>2],d=d+68|0,_s(_,m+48|0,d),ns(d),z=C}function _h(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0;if(oe=z,z=z+32|0,le=oe+12|0,M=oe,se=c+4|0,Y=h[16960+(f<<2)>>2]|0,k=(m|0)!=0,Y=k?Y*3|0:Y,_=h[se>>2]|0,P=c+8|0,b=h[P>>2]|0,k){if(y=c+12|0,m=h[y>>2]|0,_=b+_+m|0,(_|0)==(Y|0))return se=1,z=oe,se|0;C=y}else C=c+12|0,m=h[C>>2]|0,_=b+_+m|0;if((_|0)<=(Y|0))return se=0,z=oe,se|0;do if((m|0)>0){if(m=h[c>>2]|0,(b|0)>0){y=18640+(m*80|0)+60|0,m=c;break}m=18640+(m*80|0)+40|0,d?(bD(le,Y,0,0),K2(se,le,M),Ep(M),_s(M,le,se),y=m,m=c):(y=m,m=c)}else y=18640+((h[c>>2]|0)*80|0)+20|0,m=c;while(!1);if(h[m>>2]=h[y>>2],_=y+16|0,(h[_>>2]|0)>0){m=0;do n5(se),m=m+1|0;while((m|0)<(h[_>>2]|0))}return c=y+4|0,h[le>>2]=h[c>>2],h[le+4>>2]=h[c+4>>2],h[le+8>>2]=h[c+8>>2],f=h[16880+(f<<2)>>2]|0,Jb(le,k?f*3|0:f),_s(se,le,se),ns(se),k?m=((h[P>>2]|0)+(h[se>>2]|0)+(h[C>>2]|0)|0)==(Y|0)?1:2:m=2,se=m,z=oe,se|0}function GD(c,f){c=c|0,f=f|0;var d=0;do d=_h(c,f,0,1)|0;while((d|0)==2);return d|0}function t_(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0,ht=0,kt=0,Dt=0,ln=0,An=0,Nn=0,nn=0;if(An=z,z=z+240|0,y=An+224|0,ht=An+208|0,kt=An,Dt=An+192|0,ln=An+176|0,Te=An+160|0,Oe=An+144|0,Ie=An+128|0,Pe=An+112|0,_e=An+96|0,h[y>>2]=f,h[ht>>2]=h[c>>2],h[ht+4>>2]=h[c+4>>2],h[ht+8>>2]=h[c+8>>2],h[ht+12>>2]=h[c+12>>2],a5(ht,y,kt),h[_>>2]=0,me=m+d+((m|0)==6&1)|0,(me|0)<=(d|0)){z=An;return}C=h[y>>2]|0,P=d+6|0,k=16960+(C<<2)|0,Y=Oe+8|0,le=Ie+8|0,se=Pe+8|0,oe=Dt+4|0,b=0,M=d,m=-1;e:for(;;){if(y=(M|0)%6|0,c=kt+(y<<4)|0,h[Dt>>2]=h[c>>2],h[Dt+4>>2]=h[c+4>>2],h[Dt+8>>2]=h[c+8>>2],h[Dt+12>>2]=h[c+12>>2],c=b,b=_h(Dt,C,0,1)|0,(M|0)>(d|0)&(Mo(f)|0)!=0&&(c|0)!=1&&(h[Dt>>2]|0)!=(m|0)){switch(Qu(kt+(((y+5|0)%6|0)<<4)+4|0,ln),Qu(kt+(y<<4)+4|0,Te),Nn=+(h[k>>2]|0),$[Oe>>3]=Nn*3,$[Y>>3]=0,nn=Nn*-1.5,$[Ie>>3]=nn,$[le>>3]=Nn*2.598076211353316,$[Pe>>3]=nn,$[se>>3]=Nn*-2.598076211353316,y=h[ht>>2]|0,h[17040+(y*80|0)+(((m|0)==(y|0)?h[Dt>>2]|0:m)<<2)>>2]|0){case 1:{c=Ie,m=Oe;break}case 3:{c=Pe,m=Ie;break}case 2:{c=Oe,m=Pe;break}default:{c=8;break e}}b5(ln,Te,m,c,_e),!(w5(ln,_e)|0)&&!(w5(Te,_e)|0)&&(PA(_e,h[ht>>2]|0,C,1,_+8+(h[_>>2]<<4)|0),h[_>>2]=(h[_>>2]|0)+1)}if((M|0)<(P|0)&&(Qu(oe,ln),PA(ln,h[Dt>>2]|0,C,1,_+8+(h[_>>2]<<4)|0),h[_>>2]=(h[_>>2]|0)+1),M=M+1|0,(M|0)>=(me|0)){c=3;break}else m=h[Dt>>2]|0}if((c|0)==3){z=An;return}else(c|0)==8&&ft(27054,27017,737,27099)}function a5(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0;C=z,z=z+160|0,m=C+80|0,_=C,y=m,b=20368,M=y+72|0;do h[y>>2]=h[b>>2],y=y+4|0,b=b+4|0;while((y|0)<(M|0));y=_,b=20448,M=y+72|0;do h[y>>2]=h[b>>2],y=y+4|0,b=b+4|0;while((y|0)<(M|0));M=(Mo(h[f>>2]|0)|0)==0,m=M?m:_,_=c+4|0,i5(_),r5(_),Mo(h[f>>2]|0)|0&&(Yu(_),h[f>>2]=(h[f>>2]|0)+1),h[d>>2]=h[c>>2],f=d+4|0,_s(_,m,f),ns(f),h[d+16>>2]=h[c>>2],f=d+20|0,_s(_,m+12|0,f),ns(f),h[d+32>>2]=h[c>>2],f=d+36|0,_s(_,m+24|0,f),ns(f),h[d+48>>2]=h[c>>2],f=d+52|0,_s(_,m+36|0,f),ns(f),h[d+64>>2]=h[c>>2],f=d+68|0,_s(_,m+48|0,f),ns(f),h[d+80>>2]=h[c>>2],d=d+84|0,_s(_,m+60|0,d),ns(d),z=C}function qD(c,f){return c=c|0,f=f|0,f=rt(c|0,f|0,52)|0,X()|0,f&15|0}function l5(c,f){return c=c|0,f=f|0,f=rt(c|0,f|0,45)|0,X()|0,f&127|0}function n_(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0;return!(!0&(f&-16777216|0)==134217728)||(m=rt(c|0,f|0,52)|0,X()|0,m=m&15,d=rt(c|0,f|0,45)|0,X()|0,d=d&127,d>>>0>121)?(c=0,c|0):(b=(m^15)*3|0,_=rt(c|0,f|0,b|0)|0,b=dt(_|0,X()|0,b|0)|0,_=X()|0,y=Gr(-1227133514,-1171,b|0,_|0)|0,!((b&613566756&y|0)==0&(_&4681&(X()|0)|0)==0)||(b=(m*3|0)+19|0,y=dt(~c|0,~f|0,b|0)|0,b=rt(y|0,X()|0,b|0)|0,!((m|0)==15|(b|0)==0&(X()|0)==0))?(b=0,b|0):!(nt[20528+d>>0]|0)||(f=f&8191,(c|0)==0&(f|0)==0)?(b=1,b|0):(b=N5(c|0,f|0)|0,X()|0,((63-b|0)%3|0|0)!=0|0))}function i_(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0;if(_=dt(f|0,0,52)|0,y=X()|0,d=dt(d|0,0,45)|0,d=y|(X()|0)|134225919,(f|0)<1){y=-1,m=d,f=c,h[f>>2]=y,c=c+4|0,h[c>>2]=m;return}for(y=1,_=-1;b=(15-y|0)*3|0,M=dt(7,0,b|0)|0,d=d&~(X()|0),b=dt(m|0,0,b|0)|0,_=_&~M|b,d=d|(X()|0),(y|0)!=(f|0);)y=y+1|0;M=c,b=M,h[b>>2]=_,M=M+4|0,h[M>>2]=d}function r_(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0;if(y=rt(c|0,f|0,52)|0,X()|0,y=y&15,d>>>0>15)return m=4,m|0;if((y|0)<(d|0))return m=12,m|0;if((y|0)==(d|0))return h[m>>2]=c,h[m+4>>2]=f,m=0,m|0;if(_=dt(d|0,0,52)|0,_=_|c,c=X()|0|f&-15728641,(y|0)>(d|0))do f=dt(7,0,(14-d|0)*3|0)|0,d=d+1|0,_=f|_,c=X()|0|c;while((d|0)<(y|0));return h[m>>2]=_,h[m+4>>2]=c,m=0,m|0}function LA(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0;if(y=rt(c|0,f|0,52)|0,X()|0,y=y&15,!((d|0)<16&(y|0)<=(d|0)))return m=4,m|0;_=d-y|0,d=rt(c|0,f|0,45)|0,X()|0;e:do if(!(Ni(d&127)|0))d=tu(7,0,_,((_|0)<0)<<31>>31)|0,_=X()|0;else{t:do if(y|0){for(d=1;b=dt(7,0,(15-d|0)*3|0)|0,!!((b&c|0)==0&((X()|0)&f|0)==0);)if(d>>>0<y>>>0)d=d+1|0;else break t;d=tu(7,0,_,((_|0)<0)<<31>>31)|0,_=X()|0;break e}while(!1);d=tu(7,0,_,((_|0)<0)<<31>>31)|0,d=is(d|0,X()|0,5,0)|0,d=Qt(d|0,X()|0,-5,-1)|0,d=iu(d|0,X()|0,6,0)|0,d=Qt(d|0,X()|0,1,0)|0,_=X()|0}while(!1);return b=m,h[b>>2]=d,h[b+4>>2]=_,b=0,b|0}function di(c,f){c=c|0,f=f|0;var d=0,m=0,_=0;if(_=rt(c|0,f|0,45)|0,X()|0,!(Ni(_&127)|0))return _=0,_|0;_=rt(c|0,f|0,52)|0,X()|0,_=_&15;e:do if(!_)d=0;else for(m=1;;){if(d=rt(c|0,f|0,(15-m|0)*3|0)|0,X()|0,d=d&7,d|0)break e;if(m>>>0<_>>>0)m=m+1|0;else{d=0;break}}while(!1);return _=(d|0)==0&1,_|0}function zD(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0;if(b=z,z=z+16|0,y=b,c_(y,c,f,d),f=y,c=h[f>>2]|0,f=h[f+4>>2]|0,(c|0)==0&(f|0)==0)return z=b,0;_=0,d=0;do M=m+(_<<3)|0,h[M>>2]=c,h[M+4>>2]=f,_=Qt(_|0,d|0,1,0)|0,d=X()|0,h_(y),M=y,c=h[M>>2]|0,f=h[M+4>>2]|0;while(!((c|0)==0&(f|0)==0));return z=b,0}function u5(c,f,d,m){return c=c|0,f=f|0,d=d|0,m=m|0,(m|0)<(d|0)?(d=f,m=c,et(d|0),m|0):(d=dt(-1,-1,((m-d|0)*3|0)+3|0)|0,m=dt(~d|0,~(X()|0)|0,(15-m|0)*3|0)|0,d=~(X()|0)&f,m=~m&c,et(d|0),m|0)}function c5(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0;return _=rt(c|0,f|0,52)|0,X()|0,_=_&15,(d|0)<16&(_|0)<=(d|0)?((_|0)<(d|0)&&(_=dt(-1,-1,((d+-1-_|0)*3|0)+3|0)|0,_=dt(~_|0,~(X()|0)|0,(15-d|0)*3|0)|0,f=~(X()|0)&f,c=~_&c),_=dt(d|0,0,52)|0,d=f&-15728641|(X()|0),h[m>>2]=c|_,h[m+4>>2]=d,m=0,m|0):(m=4,m|0)}function HD(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0,ht=0,kt=0,Dt=0,ln=0,An=0,Nn=0,nn=0,Vt=0,ct=0;if((d|0)==0&(m|0)==0)return ct=0,ct|0;if(_=c,y=h[_>>2]|0,_=h[_+4>>2]|0,!0&(_&15728640|0)==0){if(!((m|0)>0|(m|0)==0&d>>>0>0)||(ct=f,h[ct>>2]=y,h[ct+4>>2]=_,(d|0)==1&(m|0)==0))return ct=0,ct|0;_=1,y=0;do nn=c+(_<<3)|0,Vt=h[nn+4>>2]|0,ct=f+(_<<3)|0,h[ct>>2]=h[nn>>2],h[ct+4>>2]=Vt,_=Qt(_|0,y|0,1,0)|0,y=X()|0;while((y|0)<(m|0)|(y|0)==(m|0)&_>>>0<d>>>0);return _=0,_|0}if(Nn=d<<3,Vt=Ta(Nn)|0,!Vt)return ct=13,ct|0;if(Sh(Vt|0,c|0,Nn|0)|0,nn=Co(d,8)|0,!nn)return Jt(Vt),ct=13,ct|0;e:for(;;){_=Vt,P=h[_>>2]|0,_=h[_+4>>2]|0,ln=rt(P|0,_|0,52)|0,X()|0,ln=ln&15,An=ln+-1|0,Dt=(ln|0)!=0,kt=(m|0)>0|(m|0)==0&d>>>0>0;t:do if(Dt&kt){if(Ie=dt(An|0,0,52)|0,Pe=X()|0,An>>>0>15){if(!((P|0)==0&(_|0)==0)){ct=16;break e}for(y=0,c=0;;){if(y=Qt(y|0,c|0,1,0)|0,c=X()|0,!((c|0)<(m|0)|(c|0)==(m|0)&y>>>0<d>>>0))break t;if(b=Vt+(y<<3)|0,ht=h[b>>2]|0,b=h[b+4>>2]|0,!((ht|0)==0&(b|0)==0)){_=b,ct=16;break e}}}for(M=P,c=_,y=0,b=0;;){if(!((M|0)==0&(c|0)==0)){if(!(!0&(c&117440512|0)==0)){ct=21;break e}if(k=rt(M|0,c|0,52)|0,X()|0,k=k&15,(k|0)<(An|0)){_=12,ct=27;break e}if((k|0)!=(An|0)&&(M=M|Ie,c=c&-15728641|Pe,k>>>0>=ln>>>0)){C=An;do ht=dt(7,0,(14-C|0)*3|0)|0,C=C+1|0,M=ht|M,c=X()|0|c;while(C>>>0<k>>>0)}if(le=wh(M|0,c|0,d|0,m|0)|0,se=X()|0,C=nn+(le<<3)|0,k=C,Y=h[k>>2]|0,k=h[k+4>>2]|0,!((Y|0)==0&(k|0)==0)){Te=0,Oe=0;do{if((Te|0)>(m|0)|(Te|0)==(m|0)&Oe>>>0>d>>>0){ct=31;break e}if((Y|0)==(M|0)&(k&-117440513|0)==(c|0)){oe=rt(Y|0,k|0,56)|0,X()|0,oe=oe&7,me=oe+1|0,ht=rt(Y|0,k|0,45)|0,X()|0;n:do if(!(Ni(ht&127)|0))k=7;else{if(Y=rt(Y|0,k|0,52)|0,X()|0,Y=Y&15,!Y){k=6;break}for(k=1;;){if(ht=dt(7,0,(15-k|0)*3|0)|0,!((ht&M|0)==0&((X()|0)&c|0)==0)){k=7;break n}if(k>>>0<Y>>>0)k=k+1|0;else{k=6;break}}}while(!1);if((oe+2|0)>>>0>k>>>0){ct=41;break e}ht=dt(me|0,0,56)|0,c=X()|0|c&-117440513,_e=C,h[_e>>2]=0,h[_e+4>>2]=0,M=ht|M}else le=Qt(le|0,se|0,1,0)|0,le=bh(le|0,X()|0,d|0,m|0)|0,se=X()|0;Oe=Qt(Oe|0,Te|0,1,0)|0,Te=X()|0,C=nn+(le<<3)|0,k=C,Y=h[k>>2]|0,k=h[k+4>>2]|0}while(!((Y|0)==0&(k|0)==0))}ht=C,h[ht>>2]=M,h[ht+4>>2]=c}if(y=Qt(y|0,b|0,1,0)|0,b=X()|0,!((b|0)<(m|0)|(b|0)==(m|0)&y>>>0<d>>>0))break t;c=Vt+(y<<3)|0,M=h[c>>2]|0,c=h[c+4>>2]|0}}while(!1);if(ht=Qt(d|0,m|0,5,0)|0,_e=X()|0,_e>>>0<0|(_e|0)==0&ht>>>0<11){ct=85;break}if(ht=iu(d|0,m|0,6,0)|0,X()|0,ht=Co(ht,8)|0,!ht){ct=48;break}do if(kt){for(me=0,c=0,oe=0,Te=0;;){if(k=nn+(me<<3)|0,b=k,y=h[b>>2]|0,b=h[b+4>>2]|0,(y|0)==0&(b|0)==0)_e=oe;else{Y=rt(y|0,b|0,56)|0,X()|0,Y=Y&7,M=Y+1|0,le=b&-117440513,_e=rt(y|0,b|0,45)|0,X()|0;t:do if(Ni(_e&127)|0){if(se=rt(y|0,b|0,52)|0,X()|0,se=se&15,se|0)for(C=1;;){if(_e=dt(7,0,(15-C|0)*3|0)|0,!((y&_e|0)==0&(le&(X()|0)|0)==0))break t;if(C>>>0<se>>>0)C=C+1|0;else break}b=dt(M|0,0,56)|0,y=b|y,b=X()|0|le,M=k,h[M>>2]=y,h[M+4>>2]=b,M=Y+2|0}while(!1);(M|0)==7?(_e=ht+(c<<3)|0,h[_e>>2]=y,h[_e+4>>2]=b&-117440513,c=Qt(c|0,oe|0,1,0)|0,_e=X()|0):_e=oe}if(me=Qt(me|0,Te|0,1,0)|0,Te=X()|0,(Te|0)<(m|0)|(Te|0)==(m|0)&me>>>0<d>>>0)oe=_e;else break}if(kt){if(Oe=An>>>0>15,Ie=dt(An|0,0,52)|0,Pe=X()|0,!Dt){for(y=0,C=0,M=0,b=0;(P|0)==0&(_|0)==0||(An=f+(y<<3)|0,h[An>>2]=P,h[An+4>>2]=_,y=Qt(y|0,C|0,1,0)|0,C=X()|0),M=Qt(M|0,b|0,1,0)|0,b=X()|0,!!((b|0)<(m|0)|(b|0)==(m|0)&M>>>0<d>>>0);)_=Vt+(M<<3)|0,P=h[_>>2]|0,_=h[_+4>>2]|0;_=_e;break}for(y=0,C=0,b=0,M=0;;){do if(!((P|0)==0&(_|0)==0)){if(se=rt(P|0,_|0,52)|0,X()|0,se=se&15,Oe|(se|0)<(An|0)){ct=80;break e}if((se|0)!=(An|0)){if(k=P|Ie,Y=_&-15728641|Pe,se>>>0>=ln>>>0){le=An;do Dt=dt(7,0,(14-le|0)*3|0)|0,le=le+1|0,k=Dt|k,Y=X()|0|Y;while(le>>>0<se>>>0)}}else k=P,Y=_;oe=wh(k|0,Y|0,d|0,m|0)|0,le=0,se=0,Te=X()|0;do{if((le|0)>(m|0)|(le|0)==(m|0)&se>>>0>d>>>0){ct=81;break e}if(Dt=nn+(oe<<3)|0,me=h[Dt+4>>2]|0,(me&-117440513|0)==(Y|0)&&(h[Dt>>2]|0)==(k|0)){ct=65;break}Dt=Qt(oe|0,Te|0,1,0)|0,oe=bh(Dt|0,X()|0,d|0,m|0)|0,Te=X()|0,se=Qt(se|0,le|0,1,0)|0,le=X()|0,Dt=nn+(oe<<3)|0}while(!((h[Dt>>2]|0)==(k|0)&&(h[Dt+4>>2]|0)==(Y|0)));if((ct|0)==65&&(ct=0,!0&(me&117440512|0)==100663296))break;Dt=f+(y<<3)|0,h[Dt>>2]=P,h[Dt+4>>2]=_,y=Qt(y|0,C|0,1,0)|0,C=X()|0}while(!1);if(b=Qt(b|0,M|0,1,0)|0,M=X()|0,!((M|0)<(m|0)|(M|0)==(m|0)&b>>>0<d>>>0))break;_=Vt+(b<<3)|0,P=h[_>>2]|0,_=h[_+4>>2]|0}_=_e}else y=0,_=_e}else y=0,c=0,_=0;while(!1);if(ec(nn|0,0,Nn|0)|0,Sh(Vt|0,ht|0,c<<3|0)|0,Jt(ht),(c|0)==0&(_|0)==0){ct=89;break}else f=f+(y<<3)|0,m=_,d=c}if((ct|0)==16)!0&(_&117440512|0)==0?(_=4,ct=27):ct=21;else if((ct|0)==31)ft(27795,27122,529,27132);else{if((ct|0)==41)return Jt(Vt),Jt(nn),ct=10,ct|0;if((ct|0)==48)return Jt(Vt),Jt(nn),ct=13,ct|0;(ct|0)==80?ft(27795,27122,620,27132):(ct|0)==81?ft(27795,27122,632,27132):(ct|0)==85&&(Sh(f|0,Vt|0,d<<3|0)|0,ct=89)}return(ct|0)==21?(Jt(Vt),Jt(nn),ct=5,ct|0):(ct|0)==27?(Jt(Vt),Jt(nn),ct=_,ct|0):(ct|0)==89?(Jt(Vt),Jt(nn),ct=0,ct|0):0}function $D(c,f,d,m,_,y,b){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0,y=y|0,b=b|0;var M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0;if(me=z,z=z+16|0,oe=me,!((d|0)>0|(d|0)==0&f>>>0>0))return oe=0,z=me,oe|0;if((b|0)>=16)return oe=12,z=me,oe|0;le=0,se=0,Y=0,M=0;e:for(;;){if(P=c+(le<<3)|0,C=h[P>>2]|0,P=h[P+4>>2]|0,k=rt(C|0,P|0,52)|0,X()|0,(k&15|0)>(b|0)){M=12,C=11;break}if(c_(oe,C,P,b),k=oe,P=h[k>>2]|0,k=h[k+4>>2]|0,(P|0)==0&(k|0)==0)C=Y;else{C=Y;do{if(!((M|0)<(y|0)|(M|0)==(y|0)&C>>>0<_>>>0)){C=10;break e}Y=m+(C<<3)|0,h[Y>>2]=P,h[Y+4>>2]=k,C=Qt(C|0,M|0,1,0)|0,M=X()|0,h_(oe),Y=oe,P=h[Y>>2]|0,k=h[Y+4>>2]|0}while(!((P|0)==0&(k|0)==0))}if(le=Qt(le|0,se|0,1,0)|0,se=X()|0,(se|0)<(d|0)|(se|0)==(d|0)&le>>>0<f>>>0)Y=C;else{M=0,C=11;break}}return(C|0)==10?(oe=14,z=me,oe|0):(C|0)==11?(z=me,M|0):0}function WD(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0;le=z,z=z+16|0,Y=le;e:do if((d|0)>0|(d|0)==0&f>>>0>0){for(P=0,b=0,y=0,k=0;;){if(C=c+(P<<3)|0,M=h[C>>2]|0,C=h[C+4>>2]|0,!((M|0)==0&(C|0)==0)&&(C=(LA(M,C,m,Y)|0)==0,M=Y,b=Qt(h[M>>2]|0,h[M+4>>2]|0,b|0,y|0)|0,y=X()|0,!C)){y=12;break}if(P=Qt(P|0,k|0,1,0)|0,k=X()|0,!((k|0)<(d|0)|(k|0)==(d|0)&P>>>0<f>>>0))break e}return z=le,y|0}else b=0,y=0;while(!1);return h[_>>2]=b,h[_+4>>2]=y,_=0,z=le,_|0}function jD(c,f){return c=c|0,f=f|0,f=rt(c|0,f|0,52)|0,X()|0,f&1|0}function ks(c,f){c=c|0,f=f|0;var d=0,m=0,_=0;if(_=rt(c|0,f|0,52)|0,X()|0,_=_&15,!_)return _=0,_|0;for(m=1;;){if(d=rt(c|0,f|0,(15-m|0)*3|0)|0,X()|0,d=d&7,d|0){m=5;break}if(m>>>0<_>>>0)m=m+1|0;else{d=0,m=5;break}}return(m|0)==5?d|0:0}function s_(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0,C=0;if(C=rt(c|0,f|0,52)|0,X()|0,C=C&15,!C)return M=f,C=c,et(M|0),C|0;for(M=1,d=0;;){y=(15-M|0)*3|0,m=dt(7,0,y|0)|0,_=X()|0,b=rt(c|0,f|0,y|0)|0,X()|0,y=dt(Zu(b&7)|0,0,y|0)|0,b=X()|0,c=y|c&~m,f=b|f&~_;e:do if(!d)if((y&m|0)==0&(b&_|0)==0)d=0;else if(m=rt(c|0,f|0,52)|0,X()|0,m=m&15,!m)d=1;else{d=1;t:for(;;){switch(b=rt(c|0,f|0,(15-d|0)*3|0)|0,X()|0,b&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<m>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(b=(15-d|0)*3|0,_=rt(c|0,f|0,b|0)|0,X()|0,y=dt(7,0,b|0)|0,f=f&~(X()|0),b=dt(Zu(_&7)|0,0,b|0)|0,c=c&~y|b,f=f|(X()|0),d>>>0<m>>>0)d=d+1|0;else{d=1;break}}while(!1);if(M>>>0<C>>>0)M=M+1|0;else break}return et(f|0),c|0}function Ku(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0;if(m=rt(c|0,f|0,52)|0,X()|0,m=m&15,!m)return d=f,m=c,et(d|0),m|0;for(d=1;y=(15-d|0)*3|0,b=rt(c|0,f|0,y|0)|0,X()|0,_=dt(7,0,y|0)|0,f=f&~(X()|0),y=dt(Zu(b&7)|0,0,y|0)|0,c=y|c&~_,f=X()|0|f,d>>>0<m>>>0;)d=d+1|0;return et(f|0),c|0}function XD(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0,C=0;if(C=rt(c|0,f|0,52)|0,X()|0,C=C&15,!C)return M=f,C=c,et(M|0),C|0;for(M=1,d=0;;){y=(15-M|0)*3|0,m=dt(7,0,y|0)|0,_=X()|0,b=rt(c|0,f|0,y|0)|0,X()|0,y=dt(eu(b&7)|0,0,y|0)|0,b=X()|0,c=y|c&~m,f=b|f&~_;e:do if(!d)if((y&m|0)==0&(b&_|0)==0)d=0;else if(m=rt(c|0,f|0,52)|0,X()|0,m=m&15,!m)d=1;else{d=1;t:for(;;){switch(b=rt(c|0,f|0,(15-d|0)*3|0)|0,X()|0,b&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<m>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(_=(15-d|0)*3|0,y=dt(7,0,_|0)|0,b=f&~(X()|0),f=rt(c|0,f|0,_|0)|0,X()|0,f=dt(eu(f&7)|0,0,_|0)|0,c=c&~y|f,f=b|(X()|0),d>>>0<m>>>0)d=d+1|0;else{d=1;break}}while(!1);if(M>>>0<C>>>0)M=M+1|0;else break}return et(f|0),c|0}function o_(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0;if(m=rt(c|0,f|0,52)|0,X()|0,m=m&15,!m)return d=f,m=c,et(d|0),m|0;for(d=1;b=(15-d|0)*3|0,y=dt(7,0,b|0)|0,_=f&~(X()|0),f=rt(c|0,f|0,b|0)|0,X()|0,f=dt(eu(f&7)|0,0,b|0)|0,c=f|c&~y,f=X()|0|_,d>>>0<m>>>0;)d=d+1|0;return et(f|0),c|0}function QD(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0;if(C=z,z=z+64|0,M=C+40|0,m=C+24|0,_=C+12|0,y=C,dt(f|0,0,52)|0,d=X()|0|134225919,!f)return(h[c+4>>2]|0)>2||(h[c+8>>2]|0)>2||(h[c+12>>2]|0)>2?(b=0,M=0,et(b|0),z=C,M|0):(dt(jb(c)|0,0,45)|0,b=X()|0|d,M=-1,et(b|0),z=C,M|0);if(h[M>>2]=h[c>>2],h[M+4>>2]=h[c+4>>2],h[M+8>>2]=h[c+8>>2],h[M+12>>2]=h[c+12>>2],b=M+4|0,(f|0)>0)for(c=-1;h[m>>2]=h[b>>2],h[m+4>>2]=h[b+4>>2],h[m+8>>2]=h[b+8>>2],f&1?(MD(b),h[_>>2]=h[b>>2],h[_+4>>2]=h[b+4>>2],h[_+8>>2]=h[b+8>>2],Mp(_)):(e5(b),h[_>>2]=h[b>>2],h[_+4>>2]=h[b+4>>2],h[_+8>>2]=h[b+8>>2],Yu(_)),K2(m,_,y),ns(y),k=(15-f|0)*3|0,P=dt(7,0,k|0)|0,d=d&~(X()|0),k=dt(Tp(y)|0,0,k|0)|0,c=k|c&~P,d=X()|0|d,(f|0)>1;)f=f+-1|0;else c=-1;e:do if((h[b>>2]|0)<=2&&(h[M+8>>2]|0)<=2&&(h[M+12>>2]|0)<=2){if(m=jb(M)|0,f=dt(m|0,0,45)|0,f=f|c,c=X()|0|d&-1040385,y=fD(M)|0,!(Ni(m)|0)){if((y|0)<=0)break;for(_=0;;){if(m=rt(f|0,c|0,52)|0,X()|0,m=m&15,m)for(d=1;k=(15-d|0)*3|0,M=rt(f|0,c|0,k|0)|0,X()|0,P=dt(7,0,k|0)|0,c=c&~(X()|0),k=dt(Zu(M&7)|0,0,k|0)|0,f=f&~P|k,c=c|(X()|0),d>>>0<m>>>0;)d=d+1|0;if(_=_+1|0,(_|0)==(y|0))break e}}_=rt(f|0,c|0,52)|0,X()|0,_=_&15;t:do if(_){d=1;n:for(;;){switch(k=rt(f|0,c|0,(15-d|0)*3|0)|0,X()|0,k&7){case 1:break n;case 0:break;default:break t}if(d>>>0<_>>>0)d=d+1|0;else break t}if(Xb(m,h[M>>2]|0)|0)for(d=1;M=(15-d|0)*3|0,P=dt(7,0,M|0)|0,k=c&~(X()|0),c=rt(f|0,c|0,M|0)|0,X()|0,c=dt(eu(c&7)|0,0,M|0)|0,f=f&~P|c,c=k|(X()|0),d>>>0<_>>>0;)d=d+1|0;else for(d=1;k=(15-d|0)*3|0,M=rt(f|0,c|0,k|0)|0,X()|0,P=dt(7,0,k|0)|0,c=c&~(X()|0),k=dt(Zu(M&7)|0,0,k|0)|0,f=f&~P|k,c=c|(X()|0),d>>>0<_>>>0;)d=d+1|0}while(!1);if((y|0)>0){d=0;do f=s_(f,c)|0,c=X()|0,d=d+1|0;while((d|0)!=(y|0))}}else f=0,c=0;while(!1);return P=c,k=f,et(P|0),z=C,k|0}function Mo(c){return c=c|0,(c|0)%2|0|0}function a_(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0;return _=z,z=z+16|0,m=_,f>>>0>15?(m=4,z=_,m|0):(h[c+4>>2]&2146435072|0)==2146435072||(h[c+8+4>>2]&2146435072|0)==2146435072?(m=3,z=_,m|0):(UD(c,f,m),f=QD(m,f)|0,m=X()|0,h[d>>2]=f,h[d+4>>2]=m,(f|0)==0&(m|0)==0&&ft(27795,27122,959,27145),m=0,z=_,m|0)}function l_(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0;if(_=d+4|0,y=rt(c|0,f|0,52)|0,X()|0,y=y&15,b=rt(c|0,f|0,45)|0,X()|0,m=(y|0)==0,Ni(b&127)|0){if(m)return b=1,b|0;m=1}else{if(m)return b=0,b|0;(h[_>>2]|0)==0&&(h[d+8>>2]|0)==0?m=(h[d+12>>2]|0)!=0&1:m=1}for(d=1;d&1?Mp(_):Yu(_),b=rt(c|0,f|0,(15-d|0)*3|0)|0,X()|0,t5(_,b&7),d>>>0<y>>>0;)d=d+1|0;return m|0}function vh(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0;if(k=z,z=z+16|0,C=k,P=rt(c|0,f|0,45)|0,X()|0,P=P&127,P>>>0>121)return h[d>>2]=0,h[d+4>>2]=0,h[d+8>>2]=0,h[d+12>>2]=0,P=5,z=k,P|0;e:do if((Ni(P)|0)!=0&&(y=rt(c|0,f|0,52)|0,X()|0,y=y&15,(y|0)!=0)){m=1;t:for(;;){switch(M=rt(c|0,f|0,(15-m|0)*3|0)|0,X()|0,M&7){case 5:break t;case 0:break;default:{m=f;break e}}if(m>>>0<y>>>0)m=m+1|0;else{m=f;break e}}for(_=1,m=f;f=(15-_|0)*3|0,b=dt(7,0,f|0)|0,M=m&~(X()|0),m=rt(c|0,m|0,f|0)|0,X()|0,m=dt(eu(m&7)|0,0,f|0)|0,c=c&~b|m,m=M|(X()|0),_>>>0<y>>>0;)_=_+1|0}else m=f;while(!1);if(M=7696+(P*28|0)|0,h[d>>2]=h[M>>2],h[d+4>>2]=h[M+4>>2],h[d+8>>2]=h[M+8>>2],h[d+12>>2]=h[M+12>>2],!(l_(c,m,d)|0))return P=0,z=k,P|0;if(b=d+4|0,h[C>>2]=h[b>>2],h[C+4>>2]=h[b+4>>2],h[C+8>>2]=h[b+8>>2],y=rt(c|0,m|0,52)|0,X()|0,M=y&15,y&1?(Yu(b),y=M+1|0):y=M,!(Ni(P)|0))m=0;else{e:do if(!M)m=0;else for(f=1;;){if(_=rt(c|0,m|0,(15-f|0)*3|0)|0,X()|0,_=_&7,_|0){m=_;break e}if(f>>>0<M>>>0)f=f+1|0;else{m=0;break}}while(!1);m=(m|0)==4&1}if(!(_h(d,y,m,0)|0))(y|0)!=(M|0)&&(h[b>>2]=h[C>>2],h[b+4>>2]=h[C+4>>2],h[b+8>>2]=h[C+8>>2]);else{if(Ni(P)|0)do;while((_h(d,y,0,0)|0)!=0);(y|0)!=(M|0)&&e5(b)}return P=0,z=k,P|0}function Ju(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0;return y=z,z=z+16|0,m=y,_=vh(c,f,m)|0,_|0?(z=y,_|0):(_=rt(c|0,f|0,52)|0,X()|0,VD(m,_&15,d),_=0,z=y,_|0)}function yh(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0;if(b=z,z=z+16|0,y=b,m=vh(c,f,y)|0,m|0)return y=m,z=b,y|0;m=rt(c|0,f|0,45)|0,X()|0,m=(Ni(m&127)|0)==0,_=rt(c|0,f|0,52)|0,X()|0,_=_&15;e:do if(!m){if(_|0)for(m=1;;){if(M=dt(7,0,(15-m|0)*3|0)|0,!((M&c|0)==0&((X()|0)&f|0)==0))break e;if(m>>>0<_>>>0)m=m+1|0;else break}return e_(y,_,0,5,d),M=0,z=b,M|0}while(!1);return t_(y,_,0,6,d),M=0,z=b,M|0}function YD(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0;if(_=rt(c|0,f|0,45)|0,X()|0,!(Ni(_&127)|0))return _=2,h[d>>2]=_,0;if(_=rt(c|0,f|0,52)|0,X()|0,_=_&15,!_)return _=5,h[d>>2]=_,0;for(m=1;;){if(y=dt(7,0,(15-m|0)*3|0)|0,!((y&c|0)==0&((X()|0)&f|0)==0)){m=2,c=6;break}if(m>>>0<_>>>0)m=m+1|0;else{m=5,c=6;break}}return(c|0)==6&&(h[d>>2]=m),0}function h5(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0;Y=z,z=z+128|0,P=Y+112|0,y=Y+96|0,k=Y,_=rt(c|0,f|0,52)|0,X()|0,M=_&15,h[P>>2]=M,b=rt(c|0,f|0,45)|0,X()|0,b=b&127;e:do if(Ni(b)|0){if(M|0)for(m=1;;){if(C=dt(7,0,(15-m|0)*3|0)|0,!((C&c|0)==0&((X()|0)&f|0)==0)){_=0;break e}if(m>>>0<M>>>0)m=m+1|0;else break}if(_&1)_=1;else return C=dt(M+1|0,0,52)|0,k=X()|0|f&-15728641,P=dt(7,0,(14-M|0)*3|0)|0,k=h5((C|c)&~P,k&~(X()|0),d)|0,z=Y,k|0}else _=0;while(!1);if(m=vh(c,f,y)|0,!m){_?(o5(y,P,k),C=5):(a5(y,P,k),C=6);e:do if(Ni(b)|0)if(!M)c=5;else for(m=1;;){if(b=dt(7,0,(15-m|0)*3|0)|0,!((b&c|0)==0&((X()|0)&f|0)==0)){c=2;break e}if(m>>>0<M>>>0)m=m+1|0;else{c=5;break}}else c=2;while(!1);ec(d|0,-1,c<<2|0)|0;e:do if(_)for(y=0;;){if(b=k+(y<<4)|0,GD(b,h[P>>2]|0)|0,b=h[b>>2]|0,M=h[d>>2]|0,(M|0)==-1|(M|0)==(b|0))m=d;else{_=0;do{if(_=_+1|0,_>>>0>=c>>>0){m=1;break e}m=d+(_<<2)|0,M=h[m>>2]|0}while(!((M|0)==-1|(M|0)==(b|0)))}if(h[m>>2]=b,y=y+1|0,y>>>0>=C>>>0){m=0;break}}else for(y=0;;){if(b=k+(y<<4)|0,_h(b,h[P>>2]|0,0,1)|0,b=h[b>>2]|0,M=h[d>>2]|0,(M|0)==-1|(M|0)==(b|0))m=d;else{_=0;do{if(_=_+1|0,_>>>0>=c>>>0){m=1;break e}m=d+(_<<2)|0,M=h[m>>2]|0}while(!((M|0)==-1|(M|0)==(b|0)))}if(h[m>>2]=b,y=y+1|0,y>>>0>=C>>>0){m=0;break}}while(!1)}return k=m,z=Y,k|0}function ZD(){return 12}function u_(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0,C=0;if(c>>>0>15)return M=4,M|0;if(dt(c|0,0,52)|0,M=X()|0|134225919,!c){d=0,m=0;do Ni(m)|0&&(dt(m|0,0,45)|0,b=M|(X()|0),c=f+(d<<3)|0,h[c>>2]=-1,h[c+4>>2]=b,d=d+1|0),m=m+1|0;while((m|0)!=122);return d=0,d|0}d=0,b=0;do{if(Ni(b)|0){for(dt(b|0,0,45)|0,m=1,_=-1,y=M|(X()|0);C=dt(7,0,(15-m|0)*3|0)|0,_=_&~C,y=y&~(X()|0),(m|0)!=(c|0);)m=m+1|0;C=f+(d<<3)|0,h[C>>2]=_,h[C+4>>2]=y,d=d+1|0}b=b+1|0}while((b|0)!=122);return d=0,d|0}function KD(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0;if(Ie=z,z=z+16|0,Te=Ie,Oe=rt(c|0,f|0,52)|0,X()|0,Oe=Oe&15,d>>>0>15)return Oe=4,z=Ie,Oe|0;if((Oe|0)<(d|0))return Oe=12,z=Ie,Oe|0;if((Oe|0)!=(d|0))if(y=dt(d|0,0,52)|0,y=y|c,M=X()|0|f&-15728641,(Oe|0)>(d|0)){C=d;do me=dt(7,0,(14-C|0)*3|0)|0,C=C+1|0,y=me|y,M=X()|0|M;while((C|0)<(Oe|0));me=y}else me=y;else me=c,M=f;oe=rt(me|0,M|0,45)|0,X()|0;e:do if(Ni(oe&127)|0){if(C=rt(me|0,M|0,52)|0,X()|0,C=C&15,C|0)for(y=1;;){if(oe=dt(7,0,(15-y|0)*3|0)|0,!((oe&me|0)==0&((X()|0)&M|0)==0)){P=33;break e}if(y>>>0<C>>>0)y=y+1|0;else break}if(oe=m,h[oe>>2]=0,h[oe+4>>2]=0,(Oe|0)>(d|0)){for(oe=f&-15728641,se=Oe;;){if(le=se,se=se+-1|0,se>>>0>15|(Oe|0)<(se|0)){P=19;break}if((Oe|0)!=(se|0))if(y=dt(se|0,0,52)|0,y=y|c,C=X()|0|oe,(Oe|0)<(le|0))Y=y;else{P=se;do Y=dt(7,0,(14-P|0)*3|0)|0,P=P+1|0,y=Y|y,C=X()|0|C;while((P|0)<(Oe|0));Y=y}else Y=c,C=f;if(k=rt(Y|0,C|0,45)|0,X()|0,!(Ni(k&127)|0))y=0;else{k=rt(Y|0,C|0,52)|0,X()|0,k=k&15;t:do if(!k)y=0;else for(P=1;;){if(y=rt(Y|0,C|0,(15-P|0)*3|0)|0,X()|0,y=y&7,y|0)break t;if(P>>>0<k>>>0)P=P+1|0;else{y=0;break}}while(!1);y=(y|0)==0&1}if(C=rt(c|0,f|0,(15-le|0)*3|0)|0,X()|0,C=C&7,(C|0)==7){_=5,P=42;break}if(y=(y|0)!=0,(C|0)==1&y){_=5,P=42;break}if(Y=C+(((C|0)!=0&y)<<31>>31)|0,Y|0&&(P=Oe-le|0,P=tu(7,0,P,((P|0)<0)<<31>>31)|0,k=X()|0,y?(y=is(P|0,k|0,5,0)|0,y=Qt(y|0,X()|0,-5,-1)|0,y=iu(y|0,X()|0,6,0)|0,y=Qt(y|0,X()|0,1,0)|0,C=X()|0):(y=P,C=k),le=Y+-1|0,le=is(P|0,k|0,le|0,((le|0)<0)<<31>>31|0)|0,le=Qt(y|0,C|0,le|0,X()|0)|0,Y=X()|0,k=m,k=Qt(le|0,Y|0,h[k>>2]|0,h[k+4>>2]|0)|0,Y=X()|0,le=m,h[le>>2]=k,h[le+4>>2]=Y),(se|0)<=(d|0)){P=37;break}}if((P|0)==19)ft(27795,27122,1276,27158);else if((P|0)==37){b=m,_=h[b+4>>2]|0,b=h[b>>2]|0;break}else if((P|0)==42)return z=Ie,_|0}else _=0,b=0}else P=33;while(!1);e:do if((P|0)==33)if(oe=m,h[oe>>2]=0,h[oe+4>>2]=0,(Oe|0)>(d|0)){for(y=Oe;;){if(_=rt(c|0,f|0,(15-y|0)*3|0)|0,X()|0,_=_&7,(_|0)==7){_=5;break}if(b=Oe-y|0,b=tu(7,0,b,((b|0)<0)<<31>>31)|0,_=is(b|0,X()|0,_|0,0)|0,b=X()|0,oe=m,b=Qt(h[oe>>2]|0,h[oe+4>>2]|0,_|0,b|0)|0,_=X()|0,oe=m,h[oe>>2]=b,h[oe+4>>2]=_,y=y+-1|0,(y|0)<=(d|0))break e}return z=Ie,_|0}else _=0,b=0;while(!1);return LA(me,M,Oe,Te)|0&&ft(27795,27122,1236,27173),Oe=Te,Te=h[Oe+4>>2]|0,((_|0)>-1|(_|0)==-1&b>>>0>4294967295)&((Te|0)>(_|0)|((Te|0)==(_|0)?(h[Oe>>2]|0)>>>0>b>>>0:0))?(Oe=0,z=Ie,Oe|0):(ft(27795,27122,1316,27158),0)}function JD(c,f,d,m,_,y){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0,y=y|0;var b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0;if(Y=z,z=z+16|0,b=Y,_>>>0>15)return y=4,z=Y,y|0;if(M=rt(d|0,m|0,52)|0,X()|0,M=M&15,(M|0)>(_|0))return y=12,z=Y,y|0;if(LA(d,m,_,b)|0&&ft(27795,27122,1236,27173),k=b,P=h[k+4>>2]|0,!(((f|0)>-1|(f|0)==-1&c>>>0>4294967295)&((P|0)>(f|0)|((P|0)==(f|0)?(h[k>>2]|0)>>>0>c>>>0:0))))return y=2,z=Y,y|0;k=_-M|0,_=dt(_|0,0,52)|0,C=X()|0|m&-15728641,P=y,h[P>>2]=_|d,h[P+4>>2]=C,P=rt(d|0,m|0,45)|0,X()|0;e:do if(Ni(P&127)|0){if(M|0)for(b=1;;){if(P=dt(7,0,(15-b|0)*3|0)|0,!((P&d|0)==0&((X()|0)&m|0)==0))break e;if(b>>>0<M>>>0)b=b+1|0;else break}if((k|0)<1)return y=0,z=Y,y|0;for(P=M^15,m=-1,C=1,b=1;;){M=k-C|0,M=tu(7,0,M,((M|0)<0)<<31>>31)|0,d=X()|0;do if(b)if(b=is(M|0,d|0,5,0)|0,b=Qt(b|0,X()|0,-5,-1)|0,b=iu(b|0,X()|0,6,0)|0,_=X()|0,(f|0)>(_|0)|(f|0)==(_|0)&c>>>0>b>>>0){f=Qt(c|0,f|0,-1,-1)|0,f=Gr(f|0,X()|0,b|0,_|0)|0,b=X()|0,le=y,oe=h[le>>2]|0,le=h[le+4>>2]|0,me=(P+m|0)*3|0,se=dt(7,0,me|0)|0,le=le&~(X()|0),m=iu(f|0,b|0,M|0,d|0)|0,c=X()|0,_=Qt(m|0,c|0,2,0)|0,me=dt(_|0,X()|0,me|0)|0,le=X()|0|le,_=y,h[_>>2]=me|oe&~se,h[_+4>>2]=le,c=is(m|0,c|0,M|0,d|0)|0,c=Gr(f|0,b|0,c|0,X()|0)|0,b=0,f=X()|0;break}else{me=y,se=h[me>>2]|0,me=h[me+4>>2]|0,oe=dt(7,0,(P+m|0)*3|0)|0,me=me&~(X()|0),b=y,h[b>>2]=se&~oe,h[b+4>>2]=me,b=1;break}else se=y,_=h[se>>2]|0,se=h[se+4>>2]|0,m=(P+m|0)*3|0,le=dt(7,0,m|0)|0,se=se&~(X()|0),me=iu(c|0,f|0,M|0,d|0)|0,b=X()|0,m=dt(me|0,b|0,m|0)|0,se=X()|0|se,oe=y,h[oe>>2]=m|_&~le,h[oe+4>>2]=se,b=is(me|0,b|0,M|0,d|0)|0,c=Gr(c|0,f|0,b|0,X()|0)|0,b=0,f=X()|0;while(!1);if((k|0)>(C|0))m=~C,C=C+1|0;else{f=0;break}}return z=Y,f|0}while(!1);if((k|0)<1)return me=0,z=Y,me|0;for(_=M^15,b=1;;)if(oe=k-b|0,oe=tu(7,0,oe,((oe|0)<0)<<31>>31)|0,me=X()|0,C=y,d=h[C>>2]|0,C=h[C+4>>2]|0,M=(_-b|0)*3|0,m=dt(7,0,M|0)|0,C=C&~(X()|0),le=iu(c|0,f|0,oe|0,me|0)|0,se=X()|0,M=dt(le|0,se|0,M|0)|0,C=X()|0|C,P=y,h[P>>2]=M|d&~m,h[P+4>>2]=C,me=is(le|0,se|0,oe|0,me|0)|0,c=Gr(c|0,f|0,me|0,X()|0)|0,f=X()|0,(k|0)<=(b|0)){f=0;break}else b=b+1|0;return z=Y,f|0}function c_(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0;_=rt(f|0,d|0,52)|0,X()|0,_=_&15,(f|0)==0&(d|0)==0|((m|0)>15|(_|0)>(m|0))?(y=-1,f=-1,d=0,_=0):(f=u5(f,d,_+1|0,m)|0,b=(X()|0)&-15728641,d=dt(m|0,0,52)|0,d=f|d,b=b|(X()|0),f=(di(d,b)|0)==0,y=_,f=f?-1:m,_=b),b=c,h[b>>2]=d,h[b+4>>2]=_,h[c+8>>2]=y,h[c+12>>2]=f}function f5(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0;if(_=rt(c|0,f|0,52)|0,X()|0,_=_&15,y=m+8|0,h[y>>2]=_,(c|0)==0&(f|0)==0|((d|0)>15|(_|0)>(d|0))){d=m,h[d>>2]=0,h[d+4>>2]=0,h[y>>2]=-1,h[m+12>>2]=-1;return}if(c=u5(c,f,_+1|0,d)|0,y=(X()|0)&-15728641,_=dt(d|0,0,52)|0,_=c|_,y=y|(X()|0),c=m,h[c>>2]=_,h[c+4>>2]=y,c=m+12|0,di(_,y)|0){h[c>>2]=d;return}else{h[c>>2]=-1;return}}function h_(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0;if(d=c,f=h[d>>2]|0,d=h[d+4>>2]|0,!((f|0)==0&(d|0)==0)&&(m=rt(f|0,d|0,52)|0,X()|0,m=m&15,M=dt(1,0,(m^15)*3|0)|0,f=Qt(M|0,X()|0,f|0,d|0)|0,d=X()|0,M=c,h[M>>2]=f,h[M+4>>2]=d,M=c+8|0,b=h[M>>2]|0,!((m|0)<(b|0)))){for(C=c+12|0,y=m;;){if((y|0)==(b|0)){m=5;break}if(P=(y|0)==(h[C>>2]|0),_=(15-y|0)*3|0,m=rt(f|0,d|0,_|0)|0,X()|0,m=m&7,P&((m|0)==1&!0)){m=7;break}if(!((m|0)==7&!0)){m=10;break}if(P=dt(1,0,_|0)|0,f=Qt(f|0,d|0,P|0,X()|0)|0,d=X()|0,P=c,h[P>>2]=f,h[P+4>>2]=d,(y|0)>(b|0))y=y+-1|0;else{m=10;break}}if((m|0)==5){P=c,h[P>>2]=0,h[P+4>>2]=0,h[M>>2]=-1,h[C>>2]=-1;return}else if((m|0)==7){b=dt(1,0,_|0)|0,b=Qt(f|0,d|0,b|0,X()|0)|0,M=X()|0,P=c,h[P>>2]=b,h[P+4>>2]=M,h[C>>2]=y+-1;return}else if((m|0)==10)return}}function DA(c){c=+c;var f=0;return f=c<0?c+6.283185307179586:c,+(c>=6.283185307179586?f+-6.283185307179586:f)}function xh(c,f){return c=c|0,f=f|0,+_n(+(+$[c>>3]-+$[f>>3]))<17453292519943298e-27?(f=+_n(+(+$[c+8>>3]-+$[f+8>>3]))<17453292519943298e-27,f|0):(f=0,f|0)}function io(c,f){switch(c=+c,f=f|0,f|0){case 1:{c=c<0?c+6.283185307179586:c;break}case 2:{c=c>0?c+-6.283185307179586:c;break}}return+c}function eI(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0;return _=+$[f>>3],m=+$[c>>3],y=+Sn(+((_-m)*.5)),d=+Sn(+((+$[f+8>>3]-+$[c+8>>3])*.5)),d=y*y+d*(+$n(+_)*+$n(+m)*d),+(+Ce(+ +Un(+d),+ +Un(+(1-d)))*2)}function IA(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0;return _=+$[f>>3],m=+$[c>>3],y=+Sn(+((_-m)*.5)),d=+Sn(+((+$[f+8>>3]-+$[c+8>>3])*.5)),d=y*y+d*(+$n(+_)*+$n(+m)*d),+(+Ce(+ +Un(+d),+ +Un(+(1-d)))*2*6371.007180918475)}function tI(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0;return _=+$[f>>3],m=+$[c>>3],y=+Sn(+((_-m)*.5)),d=+Sn(+((+$[f+8>>3]-+$[c+8>>3])*.5)),d=y*y+d*(+$n(+_)*+$n(+m)*d),+(+Ce(+ +Un(+d),+ +Un(+(1-d)))*2*6371.007180918475*1e3)}function nI(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0;return y=+$[f>>3],m=+$n(+y),_=+$[f+8>>3]-+$[c+8>>3],b=m*+Sn(+_),d=+$[c>>3],+ +Ce(+b,+(+Sn(+y)*+$n(+d)-+$n(+_)*(m*+Sn(+d))))}function iI(c,f,d,m){c=c|0,f=+f,d=+d,m=m|0;var _=0,y=0,b=0,M=0;if(d<1e-16){h[m>>2]=h[c>>2],h[m+4>>2]=h[c+4>>2],h[m+8>>2]=h[c+8>>2],h[m+12>>2]=h[c+12>>2];return}y=f<0?f+6.283185307179586:f,y=f>=6.283185307179586?y+-6.283185307179586:y;do if(y<1e-16)f=+$[c>>3]+d,$[m>>3]=f,_=m;else{if(_=+_n(+(y+-3.141592653589793))<1e-16,f=+$[c>>3],_){f=f-d,$[m>>3]=f,_=m;break}if(b=+$n(+d),d=+Sn(+d),f=b*+Sn(+f)+ +$n(+y)*(d*+$n(+f)),f=f>1?1:f,f=+W2(+(f<-1?-1:f)),$[m>>3]=f,+_n(+(f+-1.5707963267948966))<1e-16){$[m>>3]=1.5707963267948966,$[m+8>>3]=0;return}if(+_n(+(f+1.5707963267948966))<1e-16){$[m>>3]=-1.5707963267948966,$[m+8>>3]=0;return}if(M=1/+$n(+f),y=d*+Sn(+y)*M,d=+$[c>>3],f=M*((b-+Sn(+f)*+Sn(+d))/+$n(+d)),b=y>1?1:y,f=f>1?1:f,f=+$[c+8>>3]+ +Ce(+(b<-1?-1:b),+(f<-1?-1:f)),f>3.141592653589793)do f=f+-6.283185307179586;while(f>3.141592653589793);if(f<-3.141592653589793)do f=f+6.283185307179586;while(f<-3.141592653589793);$[m+8>>3]=f;return}while(!1);if(+_n(+(f+-1.5707963267948966))<1e-16){$[_>>3]=1.5707963267948966,$[m+8>>3]=0;return}if(+_n(+(f+1.5707963267948966))<1e-16){$[_>>3]=-1.5707963267948966,$[m+8>>3]=0;return}if(f=+$[c+8>>3],f>3.141592653589793)do f=f+-6.283185307179586;while(f>3.141592653589793);if(f<-3.141592653589793)do f=f+6.283185307179586;while(f<-3.141592653589793);$[m+8>>3]=f}function A5(c,f){return c=c|0,f=f|0,c>>>0>15?(f=4,f|0):($[f>>3]=+$[20656+(c<<3)>>3],f=0,f|0)}function rI(c,f){return c=c|0,f=f|0,c>>>0>15?(f=4,f|0):($[f>>3]=+$[20784+(c<<3)>>3],f=0,f|0)}function sI(c,f){return c=c|0,f=f|0,c>>>0>15?(f=4,f|0):($[f>>3]=+$[20912+(c<<3)>>3],f=0,f|0)}function oI(c,f){return c=c|0,f=f|0,c>>>0>15?(f=4,f|0):($[f>>3]=+$[21040+(c<<3)>>3],f=0,f|0)}function f_(c,f){c=c|0,f=f|0;var d=0;return c>>>0>15?(f=4,f|0):(d=tu(7,0,c,((c|0)<0)<<31>>31)|0,d=is(d|0,X()|0,120,0)|0,c=X()|0,h[f>>2]=d|2,h[f+4>>2]=c,f=0,f|0)}function d5(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0;return le=+$[f>>3],k=+$[c>>3],C=+Sn(+((le-k)*.5)),y=+$[f+8>>3],P=+$[c+8>>3],b=+Sn(+((y-P)*.5)),M=+$n(+k),Y=+$n(+le),b=C*C+b*(Y*M*b),b=+Ce(+ +Un(+b),+ +Un(+(1-b)))*2,C=+$[d>>3],le=+Sn(+((C-le)*.5)),m=+$[d+8>>3],y=+Sn(+((m-y)*.5)),_=+$n(+C),y=le*le+y*(Y*_*y),y=+Ce(+ +Un(+y),+ +Un(+(1-y)))*2,C=+Sn(+((k-C)*.5)),m=+Sn(+((P-m)*.5)),m=C*C+m*(M*_*m),m=+Ce(+ +Un(+m),+ +Un(+(1-m)))*2,_=(b+y+m)*.5,+(+ee(+ +Un(+(+Os(+(_*.5))*+Os(+((_-b)*.5))*+Os(+((_-y)*.5))*+Os(+((_-m)*.5)))))*4)}function A_(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0;if(M=z,z=z+192|0,y=M+168|0,b=M,_=Ju(c,f,y)|0,_|0)return d=_,z=M,d|0;if(yh(c,f,b)|0&&ft(27795,27190,415,27199),f=h[b>>2]|0,(f|0)>0){if(m=+d5(b+8|0,b+8+(((f|0)!=1&1)<<4)|0,y)+0,(f|0)!=1){c=1;do _=c,c=c+1|0,m=m+ +d5(b+8+(_<<4)|0,b+8+(((c|0)%(f|0)|0)<<4)|0,y);while((c|0)<(f|0))}}else m=0;return $[d>>3]=m,d=0,z=M,d|0}function aI(c,f,d){return c=c|0,f=f|0,d=d|0,c=A_(c,f,d)|0,c|0||($[d>>3]=+$[d>>3]*6371.007180918475*6371.007180918475),c|0}function lI(c,f,d){return c=c|0,f=f|0,d=d|0,c=A_(c,f,d)|0,c|0||($[d>>3]=+$[d>>3]*6371.007180918475*6371.007180918475*1e3*1e3),c|0}function uI(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0;if(M=z,z=z+176|0,b=M,c=Cp(c,f,b)|0,c|0)return b=c,z=M,b|0;if($[d>>3]=0,c=h[b>>2]|0,(c|0)<=1)return b=0,z=M,b|0;f=c+-1|0,c=0,m=+$[b+8>>3],_=+$[b+16>>3],y=0;do c=c+1|0,P=m,m=+$[b+8+(c<<4)>>3],k=+Sn(+((m-P)*.5)),C=_,_=+$[b+8+(c<<4)+8>>3],C=+Sn(+((_-C)*.5)),C=k*k+C*(+$n(+m)*+$n(+P)*C),y=y+ +Ce(+ +Un(+C),+ +Un(+(1-C)))*2;while((c|0)<(f|0));return $[d>>3]=y,b=0,z=M,b|0}function cI(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0;if(M=z,z=z+176|0,b=M,c=Cp(c,f,b)|0,c|0)return b=c,y=+$[d>>3],y=y*6371.007180918475,$[d>>3]=y,z=M,b|0;if($[d>>3]=0,c=h[b>>2]|0,(c|0)<=1)return b=0,y=0,y=y*6371.007180918475,$[d>>3]=y,z=M,b|0;f=c+-1|0,c=0,m=+$[b+8>>3],_=+$[b+16>>3],y=0;do c=c+1|0,P=m,m=+$[b+8+(c<<4)>>3],k=+Sn(+((m-P)*.5)),C=_,_=+$[b+8+(c<<4)+8>>3],C=+Sn(+((_-C)*.5)),C=k*k+C*(+$n(+P)*+$n(+m)*C),y=y+ +Ce(+ +Un(+C),+ +Un(+(1-C)))*2;while((c|0)!=(f|0));return $[d>>3]=y,b=0,k=y,k=k*6371.007180918475,$[d>>3]=k,z=M,b|0}function hI(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0;if(M=z,z=z+176|0,b=M,c=Cp(c,f,b)|0,c|0)return b=c,y=+$[d>>3],y=y*6371.007180918475,y=y*1e3,$[d>>3]=y,z=M,b|0;if($[d>>3]=0,c=h[b>>2]|0,(c|0)<=1)return b=0,y=0,y=y*6371.007180918475,y=y*1e3,$[d>>3]=y,z=M,b|0;f=c+-1|0,c=0,m=+$[b+8>>3],_=+$[b+16>>3],y=0;do c=c+1|0,P=m,m=+$[b+8+(c<<4)>>3],k=+Sn(+((m-P)*.5)),C=_,_=+$[b+8+(c<<4)+8>>3],C=+Sn(+((_-C)*.5)),C=k*k+C*(+$n(+P)*+$n(+m)*C),y=y+ +Ce(+ +Un(+C),+ +Un(+(1-C)))*2;while((c|0)!=(f|0));return $[d>>3]=y,b=0,k=y,k=k*6371.007180918475,k=k*1e3,$[d>>3]=k,z=M,b|0}function fI(c){c=c|0;var f=0,d=0,m=0;return f=Co(1,12)|0,f||ft(27280,27235,49,27293),d=c+4|0,m=h[d>>2]|0,m|0?(m=m+8|0,h[m>>2]=f,h[d>>2]=f,f|0):(h[c>>2]|0&&ft(27310,27235,61,27333),m=c,h[m>>2]=f,h[d>>2]=f,f|0)}function AI(c,f){c=c|0,f=f|0;var d=0,m=0;return m=Ta(24)|0,m||ft(27347,27235,78,27361),h[m>>2]=h[f>>2],h[m+4>>2]=h[f+4>>2],h[m+8>>2]=h[f+8>>2],h[m+12>>2]=h[f+12>>2],h[m+16>>2]=0,f=c+4|0,d=h[f>>2]|0,d|0?(h[d+16>>2]=m,h[f>>2]=m,m|0):(h[c>>2]|0&&ft(27376,27235,82,27361),h[c>>2]=m,h[f>>2]=m,m|0)}function p5(c){c=c|0;var f=0,d=0,m=0,_=0;if(c)for(m=1;;){if(f=h[c>>2]|0,f|0)do{if(d=h[f>>2]|0,d|0)do _=d,d=h[d+16>>2]|0,Jt(_);while((d|0)!=0);_=f,f=h[f+8>>2]|0,Jt(_)}while((f|0)!=0);if(f=c,c=h[c+8>>2]|0,m||Jt(f),c)m=0;else break}}function dI(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0,ht=0,kt=0,Dt=0,ln=0,An=0,Nn=0,nn=0,Vt=0,ct=0,Mn=0,ci=0,vn=0;if(_=c+8|0,h[_>>2]|0)return vn=1,vn|0;if(m=h[c>>2]|0,!m)return vn=0,vn|0;f=m,d=0;do d=d+1|0,f=h[f+8>>2]|0;while((f|0)!=0);if(d>>>0<2)return vn=0,vn|0;Mn=Ta(d<<2)|0,Mn||ft(27396,27235,317,27415),ct=Ta(d<<5)|0,ct||ft(27437,27235,321,27415),h[c>>2]=0,kt=c+4|0,h[kt>>2]=0,h[_>>2]=0,d=0,Vt=0,ht=0,Y=0;e:for(;;){if(k=h[m>>2]|0,k){y=0,b=k;do{if(C=+$[b+8>>3],f=b,b=h[b+16>>2]|0,P=(b|0)==0,_=P?k:b,M=+$[_+8>>3],+_n(+(C-M))>3.141592653589793){vn=14;break}y=y+(M-C)*(+$[f>>3]+ +$[_>>3])}while(!P);if((vn|0)==14){vn=0,y=0,f=k;do _e=+$[f+8>>3],nn=f+16|0,Nn=h[nn>>2]|0,Nn=(Nn|0)==0?k:Nn,Pe=+$[Nn+8>>3],y=y+(+$[f>>3]+ +$[Nn>>3])*((Pe<0?Pe+6.283185307179586:Pe)-(_e<0?_e+6.283185307179586:_e)),f=h[((f|0)==0?m:nn)>>2]|0;while((f|0)!=0)}y>0?(h[Mn+(Vt<<2)>>2]=m,Vt=Vt+1|0,_=ht,f=Y):vn=19}else vn=19;if((vn|0)==19){vn=0;do if(d){if(f=d+8|0,h[f>>2]|0){vn=21;break e}if(d=Co(1,12)|0,!d){vn=23;break e}h[f>>2]=d,_=d+4|0,b=d,f=Y}else if(Y){_=kt,b=Y+8|0,f=m,d=c;break}else if(h[c>>2]|0){vn=27;break e}else{_=kt,b=c,f=m,d=c;break}while(!1);if(h[b>>2]=m,h[_>>2]=m,b=ct+(ht<<5)|0,P=h[m>>2]|0,P){for(k=ct+(ht<<5)+8|0,$[k>>3]=17976931348623157e292,Y=ct+(ht<<5)+24|0,$[Y>>3]=17976931348623157e292,$[b>>3]=-17976931348623157e292,le=ct+(ht<<5)+16|0,$[le>>3]=-17976931348623157e292,Oe=17976931348623157e292,Ie=-17976931348623157e292,_=0,se=P,C=17976931348623157e292,me=17976931348623157e292,Te=-17976931348623157e292,M=-17976931348623157e292;y=+$[se>>3],_e=+$[se+8>>3],se=h[se+16>>2]|0,oe=(se|0)==0,Pe=+$[(oe?P:se)+8>>3],y<C&&($[k>>3]=y,C=y),_e<me&&($[Y>>3]=_e,me=_e),y>Te?$[b>>3]=y:y=Te,_e>M&&($[le>>3]=_e,M=_e),Oe=_e>0&_e<Oe?_e:Oe,Ie=_e<0&_e>Ie?_e:Ie,_=_|+_n(+(_e-Pe))>3.141592653589793,!oe;)Te=y;_&&($[le>>3]=Ie,$[Y>>3]=Oe)}else h[b>>2]=0,h[b+4>>2]=0,h[b+8>>2]=0,h[b+12>>2]=0,h[b+16>>2]=0,h[b+20>>2]=0,h[b+24>>2]=0,h[b+28>>2]=0;_=ht+1|0}if(nn=m+8|0,m=h[nn>>2]|0,h[nn>>2]=0,m)ht=_,Y=f;else{vn=45;break}}if((vn|0)==21)ft(27213,27235,35,27247);else if((vn|0)==23)ft(27267,27235,37,27247);else if((vn|0)==27)ft(27310,27235,61,27333);else if((vn|0)==45){e:do if((Vt|0)>0){for(nn=(_|0)==0,An=_<<2,Nn=(c|0)==0,ln=0,f=0;;){if(Dt=h[Mn+(ln<<2)>>2]|0,nn)vn=73;else{if(ht=Ta(An)|0,!ht){vn=50;break}if(kt=Ta(An)|0,!kt){vn=52;break}t:do if(Nn)d=0;else{for(_=0,d=0,b=c;m=ct+(_<<5)|0,m5(h[b>>2]|0,m,h[Dt>>2]|0)|0?(h[ht+(d<<2)>>2]=b,h[kt+(d<<2)>>2]=m,oe=d+1|0):oe=d,b=h[b+8>>2]|0,b;)_=_+1|0,d=oe;if((oe|0)>0)if(m=h[ht>>2]|0,(oe|0)==1)d=m;else for(le=0,se=-1,d=m,Y=m;;){for(P=h[Y>>2]|0,m=0,b=0;_=h[h[ht+(b<<2)>>2]>>2]|0,(_|0)==(P|0)?k=m:k=m+((m5(_,h[kt+(b<<2)>>2]|0,h[P>>2]|0)|0)&1)|0,b=b+1|0,(b|0)!=(oe|0);)m=k;if(_=(k|0)>(se|0),d=_?Y:d,m=le+1|0,(m|0)==(oe|0))break t;le=m,se=_?k:se,Y=h[ht+(m<<2)>>2]|0}else d=0}while(!1);if(Jt(ht),Jt(kt),d){if(_=d+4|0,m=h[_>>2]|0,m)d=m+8|0;else if(h[d>>2]|0){vn=70;break}h[d>>2]=Dt,h[_>>2]=Dt}else vn=73}if((vn|0)==73){if(vn=0,f=h[Dt>>2]|0,f|0)do kt=f,f=h[f+16>>2]|0,Jt(kt);while((f|0)!=0);Jt(Dt),f=1}if(ln=ln+1|0,(ln|0)>=(Vt|0)){ci=f;break e}}(vn|0)==50?ft(27452,27235,249,27471):(vn|0)==52?ft(27490,27235,252,27471):(vn|0)==70&&ft(27310,27235,61,27333)}else ci=0;while(!1);return Jt(Mn),Jt(ct),vn=ci,vn|0}return 0}function m5(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0;if(!(Y2(f,d)|0)||(f=Qb(f)|0,m=+$[d>>3],_=+$[d+8>>3],_=f&_<0?_+6.283185307179586:_,c=h[c>>2]|0,!c))return c=0,c|0;if(f){f=0,P=_,d=c;e:for(;;){for(;b=+$[d>>3],_=+$[d+8>>3],d=d+16|0,k=h[d>>2]|0,k=(k|0)==0?c:k,y=+$[k>>3],M=+$[k+8>>3],b>y?(C=b,b=M):(C=y,y=b,b=_,_=M),m=m==y|m==C?m+2220446049250313e-31:m,!!(m<y|m>C);)if(d=h[d>>2]|0,!d){d=22;break e}if(M=b<0?b+6.283185307179586:b,b=_<0?_+6.283185307179586:_,P=M==P|b==P?P+-2220446049250313e-31:P,C=M+(b-M)*((m-y)/(C-y)),(C<0?C+6.283185307179586:C)>P&&(f=f^1),d=h[d>>2]|0,!d){d=22;break}}if((d|0)==22)return f|0}else{f=0,P=_,d=c;e:for(;;){for(;b=+$[d>>3],_=+$[d+8>>3],d=d+16|0,k=h[d>>2]|0,k=(k|0)==0?c:k,y=+$[k>>3],M=+$[k+8>>3],b>y?(C=b,b=M):(C=y,y=b,b=_,_=M),m=m==y|m==C?m+2220446049250313e-31:m,!!(m<y|m>C);)if(d=h[d>>2]|0,!d){d=22;break e}if(P=b==P|_==P?P+-2220446049250313e-31:P,b+(_-b)*((m-y)/(C-y))>P&&(f=f^1),d=h[d>>2]|0,!d){d=22;break}}if((d|0)==22)return f|0}return 0}function hl(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0;if(Ie=z,z=z+32|0,Oe=Ie+16|0,Te=Ie,y=rt(c|0,f|0,52)|0,X()|0,y=y&15,se=rt(d|0,m|0,52)|0,X()|0,(y|0)!=(se&15|0))return Oe=12,z=Ie,Oe|0;if(P=rt(c|0,f|0,45)|0,X()|0,P=P&127,k=rt(d|0,m|0,45)|0,X()|0,k=k&127,P>>>0>121|k>>>0>121)return Oe=5,z=Ie,Oe|0;if(se=(P|0)!=(k|0),se){if(M=Q2(P,k)|0,(M|0)==7)return Oe=1,z=Ie,Oe|0;C=Q2(k,P)|0,(C|0)==7?ft(27514,27538,161,27548):(oe=M,b=C)}else oe=0,b=0;Y=Ni(P)|0,le=Ni(k)|0,h[Oe>>2]=0,h[Oe+4>>2]=0,h[Oe+8>>2]=0,h[Oe+12>>2]=0;do if(oe){if(k=h[4272+(P*28|0)+(oe<<2)>>2]|0,M=(k|0)>0,le)if(M){P=0,C=d,M=m;do C=XD(C,M)|0,M=X()|0,b=eu(b)|0,(b|0)==1&&(b=eu(1)|0),P=P+1|0;while((P|0)!=(k|0));k=b,P=C,C=M}else k=b,P=d,C=m;else if(M){P=0,C=d,M=m;do C=o_(C,M)|0,M=X()|0,b=eu(b)|0,P=P+1|0;while((P|0)!=(k|0));k=b,P=C,C=M}else k=b,P=d,C=m;if(l_(P,C,Oe)|0,se||ft(27563,27538,191,27548),M=(Y|0)!=0,b=(le|0)!=0,M&b&&ft(27590,27538,192,27548),M){if(b=ks(c,f)|0,(b|0)==7){y=5;break}if(nt[22e3+(b*7|0)+oe>>0]|0){y=1;break}C=h[21168+(b*28|0)+(oe<<2)>>2]|0,P=C}else if(b){if(b=ks(P,C)|0,(b|0)==7){y=5;break}if(nt[22e3+(b*7|0)+k>>0]|0){y=1;break}P=0,C=h[21168+(k*28|0)+(b<<2)>>2]|0}else P=0,C=0;if((P|C|0)<0)y=5;else{if((C|0)>0){M=Oe+4|0,b=0;do Ep(M),b=b+1|0;while((b|0)!=(C|0))}if(h[Te>>2]=0,h[Te+4>>2]=0,h[Te+8>>2]=0,t5(Te,oe),y|0)for(;Mo(y)|0?Mp(Te):Yu(Te),(y|0)>1;)y=y+-1|0;if((P|0)>0){y=0;do Ep(Te),y=y+1|0;while((y|0)!=(P|0))}me=Oe+4|0,_s(me,Te,me),ns(me),me=51}}else if(l_(d,m,Oe)|0,(Y|0)!=0&(le|0)!=0)if((k|0)!=(P|0)&&ft(27621,27538,261,27548),b=ks(c,f)|0,y=ks(d,m)|0,(b|0)==7|(y|0)==7)y=5;else if(nt[22e3+(b*7|0)+y>>0]|0)y=1;else if(b=h[21168+(b*28|0)+(y<<2)>>2]|0,(b|0)>0){M=Oe+4|0,y=0;do Ep(M),y=y+1|0;while((y|0)!=(b|0));me=51}else me=51;else me=51;while(!1);return(me|0)==51&&(y=Oe+4|0,h[_>>2]=h[y>>2],h[_+4>>2]=h[y+4>>2],h[_+8>>2]=h[y+8>>2],y=0),Oe=y,z=Ie,Oe|0}function g5(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0;if(me=z,z=z+48|0,P=me+36|0,b=me+24|0,M=me+12|0,C=me,_=rt(c|0,f|0,52)|0,X()|0,_=_&15,le=rt(c|0,f|0,45)|0,X()|0,le=le&127,le>>>0>121)return m=5,z=me,m|0;if(k=Ni(le)|0,dt(_|0,0,52)|0,Te=X()|0|134225919,y=m,h[y>>2]=-1,h[y+4>>2]=Te,!_)return _=Tp(d)|0,(_|0)==7||(_=X2(le,_)|0,(_|0)==127)?(Te=1,z=me,Te|0):(se=dt(_|0,0,45)|0,oe=X()|0,le=m,oe=h[le+4>>2]&-1040385|oe,Te=m,h[Te>>2]=h[le>>2]|se,h[Te+4>>2]=oe,Te=0,z=me,Te|0);for(h[P>>2]=h[d>>2],h[P+4>>2]=h[d+4>>2],h[P+8>>2]=h[d+8>>2],d=_;;){if(y=d,d=d+-1|0,h[b>>2]=h[P>>2],h[b+4>>2]=h[P+4>>2],h[b+8>>2]=h[P+8>>2],Mo(y)|0){if(_=SD(P)|0,_|0){d=13;break}h[M>>2]=h[P>>2],h[M+4>>2]=h[P+4>>2],h[M+8>>2]=h[P+8>>2],Mp(M)}else{if(_=TD(P)|0,_|0){d=13;break}h[M>>2]=h[P>>2],h[M+4>>2]=h[P+4>>2],h[M+8>>2]=h[P+8>>2],Yu(M)}if(K2(b,M,C),ns(C),_=m,Ie=h[_>>2]|0,_=h[_+4>>2]|0,Pe=(15-y|0)*3|0,Oe=dt(7,0,Pe|0)|0,_=_&~(X()|0),Pe=dt(Tp(C)|0,0,Pe|0)|0,_=X()|0|_,Te=m,h[Te>>2]=Pe|Ie&~Oe,h[Te+4>>2]=_,(y|0)<=1){d=14;break}}e:do if((d|0)!=13&&(d|0)==14)if((h[P>>2]|0)<=1&&(h[P+4>>2]|0)<=1&&(h[P+8>>2]|0)<=1){d=Tp(P)|0,_=X2(le,d)|0,(_|0)==127?C=0:C=Ni(_)|0;t:do if(d){if(k){if(_=ks(c,f)|0,(_|0)==7){_=5;break e}if(y=h[21376+(_*28|0)+(d<<2)>>2]|0,(y|0)>0){_=d,d=0;do _=Zu(_)|0,d=d+1|0;while((d|0)!=(y|0))}else _=d;if((_|0)==1){_=9;break e}d=X2(le,_)|0,(d|0)==127&&ft(27648,27538,411,27678),Ni(d)|0?ft(27693,27538,412,27678):(oe=d,se=y,Y=_)}else oe=_,se=0,Y=d;if(M=h[4272+(le*28|0)+(Y<<2)>>2]|0,(M|0)<=-1&&ft(27724,27538,419,27678),!C){if((se|0)<0){_=5;break e}if(se|0){y=m,_=0,d=h[y>>2]|0,y=h[y+4>>2]|0;do d=Ku(d,y)|0,y=X()|0,Pe=m,h[Pe>>2]=d,h[Pe+4>>2]=y,_=_+1|0;while((_|0)<(se|0))}if((M|0)<=0){_=oe,d=58;break}for(y=m,_=0,d=h[y>>2]|0,y=h[y+4>>2]|0;;)if(d=Ku(d,y)|0,y=X()|0,Pe=m,h[Pe>>2]=d,h[Pe+4>>2]=y,_=_+1|0,(_|0)==(M|0)){_=oe,d=58;break t}}if(b=Q2(oe,le)|0,(b|0)==7&&ft(27514,27538,428,27678),_=m,d=h[_>>2]|0,_=h[_+4>>2]|0,(M|0)>0){y=0;do d=Ku(d,_)|0,_=X()|0,Pe=m,h[Pe>>2]=d,h[Pe+4>>2]=_,y=y+1|0;while((y|0)!=(M|0))}if(_=ks(d,_)|0,(_|0)==7&&ft(27795,27538,440,27678),d=j2(oe)|0,d=h[(d?21792:21584)+(b*28|0)+(_<<2)>>2]|0,(d|0)<0&&ft(27795,27538,454,27678),!d)_=oe,d=58;else{b=m,_=0,y=h[b>>2]|0,b=h[b+4>>2]|0;do y=s_(y,b)|0,b=X()|0,Pe=m,h[Pe>>2]=y,h[Pe+4>>2]=b,_=_+1|0;while((_|0)<(d|0));_=oe,d=58}}else if((k|0)!=0&(C|0)!=0){if(d=ks(c,f)|0,y=m,y=ks(h[y>>2]|0,h[y+4>>2]|0)|0,(d|0)==7|(y|0)==7){_=5;break e}if(y=h[21376+(d*28|0)+(y<<2)>>2]|0,(y|0)<0){_=5;break e}if(!y)d=59;else{M=m,d=0,b=h[M>>2]|0,M=h[M+4>>2]|0;do b=Ku(b,M)|0,M=X()|0,Pe=m,h[Pe>>2]=b,h[Pe+4>>2]=M,d=d+1|0;while((d|0)<(y|0));d=58}}else d=58;while(!1);if((d|0)==58&&C&&(d=59),(d|0)==59&&(Pe=m,(ks(h[Pe>>2]|0,h[Pe+4>>2]|0)|0)==1)){_=9;break}Pe=m,Oe=h[Pe>>2]|0,Pe=h[Pe+4>>2]&-1040385,Ie=dt(_|0,0,45)|0,Pe=Pe|(X()|0),_=m,h[_>>2]=Oe|Ie,h[_+4>>2]=Pe,_=0}else _=1;while(!1);return Pe=_,z=me,Pe|0}function pI(c,f,d,m,_,y){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0,y=y|0;var b=0,M=0;return M=z,z=z+16|0,b=M,_?c=15:(c=hl(c,f,d,m,b)|0,c||(ED(b,y),c=0)),z=M,c|0}function mI(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0;return b=z,z=z+16|0,y=b,m?d=15:(d=CD(d,y)|0,d||(d=g5(c,f,y,_)|0)),z=b,d|0}function gI(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0;return C=z,z=z+32|0,b=C+12|0,M=C,y=hl(c,f,c,f,b)|0,y|0?(M=y,z=C,M|0):(c=hl(c,f,d,m,M)|0,c|0?(M=c,z=C,M|0):(b=J2(b,M)|0,M=_,h[M>>2]=b,h[M+4>>2]=((b|0)<0)<<31>>31,M=0,z=C,M|0))}function _I(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0;return C=z,z=z+32|0,b=C+12|0,M=C,y=hl(c,f,c,f,b)|0,!y&&(y=hl(c,f,d,m,M)|0,!y)?(m=J2(b,M)|0,m=Qt(m|0,((m|0)<0)<<31>>31|0,1,0)|0,b=X()|0,M=_,h[M>>2]=m,h[M+4>>2]=b,M=0,z=C,M|0):(M=y,z=C,M|0)}function vI(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0,ht=0,kt=0,Dt=0,ln=0;if(Dt=z,z=z+48|0,ht=Dt+24|0,b=Dt+12|0,kt=Dt,y=hl(c,f,c,f,ht)|0,!y&&(y=hl(c,f,d,m,b)|0,!y)){Pe=J2(ht,b)|0,_e=((Pe|0)<0)<<31>>31,h[ht>>2]=0,h[ht+4>>2]=0,h[ht+8>>2]=0,h[b>>2]=0,h[b+4>>2]=0,h[b+8>>2]=0,hl(c,f,c,f,ht)|0&&ft(27795,27538,692,27747),hl(c,f,d,m,b)|0&&ft(27795,27538,697,27747),s5(ht),s5(b),k=(Pe|0)==0?0:1/+(Pe|0),d=h[ht>>2]|0,me=k*+((h[b>>2]|0)-d|0),Te=ht+4|0,m=h[Te>>2]|0,Oe=k*+((h[b+4>>2]|0)-m|0),Ie=ht+8|0,y=h[Ie>>2]|0,k=k*+((h[b+8>>2]|0)-y|0),h[kt>>2]=d,Y=kt+4|0,h[Y>>2]=m,le=kt+8|0,h[le>>2]=y;e:do if((Pe|0)<0)y=0;else for(se=0,oe=0;;){C=+(oe>>>0)+4294967296*+(se|0),ln=me*C+ +(d|0),M=Oe*C+ +(m|0),C=k*C+ +(y|0),d=~~+Lp(+ln),b=~~+Lp(+M),y=~~+Lp(+C),ln=+_n(+(+(d|0)-ln)),M=+_n(+(+(b|0)-M)),C=+_n(+(+(y|0)-C));do if(ln>M&ln>C)d=0-(b+y)|0,m=b;else if(P=0-d|0,M>C){m=P-y|0;break}else{m=b,y=P-b|0;break}while(!1);if(h[kt>>2]=d,h[Y>>2]=m,h[le>>2]=y,RD(kt),y=g5(c,f,kt,_+(oe<<3)|0)|0,y|0)break e;if(!((se|0)<(_e|0)|(se|0)==(_e|0)&oe>>>0<Pe>>>0)){y=0;break e}d=Qt(oe|0,se|0,1,0)|0,m=X()|0,se=m,oe=d,d=h[ht>>2]|0,m=h[Te>>2]|0,y=h[Ie>>2]|0}while(!1);return kt=y,z=Dt,kt|0}return kt=y,z=Dt,kt|0}function tu(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0;if((d|0)==0&(m|0)==0)return _=0,y=1,et(_|0),y|0;y=c,_=f,c=1,f=0;do b=(d&1|0)==0&!0,c=is((b?1:y)|0,(b?0:_)|0,c|0,f|0)|0,f=X()|0,d=R5(d|0,m|0,1)|0,m=X()|0,y=is(y|0,_|0,y|0,_|0)|0,_=X()|0;while(!((d|0)==0&(m|0)==0));return et(f|0),c|0}function d_(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0;M=z,z=z+16|0,y=M,b=rt(c|0,f|0,52)|0,X()|0,b=b&15;do if(b){if(_=Ju(c,f,y)|0,!_){P=+$[y>>3],C=1/+$n(+P),k=+$[25968+(b<<3)>>3],$[d>>3]=P+k,$[d+8>>3]=P-k,P=+$[y+8>>3],C=k*C,$[d+16>>3]=C+P,$[d+24>>3]=P-C;break}return b=_,z=M,b|0}else{if(_=rt(c|0,f|0,45)|0,X()|0,_=_&127,_>>>0>121)return b=5,z=M,b|0;y=22064+(_<<5)|0,h[d>>2]=h[y>>2],h[d+4>>2]=h[y+4>>2],h[d+8>>2]=h[y+8>>2],h[d+12>>2]=h[y+12>>2],h[d+16>>2]=h[y+16>>2],h[d+20>>2]=h[y+20>>2],h[d+24>>2]=h[y+24>>2],h[d+28>>2]=h[y+28>>2];break}while(!1);return xD(d,m?1.4:1.1),m=26096+(b<<3)|0,(h[m>>2]|0)==(c|0)&&(h[m+4>>2]|0)==(f|0)&&($[d>>3]=1.5707963267948966),b=26224+(b<<3)|0,(h[b>>2]|0)==(c|0)&&(h[b+4>>2]|0)==(f|0)&&($[d+8>>3]=-1.5707963267948966),+$[d>>3]!=1.5707963267948966&&+$[d+8>>3]!=-1.5707963267948966?(b=0,z=M,b|0):($[d+16>>3]=3.141592653589793,$[d+24>>3]=-3.141592653589793,b=0,z=M,b|0)}function yI(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0;P=z,z=z+48|0,b=P+32|0,y=P+40|0,M=P,i_(b,0,0,0),C=h[b>>2]|0,b=h[b+4>>2]|0;do if(d>>>0<=15){if(_=FA(m)|0,_|0){m=M,h[m>>2]=0,h[m+4>>2]=0,h[M+8>>2]=_,h[M+12>>2]=-1,m=M+16|0,C=M+29|0,h[m>>2]=0,h[m+4>>2]=0,h[m+8>>2]=0,nt[m+12>>0]=0,nt[C>>0]=nt[y>>0]|0,nt[C+1>>0]=nt[y+1>>0]|0,nt[C+2>>0]=nt[y+2>>0]|0;break}if(_=Co((h[f+8>>2]|0)+1|0,32)|0,_){p_(f,_),k=M,h[k>>2]=C,h[k+4>>2]=b,h[M+8>>2]=0,h[M+12>>2]=d,h[M+16>>2]=m,h[M+20>>2]=f,h[M+24>>2]=_,nt[M+28>>0]=0,C=M+29|0,nt[C>>0]=nt[y>>0]|0,nt[C+1>>0]=nt[y+1>>0]|0,nt[C+2>>0]=nt[y+2>>0]|0;break}else{m=M,h[m>>2]=0,h[m+4>>2]=0,h[M+8>>2]=13,h[M+12>>2]=-1,m=M+16|0,C=M+29|0,h[m>>2]=0,h[m+4>>2]=0,h[m+8>>2]=0,nt[m+12>>0]=0,nt[C>>0]=nt[y>>0]|0,nt[C+1>>0]=nt[y+1>>0]|0,nt[C+2>>0]=nt[y+2>>0]|0;break}}else C=M,h[C>>2]=0,h[C+4>>2]=0,h[M+8>>2]=4,h[M+12>>2]=-1,C=M+16|0,k=M+29|0,h[C>>2]=0,h[C+4>>2]=0,h[C+8>>2]=0,nt[C+12>>0]=0,nt[k>>0]=nt[y>>0]|0,nt[k+1>>0]=nt[y+1>>0]|0,nt[k+2>>0]=nt[y+2>>0]|0;while(!1);Rp(M),h[c>>2]=h[M>>2],h[c+4>>2]=h[M+4>>2],h[c+8>>2]=h[M+8>>2],h[c+12>>2]=h[M+12>>2],h[c+16>>2]=h[M+16>>2],h[c+20>>2]=h[M+20>>2],h[c+24>>2]=h[M+24>>2],h[c+28>>2]=h[M+28>>2],z=P}function Rp(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0;if(_e=z,z=z+336|0,se=_e+168|0,oe=_e,m=c,d=h[m>>2]|0,m=h[m+4>>2]|0,(d|0)==0&(m|0)==0){z=_e;return}if(f=c+28|0,nt[f>>0]|0?(d=_5(d,m)|0,m=X()|0):nt[f>>0]=1,Pe=c+20|0,!(h[h[Pe>>2]>>2]|0)){f=c+24|0,d=h[f>>2]|0,d|0&&Jt(d),Ie=c,h[Ie>>2]=0,h[Ie+4>>2]=0,h[c+8>>2]=0,h[Pe>>2]=0,h[c+12>>2]=-1,h[c+16>>2]=0,h[f>>2]=0,z=_e;return}Ie=c+16|0,f=h[Ie>>2]|0,_=f&15;e:do if((d|0)==0&(m|0)==0)Oe=c+24|0;else{me=c+12|0,Y=(_|0)==3,k=f&255,C=(_|1|0)==3,le=c+24|0,P=(_+-1|0)>>>0<3,b=(_|2|0)==3,M=oe+8|0;t:for(;;){if(y=rt(d|0,m|0,52)|0,X()|0,y=y&15,(y|0)==(h[me>>2]|0)){switch(k&15){case 0:case 2:case 3:{if(_=Ju(d,m,se)|0,_|0){Te=15;break t}if(m_(h[Pe>>2]|0,h[le>>2]|0,se)|0){Te=19;break t}break}}if(C&&(_=h[(h[Pe>>2]|0)+4>>2]|0,h[se>>2]=h[_>>2],h[se+4>>2]=h[_+4>>2],h[se+8>>2]=h[_+8>>2],h[se+12>>2]=h[_+12>>2],Y2(26832,se)|0)){if(a_(h[(h[Pe>>2]|0)+4>>2]|0,y,oe)|0){Te=25;break}if(_=oe,(h[_>>2]|0)==(d|0)&&(h[_+4>>2]|0)==(m|0)){Te=29;break}}if(P){if(_=yh(d,m,se)|0,_|0){Te=32;break}if(d_(d,m,oe,0)|0){Te=36;break}if(b&&y5(h[Pe>>2]|0,h[le>>2]|0,se,oe)|0){Te=42;break}if(C&&x5(h[Pe>>2]|0,h[le>>2]|0,se,oe)|0){Te=42;break}}if(Y){if(f=d_(d,m,se,1)|0,_=h[le>>2]|0,f|0){Te=45;break}if(Z2(_,se)|0){if(Zb(oe,se),Yb(se,h[le>>2]|0)|0){Te=53;break}if(m_(h[Pe>>2]|0,h[le>>2]|0,M)|0){Te=53;break}if(x5(h[Pe>>2]|0,h[le>>2]|0,oe,se)|0){Te=53;break}}}}do if((y|0)<(h[me>>2]|0)){if(f=d_(d,m,se,1)|0,_=h[le>>2]|0,f|0){Te=58;break t}if(!(Z2(_,se)|0)){Te=73;break}if(Yb(h[le>>2]|0,se)|0&&(Zb(oe,se),y5(h[Pe>>2]|0,h[le>>2]|0,oe,se)|0)){Te=65;break t}if(d=c5(d,m,y+1|0,oe)|0,d|0){Te=67;break t}m=oe,d=h[m>>2]|0,m=h[m+4>>2]|0}else Te=73;while(!1);if((Te|0)==73&&(Te=0,d=_5(d,m)|0,m=X()|0),(d|0)==0&(m|0)==0){Oe=le;break e}}switch(Te|0){case 15:{f=h[le>>2]|0,f|0&&Jt(f),Te=c,h[Te>>2]=0,h[Te+4>>2]=0,h[Pe>>2]=0,h[me>>2]=-1,h[Ie>>2]=0,h[le>>2]=0,h[c+8>>2]=_,Te=20;break}case 19:{h[c>>2]=d,h[c+4>>2]=m,Te=20;break}case 25:{ft(27795,27761,470,27772);break}case 29:{h[c>>2]=d,h[c+4>>2]=m,z=_e;return}case 32:{f=h[le>>2]|0,f|0&&Jt(f),Oe=c,h[Oe>>2]=0,h[Oe+4>>2]=0,h[Pe>>2]=0,h[me>>2]=-1,h[Ie>>2]=0,h[le>>2]=0,h[c+8>>2]=_,z=_e;return}case 36:{ft(27795,27761,493,27772);break}case 42:{h[c>>2]=d,h[c+4>>2]=m,z=_e;return}case 45:{_|0&&Jt(_),Te=c,h[Te>>2]=0,h[Te+4>>2]=0,h[Pe>>2]=0,h[me>>2]=-1,h[Ie>>2]=0,h[le>>2]=0,h[c+8>>2]=f,Te=55;break}case 53:{h[c>>2]=d,h[c+4>>2]=m,Te=55;break}case 58:{_|0&&Jt(_),Te=c,h[Te>>2]=0,h[Te+4>>2]=0,h[Pe>>2]=0,h[me>>2]=-1,h[Ie>>2]=0,h[le>>2]=0,h[c+8>>2]=f,Te=71;break}case 65:{h[c>>2]=d,h[c+4>>2]=m,Te=71;break}case 67:{f=h[le>>2]|0,f|0&&Jt(f),Oe=c,h[Oe>>2]=0,h[Oe+4>>2]=0,h[Pe>>2]=0,h[me>>2]=-1,h[Ie>>2]=0,h[le>>2]=0,h[c+8>>2]=d,z=_e;return}}if((Te|0)==20){z=_e;return}else if((Te|0)==55){z=_e;return}else if((Te|0)==71){z=_e;return}}while(!1);f=h[Oe>>2]|0,f|0&&Jt(f),Te=c,h[Te>>2]=0,h[Te+4>>2]=0,h[c+8>>2]=0,h[Pe>>2]=0,h[c+12>>2]=-1,h[Ie>>2]=0,h[Oe>>2]=0,z=_e}function _5(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0;Y=z,z=z+16|0,k=Y,m=rt(c|0,f|0,52)|0,X()|0,m=m&15,d=rt(c|0,f|0,45)|0,X()|0;do if(m){for(;d=dt(m+4095|0,0,52)|0,_=X()|0|f&-15728641,y=(15-m|0)*3|0,b=dt(7,0,y|0)|0,M=X()|0,d=d|c|b,_=_|M,C=rt(c|0,f|0,y|0)|0,X()|0,C=C&7,m=m+-1|0,!(C>>>0<6);)if(m)f=_,c=d;else{P=4;break}if((P|0)==4){d=rt(d|0,_|0,45)|0,X()|0;break}return k=(C|0)==0&(di(d,_)|0)!=0,k=dt((k?2:1)+C|0,0,y|0)|0,P=X()|0|f&~M,k=k|c&~b,et(P|0),z=Y,k|0}while(!1);return d=d&127,d>>>0>120?(P=0,k=0,et(P|0),z=Y,k|0):(i_(k,0,d+1|0,0),P=h[k+4>>2]|0,k=h[k>>2]|0,et(P|0),z=Y,k|0)}function xI(c,f,d,m,_,y){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0,y=y|0;var b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0;Te=z,z=z+160|0,Y=Te+80|0,M=Te+64|0,le=Te+112|0,me=Te,yI(Y,c,f,d),P=Y,c_(M,h[P>>2]|0,h[P+4>>2]|0,f),P=M,C=h[P>>2]|0,P=h[P+4>>2]|0,b=h[Y+8>>2]|0,se=le+4|0,h[se>>2]=h[Y>>2],h[se+4>>2]=h[Y+4>>2],h[se+8>>2]=h[Y+8>>2],h[se+12>>2]=h[Y+12>>2],h[se+16>>2]=h[Y+16>>2],h[se+20>>2]=h[Y+20>>2],h[se+24>>2]=h[Y+24>>2],h[se+28>>2]=h[Y+28>>2],se=me,h[se>>2]=C,h[se+4>>2]=P,se=me+8|0,h[se>>2]=b,c=me+12|0,f=le,d=c+36|0;do h[c>>2]=h[f>>2],c=c+4|0,f=f+4|0;while((c|0)<(d|0));if(le=me+48|0,h[le>>2]=h[M>>2],h[le+4>>2]=h[M+4>>2],h[le+8>>2]=h[M+8>>2],h[le+12>>2]=h[M+12>>2],(C|0)==0&(P|0)==0)return me=b,z=Te,me|0;d=me+16|0,k=me+24|0,Y=me+28|0,b=0,M=0,f=C,c=P;do{if(!((b|0)<(_|0)|(b|0)==(_|0)&M>>>0<m>>>0)){oe=4;break}if(P=M,M=Qt(M|0,b|0,1,0)|0,b=X()|0,P=y+(P<<3)|0,h[P>>2]=f,h[P+4>>2]=c,h_(le),c=le,f=h[c>>2]|0,c=h[c+4>>2]|0,(f|0)==0&(c|0)==0){if(Rp(d),f=d,c=h[f>>2]|0,f=h[f+4>>2]|0,(c|0)==0&(f|0)==0){oe=10;break}f5(c,f,h[Y>>2]|0,le),c=le,f=h[c>>2]|0,c=h[c+4>>2]|0}P=me,h[P>>2]=f,h[P+4>>2]=c}while(!((f|0)==0&(c|0)==0));return(oe|0)==4?(c=me+40|0,f=h[c>>2]|0,f|0&&Jt(f),oe=me+16|0,h[oe>>2]=0,h[oe+4>>2]=0,h[k>>2]=0,h[me+36>>2]=0,h[Y>>2]=-1,h[me+32>>2]=0,h[c>>2]=0,f5(0,0,0,le),h[me>>2]=0,h[me+4>>2]=0,h[se>>2]=0,me=14,z=Te,me|0):((oe|0)==10&&(h[me>>2]=0,h[me+4>>2]=0,h[se>>2]=h[k>>2]),me=h[se>>2]|0,z=Te,me|0)}function bI(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0;if(Y=z,z=z+48|0,C=Y+32|0,M=Y+40|0,P=Y,!(h[c>>2]|0))return k=m,h[k>>2]=0,h[k+4>>2]=0,k=0,z=Y,k|0;i_(C,0,0,0),b=C,_=h[b>>2]|0,b=h[b+4>>2]|0;do if(f>>>0>15)k=P,h[k>>2]=0,h[k+4>>2]=0,h[P+8>>2]=4,h[P+12>>2]=-1,k=P+16|0,d=P+29|0,h[k>>2]=0,h[k+4>>2]=0,h[k+8>>2]=0,nt[k+12>>0]=0,nt[d>>0]=nt[M>>0]|0,nt[d+1>>0]=nt[M+1>>0]|0,nt[d+2>>0]=nt[M+2>>0]|0,d=4,k=9;else{if(d=FA(d)|0,d|0){C=P,h[C>>2]=0,h[C+4>>2]=0,h[P+8>>2]=d,h[P+12>>2]=-1,C=P+16|0,k=P+29|0,h[C>>2]=0,h[C+4>>2]=0,h[C+8>>2]=0,nt[C+12>>0]=0,nt[k>>0]=nt[M>>0]|0,nt[k+1>>0]=nt[M+1>>0]|0,nt[k+2>>0]=nt[M+2>>0]|0,k=9;break}if(d=Co((h[c+8>>2]|0)+1|0,32)|0,!d){k=P,h[k>>2]=0,h[k+4>>2]=0,h[P+8>>2]=13,h[P+12>>2]=-1,k=P+16|0,d=P+29|0,h[k>>2]=0,h[k+4>>2]=0,h[k+8>>2]=0,nt[k+12>>0]=0,nt[d>>0]=nt[M>>0]|0,nt[d+1>>0]=nt[M+1>>0]|0,nt[d+2>>0]=nt[M+2>>0]|0,d=13,k=9;break}p_(c,d),se=P,h[se>>2]=_,h[se+4>>2]=b,b=P+8|0,h[b>>2]=0,h[P+12>>2]=f,h[P+20>>2]=c,h[P+24>>2]=d,nt[P+28>>0]=0,_=P+29|0,nt[_>>0]=nt[M>>0]|0,nt[_+1>>0]=nt[M+1>>0]|0,nt[_+2>>0]=nt[M+2>>0]|0,h[P+16>>2]=3,le=+_D(d),le=le*+gD(d),y=+_n(+ +$[d>>3]),y=le/+$n(+ +Pp(+y,+ +_n(+ +$[d+8>>3])))*6371.007180918475*6371.007180918475,_=P+12|0,d=h[_>>2]|0;e:do if((d|0)>0)do{if(A5(d+-1|0,C)|0,!(y/+$[C>>3]>10))break e;se=h[_>>2]|0,d=se+-1|0,h[_>>2]=d}while((se|0)>1);while(!1);if(Rp(P),_=m,h[_>>2]=0,h[_+4>>2]=0,_=P,d=h[_>>2]|0,_=h[_+4>>2]|0,!((d|0)==0&(_|0)==0))do LA(d,_,f,C)|0,M=C,c=m,M=Qt(h[c>>2]|0,h[c+4>>2]|0,h[M>>2]|0,h[M+4>>2]|0)|0,c=X()|0,se=m,h[se>>2]=M,h[se+4>>2]=c,Rp(P),se=P,d=h[se>>2]|0,_=h[se+4>>2]|0;while(!((d|0)==0&(_|0)==0));d=h[b>>2]|0}while(!1);return se=d,z=Y,se|0}function BA(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0;if(!(Y2(f,d)|0)||(f=Qb(f)|0,m=+$[d>>3],_=+$[d+8>>3],_=f&_<0?_+6.283185307179586:_,le=h[c>>2]|0,(le|0)<=0))return le=0,le|0;if(Y=h[c+4>>2]|0,f){f=0,k=_,d=-1,c=0;e:for(;;){for(P=c;b=+$[Y+(P<<4)>>3],_=+$[Y+(P<<4)+8>>3],c=(d+2|0)%(le|0)|0,y=+$[Y+(c<<4)>>3],M=+$[Y+(c<<4)+8>>3],b>y?(C=b,b=M):(C=y,y=b,b=_,_=M),m=m==y|m==C?m+2220446049250313e-31:m,!!(m<y|m>C);)if(d=P+1|0,(d|0)>=(le|0)){d=22;break e}else c=P,P=d,d=c;if(M=b<0?b+6.283185307179586:b,b=_<0?_+6.283185307179586:_,k=M==k|b==k?k+-2220446049250313e-31:k,C=M+(b-M)*((m-y)/(C-y)),(C<0?C+6.283185307179586:C)>k&&(f=f^1),c=P+1|0,(c|0)>=(le|0)){d=22;break}else d=P}if((d|0)==22)return f|0}else{f=0,k=_,d=-1,c=0;e:for(;;){for(P=c;b=+$[Y+(P<<4)>>3],_=+$[Y+(P<<4)+8>>3],c=(d+2|0)%(le|0)|0,y=+$[Y+(c<<4)>>3],M=+$[Y+(c<<4)+8>>3],b>y?(C=b,b=M):(C=y,y=b,b=_,_=M),m=m==y|m==C?m+2220446049250313e-31:m,!!(m<y|m>C);)if(d=P+1|0,(d|0)>=(le|0)){d=22;break e}else c=P,P=d,d=c;if(k=b==k|_==k?k+-2220446049250313e-31:k,b+(_-b)*((m-y)/(C-y))>k&&(f=f^1),c=P+1|0,(c|0)>=(le|0)){d=22;break}else d=P}if((d|0)==22)return f|0}return 0}function v5(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0;if(oe=h[c>>2]|0,!oe){h[f>>2]=0,h[f+4>>2]=0,h[f+8>>2]=0,h[f+12>>2]=0,h[f+16>>2]=0,h[f+20>>2]=0,h[f+24>>2]=0,h[f+28>>2]=0;return}if(me=f+8|0,$[me>>3]=17976931348623157e292,Te=f+24|0,$[Te>>3]=17976931348623157e292,$[f>>3]=-17976931348623157e292,Oe=f+16|0,$[Oe>>3]=-17976931348623157e292,!((oe|0)<=0)){for(le=h[c+4>>2]|0,P=17976931348623157e292,k=-17976931348623157e292,Y=0,c=-1,y=17976931348623157e292,b=17976931348623157e292,C=-17976931348623157e292,m=-17976931348623157e292,se=0;d=+$[le+(se<<4)>>3],M=+$[le+(se<<4)+8>>3],c=c+2|0,_=+$[le+(((c|0)==(oe|0)?0:c)<<4)+8>>3],d<y&&($[me>>3]=d,y=d),M<b&&($[Te>>3]=M,b=M),d>C?$[f>>3]=d:d=C,M>m&&($[Oe>>3]=M,m=M),P=M>0&M<P?M:P,k=M<0&M>k?M:k,Y=Y|+_n(+(M-_))>3.141592653589793,c=se+1|0,(c|0)!=(oe|0);)Ie=se,C=d,se=c,c=Ie;Y&&($[Oe>>3]=k,$[Te>>3]=P)}}function FA(c){return c=c|0,(c>>>0<4?0:15)|0}function p_(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0,ht=0,kt=0,Dt=0;if(oe=h[c>>2]|0,oe){if(me=f+8|0,$[me>>3]=17976931348623157e292,Te=f+24|0,$[Te>>3]=17976931348623157e292,$[f>>3]=-17976931348623157e292,Oe=f+16|0,$[Oe>>3]=-17976931348623157e292,(oe|0)>0){for(_=h[c+4>>2]|0,le=17976931348623157e292,se=-17976931348623157e292,m=0,d=-1,C=17976931348623157e292,P=17976931348623157e292,Y=-17976931348623157e292,b=-17976931348623157e292,Ie=0;y=+$[_+(Ie<<4)>>3],k=+$[_+(Ie<<4)+8>>3],kt=d+2|0,M=+$[_+(((kt|0)==(oe|0)?0:kt)<<4)+8>>3],y<C&&($[me>>3]=y,C=y),k<P&&($[Te>>3]=k,P=k),y>Y?$[f>>3]=y:y=Y,k>b&&($[Oe>>3]=k,b=k),le=k>0&k<le?k:le,se=k<0&k>se?k:se,m=m|+_n(+(k-M))>3.141592653589793,d=Ie+1|0,(d|0)!=(oe|0);)kt=Ie,Y=y,Ie=d,d=kt;m&&($[Oe>>3]=se,$[Te>>3]=le)}}else h[f>>2]=0,h[f+4>>2]=0,h[f+8>>2]=0,h[f+12>>2]=0,h[f+16>>2]=0,h[f+20>>2]=0,h[f+24>>2]=0,h[f+28>>2]=0;if(kt=c+8|0,d=h[kt>>2]|0,!((d|0)<=0)){ht=c+12|0,_e=0;do if(_=h[ht>>2]|0,m=_e,_e=_e+1|0,Te=f+(_e<<5)|0,Oe=h[_+(m<<3)>>2]|0,Oe){if(Ie=f+(_e<<5)+8|0,$[Ie>>3]=17976931348623157e292,c=f+(_e<<5)+24|0,$[c>>3]=17976931348623157e292,$[Te>>3]=-17976931348623157e292,Pe=f+(_e<<5)+16|0,$[Pe>>3]=-17976931348623157e292,(Oe|0)>0){for(oe=h[_+(m<<3)+4>>2]|0,le=17976931348623157e292,se=-17976931348623157e292,_=0,m=-1,me=0,C=17976931348623157e292,P=17976931348623157e292,k=-17976931348623157e292,b=-17976931348623157e292;y=+$[oe+(me<<4)>>3],Y=+$[oe+(me<<4)+8>>3],m=m+2|0,M=+$[oe+(((m|0)==(Oe|0)?0:m)<<4)+8>>3],y<C&&($[Ie>>3]=y,C=y),Y<P&&($[c>>3]=Y,P=Y),y>k?$[Te>>3]=y:y=k,Y>b&&($[Pe>>3]=Y,b=Y),le=Y>0&Y<le?Y:le,se=Y<0&Y>se?Y:se,_=_|+_n(+(Y-M))>3.141592653589793,m=me+1|0,(m|0)!=(Oe|0);)Dt=me,me=m,k=y,m=Dt;_&&($[Pe>>3]=se,$[c>>3]=le)}}else h[Te>>2]=0,h[Te+4>>2]=0,h[Te+8>>2]=0,h[Te+12>>2]=0,h[Te+16>>2]=0,h[Te+20>>2]=0,h[Te+24>>2]=0,h[Te+28>>2]=0,d=h[kt>>2]|0;while((_e|0)<(d|0))}}function m_(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0;if(!(BA(c,f,d)|0))return _=0,_|0;if(_=c+8|0,(h[_>>2]|0)<=0)return _=1,_|0;for(m=c+12|0,c=0;;){if(y=c,c=c+1|0,BA((h[m>>2]|0)+(y<<3)|0,f+(c<<5)|0,d)|0){c=0,m=6;break}if((c|0)>=(h[_>>2]|0)){c=1,m=6;break}}return(m|0)==6?c|0:0}function y5(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0;if(P=z,z=z+16|0,M=P,b=d+8|0,!(BA(c,f,b)|0))return C=0,z=P,C|0;C=c+8|0;e:do if((h[C>>2]|0)>0){for(y=c+12|0,_=0;;){if(k=_,_=_+1|0,BA((h[y>>2]|0)+(k<<3)|0,f+(_<<5)|0,b)|0){_=0;break}if((_|0)>=(h[C>>2]|0))break e}return z=P,_|0}while(!1);if(Np(c,f,d,m)|0)return k=0,z=P,k|0;h[M>>2]=h[d>>2],h[M+4>>2]=b,_=h[C>>2]|0;e:do if((_|0)>0)for(c=c+12|0,b=0,y=_;;){if(_=h[c>>2]|0,(h[_+(b<<3)>>2]|0)>0){if(BA(M,m,h[_+(b<<3)+4>>2]|0)|0){_=0;break e}if(_=b+1|0,Np((h[c>>2]|0)+(b<<3)|0,f+(_<<5)|0,d,m)|0){_=0;break e}y=h[C>>2]|0}else _=b+1|0;if((_|0)<(y|0))b=_;else{_=1;break}}else _=1;while(!1);return k=_,z=P,k|0}function Np(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0,ht=0,kt=0,Dt=0,ln=0;if(kt=z,z=z+176|0,Ie=kt+172|0,_=kt+168|0,Pe=kt,!(Z2(f,m)|0))return c=0,z=kt,c|0;if(vD(f,m,Ie,_),Sh(Pe|0,d|0,168)|0,(h[d>>2]|0)>0){f=0;do Dt=Pe+8+(f<<4)+8|0,Oe=+io(+$[Dt>>3],h[_>>2]|0),$[Dt>>3]=Oe,f=f+1|0;while((f|0)<(h[d>>2]|0))}me=+$[m>>3],Te=+$[m+8>>3],Oe=+io(+$[m+16>>3],h[_>>2]|0),se=+io(+$[m+24>>3],h[_>>2]|0);e:do if((h[c>>2]|0)>0){if(m=c+4|0,_=h[Pe>>2]|0,(_|0)<=0){for(f=0;;)if(f=f+1|0,(f|0)>=(h[c>>2]|0)){f=0;break e}}for(d=0;;){if(f=h[m>>2]|0,le=+$[f+(d<<4)>>3],oe=+io(+$[f+(d<<4)+8>>3],h[Ie>>2]|0),f=h[m>>2]|0,d=d+1|0,Dt=(d|0)%(h[c>>2]|0)|0,y=+$[f+(Dt<<4)>>3],b=+io(+$[f+(Dt<<4)+8>>3],h[Ie>>2]|0),!(le>=me)|!(y>=me)&&!(le<=Te)|!(y<=Te)&&!(oe<=se)|!(b<=se)&&!(oe>=Oe)|!(b>=Oe)){Y=y-le,P=b-oe,f=0;do if(ln=f,f=f+1|0,Dt=(f|0)==(_|0)?0:f,y=+$[Pe+8+(ln<<4)+8>>3],b=+$[Pe+8+(Dt<<4)+8>>3]-y,M=+$[Pe+8+(ln<<4)>>3],C=+$[Pe+8+(Dt<<4)>>3]-M,k=Y*b-P*C,k!=0&&(_e=oe-y,ht=le-M,C=(_e*C-b*ht)/k,!(C<0|C>1))&&(k=(Y*_e-P*ht)/k,k>=0&k<=1)){f=1;break e}while((f|0)<(_|0))}if((d|0)>=(h[c>>2]|0)){f=0;break}}}else f=0;while(!1);return ln=f,z=kt,ln|0}function x5(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0;if(Np(c,f,d,m)|0)return y=1,y|0;if(y=c+8|0,(h[y>>2]|0)<=0)return y=0,y|0;for(_=c+12|0,c=0;;){if(b=c,c=c+1|0,Np((h[_>>2]|0)+(b<<3)|0,f+(c<<5)|0,d,m)|0){c=1,_=6;break}if((c|0)>=(h[y>>2]|0)){c=0,_=6;break}}return(_|0)==6?c|0:0}function wI(){return 8}function SI(){return 16}function TI(){return 168}function MI(){return 8}function EI(){return 16}function CI(){return 12}function RI(){return 8}function NI(c){return c=c|0,+(+((h[c>>2]|0)>>>0)+4294967296*+(h[c+4>>2]|0))}function PI(c){c=c|0;var f=0,d=0;return d=+$[c>>3],f=+$[c+8>>3],+ +Un(+(d*d+f*f))}function b5(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0;P=+$[c>>3],C=+$[f>>3]-P,M=+$[c+8>>3],b=+$[f+8>>3]-M,Y=+$[d>>3],y=+$[m>>3]-Y,le=+$[d+8>>3],k=+$[m+8>>3]-le,y=(y*(M-le)-(P-Y)*k)/(C*k-b*y),$[_>>3]=P+C*y,$[_+8>>3]=M+b*y}function w5(c,f){return c=c|0,f=f|0,+_n(+(+$[c>>3]-+$[f>>3]))<11920928955078125e-23?(f=+_n(+(+$[c+8>>3]-+$[f+8>>3]))<11920928955078125e-23,f|0):(f=0,f|0)}function dr(c,f){c=c|0,f=f|0;var d=0,m=0,_=0;return _=+$[c>>3]-+$[f>>3],m=+$[c+8>>3]-+$[f+8>>3],d=+$[c+16>>3]-+$[f+16>>3],+(_*_+m*m+d*d)}function LI(c,f){c=c|0,f=f|0;var d=0,m=0,_=0;d=+$[c>>3],m=+$n(+d),d=+Sn(+d),$[f+16>>3]=d,d=+$[c+8>>3],_=m*+$n(+d),$[f>>3]=_,d=m*+Sn(+d),$[f+8>>3]=d}function DI(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0;if(y=z,z=z+16|0,_=y,m=di(c,f)|0,(d+-1|0)>>>0>5||(m=(m|0)!=0,(d|0)==1&m))return _=-1,z=y,_|0;do if(UA(c,f,_)|0)m=-1;else if(m){m=((h[26352+(d<<2)>>2]|0)+5-(h[_>>2]|0)|0)%5|0;break}else{m=((h[26384+(d<<2)>>2]|0)+6-(h[_>>2]|0)|0)%6|0;break}while(!1);return _=m,z=y,_|0}function UA(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0,P=0;if(P=z,z=z+32|0,b=P+16|0,M=P,m=vh(c,f,b)|0,m|0)return d=m,z=P,d|0;y=l5(c,f)|0,C=ks(c,f)|0,AD(y,M),m=dD(y,h[b>>2]|0)|0;e:do if(Ni(y)|0){do switch(y|0){case 4:{c=0;break}case 14:{c=1;break}case 24:{c=2;break}case 38:{c=3;break}case 49:{c=4;break}case 58:{c=5;break}case 63:{c=6;break}case 72:{c=7;break}case 83:{c=8;break}case 97:{c=9;break}case 107:{c=10;break}case 117:{c=11;break}default:{m=1;break e}}while(!1);if(_=h[26416+(c*24|0)+8>>2]|0,f=h[26416+(c*24|0)+16>>2]|0,c=h[b>>2]|0,(c|0)!=(h[M>>2]|0)&&(M=j2(y)|0,c=h[b>>2]|0,M|(c|0)==(f|0)&&(m=(m+1|0)%6|0)),(C|0)==3&(c|0)==(f|0)){m=(m+5|0)%6|0,_=22;break}(C|0)==5&(c|0)==(_|0)&&(m=(m+1|0)%6|0),_=22}else _=22;while(!1);return(_|0)==22&&(h[d>>2]=m,m=0),d=m,z=P,d|0}function Eo(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0;if(Pe=z,z=z+32|0,Ie=Pe+24|0,Te=Pe+20|0,oe=Pe+8|0,se=Pe+16|0,le=Pe,C=(di(c,f)|0)==0,C=C?6:5,k=rt(c|0,f|0,52)|0,X()|0,k=k&15,C>>>0<=d>>>0)return m=2,z=Pe,m|0;Y=(k|0)==0,!Y&&(me=dt(7,0,(k^15)*3|0)|0,(me&c|0)==0&((X()|0)&f|0)==0)?_=d:y=4;e:do if((y|0)==4){if(_=(di(c,f)|0)!=0,((_?4:5)|0)<(d|0)||UA(c,f,Ie)|0||(y=(h[Ie>>2]|0)+d|0,_?_=26704+(((y|0)%5|0)<<2)|0:_=26736+(((y|0)%6|0)<<2)|0,me=h[_>>2]|0,(me|0)==7))return m=1,z=Pe,m|0;h[Te>>2]=0,_=ti(c,f,me,Te,oe)|0;do if(!_){if(M=oe,P=h[M>>2]|0,M=h[M+4>>2]|0,b=M>>>0<f>>>0|(M|0)==(f|0)&P>>>0<c>>>0,y=b?P:c,b=b?M:f,!Y&&(Y=dt(7,0,(k^15)*3|0)|0,(P&Y|0)==0&(M&(X()|0)|0)==0))_=d;else{if(M=(d+-1+C|0)%(C|0)|0,_=di(c,f)|0,(M|0)<0&&ft(27795,27797,246,27806),C=(_|0)!=0,((C?4:5)|0)<(M|0)&&ft(27795,27797,246,27806),UA(c,f,Ie)|0&&ft(27795,27797,246,27806),_=(h[Ie>>2]|0)+M|0,C?_=26704+(((_|0)%5|0)<<2)|0:_=26736+(((_|0)%6|0)<<2)|0,M=h[_>>2]|0,(M|0)==7&&ft(27795,27797,246,27806),h[se>>2]=0,_=ti(c,f,M,se,le)|0,_|0)break;P=le,C=h[P>>2]|0,P=h[P+4>>2]|0;do if(P>>>0<b>>>0|(P|0)==(b|0)&C>>>0<y>>>0){if(di(C,P)|0?y=wr(C,P,c,f)|0:y=h[26800+((((h[se>>2]|0)+(h[26768+(M<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=di(C,P)|0,(y+-1|0)>>>0>5){_=-1,y=C,b=P;break}if(_=(_|0)!=0,(y|0)==1&_){_=-1,y=C,b=P;break}do if(UA(C,P,Ie)|0)_=-1;else if(_){_=((h[26352+(y<<2)>>2]|0)+5-(h[Ie>>2]|0)|0)%5|0;break}else{_=((h[26384+(y<<2)>>2]|0)+6-(h[Ie>>2]|0)|0)%6|0;break}while(!1);y=C,b=P}else _=d;while(!1);M=oe,P=h[M>>2]|0,M=h[M+4>>2]|0}if((y|0)==(P|0)&(b|0)==(M|0)){if(C=(di(P,M)|0)!=0,C?c=wr(P,M,c,f)|0:c=h[26800+((((h[Te>>2]|0)+(h[26768+(me<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=di(P,M)|0,(c+-1|0)>>>0<=5&&(Oe=(_|0)!=0,!((c|0)==1&Oe)))do if(UA(P,M,Ie)|0)_=-1;else if(Oe){_=((h[26352+(c<<2)>>2]|0)+5-(h[Ie>>2]|0)|0)%5|0;break}else{_=((h[26384+(c<<2)>>2]|0)+6-(h[Ie>>2]|0)|0)%6|0;break}while(!1);else _=-1;_=_+1|0,_=(_|0)==6|C&(_|0)==5?0:_}f=b,c=y;break e}while(!1);return m=_,z=Pe,m|0}while(!1);return Oe=dt(_|0,0,56)|0,Ie=X()|0|f&-2130706433|536870912,h[m>>2]=Oe|c,h[m+4>>2]=Ie,m=0,z=Pe,m|0}function II(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0;return y=(di(c,f)|0)==0,m=Eo(c,f,0,d)|0,_=(m|0)==0,y?!_||(m=Eo(c,f,1,d+8|0)|0,m|0)||(m=Eo(c,f,2,d+16|0)|0,m|0)||(m=Eo(c,f,3,d+24|0)|0,m|0)||(m=Eo(c,f,4,d+32|0)|0,m)?(y=m,y|0):Eo(c,f,5,d+40|0)|0:!_||(m=Eo(c,f,1,d+8|0)|0,m|0)||(m=Eo(c,f,2,d+16|0)|0,m|0)||(m=Eo(c,f,3,d+24|0)|0,m|0)||(m=Eo(c,f,4,d+32|0)|0,m|0)?(y=m,y|0):(y=d+40|0,h[y>>2]=0,h[y+4>>2]=0,y=0,y|0)}function BI(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0,M=0,C=0;return C=z,z=z+192|0,_=C,y=C+168|0,b=rt(c|0,f|0,56)|0,X()|0,b=b&7,M=f&-2130706433|134217728,m=vh(c,M,y)|0,m|0?(M=m,z=C,M|0):(f=rt(c|0,f|0,52)|0,X()|0,f=f&15,di(c,M)|0?e_(y,f,b,1,_):t_(y,f,b,1,_),M=_+8|0,h[d>>2]=h[M>>2],h[d+4>>2]=h[M+4>>2],h[d+8>>2]=h[M+8>>2],h[d+12>>2]=h[M+12>>2],M=0,z=C,M|0)}function FI(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0;return _=z,z=z+16|0,d=_,!(!0&(f&2013265920|0)==536870912)||(m=f&-2130706433|134217728,!(n_(c,m)|0))?(m=0,z=_,m|0):(y=rt(c|0,f|0,56)|0,X()|0,y=(Eo(c,m,y&7,d)|0)==0,m=d,m=y&((h[m>>2]|0)==(c|0)?(h[m+4>>2]|0)==(f|0):0)&1,z=_,m|0)}function S5(c,f,d){c=c|0,f=f|0,d=d|0;var m=0;(f|0)>0?(m=Co(f,4)|0,h[c>>2]=m,m||ft(27819,27842,40,27856)):h[c>>2]=0,h[c+4>>2]=f,h[c+8>>2]=0,h[c+12>>2]=d}function T5(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0;_=c+4|0,y=c+12|0,b=c+8|0;e:for(;;){for(d=h[_>>2]|0,f=0;;){if((f|0)>=(d|0))break e;if(m=h[c>>2]|0,M=h[m+(f<<2)>>2]|0,!M)f=f+1|0;else break}f=m+(~~(+_n(+(+wa(10,+ +(15-(h[y>>2]|0)|0))*(+$[M>>3]+ +$[M+8>>3])))%+(d|0))>>>0<<2)|0,d=h[f>>2]|0;t:do if(d|0){if(m=M+32|0,(d|0)==(M|0))h[f>>2]=h[m>>2];else{if(d=d+32|0,f=h[d>>2]|0,!f)break;for(;(f|0)!=(M|0);)if(d=f+32|0,f=h[d>>2]|0,!f)break t;h[d>>2]=h[m>>2]}Jt(M),h[b>>2]=(h[b>>2]|0)+-1}while(!1)}Jt(h[c>>2]|0)}function M5(c){c=c|0;var f=0,d=0,m=0;for(m=h[c+4>>2]|0,d=0;;){if((d|0)>=(m|0)){f=0,d=4;break}if(f=h[(h[c>>2]|0)+(d<<2)>>2]|0,!f)d=d+1|0;else{d=4;break}}return(d|0)==4?f|0:0}function E5(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0;if(d=~~(+_n(+(+wa(10,+ +(15-(h[c+12>>2]|0)|0))*(+$[f>>3]+ +$[f+8>>3])))%+(h[c+4>>2]|0))>>>0,d=(h[c>>2]|0)+(d<<2)|0,m=h[d>>2]|0,!m)return y=1,y|0;y=f+32|0;do if((m|0)!=(f|0)){if(d=h[m+32>>2]|0,!d)return y=1,y|0;for(_=d;;){if((_|0)==(f|0)){_=8;break}if(d=h[_+32>>2]|0,d)m=_,_=d;else{d=1,_=10;break}}if((_|0)==8){h[m+32>>2]=h[y>>2];break}else if((_|0)==10)return d|0}else h[d>>2]=h[y>>2];while(!1);return Jt(f),y=c+8|0,h[y>>2]=(h[y>>2]|0)+-1,y=0,y|0}function UI(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0;y=Ta(40)|0,y||ft(27872,27842,98,27885),h[y>>2]=h[f>>2],h[y+4>>2]=h[f+4>>2],h[y+8>>2]=h[f+8>>2],h[y+12>>2]=h[f+12>>2],_=y+16|0,h[_>>2]=h[d>>2],h[_+4>>2]=h[d+4>>2],h[_+8>>2]=h[d+8>>2],h[_+12>>2]=h[d+12>>2],h[y+32>>2]=0,_=~~(+_n(+(+wa(10,+ +(15-(h[c+12>>2]|0)|0))*(+$[f>>3]+ +$[f+8>>3])))%+(h[c+4>>2]|0))>>>0,_=(h[c>>2]|0)+(_<<2)|0,m=h[_>>2]|0;do if(!m)h[_>>2]=y;else{for(;!(xh(m,f)|0&&xh(m+16|0,d)|0);)if(_=h[m+32>>2]|0,m=(_|0)==0?m:_,!(h[m+32>>2]|0)){b=10;break}if((b|0)==10){h[m+32>>2]=y;break}return Jt(y),b=m,b|0}while(!1);return b=c+8|0,h[b>>2]=(h[b>>2]|0)+1,b=y,b|0}function OI(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0;if(_=~~(+_n(+(+wa(10,+ +(15-(h[c+12>>2]|0)|0))*(+$[f>>3]+ +$[f+8>>3])))%+(h[c+4>>2]|0))>>>0,_=h[(h[c>>2]|0)+(_<<2)>>2]|0,!_)return d=0,d|0;if(!d){for(c=_;;){if(xh(c,f)|0){m=10;break}if(c=h[c+32>>2]|0,!c){c=0,m=10;break}}if((m|0)==10)return c|0}for(c=_;;){if(xh(c,f)|0&&xh(c+16|0,d)|0){m=10;break}if(c=h[c+32>>2]|0,!c){c=0,m=10;break}}return(m|0)==10?c|0:0}function kI(c,f){c=c|0,f=f|0;var d=0;if(d=~~(+_n(+(+wa(10,+ +(15-(h[c+12>>2]|0)|0))*(+$[f>>3]+ +$[f+8>>3])))%+(h[c+4>>2]|0))>>>0,c=h[(h[c>>2]|0)+(d<<2)>>2]|0,!c)return d=0,d|0;for(;;){if(xh(c,f)|0){f=5;break}if(c=h[c+32>>2]|0,!c){c=0,f=5;break}}return(f|0)==5?c|0:0}function VI(){return 27904}function nu(c){return c=+c,~~+L5(+c)|0}function Ta(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0,me=0,Te=0,Oe=0,Ie=0,Pe=0,_e=0,ht=0;ht=z,z=z+16|0,le=ht;do if(c>>>0<245){if(P=c>>>0<11?16:c+11&-8,c=P>>>3,Y=h[6977]|0,d=Y>>>c,d&3|0)return f=(d&1^1)+c|0,c=27948+(f<<1<<2)|0,d=c+8|0,m=h[d>>2]|0,_=m+8|0,y=h[_>>2]|0,(y|0)==(c|0)?h[6977]=Y&~(1<<f):(h[y+12>>2]=c,h[d>>2]=y),_e=f<<3,h[m+4>>2]=_e|3,_e=m+_e+4|0,h[_e>>2]=h[_e>>2]|1,_e=_,z=ht,_e|0;if(k=h[6979]|0,P>>>0>k>>>0){if(d|0)return f=2<<c,f=d<<c&(f|0-f),f=(f&0-f)+-1|0,M=f>>>12&16,f=f>>>M,d=f>>>5&8,f=f>>>d,y=f>>>2&4,f=f>>>y,c=f>>>1&2,f=f>>>c,m=f>>>1&1,m=(d|M|y|c|m)+(f>>>m)|0,f=27948+(m<<1<<2)|0,c=f+8|0,y=h[c>>2]|0,M=y+8|0,d=h[M>>2]|0,(d|0)==(f|0)?(c=Y&~(1<<m),h[6977]=c):(h[d+12>>2]=f,h[c>>2]=d,c=Y),_e=m<<3,b=_e-P|0,h[y+4>>2]=P|3,_=y+P|0,h[_+4>>2]=b|1,h[y+_e>>2]=b,k|0&&(m=h[6982]|0,f=k>>>3,d=27948+(f<<1<<2)|0,f=1<<f,c&f?(c=d+8|0,f=h[c>>2]|0):(h[6977]=c|f,f=d,c=d+8|0),h[c>>2]=m,h[f+12>>2]=m,h[m+8>>2]=f,h[m+12>>2]=d),h[6979]=b,h[6982]=_,_e=M,z=ht,_e|0;if(y=h[6978]|0,y){for(d=(y&0-y)+-1|0,_=d>>>12&16,d=d>>>_,m=d>>>5&8,d=d>>>m,b=d>>>2&4,d=d>>>b,M=d>>>1&2,d=d>>>M,C=d>>>1&1,C=h[28212+((m|_|b|M|C)+(d>>>C)<<2)>>2]|0,d=C,M=C,C=(h[C+4>>2]&-8)-P|0;c=h[d+16>>2]|0,!(!c&&(c=h[d+20>>2]|0,!c));)b=(h[c+4>>2]&-8)-P|0,_=b>>>0<C>>>0,d=c,M=_?c:M,C=_?b:C;if(b=M+P|0,b>>>0>M>>>0){_=h[M+24>>2]|0,f=h[M+12>>2]|0;do if((f|0)==(M|0)){if(c=M+20|0,f=h[c>>2]|0,!f&&(c=M+16|0,f=h[c>>2]|0,!f)){d=0;break}for(;;)if(m=f+20|0,d=h[m>>2]|0,d)f=d,c=m;else if(m=f+16|0,d=h[m>>2]|0,d)f=d,c=m;else break;h[c>>2]=0,d=f}else d=h[M+8>>2]|0,h[d+12>>2]=f,h[f+8>>2]=d,d=f;while(!1);do if(_|0){if(f=h[M+28>>2]|0,c=28212+(f<<2)|0,(M|0)==(h[c>>2]|0)){if(h[c>>2]=d,!d){h[6978]=y&~(1<<f);break}}else if(_e=_+16|0,h[((h[_e>>2]|0)==(M|0)?_e:_+20|0)>>2]=d,!d)break;h[d+24>>2]=_,f=h[M+16>>2]|0,f|0&&(h[d+16>>2]=f,h[f+24>>2]=d),f=h[M+20>>2]|0,f|0&&(h[d+20>>2]=f,h[f+24>>2]=d)}while(!1);return C>>>0<16?(_e=C+P|0,h[M+4>>2]=_e|3,_e=M+_e+4|0,h[_e>>2]=h[_e>>2]|1):(h[M+4>>2]=P|3,h[b+4>>2]=C|1,h[b+C>>2]=C,k|0&&(m=h[6982]|0,f=k>>>3,d=27948+(f<<1<<2)|0,f=1<<f,f&Y?(c=d+8|0,f=h[c>>2]|0):(h[6977]=f|Y,f=d,c=d+8|0),h[c>>2]=m,h[f+12>>2]=m,h[m+8>>2]=f,h[m+12>>2]=d),h[6979]=C,h[6982]=b),_e=M+8|0,z=ht,_e|0}else Y=P}else Y=P}else Y=P}else if(c>>>0<=4294967231)if(c=c+11|0,P=c&-8,m=h[6978]|0,m){_=0-P|0,c=c>>>8,c?P>>>0>16777215?C=31:(Y=(c+1048320|0)>>>16&8,me=c<<Y,M=(me+520192|0)>>>16&4,me=me<<M,C=(me+245760|0)>>>16&2,C=14-(M|Y|C)+(me<<C>>>15)|0,C=P>>>(C+7|0)&1|C<<1):C=0,d=h[28212+(C<<2)>>2]|0;e:do if(!d)d=0,c=0,me=61;else for(c=0,M=P<<((C|0)==31?0:25-(C>>>1)|0),y=0;;){if(b=(h[d+4>>2]&-8)-P|0,b>>>0<_>>>0)if(b)c=d,_=b;else{c=d,_=0,me=65;break e}if(me=h[d+20>>2]|0,d=h[d+16+(M>>>31<<2)>>2]|0,y=(me|0)==0|(me|0)==(d|0)?y:me,d)M=M<<1;else{d=y,me=61;break}}while(!1);if((me|0)==61){if((d|0)==0&(c|0)==0){if(c=2<<C,c=(c|0-c)&m,!c){Y=P;break}Y=(c&0-c)+-1|0,b=Y>>>12&16,Y=Y>>>b,y=Y>>>5&8,Y=Y>>>y,M=Y>>>2&4,Y=Y>>>M,C=Y>>>1&2,Y=Y>>>C,d=Y>>>1&1,c=0,d=h[28212+((y|b|M|C|d)+(Y>>>d)<<2)>>2]|0}d?me=65:(M=c,b=_)}if((me|0)==65)for(y=d;;)if(Y=(h[y+4>>2]&-8)-P|0,d=Y>>>0<_>>>0,_=d?Y:_,c=d?y:c,d=h[y+16>>2]|0,d||(d=h[y+20>>2]|0),d)y=d;else{M=c,b=_;break}if((M|0)!=0&&b>>>0<((h[6979]|0)-P|0)>>>0&&(k=M+P|0,k>>>0>M>>>0)){y=h[M+24>>2]|0,f=h[M+12>>2]|0;do if((f|0)==(M|0)){if(c=M+20|0,f=h[c>>2]|0,!f&&(c=M+16|0,f=h[c>>2]|0,!f)){f=0;break}for(;;)if(_=f+20|0,d=h[_>>2]|0,d)f=d,c=_;else if(_=f+16|0,d=h[_>>2]|0,d)f=d,c=_;else break;h[c>>2]=0}else _e=h[M+8>>2]|0,h[_e+12>>2]=f,h[f+8>>2]=_e;while(!1);do if(y){if(c=h[M+28>>2]|0,d=28212+(c<<2)|0,(M|0)==(h[d>>2]|0)){if(h[d>>2]=f,!f){m=m&~(1<<c),h[6978]=m;break}}else if(_e=y+16|0,h[((h[_e>>2]|0)==(M|0)?_e:y+20|0)>>2]=f,!f)break;h[f+24>>2]=y,c=h[M+16>>2]|0,c|0&&(h[f+16>>2]=c,h[c+24>>2]=f),c=h[M+20>>2]|0,c&&(h[f+20>>2]=c,h[c+24>>2]=f)}while(!1);e:do if(b>>>0<16)_e=b+P|0,h[M+4>>2]=_e|3,_e=M+_e+4|0,h[_e>>2]=h[_e>>2]|1;else{if(h[M+4>>2]=P|3,h[k+4>>2]=b|1,h[k+b>>2]=b,f=b>>>3,b>>>0<256){d=27948+(f<<1<<2)|0,c=h[6977]|0,f=1<<f,c&f?(c=d+8|0,f=h[c>>2]|0):(h[6977]=c|f,f=d,c=d+8|0),h[c>>2]=k,h[f+12>>2]=k,h[k+8>>2]=f,h[k+12>>2]=d;break}if(f=b>>>8,f?b>>>0>16777215?d=31:(Pe=(f+1048320|0)>>>16&8,_e=f<<Pe,Ie=(_e+520192|0)>>>16&4,_e=_e<<Ie,d=(_e+245760|0)>>>16&2,d=14-(Ie|Pe|d)+(_e<<d>>>15)|0,d=b>>>(d+7|0)&1|d<<1):d=0,f=28212+(d<<2)|0,h[k+28>>2]=d,c=k+16|0,h[c+4>>2]=0,h[c>>2]=0,c=1<<d,!(m&c)){h[6978]=m|c,h[f>>2]=k,h[k+24>>2]=f,h[k+12>>2]=k,h[k+8>>2]=k;break}f=h[f>>2]|0;t:do if((h[f+4>>2]&-8|0)!=(b|0)){for(m=b<<((d|0)==31?0:25-(d>>>1)|0);d=f+16+(m>>>31<<2)|0,c=h[d>>2]|0,!!c;)if((h[c+4>>2]&-8|0)==(b|0)){f=c;break t}else m=m<<1,f=c;h[d>>2]=k,h[k+24>>2]=f,h[k+12>>2]=k,h[k+8>>2]=k;break e}while(!1);Pe=f+8|0,_e=h[Pe>>2]|0,h[_e+12>>2]=k,h[Pe>>2]=k,h[k+8>>2]=_e,h[k+12>>2]=f,h[k+24>>2]=0}while(!1);return _e=M+8|0,z=ht,_e|0}else Y=P}else Y=P;else Y=-1;while(!1);if(d=h[6979]|0,d>>>0>=Y>>>0)return f=d-Y|0,c=h[6982]|0,f>>>0>15?(_e=c+Y|0,h[6982]=_e,h[6979]=f,h[_e+4>>2]=f|1,h[c+d>>2]=f,h[c+4>>2]=Y|3):(h[6979]=0,h[6982]=0,h[c+4>>2]=d|3,_e=c+d+4|0,h[_e>>2]=h[_e>>2]|1),_e=c+8|0,z=ht,_e|0;if(b=h[6980]|0,b>>>0>Y>>>0)return Ie=b-Y|0,h[6980]=Ie,_e=h[6983]|0,Pe=_e+Y|0,h[6983]=Pe,h[Pe+4>>2]=Ie|1,h[_e+4>>2]=Y|3,_e=_e+8|0,z=ht,_e|0;if(h[7095]|0?c=h[7097]|0:(h[7097]=4096,h[7096]=4096,h[7098]=-1,h[7099]=-1,h[7100]=0,h[7088]=0,h[7095]=le&-16^1431655768,c=4096),M=Y+48|0,C=Y+47|0,y=c+C|0,_=0-c|0,P=y&_,P>>>0<=Y>>>0||(c=h[7087]|0,c|0&&(k=h[7085]|0,le=k+P|0,le>>>0<=k>>>0|le>>>0>c>>>0)))return _e=0,z=ht,_e|0;e:do if(h[7088]&4)f=0,me=143;else{d=h[6983]|0;t:do if(d){for(m=28356;le=h[m>>2]|0,!(le>>>0<=d>>>0&&(le+(h[m+4>>2]|0)|0)>>>0>d>>>0);)if(c=h[m+8>>2]|0,c)m=c;else{me=128;break t}if(f=y-b&_,f>>>0<2147483647)if(c=ru(f|0)|0,(c|0)==((h[m>>2]|0)+(h[m+4>>2]|0)|0)){if((c|0)!=-1){b=f,y=c,me=145;break e}}else m=c,me=136;else f=0}else me=128;while(!1);do if((me|0)==128)if(d=ru(0)|0,(d|0)!=-1&&(f=d,se=h[7096]|0,oe=se+-1|0,f=((oe&f|0)==0?0:(oe+f&0-se)-f|0)+P|0,se=h[7085]|0,oe=f+se|0,f>>>0>Y>>>0&f>>>0<2147483647)){if(le=h[7087]|0,le|0&&oe>>>0<=se>>>0|oe>>>0>le>>>0){f=0;break}if(c=ru(f|0)|0,(c|0)==(d|0)){b=f,y=d,me=145;break e}else m=c,me=136}else f=0;while(!1);do if((me|0)==136){if(d=0-f|0,!(M>>>0>f>>>0&(f>>>0<2147483647&(m|0)!=-1)))if((m|0)==-1){f=0;break}else{b=f,y=m,me=145;break e}if(c=h[7097]|0,c=C-f+c&0-c,c>>>0>=2147483647){b=f,y=m,me=145;break e}if((ru(c|0)|0)==-1){ru(d|0)|0,f=0;break}else{b=c+f|0,y=m,me=145;break e}}while(!1);h[7088]=h[7088]|4,me=143}while(!1);if((me|0)==143&&P>>>0<2147483647&&(Ie=ru(P|0)|0,oe=ru(0)|0,Te=oe-Ie|0,Oe=Te>>>0>(Y+40|0)>>>0,!((Ie|0)==-1|Oe^1|Ie>>>0<oe>>>0&((Ie|0)!=-1&(oe|0)!=-1)^1))&&(b=Oe?Te:f,y=Ie,me=145),(me|0)==145){f=(h[7085]|0)+b|0,h[7085]=f,f>>>0>(h[7086]|0)>>>0&&(h[7086]=f),C=h[6983]|0;e:do if(C){for(f=28356;;){if(c=h[f>>2]|0,d=h[f+4>>2]|0,(y|0)==(c+d|0)){me=154;break}if(m=h[f+8>>2]|0,m)f=m;else break}if((me|0)==154&&(Pe=f+4|0,(h[f+12>>2]&8|0)==0)&&y>>>0>C>>>0&c>>>0<=C>>>0){h[Pe>>2]=d+b,_e=(h[6980]|0)+b|0,Ie=C+8|0,Ie=(Ie&7|0)==0?0:0-Ie&7,Pe=C+Ie|0,Ie=_e-Ie|0,h[6983]=Pe,h[6980]=Ie,h[Pe+4>>2]=Ie|1,h[C+_e+4>>2]=40,h[6984]=h[7099];break}for(y>>>0<(h[6981]|0)>>>0&&(h[6981]=y),d=y+b|0,f=28356;;){if((h[f>>2]|0)==(d|0)){me=162;break}if(c=h[f+8>>2]|0,c)f=c;else break}if((me|0)==162&&(h[f+12>>2]&8|0)==0){h[f>>2]=y,k=f+4|0,h[k>>2]=(h[k>>2]|0)+b,k=y+8|0,k=y+((k&7|0)==0?0:0-k&7)|0,f=d+8|0,f=d+((f&7|0)==0?0:0-f&7)|0,P=k+Y|0,M=f-k-Y|0,h[k+4>>2]=Y|3;t:do if((C|0)==(f|0))_e=(h[6980]|0)+M|0,h[6980]=_e,h[6983]=P,h[P+4>>2]=_e|1;else{if((h[6982]|0)==(f|0)){_e=(h[6979]|0)+M|0,h[6979]=_e,h[6982]=P,h[P+4>>2]=_e|1,h[P+_e>>2]=_e;break}if(c=h[f+4>>2]|0,(c&3|0)==1){b=c&-8,m=c>>>3;n:do if(c>>>0<256)if(c=h[f+8>>2]|0,d=h[f+12>>2]|0,(d|0)==(c|0)){h[6977]=h[6977]&~(1<<m);break}else{h[c+12>>2]=d,h[d+8>>2]=c;break}else{y=h[f+24>>2]|0,c=h[f+12>>2]|0;do if((c|0)==(f|0)){if(d=f+16|0,m=d+4|0,c=h[m>>2]|0,c)d=m;else if(c=h[d>>2]|0,!c){c=0;break}for(;;)if(_=c+20|0,m=h[_>>2]|0,m)c=m,d=_;else if(_=c+16|0,m=h[_>>2]|0,m)c=m,d=_;else break;h[d>>2]=0}else _e=h[f+8>>2]|0,h[_e+12>>2]=c,h[c+8>>2]=_e;while(!1);if(!y)break;d=h[f+28>>2]|0,m=28212+(d<<2)|0;do if((h[m>>2]|0)!=(f|0)){if(_e=y+16|0,h[((h[_e>>2]|0)==(f|0)?_e:y+20|0)>>2]=c,!c)break n}else{if(h[m>>2]=c,c|0)break;h[6978]=h[6978]&~(1<<d);break n}while(!1);if(h[c+24>>2]=y,d=f+16|0,m=h[d>>2]|0,m|0&&(h[c+16>>2]=m,h[m+24>>2]=c),d=h[d+4>>2]|0,!d)break;h[c+20>>2]=d,h[d+24>>2]=c}while(!1);f=f+b|0,_=b+M|0}else _=M;if(f=f+4|0,h[f>>2]=h[f>>2]&-2,h[P+4>>2]=_|1,h[P+_>>2]=_,f=_>>>3,_>>>0<256){d=27948+(f<<1<<2)|0,c=h[6977]|0,f=1<<f,c&f?(c=d+8|0,f=h[c>>2]|0):(h[6977]=c|f,f=d,c=d+8|0),h[c>>2]=P,h[f+12>>2]=P,h[P+8>>2]=f,h[P+12>>2]=d;break}f=_>>>8;do if(!f)m=0;else{if(_>>>0>16777215){m=31;break}Pe=(f+1048320|0)>>>16&8,_e=f<<Pe,Ie=(_e+520192|0)>>>16&4,_e=_e<<Ie,m=(_e+245760|0)>>>16&2,m=14-(Ie|Pe|m)+(_e<<m>>>15)|0,m=_>>>(m+7|0)&1|m<<1}while(!1);if(f=28212+(m<<2)|0,h[P+28>>2]=m,c=P+16|0,h[c+4>>2]=0,h[c>>2]=0,c=h[6978]|0,d=1<<m,!(c&d)){h[6978]=c|d,h[f>>2]=P,h[P+24>>2]=f,h[P+12>>2]=P,h[P+8>>2]=P;break}f=h[f>>2]|0;n:do if((h[f+4>>2]&-8|0)!=(_|0)){for(m=_<<((m|0)==31?0:25-(m>>>1)|0);d=f+16+(m>>>31<<2)|0,c=h[d>>2]|0,!!c;)if((h[c+4>>2]&-8|0)==(_|0)){f=c;break n}else m=m<<1,f=c;h[d>>2]=P,h[P+24>>2]=f,h[P+12>>2]=P,h[P+8>>2]=P;break t}while(!1);Pe=f+8|0,_e=h[Pe>>2]|0,h[_e+12>>2]=P,h[Pe>>2]=P,h[P+8>>2]=_e,h[P+12>>2]=f,h[P+24>>2]=0}while(!1);return _e=k+8|0,z=ht,_e|0}for(f=28356;c=h[f>>2]|0,!(c>>>0<=C>>>0&&(_e=c+(h[f+4>>2]|0)|0,_e>>>0>C>>>0));)f=h[f+8>>2]|0;_=_e+-47|0,c=_+8|0,c=_+((c&7|0)==0?0:0-c&7)|0,_=C+16|0,c=c>>>0<_>>>0?C:c,f=c+8|0,d=b+-40|0,Ie=y+8|0,Ie=(Ie&7|0)==0?0:0-Ie&7,Pe=y+Ie|0,Ie=d-Ie|0,h[6983]=Pe,h[6980]=Ie,h[Pe+4>>2]=Ie|1,h[y+d+4>>2]=40,h[6984]=h[7099],d=c+4|0,h[d>>2]=27,h[f>>2]=h[7089],h[f+4>>2]=h[7090],h[f+8>>2]=h[7091],h[f+12>>2]=h[7092],h[7089]=y,h[7090]=b,h[7092]=0,h[7091]=f,f=c+24|0;do Pe=f,f=f+4|0,h[f>>2]=7;while((Pe+8|0)>>>0<_e>>>0);if((c|0)!=(C|0)){if(y=c-C|0,h[d>>2]=h[d>>2]&-2,h[C+4>>2]=y|1,h[c>>2]=y,f=y>>>3,y>>>0<256){d=27948+(f<<1<<2)|0,c=h[6977]|0,f=1<<f,c&f?(c=d+8|0,f=h[c>>2]|0):(h[6977]=c|f,f=d,c=d+8|0),h[c>>2]=C,h[f+12>>2]=C,h[C+8>>2]=f,h[C+12>>2]=d;break}if(f=y>>>8,f?y>>>0>16777215?m=31:(Pe=(f+1048320|0)>>>16&8,_e=f<<Pe,Ie=(_e+520192|0)>>>16&4,_e=_e<<Ie,m=(_e+245760|0)>>>16&2,m=14-(Ie|Pe|m)+(_e<<m>>>15)|0,m=y>>>(m+7|0)&1|m<<1):m=0,d=28212+(m<<2)|0,h[C+28>>2]=m,h[C+20>>2]=0,h[_>>2]=0,f=h[6978]|0,c=1<<m,!(f&c)){h[6978]=f|c,h[d>>2]=C,h[C+24>>2]=d,h[C+12>>2]=C,h[C+8>>2]=C;break}f=h[d>>2]|0;t:do if((h[f+4>>2]&-8|0)!=(y|0)){for(m=y<<((m|0)==31?0:25-(m>>>1)|0);d=f+16+(m>>>31<<2)|0,c=h[d>>2]|0,!!c;)if((h[c+4>>2]&-8|0)==(y|0)){f=c;break t}else m=m<<1,f=c;h[d>>2]=C,h[C+24>>2]=f,h[C+12>>2]=C,h[C+8>>2]=C;break e}while(!1);Pe=f+8|0,_e=h[Pe>>2]|0,h[_e+12>>2]=C,h[Pe>>2]=C,h[C+8>>2]=_e,h[C+12>>2]=f,h[C+24>>2]=0}}else _e=h[6981]|0,(_e|0)==0|y>>>0<_e>>>0&&(h[6981]=y),h[7089]=y,h[7090]=b,h[7092]=0,h[6986]=h[7095],h[6985]=-1,h[6990]=27948,h[6989]=27948,h[6992]=27956,h[6991]=27956,h[6994]=27964,h[6993]=27964,h[6996]=27972,h[6995]=27972,h[6998]=27980,h[6997]=27980,h[7e3]=27988,h[6999]=27988,h[7002]=27996,h[7001]=27996,h[7004]=28004,h[7003]=28004,h[7006]=28012,h[7005]=28012,h[7008]=28020,h[7007]=28020,h[7010]=28028,h[7009]=28028,h[7012]=28036,h[7011]=28036,h[7014]=28044,h[7013]=28044,h[7016]=28052,h[7015]=28052,h[7018]=28060,h[7017]=28060,h[7020]=28068,h[7019]=28068,h[7022]=28076,h[7021]=28076,h[7024]=28084,h[7023]=28084,h[7026]=28092,h[7025]=28092,h[7028]=28100,h[7027]=28100,h[7030]=28108,h[7029]=28108,h[7032]=28116,h[7031]=28116,h[7034]=28124,h[7033]=28124,h[7036]=28132,h[7035]=28132,h[7038]=28140,h[7037]=28140,h[7040]=28148,h[7039]=28148,h[7042]=28156,h[7041]=28156,h[7044]=28164,h[7043]=28164,h[7046]=28172,h[7045]=28172,h[7048]=28180,h[7047]=28180,h[7050]=28188,h[7049]=28188,h[7052]=28196,h[7051]=28196,_e=b+-40|0,Ie=y+8|0,Ie=(Ie&7|0)==0?0:0-Ie&7,Pe=y+Ie|0,Ie=_e-Ie|0,h[6983]=Pe,h[6980]=Ie,h[Pe+4>>2]=Ie|1,h[y+_e+4>>2]=40,h[6984]=h[7099];while(!1);if(f=h[6980]|0,f>>>0>Y>>>0)return Ie=f-Y|0,h[6980]=Ie,_e=h[6983]|0,Pe=_e+Y|0,h[6983]=Pe,h[Pe+4>>2]=Ie|1,h[_e+4>>2]=Y|3,_e=_e+8|0,z=ht,_e|0}return _e=VI()|0,h[_e>>2]=12,_e=0,z=ht,_e|0}function Jt(c){c=c|0;var f=0,d=0,m=0,_=0,y=0,b=0,M=0,C=0;if(c){d=c+-8|0,_=h[6981]|0,c=h[c+-4>>2]|0,f=c&-8,C=d+f|0;do if(c&1)M=d,b=d;else{if(m=h[d>>2]|0,!(c&3)||(b=d+(0-m)|0,y=m+f|0,b>>>0<_>>>0))return;if((h[6982]|0)==(b|0)){if(c=C+4|0,f=h[c>>2]|0,(f&3|0)!=3){M=b,f=y;break}h[6979]=y,h[c>>2]=f&-2,h[b+4>>2]=y|1,h[b+y>>2]=y;return}if(d=m>>>3,m>>>0<256)if(c=h[b+8>>2]|0,f=h[b+12>>2]|0,(f|0)==(c|0)){h[6977]=h[6977]&~(1<<d),M=b,f=y;break}else{h[c+12>>2]=f,h[f+8>>2]=c,M=b,f=y;break}_=h[b+24>>2]|0,c=h[b+12>>2]|0;do if((c|0)==(b|0)){if(f=b+16|0,d=f+4|0,c=h[d>>2]|0,c)f=d;else if(c=h[f>>2]|0,!c){c=0;break}for(;;)if(m=c+20|0,d=h[m>>2]|0,d)c=d,f=m;else if(m=c+16|0,d=h[m>>2]|0,d)c=d,f=m;else break;h[f>>2]=0}else M=h[b+8>>2]|0,h[M+12>>2]=c,h[c+8>>2]=M;while(!1);if(_){if(f=h[b+28>>2]|0,d=28212+(f<<2)|0,(h[d>>2]|0)==(b|0)){if(h[d>>2]=c,!c){h[6978]=h[6978]&~(1<<f),M=b,f=y;break}}else if(M=_+16|0,h[((h[M>>2]|0)==(b|0)?M:_+20|0)>>2]=c,!c){M=b,f=y;break}h[c+24>>2]=_,f=b+16|0,d=h[f>>2]|0,d|0&&(h[c+16>>2]=d,h[d+24>>2]=c),f=h[f+4>>2]|0,f?(h[c+20>>2]=f,h[f+24>>2]=c,M=b,f=y):(M=b,f=y)}else M=b,f=y}while(!1);if(!(b>>>0>=C>>>0)&&(c=C+4|0,m=h[c>>2]|0,!!(m&1))){if(m&2)h[c>>2]=m&-2,h[M+4>>2]=f|1,h[b+f>>2]=f,_=f;else{if((h[6983]|0)==(C|0)){if(C=(h[6980]|0)+f|0,h[6980]=C,h[6983]=M,h[M+4>>2]=C|1,(M|0)!=(h[6982]|0))return;h[6982]=0,h[6979]=0;return}if((h[6982]|0)==(C|0)){C=(h[6979]|0)+f|0,h[6979]=C,h[6982]=b,h[M+4>>2]=C|1,h[b+C>>2]=C;return}_=(m&-8)+f|0,d=m>>>3;do if(m>>>0<256)if(f=h[C+8>>2]|0,c=h[C+12>>2]|0,(c|0)==(f|0)){h[6977]=h[6977]&~(1<<d);break}else{h[f+12>>2]=c,h[c+8>>2]=f;break}else{y=h[C+24>>2]|0,c=h[C+12>>2]|0;do if((c|0)==(C|0)){if(f=C+16|0,d=f+4|0,c=h[d>>2]|0,c)f=d;else if(c=h[f>>2]|0,!c){d=0;break}for(;;)if(m=c+20|0,d=h[m>>2]|0,d)c=d,f=m;else if(m=c+16|0,d=h[m>>2]|0,d)c=d,f=m;else break;h[f>>2]=0,d=c}else d=h[C+8>>2]|0,h[d+12>>2]=c,h[c+8>>2]=d,d=c;while(!1);if(y|0){if(c=h[C+28>>2]|0,f=28212+(c<<2)|0,(h[f>>2]|0)==(C|0)){if(h[f>>2]=d,!d){h[6978]=h[6978]&~(1<<c);break}}else if(m=y+16|0,h[((h[m>>2]|0)==(C|0)?m:y+20|0)>>2]=d,!d)break;h[d+24>>2]=y,c=C+16|0,f=h[c>>2]|0,f|0&&(h[d+16>>2]=f,h[f+24>>2]=d),c=h[c+4>>2]|0,c|0&&(h[d+20>>2]=c,h[c+24>>2]=d)}}while(!1);if(h[M+4>>2]=_|1,h[b+_>>2]=_,(M|0)==(h[6982]|0)){h[6979]=_;return}}if(c=_>>>3,_>>>0<256){d=27948+(c<<1<<2)|0,f=h[6977]|0,c=1<<c,f&c?(f=d+8|0,c=h[f>>2]|0):(h[6977]=f|c,c=d,f=d+8|0),h[f>>2]=M,h[c+12>>2]=M,h[M+8>>2]=c,h[M+12>>2]=d;return}c=_>>>8,c?_>>>0>16777215?m=31:(b=(c+1048320|0)>>>16&8,C=c<<b,y=(C+520192|0)>>>16&4,C=C<<y,m=(C+245760|0)>>>16&2,m=14-(y|b|m)+(C<<m>>>15)|0,m=_>>>(m+7|0)&1|m<<1):m=0,c=28212+(m<<2)|0,h[M+28>>2]=m,h[M+20>>2]=0,h[M+16>>2]=0,f=h[6978]|0,d=1<<m;e:do if(!(f&d))h[6978]=f|d,h[c>>2]=M,h[M+24>>2]=c,h[M+12>>2]=M,h[M+8>>2]=M;else{c=h[c>>2]|0;t:do if((h[c+4>>2]&-8|0)!=(_|0)){for(m=_<<((m|0)==31?0:25-(m>>>1)|0);d=c+16+(m>>>31<<2)|0,f=h[d>>2]|0,!!f;)if((h[f+4>>2]&-8|0)==(_|0)){c=f;break t}else m=m<<1,c=f;h[d>>2]=M,h[M+24>>2]=c,h[M+12>>2]=M,h[M+8>>2]=M;break e}while(!1);b=c+8|0,C=h[b>>2]|0,h[C+12>>2]=M,h[b>>2]=M,h[M+8>>2]=C,h[M+12>>2]=c,h[M+24>>2]=0}while(!1);if(C=(h[6985]|0)+-1|0,h[6985]=C,!(C|0)){for(c=28364;c=h[c>>2]|0,c;)c=c+8|0;h[6985]=-1}}}}function Co(c,f){c=c|0,f=f|0;var d=0;return c?(d=ke(f,c)|0,(f|c)>>>0>65535&&(d=((d>>>0)/(c>>>0)|0|0)==(f|0)?d:-1)):d=0,c=Ta(d)|0,!c||!(h[c+-4>>2]&3)||ec(c|0,0,d|0)|0,c|0}function Qt(c,f,d,m){return c=c|0,f=f|0,d=d|0,m=m|0,d=c+d>>>0,et(f+m+(d>>>0<c>>>0|0)>>>0|0),d|0|0}function Gr(c,f,d,m){return c=c|0,f=f|0,d=d|0,m=m|0,m=f-m-(d>>>0>c>>>0|0)>>>0,et(m|0),c-d>>>0|0|0}function C5(c){return c=c|0,(c?31-(St(c^c-1)|0)|0:32)|0}function g_(c,f,d,m,_){c=c|0,f=f|0,d=d|0,m=m|0,_=_|0;var y=0,b=0,M=0,C=0,P=0,k=0,Y=0,le=0,se=0,oe=0;if(k=c,C=f,P=C,b=d,le=m,M=le,!P)return y=(_|0)!=0,M?y?(h[_>>2]=c|0,h[_+4>>2]=f&0,le=0,_=0,et(le|0),_|0):(le=0,_=0,et(le|0),_|0):(y&&(h[_>>2]=(k>>>0)%(b>>>0),h[_+4>>2]=0),le=0,_=(k>>>0)/(b>>>0)>>>0,et(le|0),_|0);y=(M|0)==0;do if(b){if(!y){if(y=(St(M|0)|0)-(St(P|0)|0)|0,y>>>0<=31){Y=y+1|0,M=31-y|0,f=y-31>>31,b=Y,c=k>>>(Y>>>0)&f|P<<M,f=P>>>(Y>>>0)&f,y=0,M=k<<M;break}return _?(h[_>>2]=c|0,h[_+4>>2]=C|f&0,le=0,_=0,et(le|0),_|0):(le=0,_=0,et(le|0),_|0)}if(y=b-1|0,y&b|0){M=(St(b|0)|0)+33-(St(P|0)|0)|0,oe=64-M|0,Y=32-M|0,C=Y>>31,se=M-32|0,f=se>>31,b=M,c=Y-1>>31&P>>>(se>>>0)|(P<<Y|k>>>(M>>>0))&f,f=f&P>>>(M>>>0),y=k<<oe&C,M=(P<<oe|k>>>(se>>>0))&C|k<<Y&M-33>>31;break}return _|0&&(h[_>>2]=y&k,h[_+4>>2]=0),(b|0)==1?(se=C|f&0,oe=c|0|0,et(se|0),oe|0):(oe=C5(b|0)|0,se=P>>>(oe>>>0)|0,oe=P<<32-oe|k>>>(oe>>>0)|0,et(se|0),oe|0)}else{if(y)return _|0&&(h[_>>2]=(P>>>0)%(b>>>0),h[_+4>>2]=0),se=0,oe=(P>>>0)/(b>>>0)>>>0,et(se|0),oe|0;if(!k)return _|0&&(h[_>>2]=0,h[_+4>>2]=(P>>>0)%(M>>>0)),se=0,oe=(P>>>0)/(M>>>0)>>>0,et(se|0),oe|0;if(y=M-1|0,!(y&M))return _|0&&(h[_>>2]=c|0,h[_+4>>2]=y&P|f&0),se=0,oe=P>>>((C5(M|0)|0)>>>0),et(se|0),oe|0;if(y=(St(M|0)|0)-(St(P|0)|0)|0,y>>>0<=30){f=y+1|0,M=31-y|0,b=f,c=P<<M|k>>>(f>>>0),f=P>>>(f>>>0),y=0,M=k<<M;break}return _?(h[_>>2]=c|0,h[_+4>>2]=C|f&0,se=0,oe=0,et(se|0),oe|0):(se=0,oe=0,et(se|0),oe|0)}while(!1);if(!b)P=M,C=0,M=0;else{Y=d|0|0,k=le|m&0,P=Qt(Y|0,k|0,-1,-1)|0,d=X()|0,C=M,M=0;do m=C,C=y>>>31|C<<1,y=M|y<<1,m=c<<1|m>>>31|0,le=c>>>31|f<<1|0,Gr(P|0,d|0,m|0,le|0)|0,oe=X()|0,se=oe>>31|((oe|0)<0?-1:0)<<1,M=se&1,c=Gr(m|0,le|0,se&Y|0,(((oe|0)<0?-1:0)>>31|((oe|0)<0?-1:0)<<1)&k|0)|0,f=X()|0,b=b-1|0;while((b|0)!=0);P=C,C=0}return b=0,_|0&&(h[_>>2]=c,h[_+4>>2]=f),se=(y|0)>>>31|(P|b)<<1|(b<<1|y>>>31)&0|C,oe=(y<<1|0)&-2|M,et(se|0),oe|0}function iu(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0;return P=f>>31|((f|0)<0?-1:0)<<1,C=((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1,y=m>>31|((m|0)<0?-1:0)<<1,_=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,M=Gr(P^c|0,C^f|0,P|0,C|0)|0,b=X()|0,c=y^P,f=_^C,Gr((g_(M,b,Gr(y^d|0,_^m|0,y|0,_|0)|0,X()|0,0)|0)^c|0,(X()|0)^f|0,c|0,f|0)|0}function GI(c,f){c=c|0,f=f|0;var d=0,m=0,_=0,y=0;return y=c&65535,_=f&65535,d=ke(_,y)|0,m=c>>>16,c=(d>>>16)+(ke(_,m)|0)|0,_=f>>>16,f=ke(_,y)|0,et((c>>>16)+(ke(_,m)|0)+(((c&65535)+f|0)>>>16)|0),c+f<<16|d&65535|0|0}function is(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0;return _=c,y=d,d=GI(_,y)|0,c=X()|0,et((ke(f,y)|0)+(ke(m,_)|0)+c|c&0|0),d|0|0|0}function bh(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0,b=0,M=0,C=0,P=0;return _=z,z=z+16|0,M=_|0,b=f>>31|((f|0)<0?-1:0)<<1,y=((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1,P=m>>31|((m|0)<0?-1:0)<<1,C=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,c=Gr(b^c|0,y^f|0,b|0,y|0)|0,f=X()|0,g_(c,f,Gr(P^d|0,C^m|0,P|0,C|0)|0,X()|0,M)|0,m=Gr(h[M>>2]^b|0,h[M+4>>2]^y|0,b|0,y|0)|0,d=X()|0,z=_,et(d|0),m|0}function wh(c,f,d,m){c=c|0,f=f|0,d=d|0,m=m|0;var _=0,y=0;return y=z,z=z+16|0,_=y|0,g_(c,f,d,m,_)|0,z=y,et(h[_+4>>2]|0),h[_>>2]|0|0}function R5(c,f,d){return c=c|0,f=f|0,d=d|0,(d|0)<32?(et(f>>d|0),c>>>d|(f&(1<<d)-1)<<32-d):(et(((f|0)<0?-1:0)|0),f>>d-32|0)}function rt(c,f,d){return c=c|0,f=f|0,d=d|0,(d|0)<32?(et(f>>>d|0),c>>>d|(f&(1<<d)-1)<<32-d):(et(0),f>>>d-32|0)}function dt(c,f,d){return c=c|0,f=f|0,d=d|0,(d|0)<32?(et(f<<d|(c&(1<<d)-1<<32-d)>>>32-d|0),c<<d):(et(c<<d-32|0),0)}function N5(c,f,d){return c=c|0,f=f|0,f=St(f)|0,(f|0)==32&&(f=f+(St(c)|0)|0),et(0),f|0}function P5(c,f){return c=+c,f=+f,c!=c?+f:f!=f?+c:+mt(+c,+f)}function Pp(c,f){return c=+c,f=+f,c!=c?+f:f!=f?+c:+De(+c,+f)}function Lp(c){return c=+c,c>=0?+zi(c+.5):+qe(c-.5)}function Sh(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0;if((d|0)>=8192)return qn(c|0,f|0,d|0)|0,c|0;if(y=c|0,_=c+d|0,(c&3)==(f&3)){for(;c&3;){if(!d)return y|0;nt[c>>0]=nt[f>>0]|0,c=c+1|0,f=f+1|0,d=d-1|0}for(d=_&-4|0,m=d-64|0;(c|0)<=(m|0);)h[c>>2]=h[f>>2],h[c+4>>2]=h[f+4>>2],h[c+8>>2]=h[f+8>>2],h[c+12>>2]=h[f+12>>2],h[c+16>>2]=h[f+16>>2],h[c+20>>2]=h[f+20>>2],h[c+24>>2]=h[f+24>>2],h[c+28>>2]=h[f+28>>2],h[c+32>>2]=h[f+32>>2],h[c+36>>2]=h[f+36>>2],h[c+40>>2]=h[f+40>>2],h[c+44>>2]=h[f+44>>2],h[c+48>>2]=h[f+48>>2],h[c+52>>2]=h[f+52>>2],h[c+56>>2]=h[f+56>>2],h[c+60>>2]=h[f+60>>2],c=c+64|0,f=f+64|0;for(;(c|0)<(d|0);)h[c>>2]=h[f>>2],c=c+4|0,f=f+4|0}else for(d=_-4|0;(c|0)<(d|0);)nt[c>>0]=nt[f>>0]|0,nt[c+1>>0]=nt[f+1>>0]|0,nt[c+2>>0]=nt[f+2>>0]|0,nt[c+3>>0]=nt[f+3>>0]|0,c=c+4|0,f=f+4|0;for(;(c|0)<(_|0);)nt[c>>0]=nt[f>>0]|0,c=c+1|0,f=f+1|0;return y|0}function ec(c,f,d){c=c|0,f=f|0,d=d|0;var m=0,_=0,y=0,b=0;if(y=c+d|0,f=f&255,(d|0)>=67){for(;c&3;)nt[c>>0]=f,c=c+1|0;for(m=y&-4|0,b=f|f<<8|f<<16|f<<24,_=m-64|0;(c|0)<=(_|0);)h[c>>2]=b,h[c+4>>2]=b,h[c+8>>2]=b,h[c+12>>2]=b,h[c+16>>2]=b,h[c+20>>2]=b,h[c+24>>2]=b,h[c+28>>2]=b,h[c+32>>2]=b,h[c+36>>2]=b,h[c+40>>2]=b,h[c+44>>2]=b,h[c+48>>2]=b,h[c+52>>2]=b,h[c+56>>2]=b,h[c+60>>2]=b,c=c+64|0;for(;(c|0)<(m|0);)h[c>>2]=b,c=c+4|0}for(;(c|0)<(y|0);)nt[c>>0]=f,c=c+1|0;return y-d|0}function L5(c){return c=+c,c>=0?+zi(c+.5):+qe(c-.5)}function ru(c){c=c|0;var f=0,d=0,m=0;return m=Yt()|0,d=h[jn>>2]|0,f=d+c|0,(c|0)>0&(f|0)<(d|0)|(f|0)<0?(Xi(f|0)|0,sn(12),-1):(f|0)>(m|0)&&!(Qn(f|0)|0)?(sn(12),-1):(h[jn>>2]=f,d|0)}return{___divdi3:iu,___muldi3:is,___remdi3:bh,___uremdi3:wh,_areNeighborCells:ND,_bitshift64Ashr:R5,_bitshift64Lshr:rt,_bitshift64Shl:dt,_calloc:Co,_cellAreaKm2:aI,_cellAreaM2:lI,_cellAreaRads2:A_,_cellToBoundary:yh,_cellToCenterChild:c5,_cellToChildPos:KD,_cellToChildren:zD,_cellToChildrenSize:LA,_cellToLatLng:Ju,_cellToLocalIj:pI,_cellToParent:r_,_cellToVertex:Eo,_cellToVertexes:II,_cellsToDirectedEdge:PD,_cellsToLinkedMultiPolygon:hD,_childPosToCell:JD,_compactCells:HD,_destroyLinkedMultiPolygon:p5,_directedEdgeToBoundary:Cp,_directedEdgeToCells:BD,_edgeLengthKm:cI,_edgeLengthM:hI,_edgeLengthRads:uI,_emscripten_replace_memory:Wn,_free:Jt,_getBaseCellNumber:l5,_getDirectedEdgeDestination:DD,_getDirectedEdgeOrigin:LD,_getHexagonAreaAvgKm2:A5,_getHexagonAreaAvgM2:rI,_getHexagonEdgeLengthAvgKm:sI,_getHexagonEdgeLengthAvgM:oI,_getIcosahedronFaces:h5,_getNumCells:f_,_getPentagons:u_,_getRes0Cells:mD,_getResolution:qD,_greatCircleDistanceKm:IA,_greatCircleDistanceM:tI,_greatCircleDistanceRads:eI,_gridDisk:es,_gridDiskDistances:Jl,_gridDistance:gI,_gridPathCells:vI,_gridPathCellsSize:_I,_gridRingUnsafe:ts,_i64Add:Qt,_i64Subtract:Gr,_isPentagon:di,_isResClassIII:jD,_isValidCell:n_,_isValidDirectedEdge:ID,_isValidVertex:FI,_latLngToCell:a_,_llvm_ctlz_i64:N5,_llvm_maxnum_f64:P5,_llvm_minnum_f64:Pp,_llvm_round_f64:Lp,_localIjToCell:mI,_malloc:Ta,_maxFaceCount:YD,_maxGridDiskSize:Kl,_maxPolygonToCellsSize:NA,_maxPolygonToCellsSizeExperimental:bI,_memcpy:Sh,_memset:ec,_originToDirectedEdges:FD,_pentagonCount:ZD,_polygonToCells:uD,_polygonToCellsExperimental:xI,_readInt64AsDoubleFromPointer:NI,_res0CellCount:pD,_round:L5,_sbrk:ru,_sizeOfCellBoundary:TI,_sizeOfCoordIJ:RI,_sizeOfGeoLoop:MI,_sizeOfGeoPolygon:EI,_sizeOfH3Index:wI,_sizeOfLatLng:SI,_sizeOfLinkedGeoPolygon:CI,_uncompactCells:$D,_uncompactCellsSize:WD,_vertexToLatLng:BI,establishStackSpace:no,stackAlloc:Kt,stackRestore:Yn,stackSave:br}}(Ot,fn,V);e.___divdi3=ne.___divdi3,e.___muldi3=ne.___muldi3,e.___remdi3=ne.___remdi3,e.___uremdi3=ne.___uremdi3,e._areNeighborCells=ne._areNeighborCells,e._bitshift64Ashr=ne._bitshift64Ashr,e._bitshift64Lshr=ne._bitshift64Lshr,e._bitshift64Shl=ne._bitshift64Shl,e._calloc=ne._calloc,e._cellAreaKm2=ne._cellAreaKm2,e._cellAreaM2=ne._cellAreaM2,e._cellAreaRads2=ne._cellAreaRads2,e._cellToBoundary=ne._cellToBoundary,e._cellToCenterChild=ne._cellToCenterChild,e._cellToChildPos=ne._cellToChildPos,e._cellToChildren=ne._cellToChildren,e._cellToChildrenSize=ne._cellToChildrenSize,e._cellToLatLng=ne._cellToLatLng,e._cellToLocalIj=ne._cellToLocalIj,e._cellToParent=ne._cellToParent,e._cellToVertex=ne._cellToVertex,e._cellToVertexes=ne._cellToVertexes,e._cellsToDirectedEdge=ne._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=ne._cellsToLinkedMultiPolygon,e._childPosToCell=ne._childPosToCell,e._compactCells=ne._compactCells,e._destroyLinkedMultiPolygon=ne._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=ne._directedEdgeToBoundary,e._directedEdgeToCells=ne._directedEdgeToCells,e._edgeLengthKm=ne._edgeLengthKm,e._edgeLengthM=ne._edgeLengthM,e._edgeLengthRads=ne._edgeLengthRads;var Rt=e._emscripten_replace_memory=ne._emscripten_replace_memory;e._free=ne._free,e._getBaseCellNumber=ne._getBaseCellNumber,e._getDirectedEdgeDestination=ne._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=ne._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=ne._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=ne._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=ne._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=ne._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=ne._getIcosahedronFaces,e._getNumCells=ne._getNumCells,e._getPentagons=ne._getPentagons,e._getRes0Cells=ne._getRes0Cells,e._getResolution=ne._getResolution,e._greatCircleDistanceKm=ne._greatCircleDistanceKm,e._greatCircleDistanceM=ne._greatCircleDistanceM,e._greatCircleDistanceRads=ne._greatCircleDistanceRads,e._gridDisk=ne._gridDisk,e._gridDiskDistances=ne._gridDiskDistances,e._gridDistance=ne._gridDistance,e._gridPathCells=ne._gridPathCells,e._gridPathCellsSize=ne._gridPathCellsSize,e._gridRingUnsafe=ne._gridRingUnsafe,e._i64Add=ne._i64Add,e._i64Subtract=ne._i64Subtract,e._isPentagon=ne._isPentagon,e._isResClassIII=ne._isResClassIII,e._isValidCell=ne._isValidCell,e._isValidDirectedEdge=ne._isValidDirectedEdge,e._isValidVertex=ne._isValidVertex,e._latLngToCell=ne._latLngToCell,e._llvm_ctlz_i64=ne._llvm_ctlz_i64,e._llvm_maxnum_f64=ne._llvm_maxnum_f64,e._llvm_minnum_f64=ne._llvm_minnum_f64,e._llvm_round_f64=ne._llvm_round_f64,e._localIjToCell=ne._localIjToCell,e._malloc=ne._malloc,e._maxFaceCount=ne._maxFaceCount,e._maxGridDiskSize=ne._maxGridDiskSize,e._maxPolygonToCellsSize=ne._maxPolygonToCellsSize,e._maxPolygonToCellsSizeExperimental=ne._maxPolygonToCellsSizeExperimental,e._memcpy=ne._memcpy,e._memset=ne._memset,e._originToDirectedEdges=ne._originToDirectedEdges,e._pentagonCount=ne._pentagonCount,e._polygonToCells=ne._polygonToCells,e._polygonToCellsExperimental=ne._polygonToCellsExperimental,e._readInt64AsDoubleFromPointer=ne._readInt64AsDoubleFromPointer,e._res0CellCount=ne._res0CellCount,e._round=ne._round,e._sbrk=ne._sbrk,e._sizeOfCellBoundary=ne._sizeOfCellBoundary,e._sizeOfCoordIJ=ne._sizeOfCoordIJ,e._sizeOfGeoLoop=ne._sizeOfGeoLoop,e._sizeOfGeoPolygon=ne._sizeOfGeoPolygon,e._sizeOfH3Index=ne._sizeOfH3Index,e._sizeOfLatLng=ne._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=ne._sizeOfLinkedGeoPolygon,e._uncompactCells=ne._uncompactCells,e._uncompactCellsSize=ne._uncompactCellsSize,e._vertexToLatLng=ne._vertexToLatLng,e.establishStackSpace=ne.establishStackSpace;var We=e.stackAlloc=ne.stackAlloc,it=e.stackRestore=ne.stackRestore,Pt=e.stackSave=ne.stackSave;if(e.asm=ne,e.cwrap=E,e.setValue=v,e.getValue=x,j){he(j)||(j=s(j));{ze();var Ct=function(Ge){Ge.byteLength&&(Ge=new Uint8Array(Ge)),Q.set(Ge,g),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Ne()},wn=function(){o(j,Ct,function(){throw"could not load memory initializer "+j})},Ri=tn(j);if(Ri)Ct(Ri.buffer);else if(e.memoryInitializerRequest){var xr=function(){var Ge=e.memoryInitializerRequest,Ze=Ge.response;if(Ge.status!==200&&Ge.status!==0){var xt=tn(e.memoryInitializerRequestURL);if(xt)Ze=xt.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+Ge.status+", retrying "+j),wn();return}}Ct(Ze)};e.memoryInitializerRequest.response?setTimeout(xr,0):e.memoryInitializerRequest.addEventListener("load",xr)}else wn()}}var Hn;Se=function Ge(){Hn||gs(),Hn||(Se=Ge)};function gs(Ge){if(we>0||(Xe(),we>0))return;function Ze(){Hn||(Hn=!0,!S&&(Tt(),yt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),ut()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),Ze()},1)):Ze()}e.run=gs;function Jr(Ge){throw e.onAbort&&e.onAbort(Ge),Ge+="",a(Ge),l(Ge),S=!0,"abort("+Ge+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Jr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return gs(),n}(typeof kn=="object"?kn:{}),hn="number",rn=hn,n0=hn,un=hn,cn=hn,Pr=hn,Bt=hn,Ree=[["sizeOfH3Index",hn],["sizeOfLatLng",hn],["sizeOfCellBoundary",hn],["sizeOfGeoLoop",hn],["sizeOfGeoPolygon",hn],["sizeOfLinkedGeoPolygon",hn],["sizeOfCoordIJ",hn],["readInt64AsDoubleFromPointer",hn],["isValidCell",n0,[un,cn]],["latLngToCell",rn,[hn,hn,Pr,Bt]],["cellToLatLng",rn,[un,cn,Bt]],["cellToBoundary",rn,[un,cn,Bt]],["maxGridDiskSize",rn,[hn,Bt]],["gridDisk",rn,[un,cn,hn,Bt]],["gridDiskDistances",rn,[un,cn,hn,Bt,Bt]],["gridRingUnsafe",rn,[un,cn,hn,Bt]],["maxPolygonToCellsSize",rn,[Bt,Pr,hn,Bt]],["polygonToCells",rn,[Bt,Pr,hn,Bt]],["maxPolygonToCellsSizeExperimental",rn,[Bt,Pr,hn,Bt]],["polygonToCellsExperimental",rn,[Bt,Pr,hn,hn,hn,Bt]],["cellsToLinkedMultiPolygon",rn,[Bt,hn,Bt]],["destroyLinkedMultiPolygon",null,[Bt]],["compactCells",rn,[Bt,Bt,hn,hn]],["uncompactCells",rn,[Bt,hn,hn,Bt,hn,Pr]],["uncompactCellsSize",rn,[Bt,hn,hn,Pr,Bt]],["isPentagon",n0,[un,cn]],["isResClassIII",n0,[un,cn]],["getBaseCellNumber",hn,[un,cn]],["getResolution",hn,[un,cn]],["maxFaceCount",rn,[un,cn,Bt]],["getIcosahedronFaces",rn,[un,cn,Bt]],["cellToParent",rn,[un,cn,Pr,Bt]],["cellToChildren",rn,[un,cn,Pr,Bt]],["cellToCenterChild",rn,[un,cn,Pr,Bt]],["cellToChildrenSize",rn,[un,cn,Pr,Bt]],["cellToChildPos",rn,[un,cn,Pr,Bt]],["childPosToCell",rn,[hn,hn,un,cn,Pr,Bt]],["areNeighborCells",rn,[un,cn,un,cn,Bt]],["cellsToDirectedEdge",rn,[un,cn,un,cn,Bt]],["getDirectedEdgeOrigin",rn,[un,cn,Bt]],["getDirectedEdgeDestination",rn,[un,cn,Bt]],["isValidDirectedEdge",n0,[un,cn]],["directedEdgeToCells",rn,[un,cn,Bt]],["originToDirectedEdges",rn,[un,cn,Bt]],["directedEdgeToBoundary",rn,[un,cn,Bt]],["gridDistance",rn,[un,cn,un,cn,Bt]],["gridPathCells",rn,[un,cn,un,cn,Bt]],["gridPathCellsSize",rn,[un,cn,un,cn,Bt]],["cellToLocalIj",rn,[un,cn,un,cn,hn,Bt]],["localIjToCell",rn,[un,cn,Bt,hn,Bt]],["getHexagonAreaAvgM2",rn,[Pr,Bt]],["getHexagonAreaAvgKm2",rn,[Pr,Bt]],["getHexagonEdgeLengthAvgM",rn,[Pr,Bt]],["getHexagonEdgeLengthAvgKm",rn,[Pr,Bt]],["greatCircleDistanceM",hn,[Bt,Bt]],["greatCircleDistanceKm",hn,[Bt,Bt]],["greatCircleDistanceRads",hn,[Bt,Bt]],["cellAreaM2",rn,[un,cn,Bt]],["cellAreaKm2",rn,[un,cn,Bt]],["cellAreaRads2",rn,[un,cn,Bt]],["edgeLengthM",rn,[un,cn,Bt]],["edgeLengthKm",rn,[un,cn,Bt]],["edgeLengthRads",rn,[un,cn,Bt]],["getNumCells",rn,[Pr,Bt]],["getRes0Cells",rn,[Bt]],["res0CellCount",hn],["getPentagons",rn,[hn,Bt]],["pentagonCount",hn],["cellToVertex",rn,[un,cn,hn,Bt]],["cellToVertexes",rn,[un,cn,Bt]],["vertexToLatLng",rn,[un,cn,Bt]],["isValidVertex",n0,[un,cn]]],Nee=0,Pee=1,Lee=2,Dee=3,U9=4,Iee=5,Bee=6,Fee=7,Uee=8,Oee=9,kee=10,Vee=11,Gee=12,qee=13,zee=14,Hee=15,Zr={};Zr[Nee]="Success";Zr[Pee]="The operation failed but a more specific error is not available";Zr[Lee]="Argument was outside of acceptable range";Zr[Dee]="Latitude or longitude arguments were outside of acceptable range";Zr[U9]="Resolution argument was outside of acceptable range";Zr[Iee]="Cell argument was not valid";Zr[Bee]="Directed edge argument was not valid";Zr[Fee]="Undirected edge argument was not valid";Zr[Uee]="Vertex argument was not valid";Zr[Oee]="Pentagon distortion was encountered";Zr[kee]="Duplicate input";Zr[Vee]="Cell arguments were not neighbors";Zr[Gee]="Cell arguments had incompatible resolutions";Zr[qee]="Memory allocation failed";Zr[zee]="Bounds of provided memory were insufficient";Zr[Hee]="Mode or flags argument was not valid";var $ee=1e3,O9=1001,k9=1002,d2={};d2[$ee]="Unknown unit";d2[O9]="Array length out of bounds";d2[k9]="Got unexpected null value for H3 index";var Wee="Unknown error";function V9(n,e,t){var i=t&&"value"in t,r=new Error((n[e]||Wee)+" (code: "+e+(i?", value: "+t.value:"")+")");return r.code=e,r}function G9(n,e){var t=arguments.length===2?{value:e}:{};return V9(Zr,n,t)}function q9(n,e){var t=arguments.length===2?{value:e}:{};return V9(d2,n,t)}function Dd(n){if(n!==0)throw G9(n)}var Zs={};Ree.forEach(function(e){Zs[e[0]]=kn.cwrap.apply(kn,e)});var pf=16,Id=4,fA=8,jee=8,wg=Zs.sizeOfH3Index(),T4=Zs.sizeOfLatLng(),Xee=Zs.sizeOfCellBoundary(),Qee=Zs.sizeOfGeoPolygon(),q0=Zs.sizeOfGeoLoop();Zs.sizeOfLinkedGeoPolygon();Zs.sizeOfCoordIJ();function Yee(n){if(typeof n!="number"||n<0||n>15||Math.floor(n)!==n)throw G9(U9,n);return n}function Zee(n){if(!n)throw q9(k9);return n}var Kee=Math.pow(2,32)-1;function Jee(n){if(n>Kee)throw q9(O9,n);return n}var ete=/[^0-9a-fA-F]/;function z9(n){if(Array.isArray(n)&&n.length===2&&Number.isInteger(n[0])&&Number.isInteger(n[1]))return n;if(typeof n!="string"||ete.test(n))return[0,0];var e=parseInt(n.substring(0,n.length-8),pf),t=parseInt(n.substring(n.length-8),pf);return[t,e]}function sS(n){if(n>=0)return n.toString(pf);n=n&2147483647;var e=H9(8,n.toString(pf)),t=(parseInt(e[0],pf)+8).toString(pf);return e=t+e.substring(1),e}function tte(n,e){return sS(e)+H9(8,sS(n))}function H9(n,e){for(var t=n-e.length,i="",r=0;r<t;r++)i+="0";return i=i+e,i}function oS(n,e,t){for(var i=n.length,r=kn._calloc(i,T4),s=t?1:0,o=t?0:1,a=0;a<i*2;a+=2)kn.HEAPF64.set([n[a/2][s],n[a/2][o]].map(X9),r/fA+a);return kn.HEAPU32.set([i,r],e/Id),e}function nte(n,e){var t=n.length-1,i=kn._calloc(Qee),r=0,s=r+q0,o=s+Id;oS(n[0],i+r,e);var a;if(t>0){a=kn._calloc(t,q0);for(var l=0;l<t;l++)oS(n[l+1],a+q0*l,e)}return kn.setValue(i+s,t,"i32"),kn.setValue(i+o,a,"i32"),i}function ite(n){var e=0,t=e+q0,i=t+Id,r=Id;kn._free(kn.getValue(n+e+r,"i8*"));var s=kn.getValue(n+t,"i32");if(s>0){for(var o=kn.getValue(n+i,"i32"),a=0;a<s;a++)kn._free(kn.getValue(o+q0*a+r,"i8*"));kn._free(o)}kn._free(n)}function $9(n,e){e===void 0&&(e=0);var t=kn.getValue(n+wg*e,"i32"),i=kn.getValue(n+wg*e+Id,"i32");return i?tte(t,i):null}function rte(n){return Zs.readInt64AsDoubleFromPointer(n)}function ste(n,e){for(var t=[],i=0;i<e;i++){var r=$9(n,i);r!==null&&t.push(r)}return t}function Sg(n){return cte(kn.getValue(n,"double"))}function ote(n){return[Sg(n),Sg(n+fA)]}function ate(n){return[Sg(n+fA),Sg(n)]}function lte(n,e,t){for(var i=kn.getValue(n,"i32"),r=n+fA,s=[],o=ate,a=0;a<i*2;a+=2)s.push(o(r+fA*a));return s.push(s[0]),s}function ute(n,e,t){var i=kn._malloc(T4);kn.HEAPF64.set([n,e].map(X9),i/fA);var r=kn._malloc(wg);try{return Dd(Zs.latLngToCell(i,t,r)),Zee($9(r))}finally{kn._free(r),kn._free(i)}}function W9(n){var e=kn._malloc(T4),t=z9(n),i=t[0],r=t[1];try{return Dd(Zs.cellToLatLng(i,r,e)),ote(e)}finally{kn._free(e)}}function j9(n,e){var t=kn._malloc(Xee),i=z9(n),r=i[0],s=i[1];try{return Dd(Zs.cellToBoundary(r,s,t)),lte(t,e,e)}finally{kn._free(t)}}function aS(n,e,t){if(Yee(e),t=!!t,n.length===0||n[0].length===0)return[];var i=typeof n[0][0]=="number"?[n]:n,r=nte(i,t),s=kn._malloc(jee);try{Dd(Zs.maxPolygonToCellsSize(r,e,0,s));var o=Jee(rte(s)),a=kn._calloc(o,wg);try{return Dd(Zs.polygonToCells(r,e,0,a)),ste(a,o)}finally{kn._free(a)}}finally{kn._free(s),ite(r)}}function X9(n){return n*Math.PI/180}function cte(n){return n*180/Math.PI}function hte(n){return n=Math.max(0,Math.min(1,n)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+n*(1172.33-n*(10793.56-n*(33300.12-n*(38394.49-n*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+n*(557.33+n*(1225.33-n*(3574.96-n*(1073.77+n*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+n*(3211.1-n*(15327.97-n*(27814-n*(22569.18-n*6838.66)))))))+")"}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const fte=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveMap","envMap","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class Ate{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=fte,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const t=e.getMRT();return t!==null&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:i,material:r,object:s}=e;if(t={material:this.getMaterialData(r),geometry:{id:i.id,attributes:this.getAttributesData(i.attributes),indexVersion:i.index?i.index.version:null,drawRange:{start:i.drawRange.start,count:i.drawRange.count}},worldMatrix:s.matrixWorld.clone()},s.center&&(t.center=s.center.clone()),s.morphTargetInfluences&&(t.morphTargetInfluences=s.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:o,height:a}=e.context;t.bufferWidth=o,t.bufferHeight=a}this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const i in e){const r=e[i];t[i]={version:r.version}}return t}containsNode(e){const t=e.material;for(const i in t)if(t[i]&&t[i].isNode)return!0;return e.renderer.overrideNodes.modelViewMatrix!==null||e.renderer.overrideNodes.modelNormalViewMatrix!==null}getMaterialData(e){const t={};for(const i of this.refreshUniforms){const r=e[i];r!=null&&(typeof r=="object"&&r.clone!==void 0?r.isTexture===!0?t[i]={id:r.id,version:r.version}:t[i]=r.clone():t[i]=r)}return t}equals(e){const{object:t,material:i,geometry:r}=e,s=this.getRenderObjectData(e);if(s.worldMatrix.equals(t.matrixWorld)!==!0)return s.worldMatrix.copy(t.matrixWorld),!1;const o=s.material;for(const S in o){const T=o[S],w=i[S];if(T.equals!==void 0){if(T.equals(w)===!1)return T.copy(w),!1}else if(w.isTexture===!0){if(T.id!==w.id||T.version!==w.version)return T.id=w.id,T.version=w.version,!1}else if(T!==w)return o[S]=w,!1}if(o.transmission>0){const{width:S,height:T}=e.context;if(s.bufferWidth!==S||s.bufferHeight!==T)return s.bufferWidth=S,s.bufferHeight=T,!1}const a=s.geometry,l=r.attributes,u=a.attributes,A=Object.keys(u),p=Object.keys(l);if(a.id!==r.id)return a.id=r.id,!1;if(A.length!==p.length)return s.geometry.attributes=this.getAttributesData(l),!1;for(const S of A){const T=u[S],w=l[S];if(w===void 0)return delete u[S],!1;if(T.version!==w.version)return T.version=w.version,!1}const g=r.index,v=a.indexVersion,x=g?g.version:null;if(v!==x)return a.indexVersion=x,!1;if(a.drawRange.start!==r.drawRange.start||a.drawRange.count!==r.drawRange.count)return a.drawRange.start=r.drawRange.start,a.drawRange.count=r.drawRange.count,!1;if(s.morphTargetInfluences){let S=!1;for(let T=0;T<s.morphTargetInfluences.length;T++)s.morphTargetInfluences[T]!==t.morphTargetInfluences[T]&&(S=!0);if(S)return!0}return s.center&&s.center.equals(t.center)===!1?(s.center.copy(t.center),!0):(e.bundle!==null&&(s.version=e.bundle.version),!0)}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:i}=t;if(this.renderId!==i)return this.renderId=i,!0;const r=e.object.static===!0,s=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;return r||s?!1:this.equals(e)!==!0}}function Bd(n,e=0){let t=3735928559^e,i=1103547991^e;if(n instanceof Array)for(let r=0,s;r<n.length;r++)s=n[r],t=Math.imul(t^s,2654435761),i=Math.imul(i^s,1597334677);else for(let r=0,s;r<n.length;r++)s=n.charCodeAt(r),t=Math.imul(t^s,2654435761),i=Math.imul(i^s,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507),i^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&i)+(t>>>0)}const Q9=n=>Bd(n),p2=n=>Bd(n),Fd=(...n)=>Bd(n);function Y9(n,e=!1){const t=[];n.isNode===!0&&(t.push(n.id),n=n.getSelf());for(const{property:i,childNode:r}of Tg(n))t.push(Bd(i.slice(0,-4)),r.getCacheKey(e));return Bd(t)}function*Tg(n,e=!1){for(const t in n){if(t.startsWith("_")===!0)continue;const i=n[t];if(Array.isArray(i)===!0)for(let r=0;r<i.length;r++){const s=i[r];s&&(s.isNode===!0||e&&typeof s.toJSON=="function")&&(yield{property:t,index:r,childNode:s})}else if(i&&i.isNode===!0)yield{property:t,childNode:i};else if(typeof i=="object")for(const r in i){const s=i[r];s&&(s.isNode===!0||e&&typeof s.toJSON=="function")&&(yield{property:t,index:r,childNode:s})}}}const dte=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),lS=new WeakMap;function Z9(n){return dte.get(n)}function Mg(n){if(/[iu]?vec\d/.test(n))return n.startsWith("ivec")?Int32Array:n.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(n)||/float/.test(n))return Float32Array;if(/uint/.test(n))return Uint32Array;if(/int/.test(n))return Int32Array;throw new Error(`THREE.NodeUtils: Unsupported type: ${n}`)}function M4(n){if(/float|int|uint/.test(n))return 1;if(/vec2/.test(n))return 2;if(/vec3/.test(n))return 3;if(/vec4/.test(n)||/mat2/.test(n))return 4;if(/mat3/.test(n))return 9;if(/mat4/.test(n))return 16;console.error("THREE.TSL: Unsupported type:",n)}function Cu(n){if(n==null)return null;const e=typeof n;return n.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":n.isVector2===!0?"vec2":n.isVector3===!0?"vec3":n.isVector4===!0?"vec4":n.isMatrix2===!0?"mat2":n.isMatrix3===!0?"mat3":n.isMatrix4===!0?"mat4":n.isColor===!0?"color":n instanceof ArrayBuffer?"ArrayBuffer":null}function K9(n,...e){const t=n?n.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),n==="color"?new Ft(...e):t==="vec2"?new at(...e):t==="vec3"?new ie(...e):t==="vec4"?new $t(...e):t==="mat2"?new c2(...e):t==="mat3"?new dn(...e):t==="mat4"?new en(...e):n==="bool"?e[0]||!1:n==="float"||n==="int"||n==="uint"?e[0]||0:n==="string"?e[0]||"":n==="ArrayBuffer"?tC(e[0]):null}function J9(n){let e=lS.get(n);return e===void 0&&(e={},lS.set(n,e)),e}function eC(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function tC(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0)).buffer}const My={VERTEX:"vertex",FRAGMENT:"fragment"},mn={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},pte={BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},fs={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},nC=["fragment","vertex"],Ey=["setup","analyze","generate"],Cy=[...nC,"compute"],hh=["x","y","z","w"];let mte=0;class jt extends sl{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=mn.NONE,this.updateBeforeType=mn.NONE,this.updateAfterType=mn.NONE,this.uuid=Hx.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:mte++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,mn.FRAME)}onRenderUpdate(e){return this.onUpdate(e,mn.RENDER)}onObjectUpdate(e){return this.onUpdate(e,mn.OBJECT)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of Tg(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return e=e||this.version!==this._cacheKeyVersion,(e===!0||this._cacheKey===null)&&(this._cacheKey=Fd(Y9(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);let i=0;for(const r of this.getChildren())t["node"+i++]=r;return t.outputNode||null}analyze(e){if(e.increaseUsage(this)===1){const i=e.getNodeProperties(this);for(const r of Object.values(i))r&&r.isNode===!0&&r.build(e)}}generate(e,t){const{outputNode:i}=e.getNodeProperties(this);if(i&&i.isNode===!0)return i.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const i=this.getShared(e);if(this!==i)return i.build(e,t);e.addNode(this),e.addChain(this);let r=null;const s=e.getBuildStage();if(s==="setup"){this.updateReference(e);const o=e.getNodeProperties(this);if(o.initialized!==!0){o.initialized=!0;const a=this.setup(e),l=a&&a.isNode===!0;for(const u of Object.values(o))if(u&&u.isNode===!0){if(u.parents===!0){const A=e.getNodeProperties(u);A.parents=A.parents||[],A.parents.push(this)}u.build(e)}l&&a.build(e),o.outputNode=a}r=o.outputNode||null}else if(s==="analyze")this.analyze(e);else if(s==="generate")if(this.generate.length===1){const a=this.getNodeType(e),l=e.getDataFromNode(this);r=l.snippet,r===void 0?l.generated===void 0?(l.generated=!0,r=this.generate(e)||"",l.snippet=r):(console.warn("THREE.Node: Recursion detected.",this),r=""):l.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),r=e.format(r,a,t)}else r=this.generate(e,t)||"";return e.removeChain(this),e.addSequentialNode(this),r}getSerializeChildren(){return Tg(this)}serialize(e){const t=this.getSerializeChildren(),i={};for(const{property:r,index:s,childNode:o}of t)s!==void 0?(i[r]===void 0&&(i[r]=Number.isInteger(s)?[]:{}),i[r][s]=o.toJSON(e.meta).uuid):i[r]=o.toJSON(e.meta).uuid;Object.keys(i).length>0&&(e.inputNodes=i)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const i in e.inputNodes)if(Array.isArray(e.inputNodes[i])){const r=[];for(const s of e.inputNodes[i])r.push(t[s]);this[i]=r}else if(typeof e.inputNodes[i]=="object"){const r={};for(const s in e.inputNodes[i]){const o=e.inputNodes[i][s];r[s]=t[o]}this[i]=r}else{const r=e.inputNodes[i];this[i]=t[r]}}}toJSON(e){const{uuid:t,type:i}=this,r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{},nodes:{}});let s=e.nodes[t];s===void 0&&(s={uuid:t,type:i,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},r!==!0&&(e.nodes[s.uuid]=s),this.serialize(s),delete s.meta);function o(a){const l=[];for(const u in a){const A=a[u];delete A.metadata,l.push(A)}return l}if(r){const a=o(e.textures),l=o(e.images),u=o(e.nodes);a.length>0&&(s.textures=a),l.length>0&&(s.images=l),u.length>0&&(s.nodes=u)}return s}}class fh extends jt{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.indexNode.getNodeType(e),i=this.node.build(e),r=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return`${i}[ ${r} ]`}}class iC extends jt{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let i=null;for(const r of this.convertTo.split("|"))(i===null||e.getTypeLength(t)===e.getTypeLength(r))&&(i=r);return i}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const i=this.node,r=this.getNodeType(e),s=i.build(e,r);return e.format(s,r,t)}}class or extends jt{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const r=e.getVectorType(this.getNodeType(e,t)),s=e.getDataFromNode(this);if(s.propertyName!==void 0)return e.format(s.propertyName,r,t);if(r!=="void"&&t!=="void"&&this.hasDependencies(e)){const o=super.build(e,r),a=e.getVarFromNode(this,null,r),l=e.getPropertyName(a);return e.addLineFlowCode(`${l} = ${o}`,this),s.snippet=o,s.propertyName=l,e.format(s.propertyName,r,t)}}return super.build(e,t)}}class gte extends or{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,i)=>t+e.getTypeLength(i.getNodeType(e)),0))}generate(e,t){const i=this.getNodeType(e),r=e.getTypeLength(i),s=this.nodes,o=e.getComponentType(i),a=[];let l=0;for(const A of s){if(l>=r){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${i}()' type.`);break}let p=A.getNodeType(e),g=e.getTypeLength(p),v;l+g>r&&(console.error(`THREE.TSL: Length of '${i}()' data exceeds maximum length of output type.`),g=r-l,p=e.getTypeFromLength(g)),l+=g,v=A.build(e,p);const x=e.getComponentType(p);x!==o&&(v=e.format(v,x,o)),a.push(v)}const u=`${e.getType(i)}( ${a.join(", ")} )`;return e.format(u,i,t)}}const _te=hh.join("");class Ry extends jt{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(hh.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const i=this.node,r=e.getTypeLength(i.getNodeType(e));let s=null;if(r>1){let o=null;this.getVectorLength()>=r&&(o=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const l=i.build(e,o);this.components.length===r&&this.components===_te.slice(0,this.components.length)?s=e.format(l,o,t):s=e.format(`${l}.${this.components}`,this.getNodeType(e),t)}else s=i.build(e,t);return s}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class vte extends or{static get type(){return"SetNode"}constructor(e,t,i){super(),this.sourceNode=e,this.components=t,this.targetNode=i}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:i,targetNode:r}=this,s=this.getNodeType(e),o=e.getComponentType(r.getNodeType(e)),a=e.getTypeFromLength(i.length,o),l=r.build(e,a),u=t.build(e,s),A=e.getTypeLength(s),p=[];for(let g=0;g<A;g++){const v=hh[g];v===i[0]?(p.push(l),g+=i.length-1):p.push(u+"."+v)}return`${e.getType(s)}( ${p.join(", ")} )`}}class yte extends or{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:i}=this,r=this.getNodeType(e),s=i.build(e),o=e.getVarFromNode(this),a=e.getPropertyName(o);e.addLineFlowCode(a+" = "+s,this);const l=e.getTypeLength(r),u=[];let A=0;for(let p=0;p<l;p++){const g=hh[p];g===t[A]?(u.push("1.0 - "+(a+"."+g)),A++):u.push(a+"."+g)}return`${e.getType(r)}( ${u.join(", ")} )`}}class E4 extends jt{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?Cu(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Cu(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=eC(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?K9(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const uS=/float|u?int/;class ba extends E4{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const i=this.getNodeType(e);return uS.test(i)&&uS.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),i,t)}}class xte extends jt{static get type(){return"MemberNode"}constructor(e,t){super(),this.node=e,this.property=t,this.isMemberNode=!0}getNodeType(e){return this.node.getMemberType(e,this.property)}generate(e){return this.node.build(e)+"."+this.property}}let ah=null;const mf=new Map;function He(n,e){if(mf.has(n)){console.warn(`THREE.TSL: Redefinition of method chaining '${n}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${n} is not a function`);mf.set(n,e)}const rC=n=>n.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),cS=n=>rC(n).split("").sort().join(""),sC={setup(n,e){const t=e.shift();return n(up(t),...e)},get(n,e,t){if(typeof e=="string"&&n[e]===void 0){if(n.isStackNode!==!0&&e==="assign")return(...i)=>(ah.assign(t,...i),t);if(mf.has(e)){const i=mf.get(e);return n.isStackNode?(...r)=>t.add(i(...r)):(...r)=>i(t,...r)}else{if(e==="self")return n;if(e.endsWith("Assign")&&mf.has(e.slice(0,e.length-6))){const i=mf.get(e.slice(0,e.length-6));return n.isStackNode?(...r)=>t.assign(r[0],i(...r)):(...r)=>t.assign(i(t,...r))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=rC(e),je(new Ry(t,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=cS(e.slice(3).toLowerCase()),i=>je(new vte(n,e,i));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=cS(e.slice(4).toLowerCase()),()=>je(new yte(je(n),e));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),je(new Ry(n,e));if(/^\d+$/.test(e)===!0)return je(new fh(t,new ba(Number(e),"uint")));if(/^get$/.test(e)===!0)return i=>je(new xte(t,i))}}}return Reflect.get(n,e,t)},set(n,e,t,i){return typeof e=="string"&&n[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(i[e].assign(t),!0):Reflect.set(n,e,t,i)}},M3=new WeakMap,hS=new WeakMap,bte=function(n,e=null){const t=Cu(n);if(t==="node"){let i=M3.get(n);return i===void 0&&(i=new Proxy(n,sC),M3.set(n,i),M3.set(i,i)),i}else{if(e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string")return je(Ny(n,e));if(t==="shader")return Re(n)}return n},wte=function(n,e=null){for(const t in n)n[t]=je(n[t],e);return n},Ste=function(n,e=null){const t=n.length;for(let i=0;i<t;i++)n[i]=je(n[i],e);return n},Tte=function(n,e=null,t=null,i=null){const r=A=>je(i!==null?Object.assign(A,i):A);let s,o=e,a,l;function u(A){let p;return o?p=/[a-z]/i.test(o)?o+"()":o:p=n.type,a!==void 0&&A.length<a?(console.error(`THREE.TSL: "${p}" parameter length is less than minimum required.`),A.concat(new Array(a-A.length).fill(0))):l!==void 0&&A.length>l?(console.error(`THREE.TSL: "${p}" parameter length exceeds limit.`),A.slice(0,l)):A}return e===null?s=(...A)=>r(new n(...qc(u(A)))):t!==null?(t=je(t),s=(...A)=>r(new n(e,...qc(u(A)),t))):s=(...A)=>r(new n(e,...qc(u(A)))),s.setParameterLength=(...A)=>(A.length===1?a=l=A[0]:A.length===2&&([a,l]=A),s),s.setName=A=>(o=A,s),s},Mte=function(n,...e){return je(new n(...qc(e)))};class Ete extends jt{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,inputNodes:i}=this,r=e.getNodeProperties(t);if(r.onceOutput)return r.onceOutput;let s=null;if(t.layout){let o=hS.get(e.constructor);o===void 0&&(o=new WeakMap,hS.set(e.constructor,o));let a=o.get(t);a===void 0&&(a=je(e.buildFunctionNode(t)),o.set(t,a)),e.addInclude(a),s=je(a.call(i))}else{const o=t.jsFunc,a=i!==null||o.length>1?o(i||[],e):o(e);s=je(a)}return t.once&&(r.onceOutput=s),s}getOutputNode(e){const t=e.getNodeProperties(this);return t.outputNode===null&&(t.outputNode=this.setupOutput(e)),t.outputNode}setup(e){return this.getOutputNode(e)}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,t){return this.getOutputNode(e).build(e,t)}}class Cte extends jt{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return up(e),je(new Ete(this,e))}setup(){return this.call()}}const Rte=[!1,!0],Nte=[0,1,2,3],Pte=[-1,-2],oC=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],C4=new Map;for(const n of Rte)C4.set(n,new ba(n));const R4=new Map;for(const n of Nte)R4.set(n,new ba(n,"uint"));const N4=new Map([...R4].map(n=>new ba(n.value,"int")));for(const n of Pte)N4.set(n,new ba(n,"int"));const m2=new Map([...N4].map(n=>new ba(n.value)));for(const n of oC)m2.set(n,new ba(n));for(const n of oC)m2.set(-n,new ba(-n));const g2={bool:C4,uint:R4,ints:N4,float:m2},fS=new Map([...C4,...m2]),Ny=(n,e)=>fS.has(n)?fS.get(n):n.isNode===!0?n:new ba(n,e),Lte=n=>{try{return n.getNodeType()}catch{return}},yr=function(n,e=null){return(...t)=>{if((t.length===0||!["bool","float","int","uint"].includes(n)&&t.every(r=>typeof r!="object"))&&(t=[K9(n,...t)]),t.length===1&&e!==null&&e.has(t[0]))return je(e.get(t[0]));if(t.length===1){const r=Ny(t[0],n);return Lte(r)===n?je(r):je(new iC(r,n))}const i=t.map(r=>Ny(r));return je(new gte(i,n))}},Ud=n=>typeof n=="object"&&n!==null?n.value:n,aC=n=>n!=null?n.nodeType||n.convertTo||(typeof n=="string"?n:null):null;function gf(n,e){return new Proxy(new Cte(n,e),sC)}const je=(n,e=null)=>bte(n,e),up=(n,e=null)=>new wte(n,e),qc=(n,e=null)=>new Ste(n,e),Qe=(...n)=>new Tte(...n),gt=(...n)=>new Mte(...n);let Dte=0;const Re=(n,e=null)=>{let t=null;e!==null&&(typeof e=="object"?t=e.return:(typeof e=="string"?t=e:console.error("THREE.TSL: Invalid layout type."),e=null));const i=new gf(n,t),r=(...s)=>{let o;up(s),s[0]&&s[0].isNode?o=[...s]:o=s[0];const a=i.call(o);return t==="void"&&a.toStack(),a};if(r.shaderNode=i,r.setLayout=s=>(i.setLayout(s),r),r.once=()=>(i.once=!0,r),e!==null){if(typeof e.inputs!="object"){const s={name:"fn"+Dte++,type:t,inputs:[]};for(const o in e)o!=="return"&&s.inputs.push({name:o,type:e[o]});e=s}r.setLayout(e)}return r};He("toGlobal",n=>(n.global=!0,n));const Od=n=>{ah=n},P4=()=>ah,bn=(...n)=>ah.If(...n),Ite=(...n)=>ah.Switch(...n);function _2(n){return ah&&ah.add(n),n}He("toStack",_2);const lC=new yr("color"),re=new yr("float",g2.float),de=new yr("int",g2.ints),Et=new yr("uint",g2.uint),Hl=new yr("bool",g2.bool),Je=new yr("vec2"),Sr=new yr("ivec2"),uC=new yr("uvec2"),cC=new yr("bvec2"),xe=new yr("vec3"),hC=new yr("ivec3"),MA=new yr("uvec3"),L4=new yr("bvec3"),zt=new yr("vec4"),fC=new yr("ivec4"),AC=new yr("uvec4"),dC=new yr("bvec4"),v2=new yr("mat2"),ps=new yr("mat3"),zc=new yr("mat4"),Bte=(n="")=>je(new ba(n,"string")),Fte=n=>je(new ba(n,"ArrayBuffer"));He("toColor",lC);He("toFloat",re);He("toInt",de);He("toUint",Et);He("toBool",Hl);He("toVec2",Je);He("toIVec2",Sr);He("toUVec2",uC);He("toBVec2",cC);He("toVec3",xe);He("toIVec3",hC);He("toUVec3",MA);He("toBVec3",L4);He("toVec4",zt);He("toIVec4",fC);He("toUVec4",AC);He("toBVec4",dC);He("toMat2",v2);He("toMat3",ps);He("toMat4",zc);const pC=Qe(fh).setParameterLength(2),mC=(n,e)=>je(new iC(je(n),e)),Ute=(n,e)=>je(new Ry(je(n),e));He("element",pC);He("convert",mC);const Ote=n=>(console.warn("THREE.TSL: append() has been renamed to Stack()."),_2(n));He("append",n=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),_2(n)));const kte=(...n)=>(console.warn("THREE.TSL: tslFn() has been renamed to Fn()."),Re(...n));class si extends jt{static get type(){return"PropertyNode"}constructor(e,t=null,i=!1){super(e),this.name=t,this.varying=i,this.isPropertyNode=!0}getHash(e){return this.name||super.getHash(e)}isGlobal(){return!0}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const EA=(n,e)=>je(new si(n,e)),kd=(n,e)=>je(new si(n,e,!0)),Kn=gt(si,"vec4","DiffuseColor"),Py=gt(si,"vec3","EmissiveColor"),Va=gt(si,"float","Roughness"),Vd=gt(si,"float","Metalness"),Eg=gt(si,"float","Clearcoat"),Gd=gt(si,"float","ClearcoatRoughness"),Ic=gt(si,"vec3","Sheen"),y2=gt(si,"float","SheenRoughness"),x2=gt(si,"float","Iridescence"),D4=gt(si,"float","IridescenceIOR"),I4=gt(si,"float","IridescenceThickness"),Cg=gt(si,"float","AlphaT"),wu=gt(si,"float","Anisotropy"),z0=gt(si,"vec3","AnisotropyT"),Hc=gt(si,"vec3","AnisotropyB"),Vs=gt(si,"color","SpecularColor"),qd=gt(si,"float","SpecularF90"),Rg=gt(si,"float","Shininess"),If=gt(si,"vec4","Output"),x1=gt(si,"float","dashSize"),Ly=gt(si,"float","gapSize"),Vte=gt(si,"float","pointWidth"),H0=gt(si,"float","IOR"),Ng=gt(si,"float","Transmission"),B4=gt(si,"float","Thickness"),F4=gt(si,"float","AttenuationDistance"),U4=gt(si,"color","AttenuationColor"),O4=gt(si,"float","Dispersion");class gC extends jt{static get type(){return"UniformGroupNode"}constructor(e,t=!1,i=1){super("string"),this.name=e,this.shared=t,this.order=i,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const _C=n=>new gC(n),b2=(n,e=0)=>new gC(n,!0,e),vC=b2("frame"),Xt=b2("render"),k4=_C("object");class cp extends E4{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=k4}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){const i=this.getSelf();return e=e.bind(i),super.onUpdate(r=>{const s=e(r,i);s!==void 0&&(this.value=s)},t)}generate(e,t){const i=this.getNodeType(e),r=this.getUniformHash(e);let s=e.getNodeFromHash(r);s===void 0&&(e.setHashNode(this,r),s=this);const o=s.getInputType(e),a=e.getUniformFromNode(s,o,e.shaderStage,this.name||e.context.label),l=e.getPropertyName(a);return e.context.label!==void 0&&delete e.context.label,e.format(l,i,t)}}const qt=(n,e)=>{const t=aC(e||n),i=n&&n.isNode===!0?n.node&&n.node.value||n.value:n;return je(new cp(i,t))};class AS extends or{static get type(){return"ArrayNode"}constructor(e,t,i=null){super(e),this.count=t,this.values=i,this.isArrayNode=!0}getNodeType(e){return this.nodeType===null&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const yC=(...n)=>{let e;if(n.length===1){const t=n[0];e=new AS(null,t.length,t)}else{const t=n[0],i=n[1];e=new AS(t,i)}return je(e)};He("toArray",(n,e)=>yC(Array(e).fill(n)));class Gte extends or{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const i=e.getTypeLength(t.node.getNodeType(e));return hh.join("").slice(0,i)!==t.components}return!1}generate(e,t){const{targetNode:i,sourceNode:r}=this,s=this.needsSplitAssign(e),o=i.getNodeType(e),a=i.context({assign:!0}).build(e),l=r.build(e,o),u=r.getNodeType(e),A=e.getDataFromNode(this);let p;if(A.initialized===!0)t!=="void"&&(p=a);else if(s){const g=e.getVarFromNode(this,null,o),v=e.getPropertyName(g);e.addLineFlowCode(`${v} = ${l}`,this);const x=i.node.context({assign:!0}).build(e);for(let S=0;S<i.components.length;S++){const T=i.components[S];e.addLineFlowCode(`${x}.${T} = ${v}[ ${S} ]`,this)}t!=="void"&&(p=a)}else p=`${a} = ${l}`,(t==="void"||u==="void")&&(e.addLineFlowCode(p,this),t!=="void"&&(p=a));return A.initialized=!0,e.format(p,o,t)}}const xC=Qe(Gte).setParameterLength(2);He("assign",xC);class qte extends or{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const t=[],i=this.functionNode,r=i.getInputs(e),s=this.parameters,o=(l,u)=>{const A=u.type,p=A==="pointer";let g;return p?g="&"+l.build(e):g=l.build(e,A),g};if(Array.isArray(s)){if(s.length>r.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),s.length=r.length;else if(s.length<r.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");s.length<r.length;)s.push(re(0));for(let l=0;l<s.length;l++)t.push(o(s[l],r[l]))}else for(const l of r){const u=s[l.name];u!==void 0?t.push(o(u,l)):(console.error(`THREE.TSL: Input '${l.name}' not found in 'Fn()'.`),t.push(o(re(0),l)))}return`${i.build(e,"property")}( ${t.join(", ")} )`}}const bC=(n,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?qc(e):up(e[0]),je(new qte(je(n),e)));He("call",bC);const zte={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class qi extends or{static get type(){return"OperatorNode"}constructor(e,t,i,...r){if(super(),r.length>0){let s=new qi(e,t,i);for(let o=0;o<r.length-1;o++)s=new qi(e,s,r[o]);t=s,i=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=i,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(zte[this.op],t)}getNodeType(e){const t=this.op,i=this.aNode,r=this.bNode,s=i.getNodeType(e),o=typeof r<"u"?r.getNodeType(e):null;if(s==="void"||o==="void")return"void";if(t==="%")return s;if(t==="~"||t==="&"||t==="|"||t==="^"||t===">>"||t==="<<")return e.getIntegerType(s);if(t==="!"||t==="&&"||t==="||"||t==="^^")return"bool";if(t==="=="||t==="!="||t==="<"||t===">"||t==="<="||t===">="){const a=Math.max(e.getTypeLength(s),e.getTypeLength(o));return a>1?`bvec${a}`:"bool"}else{if(e.isMatrix(s)){if(o==="float")return s;if(e.isVector(o))return e.getVectorFromMatrix(s);if(e.isMatrix(o))return s}else if(e.isMatrix(o)){if(s==="float")return o;if(e.isVector(s))return e.getVectorFromMatrix(o)}return e.getTypeLength(o)>e.getTypeLength(s)?o:s}}generate(e,t){const i=this.op,r=this.aNode,s=this.bNode,o=this.getNodeType(e);let a=null,l=null;o!=="void"?(a=r.getNodeType(e),l=typeof s<"u"?s.getNodeType(e):null,i==="<"||i===">"||i==="<="||i===">="||i==="=="||i==="!="?e.isVector(a)?l=a:e.isVector(l)?a=l:a!==l&&(a=l="float"):i===">>"||i==="<<"?(a=o,l=e.changeComponentType(l,"uint")):i==="%"?(a=o,l=e.isInteger(a)&&e.isInteger(l)?l:a):e.isMatrix(a)?l==="float"?l="float":e.isVector(l)?l=e.getVectorFromMatrix(a):e.isMatrix(l)||(a=l=o):e.isMatrix(l)?a==="float"?a="float":e.isVector(a)?a=e.getVectorFromMatrix(l):a=l=o:a=l=o):a=l=o;const u=r.build(e,a),A=typeof s<"u"?s.build(e,l):null,p=e.getFunctionOperator(i);if(t!=="void"){const g=e.renderer.coordinateSystem===Is;if(i==="=="||i==="!="||i==="<"||i===">"||i==="<="||i===">=")return g?e.isVector(a)?e.format(`${this.getOperatorMethod(e,t)}( ${u}, ${A} )`,o,t):e.format(`( ${u} ${i} ${A} )`,o,t):e.format(`( ${u} ${i} ${A} )`,o,t);if(i==="%")return e.isInteger(l)?e.format(`( ${u} % ${A} )`,o,t):e.format(`${this.getOperatorMethod(e,o)}( ${u}, ${A} )`,o,t);if(i==="!"||i==="~")return e.format(`(${i}${u})`,a,t);if(p)return e.format(`${p}( ${u}, ${A} )`,o,t);if(e.isMatrix(a)&&l==="float")return e.format(`( ${A} ${i} ${u} )`,o,t);if(a==="float"&&e.isMatrix(l))return e.format(`${u} ${i} ${A}`,o,t);{let v=`( ${u} ${i} ${A} )`;return!g&&o==="bool"&&e.isVector(a)&&e.isVector(l)&&(v=`all${v}`),e.format(v,o,t)}}else if(a!=="void")return p?e.format(`${p}( ${u}, ${A} )`,o,t):e.isMatrix(a)&&l==="float"?e.format(`${A} ${i} ${u}`,o,t):e.format(`${u} ${i} ${A}`,o,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const hr=Qe(qi,"+").setParameterLength(2,1/0).setName("add"),Gn=Qe(qi,"-").setParameterLength(2,1/0).setName("sub"),gn=Qe(qi,"*").setParameterLength(2,1/0).setName("mul"),va=Qe(qi,"/").setParameterLength(2,1/0).setName("div"),hp=Qe(qi,"%").setParameterLength(2).setName("mod"),V4=Qe(qi,"==").setParameterLength(2).setName("equal"),wC=Qe(qi,"!=").setParameterLength(2).setName("notEqual"),SC=Qe(qi,"<").setParameterLength(2).setName("lessThan"),G4=Qe(qi,">").setParameterLength(2).setName("greaterThan"),TC=Qe(qi,"<=").setParameterLength(2).setName("lessThanEqual"),MC=Qe(qi,">=").setParameterLength(2).setName("greaterThanEqual"),EC=Qe(qi,"&&").setParameterLength(2,1/0).setName("and"),CC=Qe(qi,"||").setParameterLength(2,1/0).setName("or"),RC=Qe(qi,"!").setParameterLength(1).setName("not"),NC=Qe(qi,"^^").setParameterLength(2).setName("xor"),PC=Qe(qi,"&").setParameterLength(2).setName("bitAnd"),LC=Qe(qi,"~").setParameterLength(2).setName("bitNot"),DC=Qe(qi,"|").setParameterLength(2).setName("bitOr"),IC=Qe(qi,"^").setParameterLength(2).setName("bitXor"),BC=Qe(qi,"<<").setParameterLength(2).setName("shiftLeft"),FC=Qe(qi,">>").setParameterLength(2).setName("shiftRight"),UC=Re(([n])=>(n.addAssign(1),n)),OC=Re(([n])=>(n.subAssign(1),n)),kC=Re(([n])=>{const e=de(n).toConst();return n.addAssign(1),e}),VC=Re(([n])=>{const e=de(n).toConst();return n.subAssign(1),e});He("add",hr);He("sub",Gn);He("mul",gn);He("div",va);He("mod",hp);He("equal",V4);He("notEqual",wC);He("lessThan",SC);He("greaterThan",G4);He("lessThanEqual",TC);He("greaterThanEqual",MC);He("and",EC);He("or",CC);He("not",RC);He("xor",NC);He("bitAnd",PC);He("bitNot",LC);He("bitOr",DC);He("bitXor",IC);He("shiftLeft",BC);He("shiftRight",FC);He("incrementBefore",UC);He("decrementBefore",OC);He("increment",kC);He("decrement",VC);const GC=(n,e)=>(console.warn('THREE.TSL: "remainder()" is deprecated. Use "mod( int( ... ) )" instead.'),hp(n,e)),qC=(n,e)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),hp(de(n),de(e)));He("remainder",GC);He("modInt",qC);class Le extends or{static get type(){return"MathNode"}constructor(e,t,i=null,r=null){if(super(),(e===Le.MAX||e===Le.MIN)&&arguments.length>3){let s=new Le(e,t,i);for(let o=2;o<arguments.length-1;o++)s=new Le(e,s,arguments[o]);t=s,i=arguments[arguments.length-1],r=null}this.method=e,this.aNode=t,this.bNode=i,this.cNode=r,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),i=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,s=e.isMatrix(t)?0:e.getTypeLength(t),o=e.isMatrix(i)?0:e.getTypeLength(i),a=e.isMatrix(r)?0:e.getTypeLength(r);return s>o&&s>a?t:o>a?i:a>s?r:t}getNodeType(e){const t=this.method;return t===Le.LENGTH||t===Le.DISTANCE||t===Le.DOT?"float":t===Le.CROSS?"vec3":t===Le.ALL||t===Le.ANY?"bool":t===Le.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}generate(e,t){let i=this.method;const r=this.getNodeType(e),s=this.getInputType(e),o=this.aNode,a=this.bNode,l=this.cNode,u=e.renderer.coordinateSystem;if(i===Le.TRANSFORM_DIRECTION){let A=o,p=a;e.isMatrix(A.getNodeType(e))?p=zt(xe(p),0):A=zt(xe(A),0);const g=gn(A,p).xyz;return $l(g).build(e,t)}else{if(i===Le.NEGATE)return e.format("( - "+o.build(e,s)+" )",r,t);if(i===Le.ONE_MINUS)return Gn(1,o).build(e,t);if(i===Le.RECIPROCAL)return va(1,o).build(e,t);if(i===Le.DIFFERENCE)return wi(Gn(o,a)).build(e,t);{const A=[];return i===Le.CROSS?A.push(o.build(e,r),a.build(e,r)):u===Is&&i===Le.STEP?A.push(o.build(e,e.getTypeLength(o.getNodeType(e))===1?"float":s),a.build(e,s)):u===Is&&(i===Le.MIN||i===Le.MAX)?A.push(o.build(e,s),a.build(e,e.getTypeLength(a.getNodeType(e))===1?"float":s)):i===Le.REFRACT?A.push(o.build(e,s),a.build(e,s),l.build(e,"float")):i===Le.MIX?A.push(o.build(e,s),a.build(e,s),l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":s)):(u===Za&&i===Le.ATAN&&a!==null&&(i="atan2"),e.shaderStage!=="fragment"&&(i===Le.DFDX||i===Le.DFDY)&&(console.warn(`THREE.TSL: '${i}' is not supported in the ${e.shaderStage} stage.`),i="/*"+i+"*/"),A.push(o.build(e,s)),a!==null&&A.push(a.build(e,s)),l!==null&&A.push(l.build(e,s))),e.format(`${e.getMethod(i,r)}( ${A.join(", ")} )`,r,t)}}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}Le.ALL="all";Le.ANY="any";Le.RADIANS="radians";Le.DEGREES="degrees";Le.EXP="exp";Le.EXP2="exp2";Le.LOG="log";Le.LOG2="log2";Le.SQRT="sqrt";Le.INVERSE_SQRT="inversesqrt";Le.FLOOR="floor";Le.CEIL="ceil";Le.NORMALIZE="normalize";Le.FRACT="fract";Le.SIN="sin";Le.COS="cos";Le.TAN="tan";Le.ASIN="asin";Le.ACOS="acos";Le.ATAN="atan";Le.ABS="abs";Le.SIGN="sign";Le.LENGTH="length";Le.NEGATE="negate";Le.ONE_MINUS="oneMinus";Le.DFDX="dFdx";Le.DFDY="dFdy";Le.ROUND="round";Le.RECIPROCAL="reciprocal";Le.TRUNC="trunc";Le.FWIDTH="fwidth";Le.TRANSPOSE="transpose";Le.BITCAST="bitcast";Le.EQUALS="equals";Le.MIN="min";Le.MAX="max";Le.STEP="step";Le.REFLECT="reflect";Le.DISTANCE="distance";Le.DIFFERENCE="difference";Le.DOT="dot";Le.CROSS="cross";Le.POW="pow";Le.TRANSFORM_DIRECTION="transformDirection";Le.MIX="mix";Le.CLAMP="clamp";Le.REFRACT="refract";Le.SMOOTHSTEP="smoothstep";Le.FACEFORWARD="faceforward";const zC=re(1e-6),Hte=re(1e6),Pg=re(Math.PI),$te=re(Math.PI*2),HC=Qe(Le,Le.ALL).setParameterLength(1),$C=Qe(Le,Le.ANY).setParameterLength(1),WC=Qe(Le,Le.RADIANS).setParameterLength(1),jC=Qe(Le,Le.DEGREES).setParameterLength(1),q4=Qe(Le,Le.EXP).setParameterLength(1),AA=Qe(Le,Le.EXP2).setParameterLength(1),w2=Qe(Le,Le.LOG).setParameterLength(1),ja=Qe(Le,Le.LOG2).setParameterLength(1),ul=Qe(Le,Le.SQRT).setParameterLength(1),z4=Qe(Le,Le.INVERSE_SQRT).setParameterLength(1),Xa=Qe(Le,Le.FLOOR).setParameterLength(1),S2=Qe(Le,Le.CEIL).setParameterLength(1),$l=Qe(Le,Le.NORMALIZE).setParameterLength(1),Zl=Qe(Le,Le.FRACT).setParameterLength(1),mo=Qe(Le,Le.SIN).setParameterLength(1),Sl=Qe(Le,Le.COS).setParameterLength(1),XC=Qe(Le,Le.TAN).setParameterLength(1),QC=Qe(Le,Le.ASIN).setParameterLength(1),YC=Qe(Le,Le.ACOS).setParameterLength(1),H4=Qe(Le,Le.ATAN).setParameterLength(1,2),wi=Qe(Le,Le.ABS).setParameterLength(1),zd=Qe(Le,Le.SIGN).setParameterLength(1),Fl=Qe(Le,Le.LENGTH).setParameterLength(1),ZC=Qe(Le,Le.NEGATE).setParameterLength(1),KC=Qe(Le,Le.ONE_MINUS).setParameterLength(1),$4=Qe(Le,Le.DFDX).setParameterLength(1),W4=Qe(Le,Le.DFDY).setParameterLength(1),JC=Qe(Le,Le.ROUND).setParameterLength(1),eR=Qe(Le,Le.RECIPROCAL).setParameterLength(1),j4=Qe(Le,Le.TRUNC).setParameterLength(1),tR=Qe(Le,Le.FWIDTH).setParameterLength(1),nR=Qe(Le,Le.TRANSPOSE).setParameterLength(1),Wte=Qe(Le,Le.BITCAST).setParameterLength(2),iR=(n,e)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),V4(n,e)),Ks=Qe(Le,Le.MIN).setParameterLength(2,1/0),sr=Qe(Le,Le.MAX).setParameterLength(2,1/0),T2=Qe(Le,Le.STEP).setParameterLength(2),rR=Qe(Le,Le.REFLECT).setParameterLength(2),sR=Qe(Le,Le.DISTANCE).setParameterLength(2),oR=Qe(Le,Le.DIFFERENCE).setParameterLength(2),Wu=Qe(Le,Le.DOT).setParameterLength(2),M2=Qe(Le,Le.CROSS).setParameterLength(2),la=Qe(Le,Le.POW).setParameterLength(2),X4=Qe(Le,Le.POW,2).setParameterLength(1),aR=Qe(Le,Le.POW,3).setParameterLength(1),lR=Qe(Le,Le.POW,4).setParameterLength(1),uR=Qe(Le,Le.TRANSFORM_DIRECTION).setParameterLength(2),cR=n=>gn(zd(n),la(wi(n),1/3)),Q4=n=>Wu(n,n),ii=Qe(Le,Le.MIX).setParameterLength(3),Ja=(n,e=0,t=1)=>je(new Le(Le.CLAMP,je(n),je(e),je(t))),hR=n=>Ja(n),Y4=Qe(Le,Le.REFRACT).setParameterLength(3),el=Qe(Le,Le.SMOOTHSTEP).setParameterLength(3),Z4=Qe(Le,Le.FACEFORWARD).setParameterLength(3),fR=Re(([n])=>{const i=43758.5453,r=Wu(n.xy,Je(12.9898,78.233)),s=hp(r,Pg);return Zl(mo(s).mul(i))}),AR=(n,e,t)=>ii(e,t,n),dR=(n,e,t)=>el(e,t,n),pR=(n,e)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),H4(n,e)),jte=Z4,Xte=z4;He("all",HC);He("any",$C);He("equals",iR);He("radians",WC);He("degrees",jC);He("exp",q4);He("exp2",AA);He("log",w2);He("log2",ja);He("sqrt",ul);He("inverseSqrt",z4);He("floor",Xa);He("ceil",S2);He("normalize",$l);He("fract",Zl);He("sin",mo);He("cos",Sl);He("tan",XC);He("asin",QC);He("acos",YC);He("atan",H4);He("abs",wi);He("sign",zd);He("length",Fl);He("lengthSq",Q4);He("negate",ZC);He("oneMinus",KC);He("dFdx",$4);He("dFdy",W4);He("round",JC);He("reciprocal",eR);He("trunc",j4);He("fwidth",tR);He("atan2",pR);He("min",Ks);He("max",sr);He("step",T2);He("reflect",rR);He("distance",sR);He("dot",Wu);He("cross",M2);He("pow",la);He("pow2",X4);He("pow3",aR);He("pow4",lR);He("transformDirection",uR);He("mix",AR);He("clamp",Ja);He("refract",Y4);He("smoothstep",dR);He("faceForward",Z4);He("difference",oR);He("saturate",hR);He("cbrt",cR);He("transpose",nR);He("rand",fR);class Qte extends jt{static get type(){return"ConditionalNode"}constructor(e,t,i=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=i}getNodeType(e){const{ifNode:t,elseNode:i}=e.getNodeProperties(this);if(t===void 0)return this.setup(e),this.getNodeType(e);const r=t.getNodeType(e);if(i!==null){const s=i.getNodeType(e);if(e.getTypeLength(s)>e.getTypeLength(r))return s}return r}setup(e){const t=this.condNode.cache(),i=this.ifNode.cache(),r=this.elseNode?this.elseNode.cache():null,s=e.context.nodeBlock;e.getDataFromNode(i).parentNodeBlock=s,r!==null&&(e.getDataFromNode(r).parentNodeBlock=s);const o=e.getNodeProperties(this);o.condNode=t,o.ifNode=i.context({nodeBlock:i}),o.elseNode=r?r.context({nodeBlock:r}):null}generate(e,t){const i=this.getNodeType(e),r=e.getDataFromNode(this);if(r.nodeProperty!==void 0)return r.nodeProperty;const{condNode:s,ifNode:o,elseNode:a}=e.getNodeProperties(this),l=e.currentFunctionNode,u=t!=="void",A=u?EA(i).build(e):"";r.nodeProperty=A;const p=s.build(e,"bool");e.addFlowCode(`
${e.tab}if ( ${p} ) {

`).addFlowTab();let g=o.build(e,i);if(g&&(u?g=A+" = "+g+";":(g="return "+g+";",l===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),g="// "+g))),e.removeFlowTab().addFlowCode(e.tab+"	"+g+`

`+e.tab+"}"),a!==null){e.addFlowCode(` else {

`).addFlowTab();let v=a.build(e,i);v&&(u?v=A+" = "+v+";":(v="return "+v+";",l===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),v="// "+v))),e.removeFlowTab().addFlowCode(e.tab+"	"+v+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(A,i,t)}}const Or=Qe(Qte).setParameterLength(2,3);He("select",Or);const mR=(...n)=>(console.warn("THREE.TSL: cond() has been renamed to select()."),Or(...n));He("cond",mR);class gR extends jt{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){this.node.build(e)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value});const i=this.node.build(e);return e.setContext(t),i}generate(e,t){const i=e.getContext();e.setContext({...e.context,...this.value});const r=this.node.build(e,t);return e.setContext(i),r}}const E2=Qe(gR).setParameterLength(1,2),_R=(n,e)=>E2(n,{label:e});He("context",E2);He("label",_R);class b1 extends jt{static get type(){return"VarNode"}constructor(e,t=null,i=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=i}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:t,name:i,readOnly:r}=this,{renderer:s}=e,o=s.backend.isWebGPUBackend===!0;let a=!1,l=!1;r&&(a=e.isDeterministic(t),l=o?r:a);const u=e.getVectorType(this.getNodeType(e)),A=t.build(e,u),p=e.getVarFromNode(this,i,u,void 0,l),g=e.getPropertyName(p);let v=g;if(l)if(o)v=a?`const ${g}`:`let ${g}`;else{const x=e.getArrayCount(t);v=`const ${e.getVar(p.type,g,x)}`}return e.addLineFlowCode(`${v} = ${A}`,this),g}}const K4=Qe(b1),vR=(n,e=null)=>K4(n,e).toStack(),yR=(n,e=null)=>K4(n,e,!0).toStack();He("toVar",vR);He("toConst",yR);const xR=n=>(console.warn('TSL: "temp( node )" is deprecated. Use "Var( node )" or "node.toVar()" instead.'),K4(n));He("temp",xR);class Yte extends jt{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null}isGlobal(){return!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let i=t.varying;if(i===void 0){const r=this.name,s=this.getNodeType(e),o=this.interpolationType,a=this.interpolationSampling;t.varying=i=e.getVaryingFromNode(this,r,s,o,a),t.node=this.node}return i.needsInterpolation||(i.needsInterpolation=e.shaderStage==="fragment"),i}setup(e){this.setupVarying(e)}analyze(e){return this.setupVarying(e),this.node.analyze(e)}generate(e){const t=e.getNodeProperties(this),i=this.setupVarying(e),r=e.shaderStage==="fragment"&&t.reassignPosition===!0&&e.context.needsPositionReassign;if(t.propertyName===void 0||r){const s=this.getNodeType(e),o=e.getPropertyName(i,My.VERTEX);e.flowNodeFromShaderStage(My.VERTEX,this.node,s,o),t.propertyName=o,r?t.reassignPosition=!1:t.reassignPosition===void 0&&e.context.isPositionNodeInput&&(t.reassignPosition=!0)}return e.getPropertyName(i)}}const To=Qe(Yte).setParameterLength(1,2),bR=n=>To(n);He("toVarying",To);He("toVertexStage",bR);He("varying",(...n)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),To(...n)));He("vertexStage",(...n)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),To(...n)));const wR=Re(([n])=>{const e=n.mul(.9478672986).add(.0521327014).pow(2.4),t=n.mul(.0773993808),i=n.lessThanEqual(.04045);return ii(e,t,i)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),SR=Re(([n])=>{const e=n.pow(.41666).mul(1.055).sub(.055),t=n.mul(12.92),i=n.lessThanEqual(.0031308);return ii(e,t,i)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),fp="WorkingColorSpace",J4="OutputColorSpace";class Ap extends or{static get type(){return"ColorSpaceNode"}constructor(e,t,i){super("vec4"),this.colorNode=e,this.source=t,this.target=i}resolveColorSpace(e,t){return t===fp?Rn.workingColorSpace:t===J4?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,i=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let s=t;return Rn.enabled===!1||i===r||!i||!r||(Rn.getTransfer(i)===oi&&(s=zt(wR(s.rgb),s.a)),Rn.getPrimaries(i)!==Rn.getPrimaries(r)&&(s=zt(ps(Rn._getMatrix(new dn,i,r)).mul(s.rgb),s.a)),Rn.getTransfer(r)===oi&&(s=zt(SR(s.rgb),s.a))),s}}const TR=n=>je(new Ap(je(n),fp,J4)),MR=n=>je(new Ap(je(n),J4,fp)),ER=(n,e)=>je(new Ap(je(n),fp,e)),C2=(n,e)=>je(new Ap(je(n),e,fp)),Zte=(n,e,t)=>je(new Ap(je(n),e,t));He("toOutputColorSpace",TR);He("toWorkingColorSpace",MR);He("workingToColorSpace",ER);He("colorSpaceToWorking",C2);let Kte=class extends fh{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),i=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,i,r)}};class CR extends jt{static get type(){return"ReferenceBaseNode"}constructor(e,t,i=null,r=null){super(),this.property=e,this.uniformType=t,this.object=i,this.count=r,this.properties=e.split("."),this.reference=i,this.node=null,this.group=null,this.updateType=mn.OBJECT}setGroup(e){return this.group=e,this}element(e){return je(new Kte(this,je(e)))}setNodeType(e){const t=qt(null,e).getSelf();this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let i=e[t[0]];for(let r=1;r<t.length;r++)i=i[t[r]];return i}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Jte=(n,e,t)=>je(new CR(n,e,t));class ene extends CR{static get type(){return"RendererReferenceNode"}constructor(e,t,i=null){super(e,t,i),this.renderer=i,this.setGroup(Xt)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const RR=(n,e,t=null)=>je(new ene(n,e,t));class tne extends or{static get type(){return"ToneMappingNode"}constructor(e,t=PR,i=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=i}customCacheKey(){return Fd(this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,i=this.toneMapping;if(i===Qs)return t;let r=null;const s=e.renderer.library.getToneMappingFunction(i);return s!==null?r=zt(s(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",i),r=t),r}}const NR=(n,e,t)=>je(new tne(n,je(e),je(t))),PR=RR("toneMappingExposure","float");He("toneMapping",(n,e,t)=>NR(e,t,n));class nne extends E4{static get type(){return"BufferAttributeNode"}constructor(e,t=null,i=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=i,this.bufferOffset=r,this.usage=G1,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),i=this.value,r=e.getTypeLength(t),s=this.bufferStride||r,o=this.bufferOffset,a=i.isInterleavedBuffer===!0?i:new s2(i,s),l=new Uo(a,r,o);a.setUsage(this.usage),this.attribute=l,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),i=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(i);let s=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=r,s=r):s=To(this).build(e,t),s}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const dp=(n,e=null,t=0,i=0)=>je(new nne(n,e,t,i)),LR=(n,e=null,t=0,i=0)=>dp(n,e,t,i).setUsage(cf),Lg=(n,e=null,t=0,i=0)=>dp(n,e,t,i).setInstanced(!0),Dy=(n,e=null,t=0,i=0)=>LR(n,e,t,i).setInstanced(!0);He("toAttribute",n=>dp(n.value));class ine extends jt{static get type(){return"ComputeNode"}constructor(e,t,i=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=t,this.workgroupSize=i,this.dispatchCount=0,this.version=1,this.name="",this.updateBeforeType=mn.OBJECT,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}label(e){return this.name=e,this}updateDispatchCount(){const{count:e,workgroupSize:t}=this;let i=t[0];for(let r=1;r<t.length;r++)i*=t[r];this.dispatchCount=Math.ceil(e/i)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){const i=e.getNodeProperties(this);i.outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:i}=e;if(i==="compute"){const r=this.computeNode.build(e,"void");r!==""&&e.addLineFlowCode(r,this)}else{const s=e.getNodeProperties(this).outputComputeNode;if(s)return s.build(e,t)}}}const DR=(n,e,t)=>je(new ine(je(n),e,t));He("compute",DR);class rne extends jt{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){const t=e.getCache(),i=e.getCacheFromNode(this,this.parent);e.setCache(i);const r=this.node.getNodeType(e);return e.setCache(t),r}build(e,...t){const i=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const s=this.node.build(e,...t);return e.setCache(i),s}}const $0=(n,e)=>je(new rne(je(n),e));He("cache",$0);class sne extends jt{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const IR=Qe(sne).setParameterLength(2);He("bypass",IR);class BR extends jt{static get type(){return"RemapNode"}constructor(e,t,i,r=re(0),s=re(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=i,this.outLowNode=r,this.outHighNode=s,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:i,outLowNode:r,outHighNode:s,doClamp:o}=this;let a=e.sub(t).div(i.sub(t));return o===!0&&(a=a.clamp()),a.mul(s.sub(r)).add(r)}}const FR=Qe(BR,null,null,{doClamp:!1}).setParameterLength(3,5),UR=Qe(BR).setParameterLength(3,5);He("remap",FR);He("remapClamp",UR);class w1 extends jt{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const i=this.getNodeType(e),r=this.snippet;if(i==="void")e.addLineFlowCode(r,this);else return e.format(r,i,t)}}const Wl=Qe(w1).setParameterLength(1,2),OR=n=>(n?Or(n,Wl("discard")):Wl("discard")).toStack(),one=()=>Wl("return").toStack();He("discard",OR);class ane extends or{static get type(){return"RenderOutputNode"}constructor(e,t,i){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=i,this.isRenderOutputNode=!0}setup({context:e}){let t=this.colorNode||e.color;const i=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||Qs,r=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||go;return i!==Qs&&(t=t.toneMapping(i)),r!==go&&r!==Rn.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}const kR=(n,e=null,t=null)=>je(new ane(je(n),e,t));He("renderOutput",kR);class lne extends or{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,i=this.node.build(e),r="--- TSL debug - "+e.shaderStage+" shader ---",s="-".repeat(r.length);let o="";return o+="// #"+r+`#
`,o+=e.flow.code.replace(/^\t/mg,"")+`
`,o+="/* ... */ "+i+` /* ... */
`,o+="// #"+s+`#
`,t!==null?t(e,o):console.log(o),i}}const VR=(n,e=null)=>je(new lne(je(n),e));He("debug",VR);function une(n){console.warn("THREE.TSL: AddNodeElement has been removed in favor of tree-shaking. Trying add",n)}class GR extends jt{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const i=this.getAttributeName(e);if(e.hasGeometryAttribute(i)){const r=e.geometry.getAttribute(i);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),i=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const s=e.geometry.getAttribute(t),o=e.getTypeFromAttribute(s),a=e.getAttribute(t,o);return e.shaderStage==="vertex"?e.format(a.name,o,i):To(this).build(e,i)}else return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(i)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const jl=(n,e=null)=>je(new GR(n,e)),Oi=(n=0)=>jl("uv"+(n>0?n:""),"vec2");class cne extends jt{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const i=this.textureNode.build(e,"property"),r=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${i}, ${r} )`,this.getNodeType(e),t)}}const Iu=Qe(cne).setParameterLength(1,2);class hne extends cp{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=mn.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,i=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(i&&i.width!==void 0){const{width:r,height:s}=i;this.value=Math.log2(Math.max(r,s))}}}const qR=Qe(hne).setParameterLength(1);class tl extends cp{static get type(){return"TextureNode"}constructor(e,t=null,i=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=i,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=mn.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===bi?"uvec4":this.value.type===Ir?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return Oi(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=qt(this.value.matrix)),this._matrixUniform.mul(xe(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?mn.OBJECT:mn.NONE,this}setupUV(e,t){const i=this.value;return e.isFlipY()&&(i.image instanceof ImageBitmap&&i.flipY===!0||i.isRenderTargetTexture===!0||i.isFramebufferTexture===!0||i.isDepthTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(de(Iu(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const i=this.value;if(!i||i.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let r=this.uvNode;(r===null||e.context.forceUVContext===!0)&&e.context.getUV&&(r=e.context.getUV(this,e)),r||(r=this.getDefaultUV()),this.updateMatrix===!0&&(r=this.getTransformedUV(r)),r=this.setupUV(e,r);let s=this.levelNode;s===null&&e.context.getTextureLevel&&(s=e.context.getTextureLevel(this)),t.uvNode=r,t.levelNode=s,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(e,t,i,r,s,o,a,l){const u=this.value;let A;return r?A=e.generateTextureLevel(u,t,i,r,o):s?A=e.generateTextureBias(u,t,i,s,o):l?A=e.generateTextureGrad(u,t,i,l,o):a?A=e.generateTextureCompare(u,t,i,a,o):this.sampler===!1?A=e.generateTextureLoad(u,t,i,o):A=e.generateTexture(u,t,i,o),A}generate(e,t){const i=this.value,r=e.getNodeProperties(this),s=super.generate(e,"property");if(/^sampler/.test(t))return s+"_sampler";if(e.isReference(t))return s;{const o=e.getDataFromNode(this);let a=o.propertyName;if(a===void 0){const{uvNode:A,levelNode:p,biasNode:g,compareNode:v,depthNode:x,gradNode:S}=r,T=this.generateUV(e,A),w=p?p.build(e,"float"):null,R=g?g.build(e,"float"):null,E=x?x.build(e,"int"):null,N=v?v.build(e,"float"):null,D=S?[S[0].build(e,"vec2"),S[1].build(e,"vec2")]:null,B=e.getVarFromNode(this);a=e.getPropertyName(B);const I=this.generateSnippet(e,s,T,w,R,E,N,D);e.addLineFlowCode(`${a} = ${I}`,this),o.snippet=I,o.propertyName=a}let l=a;const u=this.getNodeType(e);return e.needsToWorkingColorSpace(i)&&(l=C2(Wl(l,u),i.colorSpace).setup(e).build(e,u)),e.format(l,u,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=je(e),t.referenceNode=this.getSelf(),je(t)}blur(e){const t=this.clone();t.biasNode=je(e).mul(qR(t)),t.referenceNode=this.getSelf();const i=t.value;return t.generateMipmaps===!1&&(i&&i.generateMipmaps===!1||i.minFilter===Mi||i.magFilter===Mi)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),je(t)}level(e){const t=this.clone();return t.levelNode=je(e),t.referenceNode=this.getSelf(),je(t)}size(e){return Iu(this,e)}bias(e){const t=this.clone();return t.biasNode=je(e),t.referenceNode=this.getSelf(),je(t)}compare(e){const t=this.clone();return t.compareNode=je(e),t.referenceNode=this.getSelf(),je(t)}grad(e,t){const i=this.clone();return i.gradNode=[je(e),je(t)],i.referenceNode=this.getSelf(),je(i)}depth(e){const t=this.clone();return t.depthNode=je(e),t.referenceNode=this.getSelf(),je(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}const In=Qe(tl).setParameterLength(1,4),Zi=(...n)=>In(...n).setSampler(!1),fne=n=>(n.isNode===!0?n:In(n)).convert("sampler"),Ane=n=>(n.isNode===!0?n:In(n)).convert("samplerComparison");class eb extends cp{static get type(){return"BufferNode"}constructor(e,t,i=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=i}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const pp=(n,e,t)=>je(new eb(n,e,t));class dne extends fh{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),i=this.getNodeType(),r=this.node.getPaddedType();return e.format(t,r,i)}}class zR extends eb{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=t===null?Cu(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=mn.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return e==="mat2"?t="mat2":/mat/.test(e)===!0?t="mat4":e.charAt(0)==="i"?t="ivec4":e.charAt(0)==="u"&&(t="uvec4"),t}update(){const{array:e,value:t}=this,i=this.elementType;if(i==="float"||i==="int"||i==="uint")for(let r=0;r<e.length;r++){const s=r*4;t[s]=e[r]}else if(i==="color")for(let r=0;r<e.length;r++){const s=r*4,o=e[r];t[s]=o.r,t[s+1]=o.g,t[s+2]=o.b||0}else if(i==="mat2")for(let r=0;r<e.length;r++){const s=r*4,o=e[r];t[s]=o.elements[0],t[s+1]=o.elements[1],t[s+2]=o.elements[2],t[s+3]=o.elements[3]}else if(i==="mat3")for(let r=0;r<e.length;r++){const s=r*16,o=e[r];t[s]=o.elements[0],t[s+1]=o.elements[1],t[s+2]=o.elements[2],t[s+4]=o.elements[3],t[s+5]=o.elements[4],t[s+6]=o.elements[5],t[s+8]=o.elements[6],t[s+9]=o.elements[7],t[s+10]=o.elements[8],t[s+15]=1}else if(i==="mat4")for(let r=0;r<e.length;r++){const s=r*16,o=e[r];for(let a=0;a<o.elements.length;a++)t[s+a]=o.elements[a]}else for(let r=0;r<e.length;r++){const s=r*4,o=e[r];t[s]=o.x,t[s+1]=o.y,t[s+2]=o.z||0,t[s+3]=o.w||0}}setup(e){const t=this.array.length,i=this.elementType;let r=Float32Array;const s=this.paddedType,o=e.getTypeLength(s);return i.charAt(0)==="i"&&(r=Int32Array),i.charAt(0)==="u"&&(r=Uint32Array),this.value=new r(t*o),this.bufferCount=t,this.bufferType=s,super.setup(e)}element(e){return je(new dne(this,je(e)))}}const Fo=(n,e)=>je(new zR(n,e)),pne=(n,e)=>(console.warn("THREE.TSL: uniforms() has been renamed to uniformArray()."),je(new zR(n,e)));class mne extends jt{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const mp=Qe(mne).setParameterLength(1),R2=qt(0,"uint").label("u_cameraIndex").setGroup(b2("cameraIndex")).toVarying("v_cameraIndex"),Tu=qt("float").label("cameraNear").setGroup(Xt).onRenderUpdate(({camera:n})=>n.near),Mu=qt("float").label("cameraFar").setGroup(Xt).onRenderUpdate(({camera:n})=>n.far),Ah=Re(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const r of n.cameras)t.push(r.projectionMatrix);e=Fo(t).setGroup(Xt).label("cameraProjectionMatrices").element(n.isMultiViewCamera?mp("gl_ViewID_OVR"):R2).toVar("cameraProjectionMatrix")}else e=qt("mat4").label("cameraProjectionMatrix").setGroup(Xt).onRenderUpdate(({camera:t})=>t.projectionMatrix);return e}).once()(),gne=Re(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const r of n.cameras)t.push(r.projectionMatrixInverse);e=Fo(t).setGroup(Xt).label("cameraProjectionMatricesInverse").element(n.isMultiViewCamera?mp("gl_ViewID_OVR"):R2).toVar("cameraProjectionMatrixInverse")}else e=qt("mat4").label("cameraProjectionMatrixInverse").setGroup(Xt).onRenderUpdate(({camera:t})=>t.projectionMatrixInverse);return e}).once()(),eo=Re(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const r of n.cameras)t.push(r.matrixWorldInverse);e=Fo(t).setGroup(Xt).label("cameraViewMatrices").element(n.isMultiViewCamera?mp("gl_ViewID_OVR"):R2).toVar("cameraViewMatrix")}else e=qt("mat4").label("cameraViewMatrix").setGroup(Xt).onRenderUpdate(({camera:t})=>t.matrixWorldInverse);return e}).once()(),_ne=qt("mat4").label("cameraWorldMatrix").setGroup(Xt).onRenderUpdate(({camera:n})=>n.matrixWorld),vne=qt("mat3").label("cameraNormalMatrix").setGroup(Xt).onRenderUpdate(({camera:n})=>n.normalMatrix),HR=qt(new ie).label("cameraPosition").setGroup(Xt).onRenderUpdate(({camera:n},e)=>e.value.setFromMatrixPosition(n.matrixWorld)),dS=new Hu;class Fn extends jt{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=mn.OBJECT,this._uniformNode=new cp(null)}getNodeType(){const e=this.scope;if(e===Fn.WORLD_MATRIX)return"mat4";if(e===Fn.POSITION||e===Fn.VIEW_POSITION||e===Fn.DIRECTION||e===Fn.SCALE)return"vec3";if(e===Fn.RADIUS)return"float"}update(e){const t=this.object3d,i=this._uniformNode,r=this.scope;if(r===Fn.WORLD_MATRIX)i.value=t.matrixWorld;else if(r===Fn.POSITION)i.value=i.value||new ie,i.value.setFromMatrixPosition(t.matrixWorld);else if(r===Fn.SCALE)i.value=i.value||new ie,i.value.setFromMatrixScale(t.matrixWorld);else if(r===Fn.DIRECTION)i.value=i.value||new ie,t.getWorldDirection(i.value);else if(r===Fn.VIEW_POSITION){const s=e.camera;i.value=i.value||new ie,i.value.setFromMatrixPosition(t.matrixWorld),i.value.applyMatrix4(s.matrixWorldInverse)}else if(r===Fn.RADIUS){const s=e.object.geometry;s.boundingSphere===null&&s.computeBoundingSphere(),dS.copy(s.boundingSphere).applyMatrix4(t.matrixWorld),i.value=dS.radius}}generate(e){const t=this.scope;return t===Fn.WORLD_MATRIX?this._uniformNode.nodeType="mat4":t===Fn.POSITION||t===Fn.VIEW_POSITION||t===Fn.DIRECTION||t===Fn.SCALE?this._uniformNode.nodeType="vec3":t===Fn.RADIUS&&(this._uniformNode.nodeType="float"),this._uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Fn.WORLD_MATRIX="worldMatrix";Fn.POSITION="position";Fn.SCALE="scale";Fn.VIEW_POSITION="viewPosition";Fn.DIRECTION="direction";Fn.RADIUS="radius";const yne=Qe(Fn,Fn.DIRECTION).setParameterLength(1),xne=Qe(Fn,Fn.WORLD_MATRIX).setParameterLength(1),$R=Qe(Fn,Fn.POSITION).setParameterLength(1),bne=Qe(Fn,Fn.SCALE).setParameterLength(1),wne=Qe(Fn,Fn.VIEW_POSITION).setParameterLength(1),Sne=Qe(Fn,Fn.RADIUS).setParameterLength(1);class $o extends Fn{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const Tne=gt($o,$o.DIRECTION),Oo=gt($o,$o.WORLD_MATRIX),Mne=gt($o,$o.POSITION),Ene=gt($o,$o.SCALE),Cne=gt($o,$o.VIEW_POSITION),Rne=gt($o,$o.RADIUS),WR=qt(new dn).onObjectUpdate(({object:n},e)=>e.value.getNormalMatrix(n.matrixWorld)),Nne=qt(new en).onObjectUpdate(({object:n},e)=>e.value.copy(n.matrixWorld).invert()),dh=Re(n=>n.renderer.overrideNodes.modelViewMatrix||jR).once()().toVar("modelViewMatrix"),jR=eo.mul(Oo),Iy=Re(n=>(n.context.isHighPrecisionModelViewMatrix=!0,qt("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),By=Re(n=>{const e=n.context.isHighPrecisionModelViewMatrix;return qt("mat3").onObjectUpdate(({object:t,camera:i})=>(e!==!0&&t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),gp=jl("position","vec3"),nr=gp.toVarying("positionLocal"),Dg=gp.toVarying("positionPrevious"),Ul=Oo.mul(nr).xyz.toVarying("v_positionWorld").context({needsPositionReassign:!0}),tb=nr.transformDirection(Oo).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection").context({needsPositionReassign:!0}),ur=Re(n=>n.context.setupPositionView(),"vec3").once()().toVarying("v_positionView").context({needsPositionReassign:!0}),Li=ur.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class Pne extends jt{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:t,material:i}=e;return t.coordinateSystem===Is&&i.side===_i?"false":e.getFrontFacing()}}const XR=gt(Pne),_p=re(XR).mul(2).sub(1),N2=jl("normal","vec3"),Js=Re(n=>n.geometry.hasAttribute("normal")===!1?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),xe(0,1,0)):N2,"vec3").once()().toVar("normalLocal"),QR=ur.dFdx().cross(ur.dFdy()).normalize().toVar("normalFlat"),Wo=Re(n=>{let e;return n.material.flatShading===!0?e=QR:e=To(nb(Js),"v_normalView").normalize(),e},"vec3").once()().toVar("normalView"),P2=Re(n=>{let e=Wo.transformDirection(eo);return n.material.flatShading!==!0&&(e=To(e,"v_normalWorld")),e},"vec3").once()().normalize().toVar("normalWorld"),tr=Re(n=>{let e=n.context.setupNormal().context({getUV:null});return n.material.flatShading!==!0&&(e=e.mul(_p)),e},"vec3").once()().toVar("transformedNormalView"),L2=tr.transformDirection(eo).toVar("transformedNormalWorld"),_f=Re(n=>{let e=n.context.setupClearcoatNormal().context({getUV:null});return n.material.flatShading!==!0&&(e=e.mul(_p)),e},"vec3").once()().toVar("transformedClearcoatNormalView"),YR=Re(([n,e=Oo])=>{const t=ps(e),i=n.div(xe(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(i).xyz}),nb=Re(([n],e)=>{const t=e.renderer.overrideNodes.modelNormalViewMatrix;if(t!==null)return t.transformDirection(n);const i=WR.mul(n);return eo.transformDirection(i)}),pS=new Qr,E3=new en,ZR=qt(0).onReference(({material:n})=>n).onObjectUpdate(({material:n})=>n.refractionRatio),S1=qt(1).onReference(({material:n})=>n).onObjectUpdate(function({material:n,scene:e}){return n.envMap?n.envMapIntensity:e.environmentIntensity}),ib=qt(new en).onReference(function(n){return n.material}).onObjectUpdate(function({material:n,scene:e}){const t=e.environment!==null&&n.envMap===null?e.environmentRotation:n.envMapRotation;return t?(pS.copy(t),E3.makeRotationFromEuler(pS)):E3.identity(),E3}),KR=Li.negate().reflect(tr),JR=Li.negate().refract(tr,ZR),eN=KR.transformDirection(eo).toVar("reflectVector"),tN=JR.transformDirection(eo).toVar("reflectVector");class Lne extends tl{static get type(){return"CubeTextureNode"}constructor(e,t=null,i=null,r=null){super(e,t,i,r),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===ga?eN:e.mapping===_a?tN:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),xe(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const i=this.value;return(e.renderer.coordinateSystem===Za||!i.isRenderTargetTexture)&&(t=xe(t.x.negate(),t.yz)),ib.mul(t)}generateUV(e,t){return t.build(e,"vec3")}}const dA=Qe(Lne).setParameterLength(1,4).setName("cubeTexture");class Dne extends fh{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),i=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,i,r)}}class D2 extends jt{static get type(){return"ReferenceNode"}constructor(e,t,i=null,r=null){super(),this.property=e,this.uniformType=t,this.object=i,this.count=r,this.properties=e.split("."),this.reference=i,this.node=null,this.group=null,this.name=null,this.updateType=mn.OBJECT}element(e){return je(new Dne(this,je(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let t=null;this.count!==null?t=pp(null,e,this.count):Array.isArray(this.getValueFromReference())?t=Fo(null,e):e==="texture"?t=In(null):e==="cubeTexture"?t=dA(null):t=qt(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.label(this.name),this.node=t.getSelf()}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let i=e[t[0]];for(let r=1;r<t.length;r++)i=i[t[r]];return i}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const pi=(n,e,t)=>je(new D2(n,e,t)),Fy=(n,e,t,i)=>je(new D2(n,e,i,t));class Ine extends D2{static get type(){return"MaterialReferenceNode"}constructor(e,t,i=null){super(e,t,i),this.material=i,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const Rl=(n,e,t=null)=>je(new Ine(n,e,t)),I2=Re(n=>(n.geometry.hasAttribute("tangent")===!1&&n.geometry.computeTangents(),jl("tangent","vec4")))(),vp=I2.xyz.toVar("tangentLocal"),yp=dh.mul(zt(vp,0)).xyz.toVarying("v_tangentView").normalize().toVar("tangentView"),nN=yp.transformDirection(eo).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),rb=yp.toVar("transformedTangentView"),Bne=rb.transformDirection(eo).normalize().toVar("transformedTangentWorld"),xp=Re(([n,e],t)=>{let i=n.mul(I2.w).xyz;return t.material.flatShading!==!0&&(i=To(n,e)),i}).once(),Fne=xp(N2.cross(I2),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),Une=xp(Js.cross(vp),"v_bitangentLocal").normalize().toVar("bitangentLocal"),iN=xp(Wo.cross(yp),"v_bitangentView").normalize().toVar("bitangentView"),One=xp(P2.cross(nN),"v_bitangentWorld").normalize().toVar("bitangentWorld"),rN=xp(tr.cross(rb),"v_transformedBitangentView").normalize().toVar("transformedBitangentView"),kne=rN.transformDirection(eo).normalize().toVar("transformedBitangentWorld"),Bc=ps(yp,iN,Wo),sN=Li.mul(Bc),Vne=(n,e)=>n.sub(sN.mul(e)),oN=(()=>{let n=Hc.cross(Li);return n=n.cross(Hc).normalize(),n=ii(n,tr,wu.mul(Va.oneMinus()).oneMinus().pow2().pow2()).normalize(),n})(),Gne=Re(n=>{const{eye_pos:e,surf_norm:t,mapN:i,uv:r}=n,s=e.dFdx(),o=e.dFdy(),a=r.dFdx(),l=r.dFdy(),u=t,A=o.cross(u),p=u.cross(s),g=A.mul(a.x).add(p.mul(l.x)),v=A.mul(a.y).add(p.mul(l.y)),x=g.dot(g).max(v.dot(v)),S=_p.mul(x.inverseSqrt());return hr(g.mul(i.x,S),v.mul(i.y,S),u.mul(i.z)).normalize()});class qne extends or{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=Ol}setup(e){const{normalMapType:t,scaleNode:i}=this;let r=this.node.mul(2).sub(1);i!==null&&(r=xe(r.xy.mul(i),r.z));let s=null;return t===Q7?s=nb(r):t===Ol&&(e.hasGeometryAttribute("tangent")===!0?s=Bc.mul(r).normalize():s=Gne({eye_pos:ur,surf_norm:Wo,mapN:r,uv:Oi()})),s}}const Uy=Qe(qne).setParameterLength(1,2),zne=Re(({textureNode:n,bumpScale:e})=>{const t=r=>n.cache().context({getUV:s=>r(s.uvNode||Oi()),forceUVContext:!0}),i=re(t(r=>r));return Je(re(t(r=>r.add(r.dFdx()))).sub(i),re(t(r=>r.add(r.dFdy()))).sub(i)).mul(e)}),Hne=Re(n=>{const{surf_pos:e,surf_norm:t,dHdxy:i}=n,r=e.dFdx().normalize(),s=e.dFdy().normalize(),o=t,a=s.cross(o),l=o.cross(r),u=r.dot(a).mul(_p),A=u.sign().mul(i.x.mul(a).add(i.y.mul(l)));return u.abs().mul(t).sub(A).normalize()});class $ne extends or{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=zne({textureNode:this.textureNode,bumpScale:e});return Hne({surf_pos:ur,surf_norm:Wo,dHdxy:t})}}const aN=Qe($ne).setParameterLength(1,2),mS=new Map;class $e extends jt{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let i=mS.get(e);return i===void 0&&(i=Rl(e,t),mS.set(e,i)),i}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,i=this.scope;let r=null;if(i===$e.COLOR){const s=t.color!==void 0?this.getColor(i):xe();t.map&&t.map.isTexture===!0?r=s.mul(this.getTexture("map")):r=s}else if(i===$e.OPACITY){const s=this.getFloat(i);t.alphaMap&&t.alphaMap.isTexture===!0?r=s.mul(this.getTexture("alpha")):r=s}else if(i===$e.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?r=this.getTexture("specular").r:r=re(1);else if(i===$e.SPECULAR_INTENSITY){const s=this.getFloat(i);t.specularIntensityMap&&t.specularIntensityMap.isTexture===!0?r=s.mul(this.getTexture(i).a):r=s}else if(i===$e.SPECULAR_COLOR){const s=this.getColor(i);t.specularColorMap&&t.specularColorMap.isTexture===!0?r=s.mul(this.getTexture(i).rgb):r=s}else if(i===$e.ROUGHNESS){const s=this.getFloat(i);t.roughnessMap&&t.roughnessMap.isTexture===!0?r=s.mul(this.getTexture(i).g):r=s}else if(i===$e.METALNESS){const s=this.getFloat(i);t.metalnessMap&&t.metalnessMap.isTexture===!0?r=s.mul(this.getTexture(i).b):r=s}else if(i===$e.EMISSIVE){const s=this.getFloat("emissiveIntensity"),o=this.getColor(i).mul(s);t.emissiveMap&&t.emissiveMap.isTexture===!0?r=o.mul(this.getTexture(i)):r=o}else if(i===$e.NORMAL)t.normalMap?(r=Uy(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType):t.bumpMap?r=aN(this.getTexture("bump").r,this.getFloat("bumpScale")):r=Wo;else if(i===$e.CLEARCOAT){const s=this.getFloat(i);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?r=s.mul(this.getTexture(i).r):r=s}else if(i===$e.CLEARCOAT_ROUGHNESS){const s=this.getFloat(i);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(i).r):r=s}else if(i===$e.CLEARCOAT_NORMAL)t.clearcoatNormalMap?r=Uy(this.getTexture(i),this.getCache(i+"Scale","vec2")):r=Wo;else if(i===$e.SHEEN){const s=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?r=s.mul(this.getTexture("sheenColor").rgb):r=s}else if(i===$e.SHEEN_ROUGHNESS){const s=this.getFloat(i);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(i).a):r=s,r=r.clamp(.07,1)}else if(i===$e.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const s=this.getTexture(i);r=v2(lf.x,lf.y,lf.y.negate(),lf.x).mul(s.rg.mul(2).sub(Je(1)).normalize().mul(s.b))}else r=lf;else if(i===$e.IRIDESCENCE_THICKNESS){const s=pi("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const o=pi("0","float",t.iridescenceThicknessRange);r=s.sub(o).mul(this.getTexture(i).g).add(o)}else r=s}else if(i===$e.TRANSMISSION){const s=this.getFloat(i);t.transmissionMap?r=s.mul(this.getTexture(i).r):r=s}else if(i===$e.THICKNESS){const s=this.getFloat(i);t.thicknessMap?r=s.mul(this.getTexture(i).g):r=s}else if(i===$e.IOR)r=this.getFloat(i);else if(i===$e.LIGHT_MAP)r=this.getTexture(i).rgb.mul(this.getFloat("lightMapIntensity"));else if(i===$e.AO)r=this.getTexture(i).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else{const s=this.getNodeType(e);r=this.getCache(i,s)}return r}}$e.ALPHA_TEST="alphaTest";$e.COLOR="color";$e.OPACITY="opacity";$e.SHININESS="shininess";$e.SPECULAR="specular";$e.SPECULAR_STRENGTH="specularStrength";$e.SPECULAR_INTENSITY="specularIntensity";$e.SPECULAR_COLOR="specularColor";$e.REFLECTIVITY="reflectivity";$e.ROUGHNESS="roughness";$e.METALNESS="metalness";$e.NORMAL="normal";$e.CLEARCOAT="clearcoat";$e.CLEARCOAT_ROUGHNESS="clearcoatRoughness";$e.CLEARCOAT_NORMAL="clearcoatNormal";$e.EMISSIVE="emissive";$e.ROTATION="rotation";$e.SHEEN="sheen";$e.SHEEN_ROUGHNESS="sheenRoughness";$e.ANISOTROPY="anisotropy";$e.IRIDESCENCE="iridescence";$e.IRIDESCENCE_IOR="iridescenceIOR";$e.IRIDESCENCE_THICKNESS="iridescenceThickness";$e.IOR="ior";$e.TRANSMISSION="transmission";$e.THICKNESS="thickness";$e.ATTENUATION_DISTANCE="attenuationDistance";$e.ATTENUATION_COLOR="attenuationColor";$e.LINE_SCALE="scale";$e.LINE_DASH_SIZE="dashSize";$e.LINE_GAP_SIZE="gapSize";$e.LINE_WIDTH="linewidth";$e.LINE_DASH_OFFSET="dashOffset";$e.POINT_SIZE="size";$e.DISPERSION="dispersion";$e.LIGHT_MAP="light";$e.AO="ao";const lN=gt($e,$e.ALPHA_TEST),uN=gt($e,$e.COLOR),cN=gt($e,$e.SHININESS),hN=gt($e,$e.EMISSIVE),sb=gt($e,$e.OPACITY),fN=gt($e,$e.SPECULAR),Oy=gt($e,$e.SPECULAR_INTENSITY),AN=gt($e,$e.SPECULAR_COLOR),W0=gt($e,$e.SPECULAR_STRENGTH),T1=gt($e,$e.REFLECTIVITY),dN=gt($e,$e.ROUGHNESS),pN=gt($e,$e.METALNESS),mN=gt($e,$e.NORMAL),gN=gt($e,$e.CLEARCOAT),_N=gt($e,$e.CLEARCOAT_ROUGHNESS),vN=gt($e,$e.CLEARCOAT_NORMAL),yN=gt($e,$e.ROTATION),xN=gt($e,$e.SHEEN),bN=gt($e,$e.SHEEN_ROUGHNESS),wN=gt($e,$e.ANISOTROPY),SN=gt($e,$e.IRIDESCENCE),TN=gt($e,$e.IRIDESCENCE_IOR),MN=gt($e,$e.IRIDESCENCE_THICKNESS),EN=gt($e,$e.TRANSMISSION),CN=gt($e,$e.THICKNESS),RN=gt($e,$e.IOR),NN=gt($e,$e.ATTENUATION_DISTANCE),PN=gt($e,$e.ATTENUATION_COLOR),LN=gt($e,$e.LINE_SCALE),DN=gt($e,$e.LINE_DASH_SIZE),IN=gt($e,$e.LINE_GAP_SIZE),Wne=gt($e,$e.LINE_WIDTH),BN=gt($e,$e.LINE_DASH_OFFSET),FN=gt($e,$e.POINT_SIZE),UN=gt($e,$e.DISPERSION),ob=gt($e,$e.LIGHT_MAP),ON=gt($e,$e.AO),lf=qt(new at).onReference(function(n){return n.material}).onRenderUpdate(function({material:n}){this.value.set(n.anisotropy*Math.cos(n.anisotropyRotation),n.anisotropy*Math.sin(n.anisotropyRotation))}),ab=Re(n=>n.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class Ii extends jt{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),i=this.scope;let r;if(i===Ii.VERTEX)r=e.getVertexIndex();else if(i===Ii.INSTANCE)r=e.getInstanceIndex();else if(i===Ii.DRAW)r=e.getDrawIndex();else if(i===Ii.INVOCATION_LOCAL)r=e.getInvocationLocalIndex();else if(i===Ii.INVOCATION_SUBGROUP)r=e.getInvocationSubgroupIndex();else if(i===Ii.SUBGROUP)r=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+i);let s;return e.shaderStage==="vertex"||e.shaderStage==="compute"?s=r:s=To(this).build(e,t),s}}Ii.VERTEX="vertex";Ii.INSTANCE="instance";Ii.SUBGROUP="subgroup";Ii.INVOCATION_LOCAL="invocationLocal";Ii.INVOCATION_SUBGROUP="invocationSubgroup";Ii.DRAW="draw";const kN=gt(Ii,Ii.VERTEX),Bu=gt(Ii,Ii.INSTANCE),jne=gt(Ii,Ii.SUBGROUP),Xne=gt(Ii,Ii.INVOCATION_SUBGROUP),Qne=gt(Ii,Ii.INVOCATION_LOCAL),VN=gt(Ii,Ii.DRAW);class GN extends jt{static get type(){return"InstanceNode"}constructor(e,t,i=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=i,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=mn.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{count:t,instanceMatrix:i,instanceColor:r}=this;let{instanceMatrixNode:s,instanceColorNode:o}=this;if(s===null){if(t<=1e3)s=pp(i.array,"mat4",Math.max(t,1)).element(Bu);else{const l=new $1(i.array,16,1);this.buffer=l;const u=i.usage===cf?Dy:Lg,A=[u(l,"vec4",16,0),u(l,"vec4",16,4),u(l,"vec4",16,8),u(l,"vec4",16,12)];s=zc(...A)}this.instanceMatrixNode=s}if(r&&o===null){const l=new Du(r.array,3),u=r.usage===cf?Dy:Lg;this.bufferColor=l,o=xe(u(l,"vec3",3,0)),this.instanceColorNode=o}const a=s.mul(nr).xyz;if(nr.assign(a),e.hasGeometryAttribute("normal")){const l=YR(Js,s);Js.assign(l)}this.instanceColorNode!==null&&kd("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==cf&&this.buffer!==null&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==cf&&this.bufferColor!==null&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}const Yne=Qe(GN).setParameterLength(2,3);class Zne extends GN{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:i,instanceColor:r}=e;super(t,i,r),this.instancedMesh=e}}const qN=Qe(Zne).setParameterLength(1);class Kne extends jt{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=Bu:this.batchingIdNode=VN);const i=Re(([x])=>{const S=de(Iu(Zi(this.batchMesh._indirectTexture),0).x),T=de(x).mod(S),w=de(x).div(S);return Zi(this.batchMesh._indirectTexture,Sr(T,w)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(de(this.batchingIdNode)),r=this.batchMesh._matricesTexture,s=de(Iu(Zi(r),0).x),o=re(i).mul(4).toInt().toVar(),a=o.mod(s),l=o.div(s),u=zc(Zi(r,Sr(a,l)),Zi(r,Sr(a.add(1),l)),Zi(r,Sr(a.add(2),l)),Zi(r,Sr(a.add(3),l))),A=this.batchMesh._colorsTexture;if(A!==null){const S=Re(([T])=>{const w=de(Iu(Zi(A),0).x),R=T,E=R.mod(w),N=R.div(w);return Zi(A,Sr(E,N)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(i);kd("vec3","vBatchColor").assign(S)}const p=ps(u);nr.assign(u.mul(nr));const g=Js.div(xe(p[0].dot(p[0]),p[1].dot(p[1]),p[2].dot(p[2]))),v=p.mul(g).xyz;Js.assign(v),e.hasGeometryAttribute("tangent")&&vp.mulAssign(p)}}const zN=Qe(Kne).setParameterLength(1);class Jne extends fh{static get type(){return"StorageArrayElementNode"}constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,t){const i=this.storageBufferNode.structTypeNode;return i?i.getMemberType(e,t):"void"}setup(e){return e.isAvailable("storageBuffer")===!1&&this.node.isPBO===!0&&e.setupPBO(this.node),super.setup(e)}generate(e,t){let i;const r=e.context.assign;if(e.isAvailable("storageBuffer")===!1?this.node.isPBO===!0&&r!==!0&&(this.node.value.isInstancedBufferAttribute||e.shaderStage!=="compute")?i=e.generatePBO(this):i=this.node.build(e):i=super.generate(e),r!==!0){const s=this.getNodeType(e);i=e.format(i,s,t)}return i}}const eie=Qe(Jne).setParameterLength(2);class tie extends eb{static get type(){return"StorageBufferNode"}constructor(e,t=null,i=0){let r,s=null;t&&t.isStruct?(r="struct",s=t.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(i=e.count)):t===null&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(r=Z9(e.itemSize),i=e.count):r=t,super(e,r,i),this.isStorageBufferNode=!0,this.structTypeNode=s,this.access=fs.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,e.isStorageBufferAttribute!==!0&&e.isStorageInstancedBufferAttribute!==!0&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(this.bufferCount===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return eie(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess(fs.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return this._attribute===null&&(this._attribute=dp(this.value),this._varying=To(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(this.structTypeNode!==null)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);const{attribute:t}=this.getAttributeData();return t.getNodeType(e)}generate(e){if(this.structTypeNode!==null&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);const{attribute:t,varying:i}=this.getAttributeData(),r=i.build(e);return e.registerTransform(r,t),r}}const $c=(n,e=null,t=0)=>je(new tie(n,e,t)),nie=(n,e,t)=>(console.warn('THREE.TSL: "storageObject()" is deprecated. Use "storage().setPBO( true )" instead.'),$c(n,e,t).setPBO(!0)),gS=new WeakMap;class HN extends jt{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=mn.OBJECT,this.skinIndexNode=jl("skinIndex","uvec4"),this.skinWeightNode=jl("skinWeight","vec4"),this.bindMatrixNode=pi("bindMatrix","mat4"),this.bindMatrixInverseNode=pi("bindMatrixInverse","mat4"),this.boneMatricesNode=Fy("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=nr,this.toPositionNode=nr,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:i,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:o}=this,a=e.element(i.x),l=e.element(i.y),u=e.element(i.z),A=e.element(i.w),p=s.mul(t),g=hr(a.mul(r.x).mul(p),l.mul(r.y).mul(p),u.mul(r.z).mul(p),A.mul(r.w).mul(p));return o.mul(g).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=Js){const{skinIndexNode:i,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:o}=this,a=e.element(i.x),l=e.element(i.y),u=e.element(i.z),A=e.element(i.w);let p=hr(r.x.mul(a),r.y.mul(l),r.z.mul(u),r.w.mul(A));return p=o.mul(p).mul(s),p.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=Fy("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,Dg)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||J9(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&Dg.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const i=this.getSkinnedNormal();Js.assign(i),e.hasGeometryAttribute("tangent")&&vp.assign(i)}return t}generate(e,t){if(t!=="void")return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;gS.get(t)!==e.frameId&&(gS.set(t,e.frameId),this.previousBoneMatricesNode!==null&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}const $N=n=>je(new HN(n)),iie=(n,e=null)=>{const t=new HN(n);return t.positionNode=$c(new Du(n.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(Bu).toVar(),t.skinIndexNode=$c(new Du(new Uint32Array(n.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(Bu).toVar(),t.skinWeightNode=$c(new Du(n.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(Bu).toVar(),t.bindMatrixNode=qt(n.bindMatrix,"mat4"),t.bindMatrixInverseNode=qt(n.bindMatrixInverse,"mat4"),t.boneMatricesNode=pp(n.skeleton.boneMatrices,"mat4",n.skeleton.bones.length),t.toPositionNode=e,je(t)};class rie extends jt{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const i={};for(let o=0,a=this.params.length-1;o<a;o++){const l=this.params[o],u=l.isNode!==!0&&l.name||this.getVarName(o),A=l.isNode!==!0&&l.type||"int";i[u]=Wl(u,A)}const r=e.addStack();t.returnsNode=this.params[this.params.length-1](i,e),t.stackNode=r;const s=this.params[0];return s.isNode!==!0&&typeof s.update=="function"&&(t.updateNode=Re(this.params[0].update)(i)),e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),i=this.params,r=t.stackNode;for(let a=0,l=i.length-1;a<l;a++){const u=i[a];let A=!1,p=null,g=null,v=null,x=null,S=null,T=null;u.isNode?u.getNodeType(e)==="bool"?(A=!0,x="bool",g=u.build(e,x)):(x="int",v=this.getVarName(a),p="0",g=u.build(e,x),S="<"):(x=u.type||"int",v=u.name||this.getVarName(a),p=u.start,g=u.end,S=u.condition,T=u.update,typeof p=="number"?p=e.generateConst(x,p):p&&p.isNode&&(p=p.build(e,x)),typeof g=="number"?g=e.generateConst(x,g):g&&g.isNode&&(g=g.build(e,x)),p!==void 0&&g===void 0?(p=p+" - 1",g="0",S=">="):g!==void 0&&p===void 0&&(p="0",S="<"),S===void 0&&(Number(p)>Number(g)?S=">=":S="<"));let w;if(A)w=`while ( ${g} )`;else{const R={start:p,end:g},E=R.start,N=R.end;let D;const B=()=>S.includes("<")?"+=":"-=";if(T!=null)switch(typeof T){case"function":D=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":D=v+" "+B()+" "+e.generateConst(x,T);break;case"string":D=v+" "+T;break;default:T.isNode?D=v+" "+B()+" "+T.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),D="break /* invalid update */")}else x==="int"||x==="uint"?T=S.includes("<")?"++":"--":T=B()+" 1.",D=v+" "+T;const I=e.getVar(x,v)+" = "+E,O=v+" "+S+" "+N;w=`for ( ${I}; ${O}; ${D} )`}e.addFlowCode((a===0?`
`:"")+e.tab+w+` {

`).addFlowTab()}const s=r.build(e,"void"),o=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+s);for(let a=0,l=this.params.length-1;a<l;a++)e.addFlowCode((a===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),o}}const ri=(...n)=>je(new rie(qc(n,"int"))).toStack(),sie=()=>Wl("continue").toStack(),WN=()=>Wl("break").toStack(),oie=(...n)=>(console.warn("THREE.TSL: loop() has been renamed to Loop()."),ri(...n)),C3=new WeakMap,lo=new $t,_S=Re(({bufferMap:n,influence:e,stride:t,width:i,depth:r,offset:s})=>{const o=de(kN).mul(t).add(s),a=o.div(i),l=o.sub(a.mul(i));return Zi(n,Sr(l,a)).depth(r).xyz.mul(e)});function aie(n){const e=n.morphAttributes.position!==void 0,t=n.morphAttributes.normal!==void 0,i=n.morphAttributes.color!==void 0,r=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,s=r!==void 0?r.length:0;let o=C3.get(n);if(o===void 0||o.count!==s){let w=function(){S.dispose(),C3.delete(n),n.removeEventListener("dispose",w)};o!==void 0&&o.texture.dispose();const a=n.morphAttributes.position||[],l=n.morphAttributes.normal||[],u=n.morphAttributes.color||[];let A=0;e===!0&&(A=1),t===!0&&(A=2),i===!0&&(A=3);let p=n.attributes.position.count*A,g=1;const v=4096;p>v&&(g=Math.ceil(p/v),p=v);const x=new Float32Array(p*g*4*s),S=new t2(x,p,g,s);S.type=lr,S.needsUpdate=!0;const T=A*4;for(let R=0;R<s;R++){const E=a[R],N=l[R],D=u[R],B=p*g*4*R;for(let I=0;I<E.count;I++){const O=I*T;e===!0&&(lo.fromBufferAttribute(E,I),x[B+O+0]=lo.x,x[B+O+1]=lo.y,x[B+O+2]=lo.z,x[B+O+3]=0),t===!0&&(lo.fromBufferAttribute(N,I),x[B+O+4]=lo.x,x[B+O+5]=lo.y,x[B+O+6]=lo.z,x[B+O+7]=0),i===!0&&(lo.fromBufferAttribute(D,I),x[B+O+8]=lo.x,x[B+O+9]=lo.y,x[B+O+10]=lo.z,x[B+O+11]=D.itemSize===4?lo.w:1)}}o={count:s,texture:S,stride:A,size:new at(p,g)},C3.set(n,o),n.addEventListener("dispose",w)}return o}class lie extends jt{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=qt(1),this.updateType=mn.OBJECT}setup(e){const{geometry:t}=e,i=t.morphAttributes.position!==void 0,r=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,s=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,o=s!==void 0?s.length:0,{texture:a,stride:l,size:u}=aie(t);i===!0&&nr.mulAssign(this.morphBaseInfluence),r===!0&&Js.mulAssign(this.morphBaseInfluence);const A=de(u.width);ri(o,({i:p})=>{const g=re(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?g.assign(Zi(this.mesh.morphTexture,Sr(de(p).add(1),de(Bu))).r):g.assign(pi("morphTargetInfluences","float").element(p).toVar()),bn(g.notEqual(0),()=>{i===!0&&nr.addAssign(_S({bufferMap:a,influence:g,stride:l,width:A,depth:p,offset:de(0)})),r===!0&&Js.addAssign(_S({bufferMap:a,influence:g,stride:l,width:A,depth:p,offset:de(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,i)=>t+i,0)}}const jN=Qe(lie).setParameterLength(1);class CA extends jt{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class uie extends CA{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class cie extends gR{static get type(){return"LightingContextNode"}constructor(e,t=null,i=null,r=null){super(e),this.lightingModel=t,this.backdropNode=i,this.backdropAlphaNode=r,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,i=xe().toVar("directDiffuse"),r=xe().toVar("directSpecular"),s=xe().toVar("indirectDiffuse"),o=xe().toVar("indirectSpecular"),a={directDiffuse:i,directSpecular:r,indirectDiffuse:s,indirectSpecular:o};return{radiance:xe().toVar("radiance"),irradiance:xe().toVar("irradiance"),iblIrradiance:xe().toVar("iblIrradiance"),ambientOcclusion:re(1).toVar("ambientOcclusion"),reflectedLight:a,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const XN=Qe(cie);class hie extends CA{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}let i0,r0;class gr extends jt{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===gr.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=mn.NONE;return(this.scope===gr.SIZE||this.scope===gr.VIEWPORT)&&(e=mn.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===gr.VIEWPORT?t!==null?r0.copy(t.viewport):(e.getViewport(r0),r0.multiplyScalar(e.getPixelRatio())):t!==null?(i0.width=t.width,i0.height=t.height):e.getDrawingBufferSize(i0)}setup(){const e=this.scope;let t=null;return e===gr.SIZE?t=qt(i0||(i0=new at)):e===gr.VIEWPORT?t=qt(r0||(r0=new $t)):t=Je(bp.div(Hd)),t}generate(e){if(this.scope===gr.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const i=e.getNodeProperties(Hd).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${i}.y - ${t}.y )`}return t}return super.generate(e)}}gr.COORDINATE="coordinate";gr.VIEWPORT="viewport";gr.SIZE="size";gr.UV="uv";const Aa=gt(gr,gr.UV),Hd=gt(gr,gr.SIZE),bp=gt(gr,gr.COORDINATE),Bf=gt(gr,gr.VIEWPORT),QN=Bf.zw,YN=bp.sub(Bf.xy),fie=YN.div(QN),Aie=Re(()=>(console.warn('THREE.TSL: "viewportResolution" is deprecated. Use "screenSize" instead.'),Hd),"vec2").once()(),die=Re(()=>(console.warn('THREE.TSL: "viewportTopLeft" is deprecated. Use "screenUV" instead.'),Aa),"vec2").once()(),pie=Re(()=>(console.warn('THREE.TSL: "viewportBottomLeft" is deprecated. Use "screenUV.flipY()" instead.'),Aa.flipY()),"vec2").once()(),s0=new at;class B2 extends tl{static get type(){return"ViewportTextureNode"}constructor(e=Aa,t=null,i=null){i===null&&(i=new rE,i.minFilter=zs),super(i,e,t),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=mn.FRAME}updateBefore(e){const t=e.renderer;t.getDrawingBufferSize(s0);const i=this.value;(i.image.width!==s0.width||i.image.height!==s0.height)&&(i.image.width=s0.width,i.image.height=s0.height,i.needsUpdate=!0);const r=i.generateMipmaps;i.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(i),i.generateMipmaps=r}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const mie=Qe(B2).setParameterLength(0,3),lb=Qe(B2,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let R3=null;class gie extends B2{static get type(){return"ViewportDepthTextureNode"}constructor(e=Aa,t=null){R3===null&&(R3=new Ys),super(e,t,R3)}}const ub=Qe(gie).setParameterLength(0,2);class Ws extends jt{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===Ws.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,i=this.valueNode;let r=null;if(t===Ws.DEPTH_BASE)i!==null&&(r=KN().assign(i));else if(t===Ws.DEPTH)e.isPerspectiveCamera?r=ZN(ur.z,Tu,Mu):r=Ff(ur.z,Tu,Mu);else if(t===Ws.LINEAR_DEPTH)if(i!==null)if(e.isPerspectiveCamera){const s=cb(i,Tu,Mu);r=Ff(s,Tu,Mu)}else r=i;else r=Ff(ur.z,Tu,Mu);return r}}Ws.DEPTH_BASE="depthBase";Ws.DEPTH="depth";Ws.LINEAR_DEPTH="linearDepth";const Ff=(n,e,t)=>n.add(e).div(e.sub(t)),_ie=(n,e,t)=>e.sub(t).mul(n).sub(e),ZN=(n,e,t)=>e.add(n).mul(t).div(t.sub(e).mul(n)),cb=(n,e,t)=>e.mul(t).div(t.sub(e).mul(n).sub(t)),hb=(n,e,t)=>{e=e.max(1e-6).toVar();const i=ja(n.negate().div(e)),r=ja(t.div(e));return i.div(r)},vie=(n,e,t)=>{const i=n.mul(w2(t.div(e)));return re(Math.E).pow(i).mul(e).negate()},KN=Qe(Ws,Ws.DEPTH_BASE),fb=gt(Ws,Ws.DEPTH),Ig=Qe(Ws,Ws.LINEAR_DEPTH).setParameterLength(0,1),yie=Ig(ub());fb.assign=n=>KN(n);class Go extends jt{static get type(){return"ClippingNode"}constructor(e=Go.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:i,unionPlanes:r}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===Go.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(i,r):this.scope===Go.HARDWARE?this.setupHardwareClipping(r,e):this.setupDefault(i,r)}setupAlphaToCoverage(e,t){return Re(()=>{const i=re().toVar("distanceToPlane"),r=re().toVar("distanceToGradient"),s=re(1).toVar("clipOpacity"),o=t.length;if(this.hardwareClipping===!1&&o>0){const l=Fo(t);ri(o,({i:u})=>{const A=l.element(u);i.assign(ur.dot(A.xyz).negate().add(A.w)),r.assign(i.fwidth().div(2)),s.mulAssign(el(r.negate(),r,i))})}const a=e.length;if(a>0){const l=Fo(e),u=re(1).toVar("intersectionClipOpacity");ri(a,({i:A})=>{const p=l.element(A);i.assign(ur.dot(p.xyz).negate().add(p.w)),r.assign(i.fwidth().div(2)),u.mulAssign(el(r.negate(),r,i).oneMinus())}),s.mulAssign(u.oneMinus())}Kn.a.mulAssign(s),Kn.a.equal(0).discard()})()}setupDefault(e,t){return Re(()=>{const i=t.length;if(this.hardwareClipping===!1&&i>0){const s=Fo(t);ri(i,({i:o})=>{const a=s.element(o);ur.dot(a.xyz).greaterThan(a.w).discard()})}const r=e.length;if(r>0){const s=Fo(e),o=Hl(!0).toVar("clipped");ri(r,({i:a})=>{const l=s.element(a);o.assign(ur.dot(l.xyz).greaterThan(l.w).and(o))}),o.discard()}})()}setupHardwareClipping(e,t){const i=e.length;return t.enableHardwareClipping(i),Re(()=>{const r=Fo(e),s=mp(t.getClipDistance());ri(i,({i:o})=>{const a=r.element(o),l=ur.dot(a.xyz).sub(a.w).negate();s.element(o).assign(l)})})()}}Go.ALPHA_TO_COVERAGE="alphaToCoverage";Go.DEFAULT="default";Go.HARDWARE="hardware";const xie=()=>je(new Go),bie=()=>je(new Go(Go.ALPHA_TO_COVERAGE)),wie=()=>je(new Go(Go.HARDWARE)),Sie=.05,vS=Re(([n])=>Zl(gn(1e4,mo(gn(17,n.x).add(gn(.1,n.y)))).mul(hr(.1,wi(mo(gn(13,n.y).add(n.x))))))),yS=Re(([n])=>vS(Je(vS(n.xy),n.z))),Tie=Re(([n])=>{const e=sr(Fl($4(n.xyz)),Fl(W4(n.xyz))),t=re(1).div(re(Sie).mul(e)).toVar("pixScale"),i=Je(AA(Xa(ja(t))),AA(S2(ja(t)))),r=Je(yS(Xa(i.x.mul(n.xyz))),yS(Xa(i.y.mul(n.xyz)))),s=Zl(ja(t)),o=hr(gn(s.oneMinus(),r.x),gn(s,r.y)),a=Ks(s,s.oneMinus()),l=xe(o.mul(o).div(gn(2,a).mul(Gn(1,a))),o.sub(gn(.5,a)).div(Gn(1,a)),Gn(1,Gn(1,o).mul(Gn(1,o)).div(gn(2,a).mul(Gn(1,a))))),u=o.lessThan(a.oneMinus()).select(o.lessThan(a).select(l.x,l.y),l.z);return Ja(u,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class Mie extends GR{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e),i=e.hasGeometryAttribute(t);let r;return i===!0?r=super.generate(e):r=e.generateConst(this.nodeType,new $t(1,1,1,1)),r}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const JN=(n=0)=>je(new Mie(n));class fr extends ds{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+Y9(this)}build(e){this.setup(e)}setupObserver(e){return new Ate(e)}setup(e){e.context.setupNormal=()=>this.setupNormal(e),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,i=t.getRenderTarget();e.addStack();const r=this.vertexNode||this.setupVertex(e);e.stack.outputNode=r,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let s;const o=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(i!==null?i.depthBuffer===!0&&this.setupDepth(e):t.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const a=this.setupLighting(e);o!==null&&e.stack.add(o);const l=zt(a,Kn.a).max(0);s=this.setupOutput(e,l),If.assign(s);const u=this.outputNode!==null;if(u&&(s=this.outputNode),i!==null){const A=t.getMRT(),p=this.mrtNode;A!==null?(u&&If.assign(s),s=A,p!==null&&(s=A.merge(p))):p!==null&&(s=p)}}else{let a=this.fragmentNode;a.isOutputStructNode!==!0&&(a=zt(a)),s=this.setupOutput(e,a)}e.stack.outputNode=s,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:t,intersectionPlanes:i}=e.clippingContext;let r=null;if(t.length>0||i.length>0){const s=e.renderer.samples;this.alphaToCoverage&&s>1?r=bie():e.stack.add(xie())}return r}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add(wie()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:i}=e;let r=this.depthNode;if(r===null){const s=t.getMRT();s&&s.has("depth")?r=s.get("depth"):t.logarithmicDepthBuffer===!0&&(i.isPerspectiveCamera?r=hb(ur.z,Tu,Mu):r=Ff(ur.z,Tu,Mu))}r!==null&&fb.assign(r).toStack()}setupPositionView(){return dh.mul(nr).xyz}setupModelViewProjection(){return Ah.mul(ur)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),ab}setupPosition(e){const{object:t,geometry:i}=e;if((i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color)&&jN(t).toStack(),t.isSkinnedMesh===!0&&$N(t).toStack(),this.displacementMap){const r=Rl("displacementMap","texture"),s=Rl("displacementScale","float"),o=Rl("displacementBias","float");nr.addAssign(Js.normalize().mul(r.x.mul(s).add(o)))}return t.isBatchedMesh&&zN(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&qN(t).toStack(),this.positionNode!==null&&nr.assign(this.positionNode.context({isPositionNodeInput:!0})),nr}setupDiffuseColor({object:e,geometry:t}){let i=this.colorNode?zt(this.colorNode):uN;this.vertexColors===!0&&t.hasAttribute("color")&&(i=i.mul(JN())),e.instanceColor&&(i=kd("vec3","vInstanceColor").mul(i)),e.isBatchedMesh&&e._colorsTexture&&(i=kd("vec3","vBatchColor").mul(i)),Kn.assign(i);const r=this.opacityNode?re(this.opacityNode):sb;if(Kn.a.assign(Kn.a.mul(r)),this.alphaTestNode!==null||this.alphaTest>0){const s=this.alphaTestNode!==null?re(this.alphaTestNode):lN;Kn.a.lessThanEqual(s).discard()}this.alphaHash===!0&&Kn.a.lessThan(Tie(nr)).discard(),this.transparent===!1&&this.blending===Fs&&this.alphaToCoverage===!1&&Kn.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?xe(0):Kn.rgb}setupNormal(){return this.normalNode?xe(this.normalNode):mN}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?Rl("envMap","cubeTexture"):Rl("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new hie(ob)),t}setupLights(e){const t=[],i=this.setupEnvironment(e);i&&i.isLightingNode&&t.push(i);const r=this.setupLightMap(e);if(r&&r.isLightingNode&&t.push(r),this.aoNode!==null||e.material.aoMap){const o=this.aoNode!==null?this.aoNode:ON;t.push(new uie(o))}let s=this.lightsNode||e.lightsNode;return t.length>0&&(s=e.renderer.lighting.createNode([...s.getLights(),...t])),s}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:i,backdropAlphaNode:r,emissiveNode:s}=this,a=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let l=this.setupOutgoingLight(e);if(a&&a.getScope().hasLights){const u=this.setupLightingModel(e)||null;l=XN(a,u,i,r)}else i!==null&&(l=xe(r!==null?ii(l,i,r):i));return(s&&s.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(Py.assign(xe(s||hN)),l=l.add(Py)),l}setupFog(e,t){const i=e.fogNode;return i&&(If.assign(t),t=zt(i)),t}setupOutput(e,t){return this.fog===!0&&(t=this.setupFog(e,t)),t}setDefaultValues(e){for(const i in e){const r=e[i];this[i]===void 0&&(this[i]=r,r&&r.clone&&(this[i]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const i in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,i)===void 0&&t[i].get!==void 0&&Object.defineProperty(this.constructor.prototype,i,t[i])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const i=ds.prototype.toJSON.call(this,e),r=Tg(this);i.inputNodes={};for(const{property:o,childNode:a}of r)i.inputNodes[o]=a.toJSON(e).uuid;function s(o){const a=[];for(const l in o){const u=o[l];delete u.metadata,a.push(u)}return a}if(t){const o=s(e.textures),a=s(e.images),l=s(e.nodes);o.length>0&&(i.textures=o),a.length>0&&(i.images=a),l.length>0&&(i.nodes=l)}return i}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const Eie=new SA;class Cie extends fr{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(Eie),this.setValues(e)}}const Rie=new dz;class Nie extends fr{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(Rie),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?re(this.offsetNode):BN,t=this.dashScaleNode?re(this.dashScaleNode):LN,i=this.dashSizeNode?re(this.dashSizeNode):DN,r=this.gapSizeNode?re(this.gapSizeNode):IN;x1.assign(i),Ly.assign(r);const s=To(jl("lineDistance").mul(t));(e?s.add(e):s).mod(x1.add(Ly)).greaterThan(x1).discard()}}let N3=null;class Pie extends B2{static get type(){return"ViewportSharedTextureNode"}constructor(e=Aa,t=null){N3===null&&(N3=new rE),super(e,t,N3)}updateReference(){return this}}const Lie=Qe(Pie).setParameterLength(0,2),eP=n=>je(n).mul(.5).add(.5),Die=n=>je(n).mul(2).sub(1),Iie=new cz;class Bie extends fr{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(Iie),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?re(this.opacityNode):sb;Kn.assign(C2(zt(eP(tr),e),Ht))}}class Fie extends or{static get type(){return"EquirectUVNode"}constructor(e=tb){super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,t=e.z.atan(e.x).mul(1/(Math.PI*2)).add(.5),i=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return Je(t,i)}}const Ab=Qe(Fie).setParameterLength(0,1);class tP extends tE{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const i=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const s=new $u(5,5,5),o=Ab(tb),a=new fr;a.colorNode=In(t,o,0),a.side=_i,a.blending=vo;const l=new Jn(s,a),u=new r2;u.add(l),t.minFilter===zs&&(t.minFilter=Tr);const A=new eE(1,10,this),p=e.getMRT();return e.setMRT(null),A.update(e,u),e.setMRT(p),t.minFilter=i,t.currentGenerateMipmaps=r,l.geometry.dispose(),l.material.dispose(),this}}const j0=new WeakMap;class Uie extends or{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=dA(null);const t=new i2;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=mn.RENDER}updateBefore(e){const{renderer:t,material:i}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const s=r.isTextureNode?r.value:i[r.property];if(s&&s.isTexture){const o=s.mapping;if(o===Yc||o===Zc){if(j0.has(s)){const a=j0.get(s);xS(a,s.mapping),this._cubeTexture=a}else{const a=s.image;if(Oie(a)){const l=new tP(a.height);l.fromEquirectangularTexture(t,s),xS(l.texture,s.mapping),this._cubeTexture=l.texture,j0.set(s,l.texture),s.addEventListener("dispose",nP)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function Oie(n){return n==null?!1:n.height>0}function nP(n){const e=n.target;e.removeEventListener("dispose",nP);const t=j0.get(e);t!==void 0&&(j0.delete(e),t.dispose())}function xS(n,e){e===Yc?n.mapping=ga:e===Zc&&(n.mapping=_a)}const iP=Qe(Uie).setParameterLength(1);class db extends CA{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=iP(this.envNode)}}class kie extends CA{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=re(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class F2{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class rP extends F2{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,i=e.reflectedLight,r=e.irradianceLightMap;i.indirectDiffuse.assign(zt(0)),r?i.indirectDiffuse.addAssign(r):i.indirectDiffuse.addAssign(zt(1,1,1,0)),i.indirectDiffuse.mulAssign(t),i.indirectDiffuse.mulAssign(Kn.rgb)}finish(e){const{material:t,context:i}=e,r=i.outgoingLight,s=e.context.environment;if(s)switch(t.combine){case tp:r.rgb.assign(ii(r.rgb,r.rgb.mul(s.rgb),W0.mul(T1)));break;case G7:r.rgb.assign(ii(r.rgb,s.rgb,W0.mul(T1)));break;case q7:r.rgb.addAssign(s.rgb.mul(W0.mul(T1)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",t.combine);break}}}const Vie=new ia;class Gie extends fr{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Vie),this.setValues(e)}setupNormal(){return Wo}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new db(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new kie(ob)),t}setupOutgoingLight(){return Kn.rgb}setupLightingModel(){return new rP}}const pA=Re(({f0:n,f90:e,dotVH:t})=>{const i=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return n.mul(i.oneMinus()).add(e.mul(i))}),lh=Re(n=>n.diffuseColor.mul(1/Math.PI)),qie=()=>re(.25),zie=Re(({dotNH:n})=>Rg.mul(re(.5)).add(1).mul(re(1/Math.PI)).mul(n.pow(Rg))),Hie=Re(({lightDirection:n})=>{const e=n.add(Li).normalize(),t=tr.dot(e).clamp(),i=Li.dot(e).clamp(),r=pA({f0:Vs,f90:1,dotVH:i}),s=qie(),o=zie({dotNH:t});return r.mul(s).mul(o)});class sP extends rP{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:i}){const s=tr.dot(e).clamp().mul(t);i.directDiffuse.addAssign(s.mul(lh({diffuseColor:Kn.rgb}))),this.specular===!0&&i.directSpecular.addAssign(s.mul(Hie({lightDirection:e})).mul(W0))}indirect(e){const{ambientOcclusion:t,irradiance:i,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(i.mul(lh({diffuseColor:Kn}))),r.indirectDiffuse.mulAssign(t)}}const $ie=new ll;class Wie extends fr{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues($ie),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new db(t):null}setupLightingModel(){return new sP(!1)}}const jie=new gE;class Xie extends fr{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(jie),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new db(t):null}setupLightingModel(){return new sP}setupVariants(){const e=(this.shininessNode?re(this.shininessNode):cN).max(1e-4);Rg.assign(e);const t=this.specularNode||fN;Vs.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const oP=Re(n=>{if(n.geometry.hasAttribute("normal")===!1)return re(0);const e=Wo.dFdx().abs().max(Wo.dFdy().abs());return e.x.max(e.y).max(e.z)}),pb=Re(n=>{const{roughness:e}=n,t=oP();let i=e.max(.0525);return i=i.add(t),i=i.min(1),i}),aP=Re(({alpha:n,dotNL:e,dotNV:t})=>{const i=n.pow2(),r=e.mul(i.add(i.oneMinus().mul(t.pow2())).sqrt()),s=t.mul(i.add(i.oneMinus().mul(e.pow2())).sqrt());return va(.5,r.add(s).max(zC))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),Qie=Re(({alphaT:n,alphaB:e,dotTV:t,dotBV:i,dotTL:r,dotBL:s,dotNV:o,dotNL:a})=>{const l=a.mul(xe(n.mul(t),e.mul(i),o).length()),u=o.mul(xe(n.mul(r),e.mul(s),a).length());return va(.5,l.add(u)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),lP=Re(({alpha:n,dotNH:e})=>{const t=n.pow2(),i=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(i.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),Yie=re(1/Math.PI),Zie=Re(({alphaT:n,alphaB:e,dotNH:t,dotTH:i,dotBH:r})=>{const s=n.mul(e),o=xe(e.mul(i),n.mul(r),s.mul(t)),a=o.dot(o),l=s.div(a);return Yie.mul(s.mul(l.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),ky=Re(n=>{const{lightDirection:e,f0:t,f90:i,roughness:r,f:s,USE_IRIDESCENCE:o,USE_ANISOTROPY:a}=n,l=n.normalView||tr,u=r.pow2(),A=e.add(Li).normalize(),p=l.dot(e).clamp(),g=l.dot(Li).clamp(),v=l.dot(A).clamp(),x=Li.dot(A).clamp();let S=pA({f0:t,f90:i,dotVH:x}),T,w;if(Ud(o)&&(S=x2.mix(S,s)),Ud(a)){const R=z0.dot(e),E=z0.dot(Li),N=z0.dot(A),D=Hc.dot(e),B=Hc.dot(Li),I=Hc.dot(A);T=Qie({alphaT:Cg,alphaB:u,dotTV:E,dotBV:B,dotTL:R,dotBL:D,dotNV:g,dotNL:p}),w=Zie({alphaT:Cg,alphaB:u,dotNH:v,dotTH:N,dotBH:I})}else T=aP({alpha:u,dotNL:p,dotNV:g}),w=lP({alpha:u,dotNH:v});return S.mul(T).mul(w)}),mb=Re(({roughness:n,dotNV:e})=>{const t=zt(-1,-.0275,-.572,.022),i=zt(1,.0425,1.04,-.04),r=n.mul(t).add(i),s=r.x.mul(r.x).min(e.mul(-9.28).exp2()).mul(r.x).add(r.y);return Je(-1.04,1.04).mul(s).add(r.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),uP=Re(n=>{const{dotNV:e,specularColor:t,specularF90:i,roughness:r}=n,s=mb({dotNV:e,roughness:r});return t.mul(s.x).add(i.mul(s.y))}),cP=Re(({f:n,f90:e,dotVH:t})=>{const i=t.oneMinus().saturate(),r=i.mul(i),s=i.mul(r,r).clamp(0,.9999);return n.sub(xe(e).mul(s)).div(s.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),Kie=Re(({roughness:n,dotNH:e})=>{const t=n.pow2(),i=re(1).div(t),s=e.pow2().oneMinus().max(.0078125);return re(2).add(i).mul(s.pow(i.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),Jie=Re(({dotNV:n,dotNL:e})=>re(1).div(re(4).mul(e.add(n).sub(e.mul(n))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),ere=Re(({lightDirection:n})=>{const e=n.add(Li).normalize(),t=tr.dot(n).clamp(),i=tr.dot(Li).clamp(),r=tr.dot(e).clamp(),s=Kie({roughness:y2,dotNH:r}),o=Jie({dotNV:i,dotNL:t});return Ic.mul(s).mul(o)}),tre=Re(({N:n,V:e,roughness:t})=>{const s=.0078125,o=n.dot(e).saturate(),a=Je(t,o.oneMinus().sqrt());return a.assign(a.mul(.984375).add(s)),a}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),nre=Re(({f:n})=>{const e=n.length();return sr(e.mul(e).add(n.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),Lm=Re(({v1:n,v2:e})=>{const t=n.dot(e),i=t.abs().toVar(),r=i.mul(.0145206).add(.4965155).mul(i).add(.8543985).toVar(),s=i.add(4.1616724).mul(i).add(3.417594).toVar(),o=r.div(s),a=t.greaterThan(0).select(o,sr(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(o));return n.cross(e).mul(a)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),bS=Re(({N:n,V:e,P:t,mInv:i,p0:r,p1:s,p2:o,p3:a})=>{const l=s.sub(r).toVar(),u=a.sub(r).toVar(),A=l.cross(u),p=xe().toVar();return bn(A.dot(t.sub(r)).greaterThanEqual(0),()=>{const g=e.sub(n.mul(e.dot(n))).normalize(),v=n.cross(g).negate(),x=i.mul(ps(g,v,n).transpose()).toVar(),S=x.mul(r.sub(t)).normalize().toVar(),T=x.mul(s.sub(t)).normalize().toVar(),w=x.mul(o.sub(t)).normalize().toVar(),R=x.mul(a.sub(t)).normalize().toVar(),E=xe(0).toVar();E.addAssign(Lm({v1:S,v2:T})),E.addAssign(Lm({v1:T,v2:w})),E.addAssign(Lm({v1:w,v2:R})),E.addAssign(Lm({v1:R,v2:S})),p.assign(xe(nre({f:E})))}),p}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),U2=1/6,hP=n=>gn(U2,gn(n,gn(n,n.negate().add(3)).sub(3)).add(1)),Vy=n=>gn(U2,gn(n,gn(n,gn(3,n).sub(6))).add(4)),fP=n=>gn(U2,gn(n,gn(n,gn(-3,n).add(3)).add(3)).add(1)),Gy=n=>gn(U2,la(n,3)),wS=n=>hP(n).add(Vy(n)),SS=n=>fP(n).add(Gy(n)),TS=n=>hr(-1,Vy(n).div(hP(n).add(Vy(n)))),MS=n=>hr(1,Gy(n).div(fP(n).add(Gy(n)))),ES=(n,e,t)=>{const i=n.uvNode,r=gn(i,e.zw).add(.5),s=Xa(r),o=Zl(r),a=wS(o.x),l=SS(o.x),u=TS(o.x),A=MS(o.x),p=TS(o.y),g=MS(o.y),v=Je(s.x.add(u),s.y.add(p)).sub(.5).mul(e.xy),x=Je(s.x.add(A),s.y.add(p)).sub(.5).mul(e.xy),S=Je(s.x.add(u),s.y.add(g)).sub(.5).mul(e.xy),T=Je(s.x.add(A),s.y.add(g)).sub(.5).mul(e.xy),w=wS(o.y).mul(hr(a.mul(n.sample(v).level(t)),l.mul(n.sample(x).level(t)))),R=SS(o.y).mul(hr(a.mul(n.sample(S).level(t)),l.mul(n.sample(T).level(t))));return w.add(R)},AP=Re(([n,e=re(3)])=>{const t=Je(n.size(de(e))),i=Je(n.size(de(e.add(1)))),r=va(1,t),s=va(1,i),o=ES(n,zt(r,t),Xa(e)),a=ES(n,zt(s,i),S2(e));return Zl(e).mix(o,a)}),CS=Re(([n,e,t,i,r])=>{const s=xe(Y4(e.negate(),$l(n),va(1,i))),o=xe(Fl(r[0].xyz),Fl(r[1].xyz),Fl(r[2].xyz));return $l(s).mul(t.mul(o))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),ire=Re(([n,e])=>n.mul(Ja(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),rre=lb(),sre=lb(),RS=Re(([n,e,t],{material:i})=>{const s=(i.side===_i?rre:sre).sample(n),o=ja(Hd.x).mul(ire(e,t));return AP(s,o)}),NS=Re(([n,e,t])=>(bn(t.notEqual(0),()=>{const i=w2(e).negate().div(t);return q4(i.negate().mul(n))}),xe(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),ore=Re(([n,e,t,i,r,s,o,a,l,u,A,p,g,v,x])=>{let S,T;if(x){S=zt().toVar(),T=xe().toVar();const D=A.sub(1).mul(x.mul(.025)),B=xe(A.sub(D),A,A.add(D));ri({start:0,end:3},({i:I})=>{const O=B.element(I),L=CS(n,e,p,O,a),F=o.add(L),V=u.mul(l.mul(zt(F,1))),H=Je(V.xy.div(V.w)).toVar();H.addAssign(1),H.divAssign(2),H.assign(Je(H.x,H.y.oneMinus()));const Q=RS(H,t,O);S.element(I).assign(Q.element(I)),S.a.addAssign(Q.a),T.element(I).assign(i.element(I).mul(NS(Fl(L),g,v).element(I)))}),S.a.divAssign(3)}else{const D=CS(n,e,p,A,a),B=o.add(D),I=u.mul(l.mul(zt(B,1))),O=Je(I.xy.div(I.w)).toVar();O.addAssign(1),O.divAssign(2),O.assign(Je(O.x,O.y.oneMinus())),S=RS(O,t,A),T=i.mul(NS(Fl(D),g,v))}const w=T.rgb.mul(S.rgb),R=n.dot(e).clamp(),E=xe(uP({dotNV:R,specularColor:r,specularF90:s,roughness:t})),N=T.r.add(T.g,T.b).div(3);return zt(E.oneMinus().mul(w),S.a.oneMinus().mul(N).oneMinus())}),are=ps(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),lre=n=>{const e=n.sqrt();return xe(1).add(e).div(xe(1).sub(e))},PS=(n,e)=>n.sub(e).div(n.add(e)).pow2(),ure=(n,e)=>{const t=n.mul(2*Math.PI*1e-9),i=xe(54856e-17,44201e-17,52481e-17),r=xe(1681e3,1795300,2208400),s=xe(43278e5,93046e5,66121e5),o=re(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let a=i.mul(s.mul(2*Math.PI).sqrt()).mul(r.mul(t).add(e).cos()).mul(t.pow2().negate().mul(s).exp());return a=xe(a.x.add(o),a.y,a.z).div(10685e-11),are.mul(a)},cre=Re(({outsideIOR:n,eta2:e,cosTheta1:t,thinFilmThickness:i,baseF0:r})=>{const s=ii(n,e,el(0,.03,i)),a=n.div(s).pow2().mul(t.pow2().oneMinus()).oneMinus();bn(a.lessThan(0),()=>xe(1));const l=a.sqrt(),u=PS(s,n),A=pA({f0:u,f90:1,dotVH:t}),p=A.oneMinus(),g=s.lessThan(n).select(Math.PI,0),v=re(Math.PI).sub(g),x=lre(r.clamp(0,.9999)),S=PS(x,s.toVec3()),T=pA({f0:S,f90:1,dotVH:l}),w=xe(x.x.lessThan(s).select(Math.PI,0),x.y.lessThan(s).select(Math.PI,0),x.z.lessThan(s).select(Math.PI,0)),R=s.mul(i,l,2),E=xe(v).add(w),N=A.mul(T).clamp(1e-5,.9999),D=N.sqrt(),B=p.pow2().mul(T).div(xe(1).sub(N)),O=A.add(B).toVar(),L=B.sub(p).toVar();return ri({start:1,end:2,condition:"<=",name:"m"},({m:F})=>{L.mulAssign(D);const V=ure(re(F).mul(R),re(F).mul(E)).mul(2);O.addAssign(L.mul(V))}),O.max(xe(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),hre=Re(({normal:n,viewDir:e,roughness:t})=>{const i=n.dot(e).saturate(),r=t.pow2(),s=Or(t.lessThan(.25),re(-339.2).mul(r).add(re(161.4).mul(t)).sub(25.9),re(-8.48).mul(r).add(re(14.3).mul(t)).sub(9.95)),o=Or(t.lessThan(.25),re(44).mul(r).sub(re(23.7).mul(t)).add(3.26),re(1.97).mul(r).sub(re(3.27).mul(t)).add(.72));return Or(t.lessThan(.25),0,re(.1).mul(t).sub(.025)).add(s.mul(i).add(o).exp()).mul(1/Math.PI).saturate()}),P3=xe(.04),L3=re(1);class dP extends F2{constructor(e=!1,t=!1,i=!1,r=!1,s=!1,o=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=i,this.anisotropy=r,this.transmission=s,this.dispersion=o,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=xe().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=xe().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=xe().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=xe().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=xe().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=tr.dot(Li).clamp();this.iridescenceFresnel=cre({outsideIOR:re(1),eta2:D4,cosTheta1:t,thinFilmThickness:I4,baseF0:Vs}),this.iridescenceF0=cP({f:this.iridescenceFresnel,f90:1,dotVH:t})}if(this.transmission===!0){const t=Ul,i=HR.sub(Ul).normalize(),r=L2,s=e.context;s.backdrop=ore(r,i,Va,Kn,Vs,qd,t,Oo,eo,Ah,H0,B4,U4,F4,this.dispersion?O4:null),s.backdropAlpha=Ng,Kn.a.mulAssign(ii(1,s.backdrop.a,Ng))}super.start(e)}computeMultiscattering(e,t,i){const r=tr.dot(Li).clamp(),s=mb({roughness:Va,dotNV:r}),a=(this.iridescenceF0?x2.mix(Vs,this.iridescenceF0):Vs).mul(s.x).add(i.mul(s.y)),u=s.x.add(s.y).oneMinus(),A=Vs.add(Vs.oneMinus().mul(.047619)),p=a.mul(A).div(u.mul(A).oneMinus());e.addAssign(a),t.addAssign(p.mul(u))}direct({lightDirection:e,lightColor:t,reflectedLight:i}){const s=tr.dot(e).clamp().mul(t);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(s.mul(ere({lightDirection:e}))),this.clearcoat===!0){const a=_f.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(a.mul(ky({lightDirection:e,f0:P3,f90:L3,roughness:Gd,normalView:_f})))}i.directDiffuse.addAssign(s.mul(lh({diffuseColor:Kn.rgb}))),i.directSpecular.addAssign(s.mul(ky({lightDirection:e,f0:Vs,f90:1,roughness:Va,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:i,halfHeight:r,reflectedLight:s,ltc_1:o,ltc_2:a}){const l=t.add(i).sub(r),u=t.sub(i).sub(r),A=t.sub(i).add(r),p=t.add(i).add(r),g=tr,v=Li,x=ur.toVar(),S=tre({N:g,V:v,roughness:Va}),T=o.sample(S).toVar(),w=a.sample(S).toVar(),R=ps(xe(T.x,0,T.y),xe(0,1,0),xe(T.z,0,T.w)).toVar(),E=Vs.mul(w.x).add(Vs.oneMinus().mul(w.y)).toVar();s.directSpecular.addAssign(e.mul(E).mul(bS({N:g,V:v,P:x,mInv:R,p0:l,p1:u,p2:A,p3:p}))),s.directDiffuse.addAssign(e.mul(Kn).mul(bS({N:g,V:v,P:x,mInv:ps(1,0,0,0,1,0,0,0,1),p0:l,p1:u,p2:A,p3:p})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:i}=e.context;i.indirectDiffuse.addAssign(t.mul(lh({diffuseColor:Kn})))}indirectSpecular(e){const{radiance:t,iblIrradiance:i,reflectedLight:r}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(i.mul(Ic,hre({normal:tr,viewDir:Li,roughness:y2}))),this.clearcoat===!0){const A=_f.dot(Li).clamp(),p=uP({dotNV:A,specularColor:P3,specularF90:L3,roughness:Gd});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(p))}const s=xe().toVar("singleScattering"),o=xe().toVar("multiScattering"),a=i.mul(1/Math.PI);this.computeMultiscattering(s,o,qd);const l=s.add(o),u=Kn.mul(l.r.max(l.g).max(l.b).oneMinus());r.indirectSpecular.addAssign(t.mul(s)),r.indirectSpecular.addAssign(o.mul(a)),r.indirectDiffuse.addAssign(u.mul(a))}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:i}=e.context,s=tr.dot(Li).clamp().add(t),o=Va.mul(-16).oneMinus().negate().exp2(),a=t.sub(s.pow(o).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(t),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(t),i.indirectDiffuse.mulAssign(t),i.indirectSpecular.mulAssign(a)}finish({context:e}){const{outgoingLight:t}=e;if(this.clearcoat===!0){const i=_f.dot(Li).clamp(),r=pA({dotVH:i,f0:P3,f90:L3}),s=t.mul(Eg.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(Eg));t.assign(s)}if(this.sheen===!0){const i=Ic.r.max(Ic.g).max(Ic.b).mul(.157).oneMinus(),r=t.mul(i).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(r)}}}const LS=re(1),qy=re(-2),Dm=re(.8),D3=re(-1),Im=re(.4),I3=re(2),Bm=re(.305),B3=re(3),DS=re(.21),fre=re(4),IS=re(4),Are=re(16),dre=Re(([n])=>{const e=xe(wi(n)).toVar(),t=re(-1).toVar();return bn(e.x.greaterThan(e.z),()=>{bn(e.x.greaterThan(e.y),()=>{t.assign(Or(n.x.greaterThan(0),0,3))}).Else(()=>{t.assign(Or(n.y.greaterThan(0),1,4))})}).Else(()=>{bn(e.z.greaterThan(e.y),()=>{t.assign(Or(n.z.greaterThan(0),2,5))}).Else(()=>{t.assign(Or(n.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),pre=Re(([n,e])=>{const t=Je().toVar();return bn(e.equal(0),()=>{t.assign(Je(n.z,n.y).div(wi(n.x)))}).ElseIf(e.equal(1),()=>{t.assign(Je(n.x.negate(),n.z.negate()).div(wi(n.y)))}).ElseIf(e.equal(2),()=>{t.assign(Je(n.x.negate(),n.y).div(wi(n.z)))}).ElseIf(e.equal(3),()=>{t.assign(Je(n.z.negate(),n.y).div(wi(n.x)))}).ElseIf(e.equal(4),()=>{t.assign(Je(n.x.negate(),n.z).div(wi(n.y)))}).Else(()=>{t.assign(Je(n.x,n.y).div(wi(n.z)))}),gn(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),mre=Re(([n])=>{const e=re(0).toVar();return bn(n.greaterThanEqual(Dm),()=>{e.assign(LS.sub(n).mul(D3.sub(qy)).div(LS.sub(Dm)).add(qy))}).ElseIf(n.greaterThanEqual(Im),()=>{e.assign(Dm.sub(n).mul(I3.sub(D3)).div(Dm.sub(Im)).add(D3))}).ElseIf(n.greaterThanEqual(Bm),()=>{e.assign(Im.sub(n).mul(B3.sub(I3)).div(Im.sub(Bm)).add(I3))}).ElseIf(n.greaterThanEqual(DS),()=>{e.assign(Bm.sub(n).mul(fre.sub(B3)).div(Bm.sub(DS)).add(B3))}).Else(()=>{e.assign(re(-2).mul(ja(gn(1.16,n))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),pP=Re(([n,e])=>{const t=n.toVar();t.assign(gn(2,t).sub(1));const i=xe(t,1).toVar();return bn(e.equal(0),()=>{i.assign(i.zyx)}).ElseIf(e.equal(1),()=>{i.assign(i.xzy),i.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{i.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{i.assign(i.zyx),i.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{i.assign(i.xzy),i.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{i.z.mulAssign(-1)}),i}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),mP=Re(([n,e,t,i,r,s])=>{const o=re(t),a=xe(e),l=Ja(mre(o),qy,s),u=Zl(l),A=Xa(l),p=xe(zy(n,a,A,i,r,s)).toVar();return bn(u.notEqual(0),()=>{const g=xe(zy(n,a,A.add(1),i,r,s)).toVar();p.assign(ii(p,g,u))}),p}),zy=Re(([n,e,t,i,r,s])=>{const o=re(t).toVar(),a=xe(e),l=re(dre(a)).toVar(),u=re(sr(IS.sub(o),0)).toVar();o.assign(sr(o,IS));const A=re(AA(o)).toVar(),p=Je(pre(a,l).mul(A.sub(2)).add(1)).toVar();return bn(l.greaterThan(2),()=>{p.y.addAssign(A),l.subAssign(3)}),p.x.addAssign(l.mul(A)),p.x.addAssign(u.mul(gn(3,Are))),p.y.addAssign(gn(4,AA(s).sub(A))),p.x.mulAssign(i),p.y.mulAssign(r),n.sample(p).grad(Je(),Je())}),F3=Re(({envMap:n,mipInt:e,outputDirection:t,theta:i,axis:r,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:a})=>{const l=Sl(i),u=t.mul(l).add(r.cross(t).mul(mo(i))).add(r.mul(r.dot(t).mul(l.oneMinus())));return zy(n,u,e,s,o,a)}),gP=Re(({n,latitudinal:e,poleAxis:t,outputDirection:i,weights:r,samples:s,dTheta:o,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:A,CUBEUV_MAX_MIP:p})=>{const g=xe(Or(e,t,M2(t,i))).toVar();bn(g.equal(xe(0)),()=>{g.assign(xe(i.z,0,i.x.negate()))}),g.assign($l(g));const v=xe().toVar();return v.addAssign(r.element(0).mul(F3({theta:0,axis:g,outputDirection:i,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:A,CUBEUV_MAX_MIP:p}))),ri({start:de(1),end:n},({i:x})=>{bn(x.greaterThanEqual(s),()=>{WN()});const S=re(o.mul(re(x))).toVar();v.addAssign(r.element(x).mul(F3({theta:S.mul(-1),axis:g,outputDirection:i,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:A,CUBEUV_MAX_MIP:p}))),v.addAssign(r.element(x).mul(F3({theta:S,axis:g,outputDirection:i,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:A,CUBEUV_MAX_MIP:p})))}),zt(v,1)}),vf=4,BS=[.125,.215,.35,.446,.526,.582],Cc=20,U3=new u2(-1,1,1,-1,0,1),gre=new Br(90,1),FS=new Ft;let O3=null,k3=0,V3=0;const Tc=(1+Math.sqrt(5))/2,Qh=1/Tc,US=[new ie(-Tc,Qh,0),new ie(Tc,Qh,0),new ie(-Qh,0,Tc),new ie(Qh,0,Tc),new ie(0,Tc,-Qh),new ie(0,Tc,Qh),new ie(-1,1,-1),new ie(1,1,-1),new ie(-1,1,1),new ie(1,1,1)],_re=new ie,_P=new WeakMap,vre=[3,1,5,0,4,2],G3=pP(Oi(),jl("faceIndex")).normalize(),gb=xe(G3.x,G3.y,G3.z);class yre{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,i=.1,r=100,s={}){const{size:o=256,position:a=_re,renderTarget:l=null}=s;if(this._setSize(o),this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");const A=l||this._allocateTargets();return s.renderTarget=A,this.fromSceneAsync(e,t,i,r,s),A}O3=this._renderer.getRenderTarget(),k3=this._renderer.getActiveCubeFace(),V3=this._renderer.getActiveMipmapLevel();const u=l||this._allocateTargets();return u.depthBuffer=!0,this._sceneToCubeUV(e,i,r,u,a),t>0&&this._blur(u,0,0,t),this._applyPMREM(u),this._cleanup(u),u}async fromSceneAsync(e,t=0,i=.1,r=100,s={}){return this._hasInitialized===!1&&await this._renderer.init(),this.fromScene(e,t,i,r,s)}fromEquirectangular(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);const i=t||this._allocateTargets();return this.fromEquirectangularAsync(e,i),i}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const i=t||this._allocateTargets();return this.fromCubemapAsync(e,t),i}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=kS(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=VS(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===ga||e.mapping===_a?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(O3,k3,V3),e.scissorTest=!1,Fm(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),O3=this._renderer.getRenderTarget(),k3=this._renderer.getActiveCubeFace(),V3=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Tr,minFilter:Tr,generateMipmaps:!1,type:Mr,format:ir,colorSpace:ha},r=OS(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=OS(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=xre(s)),this._blurMaterial=bre(s,e,t)}return r}async _compileMaterial(e){const t=new Jn(this._lodPlanes[0],e);await this._renderer.compile(t,U3)}_sceneToCubeUV(e,t,i,r,s){const o=gre;o.near=t,o.far=i;const a=[1,1,1,1,-1,1],l=[1,-1,1,-1,1,-1],u=this._renderer,A=u.autoClear;u.getClearColor(FS),u.autoClear=!1;let p=this._backgroundBox;if(p===null){const x=new ia({name:"PMREM.Background",side:_i,depthWrite:!1,depthTest:!1});p=new Jn(new $u,x)}let g=!1;const v=e.background;v?v.isColor&&(p.material.color.copy(v),e.background=null,g=!0):(p.material.color.copy(FS),g=!0),u.setRenderTarget(r),u.clear(),g&&u.render(p,o);for(let x=0;x<6;x++){const S=x%3;S===0?(o.up.set(0,a[x],0),o.position.set(s.x,s.y,s.z),o.lookAt(s.x+l[x],s.y,s.z)):S===1?(o.up.set(0,0,a[x]),o.position.set(s.x,s.y,s.z),o.lookAt(s.x,s.y+l[x],s.z)):(o.up.set(0,a[x],0),o.position.set(s.x,s.y,s.z),o.lookAt(s.x,s.y,s.z+l[x]));const T=this._cubeSize;Fm(r,S*T,x>2?T:0,T,T),u.render(e,o)}u.autoClear=A,e.background=v}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===ga||e.mapping===_a;r?this._cubemapMaterial===null&&(this._cubemapMaterial=kS(e)):this._equirectMaterial===null&&(this._equirectMaterial=VS(e));const s=r?this._cubemapMaterial:this._equirectMaterial;s.fragmentNode.value=e;const o=this._lodMeshes[0];o.material=s;const a=this._cubeSize;Fm(t,0,0,3*a,2*a),i.setRenderTarget(t),i.render(o,U3)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=US[(r-s-1)%US.length];this._blur(e,s-1,s,o,a)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const A=3,p=this._lodMeshes[r];p.material=u;const g=_P.get(u),v=this._sizeLods[i]-1,x=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*Cc-1),S=s/x,T=isFinite(s)?1+Math.floor(A*S):Cc;T>Cc&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${T} samples when the maximum is set to ${Cc}`);const w=[];let R=0;for(let I=0;I<Cc;++I){const O=I/S,L=Math.exp(-O*O/2);w.push(L),I===0?R+=L:I<T&&(R+=2*L)}for(let I=0;I<w.length;I++)w[I]=w[I]/R;e.texture.frame=(e.texture.frame||0)+1,g.envMap.value=e.texture,g.samples.value=T,g.weights.array=w,g.latitudinal.value=o==="latitudinal"?1:0,a&&(g.poleAxis.value=a);const{_lodMax:E}=this;g.dTheta.value=x,g.mipInt.value=E-i;const N=this._sizeLods[r],D=3*N*(r>E-vf?r-E+vf:0),B=4*(this._cubeSize-N);Fm(t,D,B,3*N,2*N),l.setRenderTarget(t),l.render(p,U3)}}function xre(n){const e=[],t=[],i=[],r=[];let s=n;const o=n-vf+1+BS.length;for(let a=0;a<o;a++){const l=Math.pow(2,s);t.push(l);let u=1/l;a>n-vf?u=BS[a-n+vf-1]:a===0&&(u=0),i.push(u);const A=1/(l-2),p=-A,g=1+A,v=[p,p,g,p,g,g,p,p,g,g,p,g],x=6,S=6,T=3,w=2,R=1,E=new Float32Array(T*S*x),N=new Float32Array(w*S*x),D=new Float32Array(R*S*x);for(let I=0;I<x;I++){const O=I%3*2/3-1,L=I>2?0:-1,F=[O,L,0,O+2/3,L,0,O+2/3,L+1,0,O,L,0,O+2/3,L+1,0,O,L+1,0],V=vre[I];E.set(F,T*S*V),N.set(v,w*S*V);const H=[V,V,V,V,V,V];D.set(H,R*S*V)}const B=new Ai;B.setAttribute("position",new Gi(E,T)),B.setAttribute("uv",new Gi(N,w)),B.setAttribute("faceIndex",new Gi(D,R)),e.push(B),r.push(new Jn(B,null)),s>vf&&s--}return{lodPlanes:e,sizeLods:t,sigmas:i,lodMeshes:r}}function OS(n,e,t){const i=new ol(n,e,t);return i.texture.mapping=Kc,i.texture.name="PMREM.cubeUv",i.texture.isPMREMTexture=!0,i.scissorTest=!0,i}function Fm(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function _b(n){const e=new fr;return e.depthTest=!1,e.depthWrite=!1,e.blending=vo,e.name=`PMREM_${n}`,e}function bre(n,e,t){const i=Fo(new Array(Cc).fill(0)),r=qt(new ie(0,1,0)),s=qt(0),o=re(Cc),a=qt(0),l=qt(1),u=In(null),A=qt(0),p=re(1/e),g=re(1/t),v=re(n),x={n:o,latitudinal:a,weights:i,poleAxis:r,outputDirection:gb,dTheta:s,samples:l,envMap:u,mipInt:A,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:g,CUBEUV_MAX_MIP:v},S=_b("blur");return S.fragmentNode=gP({...x,latitudinal:a.equal(1)}),_P.set(S,x),S}function kS(n){const e=_b("cubemap");return e.fragmentNode=dA(n,gb),e}function VS(n){const e=_b("equirect");return e.fragmentNode=In(n,Ab(gb),0),e}const GS=new WeakMap;function wre(n){const e=Math.log2(n)-2,t=1/n;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:t,maxMip:e}}function Sre(n,e,t){const i=Tre(e);let r=i.get(n);if((r!==void 0?r.pmremVersion:-1)!==n.pmremVersion){const o=n.image;if(n.isCubeTexture)if(Ere(o))r=t.fromCubemap(n,r);else return null;else if(Cre(o))r=t.fromEquirectangular(n,r);else return null;r.pmremVersion=n.pmremVersion,i.set(n,r)}return r.texture}function Tre(n){let e=GS.get(n);return e===void 0&&(e=new WeakMap,GS.set(n,e)),e}class Mre extends or{static get type(){return"PMREMNode"}constructor(e,t=null,i=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=i,this._generator=null;const r=new vr;r.isRenderTargetTexture=!0,this._texture=In(r),this._width=qt(0),this._height=qt(0),this._maxMip=qt(0),this.updateBeforeType=mn.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=wre(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const i=t?t.pmremVersion:-1,r=this._value;i!==r.pmremVersion&&(r.isPMREMTexture===!0?t=r:t=Sre(r,e.renderer,this._generator),t!==null&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){this._generator===null&&(this._generator=new yre(e.renderer)),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this)),t=ib.mul(xe(t.x,t.y.negate(),t.z));let i=this.levelNode;return i===null&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),mP(this._texture,t,i,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function Ere(n){if(n==null)return!1;let e=0;const t=6;for(let i=0;i<t;i++)n[i]!==void 0&&e++;return e===t}function Cre(n){return n==null?!1:n.height>0}const vb=Qe(Mre).setParameterLength(1,3),qS=new WeakMap;class Rre extends CA{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let i=this.envNode;if(i.isTextureNode||i.isMaterialReferenceNode){const p=i.isTextureNode?i.value:t[i.property];let g=qS.get(p);g===void 0&&(g=vb(p),qS.set(p,g)),i=g}const s=t.useAnisotropy===!0||t.anisotropy>0?oN:tr,o=i.context(zS(Va,s)).mul(S1),a=i.context(Nre(L2)).mul(Math.PI).mul(S1),l=$0(o),u=$0(a);e.context.radiance.addAssign(l),e.context.iblIrradiance.addAssign(u);const A=e.context.lightingModel.clearcoatRadiance;if(A){const p=i.context(zS(Gd,_f)).mul(S1),g=$0(p);A.addAssign(g)}}}const zS=(n,e)=>{let t=null;return{getUV:()=>(t===null&&(t=Li.negate().reflect(e),t=n.mul(n).mix(t,e).normalize(),t=t.transformDirection(eo)),t),getTextureLevel:()=>n}},Nre=n=>({getUV:()=>n,getTextureLevel:()=>re(1)}),Pre=new mE;class vP extends fr{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(Pre),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new Rre(t):null}setupLightingModel(){return new dP}setupSpecular(){const e=ii(xe(.04),Kn.rgb,Vd);Vs.assign(e),qd.assign(1)}setupVariants(){const e=this.metalnessNode?re(this.metalnessNode):pN;Vd.assign(e);let t=this.roughnessNode?re(this.roughnessNode):dN;t=pb({roughness:t}),Va.assign(t),this.setupSpecular(),Kn.assign(zt(Kn.rgb.mul(e.oneMinus()),Kn.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const Lre=new lz;class Dre extends vP{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(Lre),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?re(this.iorNode):RN;H0.assign(e),Vs.assign(ii(Ks(X4(H0.sub(1).div(H0.add(1))).mul(AN),xe(1)).mul(Oy),Kn.rgb,Vd)),qd.assign(ii(Oy,1,Vd))}setupLightingModel(){return new dP(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?re(this.clearcoatNode):gN,i=this.clearcoatRoughnessNode?re(this.clearcoatRoughnessNode):_N;Eg.assign(t),Gd.assign(pb({roughness:i}))}if(this.useSheen){const t=this.sheenNode?xe(this.sheenNode):xN,i=this.sheenRoughnessNode?re(this.sheenRoughnessNode):bN;Ic.assign(t),y2.assign(i)}if(this.useIridescence){const t=this.iridescenceNode?re(this.iridescenceNode):SN,i=this.iridescenceIORNode?re(this.iridescenceIORNode):TN,r=this.iridescenceThicknessNode?re(this.iridescenceThicknessNode):MN;x2.assign(t),D4.assign(i),I4.assign(r)}if(this.useAnisotropy){const t=(this.anisotropyNode?Je(this.anisotropyNode):wN).toVar();wu.assign(t.length()),bn(wu.equal(0),()=>{t.assign(Je(1,0))}).Else(()=>{t.divAssign(Je(wu)),wu.assign(wu.saturate())}),Cg.assign(wu.pow2().mix(Va.pow2(),1)),z0.assign(Bc[0].mul(t.x).add(Bc[1].mul(t.y))),Hc.assign(Bc[1].mul(t.x).sub(Bc[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?re(this.transmissionNode):EN,i=this.thicknessNode?re(this.thicknessNode):CN,r=this.attenuationDistanceNode?re(this.attenuationDistanceNode):NN,s=this.attenuationColorNode?xe(this.attenuationColorNode):PN;if(Ng.assign(t),B4.assign(i),F4.assign(r),U4.assign(s),this.useDispersion){const o=this.dispersionNode?re(this.dispersionNode):UN;O4.assign(o)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?xe(this.clearcoatNormalNode):vN}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const Ire=Re(({normal:n,lightDirection:e,builder:t})=>{const i=n.dot(e),r=Je(i.mul(.5).add(.5),0);if(t.material.gradientMap){const s=Rl("gradientMap","texture").context({getUV:()=>r});return xe(s.r)}else{const s=r.fwidth().mul(.5);return ii(xe(.7),xe(1),el(re(.7).sub(s.x),re(.7).add(s.x),r.x))}});class Bre extends F2{direct({lightDirection:e,lightColor:t,reflectedLight:i},r){const s=Ire({normal:N2,lightDirection:e,builder:r}).mul(t);i.directDiffuse.addAssign(s.mul(lh({diffuseColor:Kn.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:i,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(i.mul(lh({diffuseColor:Kn}))),r.indirectDiffuse.mulAssign(t)}}const Fre=new uz;class Ure extends fr{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Fre),this.setValues(e)}setupLightingModel(){return new Bre}}class Ore extends or{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const e=xe(Li.z,0,Li.x.negate()).normalize(),t=Li.cross(e);return Je(e.dot(tr),t.dot(tr)).mul(.495).add(.5)}}const yP=gt(Ore),kre=new Az;class Vre extends fr{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(kre),this.setValues(e)}setupVariants(e){const t=yP;let i;e.material.matcap?i=Rl("matcap","texture").context({getUV:()=>t}):i=xe(ii(.2,.8,t.y)),Kn.rgb.mulAssign(i.rgb)}}class Gre extends or{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:i}=this;if(this.getNodeType(e)==="vec2"){const s=t.cos(),o=t.sin();return v2(s,o,o.negate(),s).mul(i)}else{const s=t,o=zc(zt(1,0,0,0),zt(0,Sl(s.x),mo(s.x).negate(),0),zt(0,mo(s.x),Sl(s.x),0),zt(0,0,0,1)),a=zc(zt(Sl(s.y),0,mo(s.y),0),zt(0,1,0,0),zt(mo(s.y).negate(),0,Sl(s.y),0),zt(0,0,0,1)),l=zc(zt(Sl(s.z),mo(s.z).negate(),0,0),zt(mo(s.z),Sl(s.z),0,0),zt(0,0,1,0),zt(0,0,0,1));return o.mul(a).mul(l).mul(zt(i,1)).xyz}}}const O2=Qe(Gre).setParameterLength(2),qre=new Zx;class xP extends fr{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(qre),this.setValues(e)}setupPositionView(e){const{object:t,camera:i}=e,r=this.sizeAttenuation,{positionNode:s,rotationNode:o,scaleNode:a}=this,l=dh.mul(xe(s||0));let u=Je(Oo[0].xyz.length(),Oo[1].xyz.length());if(a!==null&&(u=u.mul(Je(a))),r===!1)if(i.isPerspectiveCamera)u=u.mul(l.z.negate());else{const v=re(2).div(Ah.element(1).element(1));u=u.mul(v.mul(2))}let A=gp.xy;if(t.center&&t.center.isVector2===!0){const v=Jte("center","vec2",t);A=A.sub(v.sub(.5))}A=A.mul(u);const p=re(o||yN),g=O2(A,p);return zt(l.xy.add(g),l.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const zre=new Jx;class Hre extends xP{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(zre),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return dh.mul(xe(e||nr)).xyz}setupVertex(e){const t=super.setupVertex(e);if(e.material.isNodeMaterial!==!0)return t;const{rotationNode:i,scaleNode:r,sizeNode:s}=this,o=gp.xy.toVar(),a=Bf.z.div(Bf.w);if(i&&i.isNode){const u=re(i);o.assign(O2(o,u))}let l=s!==null?Je(s):FN;return this.sizeAttenuation===!0&&(l=l.mul(l.div(ur.z.negate()))),r&&r.isNode&&(l=l.mul(Je(r))),o.mulAssign(l.mul(2)),o.assign(o.div(Bf.z)),o.y.assign(o.y.mul(a)),o.assign(o.mul(t.w)),t.addAssign(zt(o,0,0)),t}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}class $re extends F2{constructor(){super(),this.shadowNode=re(1).toVar("shadowMask")}direct({lightNode:e}){this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){Kn.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(Kn.rgb)}}const Wre=new az;class jre extends fr{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(Wre),this.setValues(e)}setupLightingModel(){return new $re}}EA("vec3");EA("vec3");EA("vec3");class Xre{constructor(e,t){this.nodes=e,this.info=t,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,i)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this._animationLoop!==null&&this._animationLoop(t,i)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class ya{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let i=0;i<e.length-1;i++)if(t=t.get(e[i]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let i=this.weakMap;for(let r=0;r<e.length-1;r++){const s=e[r];i.has(s)===!1&&i.set(s,new WeakMap),i=i.get(s)}return i.set(e[e.length-1],t),this}delete(e){let t=this.weakMap;for(let i=0;i<e.length-1;i++)if(t=t.get(e[i]),t===void 0)return!1;return t.delete(e[e.length-1])}}let Qre=0;function Yre(n){const e=Object.keys(n);let t=Object.getPrototypeOf(n);for(;t;){const i=Object.getOwnPropertyDescriptors(t);for(const r in i)if(i[r]!==void 0){const s=i[r];s&&typeof s.get=="function"&&e.push(r)}t=Object.getPrototypeOf(t)}return e}class Zre{constructor(e,t,i,r,s,o,a,l,u,A){this.id=Qre++,this._nodes=e,this._geometries=t,this.renderer=i,this.object=r,this.material=s,this.scene=o,this.camera=a,this.lightsNode=l,this.context=u,this.geometry=r.geometry,this.version=s.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=A,this.clippingContextCacheKey=A!==null?A.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,i=[],r=new Set;for(const s of e){const o=s.node&&s.node.attribute?s.node.attribute:t.getAttribute(s.name);if(o===void 0)continue;i.push(o);const a=o.isInterleavedBufferAttribute?o.data:o;r.add(a)}return this.attributes=i,this.vertexBuffers=Array.from(r.values()),i}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:i,group:r,drawRange:s}=this,o=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),a=this.getIndex(),l=a!==null;let u=1;if(i.isInstancedBufferGeometry===!0?u=i.instanceCount:e.count!==void 0&&(u=Math.max(0,e.count)),u===0)return null;if(o.instanceCount=u,e.isBatchedMesh===!0)return o;let A=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(A=2);let p=s.start*A,g=(s.start+s.count)*A;r!==null&&(p=Math.max(p,r.start*A),g=Math.min(g,(r.start+r.count)*A));const v=i.attributes.position;let x=1/0;l?x=a.count:v!=null&&(x=v.count),p=Math.max(p,0),g=Math.min(g,x);const S=g-p;return S<0||S===1/0?null:(o.vertexCount=S,o.firstVertex=p,o)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const i of Object.keys(e.attributes).sort()){const r=e.attributes[i];t+=i+",",r.data&&(t+=r.data.stride+","),r.offset&&(t+=r.offset+","),r.itemSize&&(t+=r.itemSize+","),r.normalized&&(t+="n,")}for(const i of Object.keys(e.morphAttributes).sort()){const r=e.morphAttributes[i];t+="morph-"+i+",";for(let s=0,o=r.length;s<o;s++){const a=r[s];t+=a.id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t}=this;let i=t.customProgramCacheKey();for(const r of Yre(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(r))continue;const s=t[r];let o;if(s!==null){const a=typeof s;a==="number"?o=s!==0?"1":"0":a==="object"?(o="{",s.isTexture&&(o+=s.mapping),o+="}"):o=String(s)}else o=String(s);i+=o+","}return i+=this.clippingContextCacheKey+",",e.geometry&&(i+=this.getGeometryCacheKey()),e.skeleton&&(i+=e.skeleton.bones.length+","),e.isBatchedMesh&&(i+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(i+=e._colorsTexture.uuid+",")),e.count>1&&(i+=e.uuid+","),i+=e.receiveShadow+",",Q9(i)}get needsGeometryUpdate(){return this.geometry.id!==this.object.geometry.id}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=Fd(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=Fd(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const Ac=[];class Kre{constructor(e,t,i,r,s,o){this.renderer=e,this.nodes=t,this.geometries=i,this.pipelines=r,this.bindings=s,this.info=o,this.chainMaps={}}get(e,t,i,r,s,o,a,l){const u=this.getChainMap(l);Ac[0]=e,Ac[1]=t,Ac[2]=o,Ac[3]=s;let A=u.get(Ac);return A===void 0?(A=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,i,r,s,o,a,l),u.set(Ac,A)):(A.updateClipping(a),A.needsGeometryUpdate&&A.setGeometry(e.geometry),(A.version!==t.version||A.needsUpdate)&&(A.initialCacheKey!==A.getCacheKey()?(A.dispose(),A=this.get(e,t,i,r,s,o,a,l)):A.version=t.version)),Ac.length=0,A}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new ya)}dispose(){this.chainMaps={}}createRenderObject(e,t,i,r,s,o,a,l,u,A,p){const g=this.getChainMap(p),v=new Zre(e,t,i,r,s,o,a,l,u,A);return v.onDispose=()=>{this.pipelines.delete(v),this.bindings.delete(v),this.nodes.delete(v),g.delete(v.getChainArray())},v}}class ju{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const ko={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},Eu=16,Jre=211,ese=212;class tse extends ju{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==null&&this.backend.destroyAttribute(e),t}update(e,t){const i=this.get(e);if(i.version===void 0)t===ko.VERTEX?this.backend.createAttribute(e):t===ko.INDEX?this.backend.createIndexAttribute(e):t===ko.STORAGE?this.backend.createStorageAttribute(e):t===ko.INDIRECT&&this.backend.createIndirectStorageAttribute(e),i.version=this._getBufferAttribute(e).version;else{const r=this._getBufferAttribute(e);(i.version<r.version||r.usage===cf)&&(this.backend.updateAttribute(e),i.version=r.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function bP(n){return n.index!==null?n.index.version:n.attributes.position.version}function HS(n){const e=[],t=n.index,i=n.attributes.position;if(t!==null){const s=t.array;for(let o=0,a=s.length;o<a;o+=3){const l=s[o+0],u=s[o+1],A=s[o+2];e.push(l,u,u,A,A,l)}}else{const s=i.array;for(let o=0,a=s.length/3-1;o<a;o+=3){const l=o+0,u=o+1,A=o+2;e.push(l,u,u,A,A,l)}}const r=new($x(e)?Qx:Xx)(e,1);return r.version=bP(n),r}class nse extends ju{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,i=this.get(t);i.initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const s=t.index,o=e.getAttributes();s!==null&&this.attributes.delete(s);for(const l of o)this.attributes.delete(l);const a=this.wireframes.get(t);a!==void 0&&this.attributes.delete(a),t.removeEventListener("dispose",r)};t.addEventListener("dispose",r)}updateAttributes(e){const t=e.getAttributes();for(const s of t)s.isStorageBufferAttribute||s.isStorageInstancedBufferAttribute?this.updateAttribute(s,ko.STORAGE):this.updateAttribute(s,ko.VERTEX);const i=this.getIndex(e);i!==null&&this.updateAttribute(i,ko.INDEX);const r=e.geometry.indirect;r!==null&&this.updateAttribute(r,ko.INDIRECT)}updateAttribute(e,t){const i=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,i)):this.attributeCall.get(e.data)!==i&&(this.attributes.update(e,t),this.attributeCall.set(e.data,i),this.attributeCall.set(e,i)):this.attributeCall.get(e)!==i&&(this.attributes.update(e,t),this.attributeCall.set(e,i))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:i}=e;let r=t.index;if(i.wireframe===!0){const s=this.wireframes;let o=s.get(t);o===void 0?(o=HS(t),s.set(t,o)):o.version!==bP(t)&&(this.attributes.delete(o),o=HS(t),s.set(t,o)),r=o}return r}}class ise{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,i){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=i*(t/3):e.isPoints?this.render.points+=i*t:e.isLineSegments?this.render.lines+=i*(t/2):e.isLine?this.render.lines+=i*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class wP{constructor(e){this.cacheKey=e,this.usedTimes=0}}class rse extends wP{constructor(e,t,i){super(e),this.vertexProgram=t,this.fragmentProgram=i}}class sse extends wP{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let ose=0;class q3{constructor(e,t,i,r=null,s=null){this.id=ose++,this.code=e,this.stage=t,this.name=i,this.transforms=r,this.attributes=s,this.usedTimes=0}}class ase extends ju{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:i}=this,r=this.get(e);if(this._needsComputeUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.computeProgram.usedTimes--);const o=this.nodes.getForCompute(e);let a=this.programs.compute.get(o.computeShader);a===void 0&&(s&&s.computeProgram.usedTimes===0&&this._releaseProgram(s.computeProgram),a=new q3(o.computeShader,"compute",e.name,o.transforms,o.nodeAttributes),this.programs.compute.set(o.computeShader,a),i.createProgram(a));const l=this._getComputeCacheKey(e,a);let u=this.caches.get(l);u===void 0&&(s&&s.usedTimes===0&&this._releasePipeline(s),u=this._getComputePipeline(e,a,l,t)),u.usedTimes++,a.usedTimes++,r.version=e.version,r.pipeline=u}return r.pipeline}getForRender(e,t=null){const{backend:i}=this,r=this.get(e);if(this._needsRenderUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.vertexProgram.usedTimes--,s.fragmentProgram.usedTimes--);const o=e.getNodeBuilderState(),a=e.material?e.material.name:"";let l=this.programs.vertex.get(o.vertexShader);l===void 0&&(s&&s.vertexProgram.usedTimes===0&&this._releaseProgram(s.vertexProgram),l=new q3(o.vertexShader,"vertex",a),this.programs.vertex.set(o.vertexShader,l),i.createProgram(l));let u=this.programs.fragment.get(o.fragmentShader);u===void 0&&(s&&s.fragmentProgram.usedTimes===0&&this._releaseProgram(s.fragmentProgram),u=new q3(o.fragmentShader,"fragment",a),this.programs.fragment.set(o.fragmentShader,u),i.createProgram(u));const A=this._getRenderCacheKey(e,l,u);let p=this.caches.get(A);p===void 0?(s&&s.usedTimes===0&&this._releasePipeline(s),p=this._getRenderPipeline(e,l,u,A,t)):e.pipeline=p,p.usedTimes++,l.usedTimes++,u.usedTimes++,r.pipeline=p}return r.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,i,r){i=i||this._getComputeCacheKey(e,t);let s=this.caches.get(i);return s===void 0&&(s=new sse(i,t),this.caches.set(i,s),this.backend.createComputePipeline(s,r)),s}_getRenderPipeline(e,t,i,r,s){r=r||this._getRenderCacheKey(e,t,i);let o=this.caches.get(r);return o===void 0&&(o=new rse(r,t,i),this.caches.set(r,o),e.pipeline=o,this.backend.createRenderPipeline(e,s)),o}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,i){return t.id+","+i.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,i=e.stage;this.programs[i].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class lse extends ju{constructor(e,t,i,r,s,o){super(),this.backend=e,this.textures=i,this.pipelines=s,this.attributes=r,this.nodes=t,this.info=o,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const i of t){const r=this.get(i);r.bindGroup===void 0&&(this._init(i),this.backend.createBindings(i,t,0),r.bindGroup=i)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const i of t){const r=this.get(i);r.bindGroup===void 0&&(this._init(i),this.backend.createBindings(i,t,0),r.bindGroup=i)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const i=t.attribute,r=i.isIndirectStorageBufferAttribute?ko.INDIRECT:ko.STORAGE;this.attributes.update(i,r)}}_update(e,t){const{backend:i}=this;let r=!1,s=!0,o=0,a=0;for(const l of e.bindings)if(!(l.isNodeUniformsGroup&&this.nodes.updateGroup(l)===!1)){if(l.isStorageBuffer){const u=l.attribute,A=u.isIndirectStorageBufferAttribute?ko.INDIRECT:ko.STORAGE;this.attributes.update(u,A)}if(l.isUniformBuffer)l.update()&&i.updateBinding(l);else if(l.isSampler)l.update();else if(l.isSampledTexture){const u=this.textures.get(l.texture);l.needsBindingsUpdate(u.generation)&&(r=!0);const A=l.update(),p=l.texture;A&&this.textures.updateTexture(p);const g=i.get(p);if(g.externalTexture!==void 0||u.isDefaultTexture?s=!1:(o=o*10+p.id,a+=p.version),i.isWebGPUBackend===!0&&g.texture===void 0&&g.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",l,A,p,l.textureNode.value,r),this.textures.updateTexture(p),r=!0),p.isStorageTexture===!0){const v=this.get(p);l.store===!0?v.needsMipmap=!0:this.textures.needsMipmaps(p)&&v.needsMipmap===!0&&(this.backend.generateMipmaps(p),v.needsMipmap=!1)}}}r===!0&&this.backend.updateBindings(e,t,s?o:0,a)}}function use(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?n.z-e.z:n.id-e.id}function $S(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function WS(n){return(n.transmission>0||n.transmissionNode)&&n.side===_r&&n.forceSinglePass===!1}class cse{constructor(e,t,i){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,i),this.lightsArray=[],this.scene=t,this.camera=i,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,i,r,s,o,a){let l=this.renderItems[this.renderItemsIndex];return l===void 0?(l={id:e.id,object:e,geometry:t,material:i,groupOrder:r,renderOrder:e.renderOrder,z:s,group:o,clippingContext:a},this.renderItems[this.renderItemsIndex]=l):(l.id=e.id,l.object=e,l.geometry=t,l.material=i,l.groupOrder=r,l.renderOrder=e.renderOrder,l.z=s,l.group=o,l.clippingContext=a),this.renderItemsIndex++,l}push(e,t,i,r,s,o,a){const l=this.getNextRenderItem(e,t,i,r,s,o,a);e.occlusionTest===!0&&this.occlusionQueryCount++,i.transparent===!0||i.transmission>0?(WS(i)&&this.transparentDoublePass.push(l),this.transparent.push(l)):this.opaque.push(l)}unshift(e,t,i,r,s,o,a){const l=this.getNextRenderItem(e,t,i,r,s,o,a);i.transparent===!0||i.transmission>0?(WS(i)&&this.transparentDoublePass.unshift(l),this.transparent.unshift(l)):this.opaque.unshift(l)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||use),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||$S),this.transparent.length>1&&this.transparent.sort(t||$S)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const i=this.renderItems[e];if(i.id===null)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.groupOrder=null,i.renderOrder=null,i.z=null,i.group=null,i.clippingContext=null}}}const o0=[];class hse{constructor(e){this.lighting=e,this.lists=new ya}get(e,t){const i=this.lists;o0[0]=e,o0[1]=t;let r=i.get(o0);return r===void 0&&(r=new cse(this.lighting,e,t),i.set(o0,r)),o0.length=0,r}dispose(){this.lists=new ya}}let fse=0;class Ase{constructor(){this.id=fse++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new $t,this.scissor=!1,this.scissorValue=new $t,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return SP(this)}}function SP(n){const{textures:e,activeCubeFace:t}=n,i=[t];for(const r of e)i.push(r.id);return p2(i)}const a0=[],dse=new r2,pse=new rp;class mse{constructor(){this.chainMaps={}}get(e,t,i=null){a0[0]=e,a0[1]=t;let r;if(i===null)r="default";else{const a=i.texture.format;r=`${i.textures.length}:${a}:${i.samples}:${i.depthBuffer}:${i.stencilBuffer}`}const s=this._getChainMap(r);let o=s.get(a0);return o===void 0&&(o=new Ase,s.set(a0,o)),a0.length=0,i!==null&&(o.sampleCount=i.samples===0?1:i.samples),o}getForClear(e=null){return this.get(dse,pse,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new ya)}dispose(){this.chainMaps={}}}const gse=new ie;class _se extends ju{constructor(e,t,i){super(),this.renderer=e,this.backend=t,this.info=i}updateRenderTarget(e,t=0){const i=this.get(e),r=e.samples===0?1:e.samples,s=i.depthTextureMips||(i.depthTextureMips={}),o=e.textures,a=this.getSize(o[0]),l=a.width>>t,u=a.height>>t;let A=e.depthTexture||s[t];const p=e.depthBuffer===!0||e.stencilBuffer===!0;let g=!1;A===void 0&&p&&(e.multiview===!0&&a.depth>1?A=new sE:A=new Ys,A.format=e.stencilBuffer?bo:xo,A.type=e.stencilBuffer?yo:bi,A.image.width=l,A.image.height=u,A.image.depth=a.depth,s[t]=A),(i.width!==a.width||a.height!==i.height)&&(g=!0,A&&(A.needsUpdate=!0,A.image.width=l,A.image.height=u,A.image.depth=A.isDepthArrayTexture?A.image.depth:1)),i.width=a.width,i.height=a.height,i.textures=o,i.depthTexture=A||null,i.depth=e.depthBuffer,i.stencil=e.stencilBuffer,i.renderTarget=e,i.sampleCount!==r&&(g=!0,A&&(A.needsUpdate=!0),i.sampleCount=r);const v={sampleCount:r};if(e.isXRRenderTarget!==!0){for(let x=0;x<o.length;x++){const S=o[x];S.isTextureArray=e.multiview===!0&&a.depth>1,g&&(S.needsUpdate=!0),this.updateTexture(S,v)}A&&this.updateTexture(A,v)}if(i.initialized!==!0){i.initialized=!0;const x=()=>{e.removeEventListener("dispose",x);for(let S=0;S<o.length;S++)this._destroyTexture(o[S]);A&&this._destroyTexture(A),this.delete(e)};e.addEventListener("dispose",x)}}updateTexture(e,t={}){const i=this.get(e);if(i.initialized===!0&&i.version===e.version)return;const r=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,s=this.backend;if(r&&i.initialized===!0&&(s.destroySampler(e),s.destroyTexture(e)),e.isFramebufferTexture){const u=this.renderer.getRenderTarget();u?e.type=u.texture.type:e.type=ji}const{width:o,height:a,depth:l}=this.getSize(e);if(t.width=o,t.height=a,t.depth=l,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,o,a):1,r||e.isStorageTexture===!0)s.createSampler(e),s.createTexture(e,t),i.generation=e.version;else if(i.initialized!==!0&&s.createSampler(e),e.version>0){const A=e.image;if(A===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(A.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const p=[];for(const g of e.images)p.push(g);t.images=p}else t.image=A;(i.isDefaultTexture===void 0||i.isDefaultTexture===!0)&&(s.createTexture(e,t),i.isDefaultTexture=!1,i.generation=e.version),e.source.dataReady===!0&&s.updateTexture(e,t),t.needsMipmaps&&e.mipmaps.length===0&&s.generateMipmaps(e)}}else s.createDefaultTexture(e),i.isDefaultTexture=!0,i.generation=e.version;if(i.initialized!==!0){i.initialized=!0,i.generation=e.version,this.info.memory.textures++;const u=()=>{e.removeEventListener("dispose",u),this._destroyTexture(e)};e.addEventListener("dispose",u)}i.version=e.version}getSize(e,t=gse){let i=e.images?e.images[0]:e.image;return i?(i.image!==void 0&&(i=i.image),t.width=i.width||1,t.height=i.height||1,t.depth=e.isCubeTexture?6:i.depth||1):t.width=t.height=t.depth=1,t}getMipLevels(e,t,i){let r;return e.isCompressedTexture?e.mipmaps?r=e.mipmaps.length:r=1:r=Math.floor(Math.log2(Math.max(t,i)))+1,r}needsMipmaps(e){return e.isCompressedTexture===!0||e.generateMipmaps}_destroyTexture(e){this.has(e)===!0&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class yb extends Ft{constructor(e,t,i,r=1){super(e,t,i),this.a=r}set(e,t,i,r=1){return this.a=r,super.set(e,t,i)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class TP extends si{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}const vse=(n,e)=>je(new TP(n,e));class yse extends jt{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.outputNode?this.outputNode.getMemberType(e,t):"void"}add(e){return this.nodes.push(e),this}If(e,t){const i=new gf(t);return this._currentCond=Or(e,i),this.add(this._currentCond)}ElseIf(e,t){const i=new gf(t),r=Or(e,i);return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new gf(e),this}Switch(e){return this._expressionNode=je(e),this}Case(...e){const t=[];if(e.length>=2)for(let a=0;a<e.length-1;a++)t.push(this._expressionNode.equal(je(e[a])));else throw new Error("TSL: Invalid parameter length. Case() requires at least two parameters.");const i=e[e.length-1],r=new gf(i);let s=t[0];for(let a=1;a<t.length;a++)s=s.or(t[a]);const o=Or(s,r);return this._currentCond===null?(this._currentCond=o,this.add(this._currentCond)):(this._currentCond.elseNode=o,this._currentCond=o,this)}Default(e){return this.Else(e),this}build(e,...t){const i=P4();Od(this);for(const r of this.nodes)r.build(e,"void");return Od(i),this.outputNode?this.outputNode.build(e,...t):super.build(e,...t)}else(...e){return console.warn("THREE.TSL: .else() has been renamed to .Else()."),this.Else(...e)}elseif(...e){return console.warn("THREE.TSL: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...e)}}const M1=Qe(yse).setParameterLength(0,1);function xse(n){return Object.entries(n).map(([e,t])=>typeof t=="string"?{name:e,type:t,atomic:!1}:{name:e,type:t.type,atomic:t.atomic||!1})}class bse extends jt{static get type(){return"StructTypeNode"}constructor(e,t=null){super("struct"),this.membersLayout=xse(e),this.name=t,this.isStructLayoutNode=!0}getLength(){let e=0;for(const t of this.membersLayout)e+=M4(t.type);return e}getMemberType(e,t){const i=this.membersLayout.find(r=>r.name===t);return i?i.type:"void"}getNodeType(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}setup(e){e.addInclude(this)}generate(e){return this.getNodeType(e)}}class wse extends jt{static get type(){return"StructNode"}constructor(e,t){super("vec3"),this.structLayoutNode=e,this.values=t,this.isStructNode=!0}getNodeType(e){return this.structLayoutNode.getNodeType(e)}getMemberType(e,t){return this.structLayoutNode.getMemberType(e,t)}generate(e){const t=e.getVarFromNode(this),i=t.type,r=e.getPropertyName(t);return e.addLineFlowCode(`${r} = ${e.generateStruct(i,this.structLayoutNode.membersLayout,this.values)}`,this),t.name}}const Sse=(n,e=null)=>{const t=new bse(n,e),i=(...r)=>{let s=null;if(r.length>0)if(r[0].isNode){s={};const o=Object.keys(n);for(let a=0;a<r.length;a++)s[o[a]]=r[a]}else s=r[0];return je(new wse(t,s))};return i.layout=t,i.isStruct=!0,i};class MP extends jt{static get type(){return"OutputStructNode"}constructor(...e){super(),this.members=e,this.isOutputStructNode=!0}getNodeType(e){const t=e.getNodeProperties(this);if(t.membersLayout===void 0){const i=this.members,r=[];for(let s=0;s<i.length;s++){const o="m"+s,a=i[s].getNodeType(e);r.push({name:o,type:a,index:s})}t.membersLayout=r,t.structType=e.getOutputStructTypeFromNode(this,t.membersLayout)}return t.structType.name}generate(e){const t=e.getOutputStructName(),i=this.members,r=t!==""?t+".":"";for(let s=0;s<i.length;s++){const o=i[s].build(e);e.addLineFlowCode(`${r}m${s} = ${o}`,this)}return t}}const Tse=Qe(MP);function EP(n,e){for(let t=0;t<n.length;t++)if(n[t].name===e)return t;return-1}class Mse extends MP{static get type(){return"MRTNode"}constructor(e){super(),this.outputNodes=e,this.isMRTNode=!0}has(e){return this.outputNodes[e]!==void 0}get(e){return this.outputNodes[e]}merge(e){const t={...this.outputNodes,...e.outputNodes};return CP(t)}setup(e){const t=this.outputNodes,i=e.renderer.getRenderTarget(),r=[],s=i.textures;for(const o in t){const a=EP(s,o);r[a]=zt(t[o])}return this.members=r,super.setup(e)}}const CP=Qe(Mse),Ese=Re(([n])=>{const e=n.toUint().mul(747796405).add(2891336453),t=e.shiftRight(e.shiftRight(28).add(4)).bitXor(e).mul(277803737);return t.shiftRight(22).bitXor(t).toFloat().mul(1/2**32)}),Hy=(n,e)=>la(gn(4,n.mul(Gn(1,n))),e),Cse=(n,e)=>n.lessThan(.5)?Hy(n.mul(2),e).div(2):Gn(1,Hy(gn(Gn(1,n),2),e).div(2)),Rse=(n,e,t)=>la(va(la(n,e),hr(la(n,e),la(Gn(1,n),t))),1/e),Nse=(n,e)=>mo(Pg.mul(e.mul(n).sub(1))).div(Pg.mul(e.mul(n).sub(1))),Tl=Re(([n])=>n.fract().sub(.5).abs()).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),Pse=Re(([n])=>xe(Tl(n.z.add(Tl(n.y.mul(1)))),Tl(n.z.add(Tl(n.x.mul(1)))),Tl(n.y.add(Tl(n.x.mul(1)))))).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Lse=Re(([n,e,t])=>{const i=xe(n).toVar(),r=re(1.4).toVar(),s=re(0).toVar(),o=xe(i).toVar();return ri({start:re(0),end:re(3),type:"float",condition:"<="},()=>{const a=xe(Pse(o.mul(2))).toVar();i.addAssign(a.add(t.mul(re(.1).mul(e)))),o.mulAssign(1.8),r.mulAssign(1.5),i.mulAssign(1.2);const l=re(Tl(i.z.add(Tl(i.x.add(Tl(i.y)))))).toVar();s.addAssign(l.div(r)),o.addAssign(.14)}),s}).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]});class Dse extends jt{static get type(){return"FunctionOverloadingNode"}constructor(e=[],...t){super(),this.functionNodes=e,this.parametersNodes=t,this._candidateFnCall=null,this.global=!0}getNodeType(){return this.functionNodes[0].shaderNode.layout.type}setup(e){const t=this.parametersNodes;let i=this._candidateFnCall;if(i===null){let r=null,s=-1;for(const o of this.functionNodes){const l=o.shaderNode.layout;if(l===null)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const u=l.inputs;if(t.length===u.length){let A=0;for(let p=0;p<t.length;p++){const g=t[p],v=u[p];g.getNodeType(e)===v.type?A++:A=0}A>s&&(r=o,s=A)}}this._candidateFnCall=i=r(...t)}return i}}const Ise=Qe(Dse),Kr=n=>(...e)=>Ise(n,...e),ph=qt(0).setGroup(Xt).onRenderUpdate(n=>n.time),RP=qt(0).setGroup(Xt).onRenderUpdate(n=>n.deltaTime),Bse=qt(0,"uint").setGroup(Xt).onRenderUpdate(n=>n.frameId),Fse=(n=1)=>(console.warn('TSL: timerLocal() is deprecated. Use "time" instead.'),ph.mul(n)),Use=(n=1)=>(console.warn('TSL: timerGlobal() is deprecated. Use "time" instead.'),ph.mul(n)),Ose=(n=1)=>(console.warn('TSL: timerDelta() is deprecated. Use "deltaTime" instead.'),RP.mul(n)),kse=(n=ph)=>n.add(.75).mul(Math.PI*2).sin().mul(.5).add(.5),Vse=(n=ph)=>n.fract().round(),Gse=(n=ph)=>n.add(.5).fract().mul(2).sub(1).abs(),qse=(n=ph)=>n.fract(),zse=Re(([n,e,t=Je(.5)])=>O2(n.sub(t),e).add(t)),Hse=Re(([n,e,t=Je(.5)])=>{const i=n.sub(t),r=i.dot(i),o=r.mul(r).mul(e);return n.add(i.mul(o))}),$se=Re(({position:n=null,horizontal:e=!0,vertical:t=!1})=>{let i;n!==null?(i=Oo.toVar(),i[3][0]=n.x,i[3][1]=n.y,i[3][2]=n.z):i=Oo;const r=eo.mul(i);return Ud(e)&&(r[0][0]=Oo[0].length(),r[0][1]=0,r[0][2]=0),Ud(t)&&(r[1][0]=0,r[1][1]=Oo[1].length(),r[1][2]=0),r[2][0]=0,r[2][1]=0,r[2][2]=1,Ah.mul(r).mul(nr)}),Wse=Re(([n=null])=>{const e=Ig();return Ig(ub(n)).sub(e).lessThan(0).select(Aa,n)});class jse extends jt{static get type(){return"SpriteSheetUVNode"}constructor(e,t=Oi(),i=re(0)){super("vec2"),this.countNode=e,this.uvNode=t,this.frameNode=i}setup(){const{frameNode:e,uvNode:t,countNode:i}=this,{width:r,height:s}=i,o=e.mod(r.mul(s)).floor(),a=o.mod(r),l=s.sub(o.add(1).div(r).ceil()),u=i.reciprocal(),A=Je(a,l);return t.add(A).mul(u)}}const Xse=Qe(jse).setParameterLength(3);class Qse extends jt{static get type(){return"TriplanarTexturesNode"}constructor(e,t=null,i=null,r=re(1),s=nr,o=Js){super("vec4"),this.textureXNode=e,this.textureYNode=t,this.textureZNode=i,this.scaleNode=r,this.positionNode=s,this.normalNode=o}setup(){const{textureXNode:e,textureYNode:t,textureZNode:i,scaleNode:r,positionNode:s,normalNode:o}=this;let a=o.abs().normalize();a=a.div(a.dot(xe(1)));const l=s.yz.mul(r),u=s.zx.mul(r),A=s.xy.mul(r),p=e.value,g=t!==null?t.value:p,v=i!==null?i.value:p,x=In(p,l).mul(a.x),S=In(g,u).mul(a.y),T=In(v,A).mul(a.z);return hr(x,S,T)}}const NP=Qe(Qse).setParameterLength(1,6),Yse=(...n)=>NP(...n),Yh=new bl,dc=new ie,Zh=new ie,z3=new ie,l0=new en,Um=new ie(0,0,-1),Na=new $t,u0=new ie,Om=new ie,c0=new $t,km=new at,Bg=new ol,Zse=Aa.flipX();Bg.depthTexture=new Ys(1,1);let H3=!1;class xb extends tl{static get type(){return"ReflectorNode"}constructor(e={}){super(e.defaultTexture||Bg.texture,Zse),this._reflectorBaseNode=e.reflector||new Kse(this,e),this._depthNode=null,this.setUpdateMatrix(!1)}get reflector(){return this._reflectorBaseNode}get target(){return this._reflectorBaseNode.target}getDepthNode(){if(this._depthNode===null){if(this._reflectorBaseNode.depth!==!0)throw new Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=je(new xb({defaultTexture:Bg.depthTexture,reflector:this._reflectorBaseNode}))}return this._depthNode}setup(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),super.setup(e)}clone(){const e=new this.constructor(this.reflectorNode);return e._reflectorBaseNode=this._reflectorBaseNode,e}dispose(){super.dispose(),this._reflectorBaseNode.dispose()}}class Kse extends jt{static get type(){return"ReflectorBaseNode"}constructor(e,t={}){super();const{target:i=new Ci,resolution:r=1,generateMipmaps:s=!1,bounces:o=!0,depth:a=!1}=t;this.textureNode=e,this.target=i,this.resolution=r,this.generateMipmaps=s,this.bounces=o,this.depth=a,this.updateBeforeType=o?mn.RENDER:mn.FRAME,this.virtualCameras=new WeakMap,this.renderTargets=new Map,this.forceUpdate=!1}_updateResolution(e,t){const i=this.resolution;t.getDrawingBufferSize(km),e.setSize(Math.round(km.width*i),Math.round(km.height*i))}setup(e){return this._updateResolution(Bg,e.renderer),super.setup(e)}dispose(){super.dispose();for(const e of this.renderTargets.values())e.dispose()}getVirtualCamera(e){let t=this.virtualCameras.get(e);return t===void 0&&(t=e.clone(),this.virtualCameras.set(e,t)),t}getRenderTarget(e){let t=this.renderTargets.get(e);return t===void 0&&(t=new ol(0,0,{type:Mr}),this.generateMipmaps===!0&&(t.texture.minFilter=gG,t.texture.generateMipmaps=!0),this.depth===!0&&(t.depthTexture=new Ys),this.renderTargets.set(e,t)),t}updateBefore(e){if(this.bounces===!1&&H3)return!1;H3=!0;const{scene:t,camera:i,renderer:r,material:s}=e,{target:o}=this,a=this.getVirtualCamera(i),l=this.getRenderTarget(a);if(r.getDrawingBufferSize(km),this._updateResolution(l,r),Zh.setFromMatrixPosition(o.matrixWorld),z3.setFromMatrixPosition(i.matrixWorld),l0.extractRotation(o.matrixWorld),dc.set(0,0,1),dc.applyMatrix4(l0),u0.subVectors(Zh,z3),u0.dot(dc)>0===!0&&this.forceUpdate===!1)return;u0.reflect(dc).negate(),u0.add(Zh),l0.extractRotation(i.matrixWorld),Um.set(0,0,-1),Um.applyMatrix4(l0),Um.add(z3),Om.subVectors(Zh,Um),Om.reflect(dc).negate(),Om.add(Zh),a.coordinateSystem=i.coordinateSystem,a.position.copy(u0),a.up.set(0,1,0),a.up.applyMatrix4(l0),a.up.reflect(dc),a.lookAt(Om),a.near=i.near,a.far=i.far,a.updateMatrixWorld(),a.projectionMatrix.copy(i.projectionMatrix),Yh.setFromNormalAndCoplanarPoint(dc,Zh),Yh.applyMatrix4(a.matrixWorldInverse),Na.set(Yh.normal.x,Yh.normal.y,Yh.normal.z,Yh.constant);const A=a.projectionMatrix;c0.x=(Math.sign(Na.x)+A.elements[8])/A.elements[0],c0.y=(Math.sign(Na.y)+A.elements[9])/A.elements[5],c0.z=-1,c0.w=(1+A.elements[10])/A.elements[14],Na.multiplyScalar(1/Na.dot(c0));const p=0;A.elements[2]=Na.x,A.elements[6]=Na.y,A.elements[10]=r.coordinateSystem===Za?Na.z-p:Na.z+1-p,A.elements[14]=Na.w,this.textureNode.value=l.texture,this.depth===!0&&(this.textureNode.getDepthNode().value=l.depthTexture),s.visible=!1;const g=r.getRenderTarget(),v=r.getMRT(),x=r.autoClear;r.setMRT(null),r.setRenderTarget(l),r.autoClear=!0,r.render(t,a),r.setMRT(v),r.setRenderTarget(g),r.autoClear=x,s.visible=!0,H3=!1,this.forceUpdate=!1}}const Jse=n=>je(new xb(n)),$3=new u2(-1,1,1,-1,0,1);class eoe extends Ai{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new ei([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new ei(t,2))}}const toe=new eoe;class bb extends Jn{constructor(e=null){super(toe,e),this.camera=$3,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,$3)}render(e){e.render(this,$3)}}const noe=new at;class ioe extends tl{static get type(){return"RTTNode"}constructor(e,t=null,i=null,r={type:Mr}){const s=new ol(t,i,r);super(s.texture,Oi()),this.node=e,this.width=t,this.height=i,this.pixelRatio=1,this.renderTarget=s,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this._rttNode=null,this._quadMesh=new bb(new fr),this.updateBeforeType=mn.RENDER}get autoSize(){return this.width===null}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,t){this.width=e,this.height=t;const i=e*this.pixelRatio,r=t*this.pixelRatio;this.renderTarget.setSize(i,r),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore({renderer:e}){if(this.textureNeedsUpdate===!1&&this.autoUpdate===!1)return;if(this.textureNeedsUpdate=!1,this.autoSize===!0){this.pixelRatio=e.getPixelRatio();const i=e.getSize(noe);this.setSize(i.width,i.height)}this._quadMesh.material.fragmentNode=this._rttNode;const t=e.getRenderTarget();e.setRenderTarget(this.renderTarget),this._quadMesh.render(e),e.setRenderTarget(t)}clone(){const e=new tl(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}const PP=(n,...e)=>je(new ioe(je(n),...e)),roe=(n,...e)=>n.isTextureNode?n:n.isPassNode?n.getTextureNode():PP(n,...e),uf=Re(([n,e,t],i)=>{let r;i.renderer.coordinateSystem===Za?(n=Je(n.x,n.y.oneMinus()).mul(2).sub(1),r=zt(xe(n,e),1)):r=zt(xe(n.x,n.y.oneMinus(),e).mul(2).sub(1),1);const s=zt(t.mul(r));return s.xyz.div(s.w)}),soe=Re(([n,e])=>{const t=e.mul(zt(n,1)),i=t.xy.div(t.w).mul(.5).add(.5).toVar();return Je(i.x,i.y.oneMinus())}),ooe=Re(([n,e,t])=>{const i=Iu(Zi(e)),r=Sr(n.mul(i)).toVar(),s=Zi(e,r).toVar(),o=Zi(e,r.sub(Sr(2,0))).toVar(),a=Zi(e,r.sub(Sr(1,0))).toVar(),l=Zi(e,r.add(Sr(1,0))).toVar(),u=Zi(e,r.add(Sr(2,0))).toVar(),A=Zi(e,r.add(Sr(0,2))).toVar(),p=Zi(e,r.add(Sr(0,1))).toVar(),g=Zi(e,r.sub(Sr(0,1))).toVar(),v=Zi(e,r.sub(Sr(0,2))).toVar(),x=wi(Gn(re(2).mul(a).sub(o),s)).toVar(),S=wi(Gn(re(2).mul(l).sub(u),s)).toVar(),T=wi(Gn(re(2).mul(p).sub(A),s)).toVar(),w=wi(Gn(re(2).mul(g).sub(v),s)).toVar(),R=uf(n,s,t).toVar(),E=x.lessThan(S).select(R.sub(uf(n.sub(Je(re(1).div(i.x),0)),a,t)),R.negate().add(uf(n.add(Je(re(1).div(i.x),0)),l,t))),N=T.lessThan(w).select(R.sub(uf(n.add(Je(0,re(1).div(i.y))),p,t)),R.negate().add(uf(n.sub(Je(0,re(1).div(i.y))),g,t)));return $l(M2(E,N))});class E1 extends Du{constructor(e,t,i=Float32Array){const r=ArrayBuffer.isView(e)?e:new i(e*t);super(r,t),this.isStorageInstancedBufferAttribute=!0}}class aoe extends Gi{constructor(e,t,i=Float32Array){const r=ArrayBuffer.isView(e)?e:new i(e*t);super(r,t),this.isStorageBufferAttribute=!0}}const loe=(n,e="float")=>{let t,i;e.isStruct===!0?(t=e.layout.getLength(),i=Mg("float")):(t=M4(e),i=Mg(e));const r=new aoe(n,t,i);return $c(r,e,n)},uoe=(n,e="float")=>{let t,i;e.isStruct===!0?(t=e.layout.getLength(),i=Mg("float")):(t=M4(e),i=Mg(e));const r=new E1(n,t,i);return $c(r,e,n)};class coe extends jt{static get type(){return"PointUVNode"}constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}const hoe=gt(coe),h0=new Qr,W3=new en;class js extends jt{static get type(){return"SceneNode"}constructor(e=js.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,i=this.scene!==null?this.scene:e.scene;let r;return t===js.BACKGROUND_BLURRINESS?r=pi("backgroundBlurriness","float",i):t===js.BACKGROUND_INTENSITY?r=pi("backgroundIntensity","float",i):t===js.BACKGROUND_ROTATION?r=qt("mat4").label("backgroundRotation").setGroup(Xt).onRenderUpdate(()=>{const s=i.background;return s!==null&&s.isTexture&&s.mapping!==Dx?(h0.copy(i.backgroundRotation),h0.x*=-1,h0.y*=-1,h0.z*=-1,W3.makeRotationFromEuler(h0)):W3.identity(),W3}):console.error("THREE.SceneNode: Unknown scope:",t),r}}js.BACKGROUND_BLURRINESS="backgroundBlurriness";js.BACKGROUND_INTENSITY="backgroundIntensity";js.BACKGROUND_ROTATION="backgroundRotation";const LP=gt(js,js.BACKGROUND_BLURRINESS),$y=gt(js,js.BACKGROUND_INTENSITY),DP=gt(js,js.BACKGROUND_ROTATION);class foe extends tl{static get type(){return"StorageTextureNode"}constructor(e,t,i=null){super(e,t),this.storeNode=i,this.isStorageTextureNode=!0,this.access=fs.WRITE_ONLY}getInputType(){return"storageTexture"}setup(e){super.setup(e);const t=e.getNodeProperties(this);t.storeNode=this.storeNode}setAccess(e){return this.access=e,this}generate(e,t){let i;return this.storeNode!==null?i=this.generateStore(e):i=super.generate(e,t),i}toReadWrite(){return this.setAccess(fs.READ_WRITE)}toReadOnly(){return this.setAccess(fs.READ_ONLY)}toWriteOnly(){return this.setAccess(fs.WRITE_ONLY)}generateStore(e){const t=e.getNodeProperties(this),{uvNode:i,storeNode:r}=t,s=super.generate(e,"property"),o=i.build(e,"uvec2"),a=r.build(e,"vec4"),l=e.generateTextureStore(e,s,o,a);e.addLineFlowCode(l,this)}}const IP=Qe(foe).setParameterLength(1,3),Aoe=(n,e,t)=>{const i=IP(n,e,t);return t!==null&&i.toStack(),i},doe=Re(({texture:n,uv:e})=>{const i=xe().toVar();return bn(e.x.lessThan(1e-4),()=>{i.assign(xe(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{i.assign(xe(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{i.assign(xe(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{i.assign(xe(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{i.assign(xe(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{i.assign(xe(0,0,-1))}).Else(()=>{const s=n.sample(e.add(xe(-.01,0,0))).r.sub(n.sample(e.add(xe(.01,0,0))).r),o=n.sample(e.add(xe(0,-.01,0))).r.sub(n.sample(e.add(xe(0,.01,0))).r),a=n.sample(e.add(xe(0,0,-.01))).r.sub(n.sample(e.add(xe(0,0,.01))).r);i.assign(xe(s,o,a))}),i.normalize()});class poe extends tl{static get type(){return"Texture3DNode"}constructor(e,t=null,i=null){super(e,t,i),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return xe(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const i=this.value;return e.isFlipY()&&(i.isRenderTargetTexture===!0||i.isFramebufferTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(de(Iu(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,"vec3")}normal(e){return doe({texture:this,uv:e})}}const BP=Qe(poe).setParameterLength(1,3);class moe extends D2{static get type(){return"UserDataNode"}constructor(e,t,i=null){super(e,t,i),this.userData=i}updateReference(e){return this.reference=this.userData!==null?this.userData:e.object.userData,this.reference}}const goe=(n,e,t)=>je(new moe(n,e,t)),jS=new WeakMap;class _oe extends or{static get type(){return"VelocityNode"}constructor(){super("vec2"),this.projectionMatrix=null,this.updateType=mn.OBJECT,this.updateAfterType=mn.OBJECT,this.previousModelWorldMatrix=qt(new en),this.previousProjectionMatrix=qt(new en).setGroup(Xt),this.previousCameraViewMatrix=qt(new en)}setProjectionMatrix(e){this.projectionMatrix=e}update({frameId:e,camera:t,object:i}){const r=XS(i);this.previousModelWorldMatrix.value.copy(r);const s=FP(t);s.frameId!==e&&(s.frameId=e,s.previousProjectionMatrix===void 0?(s.previousProjectionMatrix=new en,s.previousCameraViewMatrix=new en,s.currentProjectionMatrix=new en,s.currentCameraViewMatrix=new en,s.previousProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.previousCameraViewMatrix.copy(t.matrixWorldInverse)):(s.previousProjectionMatrix.copy(s.currentProjectionMatrix),s.previousCameraViewMatrix.copy(s.currentCameraViewMatrix)),s.currentProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.currentCameraViewMatrix.copy(t.matrixWorldInverse),this.previousProjectionMatrix.value.copy(s.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(s.previousCameraViewMatrix))}updateAfter({object:e}){XS(e).copy(e.matrixWorld)}setup(){const e=this.projectionMatrix===null?Ah:qt(this.projectionMatrix),t=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),i=e.mul(dh).mul(nr),r=this.previousProjectionMatrix.mul(t).mul(Dg),s=i.xy.div(i.w),o=r.xy.div(r.w);return Gn(s,o)}}function FP(n){let e=jS.get(n);return e===void 0&&(e={},jS.set(n,e)),e}function XS(n,e=0){const t=FP(n);let i=t[e];return i===void 0&&(t[e]=i=new en,t[e].copy(n.matrixWorld)),i}const voe=gt(_oe),UP=Re(([n,e])=>Ks(1,n.oneMinus().div(e)).oneMinus()).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),OP=Re(([n,e])=>Ks(n.div(e.oneMinus()),1)).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),kP=Re(([n,e])=>n.oneMinus().mul(e.oneMinus()).oneMinus()).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),VP=Re(([n,e])=>ii(n.mul(2).mul(e),n.oneMinus().mul(2).mul(e.oneMinus()).oneMinus(),T2(.5,n))).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),yoe=Re(([n,e])=>{const t=e.a.add(n.a.mul(e.a.oneMinus()));return zt(e.rgb.mul(e.a).add(n.rgb.mul(n.a).mul(e.a.oneMinus())).div(t),t)}).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),xoe=(...n)=>(console.warn('THREE.TSL: "burn" has been renamed. Use "blendBurn" instead.'),UP(n)),boe=(...n)=>(console.warn('THREE.TSL: "dodge" has been renamed. Use "blendDodge" instead.'),OP(n)),woe=(...n)=>(console.warn('THREE.TSL: "screen" has been renamed. Use "blendScreen" instead.'),kP(n)),Soe=(...n)=>(console.warn('THREE.TSL: "overlay" has been renamed. Use "blendOverlay" instead.'),VP(n)),Toe=Re(([n])=>wb(n.rgb)),Moe=Re(([n,e=re(1)])=>e.mix(wb(n.rgb),n.rgb)),Eoe=Re(([n,e=re(1)])=>{const t=hr(n.r,n.g,n.b).div(3),i=n.r.max(n.g.max(n.b)),r=i.sub(t).mul(e).mul(-3);return ii(n.rgb,i,r)}),Coe=Re(([n,e=re(1)])=>{const t=xe(.57735,.57735,.57735),i=e.cos();return xe(n.rgb.mul(i).add(t.cross(n.rgb).mul(e.sin()).add(t.mul(Wu(t,n.rgb).mul(i.oneMinus())))))}),wb=(n,e=xe(Rn.getLuminanceCoefficients(new ie)))=>Wu(n,e),Roe=Re(([n,e=xe(1),t=xe(0),i=xe(1),r=re(1),s=xe(Rn.getLuminanceCoefficients(new ie,ha))])=>{const o=n.rgb.dot(xe(s)),a=sr(n.rgb.mul(e).add(t),0).toVar(),l=a.pow(i).toVar();return bn(a.r.greaterThan(0),()=>{a.r.assign(l.r)}),bn(a.g.greaterThan(0),()=>{a.g.assign(l.g)}),bn(a.b.greaterThan(0),()=>{a.b.assign(l.b)}),a.assign(o.add(a.sub(o).mul(r))),zt(a.rgb,n.a)});class Noe extends or{static get type(){return"PosterizeNode"}constructor(e,t){super(),this.sourceNode=e,this.stepsNode=t}setup(){const{sourceNode:e,stepsNode:t}=this;return e.mul(t).floor().div(t)}}const Poe=Qe(Noe).setParameterLength(2),Vm=new at;class GP extends tl{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class QS extends GP{static get type(){return"PassMultipleTextureNode"}constructor(e,t,i=!1){super(e,null),this.textureName=t,this.previousTexture=i}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class nl extends or{static get type(){return"PassNode"}constructor(e,t,i,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=i,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const s=new Ys;s.isRenderTargetTexture=!0,s.name="depth";const o=new ol(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Mr,...r});o.texture.name="output",o.depthTexture=s,this.renderTarget=o,this._textures={output:o.texture,depth:s},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=qt(0),this._cameraFar=qt(0),this._mrt=null,this._layers=null,this._resolution=1,this.isPassNode=!0,this.updateBeforeType=mn.FRAME}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}isGlobal(){return!0}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const i=this._textures[e],r=this.renderTarget.textures.indexOf(i);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=i,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=je(new QS(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=je(new QS(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const i=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=cb(this.getTextureNode(e),i,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const i=this._cameraNear,r=this._cameraFar,s=this.getViewZNode(e);this._linearDepthNodes[e]=t=Ff(s,i,r)}return t}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,e.backend.isWebGLBackend===!0&&(this.renderTarget.samples=0),this.renderTarget.texture.type=e.getColorBufferType(),this.scope===nl.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:i}=this;let r,s;const o=t.getOutputRenderTarget();o&&o.isXRRenderTarget===!0?(s=1,r=t.xr.getCamera(),t.xr.updateCamera(r),Vm.set(o.width,o.height)):(r=this.camera,s=t.getPixelRatio(),t.getSize(Vm)),this._pixelRatio=s,this.setSize(Vm.width,Vm.height);const a=t.getRenderTarget(),l=t.getMRT(),u=r.layers.mask;this._cameraNear.value=r.near,this._cameraFar.value=r.far,this._layers!==null&&(r.layers.mask=this._layers.mask);for(const A in this._previousTextures)this.toggleTexture(A);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(i,r),t.setRenderTarget(a),t.setMRT(l),r.layers.mask=u}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio*this._resolution,r=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}nl.COLOR="color";nl.DEPTH="depth";const Loe=(n,e,t)=>je(new nl(nl.COLOR,n,e,t)),Doe=(n,e)=>je(new GP(n,e)),Ioe=(n,e,t)=>je(new nl(nl.DEPTH,n,e,t));class Boe extends nl{static get type(){return"ToonOutlinePassNode"}constructor(e,t,i,r,s){super(nl.COLOR,e,t),this.colorNode=i,this.thicknessNode=r,this.alphaNode=s,this._materialCache=new WeakMap}updateBefore(e){const{renderer:t}=e,i=t.getRenderObjectFunction();t.setRenderObjectFunction((r,s,o,a,l,u,A,p)=>{if((l.isMeshToonMaterial||l.isMeshToonNodeMaterial)&&l.wireframe===!1){const g=this._getOutlineMaterial(l);t.renderObject(r,s,o,a,g,u,A,p)}t.renderObject(r,s,o,a,l,u,A,p)}),super.updateBefore(e),t.setRenderObjectFunction(i)}_createMaterial(){const e=new fr;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=_i;const t=Js.negate(),i=Ah.mul(dh),r=re(1),s=i.mul(zt(nr,1)),o=i.mul(zt(nr.add(t),1)),a=$l(s.sub(o));return e.vertexNode=s.add(a.mul(this.thicknessNode).mul(s.w).mul(r)),e.colorNode=zt(this.colorNode,this.alphaNode),e}_getOutlineMaterial(e){let t=this._materialCache.get(e);return t===void 0&&(t=this._createMaterial(),this._materialCache.set(e,t)),t}}const Foe=(n,e,t=new Ft(0,0,0),i=.003,r=1)=>je(new Boe(n,e,je(t),je(i),je(r))),qP=Re(([n,e])=>n.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),zP=Re(([n,e])=>(n=n.mul(e),n.div(n.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),HP=Re(([n,e])=>{n=n.mul(e),n=n.sub(.004).max(0);const t=n.mul(n.mul(6.2).add(.5)),i=n.mul(n.mul(6.2).add(1.7)).add(.06);return t.div(i).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Uoe=Re(([n])=>{const e=n.mul(n.add(.0245786)).sub(90537e-9),t=n.mul(n.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),$P=Re(([n,e])=>{const t=ps(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),i=ps(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return n=n.mul(e).div(.6),n=t.mul(n),n=Uoe(n),n=i.mul(n),n.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Ooe=ps(xe(1.6605,-.1246,-.0182),xe(-.5876,1.1329,-.1006),xe(-.0728,-.0083,1.1187)),koe=ps(xe(.6274,.0691,.0164),xe(.3293,.9195,.088),xe(.0433,.0113,.8956)),Voe=Re(([n])=>{const e=xe(n).toVar(),t=xe(e.mul(e)).toVar(),i=xe(t.mul(t)).toVar();return re(15.5).mul(i.mul(t)).sub(gn(40.14,i.mul(e))).add(gn(31.96,i).sub(gn(6.868,t.mul(e))).add(gn(.4298,t).add(gn(.1191,e).sub(.00232))))}),WP=Re(([n,e])=>{const t=xe(n).toVar(),i=ps(xe(.856627153315983,.137318972929847,.11189821299995),xe(.0951212405381588,.761241990602591,.0767994186031903),xe(.0482516061458583,.101439036467562,.811302368396859)),r=ps(xe(1.1271005818144368,-.1413297634984383,-.14132976349843826),xe(-.11060664309660323,1.157823702216272,-.11060664309660294),xe(-.016493938717834573,-.016493938717834257,1.2519364065950405)),s=re(-12.47393),o=re(4.026069);return t.mulAssign(e),t.assign(koe.mul(t)),t.assign(i.mul(t)),t.assign(sr(t,1e-10)),t.assign(ja(t)),t.assign(t.sub(s).div(o.sub(s))),t.assign(Ja(t,0,1)),t.assign(Voe(t)),t.assign(r.mul(t)),t.assign(la(sr(xe(0),t),xe(2.2))),t.assign(Ooe.mul(t)),t.assign(Ja(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),jP=Re(([n,e])=>{const t=re(.76),i=re(.15);n=n.mul(e);const r=Ks(n.r,Ks(n.g,n.b)),s=Or(r.lessThan(.08),r.sub(gn(6.25,r.mul(r))),.04);n.subAssign(s);const o=sr(n.r,sr(n.g,n.b));bn(o.lessThan(t),()=>n);const a=Gn(1,t),l=Gn(1,a.mul(a).div(o.add(a.sub(t))));n.mulAssign(l.div(o));const u=Gn(1,va(1,i.mul(o.sub(l)).add(1)));return ii(n,xe(l),u)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class mr extends jt{static get type(){return"CodeNode"}constructor(e="",t=[],i=""){super("code"),this.isCodeNode=!0,this.code=e,this.includes=t,this.language=i}isGlobal(){return!0}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const i=e.getCodeFromNode(this,this.getNodeType(e));return i.code=this.code,i.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}const k2=Qe(mr).setParameterLength(1,3),Goe=(n,e)=>k2(n,e,"js"),qoe=(n,e)=>k2(n,e,"wgsl"),zoe=(n,e)=>k2(n,e,"glsl");class XP extends mr{static get type(){return"FunctionNode"}constructor(e="",t=[],i=""){super(e,t,i)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let i=t.nodeFunction;return i===void 0&&(i=e.parser.parseFunction(this.code),t.nodeFunction=i),i}generate(e,t){super.generate(e);const i=this.getNodeFunction(e),r=i.name,s=i.type,o=e.getCodeFromNode(this,s);r!==""&&(o.name=r);const a=e.getPropertyName(o),l=this.getNodeFunction(e).getCode(a);return o.code=l+`
`,t==="property"?a:e.format(`${a}()`,s,t)}}const QP=(n,e=[],t="")=>{for(let s=0;s<e.length;s++){const o=e[s];typeof o=="function"&&(e[s]=o.functionNode)}const i=je(new XP(n,e,t)),r=(...s)=>i.call(...s);return r.functionNode=i,r},Hoe=(n,e)=>QP(n,e,"glsl"),$oe=(n,e)=>QP(n,e,"wgsl");class Woe extends jt{static get type(){return"ScriptableValueNode"}constructor(e=null){super(),this._value=e,this._cache=null,this.inputType=null,this.outputType=null,this.events=new sl,this.isScriptableValueNode=!0}get isScriptableOutputNode(){return this.outputType!==null}set value(e){this._value!==e&&(this._cache&&this.inputType==="URL"&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){const e=this.value;if(e&&this._cache===null&&this.inputType==="URL"&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&e.value!==null&&e.value!==void 0&&((this.inputType==="URL"||this.inputType==="String")&&typeof e.value=="string"||this.inputType==="Number"&&typeof e.value=="number"||this.inputType==="Vector2"&&e.value.isVector2||this.inputType==="Vector3"&&e.value.isVector3||this.inputType==="Vector4"&&e.value.isVector4||this.inputType==="Color"&&e.value.isColor||this.inputType==="Matrix3"&&e.value.isMatrix3||this.inputType==="Matrix4"&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:re()}serialize(e){super.serialize(e),this.value!==null?this.inputType==="ArrayBuffer"?e.value=eC(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let t=null;e.value!==null&&(e.inputType==="ArrayBuffer"?t=tC(e.value):e.inputType==="Texture"?t=e.meta.textures[e.value]:t=e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}}const C1=Qe(Woe).setParameterLength(1);class YP extends Map{get(e,t=null,...i){if(this.has(e))return super.get(e);if(t!==null){const r=t(...i);return this.set(e,r),r}}}class joe{constructor(e){this.scriptableNode=e}get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){const t=this.parameters[e];return t?t.getValue():null}}const R1=new YP;class Xoe extends jt{static get type(){return"ScriptableNode"}constructor(e=null,t={}){super(),this.codeNode=e,this.parameters=t,this._local=new YP,this._output=C1(null),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,t){return this._local.set(e,t)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(const t of this.getLayout())if(t.inputType&&(t.id===e||t.name===e))return t}getOutputLayout(e){for(const t of this.getLayout())if(t.outputType&&(t.id===e||t.name===e))return t}setOutput(e,t){const i=this._outputs;return i[e]===void 0?i[e]=C1(t):i[e].value=t,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,t){const i=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),i[e]=t,i[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),i[e]=t,i[e].events.addEventListener("refresh",this.onRefresh)):i[e]===void 0?(i[e]=C1(t),i[e].events.addEventListener("refresh",this.onRefresh)):i[e].value=t,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(const e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e,...t){const r=this.getObject()[e];if(typeof r=="function")return r(...t)}async callAsync(e,...t){const r=this.getObject()[e];if(typeof r=="function")return r.constructor.name==="AsyncFunction"?await r(...t):r(...t)}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(e=null){e!==null?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),this._object!==null)return this._object;const e=()=>this.refresh(),t=(u,A)=>this.setOutput(u,A),i=new joe(this),r=R1.get("THREE"),s=R1.get("TSL"),o=this.getMethod(),a=[i,this._local,R1,e,t,r,s];this._object=o(...a);const l=this._object.layout;if(l&&(l.cache===!1&&this._local.clear(),this._output.outputType=l.outputType||null,Array.isArray(l.elements)))for(const u of l.elements){const A=u.id||u.name;u.inputType&&(this.getParameter(A)===void 0&&this.setParameter(A,null),this.getParameter(A).inputType=u.inputType),u.outputType&&(this.getOutput(A)===void 0&&this.setOutput(A,null),this.getOutput(A).outputType=u.outputType)}return this._object}deserialize(e){super.deserialize(e);for(const t in this.parameters){let i=this.parameters[t];i.isScriptableNode&&(i=i.getDefaultOutput()),i.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){const e=this.getDefaultOutput().value;return e&&e.isNode?e:re()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),this._method!==null)return this._method;const e=["parameters","local","global","refresh","setOutput","THREE","TSL"],i=["layout","init","main","dispose"].join(", "),r="var "+i+`; var output = {};
`,s=`
return { ...output, `+i+" };",o=r+this.codeNode.code+s;return this._method=new Function(...e,o),this._method}dispose(){this._method!==null&&(this._object&&typeof this._object.dispose=="function"&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}getCacheKey(e){const t=[Q9(this.source),this.getDefaultOutputNode().getCacheKey(e)];for(const i in this.parameters)t.push(this.parameters[i].getCacheKey(e));return p2(t)}set needsUpdate(e){e===!0&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return this.codeNode===null?this:(this._needsOutputUpdate===!0&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value,this)}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}const Qoe=Qe(Xoe).setParameterLength(1,2);function ZP(n){let e;const t=n.context.getViewZ;return t!==void 0&&(e=t(this)),(e||ur.z).negate()}const Sb=Re(([n,e],t)=>{const i=ZP(t);return el(n,e,i)}),Tb=Re(([n],e)=>{const t=ZP(e);return n.mul(n,t,t).negate().exp().oneMinus()}),$d=Re(([n,e])=>zt(e.toFloat().mix(If.rgb,n.toVec3()),If.a));function Yoe(n,e,t){return console.warn('THREE.TSL: "rangeFog( color, near, far )" is deprecated. Use "fog( color, rangeFogFactor( near, far ) )" instead.'),$d(n,Sb(e,t))}function Zoe(n,e){return console.warn('THREE.TSL: "densityFog( color, density )" is deprecated. Use "fog( color, densityFogFactor( density ) )" instead.'),$d(n,Tb(e))}let pc=null,mc=null;class Koe extends jt{static get type(){return"RangeNode"}constructor(e=re(),t=re()){super(),this.minNode=e,this.maxNode=t}getVectorLength(e){const t=e.getTypeLength(Cu(this.minNode.value)),i=e.getTypeLength(Cu(this.maxNode.value));return t>i?t:i}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}setup(e){const t=e.object;let i=null;if(t.count>1){const r=this.minNode.value,s=this.maxNode.value,o=e.getTypeLength(Cu(r)),a=e.getTypeLength(Cu(s));pc=pc||new $t,mc=mc||new $t,pc.setScalar(0),mc.setScalar(0),o===1?pc.setScalar(r):r.isColor?pc.set(r.r,r.g,r.b,1):pc.set(r.x,r.y,r.z||0,r.w||0),a===1?mc.setScalar(s):s.isColor?mc.set(s.r,s.g,s.b,1):mc.set(s.x,s.y,s.z||0,s.w||0);const l=4,u=l*t.count,A=new Float32Array(u);for(let g=0;g<u;g++){const v=g%l,x=pc.getComponent(v),S=mc.getComponent(v);A[g]=Hx.lerp(x,S,Math.random())}const p=this.getNodeType(e);if(t.count<=4096)i=pp(A,"vec4",t.count).element(Bu).convert(p);else{const g=new Du(A,4);e.geometry.setAttribute("__range"+this.id,g),i=Lg(g).convert(p)}}else i=re(0);return i}}const Joe=Qe(Koe).setParameterLength(2);class eae extends jt{static get type(){return"ComputeBuiltinNode"}constructor(e,t){super(t),this._builtinName=e}getHash(e){return this.getBuiltinName(e)}getNodeType(){return this.nodeType}setBuiltinName(e){return this._builtinName=e,this}getBuiltinName(){return this._builtinName}hasBuiltin(e){return e.hasBuiltin(this._builtinName)}generate(e,t){const i=this.getBuiltinName(e),r=this.getNodeType(e);return e.shaderStage==="compute"?e.format(i,r,t):(console.warn(`ComputeBuiltinNode: Compute built-in value ${i} can not be accessed in the ${e.shaderStage} stage`),e.generateConst(r))}serialize(e){super.serialize(e),e.global=this.global,e._builtinName=this._builtinName}deserialize(e){super.deserialize(e),this.global=e.global,this._builtinName=e._builtinName}}const wp=(n,e)=>je(new eae(n,e)),tae=wp("numWorkgroups","uvec3"),nae=wp("workgroupId","uvec3"),iae=wp("globalId","uvec3"),rae=wp("localId","uvec3"),sae=wp("subgroupSize","uint");class oae extends jt{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:i}=e;i.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}const Mb=Qe(oae),aae=()=>Mb("workgroup").toStack(),lae=()=>Mb("storage").toStack(),uae=()=>Mb("texture").toStack();class cae extends fh{constructor(e,t){super(e,t),this.isWorkgroupInfoElementNode=!0}generate(e,t){let i;const r=e.context.assign;if(i=super.generate(e),r!==!0){const s=this.getNodeType(e);i=e.format(i,s,t)}return i}}class hae extends jt{constructor(e,t,i=0){super(t),this.bufferType=t,this.bufferCount=i,this.isWorkgroupInfoNode=!0,this.elementType=t,this.scope=e}label(e){return this.name=e,this}setScope(e){return this.scope=e,this}getElementType(){return this.elementType}getInputType(){return`${this.scope}Array`}element(e){return je(new cae(this,e))}generate(e){return e.getScopedArray(this.name||`${this.scope}Array_${this.id}`,this.scope.toLowerCase(),this.bufferType,this.bufferCount)}}const fae=(n,e)=>je(new hae("Workgroup",n,e));class Rr extends jt{static get type(){return"AtomicFunctionNode"}constructor(e,t,i){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=i,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),i=t.parents,r=this.method,s=this.getNodeType(e),o=this.getInputType(e),a=this.pointerNode,l=this.valueNode,u=[];u.push(`&${a.build(e,o)}`),l!==null&&u.push(l.build(e,o));const A=`${e.getMethod(r,s)}( ${u.join(", ")} )`;if(i.length===1&&i[0].isStackNode===!0)e.addLineFlowCode(A,this);else return t.constNode===void 0&&(t.constNode=Wl(A,s).toConst()),t.constNode.build(e)}}Rr.ATOMIC_LOAD="atomicLoad";Rr.ATOMIC_STORE="atomicStore";Rr.ATOMIC_ADD="atomicAdd";Rr.ATOMIC_SUB="atomicSub";Rr.ATOMIC_MAX="atomicMax";Rr.ATOMIC_MIN="atomicMin";Rr.ATOMIC_AND="atomicAnd";Rr.ATOMIC_OR="atomicOr";Rr.ATOMIC_XOR="atomicXor";const Aae=Qe(Rr),cl=(n,e,t)=>Aae(n,e,t).toStack(),dae=n=>cl(Rr.ATOMIC_LOAD,n,null),pae=(n,e)=>cl(Rr.ATOMIC_STORE,n,e),mae=(n,e)=>cl(Rr.ATOMIC_ADD,n,e),gae=(n,e)=>cl(Rr.ATOMIC_SUB,n,e),_ae=(n,e)=>cl(Rr.ATOMIC_MAX,n,e),vae=(n,e)=>cl(Rr.ATOMIC_MIN,n,e),yae=(n,e)=>cl(Rr.ATOMIC_AND,n,e),xae=(n,e)=>cl(Rr.ATOMIC_OR,n,e),bae=(n,e)=>cl(Rr.ATOMIC_XOR,n,e);let Gm;function V2(n){Gm=Gm||new WeakMap;let e=Gm.get(n);return e===void 0&&Gm.set(n,e={}),e}function Eb(n){const e=V2(n);return e.shadowMatrix||(e.shadowMatrix=qt("mat4").setGroup(Xt).onRenderUpdate(()=>(n.castShadow!==!0&&n.shadow.updateMatrices(n),n.shadow.matrix)))}function KP(n,e=Ul){const t=Eb(n).mul(e);return t.xyz.div(t.w)}function Cb(n){const e=V2(n);return e.position||(e.position=qt(new ie).setGroup(Xt).onRenderUpdate((t,i)=>i.value.setFromMatrixPosition(n.matrixWorld)))}function JP(n){const e=V2(n);return e.targetPosition||(e.targetPosition=qt(new ie).setGroup(Xt).onRenderUpdate((t,i)=>i.value.setFromMatrixPosition(n.target.matrixWorld)))}function Rb(n){const e=V2(n);return e.viewPosition||(e.viewPosition=qt(new ie).setGroup(Xt).onRenderUpdate(({camera:t},i)=>{i.value=i.value||new ie,i.value.setFromMatrixPosition(n.matrixWorld),i.value.applyMatrix4(t.matrixWorldInverse)}))}const Nb=n=>eo.transformDirection(Cb(n).sub(JP(n))),wae=n=>n.sort((e,t)=>e.id-t.id),Sae=(n,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===n)return t;return null},j3=new WeakMap;class Pb extends jt{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=xe().toVar(),this.totalSpecularNode=xe().toVar(),this.outgoingLightNode=xe().toVar(),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=[],t=this._lights;for(let i=0;i<t.length;i++){const r=t[i];if(e.push(r.id),r.isSpotLight===!0){const s=r.map!==null?r.map.id:-1;e.push(s)}}return p2(e)}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const i of this._lightNodes)t.push(i.getSelf().getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getDataFromNode(this);for(const i of t.nodes)i.build(e)}setupLightsNode(e){const t=[],i=this._lightNodes,r=wae(this._lights),s=e.renderer.library;for(const o of r)if(o.isNode)t.push(je(o));else{let a=null;if(i!==null&&(a=Sae(o.id,i)),a===null){const l=s.getLightNodeClass(o.constructor);if(l===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${o.constructor.name}`);continue}let u=null;j3.has(o)?u=j3.get(o):(u=je(new l(o)),j3.set(o,u)),t.push(u)}}this._lightNodes=t}setupDirectLight(e,t,i){const{lightingModel:r,reflectedLight:s}=e.context;r.direct({...i,lightNode:t,reflectedLight:s},e)}setupDirectRectAreaLight(e,t,i){const{lightingModel:r,reflectedLight:s}=e.context;r.directRectArea({...i,lightNode:t,reflectedLight:s},e)}setupLights(e,t){for(const i of t)i.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let i=this.outgoingLightNode;const r=e.context,s=r.lightingModel,o=e.getDataFromNode(this);if(s){const{totalDiffuseNode:a,totalSpecularNode:l}=this;r.outgoingLight=i;const u=e.addStack();o.nodes=u.nodes,s.start(e);const{backdrop:A,backdropAlpha:p}=r,{directDiffuse:g,directSpecular:v,indirectDiffuse:x,indirectSpecular:S}=r.reflectedLight;let T=g.add(x);A!==null&&(p!==null?T=xe(p.mix(T,A)):T=xe(A),r.material.transparent=!0),a.assign(T),l.assign(v.add(S)),i.assign(a.add(l)),s.finish(e),i=i.bypass(e.removeStack())}else o.nodes=[];return e.lightsNode=t,i}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}const Tae=(n=[])=>je(new Pb).setLights(n);class Mae extends jt{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=mn.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){Lb.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||Ul)}dispose(){this.updateBeforeType=mn.NONE}}const Lb=EA("vec3","shadowPositionWorld");function Eae(n,e={}){return e.toneMapping=n.toneMapping,e.toneMappingExposure=n.toneMappingExposure,e.outputColorSpace=n.outputColorSpace,e.renderTarget=n.getRenderTarget(),e.activeCubeFace=n.getActiveCubeFace(),e.activeMipmapLevel=n.getActiveMipmapLevel(),e.renderObjectFunction=n.getRenderObjectFunction(),e.pixelRatio=n.getPixelRatio(),e.mrt=n.getMRT(),e.clearColor=n.getClearColor(e.clearColor||new Ft),e.clearAlpha=n.getClearAlpha(),e.autoClear=n.autoClear,e.scissorTest=n.getScissorTest(),e}function Cae(n,e){return e=Eae(n,e),n.setMRT(null),n.setRenderObjectFunction(null),n.setClearColor(0,1),n.autoClear=!0,e}function Rae(n,e){n.toneMapping=e.toneMapping,n.toneMappingExposure=e.toneMappingExposure,n.outputColorSpace=e.outputColorSpace,n.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),n.setRenderObjectFunction(e.renderObjectFunction),n.setPixelRatio(e.pixelRatio),n.setMRT(e.mrt),n.setClearColor(e.clearColor,e.clearAlpha),n.autoClear=e.autoClear,n.setScissorTest(e.scissorTest)}function Nae(n,e={}){return e.background=n.background,e.backgroundNode=n.backgroundNode,e.overrideMaterial=n.overrideMaterial,e}function Pae(n,e){return e=Nae(n,e),n.background=null,n.backgroundNode=null,n.overrideMaterial=null,e}function Lae(n,e){n.background=e.background,n.backgroundNode=e.backgroundNode,n.overrideMaterial=e.overrideMaterial}function Dae(n,e,t){return t=Cae(n,t),t=Pae(e,t),t}function Iae(n,e,t){Rae(n,t),Lae(e,t)}const YS=new WeakMap,eL=Re(({depthTexture:n,shadowCoord:e,depthLayer:t})=>{let i=In(n,e.xy).label("t_basic");return n.isDepthArrayTexture&&(i=i.depth(t)),i.compare(e.z)}),tL=Re(({depthTexture:n,shadowCoord:e,shadow:t,depthLayer:i})=>{const r=(T,w)=>{let R=In(n,T);return n.isDepthArrayTexture&&(R=R.depth(i)),R.compare(w)},s=pi("mapSize","vec2",t).setGroup(Xt),o=pi("radius","float",t).setGroup(Xt),a=Je(1).div(s),l=a.x.negate().mul(o),u=a.y.negate().mul(o),A=a.x.mul(o),p=a.y.mul(o),g=l.div(2),v=u.div(2),x=A.div(2),S=p.div(2);return hr(r(e.xy.add(Je(l,u)),e.z),r(e.xy.add(Je(0,u)),e.z),r(e.xy.add(Je(A,u)),e.z),r(e.xy.add(Je(g,v)),e.z),r(e.xy.add(Je(0,v)),e.z),r(e.xy.add(Je(x,v)),e.z),r(e.xy.add(Je(l,0)),e.z),r(e.xy.add(Je(g,0)),e.z),r(e.xy,e.z),r(e.xy.add(Je(x,0)),e.z),r(e.xy.add(Je(A,0)),e.z),r(e.xy.add(Je(g,S)),e.z),r(e.xy.add(Je(0,S)),e.z),r(e.xy.add(Je(x,S)),e.z),r(e.xy.add(Je(l,p)),e.z),r(e.xy.add(Je(0,p)),e.z),r(e.xy.add(Je(A,p)),e.z)).mul(1/17)}),nL=Re(({depthTexture:n,shadowCoord:e,shadow:t,depthLayer:i})=>{const r=(p,g)=>{let v=In(n,p);return n.isDepthArrayTexture&&(v=v.depth(i)),v.compare(g)},s=pi("mapSize","vec2",t).setGroup(Xt),o=Je(1).div(s),a=o.x,l=o.y,u=e.xy,A=Zl(u.mul(s).add(.5));return u.subAssign(A.mul(o)),hr(r(u,e.z),r(u.add(Je(a,0)),e.z),r(u.add(Je(0,l)),e.z),r(u.add(o),e.z),ii(r(u.add(Je(a.negate(),0)),e.z),r(u.add(Je(a.mul(2),0)),e.z),A.x),ii(r(u.add(Je(a.negate(),l)),e.z),r(u.add(Je(a.mul(2),l)),e.z),A.x),ii(r(u.add(Je(0,l.negate())),e.z),r(u.add(Je(0,l.mul(2))),e.z),A.y),ii(r(u.add(Je(a,l.negate())),e.z),r(u.add(Je(a,l.mul(2))),e.z),A.y),ii(ii(r(u.add(Je(a.negate(),l.negate())),e.z),r(u.add(Je(a.mul(2),l.negate())),e.z),A.x),ii(r(u.add(Je(a.negate(),l.mul(2))),e.z),r(u.add(Je(a.mul(2),l.mul(2))),e.z),A.x),A.y)).mul(1/9)}),iL=Re(({depthTexture:n,shadowCoord:e,depthLayer:t})=>{const i=re(1).toVar();let r=In(n).sample(e.xy);(n.isDepthArrayTexture||n.isDataArrayTexture)&&(r=r.depth(t)),r=r.rg;const s=T2(e.z,r.x);return bn(s.notEqual(re(1)),()=>{const o=e.z.sub(r.x),a=sr(0,r.y.mul(r.y));let l=a.div(a.add(o.mul(o)));l=Ja(Gn(l,.3).div(.95-.3)),i.assign(Ja(sr(s,l)))}),i}),Bae=Re(([n,e,t])=>{let i=Ul.sub(n).length();return i=i.sub(e).div(t.sub(e)),i=i.saturate(),i}),Fae=n=>{const e=n.shadow.camera,t=pi("near","float",e).setGroup(Xt),i=pi("far","float",e).setGroup(Xt),r=$R(n);return Bae(r,t,i)},rL=n=>{let e=YS.get(n);if(e===void 0){const t=n.isPointLight?Fae(n):null;e=new fr,e.colorNode=zt(0,0,0,1),e.depthNode=t,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,YS.set(n,e)}return e},ZS=new ya,Kh=[],sL=(n,e,t,i)=>{Kh[0]=n,Kh[1]=e;let r=ZS.get(Kh);return(r===void 0||r.shadowType!==t||r.useVelocity!==i)&&(r=(s,o,a,l,u,A,...p)=>{(s.castShadow===!0||s.receiveShadow&&t===co)&&(i&&(J9(s).useVelocity=!0),s.onBeforeShadow(n,s,a,e.camera,l,o.overrideMaterial,A),n.renderObject(s,o,a,l,u,A,...p),s.onAfterShadow(n,s,a,e.camera,l,o.overrideMaterial,A))},r.shadowType=t,r.useVelocity=i,ZS.set(Kh,r)),Kh[0]=null,Kh[1]=null,r},Uae=Re(({samples:n,radius:e,size:t,shadowPass:i,depthLayer:r})=>{const s=re(0).toVar("meanVertical"),o=re(0).toVar("squareMeanVertical"),a=n.lessThanEqual(re(1)).select(re(0),re(2).div(n.sub(1))),l=n.lessThanEqual(re(1)).select(re(0),re(-1));ri({start:de(0),end:de(n),type:"int",condition:"<"},({i:A})=>{const p=l.add(re(A).mul(a));let g=i.sample(hr(bp.xy,Je(0,p).mul(e)).div(t));(i.value.isDepthArrayTexture||i.value.isDataArrayTexture)&&(g=g.depth(r)),g=g.x,s.addAssign(g),o.addAssign(g.mul(g))}),s.divAssign(n),o.divAssign(n);const u=ul(o.sub(s.mul(s)));return Je(s,u)}),Oae=Re(({samples:n,radius:e,size:t,shadowPass:i,depthLayer:r})=>{const s=re(0).toVar("meanHorizontal"),o=re(0).toVar("squareMeanHorizontal"),a=n.lessThanEqual(re(1)).select(re(0),re(2).div(n.sub(1))),l=n.lessThanEqual(re(1)).select(re(0),re(-1));ri({start:de(0),end:de(n),type:"int",condition:"<"},({i:A})=>{const p=l.add(re(A).mul(a));let g=i.sample(hr(bp.xy,Je(p,0).mul(e)).div(t));(i.value.isDepthArrayTexture||i.value.isDataArrayTexture)&&(g=g.depth(r)),s.addAssign(g.x),o.addAssign(hr(g.y.mul(g.y),g.x.mul(g.x)))}),s.divAssign(n),o.divAssign(n);const u=ul(o.sub(s.mul(s)));return Je(s,u)}),kae=[eL,tL,nL,iL];let X3;const qm=new bb;class oL extends Mae{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:i,shadowCoord:r,shadow:s,depthLayer:o}){const a=r.x.greaterThanEqual(0).and(r.x.lessThanEqual(1)).and(r.y.greaterThanEqual(0)).and(r.y.lessThanEqual(1)).and(r.z.lessThanEqual(1)),l=t({depthTexture:i,shadowCoord:r,shadow:s,depthLayer:o});return a.select(l,re(1))}setupShadowCoord(e,t){const{shadow:i}=this,{renderer:r}=e,s=pi("bias","float",i).setGroup(Xt);let o=t,a;if(i.camera.isOrthographicCamera||r.logarithmicDepthBuffer!==!0)o=o.xyz.div(o.w),a=o.z,r.coordinateSystem===Za&&(a=a.mul(2).sub(1));else{const l=o.w;o=o.xy.div(l);const u=pi("near","float",i.camera).setGroup(Xt),A=pi("far","float",i.camera).setGroup(Xt);a=hb(l.negate(),u,A)}return o=xe(o.x,o.y.oneMinus(),a.add(s)),o}getShadowFilterFn(e){return kae[e]}setupRenderTarget(e,t){const i=new Ys(e.mapSize.width,e.mapSize.height);i.name="ShadowDepthTexture",i.compareFunction=Jg;const r=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return r.texture.name="ShadowMap",r.texture.type=e.mapType,r.depthTexture=i,{shadowMap:r,depthTexture:i}}setupShadow(e){const{renderer:t}=e,{light:i,shadow:r}=this,s=t.shadowMap.type,{depthTexture:o,shadowMap:a}=this.setupRenderTarget(r,e);if(r.camera.updateProjectionMatrix(),s===co){o.compareFunction=null,a.isRenderTargetArray?(a._vsmShadowMapVertical||(a._vsmShadowMapVertical=e.createRenderTargetArray(r.mapSize.width,r.mapSize.height,a.depth,{format:Ll,type:Mr,depthBuffer:!1}),a._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=a._vsmShadowMapVertical,a._vsmShadowMapHorizontal||(a._vsmShadowMapHorizontal=e.createRenderTargetArray(r.mapSize.width,r.mapSize.height,a.depth,{format:Ll,type:Mr,depthBuffer:!1}),a._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=a._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:Ll,type:Mr,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:Ll,type:Mr,depthBuffer:!1}));let w=In(o);o.isDepthArrayTexture&&(w=w.depth(this.depthLayer));let R=In(this.vsmShadowMapVertical.texture);o.isDepthArrayTexture&&(R=R.depth(this.depthLayer));const E=pi("blurSamples","float",r).setGroup(Xt),N=pi("radius","float",r).setGroup(Xt),D=pi("mapSize","vec2",r).setGroup(Xt);let B=this.vsmMaterialVertical||(this.vsmMaterialVertical=new fr);B.fragmentNode=Uae({samples:E,radius:N,size:D,shadowPass:w,depthLayer:this.depthLayer}).context(e.getSharedContext()),B.name="VSMVertical",B=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new fr),B.fragmentNode=Oae({samples:E,radius:N,size:D,shadowPass:R,depthLayer:this.depthLayer}).context(e.getSharedContext()),B.name="VSMHorizontal"}const l=pi("intensity","float",r).setGroup(Xt),u=pi("normalBias","float",r).setGroup(Xt),A=Eb(i).mul(Lb.add(L2.mul(u))),p=this.setupShadowCoord(e,A),g=r.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(g===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const v=s===co?this.vsmShadowMapHorizontal.texture:o,x=this.setupShadowFilter(e,{filterFn:g,shadowTexture:a.texture,depthTexture:v,shadowCoord:p,shadow:r,depthLayer:this.depthLayer});let S=In(a.texture,p);o.isDepthArrayTexture&&(S=S.depth(this.depthLayer));const T=ii(1,x.rgb.mix(S,1),l.mul(S.a)).toVar();return this.shadowMap=a,this.shadow.map=a,T}setup(e){if(e.renderer.shadowMap.enabled!==!1)return Re(()=>{let t=this._node;return this.setupShadowPosition(e),t===null&&(this._node=t=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(t=e.material.receivedShadowNode(t)),t})()}renderShadow(e){const{shadow:t,shadowMap:i,light:r}=this,{renderer:s,scene:o}=e;t.updateMatrices(r),i.setSize(t.mapSize.width,t.mapSize.height,i.depth),s.render(o,t.camera)}updateShadow(e){const{shadowMap:t,light:i,shadow:r}=this,{renderer:s,scene:o,camera:a}=e,l=s.shadowMap.type,u=t.depthTexture.version;this._depthVersionCached=u;const A=r.camera.layers.mask;(r.camera.layers.mask&4294967294)===0&&(r.camera.layers.mask=a.layers.mask);const p=s.getRenderObjectFunction(),g=s.getMRT(),v=g?g.has("velocity"):!1;X3=Dae(s,o,X3),o.overrideMaterial=rL(i),s.setRenderObjectFunction(sL(s,r,l,v)),s.setClearColor(0,0),s.setRenderTarget(t),this.renderShadow(e),s.setRenderObjectFunction(p),i.isPointLight!==!0&&l===co&&this.vsmPass(s),r.camera.layers.mask=A,Iae(s,o,X3)}vsmPass(e){const{shadow:t}=this,i=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,i),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,i),e.setRenderTarget(this.vsmShadowMapVertical),qm.material=this.vsmMaterialVertical,qm.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),qm.material=this.vsmMaterialHorizontal,qm.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:t}=this;let i=t.needsUpdate||t.autoUpdate;i&&(this._cameraFrameId[e.camera]===e.frameId&&(i=!1),this._cameraFrameId[e.camera]=e.frameId),i&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const aL=(n,e)=>je(new oL(n,e)),Vae=new Ft,na=Re(([n,e])=>{const t=n.toVar(),i=wi(t),r=va(1,sr(i.x,sr(i.y,i.z)));i.mulAssign(r),t.mulAssign(r.mul(e.mul(2).oneMinus()));const s=Je(t.xy).toVar(),a=e.mul(1.5).oneMinus();return bn(i.z.greaterThanEqual(a),()=>{bn(t.z.greaterThan(0),()=>{s.x.assign(Gn(4,t.x))})}).ElseIf(i.x.greaterThanEqual(a),()=>{const l=zd(t.x);s.x.assign(t.z.mul(l).add(l.mul(2)))}).ElseIf(i.y.greaterThanEqual(a),()=>{const l=zd(t.y);s.x.assign(t.x.add(l.mul(2)).add(2)),s.y.assign(t.z.mul(l).sub(2))}),Je(.125,.25).mul(s).add(Je(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),lL=Re(({depthTexture:n,bd3D:e,dp:t,texelSize:i})=>In(n,na(e,i.y)).compare(t)),uL=Re(({depthTexture:n,bd3D:e,dp:t,texelSize:i,shadow:r})=>{const s=pi("radius","float",r).setGroup(Xt),o=Je(-1,1).mul(s).mul(i.y);return In(n,na(e.add(o.xyy),i.y)).compare(t).add(In(n,na(e.add(o.yyy),i.y)).compare(t)).add(In(n,na(e.add(o.xyx),i.y)).compare(t)).add(In(n,na(e.add(o.yyx),i.y)).compare(t)).add(In(n,na(e,i.y)).compare(t)).add(In(n,na(e.add(o.xxy),i.y)).compare(t)).add(In(n,na(e.add(o.yxy),i.y)).compare(t)).add(In(n,na(e.add(o.xxx),i.y)).compare(t)).add(In(n,na(e.add(o.yxx),i.y)).compare(t)).mul(1/9)}),Gae=Re(({filterFn:n,depthTexture:e,shadowCoord:t,shadow:i})=>{const r=t.xyz.toVar(),s=r.length(),o=qt("float").setGroup(Xt).onRenderUpdate(()=>i.camera.near),a=qt("float").setGroup(Xt).onRenderUpdate(()=>i.camera.far),l=pi("bias","float",i).setGroup(Xt),u=qt(i.mapSize).setGroup(Xt),A=re(1).toVar();return bn(s.sub(a).lessThanEqual(0).and(s.sub(o).greaterThanEqual(0)),()=>{const p=s.sub(o).div(a.sub(o)).toVar();p.addAssign(l);const g=r.normalize(),v=Je(1).div(u.mul(Je(4,2)));A.assign(n({depthTexture:e,bd3D:g,dp:p,texelSize:v,shadow:i}))}),A}),KS=new $t,Jh=new at,f0=new at;class qae extends oL{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===cG?lL:uL}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,shadowTexture:i,depthTexture:r,shadowCoord:s,shadow:o}){return Gae({filterFn:t,shadowTexture:i,depthTexture:r,shadowCoord:s,shadow:o})}renderShadow(e){const{shadow:t,shadowMap:i,light:r}=this,{renderer:s,scene:o}=e,a=t.getFrameExtents();f0.copy(t.mapSize),f0.multiply(a),i.setSize(f0.width,f0.height),Jh.copy(t.mapSize);const l=s.autoClear,u=s.getClearColor(Vae),A=s.getClearAlpha();s.autoClear=!1,s.setClearColor(t.clearColor,t.clearAlpha),s.clear();const p=t.getViewportCount();for(let g=0;g<p;g++){const v=t.getViewport(g),x=Jh.x*v.x,S=f0.y-Jh.y-Jh.y*v.y;KS.set(x,S,Jh.x*v.z,Jh.y*v.w),i.viewport.copy(KS),t.updateMatrices(r,g),s.render(o,t.camera)}s.autoClear=l,s.setClearColor(u,A)}}const cL=(n,e)=>je(new qae(n,e));class mh extends CA{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new Ft,this.colorNode=e&&e.colorNode||qt(this.color).setGroup(Xt),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=mn.FRAME}customCacheKey(){return Fd(this.light.id,this.light.castShadow?1:0)}getHash(){return this.light.uuid}getLightVector(e){return Rb(this.light).sub(e.context.positionView||ur)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return aL(this.light)}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let i=this.shadowColorNode;if(i===null){const r=this.light.shadow.shadowNode;let s;r!==void 0?s=je(r):s=this.setupShadowNode(),this.shadowNode=s,this.shadowColorNode=i=this.colorNode.mul(s),this.baseColorNode=this.colorNode}this.colorNode=i}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),i=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),i&&e.lightsNode.setupDirectRectAreaLight(e,this,i)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const Db=Re(({lightDistance:n,cutoffDistance:e,decayExponent:t})=>{const i=n.pow(t).max(.01).reciprocal();return e.greaterThan(0).select(i.mul(n.div(e).pow4().oneMinus().clamp().pow2()),i)}),hL=({color:n,lightVector:e,cutoffDistance:t,decayExponent:i})=>{const r=e.normalize(),s=e.length(),o=Db({lightDistance:s,cutoffDistance:t,decayExponent:i}),a=n.mul(o);return{lightDirection:r,lightColor:a}};class zae extends mh{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=qt(0).setGroup(Xt),this.decayExponentNode=qt(2).setGroup(Xt)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return cL(this.light)}setupDirect(e){return hL({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const Hae=Re(([n=Oi()])=>{const e=n.mul(2),t=e.x.floor(),i=e.y.floor();return t.add(i).mod(2).sign()}),$ae=Re(([n=Oi()],{renderer:e,material:t})=>{const i=re(1).toVar(),r=Q4(n.mul(2).sub(1));if(t.alphaToCoverage&&e.samples>1){const s=re(r.fwidth()).toVar();i.assign(el(s.oneMinus(),s.add(1),r).oneMinus())}else r.greaterThan(1).discard();return i}),X0=Re(([n,e,t])=>{const i=re(t).toVar(),r=re(e).toVar(),s=Hl(n).toVar();return Or(s,r,i)}).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),Fg=Re(([n,e])=>{const t=Hl(e).toVar(),i=re(n).toVar();return Or(t,i.negate(),i)}).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),cr=Re(([n])=>{const e=re(n).toVar();return de(Xa(e))}).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),Fi=Re(([n,e])=>{const t=re(n).toVar();return e.assign(cr(t)),t.sub(re(e))}),Wae=Re(([n,e,t,i,r,s])=>{const o=re(s).toVar(),a=re(r).toVar(),l=re(i).toVar(),u=re(t).toVar(),A=re(e).toVar(),p=re(n).toVar(),g=re(Gn(1,a)).toVar();return Gn(1,o).mul(p.mul(g).add(A.mul(a))).add(o.mul(u.mul(g).add(l.mul(a))))}).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),jae=Re(([n,e,t,i,r,s])=>{const o=re(s).toVar(),a=re(r).toVar(),l=xe(i).toVar(),u=xe(t).toVar(),A=xe(e).toVar(),p=xe(n).toVar(),g=re(Gn(1,a)).toVar();return Gn(1,o).mul(p.mul(g).add(A.mul(a))).add(o.mul(u.mul(g).add(l.mul(a))))}).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]}),fL=Kr([Wae,jae]),Xae=Re(([n,e,t,i,r,s,o,a,l,u,A])=>{const p=re(A).toVar(),g=re(u).toVar(),v=re(l).toVar(),x=re(a).toVar(),S=re(o).toVar(),T=re(s).toVar(),w=re(r).toVar(),R=re(i).toVar(),E=re(t).toVar(),N=re(e).toVar(),D=re(n).toVar(),B=re(Gn(1,v)).toVar(),I=re(Gn(1,g)).toVar();return re(Gn(1,p)).toVar().mul(I.mul(D.mul(B).add(N.mul(v))).add(g.mul(E.mul(B).add(R.mul(v))))).add(p.mul(I.mul(w.mul(B).add(T.mul(v))).add(g.mul(S.mul(B).add(x.mul(v))))))}).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),Qae=Re(([n,e,t,i,r,s,o,a,l,u,A])=>{const p=re(A).toVar(),g=re(u).toVar(),v=re(l).toVar(),x=xe(a).toVar(),S=xe(o).toVar(),T=xe(s).toVar(),w=xe(r).toVar(),R=xe(i).toVar(),E=xe(t).toVar(),N=xe(e).toVar(),D=xe(n).toVar(),B=re(Gn(1,v)).toVar(),I=re(Gn(1,g)).toVar();return re(Gn(1,p)).toVar().mul(I.mul(D.mul(B).add(N.mul(v))).add(g.mul(E.mul(B).add(R.mul(v))))).add(p.mul(I.mul(w.mul(B).add(T.mul(v))).add(g.mul(S.mul(B).add(x.mul(v))))))}).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),AL=Kr([Xae,Qae]),Yae=Re(([n,e,t])=>{const i=re(t).toVar(),r=re(e).toVar(),s=Et(n).toVar(),o=Et(s.bitAnd(Et(7))).toVar(),a=re(X0(o.lessThan(Et(4)),r,i)).toVar(),l=re(gn(2,X0(o.lessThan(Et(4)),i,r))).toVar();return Fg(a,Hl(o.bitAnd(Et(1)))).add(Fg(l,Hl(o.bitAnd(Et(2)))))}).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),Zae=Re(([n,e,t,i])=>{const r=re(i).toVar(),s=re(t).toVar(),o=re(e).toVar(),a=Et(n).toVar(),l=Et(a.bitAnd(Et(15))).toVar(),u=re(X0(l.lessThan(Et(8)),o,s)).toVar(),A=re(X0(l.lessThan(Et(4)),s,X0(l.equal(Et(12)).or(l.equal(Et(14))),o,r))).toVar();return Fg(u,Hl(l.bitAnd(Et(1)))).add(Fg(A,Hl(l.bitAnd(Et(2)))))}).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),Lr=Kr([Yae,Zae]),Kae=Re(([n,e,t])=>{const i=re(t).toVar(),r=re(e).toVar(),s=MA(n).toVar();return xe(Lr(s.x,r,i),Lr(s.y,r,i),Lr(s.z,r,i))}).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),Jae=Re(([n,e,t,i])=>{const r=re(i).toVar(),s=re(t).toVar(),o=re(e).toVar(),a=MA(n).toVar();return xe(Lr(a.x,o,s,r),Lr(a.y,o,s,r),Lr(a.z,o,s,r))}).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),Lo=Kr([Kae,Jae]),ele=Re(([n])=>{const e=re(n).toVar();return gn(.6616,e)}).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),tle=Re(([n])=>{const e=re(n).toVar();return gn(.982,e)}).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),nle=Re(([n])=>{const e=xe(n).toVar();return gn(.6616,e)}).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),dL=Kr([ele,nle]),ile=Re(([n])=>{const e=xe(n).toVar();return gn(.982,e)}).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),pL=Kr([tle,ile]),Ao=Re(([n,e])=>{const t=de(e).toVar(),i=Et(n).toVar();return i.shiftLeft(t).bitOr(i.shiftRight(de(32).sub(t)))}).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),mL=Re(([n,e,t])=>{n.subAssign(t),n.bitXorAssign(Ao(t,de(4))),t.addAssign(e),e.subAssign(n),e.bitXorAssign(Ao(n,de(6))),n.addAssign(t),t.subAssign(e),t.bitXorAssign(Ao(e,de(8))),e.addAssign(n),n.subAssign(t),n.bitXorAssign(Ao(t,de(16))),t.addAssign(e),e.subAssign(n),e.bitXorAssign(Ao(n,de(19))),n.addAssign(t),t.subAssign(e),t.bitXorAssign(Ao(e,de(4))),e.addAssign(n)}),Sp=Re(([n,e,t])=>{const i=Et(t).toVar(),r=Et(e).toVar(),s=Et(n).toVar();return i.bitXorAssign(r),i.subAssign(Ao(r,de(14))),s.bitXorAssign(i),s.subAssign(Ao(i,de(11))),r.bitXorAssign(s),r.subAssign(Ao(s,de(25))),i.bitXorAssign(r),i.subAssign(Ao(r,de(16))),s.bitXorAssign(i),s.subAssign(Ao(i,de(4))),r.bitXorAssign(s),r.subAssign(Ao(s,de(14))),i.bitXorAssign(r),i.subAssign(Ao(r,de(24))),i}).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),As=Re(([n])=>{const e=Et(n).toVar();return re(e).div(re(Et(de(4294967295))))}).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),Qa=Re(([n])=>{const e=re(n).toVar();return e.mul(e).mul(e).mul(e.mul(e.mul(6).sub(15)).add(10))}).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),rle=Re(([n])=>{const e=de(n).toVar(),t=Et(Et(1)).toVar(),i=Et(Et(de(3735928559)).add(t.shiftLeft(Et(2))).add(Et(13))).toVar();return Sp(i.add(Et(e)),i,i)}).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),sle=Re(([n,e])=>{const t=de(e).toVar(),i=de(n).toVar(),r=Et(Et(2)).toVar(),s=Et().toVar(),o=Et().toVar(),a=Et().toVar();return s.assign(o.assign(a.assign(Et(de(3735928559)).add(r.shiftLeft(Et(2))).add(Et(13))))),s.addAssign(Et(i)),o.addAssign(Et(t)),Sp(s,o,a)}).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),ole=Re(([n,e,t])=>{const i=de(t).toVar(),r=de(e).toVar(),s=de(n).toVar(),o=Et(Et(3)).toVar(),a=Et().toVar(),l=Et().toVar(),u=Et().toVar();return a.assign(l.assign(u.assign(Et(de(3735928559)).add(o.shiftLeft(Et(2))).add(Et(13))))),a.addAssign(Et(s)),l.addAssign(Et(r)),u.addAssign(Et(i)),Sp(a,l,u)}).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),ale=Re(([n,e,t,i])=>{const r=de(i).toVar(),s=de(t).toVar(),o=de(e).toVar(),a=de(n).toVar(),l=Et(Et(4)).toVar(),u=Et().toVar(),A=Et().toVar(),p=Et().toVar();return u.assign(A.assign(p.assign(Et(de(3735928559)).add(l.shiftLeft(Et(2))).add(Et(13))))),u.addAssign(Et(a)),A.addAssign(Et(o)),p.addAssign(Et(s)),mL(u,A,p),u.addAssign(Et(r)),Sp(u,A,p)}).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),lle=Re(([n,e,t,i,r])=>{const s=de(r).toVar(),o=de(i).toVar(),a=de(t).toVar(),l=de(e).toVar(),u=de(n).toVar(),A=Et(Et(5)).toVar(),p=Et().toVar(),g=Et().toVar(),v=Et().toVar();return p.assign(g.assign(v.assign(Et(de(3735928559)).add(A.shiftLeft(Et(2))).add(Et(13))))),p.addAssign(Et(u)),g.addAssign(Et(l)),v.addAssign(Et(a)),mL(p,g,v),p.addAssign(Et(o)),g.addAssign(Et(s)),Sp(p,g,v)}).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]}),ui=Kr([rle,sle,ole,ale,lle]),ule=Re(([n,e])=>{const t=de(e).toVar(),i=de(n).toVar(),r=Et(ui(i,t)).toVar(),s=MA().toVar();return s.x.assign(r.bitAnd(de(255))),s.y.assign(r.shiftRight(de(8)).bitAnd(de(255))),s.z.assign(r.shiftRight(de(16)).bitAnd(de(255))),s}).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),cle=Re(([n,e,t])=>{const i=de(t).toVar(),r=de(e).toVar(),s=de(n).toVar(),o=Et(ui(s,r,i)).toVar(),a=MA().toVar();return a.x.assign(o.bitAnd(de(255))),a.y.assign(o.shiftRight(de(8)).bitAnd(de(255))),a.z.assign(o.shiftRight(de(16)).bitAnd(de(255))),a}).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),Do=Kr([ule,cle]),hle=Re(([n])=>{const e=Je(n).toVar(),t=de().toVar(),i=de().toVar(),r=re(Fi(e.x,t)).toVar(),s=re(Fi(e.y,i)).toVar(),o=re(Qa(r)).toVar(),a=re(Qa(s)).toVar(),l=re(fL(Lr(ui(t,i),r,s),Lr(ui(t.add(de(1)),i),r.sub(1),s),Lr(ui(t,i.add(de(1))),r,s.sub(1)),Lr(ui(t.add(de(1)),i.add(de(1))),r.sub(1),s.sub(1)),o,a)).toVar();return dL(l)}).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),fle=Re(([n])=>{const e=xe(n).toVar(),t=de().toVar(),i=de().toVar(),r=de().toVar(),s=re(Fi(e.x,t)).toVar(),o=re(Fi(e.y,i)).toVar(),a=re(Fi(e.z,r)).toVar(),l=re(Qa(s)).toVar(),u=re(Qa(o)).toVar(),A=re(Qa(a)).toVar(),p=re(AL(Lr(ui(t,i,r),s,o,a),Lr(ui(t.add(de(1)),i,r),s.sub(1),o,a),Lr(ui(t,i.add(de(1)),r),s,o.sub(1),a),Lr(ui(t.add(de(1)),i.add(de(1)),r),s.sub(1),o.sub(1),a),Lr(ui(t,i,r.add(de(1))),s,o,a.sub(1)),Lr(ui(t.add(de(1)),i,r.add(de(1))),s.sub(1),o,a.sub(1)),Lr(ui(t,i.add(de(1)),r.add(de(1))),s,o.sub(1),a.sub(1)),Lr(ui(t.add(de(1)),i.add(de(1)),r.add(de(1))),s.sub(1),o.sub(1),a.sub(1)),l,u,A)).toVar();return pL(p)}).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]}),Ib=Kr([hle,fle]),Ale=Re(([n])=>{const e=Je(n).toVar(),t=de().toVar(),i=de().toVar(),r=re(Fi(e.x,t)).toVar(),s=re(Fi(e.y,i)).toVar(),o=re(Qa(r)).toVar(),a=re(Qa(s)).toVar(),l=xe(fL(Lo(Do(t,i),r,s),Lo(Do(t.add(de(1)),i),r.sub(1),s),Lo(Do(t,i.add(de(1))),r,s.sub(1)),Lo(Do(t.add(de(1)),i.add(de(1))),r.sub(1),s.sub(1)),o,a)).toVar();return dL(l)}).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),dle=Re(([n])=>{const e=xe(n).toVar(),t=de().toVar(),i=de().toVar(),r=de().toVar(),s=re(Fi(e.x,t)).toVar(),o=re(Fi(e.y,i)).toVar(),a=re(Fi(e.z,r)).toVar(),l=re(Qa(s)).toVar(),u=re(Qa(o)).toVar(),A=re(Qa(a)).toVar(),p=xe(AL(Lo(Do(t,i,r),s,o,a),Lo(Do(t.add(de(1)),i,r),s.sub(1),o,a),Lo(Do(t,i.add(de(1)),r),s,o.sub(1),a),Lo(Do(t.add(de(1)),i.add(de(1)),r),s.sub(1),o.sub(1),a),Lo(Do(t,i,r.add(de(1))),s,o,a.sub(1)),Lo(Do(t.add(de(1)),i,r.add(de(1))),s.sub(1),o,a.sub(1)),Lo(Do(t,i.add(de(1)),r.add(de(1))),s,o.sub(1),a.sub(1)),Lo(Do(t.add(de(1)),i.add(de(1)),r.add(de(1))),s.sub(1),o.sub(1),a.sub(1)),l,u,A)).toVar();return pL(p)}).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Bb=Kr([Ale,dle]),ple=Re(([n])=>{const e=re(n).toVar(),t=de(cr(e)).toVar();return As(ui(t))}).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),mle=Re(([n])=>{const e=Je(n).toVar(),t=de(cr(e.x)).toVar(),i=de(cr(e.y)).toVar();return As(ui(t,i))}).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),gle=Re(([n])=>{const e=xe(n).toVar(),t=de(cr(e.x)).toVar(),i=de(cr(e.y)).toVar(),r=de(cr(e.z)).toVar();return As(ui(t,i,r))}).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),_le=Re(([n])=>{const e=zt(n).toVar(),t=de(cr(e.x)).toVar(),i=de(cr(e.y)).toVar(),r=de(cr(e.z)).toVar(),s=de(cr(e.w)).toVar();return As(ui(t,i,r,s))}).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]}),vle=Kr([ple,mle,gle,_le]),yle=Re(([n])=>{const e=re(n).toVar(),t=de(cr(e)).toVar();return xe(As(ui(t,de(0))),As(ui(t,de(1))),As(ui(t,de(2))))}).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),xle=Re(([n])=>{const e=Je(n).toVar(),t=de(cr(e.x)).toVar(),i=de(cr(e.y)).toVar();return xe(As(ui(t,i,de(0))),As(ui(t,i,de(1))),As(ui(t,i,de(2))))}).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),ble=Re(([n])=>{const e=xe(n).toVar(),t=de(cr(e.x)).toVar(),i=de(cr(e.y)).toVar(),r=de(cr(e.z)).toVar();return xe(As(ui(t,i,r,de(0))),As(ui(t,i,r,de(1))),As(ui(t,i,r,de(2))))}).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),wle=Re(([n])=>{const e=zt(n).toVar(),t=de(cr(e.x)).toVar(),i=de(cr(e.y)).toVar(),r=de(cr(e.z)).toVar(),s=de(cr(e.w)).toVar();return xe(As(ui(t,i,r,s,de(0))),As(ui(t,i,r,s,de(1))),As(ui(t,i,r,s,de(2))))}).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]}),gL=Kr([yle,xle,ble,wle]),Ug=Re(([n,e,t,i])=>{const r=re(i).toVar(),s=re(t).toVar(),o=de(e).toVar(),a=xe(n).toVar(),l=re(0).toVar(),u=re(1).toVar();return ri(o,()=>{l.addAssign(u.mul(Ib(a))),u.mulAssign(r),a.mulAssign(s)}),l}).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),_L=Re(([n,e,t,i])=>{const r=re(i).toVar(),s=re(t).toVar(),o=de(e).toVar(),a=xe(n).toVar(),l=xe(0).toVar(),u=re(1).toVar();return ri(o,()=>{l.addAssign(u.mul(Bb(a))),u.mulAssign(r),a.mulAssign(s)}),l}).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Sle=Re(([n,e,t,i])=>{const r=re(i).toVar(),s=re(t).toVar(),o=de(e).toVar(),a=xe(n).toVar();return Je(Ug(a,o,s,r),Ug(a.add(xe(de(19),de(193),de(17))),o,s,r))}).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Tle=Re(([n,e,t,i])=>{const r=re(i).toVar(),s=re(t).toVar(),o=de(e).toVar(),a=xe(n).toVar(),l=xe(_L(a,o,s,r)).toVar(),u=re(Ug(a.add(xe(de(19),de(193),de(17))),o,s,r)).toVar();return zt(l,u)}).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Mle=Re(([n,e,t,i,r,s,o])=>{const a=de(o).toVar(),l=re(s).toVar(),u=de(r).toVar(),A=de(i).toVar(),p=de(t).toVar(),g=de(e).toVar(),v=Je(n).toVar(),x=xe(gL(Je(g.add(A),p.add(u)))).toVar(),S=Je(x.x,x.y).toVar();S.subAssign(.5),S.mulAssign(l),S.addAssign(.5);const T=Je(Je(re(g),re(p)).add(S)).toVar(),w=Je(T.sub(v)).toVar();return bn(a.equal(de(2)),()=>wi(w.x).add(wi(w.y))),bn(a.equal(de(3)),()=>sr(wi(w.x),wi(w.y))),Wu(w,w)}).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Ele=Re(([n,e,t,i,r,s,o,a,l])=>{const u=de(l).toVar(),A=re(a).toVar(),p=de(o).toVar(),g=de(s).toVar(),v=de(r).toVar(),x=de(i).toVar(),S=de(t).toVar(),T=de(e).toVar(),w=xe(n).toVar(),R=xe(gL(xe(T.add(v),S.add(g),x.add(p)))).toVar();R.subAssign(.5),R.mulAssign(A),R.addAssign(.5);const E=xe(xe(re(T),re(S),re(x)).add(R)).toVar(),N=xe(E.sub(w)).toVar();return bn(u.equal(de(2)),()=>wi(N.x).add(wi(N.y)).add(wi(N.z))),bn(u.equal(de(3)),()=>sr(sr(wi(N.x),wi(N.y)),wi(N.z))),Wu(N,N)}).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),RA=Kr([Mle,Ele]),Cle=Re(([n,e,t])=>{const i=de(t).toVar(),r=re(e).toVar(),s=Je(n).toVar(),o=de().toVar(),a=de().toVar(),l=Je(Fi(s.x,o),Fi(s.y,a)).toVar(),u=re(1e6).toVar();return ri({start:-1,end:de(1),name:"x",condition:"<="},({x:A})=>{ri({start:-1,end:de(1),name:"y",condition:"<="},({y:p})=>{const g=re(RA(l,A,p,o,a,r,i)).toVar();u.assign(Ks(u,g))})}),bn(i.equal(de(0)),()=>{u.assign(ul(u))}),u}).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Rle=Re(([n,e,t])=>{const i=de(t).toVar(),r=re(e).toVar(),s=Je(n).toVar(),o=de().toVar(),a=de().toVar(),l=Je(Fi(s.x,o),Fi(s.y,a)).toVar(),u=Je(1e6,1e6).toVar();return ri({start:-1,end:de(1),name:"x",condition:"<="},({x:A})=>{ri({start:-1,end:de(1),name:"y",condition:"<="},({y:p})=>{const g=re(RA(l,A,p,o,a,r,i)).toVar();bn(g.lessThan(u.x),()=>{u.y.assign(u.x),u.x.assign(g)}).ElseIf(g.lessThan(u.y),()=>{u.y.assign(g)})})}),bn(i.equal(de(0)),()=>{u.assign(ul(u))}),u}).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Nle=Re(([n,e,t])=>{const i=de(t).toVar(),r=re(e).toVar(),s=Je(n).toVar(),o=de().toVar(),a=de().toVar(),l=Je(Fi(s.x,o),Fi(s.y,a)).toVar(),u=xe(1e6,1e6,1e6).toVar();return ri({start:-1,end:de(1),name:"x",condition:"<="},({x:A})=>{ri({start:-1,end:de(1),name:"y",condition:"<="},({y:p})=>{const g=re(RA(l,A,p,o,a,r,i)).toVar();bn(g.lessThan(u.x),()=>{u.z.assign(u.y),u.y.assign(u.x),u.x.assign(g)}).ElseIf(g.lessThan(u.y),()=>{u.z.assign(u.y),u.y.assign(g)}).ElseIf(g.lessThan(u.z),()=>{u.z.assign(g)})})}),bn(i.equal(de(0)),()=>{u.assign(ul(u))}),u}).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Ple=Re(([n,e,t])=>{const i=de(t).toVar(),r=re(e).toVar(),s=xe(n).toVar(),o=de().toVar(),a=de().toVar(),l=de().toVar(),u=xe(Fi(s.x,o),Fi(s.y,a),Fi(s.z,l)).toVar(),A=re(1e6).toVar();return ri({start:-1,end:de(1),name:"x",condition:"<="},({x:p})=>{ri({start:-1,end:de(1),name:"y",condition:"<="},({y:g})=>{ri({start:-1,end:de(1),name:"z",condition:"<="},({z:v})=>{const x=re(RA(u,p,g,v,o,a,l,r,i)).toVar();A.assign(Ks(A,x))})})}),bn(i.equal(de(0)),()=>{A.assign(ul(A))}),A}).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Lle=Kr([Cle,Ple]),Dle=Re(([n,e,t])=>{const i=de(t).toVar(),r=re(e).toVar(),s=xe(n).toVar(),o=de().toVar(),a=de().toVar(),l=de().toVar(),u=xe(Fi(s.x,o),Fi(s.y,a),Fi(s.z,l)).toVar(),A=Je(1e6,1e6).toVar();return ri({start:-1,end:de(1),name:"x",condition:"<="},({x:p})=>{ri({start:-1,end:de(1),name:"y",condition:"<="},({y:g})=>{ri({start:-1,end:de(1),name:"z",condition:"<="},({z:v})=>{const x=re(RA(u,p,g,v,o,a,l,r,i)).toVar();bn(x.lessThan(A.x),()=>{A.y.assign(A.x),A.x.assign(x)}).ElseIf(x.lessThan(A.y),()=>{A.y.assign(x)})})})}),bn(i.equal(de(0)),()=>{A.assign(ul(A))}),A}).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Ile=Kr([Rle,Dle]),Ble=Re(([n,e,t])=>{const i=de(t).toVar(),r=re(e).toVar(),s=xe(n).toVar(),o=de().toVar(),a=de().toVar(),l=de().toVar(),u=xe(Fi(s.x,o),Fi(s.y,a),Fi(s.z,l)).toVar(),A=xe(1e6,1e6,1e6).toVar();return ri({start:-1,end:de(1),name:"x",condition:"<="},({x:p})=>{ri({start:-1,end:de(1),name:"y",condition:"<="},({y:g})=>{ri({start:-1,end:de(1),name:"z",condition:"<="},({z:v})=>{const x=re(RA(u,p,g,v,o,a,l,r,i)).toVar();bn(x.lessThan(A.x),()=>{A.z.assign(A.y),A.y.assign(A.x),A.x.assign(x)}).ElseIf(x.lessThan(A.y),()=>{A.z.assign(A.y),A.y.assign(x)}).ElseIf(x.lessThan(A.z),()=>{A.z.assign(x)})})})}),bn(i.equal(de(0)),()=>{A.assign(ul(A))}),A}).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Fle=Kr([Nle,Ble]),Ule=Re(([n])=>{const e=n.y,t=n.z,i=xe().toVar();return bn(e.lessThan(1e-4),()=>{i.assign(xe(t,t,t))}).Else(()=>{let r=n.x;r=r.sub(Xa(r)).mul(6).toVar();const s=de(j4(r)),o=r.sub(re(s)),a=t.mul(e.oneMinus()),l=t.mul(e.mul(o).oneMinus()),u=t.mul(e.mul(o.oneMinus()).oneMinus());bn(s.equal(de(0)),()=>{i.assign(xe(t,u,a))}).ElseIf(s.equal(de(1)),()=>{i.assign(xe(l,t,a))}).ElseIf(s.equal(de(2)),()=>{i.assign(xe(a,t,u))}).ElseIf(s.equal(de(3)),()=>{i.assign(xe(a,l,t))}).ElseIf(s.equal(de(4)),()=>{i.assign(xe(u,a,t))}).Else(()=>{i.assign(xe(t,a,l))})}),i}).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),Ole=Re(([n])=>{const e=xe(n).toVar(),t=re(e.x).toVar(),i=re(e.y).toVar(),r=re(e.z).toVar(),s=re(Ks(t,Ks(i,r))).toVar(),o=re(sr(t,sr(i,r))).toVar(),a=re(o.sub(s)).toVar(),l=re().toVar(),u=re().toVar(),A=re().toVar();return A.assign(o),bn(o.greaterThan(0),()=>{u.assign(a.div(o))}).Else(()=>{u.assign(0)}),bn(u.lessThanEqual(0),()=>{l.assign(0)}).Else(()=>{bn(t.greaterThanEqual(o),()=>{l.assign(i.sub(r).div(a))}).ElseIf(i.greaterThanEqual(o),()=>{l.assign(hr(2,r.sub(t).div(a)))}).Else(()=>{l.assign(hr(4,t.sub(i).div(a)))}),l.mulAssign(1/6),bn(l.lessThan(0),()=>{l.addAssign(1)})}),xe(l,u,A)}).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),kle=Re(([n])=>{const e=xe(n).toVar(),t=L4(G4(e,xe(.04045))).toVar(),i=xe(e.div(12.92)).toVar(),r=xe(la(sr(e.add(xe(.055)),xe(0)).div(1.055),xe(2.4))).toVar();return ii(i,r,t)}).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),vL=(n,e)=>{n=re(n),e=re(e);const t=Je(e.dFdx(),e.dFdy()).length().mul(.7071067811865476);return el(n.sub(t),n.add(t),e)},yL=(n,e,t,i)=>ii(n,e,t[i].clamp()),Vle=(n,e,t=Oi())=>yL(n,e,t,"x"),Gle=(n,e,t=Oi())=>yL(n,e,t,"y"),xL=(n,e,t,i,r)=>ii(n,e,vL(t,i[r])),qle=(n,e,t,i=Oi())=>xL(n,e,t,i,"x"),zle=(n,e,t,i=Oi())=>xL(n,e,t,i,"y"),Hle=(n=1,e=0,t=Oi())=>t.mul(n).add(e),$le=(n,e=1)=>(n=re(n),n.abs().pow(e).mul(n.sign())),Wle=(n,e=1,t=.5)=>re(n).sub(t).mul(e).add(t),jle=(n=Oi(),e=1,t=0)=>Ib(n.convert("vec2|vec3")).mul(e).add(t),Xle=(n=Oi(),e=1,t=0)=>Bb(n.convert("vec2|vec3")).mul(e).add(t),Qle=(n=Oi(),e=1,t=0)=>(n=n.convert("vec2|vec3"),zt(Bb(n),Ib(n.add(Je(19,73)))).mul(e).add(t)),Yle=(n=Oi(),e=1)=>Lle(n.convert("vec2|vec3"),e,de(1)),Zle=(n=Oi(),e=1)=>Ile(n.convert("vec2|vec3"),e,de(1)),Kle=(n=Oi(),e=1)=>Fle(n.convert("vec2|vec3"),e,de(1)),Jle=(n=Oi())=>vle(n.convert("vec2|vec3")),eue=(n=Oi(),e=3,t=2,i=.5,r=1)=>Ug(n,de(e),t,i).mul(r),tue=(n=Oi(),e=3,t=2,i=.5,r=1)=>Sle(n,de(e),t,i).mul(r),nue=(n=Oi(),e=3,t=2,i=.5,r=1)=>_L(n,de(e),t,i).mul(r),iue=(n=Oi(),e=3,t=2,i=.5,r=1)=>Tle(n,de(e),t,i).mul(r),rue=Re(([n,e,t])=>{const i=$l(n).toVar(),r=Gn(re(.5).mul(e.sub(t)),Ul).div(i).toVar(),s=Gn(re(-.5).mul(e.sub(t)),Ul).div(i).toVar(),o=xe().toVar();o.x=i.x.greaterThan(re(0)).select(r.x,s.x),o.y=i.y.greaterThan(re(0)).select(r.y,s.y),o.z=i.z.greaterThan(re(0)).select(r.z,s.z);const a=Ks(Ks(o.x,o.y),o.z).toVar();return Ul.add(i.mul(a)).toVar().sub(t)}),bL=Re(([n,e])=>{const t=n.x,i=n.y,r=n.z;let s=e.element(0).mul(.886227);return s=s.add(e.element(1).mul(2*.511664).mul(i)),s=s.add(e.element(2).mul(2*.511664).mul(r)),s=s.add(e.element(3).mul(2*.511664).mul(t)),s=s.add(e.element(4).mul(2*.429043).mul(t).mul(i)),s=s.add(e.element(5).mul(2*.429043).mul(i).mul(r)),s=s.add(e.element(6).mul(r.mul(r).mul(.743125).sub(.247708))),s=s.add(e.element(7).mul(2*.429043).mul(t).mul(r)),s=s.add(e.element(8).mul(.429043).mul(gn(t,t).sub(gn(i,i)))),s});var U=Object.freeze({__proto__:null,BRDF_GGX:ky,BRDF_Lambert:lh,BasicPointShadowFilter:lL,BasicShadowFilter:eL,Break:WN,Const:yR,Continue:sie,DFGApprox:mb,D_GGX:lP,Discard:OR,EPSILON:zC,F_Schlick:pA,Fn:Re,INFINITY:Hte,If:bn,Loop:ri,NodeAccess:fs,NodeShaderStage:My,NodeType:pte,NodeUpdateType:mn,PCFShadowFilter:tL,PCFSoftShadowFilter:nL,PI:Pg,PI2:$te,PointShadowFilter:uL,Return:one,Schlick_to_F0:cP,ScriptableNodeResources:R1,ShaderNode:gf,Stack:_2,Switch:Ite,TBNViewMatrix:Bc,VSMShadowFilter:iL,V_GGX_SmithCorrelated:aP,Var:vR,abs:wi,acesFilmicToneMapping:$P,acos:YC,add:hr,addMethodChaining:He,addNodeElement:une,agxToneMapping:WP,all:HC,alphaT:Cg,and:EC,anisotropy:wu,anisotropyB:Hc,anisotropyT:z0,any:$C,append:Ote,array:yC,arrayBuffer:Fte,asin:QC,assign:xC,atan:H4,atan2:pR,atomicAdd:mae,atomicAnd:yae,atomicFunc:cl,atomicLoad:dae,atomicMax:_ae,atomicMin:vae,atomicOr:xae,atomicStore:pae,atomicSub:gae,atomicXor:bae,attenuationColor:U4,attenuationDistance:F4,attribute:jl,attributeArray:loe,backgroundBlurriness:LP,backgroundIntensity:$y,backgroundRotation:DP,batch:zN,billboarding:$se,bitAnd:PC,bitNot:LC,bitOr:DC,bitXor:IC,bitangentGeometry:Fne,bitangentLocal:Une,bitangentView:iN,bitangentWorld:One,bitcast:Wte,blendBurn:UP,blendColor:yoe,blendDodge:OP,blendOverlay:VP,blendScreen:kP,blur:gP,bool:Hl,buffer:pp,bufferAttribute:dp,bumpMap:aN,burn:xoe,bvec2:cC,bvec3:L4,bvec4:dC,bypass:IR,cache:$0,call:bC,cameraFar:Mu,cameraIndex:R2,cameraNear:Tu,cameraNormalMatrix:vne,cameraPosition:HR,cameraProjectionMatrix:Ah,cameraProjectionMatrixInverse:gne,cameraViewMatrix:eo,cameraWorldMatrix:_ne,cbrt:cR,cdl:Roe,ceil:S2,checker:Hae,cineonToneMapping:HP,clamp:Ja,clearcoat:Eg,clearcoatRoughness:Gd,code:k2,color:lC,colorSpaceToWorking:C2,colorToDirection:Die,compute:DR,computeSkinning:iie,cond:mR,context:E2,convert:mC,convertColorSpace:Zte,convertToTexture:roe,cos:Sl,cross:M2,cubeTexture:dA,cubeToUV:na,dFdx:$4,dFdy:W4,dashSize:x1,debug:VR,decrement:VC,decrementBefore:OC,defaultBuildStages:Ey,defaultShaderStages:nC,defined:Ud,degrees:jC,deltaTime:RP,densityFog:Zoe,densityFogFactor:Tb,depth:fb,depthPass:Ioe,difference:oR,diffuseColor:Kn,directPointLight:hL,directionToColor:eP,dispersion:O4,distance:sR,div:va,dodge:boe,dot:Wu,drawIndex:VN,dynamicBufferAttribute:LR,element:pC,emissive:Py,equal:V4,equals:iR,equirectUV:Ab,exp:q4,exp2:AA,expression:Wl,faceDirection:_p,faceForward:Z4,faceforward:jte,float:re,floor:Xa,fog:$d,fract:Zl,frameGroup:vC,frameId:Bse,frontFacing:XR,fwidth:tR,gain:Cse,gapSize:Ly,getConstNodeType:aC,getCurrentStack:P4,getDirection:pP,getDistanceAttenuation:Db,getGeometryRoughness:oP,getNormalFromDepth:ooe,getParallaxCorrectNormal:rue,getRoughness:pb,getScreenPosition:soe,getShIrradianceAt:bL,getShadowMaterial:rL,getShadowRenderObjectFunction:sL,getTextureIndex:EP,getViewPosition:uf,globalId:iae,glsl:zoe,glslFn:Hoe,grayscale:Toe,greaterThan:G4,greaterThanEqual:MC,hash:Ese,highpModelNormalViewMatrix:By,highpModelViewMatrix:Iy,hue:Coe,increment:kC,incrementBefore:UC,instance:Yne,instanceIndex:Bu,instancedArray:uoe,instancedBufferAttribute:Lg,instancedDynamicBufferAttribute:Dy,instancedMesh:qN,int:de,inverseSqrt:z4,inversesqrt:Xte,invocationLocalIndex:Qne,invocationSubgroupIndex:Xne,ior:H0,iridescence:x2,iridescenceIOR:D4,iridescenceThickness:I4,ivec2:Sr,ivec3:hC,ivec4:fC,js:Goe,label:_R,length:Fl,lengthSq:Q4,lessThan:SC,lessThanEqual:TC,lightPosition:Cb,lightProjectionUV:KP,lightShadowMatrix:Eb,lightTargetDirection:Nb,lightTargetPosition:JP,lightViewPosition:Rb,lightingContext:XN,lights:Tae,linearDepth:Ig,linearToneMapping:qP,localId:rae,log:w2,log2:ja,logarithmicDepthToViewZ:vie,loop:oie,luminance:wb,mat2:v2,mat3:ps,mat4:zc,matcapUV:yP,materialAO:ON,materialAlphaTest:lN,materialAnisotropy:wN,materialAnisotropyVector:lf,materialAttenuationColor:PN,materialAttenuationDistance:NN,materialClearcoat:gN,materialClearcoatNormal:vN,materialClearcoatRoughness:_N,materialColor:uN,materialDispersion:UN,materialEmissive:hN,materialEnvIntensity:S1,materialEnvRotation:ib,materialIOR:RN,materialIridescence:SN,materialIridescenceIOR:TN,materialIridescenceThickness:MN,materialLightMap:ob,materialLineDashOffset:BN,materialLineDashSize:DN,materialLineGapSize:IN,materialLineScale:LN,materialLineWidth:Wne,materialMetalness:pN,materialNormal:mN,materialOpacity:sb,materialPointSize:FN,materialReference:Rl,materialReflectivity:T1,materialRefractionRatio:ZR,materialRotation:yN,materialRoughness:dN,materialSheen:xN,materialSheenRoughness:bN,materialShininess:cN,materialSpecular:fN,materialSpecularColor:AN,materialSpecularIntensity:Oy,materialSpecularStrength:W0,materialThickness:CN,materialTransmission:EN,max:sr,maxMipLevel:qR,mediumpModelViewMatrix:jR,metalness:Vd,min:Ks,mix:ii,mixElement:AR,mod:hp,modInt:qC,modelDirection:Tne,modelNormalMatrix:WR,modelPosition:Mne,modelRadius:Rne,modelScale:Ene,modelViewMatrix:dh,modelViewPosition:Cne,modelViewProjection:ab,modelWorldMatrix:Oo,modelWorldMatrixInverse:Nne,morphReference:jN,mrt:CP,mul:gn,mx_aastep:vL,mx_cell_noise_float:Jle,mx_contrast:Wle,mx_fractal_noise_float:eue,mx_fractal_noise_vec2:tue,mx_fractal_noise_vec3:nue,mx_fractal_noise_vec4:iue,mx_hsvtorgb:Ule,mx_noise_float:jle,mx_noise_vec3:Xle,mx_noise_vec4:Qle,mx_ramplr:Vle,mx_ramptb:Gle,mx_rgbtohsv:Ole,mx_safepower:$le,mx_splitlr:qle,mx_splittb:zle,mx_srgb_texture_to_lin_rec709:kle,mx_transform_uv:Hle,mx_worley_noise_float:Yle,mx_worley_noise_vec2:Zle,mx_worley_noise_vec3:Kle,negate:ZC,neutralToneMapping:jP,nodeArray:qc,nodeImmutable:gt,nodeObject:je,nodeObjects:up,nodeProxy:Qe,normalFlat:QR,normalGeometry:N2,normalLocal:Js,normalMap:Uy,normalView:Wo,normalWorld:P2,normalize:$l,not:RC,notEqual:wC,numWorkgroups:tae,objectDirection:yne,objectGroup:k4,objectPosition:$R,objectRadius:Sne,objectScale:bne,objectViewPosition:wne,objectWorldMatrix:xne,oneMinus:KC,or:CC,orthographicDepthToViewZ:_ie,oscSawtooth:qse,oscSine:kse,oscSquare:Vse,oscTriangle:Gse,output:If,outputStruct:Tse,overlay:Soe,overloadingFn:Kr,parabola:Hy,parallaxDirection:sN,parallaxUV:Vne,parameter:vse,pass:Loe,passTexture:Doe,pcurve:Rse,perspectiveDepthToViewZ:cb,pmremTexture:vb,pointShadow:cL,pointUV:hoe,pointWidth:Vte,positionGeometry:gp,positionLocal:nr,positionPrevious:Dg,positionView:ur,positionViewDirection:Li,positionWorld:Ul,positionWorldDirection:tb,posterize:Poe,pow:la,pow2:X4,pow3:aR,pow4:lR,property:EA,radians:WC,rand:fR,range:Joe,rangeFog:Yoe,rangeFogFactor:Sb,reciprocal:eR,reference:pi,referenceBuffer:Fy,reflect:rR,reflectVector:eN,reflectView:KR,reflector:Jse,refract:Y4,refractVector:tN,refractView:JR,reinhardToneMapping:zP,remainder:GC,remap:FR,remapClamp:UR,renderGroup:Xt,renderOutput:kR,rendererReference:RR,rotate:O2,rotateUV:zse,roughness:Va,round:JC,rtt:PP,sRGBTransferEOTF:wR,sRGBTransferOETF:SR,sampler:fne,samplerComparison:Ane,saturate:hR,saturation:Moe,screen:woe,screenCoordinate:bp,screenSize:Hd,screenUV:Aa,scriptable:Qoe,scriptableValue:C1,select:Or,setCurrentStack:Od,shaderStages:Cy,shadow:aL,shadowPositionWorld:Lb,shapeCircle:$ae,sharedUniformGroup:b2,sheen:Ic,sheenRoughness:y2,shiftLeft:BC,shiftRight:FC,shininess:Rg,sign:zd,sin:mo,sinc:Nse,skinning:$N,smoothstep:el,smoothstepElement:dR,specularColor:Vs,specularF90:qd,spherizeUV:Hse,split:Ute,spritesheetUV:Xse,sqrt:ul,stack:M1,step:T2,storage:$c,storageBarrier:lae,storageObject:nie,storageTexture:IP,string:Bte,struct:Sse,sub:Gn,subgroupIndex:jne,subgroupSize:sae,tan:XC,tangentGeometry:I2,tangentLocal:vp,tangentView:yp,tangentWorld:nN,temp:xR,texture:In,texture3D:BP,textureBarrier:uae,textureBicubic:AP,textureCubeUV:mP,textureLoad:Zi,textureSize:Iu,textureStore:Aoe,thickness:B4,time:ph,timerDelta:Ose,timerGlobal:Use,timerLocal:Fse,toOutputColorSpace:TR,toWorkingColorSpace:MR,toneMapping:NR,toneMappingExposure:PR,toonOutlinePass:Foe,transformDirection:uR,transformNormal:YR,transformNormalToView:nb,transformedBentNormalView:oN,transformedBitangentView:rN,transformedBitangentWorld:kne,transformedClearcoatNormalView:_f,transformedNormalView:tr,transformedNormalWorld:L2,transformedTangentView:rb,transformedTangentWorld:Bne,transmission:Ng,transpose:nR,triNoise3D:Lse,triplanarTexture:Yse,triplanarTextures:NP,trunc:j4,tslFn:kte,uint:Et,uniform:qt,uniformArray:Fo,uniformGroup:_C,uniforms:pne,userData:goe,uv:Oi,uvec2:uC,uvec3:MA,uvec4:AC,varying:To,varyingProperty:kd,vec2:Je,vec3:xe,vec4:zt,vectorComponents:hh,velocity:voe,vertexColor:JN,vertexIndex:kN,vertexStage:bR,vibrance:Eoe,viewZToLogarithmicDepth:hb,viewZToOrthographicDepth:Ff,viewZToPerspectiveDepth:ZN,viewport:Bf,viewportBottomLeft:pie,viewportCoordinate:YN,viewportDepthTexture:ub,viewportLinearDepth:yie,viewportMipTexture:lb,viewportResolution:Aie,viewportSafeUV:Wse,viewportSharedTexture:Lie,viewportSize:QN,viewportTexture:mie,viewportTopLeft:die,viewportUV:fie,wgsl:qoe,wgslFn:$oe,workgroupArray:fae,workgroupBarrier:aae,workgroupId:nae,workingToColorSpace:ER,xor:NC});const Zo=new yb;class sue extends ju{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,i){const r=this.renderer,s=this.nodes.getBackgroundNode(e)||e.background;let o=!1;if(s===null)r._clearColor.getRGB(Zo),Zo.a=r._clearColor.a;else if(s.isColor===!0)s.getRGB(Zo),Zo.a=1,o=!0;else if(s.isNode===!0){const l=this.get(e),u=s;Zo.copy(r._clearColor);let A=l.backgroundMesh;if(A===void 0){let S=function(){s.removeEventListener("dispose",S),A.material.dispose(),A.geometry.dispose()};const g=E2(zt(u).mul($y),{getUV:()=>DP.mul(P2),getTextureLevel:()=>LP});let v=ab;v=v.setZ(v.w);const x=new fr;x.name="Background.material",x.side=_i,x.depthTest=!1,x.depthWrite=!1,x.allowOverride=!1,x.fog=!1,x.lights=!1,x.vertexNode=v,x.colorNode=g,l.backgroundMeshNode=g,l.backgroundMesh=A=new Jn(new al(1,32,32),x),A.frustumCulled=!1,A.name="Background.mesh",A.onBeforeRender=function(T,w,R){this.matrixWorld.copyPosition(R.matrixWorld)},s.addEventListener("dispose",S)}const p=u.getCacheKey();l.backgroundCacheKey!==p&&(l.backgroundMeshNode.node=zt(u).mul($y),l.backgroundMeshNode.needsUpdate=!0,A.material.needsUpdate=!0,l.backgroundCacheKey=p),t.unshift(A,A.geometry,A.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",s);const a=r.xr.getEnvironmentBlendMode();if(a==="additive"?Zo.set(0,0,0,1):a==="alpha-blend"&&Zo.set(0,0,0,0),r.autoClear===!0||o===!0){const l=i.clearColorValue;l.r=Zo.r,l.g=Zo.g,l.b=Zo.b,l.a=Zo.a,(r.backend.isWebGLBackend===!0||r.alpha===!0)&&(l.r*=l.a,l.g*=l.a,l.b*=l.a),i.depthClearValue=r._clearDepth,i.stencilClearValue=r._clearStencil,i.clearColor=r.autoClearColor===!0,i.clearDepth=r.autoClearDepth===!0,i.clearStencil=r.autoClearStencil===!0}else i.clearColor=!1,i.clearDepth=!1,i.clearStencil=!1}}let oue=0;class Wy{constructor(e="",t=[],i=0,r=[]){this.name=e,this.bindings=t,this.index=i,this.bindingsReference=r,this.id=oue++}}class aue{constructor(e,t,i,r,s,o,a,l,u,A=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=i,this.transforms=A,this.nodeAttributes=r,this.bindings=s,this.updateNodes=o,this.updateBeforeNodes=a,this.updateAfterNodes=l,this.observer=u,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const r=new Wy(t.name,[],t.index,t);e.push(r);for(const s of t.bindings)r.bindings.push(s.clone())}else e.push(t);return e}}class JS{constructor(e,t,i=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=i}}class lue{constructor(e,t,i){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=i.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class wL{constructor(e,t,i=!1,r=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=i,this.count=r}}class uue extends wL{constructor(e,t,i=null,r=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=i,this.interpolationSampling=r}}class cue{constructor(e,t,i=""){this.name=e,this.type=t,this.code=i,Object.defineProperty(this,"isNodeCode",{value:!0})}}let hue=0;class Q3{constructor(e=null){this.id=hue++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class fue{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class Xu{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class Aue extends Xu{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class due extends Xu{constructor(e,t=new at){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class pue extends Xu{constructor(e,t=new ie){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class mue extends Xu{constructor(e,t=new $t){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class gue extends Xu{constructor(e,t=new Ft){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class _ue extends Xu{constructor(e,t=new c2){super(e,t),this.isMatrix2Uniform=!0,this.boundary=16,this.itemSize=4}}class vue extends Xu{constructor(e,t=new dn){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class yue extends Xu{constructor(e,t=new en){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class xue extends Aue{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class bue extends due{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class wue extends pue{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Sue extends mue{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Tue extends gue{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Mue extends _ue{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Eue extends vue{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Cue extends yue{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const eT=new WeakMap,Rue=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),zm=n=>/e/g.test(n)?String(n).replace(/\+/g,""):(n=Number(n),n+(n%1?"":".0"));class SL{constructor(e,t,i){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=i,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=M1(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new Q3,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null}getBindGroupsCache(){let e=eT.get(this.renderer);return e===void 0&&(e=new ya,eT.set(this.renderer,e)),e}createRenderTarget(e,t,i){return new ol(e,t,i)}createRenderTargetArray(e,t,i,r){return new Ez(e,t,i,r)}createCubeRenderTarget(e,t){return new tP(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const i=this.getBindGroupsCache(),r=[];let s=!0;for(const a of t)r.push(a),s=s&&a.groupNode.shared!==!0;let o;return s?(o=i.get(r),o===void 0&&(o=new Wy(e,r,this.bindingsIndexes[e].group,r),i.set(r,o))):o=new Wy(e,r,this.bindingsIndexes[e].group,r),o}getBindGroupArray(e,t){const i=this.bindings[t];let r=i[e];return r===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),i[e]=r=[]),r}getBindings(){let e=this.bindGroups;if(e===null){const t={},i=this.bindings;for(const r of Cy)for(const s in i[r]){const o=i[r][s];(t[s]||(t[s]=[])).push(...o)}e=[];for(const r in t){const s=t[r],o=this._getBindGroup(r,s);e.push(o)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,i)=>t.bindings[0].groupNode.order-i.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const i=e[t];this.bindingsIndexes[i.name].group=t,i.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==mn.NONE&&this.updateNodes.push(e.getSelf());for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),i=e.getUpdateAfterType();t!==mn.NONE&&this.updateBeforeNodes.push(e.getSelf()),i!==mn.NONE&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===Tr||e.magFilter===Rf||e.magFilter===Pl||e.magFilter===zs||e.minFilter===Tr||e.minFilter===Rf||e.minFilter===Pl||e.minFilter===zs}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const i=this.getDataFromNode(e);return i.cache===void 0&&(i.cache=new Q3(t?this.getCache():null)),i.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,i=null){let r=this.generateArrayDeclaration(e,t)+"( ";for(let s=0;s<t;s++){const o=i?i[s]:null;o!==null?r+=o.build(this,e):r+=this.generateConst(e),s<t-1&&(r+=", ")}return r+=" )",r}generateStruct(e,t,i=null){const r=[];for(const s of t){const{name:o,type:a}=s;i&&i[o]&&i[o].isNode?r.push(i[o].build(this,a)):r.push(this.generateConst(a))}return e+"( "+r.join(", ")+" )"}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new Ft:e==="vec2"?t=new at:e==="vec3"?t=new ie:e==="vec4"&&(t=new $t)),e==="float")return zm(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${zm(t.r)}, ${zm(t.g)}, ${zm(t.b)} )`;const i=this.getTypeLength(e),r=this.getComponentType(e),s=o=>this.generateConst(r,o);if(i===2)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)} )`;if(i===3)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)} )`;if(i===4&&e!=="mat2")return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)}, ${s(t.w)} )`;if(i>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(s).join(", ")} )`;if(i>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const i=this.attributes;for(const s of i)if(s.name===e)return s;const r=new JS(e,t);return this.registerDeclaration(r),i.push(r),r}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===Ir)return"int";if(t===bi)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;let i=Z9(e);const r=t==="float"?"":t[0];return/mat2/.test(t)===!0&&(i=i.replace("vec","mat")),r+i}getTypeFromArray(e){return Rue.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const i=t.array,r=e.itemSize,s=e.normalized;let o;return!(e instanceof K7)&&s!==!0&&(o=this.getTypeFromArray(i)),this.getTypeFromLength(r,o)}getTypeLength(e){const t=this.getVectorType(e),i=/vec([2-4])/.exec(t);return i!==null?Number(i[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}addStack(){return this.stack=M1(this.stack),this.stacks.push(P4()||this.stack),Od(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,Od(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,i=null){i=i===null?e.isGlobal(this)?this.globalCache:this.cache:i;let r=i.getData(e);return r===void 0&&(r={},i.setData(e,r)),r[t]===void 0&&(r[t]={}),r[t]}getNodeProperties(e,t="any"){const i=this.getDataFromNode(e,t);return i.properties||(i.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const i=this.getDataFromNode(e);let r=i.bufferAttribute;if(r===void 0){const s=this.uniforms.index++;r=new JS("nodeAttribute"+s,t,e),this.bufferAttributes.push(r),i.bufferAttribute=r}return r}getStructTypeFromNode(e,t,i=null,r=this.shaderStage){const s=this.getDataFromNode(e,r,this.globalCache);let o=s.structType;if(o===void 0){const a=this.structs.index++;i===null&&(i="StructType"+a),o=new fue(i,t),this.structs[r].push(o),s.structType=o}return o}getOutputStructTypeFromNode(e,t){const i=this.getStructTypeFromNode(e,t,"OutputType","fragment");return i.output=!0,i}getUniformFromNode(e,t,i=this.shaderStage,r=null){const s=this.getDataFromNode(e,i,this.globalCache);let o=s.uniform;if(o===void 0){const a=this.uniforms.index++;o=new lue(r||"nodeUniform"+a,t,e),this.uniforms[i].push(o),this.registerDeclaration(o),s.uniform=o}return o}getArrayCount(e){let t=null;return e.isArrayNode?t=e.count:e.isVarNode&&e.node.isArrayNode&&(t=e.node.count),t}getVarFromNode(e,t=null,i=e.getNodeType(this),r=this.shaderStage,s=!1){const o=this.getDataFromNode(e,r);let a=o.variable;if(a===void 0){const l=s?"_const":"_var",u=this.vars[r]||(this.vars[r]=[]),A=this.vars[l]||(this.vars[l]=0);t===null&&(t=(s?"nodeConst":"nodeVar")+A,this.vars[l]++);const p=this.getArrayCount(e);a=new wL(t,i,s,p),s||u.push(a),this.registerDeclaration(a),o.variable=a}return a}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const t of e.values)if(!this.isDeterministic(t))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,t=null,i=e.getNodeType(this),r=null,s=null){const o=this.getDataFromNode(e,"any");let a=o.varying;if(a===void 0){const l=this.varyings,u=l.length;t===null&&(t="nodeVarying"+u),a=new uue(t,i,r,s),l.push(a),this.registerDeclaration(a),o.varying=a}return a}registerDeclaration(e){const t=this.shaderStage,i=this.declarations[t]||(this.declarations[t]={}),r=this.getPropertyName(e);let s=1,o=r;for(;i[o]!==void 0;)o=r+"_"+s++;s>1&&(e.name=o,console.warn(`THREE.TSL: Declaration name '${r}' of '${e.type}' already in use. Renamed to '${o}'.`)),i[o]=e}getCodeFromNode(e,t,i=this.shaderStage){const r=this.getDataFromNode(e);let s=r.code;if(s===void 0){const o=this.codes[i]||(this.codes[i]=[]),a=o.length;s=new cue("nodeCode"+a,t),o.push(s),r.code=s}return s}addFlowCodeHierarchy(e,t){const{flowCodes:i,flowCodeBlock:r}=this.getDataFromNode(e);let s=!0,o=t;for(;o;){if(r.get(o)===!0){s=!1;break}o=this.getDataFromNode(o).parentNodeBlock}if(s)for(const a of i)this.addLineFlowCode(a)}addLineFlowCodeBlock(e,t,i){const r=this.getDataFromNode(e),s=r.flowCodes||(r.flowCodes=[]),o=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);s.push(t),o.set(i,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),i=this.flowChildNode(e,t);return this.flowsData.set(e,i),i}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new XP,i=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=i,t}flowShaderNode(e){const t=e.layout,i={[Symbol.iterator](){let o=0;const a=Object.values(this);return{next:()=>({value:a[o],done:o++>=a.length})}}};for(const o of t.inputs)i[o.name]=new TP(o.type,o.name);e.layout=null;const r=e.call(i),s=this.flowStagesNode(r,t.type);return e.layout=t,s}flowStagesNode(e,t=null){const i=this.flow,r=this.vars,s=this.declarations,o=this.cache,a=this.buildStage,l=this.stack,u={code:""};this.flow=u,this.vars={},this.declarations={},this.cache=new Q3,this.stack=M1();for(const A of Ey)this.setBuildStage(A),u.result=e.build(this,t);return u.vars=this.getVars(this.shaderStage),this.flow=i,this.vars=r,this.declarations=s,this.cache=o,this.stack=l,this.setBuildStage(a),u}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e,t=null){const i=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=i,r}flowNodeFromShaderStage(e,t,i=null,r=null){const s=this.shaderStage;this.setShaderStage(e);const o=this.flowChildNode(t,i);return r!==null&&(o.code+=`${this.tab+r} = ${o.result};
`),this.flowCode[e]=this.flowCode[e]+o.code,this.setShaderStage(s),o}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t,i=null){return`${i!==null?this.generateArrayDeclaration(e,i):this.getType(e)} ${t}`}getVars(e){let t="";const i=this.vars[e];if(i!==void 0)for(const r of i)t+=`${this.getVar(r.type,r.name)}; `;return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let i="";if(t!==void 0)for(const r of t)i+=r.code+`
`;return i}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:t,renderer:i}=this;if(t!==null){let r=i.library.fromMaterial(t);r===null&&(console.error(`NodeMaterial: Material "${t.type}" is not compatible.`),r=new fr),r.build(this)}else this.addFlow("compute",e);for(const r of Ey){this.setBuildStage(r),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const s of Cy){this.setShaderStage(s);const o=this.flowNodes[s];for(const a of o)r==="generate"?this.flowNode(a):a.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if(t==="float"||t==="int"||t==="uint")return new xue(e);if(t==="vec2"||t==="ivec2"||t==="uvec2")return new bue(e);if(t==="vec3"||t==="ivec3"||t==="uvec3")return new wue(e);if(t==="vec4"||t==="ivec4"||t==="uvec4")return new Sue(e);if(t==="color")return new Tue(e);if(t==="mat2")return new Mue(e);if(t==="mat3")return new Eue(e);if(t==="mat4")return new Cue(e);throw new Error(`Uniform "${t}" not declared.`)}format(e,t,i){if(t=this.getVectorType(t),i=this.getVectorType(i),t===i||i===null||this.isReference(i))return e;const r=this.getTypeLength(t),s=this.getTypeLength(i);return r===16&&s===9?`${this.getType(i)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:r===9&&s===4?`${this.getType(i)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:r>4||s>4||s===0?e:r===s?`${this.getType(i)}( ${e} )`:r>s?(e=i==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,s)}`,this.format(e,this.getTypeFromLength(s,this.getComponentType(t)),i)):s===4&&r>1?`${this.getType(i)}( ${this.format(e,t,"vec3")}, 1.0 )`:r===2?`${this.getType(i)}( ${this.format(e,t,"vec2")}, 0.0 )`:(r===1&&s>1&&t!==this.getComponentType(i)&&(e=`${this.getType(this.getComponentType(i))}( ${e} )`),`${this.getType(i)}( ${e} )`)}getSignature(){return`// Three.js r${ep} - Node System
`}*[Symbol.iterator](){}createNodeMaterial(e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${e}() instead.`)}}class tT{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let i=e.get(t);return i===void 0&&(i={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,i)),i}updateBeforeNode(e){const t=e.getUpdateBeforeType(),i=e.updateReference(this);if(t===mn.FRAME){const{frameMap:r}=this._getMaps(this.updateBeforeMap,i);r.get(i)!==this.frameId&&e.updateBefore(this)!==!1&&r.set(i,this.frameId)}else if(t===mn.RENDER){const{renderMap:r}=this._getMaps(this.updateBeforeMap,i);r.get(i)!==this.renderId&&e.updateBefore(this)!==!1&&r.set(i,this.renderId)}else t===mn.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),i=e.updateReference(this);if(t===mn.FRAME){const{frameMap:r}=this._getMaps(this.updateAfterMap,i);r.get(i)!==this.frameId&&e.updateAfter(this)!==!1&&r.set(i,this.frameId)}else if(t===mn.RENDER){const{renderMap:r}=this._getMaps(this.updateAfterMap,i);r.get(i)!==this.renderId&&e.updateAfter(this)!==!1&&r.set(i,this.renderId)}else t===mn.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),i=e.updateReference(this);if(t===mn.FRAME){const{frameMap:r}=this._getMaps(this.updateMap,i);r.get(i)!==this.frameId&&e.update(this)!==!1&&r.set(i,this.frameId)}else if(t===mn.RENDER){const{renderMap:r}=this._getMaps(this.updateMap,i);r.get(i)!==this.renderId&&e.update(this)!==!1&&r.set(i,this.renderId)}else t===mn.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class Fb{constructor(e,t,i=null,r="",s=!1){this.type=e,this.name=t,this.count=i,this.qualifier=r,this.isConst=s}}Fb.isNodeFunctionInput=!0;class Nue extends mh{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:Nb(this.light),lightColor:e}}}const Y3=new en,Hm=new en;let A0=null;class Pue extends mh{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=qt(new ie).setGroup(Xt),this.halfWidth=qt(new ie).setGroup(Xt),this.updateType=mn.RENDER}update(e){super.update(e);const{light:t}=this,i=e.camera.matrixWorldInverse;Hm.identity(),Y3.copy(t.matrixWorld),Y3.premultiply(i),Hm.extractRotation(Y3),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(Hm),this.halfHeight.value.applyMatrix4(Hm)}setupDirectRectArea(e){let t,i;e.isAvailable("float32Filterable")?(t=In(A0.LTC_FLOAT_1),i=In(A0.LTC_FLOAT_2)):(t=In(A0.LTC_HALF_1),i=In(A0.LTC_HALF_2));const{colorNode:r,light:s}=this,o=Rb(s);return{lightColor:r,lightPosition:o,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:i}}static setLTC(e){A0=e}}class TL extends mh{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=qt(0).setGroup(Xt),this.penumbraCosNode=qt(0).setGroup(Xt),this.cutoffDistanceNode=qt(0).setGroup(Xt),this.decayExponentNode=qt(0).setGroup(Xt)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e){const{coneCosNode:t,penumbraCosNode:i}=this;return el(t,i,e)}setupDirect(e){const{colorNode:t,cutoffDistanceNode:i,decayExponentNode:r,light:s}=this,o=this.getLightVector(e),a=o.normalize(),l=a.dot(Nb(s)),u=this.getSpotAttenuation(l),A=o.length(),p=Db({lightDistance:A,cutoffDistance:i,decayExponent:r});let g=t.mul(u).mul(p);if(s.map){const v=KP(s,e.context.positionWorld),x=In(s.map,v.xy).onRenderUpdate(()=>s.map);g=v.mul(2).sub(1).abs().lessThan(1).all().select(g.mul(x),g)}return{lightColor:g,lightDirection:a}}}class Lue extends TL{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e){const t=this.light.iesMap;let i=null;if(t&&t.isTexture===!0){const r=e.acos().mul(1/Math.PI);i=In(t,Je(r,0),0).r}else i=super.getSpotAttenuation(e);return i}}class Due extends mh{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class Iue extends mh{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=Cb(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=qt(new Ft).setGroup(Xt)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:i,lightDirectionNode:r}=this,o=Wo.dot(r).mul(.5).add(.5),a=ii(i,t,o);e.context.irradiance.addAssign(a)}}class Bue extends mh{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let i=0;i<9;i++)t.push(new ie);this.lightProbe=Fo(t)}update(e){const{light:t}=this;super.update(e);for(let i=0;i<9;i++)this.lightProbe.array[i].copy(t.sh.coefficients[i]).multiplyScalar(t.intensity)}setup(e){const t=bL(P2,this.lightProbe);e.context.irradiance.addAssign(t)}}class ML{parseFunction(){console.warn("Abstract function.")}}class Ub{constructor(e,t,i="",r=""){this.type=e,this.inputs=t,this.name=i,this.precision=r}getCode(){console.warn("Abstract function.")}}Ub.isNodeFunction=!0;const Fue=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,Uue=/[a-z_0-9]+/ig,nT="#pragma main",Oue=n=>{n=n.trim();const e=n.indexOf(nT),t=e!==-1?n.slice(e+nT.length):n,i=t.match(Fue);if(i!==null&&i.length===5){const r=i[4],s=[];let o=null;for(;(o=Uue.exec(r))!==null;)s.push(o);const a=[];let l=0;for(;l<s.length;){const x=s[l][0]==="const";x===!0&&l++;let S=s[l][0];S==="in"||S==="out"||S==="inout"?l++:S="";const T=s[l++][0];let w=Number.parseInt(s[l][0]);Number.isNaN(w)===!1?l++:w=null;const R=s[l++][0];a.push(new Fb(T,R,w,S,x))}const u=t.substring(i[0].length),A=i[3]!==void 0?i[3]:"",p=i[2],g=i[1]!==void 0?i[1]:"",v=e!==-1?n.slice(0,e):"";return{type:p,inputs:a,name:A,precision:g,inputsCode:r,blockCode:u,headerCode:v}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class kue extends Ub{constructor(e){const{type:t,inputs:i,name:r,precision:s,inputsCode:o,blockCode:a,headerCode:l}=Oue(e);super(t,i,r,s),this.inputsCode=o,this.blockCode=a,this.headerCode=l}getCode(e=this.name){let t;const i=this.blockCode;if(i!==""){const{type:r,inputsCode:s,headerCode:o,precision:a}=this;let l=`${r} ${e} ( ${s.trim()} )`;a!==""&&(l=`${a} ${l}`),t=o+l+i}else t="";return t}}class Vue extends ML{parseFunction(e){return new kue(e)}}const iT=new WeakMap,Pa=[],ef=[];class Gue extends ju{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new tT,this.nodeBuilderCache=new Map,this.callHashCache=new ya,this.groupsData=new ya,this.cacheLib={}}updateGroup(e){const t=e.groupNode,i=t.name;if(i===k4.name)return!0;if(i===Xt.name){const s=this.get(e),o=this.nodeFrame.renderId;return s.renderId!==o?(s.renderId=o,!0):!1}if(i===vC.name){const s=this.get(e),o=this.nodeFrame.frameId;return s.frameId!==o?(s.frameId=o,!0):!1}Pa[0]=t,Pa[1]=e;let r=this.groupsData.get(Pa);return r===void 0&&this.groupsData.set(Pa,r={}),Pa.length=0,r.version!==t.version?(r.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let i=t.nodeBuilderState;if(i===void 0){const{nodeBuilderCache:r}=this,s=this.getForRenderCacheKey(e);if(i=r.get(s),i===void 0){const o=this.backend.createNodeBuilder(e.object,this.renderer);o.scene=e.scene,o.material=e.material,o.camera=e.camera,o.context.material=e.material,o.lightsNode=e.lightsNode,o.environmentNode=this.getEnvironmentNode(e.scene),o.fogNode=this.getFogNode(e.scene),o.clippingContext=e.clippingContext,this.renderer.getRenderTarget()&&this.renderer.getRenderTarget().multiview&&o.enableMultiview(),o.build(),i=this._createNodeBuilderState(o),r.set(s,i)}i.usedTimes++,t.nodeBuilderState=i}return i}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let i=t.nodeBuilderState;if(i===void 0){const r=this.backend.createNodeBuilder(e,this.renderer);r.build(),i=this._createNodeBuilderState(r),t.nodeBuilderState=i}return i}_createNodeBuilderState(e){return new aue(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const i=this.get(e);i.environmentNode&&(t=i.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const i=this.get(e);i.backgroundNode&&(t=i.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){Pa[0]=e,Pa[1]=t;const i=this.renderer.info.calls,r=this.callHashCache.get(Pa)||{};if(r.callId!==i){const s=this.getEnvironmentNode(e),o=this.getFogNode(e);t&&ef.push(t.getCacheKey(!0)),s&&ef.push(s.getCacheKey()),o&&ef.push(o.getCacheKey()),ef.push(this.renderer.shadowMap.enabled?1:0),r.callId=i,r.cacheKey=p2(ef),this.callHashCache.set(Pa,r),ef.length=0}return Pa.length=0,r.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),i=e.background;if(i){const r=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==i||r){const s=this.getCacheNode("background",i,()=>{if(i.isCubeTexture===!0||i.mapping===Yc||i.mapping===Zc||i.mapping===Kc){if(e.backgroundBlurriness>0||i.mapping===Kc)return vb(i);{let o;return i.isCubeTexture===!0?o=dA(i):o=In(i),iP(o)}}else{if(i.isTexture===!0)return In(i,Aa.flipY()).setUpdateMatrix(!0);i.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",i)}},r);t.backgroundNode=s,t.background=i,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,i,r=!1){const s=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let o=s.get(t);return(o===void 0||r)&&(o=i(),s.set(t,o)),o}updateFog(e){const t=this.get(e),i=e.fog;if(i){if(t.fog!==i){const r=this.getCacheNode("fog",i,()=>{if(i.isFogExp2){const s=pi("color","color",i).setGroup(Xt),o=pi("density","float",i).setGroup(Xt);return $d(s,Tb(o))}else if(i.isFog){const s=pi("color","color",i).setGroup(Xt),o=pi("near","float",i).setGroup(Xt),a=pi("far","float",i).setGroup(Xt);return $d(s,Sb(o,a))}else console.error("THREE.Renderer: Unsupported fog configuration.",i)});t.fogNode=r,t.fog=i}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),i=e.environment;if(i){if(t.environment!==i){const r=this.getCacheNode("environment",i,()=>{if(i.isCubeTexture===!0)return dA(i);if(i.isTexture===!0)return In(i);console.error("Nodes: Unsupported environment configuration.",i)});t.environmentNode=r,t.environment=i}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,i=null,r=null,s=null){const o=this.nodeFrame;return o.renderer=e,o.scene=t,o.object=i,o.camera=r,o.material=s,o}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return iT.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,i=this.getOutputCacheKey(),r=e.isTextureArray?BP(e,xe(Aa,mp("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):In(e,Aa).renderOutput(t.toneMapping,t.currentColorSpace);return iT.set(e,i),r}updateBefore(e){const t=e.getNodeBuilderState();for(const i of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(i)}updateAfter(e){const t=e.getNodeBuilderState();for(const i of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(i)}updateForCompute(e){const t=this.getNodeFrame(),i=this.getForCompute(e);for(const r of i.updateNodes)t.updateNode(r)}updateForRender(e){const t=this.getNodeFrameForRender(e),i=e.getNodeBuilderState();for(const r of i.updateNodes)t.updateNode(r)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new tT,this.nodeBuilderCache=new Map,this.cacheLib={}}}const Z3=new bl;class Og{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new dn,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,i){const r=e.length;for(let s=0;s<r;s++){Z3.copy(e[s]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const o=t[i+s],a=Z3.normal;o.x=-a.x,o.y=-a.y,o.z=-a.z,o.w=Z3.constant}}updateGlobal(e,t){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let i=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const r=t.clippingPlanes,s=r.length;let o,a;if(this.clipIntersection?(o=this.intersectionPlanes,a=e.intersectionPlanes.length):(o=this.unionPlanes,a=e.unionPlanes.length),o.length!==a+s){o.length=a+s;for(let l=0;l<s;l++)o[a+l]=new $t;i=!0}this.projectPlanes(r,o,a),i&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return t===void 0&&(t=new Og(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class que{constructor(e,t){this.bundleGroup=e,this.camera=t}}const d0=[];class zue{constructor(){this.bundles=new ya}get(e,t){const i=this.bundles;d0[0]=e,d0[1]=t;let r=i.get(d0);return r===void 0&&(r=new que(e,t),i.set(d0,r)),d0.length=0,r}dispose(){this.bundles=new ya}}class EL{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const i=this.getMaterialNodeClass(e.type);if(i!==null){t=new i;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,i){if(i.has(t)){console.warn(`Redefinition of node ${t}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);i.set(t,e)}addClass(e,t,i){if(i.has(t)){console.warn(`Redefinition of node ${t.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);i.set(t,e)}}const Hue=new Pb,p0=[];class $ue extends ya{constructor(){super()}createNode(e=[]){return new Pb().setLights(e)}getNode(e,t){if(e.isQuadMesh)return Hue;p0[0]=e,p0[1]=t;let i=this.get(p0);return i===void 0&&(i=this.createNode(),this.set(p0,i)),p0.length=0,i}}class E0 extends ol{constructor(e=1,t=1,i={}){super(e,t,i),this.isXRRenderTarget=!0,this.hasExternalTextures=!1,this.autoAllocateDepthBuffer=!0}copy(e){return super.copy(e),this.hasExternalTextures=e.hasExternalTextures,this.autoAllocateDepthBuffer=e.autoAllocateDepthBuffer,this}}const rT=new ie,sT=new ie;class Wue extends sl{constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new Br,this._cameraL.viewport=new $t,this._cameraR=new Br,this._cameraR.viewport=new $t,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new bE,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._supportsLayers=!1,this._createXRLayer=Kue.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new at,this._onSessionEvent=Que.bind(this),this._onSessionEnd=Yue.bind(this),this._onInputSourcesChange=Zue.bind(this),this._onAnimationFrame=Jue.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._useLayers=typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,i,r,s,o,a,l=[]){const u=new sp(e,t),A=new E0(s,o,{format:ir,type:ji,depthTexture:new Ys(s,o,l.stencil?yo:bi,void 0,void 0,void 0,void 0,void 0,void 0,l.stencil?bo:xo),stencilBuffer:l.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),p=new ia({color:16777215,side:Xs});p.map=A.texture,p.map.offset.y=1,p.map.repeat.y=-1;const g=new Jn(u,p);g.position.copy(i),g.quaternion.copy(r);const v={type:"quad",width:e,height:t,translation:i,quaternion:r,pixelwidth:s,pixelheight:o,plane:g,material:p,rendercall:a,renderTarget:A};if(this._layers.push(v),this._session!==null){v.plane.material=new ia({color:16777215,side:Xs}),v.plane.material.blending=Cf,v.plane.material.blendEquation=cs,v.plane.material.blendSrc=xl,v.plane.material.blendDst=xl,v.xrlayer=this._createXRLayer(v);const x=this._session.renderState.layers;x.unshift(v.xrlayer),this._session.updateRenderState({layers:x})}else A.isXRRenderTarget=!1;return g}createCylinderLayer(e,t,i,r,s,o,a,l,u=[]){const A=new l2(e,e,e*t/i,64,64,!0,Math.PI-t/2,t),p=new E0(o,a,{format:ir,type:ji,depthTexture:new Ys(o,a,u.stencil?yo:bi,void 0,void 0,void 0,void 0,void 0,void 0,u.stencil?bo:xo),stencilBuffer:u.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),g=new ia({color:16777215,side:_i});g.map=p.texture,g.map.offset.y=1,g.map.repeat.y=-1;const v=new Jn(A,g);v.position.copy(r),v.quaternion.copy(s);const x={type:"cylinder",radius:e,centralAngle:t,aspectratio:i,translation:r,quaternion:s,pixelwidth:o,pixelheight:a,plane:v,material:g,rendercall:l,renderTarget:p};if(this._layers.push(x),this._session!==null){x.plane.material=new ia({color:16777215,side:_i}),x.plane.material.blending=Cf,x.plane.material.blendEquation=cs,x.plane.material.blendSrc=xl,x.plane.material.blendDst=xl,x.xrlayer=this._createXRLayer(x);const S=this._session.renderState.layers;S.unshift(x.xrlayer),this._session.updateRenderState({layers:S})}else p.isXRRenderTarget=!1;return v}renderLayers(){const e=new ie,t=new bA,i=this.isPresenting;this.isPresenting=!1;for(const r of this._layers){if(r.renderTarget.isXRRenderTarget=this._session!==null,r.renderTarget.hasExternalTextures=r.renderTarget.isXRRenderTarget,r.renderTarget.autoAllocateDepthBuffer=!r.renderTarget.isXRRenderTarget,r.renderTarget.isXRRenderTarget&&this._supportsLayers){r.xrlayer.transform=new XRRigidTransform(r.plane.getWorldPosition(e),r.plane.getWorldQuaternion(t));const s=this._glBinding.getSubImage(r.xrlayer,this._xrFrame);this._renderer.backend.setXRRenderTargetTextures(r.renderTarget,s.colorTexture,s.depthStencilTexture)}this._renderer.setRenderTarget(r.renderTarget),r.rendercall()}this.isPresenting=i,this._renderer.setRenderTarget(null)}getSession(){return this._session}async setSession(e){const t=this._renderer,i=t.backend;this._gl=t.getContext();const r=this._gl,s=r.getContextAttributes();if(this._session=e,e!==null){if(i.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await i.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),this._useLayers===!0){let o=null,a=null,l=null;t.depth&&(l=t.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,o=t.stencil?bo:xo,a=t.stencil?yo:bi);const u={colorFormat:r.RGBA8,depthFormat:l,scaleFactor:this._framebufferScaleFactor};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(u.textureType="texture-array",this._useMultiview=!0);const A=new XRWebGLBinding(e,r),p=A.createProjectionLayer(u),g=[p];this._glBinding=A,this._glProjLayer=p,t.setPixelRatio(1),t.setSize(p.textureWidth,p.textureHeight,!1);let v;if(this._useMultiview?(v=new sE(p.textureWidth,p.textureHeight,2),v.type=a,v.format=o):v=new Ys(p.textureWidth,p.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,o),this._xrRenderTarget=new E0(p.textureWidth,p.textureHeight,{format:ir,type:ji,colorSpace:t.outputColorSpace,depthTexture:v,stencilBuffer:t.stencil,samples:s.antialias?4:0,resolveDepthBuffer:p.ignoreDepthValues===!1,resolveStencilBuffer:p.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget.hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._supportsLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._supportsLayers)for(const x of this._layers)x.plane.material=new ia({color:16777215,side:x.type==="cylinder"?_i:Xs}),x.plane.material.blending=Cf,x.plane.material.blendEquation=cs,x.plane.material.blendSrc=xl,x.plane.material.blendDst=xl,x.xrlayer=this._createXRLayer(x),g.unshift(x.xrlayer);e.updateRenderState({layers:g})}else{const o={antialias:t.samples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},a=new XRWebGLLayer(e,r,o);this._glBaseLayer=a,e.updateRenderState({baseLayer:a}),t.setPixelRatio(1),t.setSize(a.framebufferWidth,a.framebufferHeight,!1),this._xrRenderTarget=new E0(a.framebufferWidth,a.framebufferHeight,{format:ir,type:ji,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:a.ignoreDepthValues===!1,resolveStencilBuffer:a.ignoreDepthValues===!1}),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(t===null)return;const i=e.near,r=e.far,s=this._cameraXR,o=this._cameraL,a=this._cameraR;s.near=a.near=o.near=i,s.far=a.far=o.far=r,s.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==s.near||this._currentDepthFar!==s.far)&&(t.updateRenderState({depthNear:s.near,depthFar:s.far}),this._currentDepthNear=s.near,this._currentDepthFar=s.far),o.layers.mask=e.layers.mask|2,a.layers.mask=e.layers.mask|4,s.layers.mask=o.layers.mask|a.layers.mask;const l=e.parent,u=s.cameras;oT(s,l);for(let A=0;A<u.length;A++)oT(u[A],l);u.length===2?jue(s,o,a):s.projectionMatrix.copy(o.projectionMatrix),Xue(e,s,l)}_getController(e){let t=this._controllers[e];return t===void 0&&(t=new h1,this._controllers[e]=t),t}}function jue(n,e,t){rT.setFromMatrixPosition(e.matrixWorld),sT.setFromMatrixPosition(t.matrixWorld);const i=rT.distanceTo(sT),r=e.projectionMatrix.elements,s=t.projectionMatrix.elements,o=r[14]/(r[10]-1),a=r[14]/(r[10]+1),l=(r[9]+1)/r[5],u=(r[9]-1)/r[5],A=(r[8]-1)/r[0],p=(s[8]+1)/s[0],g=o*A,v=o*p,x=i/(-A+p),S=x*-A;if(e.matrixWorld.decompose(n.position,n.quaternion,n.scale),n.translateX(S),n.translateZ(x),n.matrixWorld.compose(n.position,n.quaternion,n.scale),n.matrixWorldInverse.copy(n.matrixWorld).invert(),r[10]===-1)n.projectionMatrix.copy(e.projectionMatrix),n.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const T=o+x,w=a+x,R=g-S,E=v+(i-S),N=l*a/w*T,D=u*a/w*T;n.projectionMatrix.makePerspective(R,E,N,D,T,w),n.projectionMatrixInverse.copy(n.projectionMatrix).invert()}}function oT(n,e){e===null?n.matrixWorld.copy(n.matrix):n.matrixWorld.multiplyMatrices(e.matrixWorld,n.matrix),n.matrixWorldInverse.copy(n.matrixWorld).invert()}function Xue(n,e,t){t===null?n.matrix.copy(e.matrixWorld):(n.matrix.copy(t.matrixWorld),n.matrix.invert(),n.matrix.multiply(e.matrixWorld)),n.matrix.decompose(n.position,n.quaternion,n.scale),n.updateMatrixWorld(!0),n.projectionMatrix.copy(e.projectionMatrix),n.projectionMatrixInverse.copy(e.projectionMatrixInverse),n.isPerspectiveCamera&&(n.fov=th*2*Math.atan(1/n.projectionMatrix.elements[5]),n.zoom=1)}function Que(n){const e=this._controllerInputSources.indexOf(n.inputSource);if(e===-1)return;const t=this._controllers[e];if(t!==void 0){const i=this.getReferenceSpace();t.update(n.inputSource,n.frame,i),t.dispatchEvent({type:n.type,data:n.inputSource})}}function Yue(){const n=this._session,e=this._renderer;n.removeEventListener("select",this._onSessionEvent),n.removeEventListener("selectstart",this._onSessionEvent),n.removeEventListener("selectend",this._onSessionEvent),n.removeEventListener("squeeze",this._onSessionEvent),n.removeEventListener("squeezestart",this._onSessionEvent),n.removeEventListener("squeezeend",this._onSessionEvent),n.removeEventListener("end",this._onSessionEnd),n.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let t=0;t<this._controllers.length;t++){const i=this._controllerInputSources[t];i!==null&&(this._controllerInputSources[t]=null,this._controllers[t].disconnect(i))}if(this._currentDepthNear=null,this._currentDepthFar=null,e.backend.setXRTarget(null),e.setOutputRenderTarget(null),e.setRenderTarget(null),this._session=null,this._xrRenderTarget=null,this._supportsLayers===!0)for(const t of this._layers)t.renderTarget=new E0(t.pixelwidth,t.pixelheight,{format:ir,type:ji,depthTexture:new Ys(t.pixelwidth,t.pixelheight,t.stencilBuffer?yo:bi,void 0,void 0,void 0,void 0,void 0,void 0,t.stencilBuffer?bo:xo),stencilBuffer:t.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),t.renderTarget.isXRRenderTarget=!1,t.plane.material=t.material,t.material.map=t.renderTarget.texture,delete t.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function Zue(n){const e=this._controllers,t=this._controllerInputSources;for(let i=0;i<n.removed.length;i++){const r=n.removed[i],s=t.indexOf(r);s>=0&&(t[s]=null,e[s].disconnect(r))}for(let i=0;i<n.added.length;i++){const r=n.added[i];let s=t.indexOf(r);if(s===-1){for(let a=0;a<e.length;a++)if(a>=t.length){t.push(r),s=a;break}else if(t[a]===null){t[a]=r,s=a;break}if(s===-1)break}const o=e[s];o&&o.connect(r)}}function Kue(n){return n.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(n.translation,n.quaternion),depthFormat:this._gl.DEPTH_COMPONENT,width:n.width/2,height:n.height/2,space:this._referenceSpace,viewPixelWidth:n.pixelwidth,viewPixelHeight:n.pixelheight}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(n.translation,n.quaternion),depthFormat:this._gl.DEPTH_COMPONENT,radius:n.radius,centralAngle:n.centralAngle,aspectRatio:n.aspectRatio,space:this._referenceSpace,viewPixelWidth:n.pixelwidth,viewPixelHeight:n.pixelheight})}function Jue(n,e){if(e===void 0)return;const t=this._cameraXR,i=this._renderer,r=i.backend,s=this._glBaseLayer,o=this.getReferenceSpace(),a=e.getViewerPose(o);if(this._xrFrame=e,a!==null){const l=a.views;this._glBaseLayer!==null&&r.setXRTarget(s.framebuffer);let u=!1;l.length!==t.cameras.length&&(t.cameras.length=0,u=!0);for(let A=0;A<l.length;A++){const p=l[A];let g;if(this._useLayers===!0){const x=this._glBinding.getViewSubImage(this._glProjLayer,p);g=x.viewport,A===0&&r.setXRRenderTargetTextures(this._xrRenderTarget,x.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:x.depthStencilTexture)}else g=s.getViewport(p);let v=this._cameras[A];v===void 0&&(v=new Br,v.layers.enable(A),v.viewport=new $t,this._cameras[A]=v),v.matrix.fromArray(p.transform.matrix),v.matrix.decompose(v.position,v.quaternion,v.scale),v.projectionMatrix.fromArray(p.projectionMatrix),v.projectionMatrixInverse.copy(v.projectionMatrix).invert(),v.viewport.set(g.x,g.y,g.width,g.height),A===0&&(t.matrix.copy(v.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale)),u===!0&&t.cameras.push(v)}i.setOutputRenderTarget(this._xrRenderTarget)}for(let l=0;l<this._controllers.length;l++){const u=this._controllerInputSources[l],A=this._controllers[l];u!==null&&A!==void 0&&A.update(u,e,o)}this._currentAnimationLoop&&this._currentAnimationLoop(n,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}const aT=new r2,$m=new at,K3=new $t,J3=new wA,ev=new Kx,Wm=new en,pu=new $t;class ece{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:i=!1,alpha:r=!0,depth:s=!0,stencil:o=!1,antialias:a=!1,samples:l=0,getFallback:u=null,colorBufferType:A=Mr,multiview:p=!1}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=l||a===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=r,this.logarithmicDepthBuffer=i,this.outputColorSpace=Ht,this.toneMapping=Qs,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=s,this.stencil=o,this.info=new ise,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new EL,this.lighting=new $ue,this._getFallback=u,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new $t(0,0,this._width,this._height),this._scissor=new $t(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new bb(new fr),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const g=this.alpha===!0?0:1;this._clearColor=new yb(0,0,0,g),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=A,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:bx},this.xr=new Wue(this,p),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(v,x,S)=>{await this.compileAsync(v,x);const T=this._renderLists.get(v,x),w=this._renderContexts.get(v,x,this._renderTarget),R=v.overrideMaterial||S.material,E=this._objects.get(S,R,v,x,T.lightsNode,w,w.clippingContext),{fragmentShader:N,vertexShader:D}=E.getNodeBuilderState();return{fragmentShader:N,vertexShader:D}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let i=this.backend;try{await i.init(this)}catch(r){if(this._getFallback!==null)try{this.backend=i=this._getFallback(r),await i.init(this)}catch(s){t(s);return}else{t(r);return}}this._nodes=new Gue(this,i),this._animation=new Xre(this._nodes,this.info),this._attributes=new tse(i),this._background=new sue(this,this._nodes),this._geometries=new nse(this._attributes,this.info),this._textures=new _se(this,i,this.info),this._pipelines=new ase(i,this._nodes),this._bindings=new lse(i,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new Kre(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new hse(this.lighting),this._bundles=new zue,this._renderContexts=new mse,this._animation.start(),this._initialized=!0,e(this)}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,i=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const r=this._nodes.nodeFrame,s=r.renderId,o=this._currentRenderContext,a=this._currentRenderObjectFunction,l=this._compilationPromises,u=e.isScene===!0?e:aT;i===null&&(i=e);const A=this._renderTarget,p=this._renderContexts.get(i,t,A),g=this._activeMipmapLevel,v=[];this._currentRenderContext=p,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=v,r.renderId++,r.update(),p.depth=this.depth,p.stencil=this.stencil,p.clippingContext||(p.clippingContext=new Og),p.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,A);const x=this._renderLists.get(e,t);if(x.begin(),this._projectObject(e,t,0,x,p.clippingContext),i!==e&&i.traverseVisible(function(E){E.isLight&&E.layers.test(t.layers)&&x.pushLight(E)}),x.finish(),A!==null){this._textures.updateRenderTarget(A,g);const E=this._textures.get(A);p.textures=E.textures,p.depthTexture=E.depthTexture}else p.textures=null,p.depthTexture=null;this._background.update(u,x,p);const S=x.opaque,T=x.transparent,w=x.transparentDoublePass,R=x.lightsNode;this.opaque===!0&&S.length>0&&this._renderObjects(S,t,u,R),this.transparent===!0&&T.length>0&&this._renderTransparents(T,w,t,u,R),r.renderId=s,this._currentRenderContext=o,this._currentRenderObjectFunction=a,this._compilationPromises=l,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(v)}async renderAsync(e,t){this._initialized===!1&&await this.init(),this._renderScene(e,t)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){e===!0?(this.overrideNodes.modelViewMatrix=Iy,this.overrideNodes.modelNormalViewMatrix=By):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===Iy&&this.overrideNodes.modelNormalViewMatrix===By}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,i){const{bundleGroup:r,camera:s,renderList:o}=e,a=this._currentRenderContext,l=this._bundles.get(r,s),u=this.backend.get(l);u.renderContexts===void 0&&(u.renderContexts=new Set);const A=r.version!==u.version,p=u.renderContexts.has(a)===!1||A;if(u.renderContexts.add(a),p){this.backend.beginBundle(a),(u.renderObjects===void 0||A)&&(u.renderObjects=[]),this._currentRenderBundle=l;const{transparentDoublePass:g,transparent:v,opaque:x}=o;this.opaque===!0&&x.length>0&&this._renderObjects(x,s,t,i),this.transparent===!0&&v.length>0&&this._renderTransparents(v,g,s,t,i),this._currentRenderBundle=null,this.backend.finishBundle(a,l),u.version=r.version}else{const{renderObjects:g}=u;for(let v=0,x=g.length;v<x;v++){const S=g[v];this._nodes.needsRefresh(S)&&(this._nodes.updateBefore(S),this._nodes.updateForRender(S),this._bindings.updateForRender(S),this._nodes.updateAfter(S))}}this.backend.addBundle(a,l)}render(e,t){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this;if(e!==Qs===!1&&t!==ha===!1)return null;const{width:s,height:o}=this.getDrawingBufferSize($m),{depth:a,stencil:l}=this;let u=this._frameBufferTarget;u===null&&(u=new ol(s,o,{depthBuffer:a,stencilBuffer:l,type:this._colorBufferType,format:ir,colorSpace:ha,generateMipmaps:!1,minFilter:Tr,magFilter:Tr,samples:this.samples}),u.isPostProcessingRenderTarget=!0,this._frameBufferTarget=u);const A=this.getOutputRenderTarget();return u.depthBuffer=a,u.stencilBuffer=l,u.setSize(s,o,A!==null?A.depth:1),u.viewport.copy(this._viewport),u.scissor.copy(this._scissor),u.viewport.multiplyScalar(this._pixelRatio),u.scissor.multiplyScalar(this._pixelRatio),u.scissorTest=this._scissorTest,u.multiview=A!==null?A.multiview:!1,u}_renderScene(e,t,i=!0){if(this._isDeviceLost===!0)return;const r=i?this._getFrameBufferTarget():null,s=this._nodes.nodeFrame,o=s.renderId,a=this._currentRenderContext,l=this._currentRenderObjectFunction,u=e.isScene===!0?e:aT,A=this._renderTarget||this._outputRenderTarget,p=this._activeCubeFace,g=this._activeMipmapLevel;let v;r!==null?(v=r,this.setRenderTarget(v)):v=A;const x=this._renderContexts.get(e,t,v);this._currentRenderContext=x,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,s.renderId=this.info.calls;const S=this.coordinateSystem,T=this.xr;if(t.coordinateSystem!==S&&T.isPresenting===!1&&(t.coordinateSystem=S,t.updateProjectionMatrix(),t.isArrayCamera))for(const Q of t.cameras)Q.coordinateSystem=S,Q.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),T.enabled===!0&&T.isPresenting===!0&&(T.cameraAutoUpdate===!0&&T.updateCamera(t),t=T.getCamera());let w=this._viewport,R=this._scissor,E=this._pixelRatio;v!==null&&(w=v.viewport,R=v.scissor,E=1),this.getDrawingBufferSize($m),K3.set(0,0,$m.width,$m.height);const N=w.minDepth===void 0?0:w.minDepth,D=w.maxDepth===void 0?1:w.maxDepth;x.viewportValue.copy(w).multiplyScalar(E).floor(),x.viewportValue.width>>=g,x.viewportValue.height>>=g,x.viewportValue.minDepth=N,x.viewportValue.maxDepth=D,x.viewport=x.viewportValue.equals(K3)===!1,x.scissorValue.copy(R).multiplyScalar(E).floor(),x.scissor=this._scissorTest&&x.scissorValue.equals(K3)===!1,x.scissorValue.width>>=g,x.scissorValue.height>>=g,x.clippingContext||(x.clippingContext=new Og),x.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,v);const B=t.isArrayCamera?ev:J3;t.isArrayCamera||(Wm.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),B.setFromProjectionMatrix(Wm,S));const I=this._renderLists.get(e,t);if(I.begin(),this._projectObject(e,t,0,I,x.clippingContext),I.finish(),this.sortObjects===!0&&I.sort(this._opaqueSort,this._transparentSort),v!==null){this._textures.updateRenderTarget(v,g);const Q=this._textures.get(v);x.textures=Q.textures,x.depthTexture=Q.depthTexture,x.width=Q.width,x.height=Q.height,x.renderTarget=v,x.depth=v.depthBuffer,x.stencil=v.stencilBuffer}else x.textures=null,x.depthTexture=null,x.width=this.domElement.width,x.height=this.domElement.height,x.depth=this.depth,x.stencil=this.stencil;x.width>>=g,x.height>>=g,x.activeCubeFace=p,x.activeMipmapLevel=g,x.occlusionQueryCount=I.occlusionQueryCount,this._background.update(u,I,x),x.camera=t,this.backend.beginRender(x);const{bundles:O,lightsNode:L,transparentDoublePass:F,transparent:V,opaque:H}=I;return O.length>0&&this._renderBundles(O,u,L),this.opaque===!0&&H.length>0&&this._renderObjects(H,t,u,L),this.transparent===!0&&V.length>0&&this._renderTransparents(V,F,t,u,L),this.backend.finishRender(x),s.renderId=o,this._currentRenderContext=a,this._currentRenderObjectFunction=l,r!==null&&(this.setRenderTarget(A,p,g),this._renderOutput(v)),u.onAfterRender(this,e,t,v),x}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const i=this.autoClear,r=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=i,this.xr.enabled=r}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,i){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=i,this.domElement.width=Math.floor(e*i),this.domElement.height=Math.floor(t*i),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setSize(e,t,i=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),i===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,i,r){const s=this._scissor;e.isVector4?s.copy(e):s.set(e,t,i,r)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,i,r,s=0,o=1){const a=this._viewport;e.isVector4?a.copy(e):a.set(e,t,i,r),a.minDepth=s,a.maxDepth=o}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,i=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,i);const r=this._renderTarget||this._getFrameBufferTarget();let s=null;if(r!==null){this._textures.updateRenderTarget(r);const o=this._textures.get(r);s=this._renderContexts.getForClear(r),s.textures=o.textures,s.depthTexture=o.depthTexture,s.width=o.width,s.height=o.height,s.renderTarget=r,s.depth=r.depthBuffer,s.stencil=r.stencilBuffer,s.clearColorValue=this.backend.getClearColor(),s.activeCubeFace=this.getActiveCubeFace(),s.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,i,s),r!==null&&this._renderTarget===null&&this._renderOutput(r)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,i=!0){this._initialized===!1&&await this.init(),this.clear(e,t,i)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:Qs}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:ha}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()}),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,i=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=i}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const t=this._nodes.nodeFrame,i=t.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,t.renderId=this.info.calls;const r=this.backend,s=this._pipelines,o=this._bindings,a=this._nodes,l=Array.isArray(e)?e:[e];if(l[0]===void 0||l[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");r.beginCompute(e);for(const u of l){if(s.has(u)===!1){const g=()=>{u.removeEventListener("dispose",g),s.delete(u),o.delete(u),a.delete(u)};u.addEventListener("dispose",g);const v=u.onInitFunction;v!==null&&v.call(u,{renderer:this})}a.updateForCompute(u),o.updateForCompute(u);const A=o.getForCompute(u),p=s.getForCompute(u,A);r.compute(e,u,A,p)}r.finishCompute(e),t.renderId=i}async computeAsync(e){this._initialized===!1&&await this.init(),this.compute(e)}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){this._initialized===!1&&await this.init(),this._textures.updateTexture(e)}initTexture(e){this._initialized===!1&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=pu.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=pu.copy(t).floor();else{console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else t=pu.set(0,0,e.image.width,e.image.height);let i=this._currentRenderContext,r;i!==null?r=i.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),r!==null&&(this._textures.updateRenderTarget(r),i=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,i,t)}copyTextureToTexture(e,t,i=null,r=null,s=0,o=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,i,r,s,o)}async readRenderTargetPixelsAsync(e,t,i,r,s,o=0,a=0){return this.backend.copyTextureToBuffer(e.textures[o],t,i,r,s,a)}_projectObject(e,t,i,r,s){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)i=e.renderOrder,e.isClippingGroup&&e.enabled&&(s=s.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){const l=t.isArrayCamera?ev:J3;if(!e.frustumCulled||l.intersectsSprite(e,t)){this.sortObjects===!0&&pu.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Wm);const{geometry:u,material:A}=e;A.visible&&r.push(e,u,A,i,pu.z,null,s)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const l=t.isArrayCamera?ev:J3;if(!e.frustumCulled||l.intersectsObject(e,t)){const{geometry:u,material:A}=e;if(this.sortObjects===!0&&(u.boundingSphere===null&&u.computeBoundingSphere(),pu.copy(u.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(Wm)),Array.isArray(A)){const p=u.groups;for(let g=0,v=p.length;g<v;g++){const x=p[g],S=A[x.materialIndex];S&&S.visible&&r.push(e,u,S,i,pu.z,x,s)}}else A.visible&&r.push(e,u,A,i,pu.z,null,s)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const l=r;r=this._renderLists.get(e,t),r.begin(),l.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}const a=e.children;for(let l=0,u=a.length;l<u;l++)this._projectObject(a[l],t,i,r,s)}_renderBundles(e,t,i){for(const r of e)this._renderBundle(r,t,i)}_renderTransparents(e,t,i,r,s){if(t.length>0){for(const{material:o}of t)o.side=_i;this._renderObjects(t,i,r,s,"backSide");for(const{material:o}of t)o.side=Xs;this._renderObjects(e,i,r,s);for(const{material:o}of t)o.side=_r}else this._renderObjects(e,i,r,s)}_renderObjects(e,t,i,r,s=null){for(let o=0,a=e.length;o<a;o++){const{object:l,geometry:u,material:A,group:p,clippingContext:g}=e[o];this._currentRenderObjectFunction(l,i,t,u,A,p,r,g,s)}}renderObject(e,t,i,r,s,o,a,l=null,u=null){let A,p,g;if(e.onBeforeRender(this,t,i,r,s,o),s.allowOverride===!0&&t.overrideMaterial!==null){const v=t.overrideMaterial;s.positionNode&&s.positionNode.isNode&&(A=v.positionNode,v.positionNode=s.positionNode),v.alphaTest=s.alphaTest,v.alphaMap=s.alphaMap,v.transparent=s.transparent||s.transmission>0,v.isShadowPassMaterial&&(v.side=s.shadowSide===null?s.side:s.shadowSide,s.depthNode&&s.depthNode.isNode&&(g=v.depthNode,v.depthNode=s.depthNode),s.castShadowNode&&s.castShadowNode.isNode&&(p=v.colorNode,v.colorNode=s.castShadowNode),s.castShadowPositionNode&&s.castShadowPositionNode.isNode&&(A=v.positionNode,v.positionNode=s.castShadowPositionNode)),s=v}s.transparent===!0&&s.side===_r&&s.forceSinglePass===!1?(s.side=_i,this._handleObjectFunction(e,s,t,i,a,o,l,"backSide"),s.side=Xs,this._handleObjectFunction(e,s,t,i,a,o,l,u),s.side=_r):this._handleObjectFunction(e,s,t,i,a,o,l,u),A!==void 0&&(t.overrideMaterial.positionNode=A),g!==void 0&&(t.overrideMaterial.depthNode=g),p!==void 0&&(t.overrideMaterial.colorNode=p),e.onAfterRender(this,t,i,r,s,o)}_renderObjectDirect(e,t,i,r,s,o,a,l){const u=this._objects.get(e,t,i,r,s,this._currentRenderContext,a,l);u.drawRange=e.geometry.drawRange,u.group=o;const A=this._nodes.needsRefresh(u);A&&(this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u)),this._pipelines.updateForRender(u),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(u),u.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(u,this.info),A&&this._nodes.updateAfter(u)}_createObjectPipeline(e,t,i,r,s,o,a,l){const u=this._objects.get(e,t,i,r,s,this._currentRenderContext,a,l);u.drawRange=e.geometry.drawRange,u.group=o,this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u),this._pipelines.getForRender(u,this._compilationPromises),this._nodes.updateAfter(u)}get compile(){return this.compileAsync}}class Ob{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function tce(n){return n+(Eu-n%Eu)%Eu}class CL extends Ob{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return tce(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class RL extends CL{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let nce=0;class NL extends RL{constructor(e,t){super("UniformBuffer_"+nce++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class ice extends RL{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){let e=0;for(let t=0,i=this.uniforms.length;t<i;t++){const r=this.uniforms[t],{boundary:s,itemSize:o}=r,a=e%Eu,l=Eu-a;a!==0&&l-s<0?e+=Eu-a:a%s!==0&&(e+=a%s),r.offset=e/this.bytesPerElement,e+=o*this.bytesPerElement}return Math.ceil(e/Eu)*Eu}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(i[s]!==r){const a=this._getBufferForType(o);a[s]=i[s]=r,t=!0}return t}updateVector2(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(i[s+0]!==r.x||i[s+1]!==r.y){const a=this._getBufferForType(o);a[s+0]=i[s+0]=r.x,a[s+1]=i[s+1]=r.y,t=!0}return t}updateVector3(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(i[s+0]!==r.x||i[s+1]!==r.y||i[s+2]!==r.z){const a=this._getBufferForType(o);a[s+0]=i[s+0]=r.x,a[s+1]=i[s+1]=r.y,a[s+2]=i[s+2]=r.z,t=!0}return t}updateVector4(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(i[s+0]!==r.x||i[s+1]!==r.y||i[s+2]!==r.z||i[s+4]!==r.w){const a=this._getBufferForType(o);a[s+0]=i[s+0]=r.x,a[s+1]=i[s+1]=r.y,a[s+2]=i[s+2]=r.z,a[s+3]=i[s+3]=r.w,t=!0}return t}updateColor(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset;if(i[s+0]!==r.r||i[s+1]!==r.g||i[s+2]!==r.b){const o=this.buffer;o[s+0]=i[s+0]=r.r,o[s+1]=i[s+1]=r.g,o[s+2]=i[s+2]=r.b,t=!0}return t}updateMatrix3(e){let t=!1;const i=this.values,r=e.getValue().elements,s=e.offset;if(i[s+0]!==r[0]||i[s+1]!==r[1]||i[s+2]!==r[2]||i[s+4]!==r[3]||i[s+5]!==r[4]||i[s+6]!==r[5]||i[s+8]!==r[6]||i[s+9]!==r[7]||i[s+10]!==r[8]){const o=this.buffer;o[s+0]=i[s+0]=r[0],o[s+1]=i[s+1]=r[1],o[s+2]=i[s+2]=r[2],o[s+4]=i[s+4]=r[3],o[s+5]=i[s+5]=r[4],o[s+6]=i[s+6]=r[5],o[s+8]=i[s+8]=r[6],o[s+9]=i[s+9]=r[7],o[s+10]=i[s+10]=r[8],t=!0}return t}updateMatrix4(e){let t=!1;const i=this.values,r=e.getValue().elements,s=e.offset;return sce(i,r,s)===!1&&(this.buffer.set(r,s),rce(i,r,s),t=!0),t}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function rce(n,e,t){for(let i=0,r=e.length;i<r;i++)n[t+i]=e[i]}function sce(n,e,t){for(let i=0,r=e.length;i<r;i++)if(n[t+i]!==e[i])return!1;return!0}let oce=0;class PL extends ice{constructor(e,t){super(e),this.id=oce++,this.groupNode=t,this.isNodeUniformsGroup=!0}}let ace=0;class lce extends Ob{constructor(e,t){super(e),this.id=ace++,this.texture=t,this.version=t?t.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:t}=this;return e!==this.generation?(this.generation=e,!0):t.isVideoTexture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}}class G2 extends lce{constructor(e,t,i,r=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=i,this.access=r}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class LL extends G2{constructor(e,t,i,r=null){super(e,t,i,r),this.isSampledCubeTexture=!0}}class DL extends G2{constructor(e,t,i,r=null){super(e,t,i,r),this.isSampledTexture3D=!0}}const uce={textureDimensions:"textureSize",equals:"equal"},cce={low:"lowp",medium:"mediump",high:"highp"},lT={swizzleAssign:!0,storageBuffer:!1},uT={perspective:"smooth",linear:"noperspective"},cT={centroid:"centroid","flat first":"flat","flat either":"flat"},hT=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class hce extends SL{constructor(e,t){super(e,t,new Vue),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==go}getMethod(e){return uce[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,i=this.flowShaderNode(e),r=[];for(const o of t.inputs)r.push(this.getType(o.type)+" "+o.name);return`${this.getType(t.type)} ${t.name}( ${r.join(", ")} ) {

	${i.vars}

${i.code}
	return ${i.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const i=t.array,r=t.count*t.itemSize,{itemSize:s}=t,o=t.array.constructor.name.toLowerCase().includes("int");let a=o?vA:ip;s===2?a=o?yA:Ll:s===3?a=o?_G:np:s===4&&(a=o?xA:ir);const l={Float32Array:lr,Uint8Array:ji,Uint16Array:sa,Uint32Array:bi,Int8Array:Uc,Int16Array:Oc,Int32Array:Ir,Uint8ClampedArray:ji},u=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/s))));let A=Math.ceil(r/s/u);u*A*s<r&&A++;const p=u*A*s,g=new i.constructor(p);g.set(i,0),t.array=g;const v=new Sq(t.array,u,A,a,l[t.array.constructor.name]||lr);v.needsUpdate=!0,v.isPBOTexture=!0;const x=new tl(v,null,null);x.setPrecision("high"),t.pboNode=x,t.pbo=x.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:i}=e,r=t.value;if(this.renderer.backend.has(r)){const A=this.renderer.backend.get(r);A.pbo=r.pbo}const s=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.label),o=this.getPropertyName(s);this.increaseUsage(i);const a=i.build(this,"uint"),l=this.getDataFromNode(e);let u=l.propertyName;if(u===void 0){const A=this.getVarFromNode(e);u=this.getPropertyName(A);const p=this.getDataFromNode(t);let g=p.propertySizeName;g===void 0&&(g=u+"Size",this.getVarFromNode(t,g,"uint"),this.addLineFlowCode(`${g} = uint( textureSize( ${o}, 0 ).x )`,e),p.propertySizeName=g);const{itemSize:v}=r,x="."+hh.join("").slice(0,v),S=`ivec2(${a} % ${g}, ${a} / ${g})`,T=this.generateTextureLoad(null,o,S,null,"0");let w="vec4";r.pbo.type===bi?w="uvec4":r.pbo.type===Ir&&(w="ivec4"),this.addLineFlowCode(`${u} = ${w}(${T})${x}`,e),l.propertyName=u}return u}generateTextureLoad(e,t,i,r,s="0"){return r?`texelFetch( ${t}, ivec3( ${i}, ${r} ), ${s} )`:`texelFetch( ${t}, ${i}, ${s} )`}generateTexture(e,t,i,r){return e.isDepthTexture?(r&&(i=`vec4( ${i}, ${r} )`),`texture( ${t}, ${i} ).x`):(r&&(i=`vec3( ${i}, ${r} )`),`texture( ${t}, ${i} )`)}generateTextureLevel(e,t,i,r){return`textureLod( ${t}, ${i}, ${r} )`}generateTextureBias(e,t,i,r){return`texture( ${t}, ${i}, ${r} )`}generateTextureGrad(e,t,i,r){return`textureGrad( ${t}, ${i}, ${r[0]}, ${r[1]} )`}generateTextureCompare(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return s?`texture( ${t}, vec4( ${i}, ${s}, ${r} ) )`:`texture( ${t}, vec3( ${i}, ${r} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}getVars(e){const t=[],i=this.vars[e];if(i!==void 0)for(const r of i)t.push(`${this.getVar(r.type,r.name,r.count)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],i=[],r={};for(const o of t){let a=null,l=!1;if(o.type==="texture"||o.type==="texture3D"){const A=o.node.value;let p="";(A.isDataTexture===!0||A.isData3DTexture===!0)&&(A.type===bi?p="u":A.type===Ir&&(p="i")),o.type==="texture3D"&&A.isTextureArray===!1?a=`${p}sampler3D ${o.name};`:A.compareFunction?A.isDepthArrayTexture===!0?a=`sampler2DArrayShadow ${o.name};`:a=`sampler2DShadow ${o.name};`:A.isDataArrayTexture===!0||A.isCompressedArrayTexture===!0||A.isTextureArray===!0?a=`${p}sampler2DArray ${o.name};`:a=`${p}sampler2D ${o.name};`}else if(o.type==="cubeTexture")a=`samplerCube ${o.name};`;else if(o.type==="buffer"){const A=o.node,p=this.getType(A.bufferType),g=A.bufferCount,v=g>0?g:"";a=`${A.name} {
	${p} ${o.name}[${v}];
};
`}else a=`${this.getVectorType(o.type)} ${this.getPropertyName(o,e)};`,l=!0;const u=o.node.precision;if(u!==null&&(a=cce[u]+" "+a),l){a="	"+a;const A=o.groupNode.name;(r[A]||(r[A]=[])).push(a)}else a="uniform "+a,i.push(a)}let s="";for(const o in r){const a=r[o];s+=this._getGLSLUniformStruct(e+"_"+o,a.join(`
`))+`
`}return s+=i.join(`
`),s}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==Ir){let i=e;e.isInterleavedBufferAttribute&&(i=e.data);const r=i.array;r instanceof Uint32Array||r instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const i=this.getAttributesArray();let r=0;for(const s of i)t+=`layout( location = ${r++} ) in ${s.type} ${s.name};
`}return t}getStructMembers(e){const t=[];for(const i of e.members)t.push(`	${i.type} ${i.name};`);return t.join(`
`)}getStructs(e){const t=[],i=this.structs[e],r=[];for(const s of i)if(s.output)for(const o of s.members)r.push(`layout( location = ${o.index} ) out ${o.type} ${o.name};`);else{let o="struct "+s.name+` {
`;o+=this.getStructMembers(s),o+=`
};
`,t.push(o)}return r.length===0&&r.push("layout( location = 0 ) out vec4 fragColor;"),`
`+r.join(`
`)+`

`+t.join(`
`)}getVaryings(e){let t="";const i=this.varyings;if(e==="vertex"||e==="compute")for(const r of i){e==="compute"&&(r.needsInterpolation=!0);const s=this.getType(r.type);if(r.needsInterpolation)if(r.interpolationType){const o=uT[r.interpolationType]||r.interpolationType,a=cT[r.interpolationSampling]||"";t+=`${o} ${a} out ${s} ${r.name};
`}else{const o=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${o}out ${s} ${r.name};
`}else t+=`${s} ${r.name};
`}else if(e==="fragment"){for(const r of i)if(r.needsInterpolation){const s=this.getType(r.type);if(r.interpolationType){const o=uT[r.interpolationType]||r.interpolationType,a=cT[r.interpolationSampling]||"";t+=`${o} ${a} in ${s} ${r.name};
`}else{const o=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${o}in ${s} ${r.name};
`}}}for(const r of this.builtins[e])t+=`${r};
`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((i,r)=>i*r,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,i=this.shaderStage){const r=this.extensions[i]||(this.extensions[i]=new Map);r.has(e)===!1&&r.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const r=this.renderer.backend.extensions;this.object.isBatchedMesh&&r.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const i=this.extensions[e];if(i!==void 0)for(const{name:r,behavior:s}of i.values())t.push(`#extension ${r} : ${s}`);return t.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=lT[e];if(t===void 0){let i;switch(t=!1,e){case"float32Filterable":i="OES_texture_float_linear";break;case"clipDistance":i="WEBGL_clip_cull_distance";break}if(i!==void 0){const r=this.renderer.backend.extensions;r.has(i)&&(r.get(i),t=!0)}lT[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let i=0;i<e.length;i++){const r=e[i],s=this.getPropertyName(r.attributeNode);s&&(t+=`${r.varyingName} = ${s};
	`)}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${hT}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${hT}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

// structs
${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let i=`// code

`;i+=this.flowCode[t];const r=this.flowNodes[t],s=r[r.length-1];for(const a of r){const l=this.getFlowData(a),u=a.name;u&&(i.length>0&&(i+=`
`),i+=`	// flow -> ${u}
	`),i+=`${l.code}
	`,a===s&&t!=="compute"&&(i+=`// result
	`,t==="vertex"?(i+="gl_Position = ",i+=`${l.result};`):t==="fragment"&&(a.outputNode.isOutputStructNode||(i+="fragColor = ",i+=`${l.result};`)))}const o=e[t];o.extensions=this.getExtensions(t),o.uniforms=this.getUniforms(t),o.attributes=this.getAttributes(t),o.varyings=this.getVaryings(t),o.vars=this.getVars(t),o.structs=this.getStructs(t),o.codes=this.getCodes(t),o.transforms=this.getTransforms(t),o.flow=i}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,i,r=null){const s=super.getUniformFromNode(e,t,i,r),o=this.getDataFromNode(e,i,this.globalCache);let a=o.uniformGPU;if(a===void 0){const l=e.groupNode,u=l.name,A=this.getBindGroupArray(u,i);if(t==="texture")a=new G2(s.name,s.node,l),A.push(a);else if(t==="cubeTexture")a=new LL(s.name,s.node,l),A.push(a);else if(t==="texture3D")a=new DL(s.name,s.node,l),A.push(a);else if(t==="buffer"){e.name=`NodeBuffer_${e.id}`,s.name=`buffer${e.id}`;const p=new NL(e,l);p.name=e.name,A.push(p),a=p}else{const p=this.uniformGroups[i]||(this.uniformGroups[i]={});let g=p[u];g===void 0&&(g=new PL(i+"_"+u,l),p[u]=g,A.push(g)),a=this.getNodeUniform(s,t),g.addUniform(a)}o.uniformGPU=a}return s}}let tv=null,tf=null;class IL{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){fa("WebGPURenderer: Timestamp tracking is disabled.");return}const t=this.timestampQueryPool[e];if(!t){fa(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);return}const i=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=i,i}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return tv=tv||new at,this.renderer.getDrawingBufferSize(tv)}setScissorTest(){}getClearColor(){const e=this.renderer;return tf=tf||new yb,e.getClearColor(tf),tf.getRGB(tf),tf}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:Y7(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${ep} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let fce=0;class Ace{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class dce{constructor(e){this.backend=e}createAttribute(e,t){const i=this.backend,{gl:r}=i,s=e.array,o=e.usage||r.STATIC_DRAW,a=e.isInterleavedBufferAttribute?e.data:e,l=i.get(a);let u=l.bufferGPU;u===void 0&&(u=this._createBuffer(r,t,s,o),l.bufferGPU=u,l.bufferType=t,l.version=a.version);let A;if(s instanceof Float32Array)A=r.FLOAT;else if(s instanceof Uint16Array)e.isFloat16BufferAttribute?A=r.HALF_FLOAT:A=r.UNSIGNED_SHORT;else if(s instanceof Int16Array)A=r.SHORT;else if(s instanceof Uint32Array)A=r.UNSIGNED_INT;else if(s instanceof Int32Array)A=r.INT;else if(s instanceof Int8Array)A=r.BYTE;else if(s instanceof Uint8Array)A=r.UNSIGNED_BYTE;else if(s instanceof Uint8ClampedArray)A=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+s);let p={bufferGPU:u,bufferType:t,type:A,byteLength:s.byteLength,bytesPerElement:s.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:A===r.INT||A===r.UNSIGNED_INT||e.gpuType===Ir,id:fce++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const g=this._createBuffer(r,t,s,o);p=new Ace(p,g)}i.set(e,p)}updateAttribute(e){const t=this.backend,{gl:i}=t,r=e.array,s=e.isInterleavedBufferAttribute?e.data:e,o=t.get(s),a=o.bufferType,l=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(i.bindBuffer(a,o.bufferGPU),l.length===0)i.bufferSubData(a,0,r);else{for(let u=0,A=l.length;u<A;u++){const p=l[u];i.bufferSubData(a,p.start*r.BYTES_PER_ELEMENT,r,p.start,p.count)}s.clearUpdateRanges()}i.bindBuffer(a,null),o.version=s.version}destroyAttribute(e){const t=this.backend,{gl:i}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const r=t.get(e);i.deleteBuffer(r.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:i}=t,r=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:s}=t.get(r),o=e.array,a=o.byteLength;i.bindBuffer(i.COPY_READ_BUFFER,s);const l=i.createBuffer();i.bindBuffer(i.COPY_WRITE_BUFFER,l),i.bufferData(i.COPY_WRITE_BUFFER,a,i.STREAM_READ),i.copyBufferSubData(i.COPY_READ_BUFFER,i.COPY_WRITE_BUFFER,0,0,a),await t.utils._clientWaitAsync();const u=new e.array.constructor(o.length);return i.bindBuffer(i.COPY_WRITE_BUFFER,l),i.getBufferSubData(i.COPY_WRITE_BUFFER,0,u),i.deleteBuffer(l),i.bindBuffer(i.COPY_READ_BUFFER,null),i.bindBuffer(i.COPY_WRITE_BUFFER,null),u.buffer}_createBuffer(e,t,i,r){const s=e.createBuffer();return e.bindBuffer(t,s),e.bufferData(t,i,r),e.bindBuffer(t,null),s}}let nv,m0;class pce{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;nv={[cs]:e.FUNC_ADD,[wx]:e.FUNC_SUBTRACT,[Sx]:e.FUNC_REVERSE_SUBTRACT},m0={[xl]:e.ZERO,[Tx]:e.ONE,[Mx]:e.SRC_COLOR,[id]:e.SRC_ALPHA,[Lx]:e.SRC_ALPHA_SATURATE,[Nx]:e.DST_COLOR,[Cx]:e.DST_ALPHA,[Ex]:e.ONE_MINUS_SRC_COLOR,[rd]:e.ONE_MINUS_SRC_ALPHA,[Px]:e.ONE_MINUS_DST_COLOR,[Rx]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),i=e.getParameter(e.VIEWPORT);this.currentScissor=new $t().fromArray(t),this.currentViewport=new $t().fromArray(i),this._tempVec4=new $t}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==U7?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===Pv?t.cullFace(t.BACK):e===O7?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:i}=this;e!==t&&(i.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,i,r,s,o,a,l){const{gl:u}=this;if(e===vo){this.currentBlendingEnabled===!0&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),e!==Cf){if(e!==this.currentBlending||l!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==cs||this.currentBlendEquationAlpha!==cs)&&(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=cs,this.currentBlendEquationAlpha=cs),l)switch(e){case Fs:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Qc:u.blendFunc(u.ONE,u.ONE);break;case Vf:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case Gf:u.blendFuncSeparate(u.ZERO,u.SRC_COLOR,u.ZERO,u.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case Fs:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Qc:u.blendFunc(u.SRC_ALPHA,u.ONE);break;case Vf:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case Gf:u.blendFunc(u.ZERO,u.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=l}return}s=s||t,o=o||i,a=a||r,(t!==this.currentBlendEquation||s!==this.currentBlendEquationAlpha)&&(u.blendEquationSeparate(nv[t],nv[s]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=s),(i!==this.currentBlendSrc||r!==this.currentBlendDst||o!==this.currentBlendSrcAlpha||a!==this.currentBlendDstAlpha)&&(u.blendFuncSeparate(m0[i],m0[r],m0[o],m0[a]),this.currentBlendSrc=i,this.currentBlendDst=r,this.currentBlendSrcAlpha=o,this.currentBlendDstAlpha=a),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case sd:t.depthFunc(t.NEVER);break;case od:t.depthFunc(t.ALWAYS);break;case ad:t.depthFunc(t.LESS);break;case Ou:t.depthFunc(t.LEQUAL);break;case ld:t.depthFunc(t.EQUAL);break;case ud:t.depthFunc(t.GEQUAL);break;case cd:t.depthFunc(t.GREATER);break;case hd:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,i,r){const s=this._tempVec4.set(e,t,i,r);if(this.currentScissor.equals(s)===!1){const{gl:o}=this;o.scissor(s.x,s.y,s.z,s.w),this.currentScissor.copy(s)}}viewport(e,t,i,r){const s=this._tempVec4.set(e,t,i,r);if(this.currentViewport.equals(s)===!1){const{gl:o}=this;o.viewport(s.x,s.y,s.z,s.w),this.currentViewport.copy(s)}}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,i){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==i)&&(this.gl.stencilFunc(e,t,i),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=i)}setStencilOp(e,t,i){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==i)&&(this.gl.stencilOp(e,t,i),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=i)}setMaterial(e,t,i){const{gl:r}=this;e.side===_r?this.disable(r.CULL_FACE):this.enable(r.CULL_FACE);let s=e.side===_i;t&&(s=!s),this.setFlipSided(s),e.blending===Fs&&e.transparent===!1?this.setBlending(vo):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const o=e.stencilWrite;if(this.setStencilTest(o),o&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(r.SAMPLE_ALPHA_TO_COVERAGE):this.disable(r.SAMPLE_ALPHA_TO_COVERAGE),i>0&&this.currentClippingPlanes!==i)for(let l=0;l<8;l++)l<i?this.enable(12288+l):this.disable(12288+l)}setPolygonOffset(e,t,i){const{gl:r}=this;e?(this.enable(r.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==i)&&(r.polygonOffset(t,i),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=i)):this.disable(r.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,t=null){const i=this.gl;return this.currentVAO!==e||this.currentIndex!==t?(i.bindVertexArray(e),t!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:i,currentBoundFramebuffers:r}=this;return r[e]!==t?(i.bindFramebuffer(e,t),r[e]=t,e===i.DRAW_FRAMEBUFFER&&(r[i.FRAMEBUFFER]=t),e===i.FRAMEBUFFER&&(r[i.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:i}=this;let r=[],s=!1;if(e.textures!==null){r=this.currentDrawbuffers.get(t),r===void 0&&(r=[],this.currentDrawbuffers.set(t,r));const o=e.textures;if(r.length!==o.length||r[0]!==i.COLOR_ATTACHMENT0){for(let a=0,l=o.length;a<l;a++)r[a]=i.COLOR_ATTACHMENT0+a;r.length=o.length,s=!0}}else r[0]!==i.BACK&&(r[0]=i.BACK,s=!0);s&&i.drawBuffers(r)}activeTexture(e){const{gl:t,currentTextureSlot:i,maxTextures:r}=this;e===void 0&&(e=t.TEXTURE0+r-1),i!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,i){const{gl:r,currentTextureSlot:s,currentBoundTextures:o,maxTextures:a}=this;i===void 0&&(s===null?i=r.TEXTURE0+a-1:i=s);let l=o[i];l===void 0&&(l={type:void 0,texture:void 0},o[i]=l),(l.type!==e||l.texture!==t)&&(s!==i&&(r.activeTexture(i),this.currentTextureSlot=i),r.bindTexture(e,t),l.type=e,l.texture=t)}bindBufferBase(e,t,i){const{gl:r}=this,s=`${e}-${t}`;return this.currentBoundBufferBases[s]!==i?(r.bindBufferBase(e,t,i),this.currentBoundBufferBases[s]=i,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:i}=this,r=i[t];r!==void 0&&r.type!==void 0&&(e.bindTexture(r.type,null),r.type=void 0,r.texture=void 0)}}class mce{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=go){const{gl:i,extensions:r}=this;let s;if(e===ji)return i.UNSIGNED_BYTE;if(e===Yg)return i.UNSIGNED_SHORT_4_4_4_4;if(e===Zg)return i.UNSIGNED_SHORT_5_5_5_1;if(e===Kg)return i.UNSIGNED_INT_5_9_9_9_REV;if(e===Uc)return i.BYTE;if(e===Oc)return i.SHORT;if(e===sa)return i.UNSIGNED_SHORT;if(e===Ir)return i.INT;if(e===bi)return i.UNSIGNED_INT;if(e===lr)return i.FLOAT;if(e===Mr)return i.HALF_FLOAT;if(e===Bx)return i.ALPHA;if(e===np)return i.RGB;if(e===ir)return i.RGBA;if(e===xo)return i.DEPTH_COMPONENT;if(e===bo)return i.DEPTH_STENCIL;if(e===ip)return i.RED;if(e===vA)return i.RED_INTEGER;if(e===Ll)return i.RG;if(e===yA)return i.RG_INTEGER;if(e===xA)return i.RGBA_INTEGER;if(e===kc||e===Nu||e===Pu||e===Lu)if(t===Ht)if(s=r.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(e===kc)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===Nu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===Pu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===Lu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=r.get("WEBGL_compressed_texture_s3tc"),s!==null){if(e===kc)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Nu)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Pu)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Lu)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===fd||e===Ad||e===dd||e===pd)if(s=r.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(e===fd)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Ad)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===dd)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===pd)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===md||e===qf||e===zf)if(s=r.get("WEBGL_compressed_texture_etc"),s!==null){if(e===md||e===qf)return t===Ht?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(e===zf)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===Hf||e===$f||e===Wf||e===jf||e===Xf||e===Qf||e===Yf||e===Zf||e===Kf||e===Jf||e===eA||e===tA||e===nA||e===iA)if(s=r.get("WEBGL_compressed_texture_astc"),s!==null){if(e===Hf)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===$f)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===Wf)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===jf)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===Xf)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===Qf)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===Yf)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===Zf)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===Kf)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===Jf)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===eA)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===tA)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===nA)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===iA)return t===Ht?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===Vc)if(s=r.get("EXT_texture_compression_bptc"),s!==null){if(e===Vc)return t===Ht?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===Fx||e===gd||e===_d||e===vd)if(s=r.get("EXT_texture_compression_rgtc"),s!==null){if(e===Vc)return s.COMPRESSED_RED_RGTC1_EXT;if(e===gd)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===_d)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===vd)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===yo?i.UNSIGNED_INT_24_8:i[e]!==void 0?i[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((i,r)=>{function s(){const o=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(o===e.WAIT_FAILED){e.deleteSync(t),r();return}if(o===e.TIMEOUT_EXPIRED){requestAnimationFrame(s);return}e.deleteSync(t),i()}s()})}}let fT=!1,jm,iv,AT;class gce{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},fT===!1&&(this._init(),fT=!0)}_init(){const e=this.gl;jm={[Jc]:e.REPEAT,[qa]:e.CLAMP_TO_EDGE,[eh]:e.MIRRORED_REPEAT},iv={[Mi]:e.NEAREST,[Ix]:e.NEAREST_MIPMAP_NEAREST,[Pl]:e.NEAREST_MIPMAP_LINEAR,[Tr]:e.LINEAR,[Rf]:e.LINEAR_MIPMAP_NEAREST,[zs]:e.LINEAR_MIPMAP_LINEAR},AT={[Ux]:e.NEVER,[qx]:e.ALWAYS,[Jg]:e.LESS,[e2]:e.LEQUAL,[Ox]:e.EQUAL,[Gx]:e.GEQUAL,[kx]:e.GREATER,[Vx]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let i;return e.isCubeTexture===!0?i=t.TEXTURE_CUBE_MAP:e.isDepthArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0||e.isTextureArray===!0?i=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?i=t.TEXTURE_3D:i=t.TEXTURE_2D,i}getInternalFormat(e,t,i,r,s=!1){const{gl:o,extensions:a}=this;if(e!==null){if(o[e]!==void 0)return o[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let l=t;return t===o.RED&&(i===o.FLOAT&&(l=o.R32F),i===o.HALF_FLOAT&&(l=o.R16F),i===o.UNSIGNED_BYTE&&(l=o.R8),i===o.UNSIGNED_SHORT&&(l=o.R16),i===o.UNSIGNED_INT&&(l=o.R32UI),i===o.BYTE&&(l=o.R8I),i===o.SHORT&&(l=o.R16I),i===o.INT&&(l=o.R32I)),t===o.RED_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.R8UI),i===o.UNSIGNED_SHORT&&(l=o.R16UI),i===o.UNSIGNED_INT&&(l=o.R32UI),i===o.BYTE&&(l=o.R8I),i===o.SHORT&&(l=o.R16I),i===o.INT&&(l=o.R32I)),t===o.RG&&(i===o.FLOAT&&(l=o.RG32F),i===o.HALF_FLOAT&&(l=o.RG16F),i===o.UNSIGNED_BYTE&&(l=o.RG8),i===o.UNSIGNED_SHORT&&(l=o.RG16),i===o.UNSIGNED_INT&&(l=o.RG32UI),i===o.BYTE&&(l=o.RG8I),i===o.SHORT&&(l=o.RG16I),i===o.INT&&(l=o.RG32I)),t===o.RG_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.RG8UI),i===o.UNSIGNED_SHORT&&(l=o.RG16UI),i===o.UNSIGNED_INT&&(l=o.RG32UI),i===o.BYTE&&(l=o.RG8I),i===o.SHORT&&(l=o.RG16I),i===o.INT&&(l=o.RG32I)),t===o.RGB&&(i===o.FLOAT&&(l=o.RGB32F),i===o.HALF_FLOAT&&(l=o.RGB16F),i===o.UNSIGNED_BYTE&&(l=o.RGB8),i===o.UNSIGNED_SHORT&&(l=o.RGB16),i===o.UNSIGNED_INT&&(l=o.RGB32UI),i===o.BYTE&&(l=o.RGB8I),i===o.SHORT&&(l=o.RGB16I),i===o.INT&&(l=o.RGB32I),i===o.UNSIGNED_BYTE&&(l=r===Ht&&s===!1?o.SRGB8:o.RGB8),i===o.UNSIGNED_SHORT_5_6_5&&(l=o.RGB565),i===o.UNSIGNED_SHORT_5_5_5_1&&(l=o.RGB5_A1),i===o.UNSIGNED_SHORT_4_4_4_4&&(l=o.RGB4),i===o.UNSIGNED_INT_5_9_9_9_REV&&(l=o.RGB9_E5)),t===o.RGB_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.RGB8UI),i===o.UNSIGNED_SHORT&&(l=o.RGB16UI),i===o.UNSIGNED_INT&&(l=o.RGB32UI),i===o.BYTE&&(l=o.RGB8I),i===o.SHORT&&(l=o.RGB16I),i===o.INT&&(l=o.RGB32I)),t===o.RGBA&&(i===o.FLOAT&&(l=o.RGBA32F),i===o.HALF_FLOAT&&(l=o.RGBA16F),i===o.UNSIGNED_BYTE&&(l=o.RGBA8),i===o.UNSIGNED_SHORT&&(l=o.RGBA16),i===o.UNSIGNED_INT&&(l=o.RGBA32UI),i===o.BYTE&&(l=o.RGBA8I),i===o.SHORT&&(l=o.RGBA16I),i===o.INT&&(l=o.RGBA32I),i===o.UNSIGNED_BYTE&&(l=r===Ht&&s===!1?o.SRGB8_ALPHA8:o.RGBA8),i===o.UNSIGNED_SHORT_4_4_4_4&&(l=o.RGBA4),i===o.UNSIGNED_SHORT_5_5_5_1&&(l=o.RGB5_A1)),t===o.RGBA_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.RGBA8UI),i===o.UNSIGNED_SHORT&&(l=o.RGBA16UI),i===o.UNSIGNED_INT&&(l=o.RGBA32UI),i===o.BYTE&&(l=o.RGBA8I),i===o.SHORT&&(l=o.RGBA16I),i===o.INT&&(l=o.RGBA32I)),t===o.DEPTH_COMPONENT&&(i===o.UNSIGNED_SHORT&&(l=o.DEPTH_COMPONENT16),i===o.UNSIGNED_INT&&(l=o.DEPTH_COMPONENT24),i===o.FLOAT&&(l=o.DEPTH_COMPONENT32F)),t===o.DEPTH_STENCIL&&i===o.UNSIGNED_INT_24_8&&(l=o.DEPTH24_STENCIL8),(l===o.R16F||l===o.R32F||l===o.RG16F||l===o.RG32F||l===o.RGBA16F||l===o.RGBA32F)&&a.get("EXT_color_buffer_float"),l}setTextureParameters(e,t){const{gl:i,extensions:r,backend:s}=this;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,t.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,t.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE),i.texParameteri(e,i.TEXTURE_WRAP_S,jm[t.wrapS]),i.texParameteri(e,i.TEXTURE_WRAP_T,jm[t.wrapT]),(e===i.TEXTURE_3D||e===i.TEXTURE_2D_ARRAY)&&t.isDepthArrayTexture!==!0&&t.isTextureArray===!1&&i.texParameteri(e,i.TEXTURE_WRAP_R,jm[t.wrapR]),i.texParameteri(e,i.TEXTURE_MAG_FILTER,iv[t.magFilter]);const o=t.mipmaps!==void 0&&t.mipmaps.length>0,a=t.minFilter===Tr&&o?zs:t.minFilter;if(i.texParameteri(e,i.TEXTURE_MIN_FILTER,iv[a]),t.compareFunction&&(i.texParameteri(e,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(e,i.TEXTURE_COMPARE_FUNC,AT[t.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===Mi||t.minFilter!==Pl&&t.minFilter!==zs||t.type===lr&&r.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const l=r.get("EXT_texture_filter_anisotropic");i.texParameterf(e,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,s.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:i,defaultTextures:r}=this,s=this.getGLTextureType(e);let o=r[s];o===void 0&&(o=t.createTexture(),i.state.bindTexture(s,o),t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST),r[s]=o),i.set(e,{textureGPU:o,glTextureType:s,isDefault:!0})}createTexture(e,t){const{gl:i,backend:r}=this,{levels:s,width:o,height:a,depth:l}=t,u=r.utils.convert(e.format,e.colorSpace),A=r.utils.convert(e.type),p=this.getInternalFormat(e.internalFormat,u,A,e.colorSpace,e.isVideoTexture),g=i.createTexture(),v=this.getGLTextureType(e);r.state.bindTexture(v,g),this.setTextureParameters(v,e),e.isDepthArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture||e.isTextureArray?i.texStorage3D(i.TEXTURE_2D_ARRAY,s,p,o,a,l):e.isData3DTexture?i.texStorage3D(i.TEXTURE_3D,s,p,o,a,l):e.isVideoTexture||i.texStorage2D(v,s,p,o,a),r.set(e,{textureGPU:g,glTextureType:v,glFormat:u,glType:A,glInternalFormat:p})}copyBufferToTexture(e,t){const{gl:i,backend:r}=this,{textureGPU:s,glTextureType:o,glFormat:a,glType:l}=r.get(t),{width:u,height:A}=t.source.data;i.bindBuffer(i.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(o,s),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.texSubImage2D(o,0,0,0,u,A,a,l,0),i.bindBuffer(i.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}updateTexture(e,t){const{gl:i}=this,{width:r,height:s}=t,{textureGPU:o,glTextureType:a,glFormat:l,glType:u,glInternalFormat:A}=this.backend.get(e);if(e.isRenderTargetTexture||o===void 0)return;const p=g=>g.isDataTexture?g.image.data:typeof HTMLImageElement<"u"&&g instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&g instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&g instanceof ImageBitmap||g instanceof OffscreenCanvas?g:g.data;if(this.backend.state.bindTexture(a,o),this.setTextureParameters(a,e),e.isCompressedTexture){const g=e.mipmaps,v=t.image;for(let x=0;x<g.length;x++){const S=g[x];e.isCompressedArrayTexture?e.format!==i.RGBA?l!==null?i.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,x,0,0,0,S.width,S.height,v.depth,l,S.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texSubImage3D(i.TEXTURE_2D_ARRAY,x,0,0,0,S.width,S.height,v.depth,l,u,S.data):l!==null?i.compressedTexSubImage2D(i.TEXTURE_2D,x,0,0,S.width,S.height,l,S.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const g=t.images;for(let v=0;v<6;v++){const x=p(g[v]);i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,0,0,r,s,l,u,x)}}else if(e.isDataArrayTexture||e.isDepthArrayTexture){const g=t.image;i.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,g.width,g.height,g.depth,l,u,g.data)}else if(e.isData3DTexture){const g=t.image;i.texSubImage3D(i.TEXTURE_3D,0,0,0,0,g.width,g.height,g.depth,l,u,g.data)}else if(e.isVideoTexture)e.update(),i.texImage2D(a,0,A,l,u,t.image);else{const g=p(t.image);i.texSubImage2D(a,0,0,0,r,s,l,u,g)}}generateMipmaps(e){const{gl:t,backend:i}=this,{textureGPU:r,glTextureType:s}=i.get(e);i.state.bindTexture(s,r),t.generateMipmap(s)}deallocateRenderBuffers(e){const{gl:t,backend:i}=this;if(e){const r=i.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(const s in r.framebuffers)t.deleteFramebuffer(r.framebuffers[s]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(let s=0;s<r.msaaRenderbuffers.length;s++)t.deleteRenderbuffer(r.msaaRenderbuffers[s]);delete r.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:i}=this,{textureGPU:r,renderTarget:s}=i.get(e);this.deallocateRenderBuffers(s),t.deleteTexture(r),i.delete(e)}copyTextureToTexture(e,t,i=null,r=null,s=0,o=0){const{gl:a,backend:l}=this,{state:u}=this.backend,{textureGPU:A,glTextureType:p,glType:g,glFormat:v}=l.get(t);u.bindTexture(p,A);let x,S,T,w,R,E,N,D,B;const I=e.isCompressedTexture?e.mipmaps[o]:e.image;if(i!==null)x=i.max.x-i.min.x,S=i.max.y-i.min.y,T=i.isBox3?i.max.z-i.min.z:1,w=i.min.x,R=i.min.y,E=i.isBox3?i.min.z:0;else{const te=Math.pow(2,-s);x=Math.floor(I.width*te),S=Math.floor(I.height*te),e.isDataArrayTexture||e.isDepthArrayTexture?T=I.depth:e.isData3DTexture?T=Math.floor(I.depth*te):T=1,w=0,R=0,E=0}r!==null?(N=r.x,D=r.y,B=r.z):(N=0,D=0,B=0),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,t.unpackAlignment);const O=a.getParameter(a.UNPACK_ROW_LENGTH),L=a.getParameter(a.UNPACK_IMAGE_HEIGHT),F=a.getParameter(a.UNPACK_SKIP_PIXELS),V=a.getParameter(a.UNPACK_SKIP_ROWS),H=a.getParameter(a.UNPACK_SKIP_IMAGES);a.pixelStorei(a.UNPACK_ROW_LENGTH,I.width),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,I.height),a.pixelStorei(a.UNPACK_SKIP_PIXELS,w),a.pixelStorei(a.UNPACK_SKIP_ROWS,R),a.pixelStorei(a.UNPACK_SKIP_IMAGES,E);const Q=t.isDataArrayTexture||t.isData3DTexture||t.isDepthArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const te=l.get(e),K=l.get(t),W=l.get(te.renderTarget),Z=l.get(K.renderTarget),J=W.framebuffers[te.cacheKey],fe=Z.framebuffers[K.cacheKey];u.bindFramebuffer(a.READ_FRAMEBUFFER,J),u.bindFramebuffer(a.DRAW_FRAMEBUFFER,fe);let ge=a.COLOR_BUFFER_BIT;e.isDepthTexture&&(ge=a.DEPTH_BUFFER_BIT),a.blitFramebuffer(w,R,x,S,N,D,x,S,ge,a.NEAREST),u.bindFramebuffer(a.READ_FRAMEBUFFER,null),u.bindFramebuffer(a.DRAW_FRAMEBUFFER,null)}else Q?e.isDataTexture||e.isData3DTexture?a.texSubImage3D(p,o,N,D,B,x,S,T,v,g,I.data):t.isCompressedArrayTexture?a.compressedTexSubImage3D(p,o,N,D,B,x,S,T,v,I.data):a.texSubImage3D(p,o,N,D,B,x,S,T,v,g,I):e.isDataTexture?a.texSubImage2D(p,o,N,D,x,S,v,g,I.data):e.isCompressedTexture?a.compressedTexSubImage2D(p,o,N,D,I.width,I.height,v,I.data):a.texSubImage2D(p,o,N,D,x,S,v,g,I);a.pixelStorei(a.UNPACK_ROW_LENGTH,O),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,L),a.pixelStorei(a.UNPACK_SKIP_PIXELS,F),a.pixelStorei(a.UNPACK_SKIP_ROWS,V),a.pixelStorei(a.UNPACK_SKIP_IMAGES,H),o===0&&t.generateMipmaps&&a.generateMipmap(p),u.unbindTexture()}copyFramebufferToTexture(e,t,i){const{gl:r}=this,{state:s}=this.backend,{textureGPU:o}=this.backend.get(e),{x:a,y:l,z:u,w:A}=i,p=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,g=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(p){const v=a!==0||l!==0;let x,S;if(e.isDepthTexture===!0?(x=r.DEPTH_BUFFER_BIT,S=r.DEPTH_ATTACHMENT,t.stencil&&(x|=r.STENCIL_BUFFER_BIT)):(x=r.COLOR_BUFFER_BIT,S=r.COLOR_ATTACHMENT0),v){const T=this.backend.get(t.renderTarget),w=T.framebuffers[t.getCacheKey()],R=T.msaaFrameBuffer;s.bindFramebuffer(r.DRAW_FRAMEBUFFER,w),s.bindFramebuffer(r.READ_FRAMEBUFFER,R);const E=g-l-A;r.blitFramebuffer(a,E,a+u,E+A,a,E,a+u,E+A,x,r.NEAREST),s.bindFramebuffer(r.READ_FRAMEBUFFER,w),s.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,a,E,u,A),s.unbindTexture()}else{const T=r.createFramebuffer();s.bindFramebuffer(r.DRAW_FRAMEBUFFER,T),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,S,r.TEXTURE_2D,o,0),r.blitFramebuffer(0,0,u,A,0,0,u,A,x,r.NEAREST),r.deleteFramebuffer(T)}}else s.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,a,g-A-l,u,A),s.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,i,r=!1){const{gl:s}=this,o=t.renderTarget,{depthTexture:a,depthBuffer:l,stencilBuffer:u,width:A,height:p}=o;if(s.bindRenderbuffer(s.RENDERBUFFER,e),l&&!u){let g=s.DEPTH_COMPONENT24;r===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(s.RENDERBUFFER,o.samples,g,A,p):i>0?(a&&a.isDepthTexture&&a.type===s.FLOAT&&(g=s.DEPTH_COMPONENT32F),s.renderbufferStorageMultisample(s.RENDERBUFFER,i,g,A,p)):s.renderbufferStorage(s.RENDERBUFFER,g,A,p),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e)}else l&&u&&(i>0?s.renderbufferStorageMultisample(s.RENDERBUFFER,i,s.DEPTH24_STENCIL8,A,p):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,A,p),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e))}async copyTextureToBuffer(e,t,i,r,s,o){const{backend:a,gl:l}=this,{textureGPU:u,glFormat:A,glType:p}=this.backend.get(e),g=l.createFramebuffer();l.bindFramebuffer(l.READ_FRAMEBUFFER,g);const v=e.isCubeTexture?l.TEXTURE_CUBE_MAP_POSITIVE_X+o:l.TEXTURE_2D;l.framebufferTexture2D(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,v,u,0);const x=this._getTypedArrayType(p),S=this._getBytesPerTexel(p,A),w=r*s*S,R=l.createBuffer();l.bindBuffer(l.PIXEL_PACK_BUFFER,R),l.bufferData(l.PIXEL_PACK_BUFFER,w,l.STREAM_READ),l.readPixels(t,i,r,s,A,p,0),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),await a.utils._clientWaitAsync();const E=new x(w/x.BYTES_PER_ELEMENT);return l.bindBuffer(l.PIXEL_PACK_BUFFER,R),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,E),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),l.deleteFramebuffer(g),E}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:i}=this;let r=0;if(e===i.UNSIGNED_BYTE&&(r=1),(e===i.UNSIGNED_SHORT_4_4_4_4||e===i.UNSIGNED_SHORT_5_5_5_1||e===i.UNSIGNED_SHORT_5_6_5||e===i.UNSIGNED_SHORT||e===i.HALF_FLOAT)&&(r=2),(e===i.UNSIGNED_INT||e===i.FLOAT)&&(r=4),t===i.RGBA)return r*4;if(t===i.RGB)return r*3;if(t===i.ALPHA)return r}}class _ce{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class vce{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const i=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const dT={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class yce{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:i,mode:r,object:s,type:o,info:a,index:l}=this;l!==0?i.drawElements(r,t,o,e):i.drawArrays(r,e,t),a.update(s,t,1)}renderInstances(e,t,i){const{gl:r,mode:s,type:o,index:a,object:l,info:u}=this;i!==0&&(a!==0?r.drawElementsInstanced(s,t,o,e,i):r.drawArraysInstanced(s,e,t,i),u.update(l,t,i))}renderMultiDraw(e,t,i){const{extensions:r,mode:s,object:o,info:a}=this;if(i===0)return;const l=r.get("WEBGL_multi_draw");if(l===null)for(let u=0;u<i;u++)this.render(e[u],t[u]);else{this.index!==0?l.multiDrawElementsWEBGL(s,t,0,this.type,e,0,i):l.multiDrawArraysWEBGL(s,e,0,t,0,i);let u=0;for(let A=0;A<i;A++)u+=t[A];a.update(o,u,1)}}renderMultiDrawInstances(e,t,i,r){const{extensions:s,mode:o,object:a,info:l}=this;if(i===0)return;const u=s.get("WEBGL_multi_draw");if(u===null)for(let A=0;A<i;A++)this.renderInstances(e[A],t[A],r[A]);else{this.index!==0?u.multiDrawElementsInstancedWEBGL(o,t,0,this.type,e,0,r,0,i):u.multiDrawArraysInstancedWEBGL(o,e,0,t,0,r,0,i);let A=0;for(let p=0;p<i;p++)A+=t[p]*r[p];l.update(a,A,1)}}}class BL{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class xce extends BL{constructor(e,t,i=2048){if(super(i),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let r=0;r<this.maxQueries;r++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return fa(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e.id,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t==null||this.activeQuery!==null)return;const i=this.queries[t];if(i)try{this.queryStates.get(t)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,i),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(r){console.error("Error in beginQuery:",r),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t!=null&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(i){console.error("Error in endQuery:",i),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[r,s]of this.queryStates)if(s==="ended"){const o=this.queries[r];e.push(this.resolveQuery(o))}if(e.length===0)return this.lastValue;const i=(await Promise.all(e)).reduce((r,s)=>r+s,0);return this.lastValue=i,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,i}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed){t(this.lastValue);return}let i,r=!1;const s=()=>{i&&(clearTimeout(i),i=null)},o=l=>{r||(r=!0,s(),t(l))},a=()=>{if(this.isDisposed){o(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){o(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){i=setTimeout(a,1);return}const A=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(A)/1e6)}catch(l){console.error("Error checking query:",l),t(this.lastValue)}};a()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class pT extends IL{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,i={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},r=t.context!==void 0?t.context:e.domElement.getContext("webgl2",i);function s(o){o.preventDefault();const a={api:"WebGL",message:o.statusMessage||"Unknown reason",reason:null,originalEvent:o};e.onDeviceLost(a)}this._onContextLost=s,e.domElement.addEventListener("webglcontextlost",s,!1),this.gl=r,this.extensions=new _ce(this),this.capabilities=new vce(this),this.attributeUtils=new dce(this),this.textureUtils=new gce(this),this.bufferRenderer=new yce(this),this.state=new pce(this),this.utils=new mce(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return Is}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,i=null){const r=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:r.RGBA8}),i!==null){const s=e.stencilBuffer?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:i,glInternalFormat:s}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer===!0&&e.multiview===!1&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e.autoAllocateDepthBuffer=!1}}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t]||(this.timestampQueryPool[t]=new xce(this.gl,t,2048));const i=this.timestampQueryPool[t];i.allocateQueriesForContext(e)!==null&&i.beginQuery(e)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t].endQuery(e)}getContext(){return this.gl}beginRender(e){const{state:t,gl:i}=this,r=this.get(e);if(e.viewport?this.updateViewport(e):t.viewport(0,0,i.drawingBufferWidth,i.drawingBufferHeight),e.scissor){const{x:o,y:a,width:l,height:u}=e.scissorValue;t.scissor(o,e.height-u-a,l,u)}this.initTimestampQuery(e),r.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const s=e.occlusionQueryCount;s>0&&(r.currentOcclusionQueries=r.occlusionQueries,r.currentOcclusionQueryObjects=r.occlusionQueryObjects,r.lastOcclusionObject=null,r.occlusionQueries=new Array(s),r.occlusionQueryObjects=new Array(s),r.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:i}=this,r=this.get(e),s=r.previousContext;i.resetVertexState();const o=e.occlusionQueryCount;o>0&&(o>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const a=e.textures;if(a!==null)for(let l=0;l<a.length;l++){const u=a[l];u.generateMipmaps&&this.generateMipmaps(u)}if(this._currentContext=s,e.textures!==null&&e.renderTarget){const l=this.get(e.renderTarget),{samples:u}=e.renderTarget;if(u>0&&this._useMultisampledExtension(e.renderTarget)===!1){const A=l.framebuffers[e.getCacheKey()],p=t.COLOR_BUFFER_BIT,g=l.msaaFrameBuffer,v=e.textures;i.bindFramebuffer(t.READ_FRAMEBUFFER,g),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,A);for(let x=0;x<v.length;x++)if(e.scissor){const{x:S,y:T,width:w,height:R}=e.scissorValue,E=e.height-R-T;t.blitFramebuffer(S,E,S+w,E+R,S,E,S+w,E+R,p,t.NEAREST),this._supportsInvalidateFramebuffer===!0&&t.invalidateSubFramebuffer(t.READ_FRAMEBUFFER,l.invalidationArray,S,E,w,R)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,p,t.NEAREST),this._supportsInvalidateFramebuffer===!0&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,l.invalidationArray)}}s!==null&&(this._setFramebuffer(s),s.viewport?this.updateViewport(s):i.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)),this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:i,currentOcclusionQueryObjects:r}=t;if(i&&r){const s=new WeakSet,{gl:o}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const a=()=>{let l=0;for(let u=0;u<i.length;u++){const A=i[u];A!==null&&o.getQueryParameter(A,o.QUERY_RESULT_AVAILABLE)&&(o.getQueryParameter(A,o.QUERY_RESULT)===0&&s.add(r[u]),i[u]=null,o.deleteQuery(A),l++)}l<i.length?requestAnimationFrame(a):t.occluded=s};a()}}isOccluded(e,t){const i=this.get(e);return i.occluded&&i.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:i,y:r,width:s,height:o}=e.viewportValue;t.viewport(i,e.height-o-r,s,o)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,i,r=null,s=!0){const{gl:o,renderer:a}=this;r===null&&(r={textures:null,clearColorValue:this.getClearColor()});let l=0;if(e&&(l|=o.COLOR_BUFFER_BIT),t&&(l|=o.DEPTH_BUFFER_BIT),i&&(l|=o.STENCIL_BUFFER_BIT),l!==0){let u;r.clearColorValue?u=r.clearColorValue:u=this.getClearColor();const A=a.getClearDepth(),p=a.getClearStencil();if(t&&this.state.setDepthMask(!0),r.textures===null)o.clearColor(u.r,u.g,u.b,u.a),o.clear(l);else{if(s&&this._setFramebuffer(r),e)for(let g=0;g<r.textures.length;g++)g===0?o.clearBufferfv(o.COLOR,g,[u.r,u.g,u.b,u.a]):o.clearBufferfv(o.COLOR,g,[0,0,0,1]);t&&i?o.clearBufferfi(o.DEPTH_STENCIL,0,A,p):t?o.clearBufferfv(o.DEPTH,0,[A]):i&&o.clearBufferiv(o.STENCIL,0,[p])}}}beginCompute(e){const{state:t,gl:i}=this;t.bindFramebuffer(i.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,t,i,r){const{state:s,gl:o}=this;this.discard===!1&&(o.enable(o.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:a,transformBuffers:l,attributes:u}=this.get(r),A=this._getVaoKey(u),p=this.vaoCache[A];p===void 0?this._createVao(u):s.setVertexState(p),s.useProgram(a),this._bindUniforms(i);const g=this._getTransformFeedback(l);o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,g),o.beginTransformFeedback(o.POINTS),u[0].isStorageInstancedBufferAttribute?o.drawArraysInstanced(o.POINTS,0,1,t.count):o.drawArrays(o.POINTS,0,t.count),o.endTransformFeedback(),o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,null);for(let v=0;v<l.length;v++){const x=l[v];x.pbo&&this.textureUtils.copyBufferToTexture(x.transformBuffer,x.pbo),x.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isDepthArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:i,material:r,context:s,hardwareClippingPlanes:o}=e,{programGPU:a}=this.get(i),{gl:l,state:u}=this,A=this.get(s),p=e.getDrawParameters();if(p===null)return;this._bindUniforms(e.getBindings());const g=t.isMesh&&t.matrixWorld.determinant()<0;u.setMaterial(r,g,o),u.useProgram(a);const v=this.get(e);let x=v.staticVao;if(x===void 0||v.geometryId!==e.geometry.id){const I=this._getVaoKey(e.getAttributes());if(x=this.vaoCache[I],x===void 0){let O;({vaoGPU:x,staticVao:O}=this._createVao(e.getAttributes())),O&&(v.staticVao=x,v.geometryId=e.geometry.id)}}const S=e.getIndex(),T=S!==null?this.get(S).bufferGPU:null;u.setVertexState(x,T);const w=A.lastOcclusionObject;if(w!==t&&w!==void 0){if(w!==null&&w.occlusionTest===!0&&(l.endQuery(l.ANY_SAMPLES_PASSED),A.occlusionQueryIndex++),t.occlusionTest===!0){const I=l.createQuery();l.beginQuery(l.ANY_SAMPLES_PASSED,I),A.occlusionQueries[A.occlusionQueryIndex]=I,A.occlusionQueryObjects[A.occlusionQueryIndex]=t}A.lastOcclusionObject=t}const R=this.bufferRenderer;t.isPoints?R.mode=l.POINTS:t.isLineSegments?R.mode=l.LINES:t.isLine?R.mode=l.LINE_STRIP:t.isLineLoop?R.mode=l.LINE_LOOP:r.wireframe===!0?(u.setLineWidth(r.wireframeLinewidth*this.renderer.getPixelRatio()),R.mode=l.LINES):R.mode=l.TRIANGLES;const{vertexCount:E,instanceCount:N}=p;let{firstVertex:D}=p;if(R.object=t,S!==null){D*=S.array.BYTES_PER_ELEMENT;const I=this.get(S);R.index=S.count,R.type=I.type}else R.index=0;const B=()=>{t.isBatchedMesh?t._multiDrawInstances!==null?(fa("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),R.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?R.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):fa("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):N>1?R.renderInstances(D,E,N):R.render(D,E)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const I=this.get(e.camera),O=e.camera.cameras,L=e.getBindingGroup("cameraIndex").bindings[0];if(I.indexesGPU===void 0||I.indexesGPU.length!==O.length){const K=new Uint32Array([0,0,0,0]),W=[];for(let Z=0,J=O.length;Z<J;Z++){const fe=l.createBuffer();K[0]=Z,l.bindBuffer(l.UNIFORM_BUFFER,fe),l.bufferData(l.UNIFORM_BUFFER,K,l.STATIC_DRAW),W.push(fe)}I.indexesGPU=W}const F=this.get(L),V=this.renderer.getPixelRatio(),H=this._currentContext.renderTarget,Q=this._isRenderCameraDepthArray(this._currentContext),te=this._currentContext.activeCubeFace;if(Q){const K=this.get(H.depthTexture);if(K.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){K.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:W}=H;for(let Z=0,J=O.length;Z<J;Z++)this.renderer._activeCubeFace=Z,this._currentContext.activeCubeFace=Z,this._setFramebuffer(this._currentContext),this.clear(!1,!0,W,this._currentContext,!1);this.renderer._activeCubeFace=te,this._currentContext.activeCubeFace=te}}for(let K=0,W=O.length;K<W;K++){const Z=O[K];if(t.layers.test(Z.layers)){Q&&(this.renderer._activeCubeFace=K,this._currentContext.activeCubeFace=K,this._setFramebuffer(this._currentContext));const J=Z.viewport;if(J!==void 0){const fe=J.x*V,ge=J.y*V,pe=J.width*V,Ae=J.height*V;u.viewport(Math.floor(fe),Math.floor(e.context.height-Ae-ge),Math.floor(pe),Math.floor(Ae))}u.bindBufferBase(l.UNIFORM_BUFFER,F.index,I.indexesGPU[K]),B()}this._currentContext.activeCubeFace=te,this.renderer._activeCubeFace=te}}else B()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,i,r,s,o){return this.textureUtils.copyTextureToBuffer(e,t,i,r,s,o)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new hce(e,t)}createProgram(e){const t=this.gl,{stage:i,code:r}=e,s=i==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(s,r),t.compileShader(s),this.set(e,{shaderGPU:s})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const i=this.gl,r=e.pipeline,{fragmentProgram:s,vertexProgram:o}=r,a=i.createProgram(),l=this.get(s).shaderGPU,u=this.get(o).shaderGPU;if(i.attachShader(a,l),i.attachShader(a,u),i.linkProgram(a),this.set(r,{programGPU:a,fragmentShader:l,vertexShader:u}),t!==null&&this.parallel){const A=new Promise(p=>{const g=this.parallel,v=()=>{i.getProgramParameter(a,g.COMPLETION_STATUS_KHR)?(this._completeCompile(e,r),p()):requestAnimationFrame(v)};v()});t.push(A);return}this._completeCompile(e,r)}_handleSource(e,t){const i=e.split(`
`),r=[],s=Math.max(t-6,0),o=Math.min(t+6,i.length);for(let a=s;a<o;a++){const l=a+1;r.push(`${l===t?">":" "} ${l}: ${i[a]}`)}return r.join(`
`)}_getShaderErrors(e,t,i){const r=e.getShaderParameter(t,e.COMPILE_STATUS),s=e.getShaderInfoLog(t).trim();if(r&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const a=parseInt(o[1]);return i.toUpperCase()+`

`+s+`

`+this._handleSource(e.getShaderSource(t),a)}else return s}_logProgramError(e,t,i){if(this.renderer.debug.checkShaderErrors){const r=this.gl,s=r.getProgramInfoLog(e).trim();if(r.getProgramParameter(e,r.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(r,e,i,t);else{const o=this._getShaderErrors(r,i,"vertex"),a=this._getShaderErrors(r,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+`

Program Info Log: `+s+`
`+o+`
`+a)}else s!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",s)}}_completeCompile(e,t){const{state:i,gl:r}=this,s=this.get(t),{programGPU:o,fragmentShader:a,vertexShader:l}=s;r.getProgramParameter(o,r.LINK_STATUS)===!1&&this._logProgramError(o,a,l),i.useProgram(o);const u=e.getBindings();this._setupBindings(u,o),this.set(t,{programGPU:o})}createComputePipeline(e,t){const{state:i,gl:r}=this,s={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(s);const{computeProgram:o}=e,a=r.createProgram(),l=this.get(s).shaderGPU,u=this.get(o).shaderGPU,A=o.transforms,p=[],g=[];for(let T=0;T<A.length;T++){const w=A[T];p.push(w.varyingName),g.push(w.attributeNode)}r.attachShader(a,l),r.attachShader(a,u),r.transformFeedbackVaryings(a,p,r.SEPARATE_ATTRIBS),r.linkProgram(a),r.getProgramParameter(a,r.LINK_STATUS)===!1&&this._logProgramError(a,l,u),i.useProgram(a),this._setupBindings(t,a);const v=o.attributes,x=[],S=[];for(let T=0;T<v.length;T++){const w=v[T].node.attribute;x.push(w),this.has(w)||this.attributeUtils.createAttribute(w,r.ARRAY_BUFFER)}for(let T=0;T<g.length;T++){const w=g[T].attribute;this.has(w)||this.attributeUtils.createAttribute(w,r.ARRAY_BUFFER);const R=this.get(w);S.push(R)}this.set(e,{programGPU:a,transformBuffers:S,attributes:x})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let i=0,r=0;for(const s of t){this.set(s,{textures:r,uniformBuffers:i});for(const o of s.bindings)o.isUniformBuffer&&i++,o.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,i=this.get(e);let r=i.uniformBuffers,s=i.textures;for(const o of e.bindings)if(o.isUniformsGroup||o.isUniformBuffer){const a=o.buffer,l=t.createBuffer();t.bindBuffer(t.UNIFORM_BUFFER,l),t.bufferData(t.UNIFORM_BUFFER,a,t.DYNAMIC_DRAW),this.set(o,{index:r++,bufferGPU:l})}else if(o.isSampledTexture){const{textureGPU:a,glTextureType:l}=this.get(o.texture);this.set(o,{index:s++,textureGPU:a,glTextureType:l})}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,s=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,s,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(dT).filter(r=>dT[r]===e),i=this.extensions;for(let r=0;r<t.length;r++)if(i.has(t[r]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,i=null,r=null,s=0,o=0){this.textureUtils.copyTextureToTexture(e,t,i,r,s,o)}copyFramebufferToTexture(e,t,i){this.textureUtils.copyFramebufferToTexture(e,t,i)}_setFramebuffer(e){const{gl:t,state:i}=this;let r=null;if(e.textures!==null){const s=e.renderTarget,o=this.get(s),{samples:a,depthBuffer:l,stencilBuffer:u}=s,A=s.isWebGLCubeRenderTarget===!0,p=s.isRenderTarget3D===!0,g=s.isRenderTargetArray===!0,v=s.isXRRenderTarget===!0,x=v===!0&&s.hasExternalTextures===!0;let S=o.msaaFrameBuffer,T=o.depthRenderbuffer;const w=this.extensions.get("WEBGL_multisampled_render_to_texture"),R=this.extensions.get("OVR_multiview2"),E=this._useMultisampledExtension(s),N=SP(e);let D;if(A?(o.cubeFramebuffers||(o.cubeFramebuffers={}),D=o.cubeFramebuffers[N]):v&&x===!1?D=this._xrFramebuffer:(o.framebuffers||(o.framebuffers={}),D=o.framebuffers[N]),D===void 0){D=t.createFramebuffer(),i.bindFramebuffer(t.FRAMEBUFFER,D);const B=e.textures;if(A){o.cubeFramebuffers[N]=D;const{textureGPU:I}=this.get(B[0]),O=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+O,I,0)}else{o.framebuffers[N]=D;for(let I=0;I<B.length;I++){const O=B[I],L=this.get(O);L.renderTarget=e.renderTarget,L.cacheKey=N;const F=t.COLOR_ATTACHMENT0+I;if(p||g){const V=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,F,L.textureGPU,0,V)}else s.multiview?R.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,F,L.textureGPU,0,a,0,2):x&&E?w.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,F,t.TEXTURE_2D,L.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,F,t.TEXTURE_2D,L.textureGPU,0)}i.drawBuffers(e,D)}if(s.isXRRenderTarget&&s.autoAllocateDepthBuffer===!0){const I=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(I,e,0,E),o.xrDepthRenderbuffer=I}else if(e.depthTexture!==null){const I=this.get(e.depthTexture),O=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(I.renderTarget=e.renderTarget,I.cacheKey=N,s.multiview)R.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,O,I.textureGPU,0,a,0,2);else if(x&&E)w.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,O,t.TEXTURE_2D,I.textureGPU,0,a);else if(e.depthTexture.isDepthArrayTexture){const L=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,O,I.textureGPU,0,L)}else t.framebufferTexture2D(t.FRAMEBUFFER,O,t.TEXTURE_2D,I.textureGPU,0)}}else{if(this._isRenderCameraDepthArray(e)){i.bindFramebuffer(t.FRAMEBUFFER,D);const I=this.renderer._activeCubeFace,O=this.get(e.depthTexture),L=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,L,O.textureGPU,0,I)}if(v&&x||s.multiview){i.bindFramebuffer(t.FRAMEBUFFER,D);const I=this.get(e.textures[0]);s.multiview?R.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,I.textureGPU,0,a,0,2):E?w.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,I.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,I.textureGPU,0);const O=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s.autoAllocateDepthBuffer===!0){const L=o.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,L),t.framebufferRenderbuffer(t.FRAMEBUFFER,O,t.RENDERBUFFER,L)}else{const L=this.get(e.depthTexture);s.multiview?R.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,O,L.textureGPU,0,a,0,2):E?w.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,O,t.TEXTURE_2D,L.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,O,t.TEXTURE_2D,L.textureGPU,0)}}}if(a>0&&E===!1&&!s.multiview){if(S===void 0){const B=[];S=t.createFramebuffer(),i.bindFramebuffer(t.FRAMEBUFFER,S);const I=[],O=e.textures;for(let L=0;L<O.length;L++){if(I[L]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,I[L]),B.push(t.COLOR_ATTACHMENT0+L),l){const H=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;B.push(H)}const F=e.textures[L],V=this.get(F);t.renderbufferStorageMultisample(t.RENDERBUFFER,a,V.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+L,t.RENDERBUFFER,I[L])}if(o.msaaFrameBuffer=S,o.msaaRenderbuffers=I,T===void 0){T=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(T,e,a),o.depthRenderbuffer=T;const L=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;B.push(L)}o.invalidationArray=B}r=o.msaaFrameBuffer}else r=D}i.bindFramebuffer(t.FRAMEBUFFER,r)}_getVaoKey(e){let t="";for(let i=0;i<e.length;i++){const r=this.get(e[i]);t+=":"+r.id}return t}_createVao(e){const{gl:t}=this,i=t.createVertexArray();let r="",s=!0;t.bindVertexArray(i);for(let o=0;o<e.length;o++){const a=e[o],l=this.get(a);r+=":"+l.id,t.bindBuffer(t.ARRAY_BUFFER,l.bufferGPU),t.enableVertexAttribArray(o),(a.isStorageBufferAttribute||a.isStorageInstancedBufferAttribute)&&(s=!1);let u,A;a.isInterleavedBufferAttribute===!0?(u=a.data.stride*l.bytesPerElement,A=a.offset*l.bytesPerElement):(u=0,A=0),l.isInteger?t.vertexAttribIPointer(o,a.itemSize,l.type,u,A):t.vertexAttribPointer(o,a.itemSize,l.type,a.normalized,u,A),a.isInstancedBufferAttribute&&!a.isInterleavedBufferAttribute?t.vertexAttribDivisor(o,a.meshPerAttribute):a.isInterleavedBufferAttribute&&a.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(o,a.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),this.vaoCache[r]=i,{vaoGPU:i,staticVao:s}}_getTransformFeedback(e){let t="";for(let s=0;s<e.length;s++)t+=":"+e[s].id;let i=this.transformFeedbackCache[t];if(i!==void 0)return i;const{gl:r}=this;i=r.createTransformFeedback(),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i);for(let s=0;s<e.length;s++){const o=e[s];r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,s,o.transformBuffer)}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=i,i}_setupBindings(e,t){const i=this.gl;for(const r of e)for(const s of r.bindings){const a=this.get(s).index;if(s.isUniformsGroup||s.isUniformBuffer){const l=i.getUniformBlockIndex(t,s.name);i.uniformBlockBinding(t,l,a)}else if(s.isSampledTexture){const l=i.getUniformLocation(t,s.name);i.uniform1i(l,a)}}}_bindUniforms(e){const{gl:t,state:i}=this;for(const r of e)for(const s of r.bindings){const o=this.get(s),a=o.index;s.isUniformsGroup||s.isUniformBuffer?i.bindBufferBase(t.UNIFORM_BUFFER,a,o.bufferGPU):s.isSampledTexture&&i.bindTexture(o.glTextureType,o.textureGPU,t.TEXTURE0+a)}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer!==!1}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const yf={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},qr={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},Ss={Store:"store"},ni={Load:"load",Clear:"clear"},rv={CCW:"ccw"},sv={None:"none",Front:"front",Back:"back"},mA={Uint16:"uint16",Uint32:"uint32"},ve={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},ov={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},Rc={Linear:"linear",Nearest:"nearest"},yn={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDstColor:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},gc={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},mT={None:0,All:15},mu={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},av={Storage:"storage",ReadOnlyStorage:"read-only-storage"},lv={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},gT={NonFiltering:"non-filtering",Comparison:"comparison"},_c={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},_T={TwoD:"2d",ThreeD:"3d"},Dr={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},bce={All:"all"},Xm={Vertex:"vertex",Instance:"instance"},jy={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"};class wce extends Ob{constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.isSampler=!0}}class Sce extends wce{constructor(e,t,i){super(e,t?t.value:null),this.textureNode=t,this.groupNode=i}update(){this.texture=this.textureNode.value}}class Tce extends CL{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let Mce=0;class Ece extends Tce{constructor(e,t){super("StorageBuffer_"+Mce++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:fs.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class Cce extends ju{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,i=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,r=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:Rc.Linear}),this.flipYSampler=e.createSampler({minFilter:Rc.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:t}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:i}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:r})}getTransferPipeline(e){let t=this.transferPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:yf.TriangleStrip,stripIndexFormat:mA.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:yf.TriangleStrip,stripIndexFormat:mA.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,i=0){const r=t.format,{width:s,height:o}=t.size,a=this.getTransferPipeline(r),l=this.getFlipYPipeline(r),u=this.device.createTexture({size:{width:s,height:o,depthOrArrayLayers:1},format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),A=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Dr.TwoD,baseArrayLayer:i}),p=u.createView({baseMipLevel:0,mipLevelCount:1,dimension:Dr.TwoD,baseArrayLayer:0}),g=this.device.createCommandEncoder({}),v=(x,S,T)=>{const w=x.getBindGroupLayout(0),R=this.device.createBindGroup({layout:w,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:S}]}),E=g.beginRenderPass({colorAttachments:[{view:T,loadOp:ni.Clear,storeOp:Ss.Store,clearValue:[0,0,0,0]}]});E.setPipeline(x),E.setBindGroup(0,R),E.draw(4,1,0,0),E.end()};v(a,A,p),v(l,p,A),this.device.queue.submit([g.finish()]),u.destroy()}generateMipmaps(e,t,i=0){const r=this.get(e);r.useCount===void 0&&(r.useCount=0,r.layers=[]);const s=r.layers[i]||this._mipmapCreateBundles(e,t,i),o=this.device.createCommandEncoder({});this._mipmapRunBundles(o,s),this.device.queue.submit([o.finish()]),r.useCount!==0&&(r.layers[i]=s),r.useCount++}_mipmapCreateBundles(e,t,i){const r=this.getTransferPipeline(t.format),s=r.getBindGroupLayout(0);let o=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Dr.TwoD,baseArrayLayer:i});const a=[];for(let l=1;l<t.mipLevelCount;l++){const u=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:o}]}),A=e.createView({baseMipLevel:l,mipLevelCount:1,dimension:Dr.TwoD,baseArrayLayer:i}),p={colorAttachments:[{view:A,loadOp:ni.Clear,storeOp:Ss.Store,clearValue:[0,0,0,0]}]},g=this.device.createRenderBundleEncoder({colorFormats:[t.format]});g.setPipeline(r),g.setBindGroup(0,u),g.draw(4,1,0,0),a.push({renderBundles:[g.finish()],passDescriptor:p}),o=A}return a}_mipmapRunBundles(e,t){const i=t.length;for(let r=0;r<i;r++){const s=t[r],o=e.beginRenderPass(s.passDescriptor);o.executeBundles(s.renderBundles),o.end()}}}const Rce={[Ux]:"never",[Jg]:"less",[Ox]:"equal",[e2]:"less-equal",[kx]:"greater",[Gx]:"greater-equal",[qx]:"always",[Vx]:"not-equal"},Nce=[0,1,3,2,4,5];class Pce{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new Ys,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,i=t.device,r=t.get(e),s={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};s.magFilter===Rc.Linear&&s.minFilter===Rc.Linear&&s.mipmapFilter===Rc.Linear&&(s.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(s.compare=Rce[e.compareFunction]),r.sampler=i.createSampler(s)}createDefaultTexture(e){let t;const i=Xy(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(i):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():t=this._getDefaultTextureGPU(i),this.backend.get(e).texture=t}createTexture(e,t={}){const i=this.backend,r=i.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:s,height:o,depth:a,levels:l}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const u=this._getDimension(e),A=e.internalFormat||t.format||Xy(e,i.device);r.format=A;const{samples:p,primarySamples:g,isMSAA:v}=i.utils.getTextureSampleData(e);let x=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(x|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&(x|=GPUTextureUsage.RENDER_ATTACHMENT);const S={label:e.name,size:{width:s,height:o,depthOrArrayLayers:a},mipLevelCount:l,sampleCount:g,dimension:u,format:A,usage:x};if(e.isVideoTexture){const T=e.source.data,w=new VideoFrame(T);S.size.width=w.displayWidth,S.size.height=w.displayHeight,w.close(),r.externalTexture=T}else{if(A===void 0){console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}e.isCubeTexture&&(S.textureBindingViewDimension=Dr.Cube),r.texture=i.device.createTexture(S)}if(v){const T=Object.assign({},S);T.label=T.label+"-msaa",T.sampleCount=p,r.msaaTexture=i.device.createTexture(T)}r.initialized=!0,r.textureDescriptorGPU=S}destroyTexture(e){const t=this.backend,i=t.get(e);i.texture!==void 0&&i.texture.destroy(),i.msaaTexture!==void 0&&i.msaaTexture.destroy(),t.delete(e)}destroySampler(e){const i=this.backend.get(e);delete i.sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let i=0;i<6;i++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,i);else{const i=e.image.depth||1;for(let r=0;r<i;r++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,r)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:i}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:i,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const i=this.backend,{width:r,height:s}=i.getDrawingBufferSize(),o=this.depthTexture,a=i.get(o).texture;let l,u;if(t?(l=bo,u=yo):e&&(l=xo,u=bi),a!==void 0){if(o.image.width===r&&o.image.height===s&&o.format===l&&o.type===u)return a;this.destroyTexture(o)}return o.name="depthBuffer",o.format=l,o.type=u,o.image.width=r,o.image.height=s,this.createTexture(o,{width:r,height:s}),i.get(o).texture}updateTexture(e,t){const i=this.backend.get(e),{textureDescriptorGPU:r}=i;if(!(e.isRenderTargetTexture||r===void 0)){if(e.isDataTexture)this._copyBufferToTexture(t.image,i.texture,r,0,e.flipY);else if(e.isDataArrayTexture||e.isDepthArrayTexture||e.isData3DTexture)for(let s=0;s<t.image.depth;s++)this._copyBufferToTexture(t.image,i.texture,r,s,e.flipY,s);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,i.texture,r);else if(e.isCubeTexture)this._copyCubeMapToTexture(t.images,i.texture,r,e.flipY);else if(e.isVideoTexture){const s=e.source.data;i.externalTexture=s}else this._copyImageToTexture(t.image,i.texture,r,0,e.flipY);i.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,t,i,r,s,o){const a=this.backend.device,l=this.backend.get(e),u=l.texture,A=l.textureDescriptorGPU.format,p=this._getBytesPerTexel(A);let g=r*p;g=Math.ceil(g/256)*256;const v=a.createBuffer({size:r*s*p,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),x=a.createCommandEncoder();x.copyTextureToBuffer({texture:u,origin:{x:t,y:i,z:o}},{buffer:v,bytesPerRow:g},{width:r,height:s});const S=this._getTypedArrayType(A);a.queue.submit([x.finish()]),await v.mapAsync(GPUMapMode.READ);const T=v.getMappedRange();return new S(T)}_isEnvironmentTexture(e){const t=e.mapping;return t===Yc||t===Zc||t===ga||t===_a}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const i=new vr;i.minFilter=Mi,i.magFilter=Mi,this.createTexture(i,{width:1,height:1,format:e}),this.defaultTexture[e]=t=i}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const i=new i2;i.minFilter=Mi,i.magFilter=Mi,this.createTexture(i,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=i}return this.backend.get(t).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(e===null){const t={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),t)}return e}_copyCubeMapToTexture(e,t,i,r){for(let s=0;s<6;s++){const o=e[s],a=r===!0?Nce[s]:s;o.isDataTexture?this._copyBufferToTexture(o.image,t,i,a,r):this._copyImageToTexture(o,t,i,a,r)}}_copyImageToTexture(e,t,i,r,s){this.backend.device.queue.copyExternalImageToTexture({source:e,flipY:s},{texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},{width:e.width,height:e.height,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new Cce(this.backend.device)),e}_generateMipmaps(e,t,i=0){this._getPassUtils().generateMipmaps(e,t,i)}_flipY(e,t,i=0){this._getPassUtils().flipY(e,t,i)}_copyBufferToTexture(e,t,i,r,s,o=0){const a=this.backend.device,l=e.data,u=this._getBytesPerTexel(i.format),A=e.width*u;a.queue.writeTexture({texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},l,{offset:e.width*e.height*u*o,bytesPerRow:A},{width:e.width,height:e.height,depthOrArrayLayers:1}),s===!0&&this._flipY(t,i,r)}_copyCompressedBufferToTexture(e,t,i){const r=this.backend.device,s=this._getBlockData(i.format),o=i.size.depthOrArrayLayers>1;for(let a=0;a<e.length;a++){const l=e[a],u=l.width,A=l.height,p=o?i.size.depthOrArrayLayers:1,g=Math.ceil(u/s.width)*s.byteLength,v=g*Math.ceil(A/s.height);for(let x=0;x<p;x++)r.queue.writeTexture({texture:t,mipLevel:a,origin:{x:0,y:0,z:x}},l.data,{offset:x*v,bytesPerRow:g,rowsPerImage:Math.ceil(A/s.height)},{width:Math.ceil(u/s.width)*s.width,height:Math.ceil(A/s.height)*s.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===ve.BC1RGBAUnorm||e===ve.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===ve.BC2RGBAUnorm||e===ve.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===ve.BC3RGBAUnorm||e===ve.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===ve.BC4RUnorm||e===ve.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===ve.BC5RGUnorm||e===ve.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===ve.BC6HRGBUFloat||e===ve.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===ve.BC7RGBAUnorm||e===ve.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===ve.ETC2RGB8Unorm||e===ve.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===ve.ETC2RGB8A1Unorm||e===ve.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===ve.ETC2RGBA8Unorm||e===ve.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===ve.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===ve.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===ve.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===ve.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===ve.ASTC4x4Unorm||e===ve.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===ve.ASTC5x4Unorm||e===ve.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===ve.ASTC5x5Unorm||e===ve.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===ve.ASTC6x5Unorm||e===ve.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===ve.ASTC6x6Unorm||e===ve.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===ve.ASTC8x5Unorm||e===ve.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===ve.ASTC8x6Unorm||e===ve.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===ve.ASTC8x8Unorm||e===ve.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===ve.ASTC10x5Unorm||e===ve.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===ve.ASTC10x6Unorm||e===ve.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===ve.ASTC10x8Unorm||e===ve.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===ve.ASTC10x10Unorm||e===ve.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===ve.ASTC12x10Unorm||e===ve.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===ve.ASTC12x12Unorm||e===ve.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=ov.ClampToEdge;return e===Jc?t=ov.Repeat:e===eh&&(t=ov.MirrorRepeat),t}_convertFilterMode(e){let t=Rc.Linear;return(e===Mi||e===Ix||e===Pl)&&(t=Rc.Nearest),t}_getBytesPerTexel(e){if(e===ve.R8Unorm||e===ve.R8Snorm||e===ve.R8Uint||e===ve.R8Sint)return 1;if(e===ve.R16Uint||e===ve.R16Sint||e===ve.R16Float||e===ve.RG8Unorm||e===ve.RG8Snorm||e===ve.RG8Uint||e===ve.RG8Sint)return 2;if(e===ve.R32Uint||e===ve.R32Sint||e===ve.R32Float||e===ve.RG16Uint||e===ve.RG16Sint||e===ve.RG16Float||e===ve.RGBA8Unorm||e===ve.RGBA8UnormSRGB||e===ve.RGBA8Snorm||e===ve.RGBA8Uint||e===ve.RGBA8Sint||e===ve.BGRA8Unorm||e===ve.BGRA8UnormSRGB||e===ve.RGB9E5UFloat||e===ve.RGB10A2Unorm||e===ve.RG11B10UFloat||e===ve.Depth32Float||e===ve.Depth24Plus||e===ve.Depth24PlusStencil8||e===ve.Depth32FloatStencil8)return 4;if(e===ve.RG32Uint||e===ve.RG32Sint||e===ve.RG32Float||e===ve.RGBA16Uint||e===ve.RGBA16Sint||e===ve.RGBA16Float)return 8;if(e===ve.RGBA32Uint||e===ve.RGBA32Sint||e===ve.RGBA32Float)return 16}_getTypedArrayType(e){if(e===ve.R8Uint)return Uint8Array;if(e===ve.R8Sint)return Int8Array;if(e===ve.R8Unorm)return Uint8Array;if(e===ve.R8Snorm)return Int8Array;if(e===ve.RG8Uint)return Uint8Array;if(e===ve.RG8Sint)return Int8Array;if(e===ve.RG8Unorm)return Uint8Array;if(e===ve.RG8Snorm)return Int8Array;if(e===ve.RGBA8Uint)return Uint8Array;if(e===ve.RGBA8Sint)return Int8Array;if(e===ve.RGBA8Unorm)return Uint8Array;if(e===ve.RGBA8Snorm)return Int8Array;if(e===ve.R16Uint)return Uint16Array;if(e===ve.R16Sint)return Int16Array;if(e===ve.RG16Uint)return Uint16Array;if(e===ve.RG16Sint)return Int16Array;if(e===ve.RGBA16Uint)return Uint16Array;if(e===ve.RGBA16Sint)return Int16Array;if(e===ve.R16Float||e===ve.RG16Float||e===ve.RGBA16Float)return Uint16Array;if(e===ve.R32Uint)return Uint32Array;if(e===ve.R32Sint)return Int32Array;if(e===ve.R32Float)return Float32Array;if(e===ve.RG32Uint)return Uint32Array;if(e===ve.RG32Sint)return Int32Array;if(e===ve.RG32Float)return Float32Array;if(e===ve.RGBA32Uint)return Uint32Array;if(e===ve.RGBA32Sint)return Int32Array;if(e===ve.RGBA32Float)return Float32Array;if(e===ve.BGRA8Unorm||e===ve.BGRA8UnormSRGB)return Uint8Array;if(e===ve.RGB10A2Unorm||e===ve.RGB9E5UFloat||e===ve.RG11B10UFloat)return Uint32Array;if(e===ve.Depth32Float)return Float32Array;if(e===ve.Depth24Plus||e===ve.Depth24PlusStencil8)return Uint32Array;if(e===ve.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.isData3DTexture?t=_T.ThreeD:t=_T.TwoD,t}}function Xy(n,e=null){const t=n.format,i=n.type,r=n.colorSpace;let s;if(n.isCompressedTexture===!0||n.isCompressedArrayTexture===!0)switch(t){case Nu:s=r===Ht?ve.BC1RGBAUnormSRGB:ve.BC1RGBAUnorm;break;case Pu:s=r===Ht?ve.BC2RGBAUnormSRGB:ve.BC2RGBAUnorm;break;case Lu:s=r===Ht?ve.BC3RGBAUnormSRGB:ve.BC3RGBAUnorm;break;case qf:s=r===Ht?ve.ETC2RGB8UnormSRGB:ve.ETC2RGB8Unorm;break;case zf:s=r===Ht?ve.ETC2RGBA8UnormSRGB:ve.ETC2RGBA8Unorm;break;case Hf:s=r===Ht?ve.ASTC4x4UnormSRGB:ve.ASTC4x4Unorm;break;case $f:s=r===Ht?ve.ASTC5x4UnormSRGB:ve.ASTC5x4Unorm;break;case Wf:s=r===Ht?ve.ASTC5x5UnormSRGB:ve.ASTC5x5Unorm;break;case jf:s=r===Ht?ve.ASTC6x5UnormSRGB:ve.ASTC6x5Unorm;break;case Xf:s=r===Ht?ve.ASTC6x6UnormSRGB:ve.ASTC6x6Unorm;break;case Qf:s=r===Ht?ve.ASTC8x5UnormSRGB:ve.ASTC8x5Unorm;break;case Yf:s=r===Ht?ve.ASTC8x6UnormSRGB:ve.ASTC8x6Unorm;break;case Zf:s=r===Ht?ve.ASTC8x8UnormSRGB:ve.ASTC8x8Unorm;break;case Kf:s=r===Ht?ve.ASTC10x5UnormSRGB:ve.ASTC10x5Unorm;break;case Jf:s=r===Ht?ve.ASTC10x6UnormSRGB:ve.ASTC10x6Unorm;break;case eA:s=r===Ht?ve.ASTC10x8UnormSRGB:ve.ASTC10x8Unorm;break;case tA:s=r===Ht?ve.ASTC10x10UnormSRGB:ve.ASTC10x10Unorm;break;case nA:s=r===Ht?ve.ASTC12x10UnormSRGB:ve.ASTC12x10Unorm;break;case iA:s=r===Ht?ve.ASTC12x12UnormSRGB:ve.ASTC12x12Unorm;break;case ir:s=r===Ht?ve.RGBA8UnormSRGB:ve.RGBA8Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}else switch(t){case ir:switch(i){case Uc:s=ve.RGBA8Snorm;break;case Oc:s=ve.RGBA16Sint;break;case sa:s=ve.RGBA16Uint;break;case bi:s=ve.RGBA32Uint;break;case Ir:s=ve.RGBA32Sint;break;case ji:s=r===Ht?ve.RGBA8UnormSRGB:ve.RGBA8Unorm;break;case Mr:s=ve.RGBA16Float;break;case lr:s=ve.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",i)}break;case np:switch(i){case Kg:s=ve.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",i)}break;case ip:switch(i){case Uc:s=ve.R8Snorm;break;case Oc:s=ve.R16Sint;break;case sa:s=ve.R16Uint;break;case bi:s=ve.R32Uint;break;case Ir:s=ve.R32Sint;break;case ji:s=ve.R8Unorm;break;case Mr:s=ve.R16Float;break;case lr:s=ve.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",i)}break;case Ll:switch(i){case Uc:s=ve.RG8Snorm;break;case Oc:s=ve.RG16Sint;break;case sa:s=ve.RG16Uint;break;case bi:s=ve.RG32Uint;break;case Ir:s=ve.RG32Sint;break;case ji:s=ve.RG8Unorm;break;case Mr:s=ve.RG16Float;break;case lr:s=ve.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",i)}break;case xo:switch(i){case sa:s=ve.Depth16Unorm;break;case bi:s=ve.Depth24Plus;break;case lr:s=ve.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",i)}break;case bo:switch(i){case yo:s=ve.Depth24PlusStencil8;break;case lr:e&&e.features.has(jy.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),s=ve.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",i)}break;case vA:switch(i){case Ir:s=ve.R32Sint;break;case bi:s=ve.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",i)}break;case yA:switch(i){case Ir:s=ve.RG32Sint;break;case bi:s=ve.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",i)}break;case xA:switch(i){case Ir:s=ve.RGBA32Sint;break;case bi:s=ve.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",i)}break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}return s}const Lce=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,Dce=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,vT={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},Ice=n=>{n=n.trim();const e=n.match(Lce);if(e!==null&&e.length===4){const t=e[2],i=[];let r=null;for(;(r=Dce.exec(t))!==null;)i.push({name:r[1],type:r[2]});const s=[];for(let A=0;A<i.length;A++){const{name:p,type:g}=i[A];let v=g;v.startsWith("ptr")?v="pointer":(v.startsWith("texture")&&(v=g.split("<")[0]),v=vT[v]),s.push(new Fb(v,p))}const o=n.substring(e[0].length),a=e[3]||"void",l=e[1]!==void 0?e[1]:"";return{type:vT[a]||a,inputs:s,name:l,inputsCode:t,blockCode:o,outputType:a}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class Bce extends Ub{constructor(e){const{type:t,inputs:i,name:r,inputsCode:s,blockCode:o,outputType:a}=Ice(e);super(t,i,r),this.inputsCode=s,this.blockCode=o,this.outputType=a}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class Fce extends ML{parseFunction(e){return new Bce(e)}}const nf=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},Uce={[fs.READ_ONLY]:"read",[fs.WRITE_ONLY]:"write",[fs.READ_WRITE]:"read_write"},yT={[Jc]:"repeat",[qa]:"clamp",[eh]:"mirror"},Qm={vertex:nf?nf.VERTEX:1,fragment:nf?nf.FRAGMENT:2,compute:nf?nf.COMPUTE:4},xT={instance:!0,swizzleAssign:!1,storageBuffer:!0},Oce={"^^":"tsl_xor"},kce={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},bT={},Io={tsl_xor:new mr("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new mr("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new mr("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new mr("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new mr("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new mr("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new mr("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new mr("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new mr("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new mr("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new mr("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new mr("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new mr(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},C0={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};typeof navigator<"u"&&/Windows/g.test(navigator.userAgent)&&(Io.pow_float=new mr("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),Io.pow_vec2=new mr("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[Io.pow_float]),Io.pow_vec3=new mr("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[Io.pow_float]),Io.pow_vec4=new mr("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[Io.pow_float]),C0.pow_float="tsl_pow_float",C0.pow_vec2="tsl_pow_vec2",C0.pow_vec3="tsl_pow_vec3",C0.pow_vec4="tsl_pow_vec4");let FL="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(FL+=`diagnostic( off, derivative_uniformity );
`);class Vce extends SL{constructor(e,t){super(e,t,new Fce),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==go}_generateTextureSample(e,t,i,r,s=this.shaderStage){return s==="fragment"?r?`textureSample( ${t}, ${t}_sampler, ${i}, ${r} )`:`textureSample( ${t}, ${t}_sampler, ${i} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,i):this.generateTextureLod(e,t,i,r,"0")}_generateVideoSample(e,t,i=this.shaderStage){if(i==="fragment")return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${t}.x, 1.0 - ${t}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${i} shader.`)}_generateTextureSampleLevel(e,t,i,r,s,o=this.shaderStage){return(o==="fragment"||o==="compute")&&this.isUnfilterable(e)===!1?`textureSampleLevel( ${t}, ${t}_sampler, ${i}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,i,r):this.generateTextureLod(e,t,i,s,r)}generateWrapFunction(e){const t=`tsl_coord_${yT[e.wrapS]}S_${yT[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let i=bT[t];if(i===void 0){const r=[],s=e.isData3DTexture?"vec3f":"vec2f";let o=`fn ${t}( coord : ${s} ) -> ${s} {

	return ${s}(
`;const a=(l,u)=>{l===Jc?(r.push(Io.repeatWrapping_float),o+=`		tsl_repeatWrapping_float( coord.${u} )`):l===qa?(r.push(Io.clampWrapping_float),o+=`		tsl_clampWrapping_float( coord.${u} )`):l===eh?(r.push(Io.mirrorWrapping_float),o+=`		tsl_mirrorWrapping_float( coord.${u} )`):(o+=`		coord.${u}`,console.warn(`WebGPURenderer: Unsupported texture wrap type "${l}" for vertex shader.`))};a(e.wrapS,"x"),o+=`,
`,a(e.wrapT,"y"),e.isData3DTexture&&(o+=`,
`,a(e.wrapR,"z")),o+=`
	);

}
`,bT[t]=i=new mr(o,r)}return i.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,i){const r=this.getDataFromNode(e,this.shaderStage,this.globalCache);r.dimensionsSnippet===void 0&&(r.dimensionsSnippet={});let s=r.dimensionsSnippet[i];if(r.dimensionsSnippet[i]===void 0){let o,a;const{primarySamples:l}=this.renderer.backend.utils.getTextureSampleData(e),u=l>1;e.isData3DTexture?a="vec3<u32>":a="vec2<u32>",u||e.isVideoTexture||e.isStorageTexture?o=t:o=`${t}${i?`, u32( ${i} )`:""}`,s=new b1(new w1(`textureDimensions( ${o} )`,a)),r.dimensionsSnippet[i]=s,(e.isDataArrayTexture||e.isDepthArrayTexture||e.isData3DTexture)&&(r.arrayLayerCount=new b1(new w1(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(r.cubeFaceCount=new b1(new w1("6u","u32")))}return s.build(this)}generateFilteredTexture(e,t,i,r="0u"){this._include("biquadraticTexture");const s=this.generateWrapFunction(e),o=this.generateTextureDimension(e,t,r);return`tsl_biquadraticTexture( ${t}, ${s}( ${i} ), ${o}, u32( ${r} ) )`}generateTextureLod(e,t,i,r,s="0u"){const o=this.generateWrapFunction(e),a=this.generateTextureDimension(e,t,s),l=e.isData3DTexture?"vec3":"vec2",u=`${l}<u32>( ${o}( ${i} ) * ${l}<f32>( ${a} ) )`;return this.generateTextureLoad(e,t,u,r,s)}generateTextureLoad(e,t,i,r,s="0u"){let o;return e.isVideoTexture===!0||e.isStorageTexture===!0?o=`textureLoad( ${t}, ${i} )`:r?o=`textureLoad( ${t}, ${i}, ${r}, u32( ${s} ) )`:(o=`textureLoad( ${t}, ${i}, u32( ${s} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(o+=".x")),o}generateTextureStore(e,t,i,r){return`textureStore( ${t}, ${i}, ${r} )`}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===lr||this.isSampleCompare(e)===!1&&e.minFilter===Mi&&e.magFilter===Mi||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,i,r,s=this.shaderStage){let o=null;return e.isVideoTexture===!0?o=this._generateVideoSample(t,i,s):this.isUnfilterable(e)?o=this.generateTextureLod(e,t,i,r,"0",s):o=this._generateTextureSample(e,t,i,r,s),o}generateTextureGrad(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return`textureSampleGrad( ${t}, ${t}_sampler, ${i},  ${r[0]}, ${r[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${o} shader.`)}generateTextureCompare(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return e.isDepthArrayTexture?`textureSampleCompare( ${t}, ${t}_sampler, ${i}, ${s}, ${r} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${i}, ${r} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}generateTextureLevel(e,t,i,r,s,o=this.shaderStage){let a=null;return e.isVideoTexture===!0?a=this._generateVideoSample(t,i,o):a=this._generateTextureSampleLevel(e,t,i,r,s,o),a}generateTextureBias(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return`textureSampleBias( ${t}, ${t}_sampler, ${i}, ${r} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${o} shader.`)}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const i=e.name,r=e.type;return r==="texture"||r==="cubeTexture"||r==="storageTexture"||r==="texture3D"?i:r==="buffer"||r==="storageBuffer"||r==="indirectStorageBuffer"?this.isCustomStruct(e)?i:i+".value":e.groupNode.name+"."+i}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=Oce[e];return t!==void 0?(this._include(t),t):null}getNodeAccess(e,t){return t!=="compute"?fs.READ_ONLY:e.access}getStorageAccess(e,t){return Uce[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,i,r=null){const s=super.getUniformFromNode(e,t,i,r),o=this.getDataFromNode(e,i,this.globalCache);if(o.uniformGPU===void 0){let a;const l=e.groupNode,u=l.name,A=this.getBindGroupArray(u,i);if(t==="texture"||t==="cubeTexture"||t==="storageTexture"||t==="texture3D"){let p=null;const g=this.getNodeAccess(e,i);if(t==="texture"||t==="storageTexture"?p=new G2(s.name,s.node,l,g):t==="cubeTexture"?p=new LL(s.name,s.node,l,g):t==="texture3D"&&(p=new DL(s.name,s.node,l,g)),p.store=e.isStorageTextureNode===!0,p.setVisibility(Qm[i]),(i==="fragment"||i==="compute")&&this.isUnfilterable(e.value)===!1&&p.store===!1){const v=new Sce(`${s.name}_sampler`,s.node,l);v.setVisibility(Qm[i]),A.push(v,p),a=[v,p]}else A.push(p),a=[p]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const p=t==="buffer"?NL:Ece,g=new p(e,l);g.setVisibility(Qm[i]),A.push(g),a=g,s.name=r||"NodeBuffer_"+s.id}else{const p=this.uniformGroups[i]||(this.uniformGroups[i]={});let g=p[u];g===void 0&&(g=new PL(u,l),g.setVisibility(Qm[i]),p[u]=g,A.push(g)),a=this.getNodeUniform(s,t),g.addUniform(a)}o.uniformGPU=a}return s}getBuiltin(e,t,i,r=this.shaderStage){const s=this.builtins[r]||(this.builtins[r]=new Map);return s.has(e)===!1&&s.set(e,{name:e,property:t,type:i}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,i=this.flowShaderNode(e),r=[];for(const o of t.inputs)r.push(o.name+" : "+this.getType(o.type));let s=`fn ${t.name}( ${r.join(", ")} ) -> ${this.getType(t.type)} {
${i.vars}
${i.code}
`;return i.result&&(s+=`	return ${i.result};
`),s+=`
}
`,s}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],i=this.directives[e];if(i!==void 0)for(const r of i)t.push(`enable ${r};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],i=this.builtins[e];if(i!==void 0)for(const{name:r,property:s,type:o}of i.values())t.push(`@builtin( ${r} ) ${s} : ${o}`);return t.join(`,
	`)}getScopedArray(e,t,i,r){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:i,bufferCount:r}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:i,scope:r,bufferType:s,bufferCount:o}of this.scopedArrays.values()){const a=this.getType(s);t.push(`var<${r}> ${i}: array< ${a}, ${o} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const i=this.getBuiltins("attribute");i&&t.push(i);const r=this.getAttributesArray();for(let s=0,o=r.length;s<o;s++){const a=r[s],l=a.name,u=this.getType(a.type);t.push(`@location( ${s} ) ${l} : ${u}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[];for(const i of e.members){const r=e.output?"@location( "+i.index+" ) ":"";let s=this.getType(i.type);i.atomic&&(s="atomic< "+s+" >"),t.push(`	${r+i.name} : ${s}`)}return e.output&&t.push(`	${this.getBuiltins("output")}`),t.join(`,
`)}getStructs(e){let t="";const i=this.structs[e];if(i.length>0){const r=[];for(const s of i){let o=`struct ${s.name} {
`;o+=this.getStructMembers(s),o+=`
};`,r.push(o)}t=`
`+r.join(`

`)+`
`}return t}getVar(e,t,i=null){let r=`var ${t} : `;return i!==null?r+=this.generateArrayDeclaration(e,i):r+=this.getType(e),r}getVars(e){const t=[],i=this.vars[e];if(i!==void 0)for(const r of i)t.push(`	${this.getVar(r.type,r.name,r.count)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const s=this.varyings,o=this.vars[e];for(let a=0;a<s.length;a++){const l=s[a];if(l.needsInterpolation){let u=`@location( ${a} )`;if(l.interpolationType){const A=l.interpolationSampling!==null?`, ${l.interpolationSampling} )`:" )";u+=` @interpolate( ${l.interpolationType}${A}`}else/^(int|uint|ivec|uvec)/.test(l.type)&&(u+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${u} ${l.name} : ${this.getType(l.type)}`)}else e==="vertex"&&o.includes(l)===!1&&o.push(l)}}const i=this.getBuiltins(e);i&&t.push(i);const r=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+r):r}isCustomStruct(e){const t=e.value,i=e.node,r=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&i.structTypeNode!==null,s=i.value&&i.value.array&&typeof i.value.itemSize=="number"&&i.value.array.length>i.value.itemSize;return r&&!s}getUniforms(e){const t=this.uniforms[e],i=[],r=[],s=[],o={};for(const l of t){const u=l.groupNode.name,A=this.bindingsIndexes[u];if(l.type==="texture"||l.type==="cubeTexture"||l.type==="storageTexture"||l.type==="texture3D"){const p=l.node.value;(e==="fragment"||e==="compute")&&this.isUnfilterable(p)===!1&&l.node.isStorageTextureNode!==!0&&(this.isSampleCompare(p)?i.push(`@binding( ${A.binding++} ) @group( ${A.group} ) var ${l.name}_sampler : sampler_comparison;`):i.push(`@binding( ${A.binding++} ) @group( ${A.group} ) var ${l.name}_sampler : sampler;`));let g,v="";const{primarySamples:x}=this.renderer.backend.utils.getTextureSampleData(p);if(x>1&&(v="_multisampled"),p.isCubeTexture===!0)g="texture_cube<f32>";else if(p.isDataArrayTexture===!0||p.isCompressedArrayTexture===!0||p.isTextureArray===!0)g="texture_2d_array<f32>";else if(p.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&p.compareFunction===null?g=`texture${v}_2d<f32>`:g=`texture_depth${v}_2d${p.isDepthArrayTexture===!0?"_array":""}`;else if(p.isVideoTexture===!0)g="texture_external";else if(p.isData3DTexture===!0)g="texture_3d<f32>";else if(l.node.isStorageTextureNode===!0){const S=Xy(p),T=this.getStorageAccess(l.node,e);g=`texture_storage_2d<${S}, ${T}>`}else{const S=this.getComponentTypeFromTexture(p).charAt(0);g=`texture${v}_2d<${S}32>`}i.push(`@binding( ${A.binding++} ) @group( ${A.group} ) var ${l.name} : ${g};`)}else if(l.type==="buffer"||l.type==="storageBuffer"||l.type==="indirectStorageBuffer"){const p=l.node,g=this.getType(p.getNodeType(this)),v=p.bufferCount,x=v>0&&l.type==="buffer"?", "+v:"",S=p.isStorageBufferNode?`storage, ${this.getStorageAccess(p,e)}`:"uniform";if(this.isCustomStruct(l))r.push(`@binding( ${A.binding++} ) @group( ${A.group} ) var<${S}> ${l.name} : ${g};`);else{const w=`	value : array< ${p.isAtomic?`atomic<${g}>`:`${g}`}${x} >`;r.push(this._getWGSLStructBinding(l.name,w,S,A.binding++,A.group))}}else{const p=this.getType(this.getVectorType(l.type)),g=l.groupNode.name;(o[g]||(o[g]={index:A.binding++,id:A.group,snippets:[]})).snippets.push(`	${l.name} : ${p}`)}}for(const l in o){const u=o[l];s.push(this._getWGSLStructBinding(l,u.snippets.join(`,
`),"uniform",u.index,u.id))}let a=i.join(`
`);return a+=r.join(`
`),a+=s.join(`
`),a}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const i=e[t];i.uniforms=this.getUniforms(t),i.attributes=this.getAttributes(t),i.varyings=this.getVaryings(t),i.structs=this.getStructs(t),i.vars=this.getVars(t),i.codes=this.getCodes(t),i.directives=this.getDirectives(t),i.scopedArrays=this.getScopedArrays(t);let r=`// code

`;r+=this.flowCode[t];const s=this.flowNodes[t],o=s[s.length-1],a=o.outputNode,l=a!==void 0&&a.isOutputStructNode===!0;for(const u of s){const A=this.getFlowData(u),p=u.name;if(p&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${p}
`),r+=`${A.code}
	`,u===o&&t!=="compute"){if(r+=`// result

	`,t==="vertex")r+=`varyings.Vertex = ${A.result};`;else if(t==="fragment")if(l)i.returnType=a.getNodeType(this),i.structs+="var<private> output : "+i.returnType+";",r+=`return ${A.result};`;else{let g="	@location(0) color: vec4<f32>";const v=this.getBuiltins("output");v&&(g+=`,
	`+v),i.returnType="OutputStruct",i.structs+=this._getWGSLStruct("OutputStruct",g),i.structs+=`
var<private> output : OutputStruct;`,r+=`output.color = ${A.result};

	return output;`}}}i.flow=r}this.shaderStage=null,this.material!==null?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,t=null){let i;return t!==null&&(i=this._getWGSLMethod(e+"_"+t)),i===void 0&&(i=this._getWGSLMethod(e)),i||e}getType(e){return kce[e]||e}isAvailable(e){let t=xT[e];return t===void 0&&(e==="float32Filterable"?t=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(t=this.renderer.hasFeature("clip-distances")),xT[e]=t),t}_getWGSLMethod(e){return Io[e]!==void 0&&this._include(e),C0[e]}_include(e){const t=Io[e];return t.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${FL}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${t} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x + globalId.y * numWorkgroups.x * u32(${t}) + globalId.z * numWorkgroups.x * numWorkgroups.y * u32(${t});

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,i,r=0,s=0){const o=e+"Struct";return`${this._getWGSLStruct(o,t)}
@binding( ${r} ) @group( ${s} )
var<${i}> ${e} : ${o};`}}class Gce{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=ve.Depth24PlusStencil8:e.depth&&(t=ve.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const s=this.backend.renderer,o=s.getRenderTarget();t=o?o.samples:s.samples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const i=t>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:t,primarySamples:i?1:t,isMSAA:i}}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return yf.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return yf.LineList;if(e.isLine)return yf.LineStrip;if(e.isMesh)return yf.TriangleList}getSampleCount(e){let t=1;return e>1&&(t=Math.pow(2,Math.floor(Math.log2(e))),t===2&&(t=4)),t}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(e===void 0)return navigator.gpu.getPreferredCanvasFormat();if(e===ji)return ve.BGRA8Unorm;if(e===Mr)return ve.RGBA16Float;throw new Error("Unsupported outputType")}}const qce=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),zce=new Map([[K7,["float16"]]]),Hce=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class $ce{constructor(e){this.backend=e}createAttribute(e,t){const i=this._getBufferAttribute(e),r=this.backend,s=r.get(i);let o=s.buffer;if(o===void 0){const a=r.device;let l=i.array;if(e.normalized===!1){if(l.constructor===Int16Array||l.constructor===Int8Array)l=new Int32Array(l);else if((l.constructor===Uint16Array||l.constructor===Uint8Array)&&(l=new Uint32Array(l),t&GPUBufferUsage.INDEX))for(let A=0;A<l.length;A++)l[A]===65535&&(l[A]=4294967295)}if(i.array=l,(i.isStorageBufferAttribute||i.isStorageInstancedBufferAttribute)&&i.itemSize===3){l=new l.constructor(i.count*4);for(let A=0;A<i.count;A++)l.set(i.array.subarray(A*3,A*3+3),A*4);i.itemSize=4,i.array=l,s._force3to4BytesAlignment=!0}const u=l.byteLength+(4-l.byteLength%4)%4;o=a.createBuffer({label:i.name,size:u,usage:t,mappedAtCreation:!0}),new l.constructor(o.getMappedRange()).set(l),o.unmap(),s.buffer=o}}updateAttribute(e){const t=this._getBufferAttribute(e),i=this.backend,r=i.device,s=i.get(t),o=i.get(t).buffer;let a=t.array;if(s._force3to4BytesAlignment===!0){a=new a.constructor(t.count*4);for(let A=0;A<t.count;A++)a.set(t.array.subarray(A*3,A*3+3),A*4);t.array=a}const l=this._isTypedArray(a),u=t.updateRanges;if(u.length===0)r.queue.writeBuffer(o,0,a,0);else{const A=l?1:a.BYTES_PER_ELEMENT;for(let p=0,g=u.length;p<g;p++){const v=u[p];let x,S;if(s._force3to4BytesAlignment===!0){const w=Math.floor(v.start/3),R=Math.ceil(v.count/3);x=w*4*A,S=R*4*A}else x=v.start*A,S=v.count*A;const T=x*(l?a.BYTES_PER_ELEMENT:1);r.queue.writeBuffer(o,T,a,x,S)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),i=new Map;for(let r=0;r<t.length;r++){const s=t[r],o=s.array.BYTES_PER_ELEMENT,a=this._getBufferAttribute(s);let l=i.get(a);if(l===void 0){let p,g;s.isInterleavedBufferAttribute===!0?(p=s.data.stride*o,g=s.data.isInstancedInterleavedBuffer?Xm.Instance:Xm.Vertex):(p=s.itemSize*o,g=s.isInstancedBufferAttribute?Xm.Instance:Xm.Vertex),s.normalized===!1&&(s.array.constructor===Int16Array||s.array.constructor===Uint16Array)&&(p=4),l={arrayStride:p,attributes:[],stepMode:g},i.set(a,l)}const u=this._getVertexFormat(s),A=s.isInterleavedBufferAttribute===!0?s.offset*o:0;l.attributes.push({shaderLocation:r,offset:A,format:u})}return Array.from(i.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,i=t.device,s=t.get(this._getBufferAttribute(e)).buffer,o=s.size,a=i.createBuffer({label:`${e.name}_readback`,size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),l=i.createCommandEncoder({label:`readback_encoder_${e.name}`});l.copyBufferToBuffer(s,0,a,0,o);const u=l.finish();i.queue.submit([u]),await a.mapAsync(GPUMapMode.READ);const A=a.getMappedRange(),p=new e.array.constructor(A.slice(0));return a.unmap(),p.buffer}_getVertexFormat(e){const{itemSize:t,normalized:i}=e,r=e.array.constructor,s=e.constructor;let o;if(t===1)o=Hce.get(r);else{const l=(zce.get(s)||qce.get(r))[i?1:0];if(l){const u=r.BYTES_PER_ELEMENT*t,p=Math.floor((u+3)/4)*4/r.BYTES_PER_ELEMENT;if(p%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");o=`${l}x${p}`}}return o||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),o}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class Wce{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend,i=t.device,r=[];let s=0;for(const o of e.bindings){const a={binding:s++,visibility:o.visibility};if(o.isUniformBuffer||o.isStorageBuffer){const l={};o.isStorageBuffer&&(o.visibility&4&&(o.access===fs.READ_WRITE||o.access===fs.WRITE_ONLY)?l.type=av.Storage:l.type=av.ReadOnlyStorage),a.buffer=l}else if(o.isSampler){const l={};o.texture.isDepthTexture&&(o.texture.compareFunction!==null?l.type=gT.Comparison:t.compatibilityMode&&(l.type=gT.NonFiltering)),a.sampler=l}else if(o.isSampledTexture&&o.texture.isVideoTexture)a.externalTexture={};else if(o.isSampledTexture&&o.store){const l={};l.format=this.backend.get(o.texture).texture.format;const u=o.access;u===fs.READ_WRITE?l.access=lv.ReadWrite:u===fs.WRITE_ONLY?l.access=lv.WriteOnly:l.access=lv.ReadOnly,a.storageTexture=l}else if(o.isSampledTexture){const l={},{primarySamples:u}=t.utils.getTextureSampleData(o.texture);if(u>1&&(l.multisampled=!0,o.texture.isDepthTexture||(l.sampleType=_c.UnfilterableFloat)),o.texture.isDepthTexture)t.compatibilityMode&&o.texture.compareFunction===null?l.sampleType=_c.UnfilterableFloat:l.sampleType=_c.Depth;else if(o.texture.isDataTexture||o.texture.isDataArrayTexture||o.texture.isData3DTexture){const A=o.texture.type;A===Ir?l.sampleType=_c.SInt:A===bi?l.sampleType=_c.UInt:A===lr&&(this.backend.hasFeature("float32-filterable")?l.sampleType=_c.Float:l.sampleType=_c.UnfilterableFloat)}o.isSampledCubeTexture?l.viewDimension=Dr.Cube:o.texture.isDataArrayTexture||o.texture.isDepthArrayTexture||o.texture.isCompressedArrayTexture?l.viewDimension=Dr.TwoDArray:o.isSampledTexture3D&&(l.viewDimension=Dr.ThreeD),a.texture=l}else console.error(`WebGPUBindingUtils: Unsupported binding "${o}".`);r.push(a)}return i.createBindGroupLayout({entries:r})}createBindings(e,t,i,r=0){const{backend:s,bindGroupLayoutCache:o}=this,a=s.get(e);let l=o.get(e.bindingsReference);l===void 0&&(l=this.createBindingsLayout(e),o.set(e.bindingsReference,l));let u;i>0&&(a.groups===void 0&&(a.groups=[],a.versions=[]),a.versions[i]===r&&(u=a.groups[i])),u===void 0&&(u=this.createBindGroup(e,l),i>0&&(a.groups[i]=u,a.versions[i]=r)),a.group=u,a.layout=l}updateBinding(e){const t=this.backend,i=t.device,r=e.buffer,s=t.get(e).buffer;i.queue.writeBuffer(s,0,r,0)}createBindGroupIndex(e,t){const r=this.backend.device,s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,o=e[0],a=r.createBuffer({label:"bindingCameraIndex_"+o,size:16,usage:s});r.queue.writeBuffer(a,0,e,0);const l=[{binding:0,resource:{buffer:a}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+o,layout:t,entries:l})}createBindGroup(e,t){const i=this.backend,r=i.device;let s=0;const o=[];for(const a of e.bindings){if(a.isUniformBuffer){const l=i.get(a);if(l.buffer===void 0){const u=a.byteLength,A=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,p=r.createBuffer({label:"bindingBuffer_"+a.name,size:u,usage:A});l.buffer=p}o.push({binding:s,resource:{buffer:l.buffer}})}else if(a.isStorageBuffer){const l=i.get(a);if(l.buffer===void 0){const u=a.attribute;l.buffer=i.get(u).buffer}o.push({binding:s,resource:{buffer:l.buffer}})}else if(a.isSampler){const l=i.get(a.texture);o.push({binding:s,resource:l.sampler})}else if(a.isSampledTexture){const l=i.get(a.texture);let u;if(l.externalTexture!==void 0)u=r.importExternalTexture({source:l.externalTexture});else{const A=a.store?1:l.texture.mipLevelCount,p=`view-${l.texture.width}-${l.texture.height}-${A}`;if(u=l[p],u===void 0){const g=bce.All;let v;a.isSampledCubeTexture?v=Dr.Cube:a.isSampledTexture3D?v=Dr.ThreeD:a.texture.isDataArrayTexture||a.texture.isDepthArrayTexture||a.texture.isCompressedArrayTexture?v=Dr.TwoDArray:v=Dr.TwoD,u=l[p]=l.texture.createView({aspect:g,dimension:v,mipLevelCount:A})}}o.push({binding:s,resource:u})}s++}return r.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:o})}}class jce{constructor(e){this.backend=e}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:i,material:r,geometry:s,pipeline:o}=e,{vertexProgram:a,fragmentProgram:l}=o,u=this.backend,A=u.device,p=u.utils,g=u.get(o),v=[];for(const Q of e.getBindings()){const te=u.get(Q);v.push(te.layout)}const x=u.attributeUtils.createShaderVertexBuffers(e);let S;r.blending!==vo&&(r.blending!==Fs||r.transparent!==!1)&&(S=this._getBlending(r));let T={};r.stencilWrite===!0&&(T={compare:this._getStencilCompare(r),failOp:this._getStencilOperation(r.stencilFail),depthFailOp:this._getStencilOperation(r.stencilZFail),passOp:this._getStencilOperation(r.stencilZPass)});const w=this._getColorWriteMask(r),R=[];if(e.context.textures!==null){const Q=e.context.textures;for(let te=0;te<Q.length;te++){const K=p.getTextureFormatGPU(Q[te]);R.push({format:K,blend:S,writeMask:w})}}else{const Q=p.getCurrentColorFormat(e.context);R.push({format:Q,blend:S,writeMask:w})}const E=u.get(a).module,N=u.get(l).module,D=this._getPrimitiveState(i,s,r),B=this._getDepthCompare(r),I=p.getCurrentDepthStencilFormat(e.context),O=this._getSampleCount(e.context),L={label:`renderPipeline_${r.name||r.type}_${r.id}`,vertex:Object.assign({},E,{buffers:x}),fragment:Object.assign({},N,{targets:R}),primitive:D,multisample:{count:O,alphaToCoverageEnabled:r.alphaToCoverage&&O>1},layout:A.createPipelineLayout({bindGroupLayouts:v})},F={},V=e.context.depth,H=e.context.stencil;if((V===!0||H===!0)&&(V===!0&&(F.format=I,F.depthWriteEnabled=r.depthWrite,F.depthCompare=B),H===!0&&(F.stencilFront=T,F.stencilBack={},F.stencilReadMask=r.stencilFuncMask,F.stencilWriteMask=r.stencilWriteMask),r.polygonOffset===!0&&(F.depthBias=r.polygonOffsetUnits,F.depthBiasSlopeScale=r.polygonOffsetFactor,F.depthBiasClamp=0),L.depthStencil=F),t===null)g.pipeline=A.createRenderPipeline(L);else{const Q=new Promise(te=>{A.createRenderPipelineAsync(L).then(K=>{g.pipeline=K,te()})});t.push(Q)}}createBundleEncoder(e,t="renderBundleEncoder"){const i=this.backend,{utils:r,device:s}=i,o=r.getCurrentDepthStencilFormat(e),a=r.getCurrentColorFormat(e),l=this._getSampleCount(e),u={label:t,colorFormats:[a],depthStencilFormat:o,sampleCount:l};return s.createRenderBundleEncoder(u)}createComputePipeline(e,t){const i=this.backend,r=i.device,s=i.get(e.computeProgram).module,o=i.get(e),a=[];for(const l of t){const u=i.get(l);a.push(u.layout)}o.pipeline=r.createComputePipeline({compute:s,layout:r.createPipelineLayout({bindGroupLayouts:a})})}_getBlending(e){let t,i;const r=e.blending,s=e.blendSrc,o=e.blendDst,a=e.blendEquation;if(r===Cf){const l=e.blendSrcAlpha!==null?e.blendSrcAlpha:s,u=e.blendDstAlpha!==null?e.blendDstAlpha:o,A=e.blendEquationAlpha!==null?e.blendEquationAlpha:a;t={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(a)},i={srcFactor:this._getBlendFactor(l),dstFactor:this._getBlendFactor(u),operation:this._getBlendOperation(A)}}else{const l=e.premultipliedAlpha,u=(A,p,g,v)=>{t={srcFactor:A,dstFactor:p,operation:gc.Add},i={srcFactor:g,dstFactor:v,operation:gc.Add}};if(l)switch(r){case Fs:u(yn.One,yn.OneMinusSrcAlpha,yn.One,yn.OneMinusSrcAlpha);break;case Qc:u(yn.One,yn.One,yn.One,yn.One);break;case Vf:u(yn.Zero,yn.OneMinusSrc,yn.Zero,yn.One);break;case Gf:u(yn.Zero,yn.Src,yn.Zero,yn.SrcAlpha);break}else switch(r){case Fs:u(yn.SrcAlpha,yn.OneMinusSrcAlpha,yn.One,yn.OneMinusSrcAlpha);break;case Qc:u(yn.SrcAlpha,yn.One,yn.SrcAlpha,yn.One);break;case Vf:u(yn.Zero,yn.OneMinusSrc,yn.Zero,yn.One);break;case Gf:u(yn.Zero,yn.Src,yn.Zero,yn.Src);break}}if(t!==void 0&&i!==void 0)return{color:t,alpha:i};console.error("THREE.WebGPURenderer: Invalid blending: ",r)}_getBlendFactor(e){let t;switch(e){case xl:t=yn.Zero;break;case Tx:t=yn.One;break;case Mx:t=yn.Src;break;case Ex:t=yn.OneMinusSrc;break;case id:t=yn.SrcAlpha;break;case rd:t=yn.OneMinusSrcAlpha;break;case Nx:t=yn.Dst;break;case Px:t=yn.OneMinusDstColor;break;case Cx:t=yn.DstAlpha;break;case Rx:t=yn.OneMinusDstAlpha;break;case Lx:t=yn.SrcAlphaSaturated;break;case Jre:t=yn.Constant;break;case ese:t=yn.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const i=e.stencilFunc;switch(i){case NG:t=qr.Never;break;case Iv:t=qr.Always;break;case PG:t=qr.Less;break;case DG:t=qr.LessEqual;break;case LG:t=qr.Equal;break;case FG:t=qr.GreaterEqual;break;case IG:t=qr.Greater;break;case BG:t=qr.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",i)}return t}_getStencilOperation(e){let t;switch(e){case bc:t=mu.Keep;break;case wG:t=mu.Zero;break;case SG:t=mu.Replace;break;case RG:t=mu.Invert;break;case TG:t=mu.IncrementClamp;break;case MG:t=mu.DecrementClamp;break;case EG:t=mu.IncrementWrap;break;case CG:t=mu.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case cs:t=gc.Add;break;case wx:t=gc.Subtract;break;case Sx:t=gc.ReverseSubtract;break;case k7:t=gc.Min;break;case V7:t=gc.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,i){const r={},s=this.backend.utils;switch(r.topology=s.getPrimitiveTopology(e,i),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?mA.Uint16:mA.Uint32),i.side){case Xs:r.frontFace=rv.CCW,r.cullMode=sv.Back;break;case _i:r.frontFace=rv.CCW,r.cullMode=sv.Front;break;case _r:r.frontFace=rv.CCW,r.cullMode=sv.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",i.side);break}return r}_getColorWriteMask(e){return e.colorWrite===!0?mT.All:mT.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=qr.Always;else{const i=e.depthFunc;switch(i){case sd:t=qr.Never;break;case od:t=qr.Always;break;case ad:t=qr.Less;break;case Ou:t=qr.LessEqual;break;case ld:t=qr.Equal;break;case ud:t=qr.GreaterEqual;break;case cd:t=qr.Greater;break;case hd:t=qr.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",i)}}return t}}class Xce extends BL{constructor(e,t,i=2048){super(i),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const r=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return fa(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e.id,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,i=t*8;this.currentQueryIndex=0,this.queryOffsets.clear();const r=this.device.createCommandEncoder();r.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),r.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,i);const s=r.finish();if(this.device.queue.submit([s]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,i),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const o=new BigUint64Array(this.resultBuffer.getMappedRange(0,i));let a=0;for(const[,l]of e){const u=o[l],A=o[l+1],p=Number(A-u)/1e6;a+=p}return this.resultBuffer.unmap(),this.lastValue=a,a}catch(e){return console.error("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class Qce extends IL{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new Gce(this),this.attributeUtils=new $ce(this),this.bindingUtils=new Wce(this),this.pipelineUtils=new jce(this),this.textureUtils=new Pce(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let i;if(t.device===void 0){const o={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},a=typeof navigator<"u"?await navigator.gpu.requestAdapter(o):null;if(a===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const l=Object.values(jy),u=[];for(const p of l)a.features.has(p)&&u.push(p);const A={requiredFeatures:u,requiredLimits:t.requiredLimits};i=await a.requestDevice(A)}else i=t.device;i.lost.then(o=>{const a={api:"WebGPU",message:o.message||"Unknown reason",reason:o.reason||null,originalEvent:o};e.onDeviceLost(a)});const r=t.context!==void 0?t.context:e.domElement.getContext("webgpu");this.device=i,this.context=r;const s=t.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(jy.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:s}),this.updateSize()}get coordinateSystem(){return Za}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const i=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(i.depth,i.stencil).createView()});const r=e.colorAttachments[0];this.renderer.samples>0?r.view=this.colorBuffer.createView():r.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isDepthArrayTexture&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const i=e.renderTarget,r=this.get(i);let s=r.descriptors;if(s===void 0||r.width!==i.width||r.height!==i.height||r.dimensions!==i.dimensions||r.activeMipmapLevel!==e.activeMipmapLevel||r.activeCubeFace!==e.activeCubeFace||r.samples!==i.samples){s={},r.descriptors=s;const u=()=>{i.removeEventListener("dispose",u),this.delete(i)};i.hasEventListener("dispose",u)===!1&&i.addEventListener("dispose",u)}const o=e.getCacheKey();let a=s[o];if(a===void 0){const u=e.textures,A=[];let p;const g=this._isRenderCameraDepthArray(e);for(let v=0;v<u.length;v++){const x=this.get(u[v]),S={label:`colorAttachment_${v}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:Dr.TwoD};if(i.isRenderTarget3D)p=e.activeCubeFace,S.baseArrayLayer=0,S.dimension=Dr.ThreeD,S.depthOrArrayLayers=u[v].image.depth;else if(i.isRenderTargetArray)if(g===!0){const T=e.camera.cameras;for(let w=0;w<T.length;w++){const R={...S,baseArrayLayer:w,arrayLayerCount:1,dimension:Dr.TwoD},E=x.texture.createView(R);A.push({view:E,resolveTarget:void 0,depthSlice:void 0})}}else S.dimension=Dr.TwoDArray,S.depthOrArrayLayers=u[v].image.depth;if(g!==!0){const T=x.texture.createView(S);let w,R;x.msaaTexture!==void 0?(w=x.msaaTexture.createView(),R=T):(w=T,R=void 0),A.push({view:w,resolveTarget:R,depthSlice:p})}}if(a={textureViews:A},e.depth){const v=this.get(e.depthTexture),x={};e.depthTexture.isDepthArrayTexture&&(x.dimension=Dr.TwoD,x.arrayLayerCount=1,x.baseArrayLayer=e.activeCubeFace),a.depthStencilView=v.texture.createView(x)}s[o]=a,r.width=i.width,r.height=i.height,r.samples=i.samples,r.activeMipmapLevel=e.activeMipmapLevel,r.activeCubeFace=e.activeCubeFace,r.dimensions=i.dimensions}const l={colorAttachments:[]};for(let u=0;u<a.textureViews.length;u++){const A=a.textureViews[u];let p={r:0,g:0,b:0,a:1};u===0&&t.clearValue&&(p=t.clearValue),l.colorAttachments.push({view:A.view,depthSlice:A.depthSlice,resolveTarget:A.resolveTarget,loadOp:t.loadOp||ni.Load,storeOp:t.storeOp||Ss.Store,clearValue:p})}return a.depthStencilView&&(l.depthStencilAttachment={view:a.depthStencilView}),l}beginRender(e){const t=this.get(e),i=this.device,r=e.occlusionQueryCount;let s;r>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,s=i.createQuerySet({type:"occlusion",count:r,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=s,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(r),t.lastOcclusionObject=null);let o;e.textures===null?o=this._getDefaultRenderPassDescriptor():o=this._getRenderPassDescriptor(e,{loadOp:ni.Load}),this.initTimestampQuery(e,o),o.occlusionQuerySet=s;const a=o.depthStencilAttachment;if(e.textures!==null){const u=o.colorAttachments;for(let A=0;A<u.length;A++){const p=u[A];e.clearColor?(p.clearValue=A===0?e.clearColorValue:{r:0,g:0,b:0,a:1},p.loadOp=ni.Clear):p.loadOp=ni.Load,p.storeOp=Ss.Store}}else{const u=o.colorAttachments[0];e.clearColor?(u.clearValue=e.clearColorValue,u.loadOp=ni.Clear):u.loadOp=ni.Load,u.storeOp=Ss.Store}e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=ni.Clear):a.depthLoadOp=ni.Load,a.depthStoreOp=Ss.Store),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=ni.Clear):a.stencilLoadOp=ni.Load,a.stencilStoreOp=Ss.Store);const l=i.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const u=e.camera.cameras;!t.layerDescriptors||t.layerDescriptors.length!==u.length?this._createDepthLayerDescriptors(e,t,o,u):this._updateDepthLayerDescriptors(e,t,u),t.bundleEncoders=[],t.bundleSets=[];for(let A=0;A<u.length;A++){const p=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+A),g={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(p),t.bundleSets.push(g)}t.currentPass=null}else{const u=l.beginRenderPass(o);if(t.currentPass=u,e.viewport&&this.updateViewport(e),e.scissor){const{x:A,y:p,width:g,height:v}=e.scissorValue;u.setScissorRect(A,p,g,v)}}t.descriptor=o,t.encoder=l,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,i,r){const s=i.depthStencilAttachment;t.layerDescriptors=[];const o=this.get(e.depthTexture);o.viewCache||(o.viewCache=[]);for(let a=0;a<r.length;a++){const l={...i,colorAttachments:[{...i.colorAttachments[0],view:i.colorAttachments[a].view}]};if(i.depthStencilAttachment){const u=a;o.viewCache[u]||(o.viewCache[u]=o.texture.createView({dimension:Dr.TwoD,baseArrayLayer:a,arrayLayerCount:1})),l.depthStencilAttachment={view:o.viewCache[u],depthLoadOp:s.depthLoadOp||ni.Clear,depthStoreOp:s.depthStoreOp||Ss.Store,depthClearValue:s.depthClearValue||1},e.stencil&&(l.depthStencilAttachment.stencilLoadOp=s.stencilLoadOp,l.depthStencilAttachment.stencilStoreOp=s.stencilStoreOp,l.depthStencilAttachment.stencilClearValue=s.stencilClearValue)}else l.depthStencilAttachment={...s};t.layerDescriptors.push(l)}}_updateDepthLayerDescriptors(e,t,i){for(let r=0;r<i.length;r++){const s=t.layerDescriptors[r];if(s.depthStencilAttachment){const o=s.depthStencilAttachment;e.depth&&(e.clearDepth?(o.depthClearValue=e.clearDepthValue,o.depthLoadOp=ni.Clear):o.depthLoadOp=ni.Load),e.stencil&&(e.clearStencil?(o.stencilClearValue=e.clearStencilValue,o.stencilLoadOp=ni.Clear):o.stencilLoadOp=ni.Load)}}}finishRender(e){const t=this.get(e),i=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),i>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const r=t.encoder;if(this._isRenderCameraDepthArray(e)===!0){const s=[];for(let o=0;o<t.bundleEncoders.length;o++){const a=t.bundleEncoders[o];s.push(a.finish())}for(let o=0;o<t.layerDescriptors.length;o++)if(o<s.length){const a=t.layerDescriptors[o],l=r.beginRenderPass(a);if(e.viewport){const{x:u,y:A,width:p,height:g,minDepth:v,maxDepth:x}=e.viewportValue;l.setViewport(u,A,p,g,v,x)}if(e.scissor){const{x:u,y:A,width:p,height:g}=e.scissorValue;l.setScissorRect(u,A,p,g)}l.executeBundles([s[o]]),l.end()}}else t.currentPass&&t.currentPass.end();if(i>0){const s=i*8;let o=this.occludedResolveCache.get(s);o===void 0&&(o=this.device.createBuffer({size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(s,o));const a=this.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,i,o,0),t.encoder.copyBufferToBuffer(o,0,a,0,s),t.occlusionQueryBuffer=a,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const s=e.textures;for(let o=0;o<s.length;o++){const a=s[o];a.generateMipmaps===!0&&this.textureUtils.generateMipmaps(a)}}}isOccluded(e,t){const i=this.get(e);return i.occluded&&i.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:i,currentOcclusionQueryObjects:r}=t;if(i&&r){const s=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await i.mapAsync(GPUMapMode.READ);const o=i.getMappedRange(),a=new BigUint64Array(o);for(let l=0;l<r.length;l++)a[l]===BigInt(0)&&s.add(r[l]);i.destroy(),t.occluded=s}}updateViewport(e){const{currentPass:t}=this.get(e),{x:i,y:r,width:s,height:o,minDepth:a,maxDepth:l}=e.viewportValue;t.setViewport(i,r,s,o,a,l)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,i,r=null){const s=this.device,o=this.renderer;let a=[],l,u,A,p;if(e){const x=this.getClearColor();u={r:x.r,g:x.g,b:x.b,a:x.a}}if(r===null){A=o.depth,p=o.stencil;const x=this._getDefaultRenderPassDescriptor();if(e){a=x.colorAttachments;const S=a[0];S.clearValue=u,S.loadOp=ni.Clear,S.storeOp=Ss.Store}(A||p)&&(l=x.depthStencilAttachment)}else{A=r.depth,p=r.stencil;const x={loadOp:e?ni.Clear:ni.Load,clearValue:e?u:void 0};A&&(x.depthLoadOp=t?ni.Clear:ni.Load,x.depthClearValue=t?o.getClearDepth():void 0,x.depthStoreOp=Ss.Store),p&&(x.stencilLoadOp=i?ni.Clear:ni.Load,x.stencilClearValue=i?o.getClearStencil():void 0,x.stencilStoreOp=Ss.Store);const S=this._getRenderPassDescriptor(r,x);a=S.colorAttachments,l=S.depthStencilAttachment}A&&l&&l.depthLoadOp===void 0&&(t?(l.depthLoadOp=ni.Clear,l.depthClearValue=o.getClearDepth(),l.depthStoreOp=Ss.Store):(l.depthLoadOp=ni.Load,l.depthStoreOp=Ss.Store)),p&&l&&l.stencilLoadOp===void 0&&(i?(l.stencilLoadOp=ni.Clear,l.stencilClearValue=o.getClearStencil(),l.stencilStoreOp=Ss.Store):(l.stencilLoadOp=ni.Load,l.stencilStoreOp=Ss.Store));const g=s.createCommandEncoder({label:"clear"});g.beginRenderPass({colorAttachments:a,depthStencilAttachment:l}).end(),s.queue.submit([g.finish()])}beginCompute(e){const t=this.get(e),i={label:"computeGroup_"+e.id};this.initTimestampQuery(e,i),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(i)}compute(e,t,i,r){const{passEncoderGPU:s}=this.get(e),o=this.get(r).pipeline;s.setPipeline(o);for(let A=0,p=i.length;A<p;A++){const g=i[A],v=this.get(g);s.setBindGroup(A,v.group)}const a=this.device.limits.maxComputeWorkgroupsPerDimension,l=this.get(t);l.dispatchSize===void 0&&(l.dispatchSize={x:0,y:1,z:1});const{dispatchSize:u}=l;t.dispatchCount>a?(u.x=Math.min(t.dispatchCount,a),u.y=Math.ceil(t.dispatchCount/a)):u.x=t.dispatchCount,s.dispatchWorkgroups(u.x,u.y,u.z)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:i,material:r,context:s,pipeline:o}=e,a=e.getBindings(),l=this.get(s),u=this.get(o).pipeline,A=e.getIndex(),p=A!==null,g=e.getDrawParameters();if(g===null)return;const v=(S,T)=>{S.setPipeline(u),T.pipeline=u;const w=T.bindingGroups;for(let E=0,N=a.length;E<N;E++){const D=a[E],B=this.get(D);w[D.index]!==D.id&&(S.setBindGroup(D.index,B.group),w[D.index]=D.id)}if(p===!0&&T.index!==A){const E=this.get(A).buffer,N=A.array instanceof Uint16Array?mA.Uint16:mA.Uint32;S.setIndexBuffer(E,N),T.index=A}const R=e.getVertexBuffers();for(let E=0,N=R.length;E<N;E++){const D=R[E];if(T.attributes[E]!==D){const B=this.get(D).buffer;S.setVertexBuffer(E,B),T.attributes[E]=D}}s.stencil===!0&&r.stencilWrite===!0&&l.currentStencilRef!==r.stencilRef&&(S.setStencilReference(r.stencilRef),l.currentStencilRef=r.stencilRef)},x=(S,T)=>{if(v(S,T),i.isBatchedMesh===!0){const w=i._multiDrawStarts,R=i._multiDrawCounts,E=i._multiDrawCount,N=i._multiDrawInstances;N!==null&&fa("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let D=0;D<E;D++){const B=N?N[D]:1,I=B>1?0:D;p===!0?S.drawIndexed(R[D],B,w[D]/A.array.BYTES_PER_ELEMENT,0,I):S.draw(R[D],B,w[D],I),t.update(i,R[D],B)}}else if(p===!0){const{vertexCount:w,instanceCount:R,firstVertex:E}=g,N=e.getIndirect();if(N!==null){const D=this.get(N).buffer;S.drawIndexedIndirect(D,0)}else S.drawIndexed(w,R,E,0,0);t.update(i,w,R)}else{const{vertexCount:w,instanceCount:R,firstVertex:E}=g,N=e.getIndirect();if(N!==null){const D=this.get(N).buffer;S.drawIndirect(D,0)}else S.draw(w,R,E,0);t.update(i,w,R)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const S=this.get(e.camera),T=e.camera.cameras,w=e.getBindingGroup("cameraIndex");if(S.indexesGPU===void 0||S.indexesGPU.length!==T.length){const E=this.get(w),N=[],D=new Uint32Array([0,0,0,0]);for(let B=0,I=T.length;B<I;B++){D[0]=B;const O=this.bindingUtils.createBindGroupIndex(D,E.layout);N.push(O)}S.indexesGPU=N}const R=this.renderer.getPixelRatio();for(let E=0,N=T.length;E<N;E++){const D=T[E];if(i.layers.test(D.layers)){const B=D.viewport;let I=l.currentPass,O=l.currentSets;if(l.bundleEncoders){const L=l.bundleEncoders[E],F=l.bundleSets[E];I=L,O=F}B&&I.setViewport(Math.floor(B.x*R),Math.floor(B.y*R),Math.floor(B.width*R),Math.floor(B.height*R),s.viewportValue.minDepth,s.viewportValue.maxDepth),w&&S.indexesGPU&&(I.setBindGroup(w.index,S.indexesGPU[E]),O.bindingGroups[w.index]=w.id),x(I,O)}}}else if(l.currentPass){if(l.occlusionQuerySet!==void 0){const S=l.lastOcclusionObject;S!==i&&(S!==null&&S.occlusionTest===!0&&(l.currentPass.endOcclusionQuery(),l.occlusionQueryIndex++),i.occlusionTest===!0&&(l.currentPass.beginOcclusionQuery(l.occlusionQueryIndex),l.occlusionQueryObjects[l.occlusionQueryIndex]=i),l.lastOcclusionObject=i)}x(l.currentPass,l.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:i,material:r}=e,s=this.utils,o=s.getSampleCountRenderContext(e.context),a=s.getCurrentColorSpace(e.context),l=s.getCurrentColorFormat(e.context),u=s.getCurrentDepthStencilFormat(e.context),A=s.getPrimitiveTopology(i,r);let p=!1;return(t.material!==r||t.materialVersion!==r.version||t.transparent!==r.transparent||t.blending!==r.blending||t.premultipliedAlpha!==r.premultipliedAlpha||t.blendSrc!==r.blendSrc||t.blendDst!==r.blendDst||t.blendEquation!==r.blendEquation||t.blendSrcAlpha!==r.blendSrcAlpha||t.blendDstAlpha!==r.blendDstAlpha||t.blendEquationAlpha!==r.blendEquationAlpha||t.colorWrite!==r.colorWrite||t.depthWrite!==r.depthWrite||t.depthTest!==r.depthTest||t.depthFunc!==r.depthFunc||t.stencilWrite!==r.stencilWrite||t.stencilFunc!==r.stencilFunc||t.stencilFail!==r.stencilFail||t.stencilZFail!==r.stencilZFail||t.stencilZPass!==r.stencilZPass||t.stencilFuncMask!==r.stencilFuncMask||t.stencilWriteMask!==r.stencilWriteMask||t.side!==r.side||t.alphaToCoverage!==r.alphaToCoverage||t.sampleCount!==o||t.colorSpace!==a||t.colorFormat!==l||t.depthStencilFormat!==u||t.primitiveTopology!==A||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=o,t.colorSpace=a,t.colorFormat=l,t.depthStencilFormat=u,t.primitiveTopology=A,t.clippingContextCacheKey=e.clippingContextCacheKey,p=!0),p}getRenderCacheKey(e){const{object:t,material:i}=e,r=this.utils,s=e.context;return[i.transparent,i.blending,i.premultipliedAlpha,i.blendSrc,i.blendDst,i.blendEquation,i.blendSrcAlpha,i.blendDstAlpha,i.blendEquationAlpha,i.colorWrite,i.depthWrite,i.depthTest,i.depthFunc,i.stencilWrite,i.stencilFunc,i.stencilFail,i.stencilZFail,i.stencilZPass,i.stencilFuncMask,i.stencilWriteMask,i.side,r.getSampleCountRenderContext(s),r.getCurrentColorSpace(s),r.getCurrentColorFormat(s),r.getCurrentDepthStencilFormat(s),r.getPrimitiveTopology(t,i),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,i,r,s,o){return this.textureUtils.copyTextureToBuffer(e,t,i,r,s,o)}initTimestampQuery(e,t){if(!this.trackTimestamp)return;const i=e.isComputeNode?"compute":"render";this.timestampQueryPool[i]||(this.timestampQueryPool[i]=new Xce(this.device,i,2048));const r=this.timestampQueryPool[i],s=r.allocateQueriesForContext(e);t.timestampWrites={querySet:r.querySet,beginningOfPassWriteIndex:s,endOfPassWriteIndex:s+1}}createNodeBuilder(e,t){return new Vce(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const i=this.get(e),s=i.currentPass.finish();this.get(t).bundleGPU=s,i.currentSets=i._currentSets,i.currentPass=i._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,i,r){this.bindingUtils.createBindings(e,t,i,r)}updateBindings(e,t,i,r){this.bindingUtils.createBindings(e,t,i,r)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,i=null,r=null,s=0,o=0){let a=0,l=0,u=0,A=0,p=0,g=0,v=e.image.width,x=e.image.height,S=1;i!==null&&(i.isBox3===!0?(A=i.min.x,p=i.min.y,g=i.min.z,v=i.max.x-i.min.x,x=i.max.y-i.min.y,S=i.max.z-i.min.z):(A=i.min.x,p=i.min.y,v=i.max.x-i.min.x,x=i.max.y-i.min.y,S=1)),r!==null&&(a=r.x,l=r.y,u=r.z||0);const T=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),w=this.get(e).texture,R=this.get(t).texture;T.copyTextureToTexture({texture:w,mipLevel:s,origin:{x:A,y:p,z:g}},{texture:R,mipLevel:o,origin:{x:a,y:l,z:u}},[v,x,S]),this.device.queue.submit([T.finish()]),o===0&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,i){const r=this.get(t);let s=null;t.renderTarget?e.isDepthTexture?s=this.get(t.depthTexture).texture:s=this.get(t.textures[0]).texture:e.isDepthTexture?s=this.textureUtils.getDepthBuffer(t.depth,t.stencil):s=this.context.getCurrentTexture();const o=this.get(e).texture;if(s.format!==o.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",s.format,o.format);return}let a;if(r.currentPass?(r.currentPass.end(),a=r.encoder):a=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),a.copyTextureToTexture({texture:s,origin:[i.x,i.y,0]},{texture:o},[i.z,i.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e),r.currentPass){const{descriptor:l}=r;for(let u=0;u<l.colorAttachments.length;u++)l.colorAttachments[u].loadOp=ni.Load;if(t.depth&&(l.depthStencilAttachment.depthLoadOp=ni.Load),t.stencil&&(l.depthStencilAttachment.stencilLoadOp=ni.Load),r.currentPass=a.beginRenderPass(l),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){const{x:u,y:A,width:p,height:g}=t.scissorValue;r.currentPass.setScissorRect(u,A,p,g)}}else this.device.queue.submit([a.finish()])}}class Yce extends vE{constructor(e,t,i,r,s,o){super(e,t,i,r,s,o),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class Zce extends EL{constructor(){super(),this.addMaterial(Xie,"MeshPhongMaterial"),this.addMaterial(vP,"MeshStandardMaterial"),this.addMaterial(Dre,"MeshPhysicalMaterial"),this.addMaterial(Ure,"MeshToonMaterial"),this.addMaterial(Gie,"MeshBasicMaterial"),this.addMaterial(Wie,"MeshLambertMaterial"),this.addMaterial(Bie,"MeshNormalMaterial"),this.addMaterial(Vre,"MeshMatcapMaterial"),this.addMaterial(Cie,"LineBasicMaterial"),this.addMaterial(Nie,"LineDashedMaterial"),this.addMaterial(Hre,"PointsMaterial"),this.addMaterial(xP,"SpriteMaterial"),this.addMaterial(jre,"ShadowMaterial"),this.addLight(zae,xz),this.addLight(Nue,yE),this.addLight(Pue,wz),this.addLight(TL,vE),this.addLight(Due,xE),this.addLight(Iue,_z),this.addLight(Bue,Tz),this.addLight(Lue,Yce),this.addToneMapping(qP,z7),this.addToneMapping(zP,H7),this.addToneMapping(HP,$7),this.addToneMapping($P,W7),this.addToneMapping(WP,j7),this.addToneMapping(jP,X7)}}class Kce extends ece{constructor(e={}){let t;e.forceWebGL?t=pT:(t=Qce,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new pT(e)));const i=new t(e);super(i,e),this.library=new Zce,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */U.BRDF_GGX;U.BRDF_Lambert;U.BasicShadowFilter;U.Break;U.Continue;U.DFGApprox;U.D_GGX;U.Discard;U.EPSILON;U.F_Schlick;const Jce=U.Fn;U.INFINITY;const ehe=U.If;U.Switch;const the=U.Loop;U.NodeShaderStage;U.NodeType;U.NodeUpdateType;U.NodeAccess;U.PCFShadowFilter;U.PCFSoftShadowFilter;U.PI;U.PI2;U.Return;U.Schlick_to_F0;U.ScriptableNodeResources;U.ShaderNode;U.TBNViewMatrix;U.VSMShadowFilter;U.V_GGX_SmithCorrelated;U.abs;U.acesFilmicToneMapping;U.acos;U.add;U.addNodeElement;U.agxToneMapping;U.all;U.alphaT;U.and;U.anisotropy;U.anisotropyB;U.anisotropyT;U.any;U.append;U.array;U.arrayBuffer;const nhe=U.asin;U.assign;U.atan;U.atan2;U.atomicAdd;U.atomicAnd;U.atomicFunc;U.atomicMax;U.atomicMin;U.atomicOr;U.atomicStore;U.atomicSub;U.atomicXor;U.atomicLoad;U.attenuationColor;U.attenuationDistance;U.attribute;U.attributeArray;U.backgroundBlurriness;U.backgroundIntensity;U.backgroundRotation;U.batch;U.billboarding;U.bitAnd;U.bitNot;U.bitOr;U.bitXor;U.bitangentGeometry;U.bitangentLocal;U.bitangentView;U.bitangentWorld;U.bitcast;U.blendBurn;U.blendColor;U.blendDodge;U.blendOverlay;U.blendScreen;U.blur;U.bool;U.buffer;U.bufferAttribute;U.bumpMap;U.burn;U.bvec2;U.bvec3;U.bvec4;U.bypass;U.cache;U.call;U.cameraFar;U.cameraIndex;U.cameraNear;U.cameraNormalMatrix;U.cameraPosition;U.cameraProjectionMatrix;U.cameraProjectionMatrixInverse;U.cameraViewMatrix;U.cameraWorldMatrix;U.cbrt;U.cdl;U.ceil;U.checker;U.cineonToneMapping;U.clamp;U.clearcoat;U.clearcoatRoughness;U.code;U.color;U.colorSpaceToWorking;U.colorToDirection;U.compute;U.computeSkinning;U.cond;U.Const;U.context;U.convert;U.convertColorSpace;U.convertToTexture;const ihe=U.cos;U.cross;U.cubeTexture;U.dFdx;U.dFdy;U.dashSize;U.debug;U.decrement;U.decrementBefore;U.defaultBuildStages;U.defaultShaderStages;U.defined;U.degrees;U.deltaTime;U.densityFog;U.densityFogFactor;U.depth;U.depthPass;U.difference;U.diffuseColor;U.directPointLight;U.directionToColor;U.dispersion;U.distance;U.div;U.dodge;U.dot;U.drawIndex;U.dynamicBufferAttribute;U.element;U.emissive;U.equal;U.equals;U.equirectUV;const rhe=U.exp;U.exp2;U.expression;U.faceDirection;U.faceForward;U.faceforward;const she=U.float;U.floor;U.fog;U.fract;U.frameGroup;U.frameId;U.frontFacing;U.fwidth;U.gain;U.gapSize;U.getConstNodeType;U.getCurrentStack;U.getDirection;U.getDistanceAttenuation;U.getGeometryRoughness;U.getNormalFromDepth;U.getParallaxCorrectNormal;U.getRoughness;U.getScreenPosition;U.getShIrradianceAt;U.getTextureIndex;U.getViewPosition;U.getShadowMaterial;U.getShadowRenderObjectFunction;U.glsl;U.glslFn;U.grayscale;U.greaterThan;U.greaterThanEqual;U.hash;U.highpModelNormalViewMatrix;U.highpModelViewMatrix;U.hue;U.increment;U.incrementBefore;U.instance;const ohe=U.instanceIndex;U.instancedArray;U.instancedBufferAttribute;U.instancedDynamicBufferAttribute;U.instancedMesh;U.int;U.inverseSqrt;U.inversesqrt;U.invocationLocalIndex;U.invocationSubgroupIndex;U.ior;U.iridescence;U.iridescenceIOR;U.iridescenceThickness;U.ivec2;U.ivec3;U.ivec4;U.js;U.label;U.length;U.lengthSq;U.lessThan;U.lessThanEqual;U.lightPosition;U.lightShadowMatrix;U.lightTargetDirection;U.lightTargetPosition;U.lightViewPosition;U.lightingContext;U.lights;U.linearDepth;U.linearToneMapping;U.localId;U.globalId;U.log;U.log2;U.logarithmicDepthToViewZ;U.loop;U.luminance;U.mediumpModelViewMatrix;U.mat2;U.mat3;U.mat4;U.matcapUV;U.materialAO;U.materialAlphaTest;U.materialAnisotropy;U.materialAnisotropyVector;U.materialAttenuationColor;U.materialAttenuationDistance;U.materialClearcoat;U.materialClearcoatNormal;U.materialClearcoatRoughness;U.materialColor;U.materialDispersion;U.materialEmissive;U.materialIOR;U.materialIridescence;U.materialIridescenceIOR;U.materialIridescenceThickness;U.materialLightMap;U.materialLineDashOffset;U.materialLineDashSize;U.materialLineGapSize;U.materialLineScale;U.materialLineWidth;U.materialMetalness;U.materialNormal;U.materialOpacity;U.materialPointSize;U.materialReference;U.materialReflectivity;U.materialRefractionRatio;U.materialRotation;U.materialRoughness;U.materialSheen;U.materialSheenRoughness;U.materialShininess;U.materialSpecular;U.materialSpecularColor;U.materialSpecularIntensity;U.materialSpecularStrength;U.materialThickness;U.materialTransmission;U.max;U.maxMipLevel;U.metalness;U.min;U.mix;U.mixElement;U.mod;U.modInt;U.modelDirection;U.modelNormalMatrix;U.modelPosition;U.modelRadius;U.modelScale;U.modelViewMatrix;U.modelViewPosition;U.modelViewProjection;U.modelWorldMatrix;U.modelWorldMatrixInverse;U.morphReference;U.mrt;U.mul;U.mx_aastep;U.mx_cell_noise_float;U.mx_contrast;U.mx_fractal_noise_float;U.mx_fractal_noise_vec2;U.mx_fractal_noise_vec3;U.mx_fractal_noise_vec4;U.mx_hsvtorgb;U.mx_noise_float;U.mx_noise_vec3;U.mx_noise_vec4;U.mx_ramplr;U.mx_ramptb;U.mx_rgbtohsv;U.mx_safepower;U.mx_splitlr;U.mx_splittb;U.mx_srgb_texture_to_lin_rec709;U.mx_transform_uv;U.mx_worley_noise_float;U.mx_worley_noise_vec2;U.mx_worley_noise_vec3;const ahe=U.negate;U.neutralToneMapping;U.nodeArray;U.nodeImmutable;U.nodeObject;U.nodeObjects;U.nodeProxy;U.normalFlat;U.normalGeometry;U.normalLocal;U.normalMap;U.normalView;U.normalWorld;U.normalize;U.not;U.notEqual;U.numWorkgroups;U.objectDirection;U.objectGroup;U.objectPosition;U.objectRadius;U.objectScale;U.objectViewPosition;U.objectWorldMatrix;U.oneMinus;U.or;U.orthographicDepthToViewZ;U.oscSawtooth;U.oscSine;U.oscSquare;U.oscTriangle;U.output;U.outputStruct;U.overlay;U.overloadingFn;U.parabola;U.parallaxDirection;U.parallaxUV;U.parameter;U.pass;U.passTexture;U.pcurve;U.perspectiveDepthToViewZ;U.pmremTexture;U.pointUV;U.pointWidth;U.positionGeometry;U.positionLocal;U.positionPrevious;U.positionView;U.positionViewDirection;U.positionWorld;U.positionWorldDirection;U.posterize;U.pow;U.pow2;U.pow3;U.pow4;U.property;U.radians;U.rand;U.range;U.rangeFog;U.rangeFogFactor;U.reciprocal;U.lightProjectionUV;U.reference;U.referenceBuffer;U.reflect;U.reflectVector;U.reflectView;U.reflector;U.refract;U.refractVector;U.refractView;U.reinhardToneMapping;U.remainder;U.remap;U.remapClamp;U.renderGroup;U.renderOutput;U.rendererReference;U.rotate;U.rotateUV;U.roughness;U.round;U.rtt;U.sRGBTransferEOTF;U.sRGBTransferOETF;U.sampler;U.samplerComparison;U.saturate;U.saturation;U.screen;U.screenCoordinate;U.screenSize;U.screenUV;U.scriptable;U.scriptableValue;U.select;U.setCurrentStack;U.shaderStages;U.shadow;U.pointShadow;U.shadowPositionWorld;U.sharedUniformGroup;U.shapeCircle;U.sheen;U.sheenRoughness;U.shiftLeft;U.shiftRight;U.shininess;U.sign;const lhe=U.sin;U.sinc;U.skinning;U.smoothstep;U.smoothstepElement;U.specularColor;U.specularF90;U.spherizeUV;U.split;U.spritesheetUV;const uhe=U.sqrt;U.stack;U.step;const che=U.storage;U.storageBarrier;U.storageObject;U.storageTexture;U.string;U.struct;U.sub;U.subgroupIndex;U.subgroupSize;U.tan;U.tangentGeometry;U.tangentLocal;U.tangentView;U.tangentWorld;U.temp;U.texture;U.texture3D;U.textureBarrier;U.textureBicubic;U.textureCubeUV;U.textureLoad;U.textureSize;U.textureStore;U.thickness;U.threshold;U.time;U.timerDelta;U.timerGlobal;U.timerLocal;U.toOutputColorSpace;U.toWorkingColorSpace;U.toneMapping;U.toneMappingExposure;U.toonOutlinePass;U.transformDirection;U.transformNormal;U.transformNormalToView;U.transformedBentNormalView;U.transformedBitangentView;U.transformedBitangentWorld;U.transformedClearcoatNormalView;U.transformedNormalView;U.transformedNormalWorld;U.transformedTangentView;U.transformedTangentWorld;U.transmission;U.transpose;U.tri;U.tri3;U.triNoise3D;U.triplanarTexture;U.triplanarTextures;U.trunc;U.tslFn;U.uint;const hhe=U.uniform;U.uniformArray;U.uniformGroup;U.uniforms;U.userData;U.uv;U.uvec2;U.uvec3;U.uvec4;U.Var;U.varying;U.varyingProperty;U.vec2;U.vec3;U.vec4;U.vectorComponents;U.velocity;U.vertexColor;U.vertexIndex;U.vibrance;U.viewZToLogarithmicDepth;U.viewZToOrthographicDepth;U.viewZToPerspectiveDepth;U.viewport;U.viewportBottomLeft;U.viewportCoordinate;U.viewportDepthTexture;U.viewportLinearDepth;U.viewportMipTexture;U.viewportResolution;U.viewportSafeUV;U.viewportSharedTexture;U.viewportSize;U.viewportTexture;U.viewportTopLeft;U.viewportUV;U.wgsl;U.wgslFn;U.workgroupArray;U.workgroupBarrier;U.workgroupId;U.workingToColorSpace;U.xor;const wT=new zu,Ym=new ie;class UL extends Mz{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],i=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(i),this.setAttribute("position",new ei(e,3)),this.setAttribute("uv",new ei(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,i=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),i.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new $1(t,6,1);return this.setAttribute("instanceStart",new Uo(i,3,0)),this.setAttribute("instanceEnd",new Uo(i,3,3)),this.instanceCount=this.attributes.instanceStart.count,this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new $1(t,6,1);return this.setAttribute("instanceColorStart",new Uo(i,3,0)),this.setAttribute("instanceColorEnd",new Uo(i,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new oz(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new zu);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),wT.setFromBufferAttribute(t),this.boundingBox.union(wT))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Hu),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Ym.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Ym)),Ym.fromBufferAttribute(t,s),r=Math.max(r,i.distanceToSquared(Ym));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}}Mt.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new at(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Gs.line={uniforms:Yx.merge([Mt.common,Mt.fog,Mt.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class kb extends zo{constructor(e){super({type:"LineMaterial",uniforms:Yx.clone(Gs.line.uniforms),vertexShader:Gs.line.vertexShader,fragmentShader:Gs.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){e===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){e===!0!==this.dashed&&(this.needsUpdate=!0),e===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(e===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),e===!0?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const uv=new $t,ST=new ie,TT=new ie,zr=new $t,Hr=new $t,La=new $t,cv=new ie,hv=new en,$r=new Cz,MT=new ie,Zm=new zu,Km=new Hu,Da=new $t;let Ga,Wc;function ET(n,e,t){return Da.set(0,0,-e,1).applyMatrix4(n.projectionMatrix),Da.multiplyScalar(1/Da.w),Da.x=Wc/t.width,Da.y=Wc/t.height,Da.applyMatrix4(n.projectionMatrixInverse),Da.multiplyScalar(1/Da.w),Math.abs(Math.max(Da.x,Da.y))}function fhe(n,e){const t=n.matrixWorld,i=n.geometry,r=i.attributes.instanceStart,s=i.attributes.instanceEnd,o=Math.min(i.instanceCount,r.count);for(let a=0,l=o;a<l;a++){$r.start.fromBufferAttribute(r,a),$r.end.fromBufferAttribute(s,a),$r.applyMatrix4(t);const u=new ie,A=new ie;Ga.distanceSqToSegment($r.start,$r.end,A,u),A.distanceTo(u)<Wc*.5&&e.push({point:A,pointOnLine:u,distance:Ga.origin.distanceTo(A),object:n,face:null,faceIndex:a,uv:null,uv1:null})}}function Ahe(n,e,t){const i=e.projectionMatrix,s=n.material.resolution,o=n.matrixWorld,a=n.geometry,l=a.attributes.instanceStart,u=a.attributes.instanceEnd,A=Math.min(a.instanceCount,l.count),p=-e.near;Ga.at(1,La),La.w=1,La.applyMatrix4(e.matrixWorldInverse),La.applyMatrix4(i),La.multiplyScalar(1/La.w),La.x*=s.x/2,La.y*=s.y/2,La.z=0,cv.copy(La),hv.multiplyMatrices(e.matrixWorldInverse,o);for(let g=0,v=A;g<v;g++){if(zr.fromBufferAttribute(l,g),Hr.fromBufferAttribute(u,g),zr.w=1,Hr.w=1,zr.applyMatrix4(hv),Hr.applyMatrix4(hv),zr.z>p&&Hr.z>p)continue;if(zr.z>p){const E=zr.z-Hr.z,N=(zr.z-p)/E;zr.lerp(Hr,N)}else if(Hr.z>p){const E=Hr.z-zr.z,N=(Hr.z-p)/E;Hr.lerp(zr,N)}zr.applyMatrix4(i),Hr.applyMatrix4(i),zr.multiplyScalar(1/zr.w),Hr.multiplyScalar(1/Hr.w),zr.x*=s.x/2,zr.y*=s.y/2,Hr.x*=s.x/2,Hr.y*=s.y/2,$r.start.copy(zr),$r.start.z=0,$r.end.copy(Hr),$r.end.z=0;const S=$r.closestPointToPointParameter(cv,!0);$r.at(S,MT);const T=Hx.lerp(zr.z,Hr.z,S),w=T>=-1&&T<=1,R=cv.distanceTo(MT)<Wc*.5;if(w&&R){$r.start.fromBufferAttribute(l,g),$r.end.fromBufferAttribute(u,g),$r.start.applyMatrix4(o),$r.end.applyMatrix4(o);const E=new ie,N=new ie;Ga.distanceSqToSegment($r.start,$r.end,N,E),t.push({point:N,pointOnLine:E,distance:Ga.origin.distanceTo(N),object:n,face:null,faceIndex:g,uv:null,uv1:null})}}}class dhe extends Jn{constructor(e=new UL,t=new kb({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,i=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let o=0,a=0,l=t.count;o<l;o++,a+=2)ST.fromBufferAttribute(t,o),TT.fromBufferAttribute(i,o),r[a]=a===0?0:r[a-1],r[a+1]=r[a]+ST.distanceTo(TT);const s=new $1(r,2,1);return e.setAttribute("instanceDistanceStart",new Uo(s,1,0)),e.setAttribute("instanceDistanceEnd",new Uo(s,1,1)),this}raycast(e,t){const i=this.material.worldUnits,r=e.camera;r===null&&!i&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Ga=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;Wc=l.linewidth+s,a.boundingSphere===null&&a.computeBoundingSphere(),Km.copy(a.boundingSphere).applyMatrix4(o);let u;if(i)u=Wc*.5;else{const p=Math.max(r.near,Km.distanceToPoint(Ga.origin));u=ET(r,p,l.resolution)}if(Km.radius+=u,Ga.intersectsSphere(Km)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),Zm.copy(a.boundingBox).applyMatrix4(o);let A;if(i)A=Wc*.5;else{const p=Math.max(r.near,Zm.distanceToPoint(Ga.origin));A=ET(r,p,l.resolution)}Zm.expandByScalar(A),Ga.intersectsBox(Zm)!==!1&&(i?fhe(this,t):Ahe(this,r,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(uv),this.material.uniforms.resolution.value.set(uv.z,uv.w))}}class OL extends UL{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,i=new Float32Array(2*t);for(let r=0;r<t;r+=3)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5];return super.setPositions(i),this}setColors(e){const t=e.length-3,i=new Float32Array(2*t);for(let r=0;r<t;r+=3)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5];return super.setColors(i),this}setFromPoints(e){const t=e.length-1,i=new Float32Array(6*t);for(let r=0;r<t;r++)i[6*r]=e[r].x,i[6*r+1]=e[r].y,i[6*r+2]=e[r].z||0,i[6*r+3]=e[r+1].x,i[6*r+4]=e[r+1].y,i[6*r+5]=e[r+1].z||0;return super.setPositions(i),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class phe extends dhe{constructor(e=new OL,t=new kb({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}class CT extends n4{constructor(e,t={}){const i=t.font;if(i===void 0)super();else{const r=i.generateShapes(e,t.size);t.depth===void 0&&(t.depth=50),t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class mhe{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const i=[],r=ghe(e,t,this.data);for(let s=0,o=r.length;s<o;s++)i.push(...r[s].toShapes());return i}}function ghe(n,e,t){const i=Array.from(n),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,o=[];let a=0,l=0;for(let u=0;u<i.length;u++){const A=i[u];if(A===`
`)a=0,l-=s;else{const p=_he(A,r,a,l,t);a+=p.offsetX,o.push(p.path)}}return o}function _he(n,e,t,i,r){const s=r.glyphs[n]||r.glyphs["?"];if(!s){console.error('THREE.Font: character "'+n+'" does not exists in font family '+r.familyName+".");return}const o=new Rz;let a,l,u,A,p,g,v,x;if(s.o){const S=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let T=0,w=S.length;T<w;)switch(S[T++]){case"m":a=S[T++]*e+t,l=S[T++]*e+i,o.moveTo(a,l);break;case"l":a=S[T++]*e+t,l=S[T++]*e+i,o.lineTo(a,l);break;case"q":u=S[T++]*e+t,A=S[T++]*e+i,p=S[T++]*e+t,g=S[T++]*e+i,o.quadraticCurveTo(p,g,u,A);break;case"b":u=S[T++]*e+t,A=S[T++]*e+i,p=S[T++]*e+t,g=S[T++]*e+i,v=S[T++]*e+t,x=S[T++]*e+i,o.bezierCurveTo(p,g,v,x,u,A);break}}return{offsetX:s.ha*e,path:o}}class vhe extends Ci{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new at(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}new ie;new en;new en;new ie;new ie;function Qy(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function yhe(n){if(Array.isArray(n))return n}function xhe(n){if(Array.isArray(n))return Qy(n)}function kL(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function bhe(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function RT(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(u){return void t(u)}a.done?e(l):Promise.resolve(l).then(i,r)}function whe(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){RT(s,i,r,o,a,"next",l)}function a(l){RT(s,i,r,o,a,"throw",l)}o(void 0)})}}function q2(n,e,t){return e=gA(e),Lhe(n,Gb()?Reflect.construct(e,t||[],gA(n).constructor):e.apply(n,t))}function She(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z2(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function g0(n,e){return n.get(kL(n,e))}function fv(n,e,t){She(n,e),e.set(n,t)}function Av(n,e,t){return n.set(kL(n,e),t),t}function Vb(n,e,t){if(Gb())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(n.bind.apply(n,i));return r}function The(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,VL(i.key),i)}}function H2(n,e,t){return e&&The(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function Vr(n,e,t){return(e=VL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yy(){return Yy=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,e,t){var i=Dhe(n,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?n:t):r.value}},Yy.apply(null,arguments)}function gA(n){return gA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gA(n)}function $2(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Ky(n,e)}function Gb(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Gb=function(){return!!n})()}function Mhe(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Ehe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Che(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NT(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function ai(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?NT(Object(t),!0).forEach(function(i){Vr(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):NT(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Nhe(n,e){if(n==null)return{};var t,i,r=Phe(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function Phe(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.indexOf(i)!==-1)continue;t[i]=n[i]}return t}function Lhe(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bhe(n)}function Zy(){Zy=function(){return e};var n,e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(W,Z,J){W[Z]=J.value},s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function u(W,Z,J){return Object.defineProperty(W,Z,{value:J,enumerable:!0,configurable:!0,writable:!0}),W[Z]}try{u({},"")}catch{u=function(Z,J,fe){return Z[J]=fe}}function A(W,Z,J,fe){var ge=Z&&Z.prototype instanceof w?Z:w,pe=Object.create(ge.prototype),Ae=new te(fe||[]);return r(pe,"_invoke",{value:F(W,J,Ae)}),pe}function p(W,Z,J){try{return{type:"normal",arg:W.call(Z,J)}}catch(fe){return{type:"throw",arg:fe}}}e.wrap=A;var g="suspendedStart",v="suspendedYield",x="executing",S="completed",T={};function w(){}function R(){}function E(){}var N={};u(N,o,function(){return this});var D=Object.getPrototypeOf,B=D&&D(D(K([])));B&&B!==t&&i.call(B,o)&&(N=B);var I=E.prototype=w.prototype=Object.create(N);function O(W){["next","throw","return"].forEach(function(Z){u(W,Z,function(J){return this._invoke(Z,J)})})}function L(W,Z){function J(ge,pe,Ae,Fe){var be=p(W[ge],W,pe);if(be.type!=="throw"){var Ve=be.arg,Ye=Ve.value;return Ye&&typeof Ye=="object"&&i.call(Ye,"__await")?Z.resolve(Ye.__await).then(function(Xe){J("next",Xe,Ae,Fe)},function(Xe){J("throw",Xe,Ae,Fe)}):Z.resolve(Ye).then(function(Xe){Ve.value=Xe,Ae(Ve)},function(Xe){return J("throw",Xe,Ae,Fe)})}Fe(be.arg)}var fe;r(this,"_invoke",{value:function(ge,pe){function Ae(){return new Z(function(Fe,be){J(ge,pe,Fe,be)})}return fe=fe?fe.then(Ae,Ae):Ae()}})}function F(W,Z,J){var fe=g;return function(ge,pe){if(fe===x)throw Error("Generator is already running");if(fe===S){if(ge==="throw")throw pe;return{value:n,done:!0}}for(J.method=ge,J.arg=pe;;){var Ae=J.delegate;if(Ae){var Fe=V(Ae,J);if(Fe){if(Fe===T)continue;return Fe}}if(J.method==="next")J.sent=J._sent=J.arg;else if(J.method==="throw"){if(fe===g)throw fe=S,J.arg;J.dispatchException(J.arg)}else J.method==="return"&&J.abrupt("return",J.arg);fe=x;var be=p(W,Z,J);if(be.type==="normal"){if(fe=J.done?S:v,be.arg===T)continue;return{value:be.arg,done:J.done}}be.type==="throw"&&(fe=S,J.method="throw",J.arg=be.arg)}}}function V(W,Z){var J=Z.method,fe=W.iterator[J];if(fe===n)return Z.delegate=null,J==="throw"&&W.iterator.return&&(Z.method="return",Z.arg=n,V(W,Z),Z.method==="throw")||J!=="return"&&(Z.method="throw",Z.arg=new TypeError("The iterator does not provide a '"+J+"' method")),T;var ge=p(fe,W.iterator,Z.arg);if(ge.type==="throw")return Z.method="throw",Z.arg=ge.arg,Z.delegate=null,T;var pe=ge.arg;return pe?pe.done?(Z[W.resultName]=pe.value,Z.next=W.nextLoc,Z.method!=="return"&&(Z.method="next",Z.arg=n),Z.delegate=null,T):pe:(Z.method="throw",Z.arg=new TypeError("iterator result is not an object"),Z.delegate=null,T)}function H(W){var Z={tryLoc:W[0]};1 in W&&(Z.catchLoc=W[1]),2 in W&&(Z.finallyLoc=W[2],Z.afterLoc=W[3]),this.tryEntries.push(Z)}function Q(W){var Z=W.completion||{};Z.type="normal",delete Z.arg,W.completion=Z}function te(W){this.tryEntries=[{tryLoc:"root"}],W.forEach(H,this),this.reset(!0)}function K(W){if(W||W===""){var Z=W[o];if(Z)return Z.call(W);if(typeof W.next=="function")return W;if(!isNaN(W.length)){var J=-1,fe=function ge(){for(;++J<W.length;)if(i.call(W,J))return ge.value=W[J],ge.done=!1,ge;return ge.value=n,ge.done=!0,ge};return fe.next=fe}}throw new TypeError(typeof W+" is not iterable")}return R.prototype=E,r(I,"constructor",{value:E,configurable:!0}),r(E,"constructor",{value:R,configurable:!0}),R.displayName=u(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(W){var Z=typeof W=="function"&&W.constructor;return!!Z&&(Z===R||(Z.displayName||Z.name)==="GeneratorFunction")},e.mark=function(W){return Object.setPrototypeOf?Object.setPrototypeOf(W,E):(W.__proto__=E,u(W,l,"GeneratorFunction")),W.prototype=Object.create(I),W},e.awrap=function(W){return{__await:W}},O(L.prototype),u(L.prototype,a,function(){return this}),e.AsyncIterator=L,e.async=function(W,Z,J,fe,ge){ge===void 0&&(ge=Promise);var pe=new L(A(W,Z,J,fe),ge);return e.isGeneratorFunction(Z)?pe:pe.next().then(function(Ae){return Ae.done?Ae.value:pe.next()})},O(I),u(I,l,"Generator"),u(I,o,function(){return this}),u(I,"toString",function(){return"[object Generator]"}),e.keys=function(W){var Z=Object(W),J=[];for(var fe in Z)J.push(fe);return J.reverse(),function ge(){for(;J.length;){var pe=J.pop();if(pe in Z)return ge.value=pe,ge.done=!1,ge}return ge.done=!0,ge}},e.values=K,te.prototype={constructor:te,reset:function(W){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(Q),!W)for(var Z in this)Z.charAt(0)==="t"&&i.call(this,Z)&&!isNaN(+Z.slice(1))&&(this[Z]=n)},stop:function(){this.done=!0;var W=this.tryEntries[0].completion;if(W.type==="throw")throw W.arg;return this.rval},dispatchException:function(W){if(this.done)throw W;var Z=this;function J(be,Ve){return pe.type="throw",pe.arg=W,Z.next=be,Ve&&(Z.method="next",Z.arg=n),!!Ve}for(var fe=this.tryEntries.length-1;fe>=0;--fe){var ge=this.tryEntries[fe],pe=ge.completion;if(ge.tryLoc==="root")return J("end");if(ge.tryLoc<=this.prev){var Ae=i.call(ge,"catchLoc"),Fe=i.call(ge,"finallyLoc");if(Ae&&Fe){if(this.prev<ge.catchLoc)return J(ge.catchLoc,!0);if(this.prev<ge.finallyLoc)return J(ge.finallyLoc)}else if(Ae){if(this.prev<ge.catchLoc)return J(ge.catchLoc,!0)}else{if(!Fe)throw Error("try statement without catch or finally");if(this.prev<ge.finallyLoc)return J(ge.finallyLoc)}}}},abrupt:function(W,Z){for(var J=this.tryEntries.length-1;J>=0;--J){var fe=this.tryEntries[J];if(fe.tryLoc<=this.prev&&i.call(fe,"finallyLoc")&&this.prev<fe.finallyLoc){var ge=fe;break}}ge&&(W==="break"||W==="continue")&&ge.tryLoc<=Z&&Z<=ge.finallyLoc&&(ge=null);var pe=ge?ge.completion:{};return pe.type=W,pe.arg=Z,ge?(this.method="next",this.next=ge.finallyLoc,T):this.complete(pe)},complete:function(W,Z){if(W.type==="throw")throw W.arg;return W.type==="break"||W.type==="continue"?this.next=W.arg:W.type==="return"?(this.rval=this.arg=W.arg,this.method="return",this.next="end"):W.type==="normal"&&Z&&(this.next=Z),T},finish:function(W){for(var Z=this.tryEntries.length-1;Z>=0;--Z){var J=this.tryEntries[Z];if(J.finallyLoc===W)return this.complete(J.completion,J.afterLoc),Q(J),T}},catch:function(W){for(var Z=this.tryEntries.length-1;Z>=0;--Z){var J=this.tryEntries[Z];if(J.tryLoc===W){var fe=J.completion;if(fe.type==="throw"){var ge=fe.arg;Q(J)}return ge}}throw Error("illegal catch attempt")},delegateYield:function(W,Z,J){return this.delegate={iterator:K(W),resultName:Z,nextLoc:J},this.method==="next"&&(this.arg=n),T}},e}function Ky(n,e){return Ky=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},Ky(n,e)}function Bi(n,e){return yhe(n)||Ehe(n,e)||GL(n,e)||Che()}function Dhe(n,e){for(;!{}.hasOwnProperty.call(n,e)&&(n=gA(n))!==null;);return n}function dv(n,e,t,i){var r=Yy(gA(n.prototype),e,t);return typeof r=="function"?function(s){return r.apply(t,s)}:r}function fi(n){return xhe(n)||Mhe(n)||GL(n)||Rhe()}function Ihe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function VL(n){var e=Ihe(n,"string");return typeof e=="symbol"?e:e+""}function GL(n,e){if(n){if(typeof n=="string")return Qy(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Qy(n,e):void 0}}var qL=function(e){e instanceof Array?e.forEach(qL):(e.map&&e.map.dispose(),e.dispose())},qb=function(e){e.geometry&&e.geometry.dispose(),e.material&&qL(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(qb)},mi=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),qb(t)}};function Us(n,e){var t=new e;return{linkProp:function(r){return{default:t[r](),onChange:function(o,a){a[n][r](o)},triggerUpdate:!1}},linkMethod:function(r){return function(s){for(var o=s[n],a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];var A=o[r].apply(o,l);return A===o?this:A}}}}var Ei=100;function PT(){return Ei}function jo(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180,s=Ei*(1+t),o=Math.sin(i);return{x:s*o*Math.cos(r),y:s*Math.cos(i),z:s*o*Math.sin(r)}}function zL(n){var e=n.x,t=n.y,i=n.z,r=Math.sqrt(e*e+t*t+i*i),s=Math.acos(t/r),o=Math.atan2(i,e);return{lat:90-s*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),altitude:r/Ei-1}}function Nc(n){return n*Math.PI/180}var Wd=window.THREE?window.THREE:{BackSide:_i,BufferAttribute:Gi,Color:Ft,Mesh:Jn,ShaderMaterial:zo},Bhe=`
uniform float hollowRadius;

varying vec3 vVertexWorldPosition;
varying vec3 vVertexNormal;
varying float vCameraDistanceToObjCenter;
varying float vVertexAngularDistanceToHollowRadius;

void main() {    
  vVertexNormal	= normalize(normalMatrix * normal);
  vVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
  
  vec4 objCenterViewPosition = modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0);
  vCameraDistanceToObjCenter = length(objCenterViewPosition);
  
  float edgeAngle = atan(hollowRadius / vCameraDistanceToObjCenter);
  float vertexAngle = acos(dot(normalize(modelViewMatrix * vec4(position, 1.0)), normalize(objCenterViewPosition)));
  vVertexAngularDistanceToHollowRadius = vertexAngle - edgeAngle;

  gl_Position	= projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,Fhe=`
uniform vec3 color;
uniform float coefficient;
uniform float power;
uniform float hollowRadius;

varying vec3 vVertexNormal;
varying vec3 vVertexWorldPosition;
varying float vCameraDistanceToObjCenter;
varying float vVertexAngularDistanceToHollowRadius;

void main() {
  if (vCameraDistanceToObjCenter < hollowRadius) discard; // inside the hollowRadius
  if (vVertexAngularDistanceToHollowRadius < 0.0) discard; // frag position is within the hollow radius

  vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;
  vec3 viewCameraToVertex	= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;
  viewCameraToVertex = normalize(viewCameraToVertex);
  float intensity	= pow(
    coefficient + dot(vVertexNormal, viewCameraToVertex),
    power
  );
  gl_FragColor = vec4(color, intensity);
}`;function Uhe(n,e,t,i){return new Wd.ShaderMaterial({depthWrite:!1,transparent:!0,vertexShader:Bhe,fragmentShader:Fhe,uniforms:{coefficient:{value:n},color:{value:new Wd.Color(e)},power:{value:t},hollowRadius:{value:i}}})}function Ohe(n,e){for(var t=n.clone(),i=new Float32Array(n.attributes.position.count*3),r=0,s=i.length;r<s;r++){var o=n.attributes.normal.array[r],a=n.attributes.position.array[r];i[r]=a+o*e}return t.setAttribute("position",new Wd.BufferAttribute(i,3)),t}var khe=function(n){function e(t){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.color,o=s===void 0?"gold":s,a=r.size,l=a===void 0?2:a,u=r.coefficient,A=u===void 0?.5:u,p=r.power,g=p===void 0?1:p,v=r.hollowRadius,x=v===void 0?0:v,S=r.backside,T=S===void 0?!0:S;z2(this,e),i=q2(this,e);var w=Ohe(t,l),R=Uhe(A,o,g,x);return T&&(R.side=Wd.BackSide),i.geometry=w,i.material=R,i}return $2(e,n),H2(e)}(Wd.Mesh),Ia=window.THREE?window.THREE:{Color:Ft,Group:Bs,LineBasicMaterial:SA,LineSegments:iE,Mesh:Jn,MeshPhongMaterial:gE,SphereGeometry:al,SRGBColorSpace:Ht,TextureLoader:_E},HL=ms({props:{globeImageUrl:{},bumpImageUrl:{},showGlobe:{default:!0,onChange:function(e,t){t.globeGroup.visible=!!e},triggerUpdate:!1},showGraticules:{default:!1,onChange:function(e,t){t.graticulesObj.visible=!!e},triggerUpdate:!1},showAtmosphere:{default:!0,onChange:function(e,t){t.atmosphereObj&&(t.atmosphereObj.visible=!!e)},triggerUpdate:!1},atmosphereColor:{default:"lightskyblue"},atmosphereAltitude:{default:.15},globeTileEngineUrl:{onChange:function(e,t){t.tileEngine.tileUrl=e}},globeTileEngineMaxLevel:{default:17,onChange:function(e,t){t.tileEngine.maxLevel=e},triggerUpdate:!1},updatePov:{onChange:function(e,t){t.tileEngine.updatePov(e)},triggerUpdate:!1},onReady:{default:function(){},triggerUpdate:!1}},methods:{globeMaterial:function(e,t){return t!==void 0?(e.globeObj.material=t||e.defaultGlobeMaterial,this):e.globeObj.material},_destructor:function(e){mi(e.globeObj),mi(e.tileEngine),mi(e.graticulesObj)}},stateInit:function(){var e=new Ia.SphereGeometry(Ei,75,75),t=new Ia.MeshPhongMaterial({color:0}),i=new Ia.Mesh(e,t);i.rotation.y=-Math.PI/2;var r=new PZ(Ei),s=new Ia.Group;s.__globeObjType="globe",s.add(i),s.add(r);var o=new Ia.LineSegments(new E9(QY(),Ei,2),new Ia.LineBasicMaterial({color:"lightgrey",transparent:!0,opacity:.1}));return{globeGroup:s,globeObj:i,graticulesObj:o,defaultGlobeMaterial:t,tileEngine:r}},init:function(e,t){mi(e),t.scene=e,t.scene.add(t.globeGroup),t.scene.add(t.graticulesObj),t.ready=!1},update:function(e,t){var i=e.globeObj.material;if(e.tileEngine.visible=!(e.globeObj.visible=!e.globeTileEngineUrl),t.hasOwnProperty("globeImageUrl")&&(e.globeImageUrl?new Ia.TextureLoader().load(e.globeImageUrl,function(s){s.colorSpace=Ia.SRGBColorSpace,i.map=s,i.color=null,i.needsUpdate=!0,!e.ready&&(e.ready=!0)&&setTimeout(e.onReady)}):!i.color&&(i.color=new Ia.Color(0))),t.hasOwnProperty("bumpImageUrl")&&(e.bumpImageUrl?e.bumpImageUrl&&new Ia.TextureLoader().load(e.bumpImageUrl,function(s){i.bumpMap=s,i.needsUpdate=!0}):(i.bumpMap=null,i.needsUpdate=!0)),(t.hasOwnProperty("atmosphereColor")||t.hasOwnProperty("atmosphereAltitude"))&&(e.atmosphereObj&&(e.scene.remove(e.atmosphereObj),mi(e.atmosphereObj)),e.atmosphereColor&&e.atmosphereAltitude)){var r=e.atmosphereObj=new khe(e.globeObj.geometry,{color:e.atmosphereColor,size:Ei*e.atmosphereAltitude,hollowRadius:Ei,coefficient:.1,power:3.5});r.visible=!!e.showAtmosphere,r.__globeObjType="atmosphere",e.scene.add(r)}!e.ready&&(!e.globeImageUrl||e.globeTileEngineUrl)&&(e.ready=!0,e.onReady())}}),il=function(e){return isNaN(e)?parseInt(Wt(e).toHex(),16):e},da=function(e){return e&&isNaN(e)?rh(e).opacity:1},Vu=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r,s=1,o=/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.eE+-]+)\s*\)$/.exec(e.trim().toLowerCase());if(o){var a=o.slice(1),l=Bi(a,4),u=l[0],A=l[1],p=l[2],g=l[3];r=new Ft("rgb(".concat(+u,",").concat(+A,",").concat(+p,")")),s=Math.min(+g,1)}else r=new Ft(e);i&&r.convertLinearToSRGB();var v=r.toArray();return t?[].concat(fi(v),[s]):v};function Vhe(n,e,t){return n.opacity=e,n.transparent=e<1,n.depthWrite=e>=1,n}var LT=window.THREE?window.THREE:{BufferAttribute:Gi};function rl(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float32Array;if(e===1)return new LT.BufferAttribute(new t(n),e);for(var i=new LT.BufferAttribute(new t(n.length*e),e),r=0,s=n.length;r<s;r++)i.set(n[r],r*e);return i}function Ghe(n){for(var e=n.itemSize,t=[],i=0;i<n.count;i++)t.push(n.array.slice(i*e,(i+1)*e));return t}var pv=new WeakMap,Jm=new WeakMap,e1=new WeakMap,to=function(n){function e(t){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.dataBindAttr,o=s===void 0?"__data":s,a=r.objBindAttr,l=a===void 0?"__threeObj":a,u=r.removeDelay,A=u===void 0?0:u;return z2(this,e),i=q2(this,e),Vr(i,"scene",void 0),fv(i,pv,void 0),fv(i,Jm,void 0),fv(i,e1,void 0),i.scene=t,Av(pv,i,o),Av(Jm,i,l),Av(e1,i,A),i.onRemoveObj(function(){}),i}return $2(e,n),H2(e,[{key:"onCreateObj",value:function(i){var r=this;return dv(e,"onCreateObj",this)([function(s){var o=i(s);return s[g0(Jm,r)]=o,o[g0(pv,r)]=s,r.scene.add(o),o}]),this}},{key:"onRemoveObj",value:function(i){var r=this;return dv(e,"onRemoveObj",this)([function(s,o){var a=dv(e,"getData",r)([s]);i(s,o);var l=function(){r.scene.remove(s),mi(s),delete a[g0(Jm,r)]};g0(e1,r)?setTimeout(l,g0(e1,r)):l()}]),this}}])}(oJ),Ko=window.THREE?window.THREE:{BufferGeometry:Ai,CylinderGeometry:l2,Matrix4:en,Mesh:Jn,MeshLambertMaterial:ll,Object3D:Ci,Vector3:ie},DT=Object.assign({},v4),IT=DT.BufferGeometryUtils||DT,$L=ms({props:{pointsData:{default:[]},pointLat:{default:"lat"},pointLng:{default:"lng"},pointColor:{default:function(){return"#ffffaa"}},pointAltitude:{default:.1},pointRadius:{default:.25},pointResolution:{default:12,triggerUpdate:!1},pointsMerge:{default:!1},pointsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;mi(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new to(e,{objBindAttr:"__threeObjPoint"})},update:function(e,t){var i=ot(e.pointLat),r=ot(e.pointLng),s=ot(e.pointAltitude),o=ot(e.pointRadius),a=ot(e.pointColor),l=new Ko.CylinderGeometry(1,1,1,e.pointResolution);l.applyMatrix4(new Ko.Matrix4().makeRotationX(Math.PI/2)),l.applyMatrix4(new Ko.Matrix4().makeTranslation(0,0,-.5));var u=2*Math.PI*Ei/360,A={};if(!e.pointsMerge&&t.hasOwnProperty("pointsMerge")&&mi(e.scene),e.dataMapper.scene=e.pointsMerge?new Ko.Object3D:e.scene,e.dataMapper.onCreateObj(v).onUpdateObj(x).digest(e.pointsData),e.pointsMerge){var p=e.pointsData.length?(IT.mergeGeometries||IT.mergeBufferGeometries)(e.pointsData.map(function(S){var T=e.dataMapper.getObj(S),w=T.geometry.clone();T.updateMatrix(),w.applyMatrix4(T.matrix);var R=Vu(a(S));return w.setAttribute("color",rl(Array(w.getAttribute("position").count).fill(R),4)),w})):new Ko.BufferGeometry,g=new Ko.Mesh(p,new Ko.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0}));g.__globeObjType="points",g.__data=e.pointsData,e.dataMapper.clear(),mi(e.scene),e.scene.add(g)}function v(){var S=new Ko.Mesh(l);return S.__globeObjType="point",S}function x(S,T){var w=function(O){var L=S.__currentTargetD=O,F=L.r,V=L.alt,H=L.lat,Q=L.lng;Object.assign(S.position,jo(H,Q));var te=e.pointsMerge?new Ko.Vector3(0,0,0):e.scene.localToWorld(new Ko.Vector3(0,0,0));S.lookAt(te),S.scale.x=S.scale.y=Math.min(30,F)*u,S.scale.z=Math.max(V*Ei,.1)},R={alt:+s(T),r:+o(T),lat:+i(T),lng:+r(T)},E=S.__currentTargetD||Object.assign({},R,{alt:-.001});if(Object.keys(R).some(function(I){return E[I]!==R[I]})&&(e.pointsMerge||!e.pointsTransitionDuration||e.pointsTransitionDuration<0?w(R):e.tweenGroup.add(new wo(E).to(R,e.pointsTransitionDuration).easing(Xr.Quadratic.InOut).onUpdate(w).start())),!e.pointsMerge){var N=a(T),D=N?da(N):0,B=!!D;S.visible=B,B&&(A.hasOwnProperty(N)||(A[N]=new Ko.MeshLambertMaterial({color:il(N),transparent:D<1,opacity:D})),S.material=A[N])}}}}),WL=function(){return{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:`
    uniform float dashTranslate; 

    attribute vec4 color;
    varying vec4 vColor;
    
    attribute float relDistance;
    varying float vRelDistance;

    void main() {
      // pass through colors and distances
      vColor = color;
      vRelDistance = relDistance + dashTranslate;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,fragmentShader:`
    uniform float dashOffset; 
    uniform float dashSize;
    uniform float gapSize; 
    
    varying vec4 vColor;
    varying float vRelDistance;
    
    void main() {
      // ignore pixels in the gap
      if (vRelDistance < dashOffset) discard;
      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;
    
      // set px color: [r, g, b, a], interpolated between vertices 
      gl_FragColor = vColor; 
    }
  `}},Jy=function(e){return e.uniforms.surfaceRadius={type:"float",value:0},e.vertexShader=(`attribute float surfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.vertexShader).replace("void main() {",["void main() {","vSurfaceRadius = surfaceRadius;","vPos = position;"].join(`
`)),e.fragmentShader=(`uniform float surfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.fragmentShader).replace("void main() {",["void main() {","if (length(vPos) < max(surfaceRadius, vSurfaceRadius)) discard;"].join(`
`)),e},qhe=function(e){return e.vertexShader=`
    attribute float r;
    
    const float PI = 3.1415926535897932384626433832795;
    float toRad(in float a) {
      return a * PI / 180.0;
    }
    
    vec3 Polar2Cartesian(in vec3 c) { // [lat, lng, r]
      float phi = toRad(90.0 - c.x);
      float theta = toRad(90.0 - c.y);
      float r = c.z;
      return vec3( // x,y,z
        r * sin(phi) * cos(theta),
        r * cos(phi),
        r * sin(phi) * sin(theta)
      );
    }
    
    vec2 Cartesian2Polar(in vec3 p) {
      float r = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);
      float phi = acos(p.y / r);
      float theta = atan(p.z, p.x);
      return vec2( // lat,lng
        90.0 - phi * 180.0 / PI,
        90.0 - theta * 180.0 / PI - (theta < -PI / 2.0 ? 360.0 : 0.0)
      );
    }
    `.concat(e.vertexShader.replace("}",`                  
        vec3 pos = Polar2Cartesian(vec3(Cartesian2Polar(position), r));
        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
      }
    `),`
  `),e},zb=function(e,t){return e.onBeforeCompile=function(i){e.userData.shader=t(i)},e},zhe=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(r){return r};if(e.userData.shader)t(e.userData.shader.uniforms);else{var i=e.onBeforeCompile;e.onBeforeCompile=function(r){i(r),t(r.uniforms)}}},Hhe=["stroke"],Jo=window.THREE?window.THREE:{BufferGeometry:Ai,CubicBezierCurve3:aE,Curve:xa,Group:Bs,Line:o2,Mesh:Jn,NormalBlending:Fs,ShaderMaterial:zo,TubeGeometry:i4,Vector3:ie},$he=hA.default||hA,jL=ms({props:{arcsData:{default:[]},arcStartLat:{default:"startLat"},arcStartLng:{default:"startLng"},arcEndLat:{default:"endLat"},arcEndLng:{default:"endLng"},arcColor:{default:function(){return"#ffffaa"}},arcAltitude:{},arcAltitudeAutoScale:{default:.5},arcStroke:{},arcCurveResolution:{default:64,triggerUpdate:!1},arcCircularResolution:{default:6,triggerUpdate:!1},arcDashLength:{default:1},arcDashGap:{default:0},arcDashInitialGap:{default:0},arcDashAnimateTime:{default:0},arcsTransitionDuration:{default:1e3,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;e.sharedMaterial.dispose(),(t=e.ticker)===null||t===void 0||t.dispose()}},stateInit:function(e){var t=e.tweenGroup;return{tweenGroup:t,ticker:new $he,sharedMaterial:new Jo.ShaderMaterial(ai(ai({},WL()),{},{transparent:!0,blending:Jo.NormalBlending}))}},init:function(e,t){mi(e),t.scene=e,t.dataMapper=new to(e,{objBindAttr:"__threeObjArc"}).onCreateObj(function(){var i=new Jo.Group;return i.__globeObjType="arc",i}),t.ticker.onTick.add(function(i,r){t.dataMapper.entries().map(function(s){var o=Bi(s,2),a=o[1];return a}).filter(function(s){return s.children.length&&s.children[0].material&&s.children[0].__dashAnimateStep}).forEach(function(s){var o=s.children[0],a=o.__dashAnimateStep*r,l=o.material.uniforms.dashTranslate.value%1e9;o.material.uniforms.dashTranslate.value=l+a})})},update:function(e){var t=ot(e.arcStartLat),i=ot(e.arcStartLng),r=ot(e.arcEndLat),s=ot(e.arcEndLng),o=ot(e.arcAltitude),a=ot(e.arcAltitudeAutoScale),l=ot(e.arcStroke),u=ot(e.arcColor),A=ot(e.arcDashLength),p=ot(e.arcDashGap),g=ot(e.arcDashInitialGap),v=ot(e.arcDashAnimateTime);e.dataMapper.onUpdateObj(function(w,R){var E=l(R),N=E!=null;if(!w.children.length||N!==(w.children[0].type==="Mesh")){mi(w);var D=N?new Jo.Mesh:new Jo.Line(new Jo.BufferGeometry);D.material=e.sharedMaterial.clone(),w.add(D)}var B=w.children[0];Object.assign(B.material.uniforms,{dashSize:{value:A(R)},gapSize:{value:p(R)},dashOffset:{value:g(R)}});var I=v(R);B.__dashAnimateStep=I>0?1e3/I:0;var O=S(u(R),e.arcCurveResolution,N?e.arcCircularResolution+1:1),L=T(e.arcCurveResolution,N?e.arcCircularResolution+1:1,!0);B.geometry.setAttribute("color",O),B.geometry.setAttribute("relDistance",L);var F=function(te){var K=w.__currentTargetD=te,W=K.stroke,Z=Nhe(K,Hhe),J=x(Z);N?(B.geometry&&B.geometry.dispose(),B.geometry=new Jo.TubeGeometry(J,e.arcCurveResolution,W/2,e.arcCircularResolution),B.geometry.setAttribute("color",O),B.geometry.setAttribute("relDistance",L)):B.geometry.setFromPoints(J.getPoints(e.arcCurveResolution))},V={stroke:E,alt:o(R),altAutoScale:+a(R),startLat:+t(R),startLng:+i(R),endLat:+r(R),endLng:+s(R)},H=w.__currentTargetD||Object.assign({},V,{altAutoScale:-.001});Object.keys(V).some(function(Q){return H[Q]!==V[Q]})&&(!e.arcsTransitionDuration||e.arcsTransitionDuration<0?F(V):e.tweenGroup.add(new wo(H).to(V,e.arcsTransitionDuration).easing(Xr.Quadratic.InOut).onUpdate(F).start()))}).digest(e.arcsData);function x(w){var R=w.alt,E=w.altAutoScale,N=w.startLat,D=w.startLng,B=w.endLat,I=w.endLng,O=function(pe){var Ae=Bi(pe,3),Fe=Ae[0],be=Ae[1],Ve=Ae[2],Ye=jo(be,Fe,Ve),Xe=Ye.x,Tt=Ye.y,yt=Ye.z;return new Jo.Vector3(Xe,Tt,yt)},L=[D,N],F=[I,B],V=R;if(V==null&&(V=ku(L,F)/2*E),V){var H=d4(L,F),Q=[.25,.75].map(function(ge){return[].concat(fi(H(ge)),[V*1.5])}),te=Bi(Q,2),K=te[0],W=te[1],Z=Vb(Jo.CubicBezierCurve3,fi([L,K,W,F].map(O)));return Z}else{var J=.001;return fe.apply(void 0,fi([[].concat(L,[J]),[].concat(F,[J])].map(O)))}function fe(ge,pe){var Ae=ge.angleTo(pe),Fe=Ae===0?function(){return ge.clone()}:function(Ve){return new Jo.Vector3().addVectors(ge.clone().multiplyScalar(Math.sin((1-Ve)*Ae)),pe.clone().multiplyScalar(Math.sin(Ve*Ae))).divideScalar(Math.sin(Ae))},be=new Jo.Curve;return be.getPoint=Fe,be}}function S(w,R){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=R+1,D;if(w instanceof Array||w instanceof Function){var B=w instanceof Array?kl().domain(w.map(function(Q,te){return te/(w.length-1)})).range(w):w;D=function(te){return Vu(B(te),!0,!0)}}else{var I=Vu(w,!0,!0);D=function(){return I}}for(var O=[],L=0,F=N;L<F;L++)for(var V=D(L/(F-1)),H=0;H<E;H++)O.push(V);return rl(O,4)}function T(w){for(var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,N=w+1,D=[],B=0,I=N;B<I;B++)for(var O=B/(I-1),L=0;L<R;L++)D.push(O);return E&&D.reverse(),rl(D,1)}}}),gu=window.THREE?window.THREE:{BufferGeometry:Ai,DoubleSide:_r,Mesh:Jn,MeshLambertMaterial:ll,Object3D:Ci},BT=Object.assign({},v4),FT=BT.BufferGeometryUtils||BT,XL=ms({props:{hexBinPointsData:{default:[]},hexBinPointLat:{default:"lat"},hexBinPointLng:{default:"lng"},hexBinPointWeight:{default:1},hexBinResolution:{default:4},hexMargin:{default:.2},hexTopCurvatureResolution:{default:5},hexTopColor:{default:function(){return"#ffffaa"}},hexSideColor:{default:function(){return"#ffffaa"}},hexAltitude:{default:function(e){var t=e.sumWeight;return t*.01}},hexBinMerge:{default:!1},hexTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;mi(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new to(e,{objBindAttr:"__threeObjHexbin"})},update:function(e,t){var i=ot(e.hexBinPointLat),r=ot(e.hexBinPointLng),s=ot(e.hexBinPointWeight),o=ot(e.hexAltitude),a=ot(e.hexTopColor),l=ot(e.hexSideColor),u=ot(e.hexMargin),A=Cee(e.hexBinPointsData.map(function(R){return ai(ai({},R),{},{h3Idx:ute(i(R),r(R),e.hexBinResolution)})}),"h3Idx"),p=Object.entries(A).map(function(R){var E=Bi(R,2),N=E[0],D=E[1];return{h3Idx:N,points:D,sumWeight:D.reduce(function(B,I){return B+ +s(I)},0)}}),g={};if(!e.hexBinMerge&&t.hasOwnProperty("hexBinMerge")&&mi(e.scene),e.dataMapper.scene=e.hexBinMerge?new gu.Object3D:e.scene,e.dataMapper.id(function(R){return R.h3Idx}).onCreateObj(T).onUpdateObj(w).digest(p),e.hexBinMerge){var v=p.length?(FT.mergeGeometries||FT.mergeBufferGeometries)(p.map(function(R){var E=e.dataMapper.getObj(R),N=E.geometry.toNonIndexed();E.updateMatrix(),N.applyMatrix4(E.matrix);var D=Vu(a(R)),B=Vu(l(R)),I=N.getAttribute("position").count,O=N.groups[0].count;return N.setAttribute("color",rl(fi(new Array(I)).map(function(L,F){return F>=O?D:B}),4)),N})):new gu.BufferGeometry,x=new gu.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0,side:gu.DoubleSide});x.onBeforeCompile=function(R){x.userData.shader=Jy(R)};var S=new gu.Mesh(v,x);S.__globeObjType="hexBinPoints",S.__data=p,e.dataMapper.clear(),mi(e.scene),e.scene.add(S)}function T(R){var E=new gu.Mesh;E.__hexCenter=W9(R.h3Idx),E.__hexGeoJson=j9(R.h3Idx,!0).reverse();var N=E.__hexCenter[1];return E.__hexGeoJson.forEach(function(D){var B=D[0];Math.abs(N-B)>170&&(D[0]+=N>B?360:-360)}),E.__globeObjType="hexbin",E}function w(R,E){var N=function(Z,J,fe){return Z-(Z-J)*fe},D=Math.max(0,Math.min(1,+u(E))),B=Bi(R.__hexCenter,2),I=B[0],O=B[1],L=D===0?R.__hexGeoJson:R.__hexGeoJson.map(function(W){var Z=Bi(W,2),J=Z[0],fe=Z[1];return[[J,O],[fe,I]].map(function(ge){var pe=Bi(ge,2),Ae=pe[0],Fe=pe[1];return N(Ae,Fe,D)})}),F=e.hexTopCurvatureResolution;R.geometry&&R.geometry.dispose(),R.geometry=new S4([L],0,Ei,!1,!0,!0,F);var V={alt:+o(E)},H=function(Z){var J=R.__currentTargetD=Z,fe=J.alt;R.scale.x=R.scale.y=R.scale.z=1+fe;var ge=Ei/(fe+1);R.geometry.setAttribute("surfaceRadius",rl(Array(R.geometry.getAttribute("position").count).fill(ge),1))},Q=R.__currentTargetD||Object.assign({},V,{alt:-.001});if(Object.keys(V).some(function(W){return Q[W]!==V[W]})&&(e.hexBinMerge||!e.hexTransitionDuration||e.hexTransitionDuration<0?H(V):e.tweenGroup.add(new wo(Q).to(V,e.hexTransitionDuration).easing(Xr.Quadratic.InOut).onUpdate(H).start())),!e.hexBinMerge){var te=l(E),K=a(E);[te,K].forEach(function(W){if(!g.hasOwnProperty(W)){var Z=da(W);g[W]=zb(new gu.MeshLambertMaterial({color:il(W),transparent:Z<1,opacity:Z,side:gu.DoubleSide}),Jy)}}),R.material=[te,K].map(function(W){return g[W]})}}}}),QL=function(e){return e*e},Nl=function(e){return e*Math.PI/180};function Whe(n,e){var t=Math.sqrt,i=Math.cos,r=function(A){return QL(Math.sin(A/2))},s=Nl(n[1]),o=Nl(e[1]),a=Nl(n[0]),l=Nl(e[0]);return 2*Math.asin(t(r(o-s)+i(s)*i(o)*r(l-a)))}var jhe=Math.sqrt(2*Math.PI);function Xhe(n,e){return Math.exp(-QL(n/e)/2)/(e*jhe)}var Qhe=function(e){var t=Bi(e,2),i=t[0],r=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.lngAccessor,l=a===void 0?function(T){return T[0]}:a,u=o.latAccessor,A=u===void 0?function(T){return T[1]}:u,p=o.weightAccessor,g=p===void 0?function(){return 1}:p,v=o.bandwidth,x=[i,r],S=v*Math.PI/180;return TQ(s.map(function(T){var w=g(T);if(!w)return 0;var R=Whe(x,[l(T),A(T)]);return Xhe(R,S)*w}))},Yhe=function(){var n=whe(Zy().mark(function e(t){var i,r,s,o,a,l,u,A,p,g,v,x,S,T,w,R,E,N,D,B,I,O,L,F,V,H,Q,te,K,W,Z,J,fe,ge,pe,Ae,Fe,be,Ve,Ye,Xe=arguments;return Zy().wrap(function(yt){for(;;)switch(yt.prev=yt.next){case 0:if(r=Xe.length>1&&Xe[1]!==void 0?Xe[1]:[],s=Xe.length>2&&Xe[2]!==void 0?Xe[2]:{},o=s.lngAccessor,a=o===void 0?function(ut){return ut[0]}:o,l=s.latAccessor,u=l===void 0?function(ut){return ut[1]}:l,A=s.weightAccessor,p=A===void 0?function(){return 1}:A,g=s.bandwidth,(i=navigator)!==null&&i!==void 0&&i.gpu){yt.next=5;break}return console.warn("WebGPU not enabled in browser. Please consider enabling it to improve performance."),yt.abrupt("return",t.map(function(ut){return Qhe(ut,r,{lngAccessor:a,latAccessor:u,weightAccessor:p,bandwidth:g})}));case 5:return v=4,x=Jce,S=ehe,T=hhe,w=che,R=she,E=ohe,N=the,D=uhe,B=lhe,I=ihe,O=nhe,L=rhe,F=ahe,V=w(new E1(new Float32Array(t.flat().map(Nl)),2),"vec2",t.length),H=w(new E1(new Float32Array(r.map(function(ut){return[Nl(a(ut)),Nl(u(ut)),p(ut)]}).flat()),3),"vec3",r.length),Q=new E1(t.length,1),te=w(Q,"float",t.length),K=R(Math.PI),W=D(K.mul(2)),Z=function(Ut){return Ut.mul(Ut)},J=function(Ut){return Z(B(Ut.div(2)))},fe=function(Ut,ue){var ce=R(Ut[1]),G=R(ue[1]),Ee=R(Ut[0]),ye=R(ue[0]);return R(2).mul(O(D(J(G.sub(ce)).add(I(ce).mul(I(G)).mul(J(ye.sub(Ee)))))))},ge=function(Ut,ue){return L(F(Z(Ut.div(ue)).div(2))).div(ue.mul(W))},pe=T(Nl(g)),Ae=T(Nl(g*v)),Fe=T(r.length),be=x(function(){var ut=V.element(E),Ut=te.element(E);Ut.assign(0),N(Fe,function(ue){var ce=ue.i,G=H.element(ce),Ee=G.z;S(Ee,function(){var ye=fe(G.xy,ut.xy);S(ye&&ye.lessThan(Ae),function(){Ut.addAssign(ge(ye,pe).mul(Ee))})})})}),Ve=be().compute(t.length),Ye=new Kce,yt.next=25,Ye.computeAsync(Ve);case 25:return yt.t0=Array,yt.t1=Float32Array,yt.next=29,Ye.getArrayBufferAsync(Q);case 29:return yt.t2=yt.sent,yt.t3=new yt.t1(yt.t2),yt.abrupt("return",yt.t0.from.call(yt.t0,yt.t3));case 32:case"end":return yt.stop()}},e)}));return function(t){return n.apply(this,arguments)}}(),t1=window.THREE?window.THREE:{Mesh:Jn,MeshLambertMaterial:ll,SphereGeometry:al},Zhe=3.5,Khe=.1,UT=100,Jhe=function(e){var t=rh(hte(e));return t.opacity=Math.cbrt(e),t.formatRgb()},YL=ms({props:{heatmapsData:{default:[]},heatmapPoints:{default:function(e){return e}},heatmapPointLat:{default:function(e){return e[0]}},heatmapPointLng:{default:function(e){return e[1]}},heatmapPointWeight:{default:1},heatmapBandwidth:{default:2.5},heatmapColorFn:{default:function(){return Jhe}},heatmapColorSaturation:{default:1.5},heatmapBaseAltitude:{default:.01},heatmapTopAltitude:{},heatmapsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;mi(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new to(e,{objBindAttr:"__threeObjHeatmap"}).onCreateObj(function(){var s=new t1.Mesh(new t1.SphereGeometry(Ei),zb(new t1.MeshLambertMaterial({vertexColors:!0,transparent:!0}),qhe));return s.__globeObjType="heatmap",s})},update:function(e){var t=ot(e.heatmapPoints),i=ot(e.heatmapPointLat),r=ot(e.heatmapPointLng),s=ot(e.heatmapPointWeight),o=ot(e.heatmapBandwidth),a=ot(e.heatmapColorFn),l=ot(e.heatmapColorSaturation),u=ot(e.heatmapBaseAltitude),A=ot(e.heatmapTopAltitude);e.dataMapper.onUpdateObj(function(p,g){var v=o(g),x=a(g),S=l(g),T=u(g),w=A(g),R=t(g).map(function(I){var O=i(I),L=r(I),F=jo(O,L),V=F.x,H=F.y,Q=F.z;return{x:V,y:H,z:Q,lat:O,lng:L,weight:s(I)}}),E=Math.max(Khe,v/Zhe),N=Math.ceil(360/(E||-1));p.geometry.parameters.widthSegments!==N&&(p.geometry.dispose(),p.geometry=new t1.SphereGeometry(Ei,N,N/2));var D=Ghe(p.geometry.getAttribute("position")),B=D.map(function(I){var O=Bi(I,3),L=O[0],F=O[1],V=O[2],H=zL({x:L,y:F,z:V}),Q=H.lng,te=H.lat;return[Q,te]});Yhe(B,R,{latAccessor:function(O){return O.lat},lngAccessor:function(O){return O.lng},weightAccessor:function(O){return O.weight},bandwidth:v}).then(function(I){var O=fi(new Array(UT)).map(function(H,Q){return Vu(x(Q/(UT-1)))}),L=function(Q){var te=p.__currentTargetD=Q,K=te.kdeVals,W=te.topAlt,Z=te.saturation,J=bQ(K.map(Math.abs))||1e-15,fe=jE([0,J/Z],O);p.geometry.setAttribute("color",rl(K.map(function(pe){return fe(Math.abs(pe))}),4));var ge=kl([0,J],[Ei*(1+T),Ei*(1+(W||T))]);p.geometry.setAttribute("r",rl(K.map(ge)))},F={kdeVals:I,topAlt:w,saturation:S},V=p.__currentTargetD||Object.assign({},F,{kdeVals:I.map(function(){return 0}),topAlt:w&&T,saturation:.5});V.kdeVals.length!==I.length&&(V.kdeVals=I.slice()),Object.keys(F).some(function(H){return V[H]!==F[H]})&&(!e.heatmapsTransitionDuration||e.heatmapsTransitionDuration<0?L(F):e.tweenGroup.add(new wo(V).to(F,e.heatmapsTransitionDuration).easing(Xr.Quadratic.InOut).onUpdate(L).start()))})}).digest(e.heatmapsData)}}),_u=window.THREE?window.THREE:{DoubleSide:_r,Group:Bs,LineBasicMaterial:SA,LineSegments:iE,Mesh:Jn,MeshBasicMaterial:ia},ZL=ms({props:{polygonsData:{default:[]},polygonGeoJsonGeometry:{default:"geometry"},polygonSideColor:{default:function(){return"#ffffaa"}},polygonSideMaterial:{},polygonCapColor:{default:function(){return"#ffffaa"}},polygonCapMaterial:{},polygonStrokeColor:{},polygonAltitude:{default:.01},polygonCapCurvatureResolution:{default:5},polygonsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;mi(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new to(e,{objBindAttr:"__threeObjPolygon"}).id(function(s){return s.id}).onCreateObj(function(){var s=new _u.Group;return s.__defaultSideMaterial=zb(new _u.MeshBasicMaterial({side:_u.DoubleSide,depthWrite:!0}),Jy),s.__defaultCapMaterial=new _u.MeshBasicMaterial({side:_u.DoubleSide,depthWrite:!0}),s.add(new _u.Mesh(void 0,[s.__defaultSideMaterial,s.__defaultCapMaterial])),s.add(new _u.LineSegments(void 0,new _u.LineBasicMaterial)),s.__globeObjType="polygon",s})},update:function(e){var t=ot(e.polygonGeoJsonGeometry),i=ot(e.polygonAltitude),r=ot(e.polygonCapCurvatureResolution),s=ot(e.polygonCapColor),o=ot(e.polygonCapMaterial),a=ot(e.polygonSideColor),l=ot(e.polygonSideMaterial),u=ot(e.polygonStrokeColor),A=[];e.polygonsData.forEach(function(p){var g={data:p,capColor:s(p),capMaterial:o(p),sideColor:a(p),sideMaterial:l(p),strokeColor:u(p),altitude:+i(p),capCurvatureResolution:+r(p)},v=t(p),x=p.__id||"".concat(Math.round(Math.random()*1e9));p.__id=x,v.type==="Polygon"?A.push(ai({id:"".concat(x,"_0"),coords:v.coordinates},g)):v.type==="MultiPolygon"?A.push.apply(A,fi(v.coordinates.map(function(S,T){return ai({id:"".concat(x,"_").concat(T),coords:S},g)}))):console.warn("Unsupported GeoJson geometry type: ".concat(v.type,". Skipping geometry..."))}),e.dataMapper.onUpdateObj(function(p,g){var v=g.coords,x=g.capColor,S=g.capMaterial,T=g.sideColor,w=g.sideMaterial,R=g.strokeColor,E=g.altitude,N=g.capCurvatureResolution,D=Bi(p.children,2),B=D[0],I=D[1],O=!!R;I.visible=O;var L=!!(x||S),F=!!(T||w);efe(B.geometry.parameters||{},{polygonGeoJson:v,curvatureResolution:N,closedTop:L,includeSides:F})||(B.geometry&&B.geometry.dispose(),B.geometry=new S4(v,0,Ei,!1,L,F,N)),O&&(!I.geometry.parameters||I.geometry.parameters.geoJson.coordinates!==v||I.geometry.parameters.resolution!==N)&&(I.geometry&&I.geometry.dispose(),I.geometry=new E9({type:"Polygon",coordinates:v},Ei,N));var V=F?0:-1,H=L?F?1:0:-1;if(V>=0&&(B.material[V]=w||p.__defaultSideMaterial),H>=0&&(B.material[H]=S||p.__defaultCapMaterial),[[!w&&T,V],[!S&&x,H]].forEach(function(J){var fe=Bi(J,2),ge=fe[0],pe=fe[1];if(!(!ge||pe<0)){var Ae=B.material[pe],Fe=da(ge);Ae.color.set(il(ge)),Ae.transparent=Fe<1,Ae.opacity=Fe}}),O){var Q=I.material,te=da(R);Q.color.set(il(R)),Q.transparent=te<1,Q.opacity=te}var K={alt:E},W=function(fe){var ge=p.__currentTargetD=fe,pe=ge.alt;B.scale.x=B.scale.y=B.scale.z=1+pe,O&&(I.scale.x=I.scale.y=I.scale.z=1+pe+1e-4),zhe(p.__defaultSideMaterial,function(Ae){return Ae.surfaceRadius.value=Ei/(pe+1)})},Z=p.__currentTargetD||Object.assign({},K,{alt:-.001});Object.keys(K).some(function(J){return Z[J]!==K[J]})&&(!e.polygonsTransitionDuration||e.polygonsTransitionDuration<0||Z.alt===K.alt?W(K):e.tweenGroup.add(new wo(Z).to(K,e.polygonsTransitionDuration).easing(Xr.Quadratic.InOut).onUpdate(W).start()))}).digest(A)}});function efe(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return function(i,r){return i===r}};return Object.entries(e).every(function(i){var r=Bi(i,2),s=r[0],o=r[1];return n.hasOwnProperty(s)&&t(s)(n[s],o)})}var rf=window.THREE?window.THREE:{BufferGeometry:Ai,DoubleSide:_r,Mesh:Jn,MeshLambertMaterial:ll,Vector3:ie},OT=Object.assign({},v4),kT=OT.BufferGeometryUtils||OT,KL=ms({props:{hexPolygonsData:{default:[]},hexPolygonGeoJsonGeometry:{default:"geometry"},hexPolygonColor:{default:function(){return"#ffffaa"}},hexPolygonAltitude:{default:.001},hexPolygonResolution:{default:3},hexPolygonMargin:{default:.2},hexPolygonUseDots:{default:!1},hexPolygonCurvatureResolution:{default:5},hexPolygonDotResolution:{default:12},hexPolygonsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;mi(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new to(e,{objBindAttr:"__threeObjHexPolygon"}).onCreateObj(function(){var s=new rf.Mesh(void 0,new rf.MeshLambertMaterial({side:rf.DoubleSide}));return s.__globeObjType="hexPolygon",s})},update:function(e){var t=ot(e.hexPolygonGeoJsonGeometry),i=ot(e.hexPolygonColor),r=ot(e.hexPolygonAltitude),s=ot(e.hexPolygonResolution),o=ot(e.hexPolygonMargin),a=ot(e.hexPolygonUseDots),l=ot(e.hexPolygonCurvatureResolution),u=ot(e.hexPolygonDotResolution);e.dataMapper.onUpdateObj(function(A,p){var g=t(p),v=s(p),x=r(p),S=Math.max(0,Math.min(1,+o(p))),T=a(p),w=l(p),R=u(p),E=i(p),N=da(E);A.material.color.set(il(E)),A.material.transparent=N<1,A.material.opacity=N;var D={alt:x,margin:S,curvatureResolution:w},B={geoJson:g,h3Res:v},I=A.__currentTargetD||Object.assign({},D,{alt:-.001}),O=A.__currentMemD||B;if(Object.keys(D).some(function(H){return I[H]!==D[H]})||Object.keys(B).some(function(H){return O[H]!==B[H]})){A.__currentMemD=B;var L=[];g.type==="Polygon"?aS(g.coordinates,v,!0).forEach(function(H){return L.push(H)}):g.type==="MultiPolygon"?g.coordinates.forEach(function(H){return aS(H,v,!0).forEach(function(Q){return L.push(Q)})}):console.warn("Unsupported GeoJson geometry type: ".concat(g.type,". Skipping geometry..."));var F=L.map(function(H){var Q=W9(H),te=j9(H,!0).reverse(),K=Q[1];return te.forEach(function(W){var Z=W[0];Math.abs(K-Z)>170&&(W[0]+=K>Z?360:-360)}),{h3Idx:H,hexCenter:Q,hexGeoJson:te}}),V=function(Q){var te=A.__currentTargetD=Q,K=te.alt,W=te.margin,Z=te.curvatureResolution;A.geometry&&A.geometry.dispose(),A.geometry=F.length?(kT.mergeGeometries||kT.mergeBufferGeometries)(F.map(function(J){var fe=Bi(J.hexCenter,2),ge=fe[0],pe=fe[1];if(T){var Ae=jo(ge,pe,K),Fe=jo(J.hexGeoJson[0][1],J.hexGeoJson[0][0],K),be=.85*(1-W)*new rf.Vector3(Ae.x,Ae.y,Ae.z).distanceTo(new rf.Vector3(Fe.x,Fe.y,Fe.z)),Ve=new a2(be,R);return Ve.rotateX(Nc(-ge)),Ve.rotateY(Nc(pe)),Ve.translate(Ae.x,Ae.y,Ae.z),Ve}else{var Ye=function(yt,ut,Ut){return yt-(yt-ut)*Ut},Xe=W===0?J.hexGeoJson:J.hexGeoJson.map(function(Tt){var yt=Bi(Tt,2),ut=yt[0],Ut=yt[1];return[[ut,pe],[Ut,ge]].map(function(ue){var ce=Bi(ue,2),G=ce[0],Ee=ce[1];return Ye(G,Ee,W)})});return new S4([Xe],Ei,Ei*(1+K),!1,!0,!1,Z)}})):new rf.BufferGeometry};!e.hexPolygonsTransitionDuration||e.hexPolygonsTransitionDuration<0?V(D):e.tweenGroup.add(new wo(I).to(D,e.hexPolygonsTransitionDuration).easing(Xr.Quadratic.InOut).onUpdate(V).start())}}).digest(e.hexPolygonsData)}}),tfe=window.THREE?window.THREE:{Vector3:ie};function nfe(n,e){var t=function(o,a){var l=o[o.length-1];return[].concat(fi(o),fi(Array(a-o.length).fill(l)))},i=Math.max(n.length,e.length),r=GQ.apply(void 0,fi([n,e].map(function(s){return s.map(function(o){var a=o.x,l=o.y,u=o.z;return[a,l,u]})}).map(function(s){return t(s,i)})));return function(s){return s===0?n:s===1?e:r(s).map(function(o){var a=Bi(o,3),l=a[0],u=a[1],A=a[2];return new tfe.Vector3(l,u,A)})}}var vc=window.THREE?window.THREE:{BufferGeometry:Ai,Color:Ft,Group:Bs,Line:o2,NormalBlending:Fs,ShaderMaterial:zo,Vector3:ie},ife=hA.default||hA,JL=ms({props:{pathsData:{default:[]},pathPoints:{default:function(e){return e}},pathPointLat:{default:function(e){return e[0]}},pathPointLng:{default:function(e){return e[1]}},pathPointAlt:{default:.001},pathResolution:{default:2},pathColor:{default:function(){return"#ffffaa"}},pathStroke:{},pathDashLength:{default:1},pathDashGap:{default:0},pathDashInitialGap:{default:0},pathDashAnimateTime:{default:0},pathTransitionDuration:{default:1e3,triggerUpdate:!1},rendererSize:{}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},stateInit:function(e){var t=e.tweenGroup;return{tweenGroup:t,ticker:new ife,sharedMaterial:new vc.ShaderMaterial(ai(ai({},WL()),{},{transparent:!0,blending:vc.NormalBlending}))}},init:function(e,t){mi(e),t.scene=e,t.dataMapper=new to(e,{objBindAttr:"__threeObjPath"}).onCreateObj(function(){var i=new vc.Group;return i.__globeObjType="path",i}),t.ticker.onTick.add(function(i,r){t.dataMapper.entries().map(function(s){var o=Bi(s,2),a=o[1];return a}).filter(function(s){return s.children.length&&s.children[0].material&&s.children[0].__dashAnimateStep}).forEach(function(s){var o=s.children[0],a=o.__dashAnimateStep*r;if(o.type==="Line"){var l=o.material.uniforms.dashTranslate.value%1e9;o.material.uniforms.dashTranslate.value=l+a}else if(o.type==="Line2"){for(var u=o.material.dashOffset-a,A=o.material.dashSize+o.material.gapSize;u<=-A;)u+=A;o.material.dashOffset=u}})})},update:function(e){var t=ot(e.pathPoints),i=ot(e.pathPointLat),r=ot(e.pathPointLng),s=ot(e.pathPointAlt),o=ot(e.pathStroke),a=ot(e.pathColor),l=ot(e.pathDashLength),u=ot(e.pathDashGap),A=ot(e.pathDashInitialGap),p=ot(e.pathDashAnimateTime);e.dataMapper.onUpdateObj(function(T,w){var R=o(w),E=R!=null;if(!T.children.length||E===(T.children[0].type==="Line")){mi(T);var N=E?new phe(new OL,new kb):new vc.Line(new vc.BufferGeometry,e.sharedMaterial.clone());T.add(N)}var D=T.children[0],B=v(t(w),i,r,s,e.pathResolution),I=p(w);if(D.__dashAnimateStep=I>0?1e3/I:0,E){D.material.resolution=e.rendererSize;{var F=l(w),V=u(w),H=A(w);D.material.dashed=V>0,D.material.dashed?D.material.defines.USE_DASH="":delete D.material.defines.USE_DASH,D.material.dashed&&(D.material.dashScale=1/g(B),D.material.dashSize=F,D.material.gapSize=V,D.material.dashOffset=-H)}{var Q=a(w);if(Q instanceof Array){var te=x(a(w),B.length-1,1,!1);D.geometry.setColors(te.array),D.material.vertexColors=!0}else{var K=Q,W=da(K);D.material.color=new vc.Color(il(K)),D.material.transparent=W<1,D.material.opacity=W,D.material.vertexColors=!1}}D.material.needsUpdate=!0}else{Object.assign(D.material.uniforms,{dashSize:{value:l(w)},gapSize:{value:u(w)},dashOffset:{value:A(w)}});var O=x(a(w),B.length),L=S(B.length,1,!0);D.geometry.setAttribute("color",O),D.geometry.setAttribute("relDistance",L)}var Z=nfe(T.__currentTargetD&&T.__currentTargetD.points||[B[0]],B),J=function(Ae){var Fe=T.__currentTargetD=Ae,be=Fe.stroke,Ve=Fe.interpolK,Ye=T.__currentTargetD.points=Z(Ve);if(E){var Xe;D.geometry.setPositions((Xe=[]).concat.apply(Xe,fi(Ye.map(function(Tt){var yt=Tt.x,ut=Tt.y,Ut=Tt.z;return[yt,ut,Ut]})))),D.material.linewidth=be,D.material.dashed&&D.computeLineDistances()}else D.geometry.setFromPoints(Ye),D.geometry.computeBoundingSphere()},fe={stroke:R,interpolK:1},ge=Object.assign({},T.__currentTargetD||fe,{interpolK:0});Object.keys(fe).some(function(pe){return ge[pe]!==fe[pe]})&&(!e.pathTransitionDuration||e.pathTransitionDuration<0?J(fe):e.tweenGroup.add(new wo(ge).to(fe,e.pathTransitionDuration).easing(Xr.Quadratic.InOut).onUpdate(J).start()))}).digest(e.pathsData);function g(T){var w=0,R;return T.forEach(function(E){R&&(w+=R.distanceTo(E)),R=E}),w}function v(T,w,R,E,N){var D=function(L,F,V){for(var H=[],Q=1;Q<=V;Q++)H.push(L+(F-L)*Q/(V+1));return H},B=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,V=[],H=null;return L.forEach(function(Q){if(H){for(;Math.abs(H[1]-Q[1])>180;)H[1]+=360*(H[1]<Q[1]?1:-1);var te=Math.sqrt(Math.pow(Q[0]-H[0],2)+Math.pow(Q[1]-H[1],2));if(te>F)for(var K=Math.floor(te/F),W=D(H[0],Q[0],K),Z=D(H[1],Q[1],K),J=D(H[2],Q[2],K),fe=0,ge=W.length;fe<ge;fe++)V.push([W[fe],Z[fe],J[fe]])}V.push(H=Q)}),V},I=function(L){var F=Bi(L,3),V=F[0],H=F[1],Q=F[2],te=jo(V,H,Q),K=te.x,W=te.y,Z=te.z;return new vc.Vector3(K,W,Z)};return B(T.map(function(O){return[w(O),R(O),E(O)]}),N).map(I)}function x(T,w){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,N=w+1,D;if(T instanceof Array||T instanceof Function){var B=T instanceof Array?kl().domain(T.map(function(Q,te){return te/(T.length-1)})).range(T):T;D=function(te){return Vu(B(te),E,!0)}}else{var I=Vu(T,E,!0);D=function(){return I}}for(var O=[],L=0,F=N;L<F;L++)for(var V=D(L/(F-1)),H=0;H<R;H++)O.push(V);return rl(O,E?4:3)}function S(T){for(var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=T+1,N=[],D=0,B=E;D<B;D++)for(var I=D/(B-1),O=0;O<w;O++)N.push(I);return R&&N.reverse(),rl(N,1)}}}),n1=window.THREE?window.THREE:{Euler:Qr,Mesh:Jn,MeshLambertMaterial:ll,SphereGeometry:al},eD=ms({props:{tilesData:{default:[]},tileLat:{default:"lat"},tileLng:{default:"lng"},tileAltitude:{default:.01},tileWidth:{default:1},tileHeight:{default:1},tileUseGlobeProjection:{default:!0},tileMaterial:{default:function(){return new n1.MeshLambertMaterial({color:"#ffbb88",opacity:.4,transparent:!0})}},tileCurvatureResolution:{default:5},tilesTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;mi(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new to(e,{objBindAttr:"__threeObjTile"}).onCreateObj(function(){var s=new n1.Mesh;return s.__globeObjType="tile",s})},update:function(e){var t=ot(e.tileLat),i=ot(e.tileLng),r=ot(e.tileAltitude),s=ot(e.tileWidth),o=ot(e.tileHeight),a=ot(e.tileUseGlobeProjection),l=ot(e.tileMaterial),u=ot(e.tileCurvatureResolution);e.dataMapper.onUpdateObj(function(A,p){A.material=l(p);var g=a(p),v=u(p),x=function(R){var E=A.__currentTargetD=R,N=E.lat,D=E.lng,B=E.alt,I=E.width,O=E.height,L=sf(D),F=sf(-N);A.geometry&&A.geometry.dispose(),A.geometry=new n1.SphereGeometry(Ei*(1+B),Math.ceil(I/(v||-1)),Math.ceil(O/(v||-1)),sf(90-I/2)+(g?L:0),sf(I),sf(90-O/2)+(g?F:0),sf(O)),g||A.setRotationFromEuler(new n1.Euler(F,L,0,"YXZ"))},S={lat:+t(p),lng:+i(p),alt:+r(p),width:+s(p),height:+o(p)},T=A.__currentTargetD||Object.assign({},S,{width:0,height:0});Object.keys(S).some(function(w){return T[w]!==S[w]})&&(!e.tilesTransitionDuration||e.tilesTransitionDuration<0?x(S):e.tweenGroup.add(new wo(T).to(S,e.tilesTransitionDuration).easing(Xr.Quadratic.InOut).onUpdate(x).start()))}).digest(e.tilesData)}}),sf=function(e){return e*Math.PI/180},_0=window.THREE?window.THREE:{BufferGeometry:Ai,Color:Ft,Points:Eq,PointsMaterial:Jx},tD=ms({props:{particlesData:{default:[]},particlesList:{default:function(e){return e}},particleLat:{default:"lat"},particleLng:{default:"lng"},particleAltitude:{default:.01},particlesSize:{default:.5},particlesSizeAttenuation:{default:!0},particlesColor:{default:function(){return"white"}},particlesTexture:{}},init:function(e,t){mi(e),t.scene=e,t.dataMapper=new to(e,{objBindAttr:"__threeObjParticles"}).onCreateObj(function(){var i=new _0.Points(new _0.BufferGeometry,new _0.PointsMaterial);return i.__globeObjType="particles",i}).onUpdateObj(function(i,r){var s=ot(t.particlesList),o=ot(t.particleLat),a=ot(t.particleLng),l=ot(t.particleAltitude);i.geometry.setAttribute("position",rl(s(r).map(function(u){return Object.values(jo(o(u),a(u),l(u)))}),3))})},update:function(e,t){["particlesData","particlesList","particleLat","particleLng","particleAltitude"].some(function(a){return t.hasOwnProperty(a)})&&e.dataMapper.digest(e.particlesData);var i=ot(e.particlesColor),r=ot(e.particlesSize),s=ot(e.particlesSizeAttenuation),o=ot(e.particlesTexture);e.dataMapper.entries().forEach(function(a){var l=Bi(a,2),u=l[0],A=l[1];if(A.material.size=r(u),A.material.sizeAttenuation=s(u),e.particlesTexture)A.material.color=new _0.Color(16777215),A.material.transparent=!1,A.material.alphaTest=.5,A.material.map=o(u);else{var p=i(u),g=da(p);A.material.color=new _0.Color(il(p)),A.material.transparent=g<1,A.material.opacity=g,A.material.alphaTest=0}})}}),rfe=window.THREE?window.THREE:{BufferGeometry:Ai},sfe=function(n){function e(){var t,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32;z2(this,e),t=q2(this,e),t.type="CircleLineGeometry",t.parameters={radius:i,segmentCount:r};for(var s=[],o=0;o<=r;o++){var a=(o/r-.25)*Math.PI*2;s.push({x:Math.cos(a)*i,y:Math.sin(a)*i,z:0})}return t.setFromPoints(s),t}return $2(e,n),H2(e)}(rfe.BufferGeometry),of=window.THREE?window.THREE:{Color:Ft,Group:Bs,Line:o2,LineBasicMaterial:SA,Vector3:ie},ofe=hA.default||hA,nD=ms({props:{ringsData:{default:[]},ringLat:{default:"lat"},ringLng:{default:"lng"},ringAltitude:{default:.0015},ringColor:{default:function(){return"#ffffaa"},triggerUpdate:!1},ringResolution:{default:64,triggerUpdate:!1},ringMaxRadius:{default:2,triggerUpdate:!1},ringPropagationSpeed:{default:1,triggerUpdate:!1},ringRepeatPeriod:{default:700,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},init:function(e,t,i){var r=i.tweenGroup;mi(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new to(e,{objBindAttr:"__threeObjRing",removeDelay:3e4}).onCreateObj(function(){var s=new of.Group;return s.__globeObjType="ring",s}),t.ticker=new ofe,t.ticker.onTick.add(function(s){if(t.ringsData.length){var o=ot(t.ringColor),a=ot(t.ringAltitude),l=ot(t.ringMaxRadius),u=ot(t.ringPropagationSpeed),A=ot(t.ringRepeatPeriod);t.dataMapper.entries().filter(function(p){var g=Bi(p,2),v=g[1];return v}).forEach(function(p){var g=Bi(p,2),v=g[0],x=g[1];if((x.__nextRingTime||0)<=s){var S=A(v)/1e3;x.__nextRingTime=s+(S<=0?1/0:S);var T=new of.Line(new sfe(1,t.ringResolution),new of.LineBasicMaterial),w=o(v),R=w instanceof Array||w instanceof Function,E;R?w instanceof Array?(E=kl().domain(w.map(function(V,H){return H/(w.length-1)})).range(w),T.material.transparent=w.some(function(V){return da(V)<1})):(E=w,T.material.transparent=!0):(T.material.color=new of.Color(il(w)),Vhe(T.material,da(w)));var N=Ei*(1+a(v)),D=l(v),B=D*Math.PI/180,I=u(v),O=I<=0,L=function(H){var Q=H.t,te=(O?1-Q:Q)*B;if(T.scale.x=T.scale.y=N*Math.sin(te),T.position.z=N*(1-Math.cos(te)),R){var K=E(Q);T.material.color=new of.Color(il(K)),T.material.transparent&&(T.material.opacity=da(K))}};if(I===0)L({t:0}),x.add(T);else{var F=Math.abs(D/I)*1e3;t.tweenGroup.add(new wo({t:0}).to({t:1},F).onUpdate(L).onStart(function(){return x.add(T)}).onComplete(function(){x.remove(T),qb(T)}).start())}}})}})},update:function(e){var t=ot(e.ringLat),i=ot(e.ringLng),r=ot(e.ringAltitude),s=e.scene.localToWorld(new of.Vector3(0,0,0));e.dataMapper.onUpdateObj(function(o,a){var l=t(a),u=i(a),A=r(a);Object.assign(o.position,jo(l,u,A)),o.lookAt(s)}).digest(e.ringsData)}}),afe={0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},ο:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"¦":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},Τ:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},Π:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},ΐ:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"²":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"–":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},Κ:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},ƒ:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},ό:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"»":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"©":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},ώ:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"«":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"∙":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},ÿ:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},µ:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},Ι:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},Ύ:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"’":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},Ν:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},ς:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},Ψ:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},ι:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},Ά:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},ε:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},Δ:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"‰":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"—":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},ρ:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"¯":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},Η:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},Α:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"…":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},ν:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"¶":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},β:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},Μ:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},Ό:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},Ή:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"•":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"¥":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},γ:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},α:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"­":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},Χ:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"†":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"°":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},Ξ:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "}," ":{x_min:0,x_max:0,ha:853},Ϋ:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"”":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},Ί:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},Β:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},υ:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},χ:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},ί:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},Ζ:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"¨":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"‹":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"„":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},δ:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},έ:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},ω:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"´":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"±":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},ϋ:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"§":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},Ω:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},ύ:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"™":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},ή:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},Θ:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"®":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},Ε:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"³":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},σ:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},ζ:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},θ:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},Ο:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},Γ:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},Έ:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},Ώ:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},Ϊ:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"½":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},Ρ:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},ª:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"΅":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},Φ:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"⁋":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},Σ:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"›":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"£":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"¬":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},λ:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},τ:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},ξ:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},Λ:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},ΰ:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"·":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},Υ:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},μ:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},φ:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"“":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"‘":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},ϊ:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},π:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},ά:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"¤":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},κ:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"‡":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},ψ:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},η:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},lfe="normal",ufe=1189,cfe=-100,hfe="normal",ffe={yMin:-334,xMin:-111,yMax:1189,xMax:1672},Afe=1e3,dfe={postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) Μagenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"Μagenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:`Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r
\r
Permission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r
\r
The above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r
\r
The Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r
\r
This License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r
\r
The Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r
\r
THE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.`,manufacturer_name:"Μagenta ltd",font_sub_family_name:"Regular"},pfe=-334,mfe="Helvetiker",gfe=1522,_fe=50,vfe={glyphs:afe,cssFontWeight:lfe,ascender:ufe,underlinePosition:cfe,cssFontStyle:hfe,boundingBox:ffe,resolution:Afe,original_font_information:dfe,descender:pfe,familyName:mfe,lineHeight:gfe,underlineThickness:_fe},ea=ai(ai({},window.THREE?window.THREE:{BoxGeometry:$u,CircleGeometry:a2,DoubleSide:_r,Group:Bs,Mesh:Jn,MeshLambertMaterial:ll,TextGeometry:CT,Vector3:ie}),{},{Font:mhe,TextGeometry:CT}),iD=ms({props:{labelsData:{default:[]},labelLat:{default:"lat"},labelLng:{default:"lng"},labelAltitude:{default:0},labelText:{default:"text"},labelSize:{default:.5},labelTypeFace:{default:vfe,onChange:function(e,t){t.font=new ea.Font(e)}},labelColor:{default:function(){return"lightgrey"}},labelRotation:{default:0},labelResolution:{default:3},labelIncludeDot:{default:!0},labelDotRadius:{default:.1},labelDotOrientation:{default:function(){return"bottom"}},labelsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;mi(e),t.scene=e,t.tweenGroup=r;var s=new ea.CircleGeometry(1,32);t.dataMapper=new to(e,{objBindAttr:"__threeObjLabel"}).onCreateObj(function(){var o=new ea.MeshLambertMaterial;o.side=_r;var a=new ea.Group;a.add(new ea.Mesh(s,o));var l=new ea.Mesh(void 0,o);a.add(l);var u=new ea.Mesh;return u.visible=!1,l.add(u),a.__globeObjType="label",a})},update:function(e){var t=ot(e.labelLat),i=ot(e.labelLng),r=ot(e.labelAltitude),s=ot(e.labelText),o=ot(e.labelSize),a=ot(e.labelRotation),l=ot(e.labelColor),u=ot(e.labelIncludeDot),A=ot(e.labelDotRadius),p=ot(e.labelDotOrientation),g=new Set(["right","top","bottom"]),v=2*Math.PI*Ei/360;e.dataMapper.onUpdateObj(function(x,S){var T=Bi(x.children,2),w=T[0],R=T[1],E=Bi(R.children,1),N=E[0],D=l(S),B=da(D);R.material.color.set(il(D)),R.material.transparent=B<1,R.material.opacity=B;var I=u(S),O=p(S);!I||!g.has(O)&&(O="bottom");var L=I?+A(S)*v:1e-12;w.scale.x=w.scale.y=L;var F=+o(S)*v;if(R.geometry&&R.geometry.dispose(),R.geometry=new ea.TextGeometry(s(S),{font:e.font,size:F,depth:0,bevelEnabled:!0,bevelThickness:0,bevelSize:0,curveSegments:e.labelResolution}),N.geometry&&N.geometry.dispose(),R.geometry.computeBoundingBox(),N.geometry=Vb(ea.BoxGeometry,fi(new ea.Vector3().subVectors(R.geometry.boundingBox.max,R.geometry.boundingBox.min).toArray())),O!=="right"&&R.geometry.center(),I){var V=L+F/2;O==="right"&&(R.position.x=V),R.position.y={right:-F/2,top:V+F/2,bottom:-V-F/2}[O]}var H=function(W){var Z=x.__currentTargetD=W,J=Z.lat,fe=Z.lng,ge=Z.alt,pe=Z.rot,Ae=Z.scale;Object.assign(x.position,jo(J,fe,ge)),x.lookAt(e.scene.localToWorld(new ea.Vector3(0,0,0))),x.rotateY(Math.PI),x.rotateZ(-pe*Math.PI/180),x.scale.x=x.scale.y=x.scale.z=Ae},Q={lat:+t(S),lng:+i(S),alt:+r(S),rot:+a(S),scale:1},te=x.__currentTargetD||Object.assign({},Q,{scale:1e-12});Object.keys(Q).some(function(K){return te[K]!==Q[K]})&&(!e.labelsTransitionDuration||e.labelsTransitionDuration<0?H(Q):e.tweenGroup.add(new wo(te).to(Q,e.labelsTransitionDuration).easing(Xr.Quadratic.InOut).onUpdate(H).start()))}).digest(e.labelsData)}}),yfe=ai(ai({},window.THREE?window.THREE:{}),{},{CSS2DObject:vhe}),rD=ms({props:{htmlElementsData:{default:[]},htmlLat:{default:"lat"},htmlLng:{default:"lng"},htmlAltitude:{default:0},htmlElement:{},htmlElementVisibilityModifier:{triggerUpdate:!1},htmlTransitionDuration:{default:1e3,triggerUpdate:!1},isBehindGlobe:{onChange:function(){this.updateObjVisibility()},triggerUpdate:!1}},methods:{updateObjVisibility:function(e,t){if(e.dataMapper){var i=t?[t]:e.dataMapper.entries().map(function(r){var s=Bi(r,2),o=s[1];return o}).filter(function(r){return r});i.forEach(function(r){var s=!e.isBehindGlobe||!e.isBehindGlobe(r.position);e.htmlElementVisibilityModifier?(r.visible=!0,e.htmlElementVisibilityModifier(r.element,s)):r.visible=s})}}},init:function(e,t,i){var r=i.tweenGroup;mi(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new to(e,{objBindAttr:"__threeObjHtml"}).onCreateObj(function(s){var o=ot(t.htmlElement)(s),a=new yfe.CSS2DObject(o);return a.__globeObjType="html",a})},update:function(e,t){var i=this,r=ot(e.htmlLat),s=ot(e.htmlLng),o=ot(e.htmlAltitude);t.hasOwnProperty("htmlElement")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(a,l){var u=function(g){var v=a.__currentTargetD=g,x=v.alt,S=v.lat,T=v.lng;Object.assign(a.position,jo(S,T,x)),i.updateObjVisibility(a)},A={lat:+r(l),lng:+s(l),alt:+o(l)};!e.htmlTransitionDuration||e.htmlTransitionDuration<0||!a.__currentTargetD?u(A):e.tweenGroup.add(new wo(a.__currentTargetD).to(A,e.htmlTransitionDuration).easing(Xr.Quadratic.InOut).onUpdate(u).start())}).digest(e.htmlElementsData)}}),i1=window.THREE?window.THREE:{Group:Bs,Mesh:Jn,MeshLambertMaterial:ll,SphereGeometry:al},sD=ms({props:{objectsData:{default:[]},objectLat:{default:"lat"},objectLng:{default:"lng"},objectAltitude:{default:.01},objectFacesSurface:{default:!0},objectRotation:{},objectThreeObject:{default:new i1.Mesh(new i1.SphereGeometry(1,16,8),new i1.MeshLambertMaterial({color:"#ffffaa",transparent:!0,opacity:.7}))}},init:function(e,t){mi(e),t.scene=e,t.dataMapper=new to(e,{objBindAttr:"__threeObjObject"}).onCreateObj(function(i){var r=ot(t.objectThreeObject)(i);t.objectThreeObject===r&&(r=r.clone());var s=new i1.Group;return s.add(r),s.__globeObjType="object",s})},update:function(e,t){var i=ot(e.objectLat),r=ot(e.objectLng),s=ot(e.objectAltitude),o=ot(e.objectFacesSurface),a=ot(e.objectRotation);t.hasOwnProperty("objectThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(l,u){var A=+i(u),p=+r(u),g=+s(u);Object.assign(l.position,jo(A,p,g)),o(u)?l.setRotationFromEuler(new Qr(Nc(-A),Nc(p),0,"YXZ")):l.rotation.set(0,0,0);var v=l.children[0],x=a(u);x&&v.setRotationFromEuler(new Qr(Nc(x.x||0),Nc(x.y||0),Nc(x.z||0)))}).digest(e.objectsData)}}),oD=ms({props:{customLayerData:{default:[]},customThreeObject:{},customThreeObjectUpdate:{triggerUpdate:!1}},init:function(e,t){mi(e),t.scene=e,t.dataMapper=new to(e,{objBindAttr:"__threeObjCustom"}).onCreateObj(function(i){var r=ot(t.customThreeObject)(i,Ei);return r&&(t.customThreeObject===r&&(r=r.clone()),r.__globeObjType="custom"),r})},update:function(e,t){e.customThreeObjectUpdate||mi(e.scene);var i=ot(e.customThreeObjectUpdate);t.hasOwnProperty("customThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(r,s){return i(r,s,Ei)}).digest(e.customLayerData)}}),r1=window.THREE?window.THREE:{Camera:rp,Group:Bs,Vector2:at,Vector3:ie},xfe=["globeLayer","pointsLayer","arcsLayer","hexBinLayer","heatmapsLayer","polygonsLayer","hexedPolygonsLayer","pathsLayer","tilesLayer","particlesLayer","ringsLayer","labelsLayer","htmlElementsLayer","objectsLayer","customLayer"],aD=Us("globeLayer",HL),bfe=Object.assign.apply(Object,fi(["globeImageUrl","bumpImageUrl","globeTileEngineUrl","globeTileEngineMaxLevel","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude"].map(function(n){return Vr({},n,aD.linkProp(n))}))),wfe=Object.assign.apply(Object,fi(["globeMaterial"].map(function(n){return Vr({},n,aD.linkMethod(n))}))),Sfe=Us("pointsLayer",$L),Tfe=Object.assign.apply(Object,fi(["pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration"].map(function(n){return Vr({},n,Sfe.linkProp(n))}))),Mfe=Us("arcsLayer",jL),Efe=Object.assign.apply(Object,fi(["arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration"].map(function(n){return Vr({},n,Mfe.linkProp(n))}))),Cfe=Us("hexBinLayer",XL),Rfe=Object.assign.apply(Object,fi(["hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration"].map(function(n){return Vr({},n,Cfe.linkProp(n))}))),Nfe=Us("heatmapsLayer",YL),Pfe=Object.assign.apply(Object,fi(["heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration"].map(function(n){return Vr({},n,Nfe.linkProp(n))}))),Lfe=Us("hexedPolygonsLayer",KL),Dfe=Object.assign.apply(Object,fi(["hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration"].map(function(n){return Vr({},n,Lfe.linkProp(n))}))),Ife=Us("polygonsLayer",ZL),Bfe=Object.assign.apply(Object,fi(["polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration"].map(function(n){return Vr({},n,Ife.linkProp(n))}))),Ffe=Us("pathsLayer",JL),Ufe=Object.assign.apply(Object,fi(["pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration"].map(function(n){return Vr({},n,Ffe.linkProp(n))}))),Ofe=Us("tilesLayer",eD),kfe=Object.assign.apply(Object,fi(["tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration"].map(function(n){return Vr({},n,Ofe.linkProp(n))}))),Vfe=Us("particlesLayer",tD),Gfe=Object.assign.apply(Object,fi(["particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture"].map(function(n){return Vr({},n,Vfe.linkProp(n))}))),qfe=Us("ringsLayer",nD),zfe=Object.assign.apply(Object,fi(["ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod"].map(function(n){return Vr({},n,qfe.linkProp(n))}))),Hfe=Us("labelsLayer",iD),$fe=Object.assign.apply(Object,fi(["labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration"].map(function(n){return Vr({},n,Hfe.linkProp(n))}))),Wfe=Us("htmlElementsLayer",rD),jfe=Object.assign.apply(Object,fi(["htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration"].map(function(n){return Vr({},n,Wfe.linkProp(n))}))),Xfe=Us("objectsLayer",sD),Qfe=Object.assign.apply(Object,fi(["objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject"].map(function(n){return Vr({},n,Xfe.linkProp(n))}))),Yfe=Us("customLayer",oD),Zfe=Object.assign.apply(Object,fi(["customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(n){return Vr({},n,Yfe.linkProp(n))}))),Kfe=ms({props:ai(ai(ai(ai(ai(ai(ai(ai(ai(ai(ai(ai(ai(ai(ai({onGlobeReady:{triggerUpdate:!1},rendererSize:{default:new r1.Vector2(window.innerWidth,window.innerHeight),onChange:function(e,t){t.pathsLayer.rendererSize(e)},triggerUpdate:!1}},bfe),Tfe),Efe),Rfe),Pfe),Bfe),Dfe),Ufe),kfe),Gfe),zfe),$fe),jfe),Qfe),Zfe),methods:ai({getGlobeRadius:PT,getCoords:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return jo.apply(void 0,i)},toGeoCoords:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return zL.apply(void 0,i)},setPointOfView:function(e,t){var i=t instanceof r1.Camera?t.position:t,r=PT(),s=void 0;if(e.scene&&i){var o,a,l,u;s=function(p){o===void 0&&(o=i.clone().applyMatrix4(e.scene.matrixWorld.clone().invert())),a===void 0&&(a=o.length()),l===void 0&&(l=Math.sqrt(Math.pow(a,2)-Math.pow(r,2))),u===void 0&&(u=Math.acos(l/a));var g=o.distanceTo(p);if(g<l)return!1;var v=p.length(),x=Math.acos((Math.pow(a,2)+Math.pow(g,2)-Math.pow(v,2))/(2*a*g));return x<u}}e.layersThatNeedUpdatePov.forEach(function(A){return A.updatePov(t)}),e.layersThatNeedBehindGlobeChecker.forEach(function(A){return A.isBehindGlobe(s)})},pauseAnimation:function(e){return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),e.pausableLayers.forEach(function(t){var i;return(i=t.pauseAnimation)===null||i===void 0?void 0:i.call(t)}),this},resumeAnimation:function(e){return e.animationFrameRequestId===null&&this._animationCycle(),e.pausableLayers.forEach(function(t){var i;return(i=t.resumeAnimation)===null||i===void 0?void 0:i.call(t)}),this},_animationCycle:function(e){e.animationFrameRequestId=requestAnimationFrame(this._animationCycle),e.tweenGroup.update()},_destructor:function(e){this.pauseAnimation(),e.destructableLayers.forEach(function(t){return t._destructor()})}},wfe),stateInit:function(){var e=new NE,t={tweenGroup:e},i={globeLayer:HL(t),pointsLayer:$L(t),arcsLayer:jL(t),hexBinLayer:XL(t),heatmapsLayer:YL(t),polygonsLayer:ZL(t),hexedPolygonsLayer:KL(t),pathsLayer:JL(t),tilesLayer:eD(t),particlesLayer:tD(t),ringsLayer:nD(t),labelsLayer:iD(t),htmlElementsLayer:rD(t),objectsLayer:sD(t),customLayer:oD(t)};return ai(ai({tweenGroup:e},i),{},{layersThatNeedUpdatePov:Object.values(i).filter(function(r){return r.hasOwnProperty("updatePov")}),layersThatNeedBehindGlobeChecker:Object.values(i).filter(function(r){return r.hasOwnProperty("isBehindGlobe")}),destructableLayers:Object.values(i).filter(function(r){return r.hasOwnProperty("_destructor")}),pausableLayers:Object.values(i).filter(function(r){return r.hasOwnProperty("pauseAnimation")})})},init:function(e,t,i){var r=i.animateIn,s=r===void 0?!0:r,o=i.waitForGlobeReady,a=o===void 0?!0:o;mi(e),t.scene=e,t.scene.visible=!1,xfe.forEach(function(u){var A=new r1.Group;t.scene.add(A),t[u](A)});var l=function(){if(s){t.scene.scale.set(1e-6,1e-6,1e-6),t.tweenGroup.add(new wo({k:1e-6}).to({k:1},600).easing(Xr.Quadratic.Out).onUpdate(function(p){var g=p.k;return t.scene.scale.set(g,g,g)}).start());var A=new r1.Vector3(0,1,0);t.tweenGroup.add(new wo({rot:Math.PI*2}).to({rot:0},1200).easing(Xr.Quintic.Out).onUpdate(function(p){var g=p.rot;return t.scene.setRotationFromAxisAngle(A,g)}).start())}t.scene.visible=!0,t.onGlobeReady&&t.onGlobeReady()};a?t.globeLayer.onReady(l):l(),this._animationCycle()},update:function(e){}});function Jfe(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=function(r){function s(){var o;z2(this,s);for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return o=q2(this,s,[].concat(l)),o.__kapsuleInstance=Vb(n,[].concat(fi(t?[o]:[]),l)),o}return $2(s,r),H2(s)}(e);return Object.keys(n()).forEach(function(r){return i.prototype[r]=function(){var s,o=(s=this.__kapsuleInstance)[r].apply(s,arguments);return o===this.__kapsuleInstance?this:o}}),i}var eAe=window.THREE?window.THREE:{Group:Bs},tAe=Jfe(Kfe,eAe.Group,!0);function nAe(){const e=document.createElement("canvas");e.width=e.height=128;const t=e.getContext("2d"),i=t.createRadialGradient(128/2,128/2,0,128/2,128/2,128/2);return i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(.2,"rgba(255,255,255,0.6)"),i.addColorStop(1,"rgba(255,255,255,0)"),t.fillStyle=i,t.fillRect(0,0,128,128),new Cq(e)}const VT="globe-viz",iAe="./img/earth_night.jpg",rAe=50,sAe=600,oAe={__name:"leo-3d-earth-hero",props:{readyDelay:{type:Number,default:500},isZoomOut:{type:Boolean,default:!1}},emits:["onReady"],setup(n,{emit:e}){const t=n,i=e,r=Ln(null);let s=null,o=null;const A=class A{constructor(g,v={}){this.targetId=g,this.moving=!0,this.lastRenderTime=0,this.renderInterval=1e3/60,this.options={arcsCount:50,spotsCount:500,globeTextureUrl:"",colors:["#00F4DC","#8D41D9"],cameraSpeed:.05,rotationSpeed:{x:25e-5,y:.001},zoomSpeed:2,maxZoom:350,...v},this.scene=null,this.camera=null,this.renderer=null,this.globe=null,this.animationId=null}init(){const g=this.generateArcData(this.options.arcsCount),v=this.generateSpotData(this.options.spotsCount);this.globe=new tAe().globeImageUrl(this.options.globeTextureUrl).arcsData(g).arcColor("color").arcAltitude(.25).arcAltitudeAutoScale(1).arcDashLength(.5).arcDashGap(4).arcDashInitialGap(()=>Math.random()*5).arcDashAnimateTime(2e3).arcStroke(.5).customLayerData(v).customThreeObject(S=>this.createCustomObject(S)).customThreeObjectUpdate((S,T)=>{Object.assign(S.position,this.globe.getCoords(T.lat,T.lng,T.alt))}),this.renderer=new fX({alpha:!0}),this.renderer.setClearColor(0,0),this.renderer.setSize(document.documentElement.clientWidth,window.innerHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2));const x=document.getElementById(this.targetId);return x&&x.appendChild(this.renderer.domElement),this}setScene(){return this.scene=new r2,this.globe&&this.scene.add(this.globe),this}setCamera({position:g}){return this.camera=new Br(50,document.documentElement.clientWidth/window.innerHeight,.1,1e3),this.camera.position.set(...g),this.options.cameraPosition=g,this}setLight(){if(!this.scene)return this;const g=new xE(13421772,1*Math.PI),v=new yE(16777215,10*Math.PI);return v.position.set(-15,75,-25),v.castShadow=!0,this.scene.add(g),this.scene.add(v),this}animate(){let g=!0;const v=x=>{if(this.animationId=requestAnimationFrame(v),!(x-this.lastRenderTime<this.renderInterval)){if(this.lastRenderTime=x,this.moving)if(t.isZoomOut){let S=!1;Math.abs(this.camera.position.x)>.1?(this.camera.position.x+=(0-this.camera.position.x)*this.options.cameraSpeed,S=!0):this.camera.position.x=0,Math.abs(this.camera.position.y)>.1?(this.camera.position.y+=(0-this.camera.position.y)*this.options.cameraSpeed,S=!0):this.camera.position.y=0,this.camera.translateZ(this.options.zoomSpeed),!S&&this.camera.position.z>=this.options.maxZoom&&(this.moving=!1)}else{const[S,T,w]=this.options.cameraPosition;let R=!1;if(Math.abs(this.camera.position.x-S)>.1?(this.camera.position.x+=(S-this.camera.position.x)*this.options.cameraSpeed,R=!0):this.camera.position.x=S,Math.abs(this.camera.position.y-T)>.1?(this.camera.position.y+=(T-this.camera.position.y)*this.options.cameraSpeed,R=!0):this.camera.position.y=T,Math.abs(this.camera.position.z-w)>.1){const E=this.camera.position.z,N=(w-E)*this.options.cameraSpeed;this.camera.translateZ(N/Math.abs(N||1)*this.options.zoomSpeed),R=!0}else this.camera.position.z=w;R||(this.camera.position.set(S,T,w),this.moving=!1)}this.camera.position.z>this.options.maxZoom&&(this.camera.position.z=this.options.maxZoom),this.globe&&(this.globe.rotation.y+=this.options.rotationSpeed.y,this.globe.rotation.x+=this.options.rotationSpeed.x),this.renderer&&this.scene&&this.camera&&(this.renderer.render(this.scene,this.camera),g&&(setTimeout(()=>{i("onReady")},t.readyDelay),g=!1))}};return v(),this}generateArcData(g){return[...Array(g).keys()].map(()=>({startLat:(Math.random()-.5)*180,startLng:(Math.random()-.5)*360,endLat:(Math.random()-.5)*180,endLng:(Math.random()-.5)*360,color:this.options.colors[Math.floor(Math.random()*this.options.colors.length)]}))}generateSpotData(g){return[...Array(g).keys()].map(()=>({lat:(Math.random()-.5)*180,lng:(Math.random()-.5)*360,alt:Math.random()*.15,radius:Math.random()*1,color:this.options.colors[Math.round(Math.random()*(this.options.colors.length-1))]}))}static getMaterial(g){const v=g.toString();if(!this.materialPool.has(v)){const x=this.sharedSpriteMaterial.clone();x.color=new Ft(g),this.materialPool.set(v,x)}return this.materialPool.get(v)}createCustomObject(g){const v=new Jn(A.sharedSphereGeometry,new ll({color:g.color}));v.scale.set(g.radius,g.radius,g.radius);const x=A.getMaterial(g.color),S=new wq(x);S.scale.set(g.radius*6,g.radius*6,1);const T=new Bs;return T.add(v),T.add(S),T}stop(){return this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this}resetCamera(){return this.camera&&(this.camera.position.set(...this.options.cameraPosition),this.moving=!0),this}updateRotationSpeed(g,v){return this.options.rotationSpeed.x=g,this.options.rotationSpeed.y=v,this}resize(){return this.camera&&this.renderer&&(this.camera.aspect=document.documentElement.clientWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(document.documentElement.clientWidth,window.innerHeight)),this}dispose(){return this.stop(),this.scene&&(this.scene.traverse(g=>{g.geometry&&g.geometry.dispose(),g.material&&(Array.isArray(g.material)?g.material.forEach(v=>v.dispose()):g.material.dispose())}),this.scene.clear()),A.materialPool&&(A.materialPool.forEach(g=>g.dispose()),A.materialPool.clear()),this.renderer&&(this.renderer.dispose(),this.renderer.domElement.remove()),this}};OA(A,"sharedSphereGeometry",new al(1,8,8)),OA(A,"sharedGlowTexture",nAe()),OA(A,"sharedSpriteMaterial",new Zx({map:A.sharedGlowTexture,color:16777215,transparent:!0,opacity:.5,depthWrite:!1,blending:Qc})),OA(A,"materialPool",new Map);let a=A;Yl(()=>{s=new a(VT,{arcsCount:rAe,spotsCount:sAe,globeTextureUrl:iAe}),s.init().setScene().setCamera({position:[-100,50,200]}).setLight().animate(),jr(()=>t.isZoomOut,()=>{s&&(s.moving=!0)}),window.addEventListener("resize",u),o=new IntersectionObserver(l,{threshold:0}),o.observe(r.value)}),Yd(()=>{s&&(s.dispose(),s=null),window.removeEventListener("resize",u),o.disconnect()});function l(p){p.forEach(g=>{g.isIntersecting?(s==null||s.resetCamera(),s==null||s.animate()):s==null||s.stop()})}function u(){s&&(s.resetCamera(),s.resize())}return(p,g)=>(lt(),pt("div",{id:VT,ref_key:"globeContainer",ref:r,class:"leo-hero-earth w-full overflow-hidden"},null,512))}},Uf=_t({__name:"leo-scroll-trigger",props:{threshold:{},rootMargin:{},disabled:{type:Boolean},scrollHeight:{},devMode:{type:Boolean}},emits:["change"],setup(n,{expose:e,emit:t}){const i=n,r=t,s=Ln(null),o=Ln(!1);let a=null;e({triggerRef:s,isIntersecting:o}),jr(()=>i.disabled,u=>{u?a==null||a.disconnect():(l(),s.value&&a.observe(s.value))}),Yl(()=>{i.disabled||(l(),s.value&&a.observe(s.value))}),Yd(()=>{a==null||a.disconnect()});function l(){a&&a.disconnect(),a=new IntersectionObserver(u=>{u.forEach(A=>{o.value=A.isIntersecting,r("change",A.isIntersecting,A)})},{threshold:i.threshold??.1,rootMargin:i.rootMargin??"0px"})}return(u,A)=>(lt(),pt("div",{ref_key:"triggerRef",ref:s,class:On(["l-scroll-trigger",u.devMode?"relative z-100 w-full border border-red-500":""]),style:pa({"--scroll-height":i.scrollHeight||"auto"})},[Ti(u.$slots,"default",{isIntersecting:o.value})],6))}});function Hb({category:n,action:e,label:t}){if(console.log("sendGA",n,e,t),typeof window>"u")return console.error("GA not ready");if(!e||!t)return console.error("GA event missing params");window.gtag&&window.gtag("event",e,{event_category:n,[n]:t}),window.ga&&window.ga("send",{hitType:"event",eventCategory:n,eventAction:e,eventLabel:t,eventValue:""})}const aAe="太空經濟",lAe="低軌衛星競賽升溫",uAe="據衛星資料庫CelesTrak統計，截至今年6月30日，有超過11,989顆<span class='country-label white'>人造衛星</span>在太空中運行。",cAe="人造衛星依運行的軌道高度可分為低軌、中軌、高軌，目前超過9成人造衛星，都是運行在距離地表2000公里以內的<span class='country-label orange'>低軌衛星</span>。",hAe="低軌衛星因距離地球近，訊號傳遞具有低延遲、高速等特性，多應用在通訊，高盛預估未來5年將有多達7萬顆低軌衛星發射；至2035年，衛星市場規模將從目前的150億美元成長到4570億美元。",fAe="其中，富豪馬斯克旗下<span class='country-label green'>SpaceX</span>的星鏈計畫，就占了7,841顆，占比超過6成。",AAe="其餘廠商如歐洲的<span class='country-label yellow'>Eutelsat OneWeb</span>、亞馬遜（Amazon）旗下的<span class='country-label purple'>Kuiper</span>計畫，也正在積極追上SpaceX腳步。OneWeb目前運行的衛星數量約有651顆，Kuiper則在今年4月底發射第一批衛星，目前共54顆運行中，正式加入低軌衛星戰局。",dAe="經濟部產發署統計，目前已有51家台廠打入前兩大低軌衛星營運商SpaceX、OneWeb供應鏈，多家廠商已成功卡位關鍵節點。不過，台廠目前在低軌衛星產業供應鏈中以代工居多，較缺乏系統整合與設計能力，角色被動，如何從OEM（代工製造）走向ODM（設計製造），甚至開展應用服務、尋找更多商業機會，是下一步挑戰。",pAe="台廠數量",mAe="衛星本體 / 酬載",gAe="100＋",_Ae="包含衛星主結構、衛星電腦與遙測酬載等關鍵技術，是政府與企業打造自主太空產業、強化國家競爭力的核心能力。",vAe="立方衛星",yAe="10＋",xAe="小型衛星，以邊長10公分的立方體為一標準單位（1U），研發、製造的時間與成本皆較低，許多台廠會選擇以立方衛星作為開發整顆衛星的起點。",bAe="地面設備",wAe="140＋",SAe="包含射頻微波元件、天線次系統、地面站等核心項目，也是擁有資通訊、半導體等優勢的台廠主要切入領域。",TAe="衛星發射",MAe="15＋",EAe="包含衛星發射服務、火箭元件／研製等領域，是建立自主發射能力、提升戰略自主性的關鍵環節。",CAe="衛星服務",RAe="35＋",NAe="包含衛星通訊、衛星廣播電視等延伸應用，讓太空技術得以落地、擴展產業價值。",PAe="看完整台廠名單",LAe="查看完整資訊",DAe="資料來源／國家太空中心、記者整理",IAe="從地面到天上 台灣太空產業現況一覽",BAe="深入解讀",FAe="圖解1.8兆美元太空商機：食衣住行產業全包 超乎想像",UAe="https://vip.udn.com/vip/story/122861/8688226",OAe="地緣政治下的太空經濟 台廠如何在供應鏈中突圍？",kAe="https://vip.udn.com/vip/story/121938/8733840",VAe="從遠洋漁業看到太空商機 台廠老牌力拚衛星應用新藍海",GAe="https://vip.udn.com/vip/story/121938/8702769",ex={title:aAe,subTitle:lAe,p1t1:uAe,p2t1:cAe,p2t2:hAe,p3t1:fAe,p4t1:AAe,p5t1:dAe,featFactory:pAe,feat1Title:mAe,feat1Number:gAe,feat1Desc:_Ae,feat2Title:vAe,feat2Number:yAe,feat2Desc:xAe,feat3Title:bAe,feat3Number:wAe,feat3Desc:SAe,feat4Title:TAe,feat4Number:MAe,feat4Desc:EAe,feat5Title:CAe,feat5Number:RAe,feat5Desc:NAe,feat6Title:PAe,featReadMore:LAe,featCaption:DAe,dialogTitle:IAe,relatedTitle:BAe,related1Title:FAe,related1Link:UAe,related2Title:OAe,related2Link:kAe,related3Title:VAe,related3Link:GAe},qAe="國安戰場",zAe="地緣角力升空對峙",HAe="對各國政府而言，太空除牽涉經濟，更受關注的是國家安全。俄烏戰爭爆發後，從馬斯克旗下SpaceX星鏈提供的關鍵通訊服務，到美國總統川普和烏克蘭總統澤倫斯基在白宮談判不歡而散後，美國一度暫停提供烏克蘭衛星軍事情報，都一再凸顯出太空在地緣衝突中的影響力。",$Ae="此外，川普5月時宣布將打造涵蓋美國全境的「金穹」（Golden Dome）飛彈防禦系統，金穹主要藉由衛星網絡，在太空部署感測器和攔截器，來防禦來襲的彈道飛彈、極音速飛彈等武器。消息一出引發中俄兩大國反彈，有軍事專家擔憂中俄勢必採取反制措施，例如開發太空核武來攻擊金穹，讓「太空戰場化」更具體展現在世人面前。",WAe="Graph Title",jAe="Graph Caption",XAe="近年全球主要大國紛紛成立太空軍，在太空部屬監偵、防禦甚至攻擊能力。根據Novaspace最新的全球太空國防安全報告，2023年全球有超過52個國家，在太空防禦和安全方面投資至少1000萬美元；美國、中國投資金額高居全球第一和第二名，分別投入389億和88億美元，光是美中，就占了全球整體投資金額超過8成。",QAe="Graph Title",YAe="Graph Caption",ZAe="各國對太空國防的投資主要分布在10個領域，情報、監視和偵察（ISR）占比最高，主要藉由衛星蒐集更多情報、監控友軍或敵方的軍事資產；2023年，17個國家共發射了107顆國防衛星，比2022年增加了40％。",KAe="從太空防禦和安全投資的金額分布可看到，與地表態勢相同，太空中現在也逐漸演變成美中兩大陣營之間的對抗，隨著太空技術持續發展、各國競相投入，雙方競賽已不只停留在資源和能力較量，更要爭奪外太空秩序、規則建立與治理的主導權。",JAe="Graph Caption",e0e="目前太空治理主要仰賴聯合國於1967年通過的《外太空條約》（Outer Space Treaty），規定締約國需對其政府與民間的太空活動負責。根據聯合國外太空事務廳（UNOOSA）統計，截至2025年1月，共有139個國家已批准、加入或簽署該條約，但隨著全球在太空領域的投資與競爭日益升溫，條約內容已無法跟上目前各國發展現況與技術演進，實質約束力與規範效用正面臨挑戰。",t0e="註：資料統計截至2025年5月14日。",n0e="資料來源／美國太空總署（NASA）、美國外交關係委員會（CFR）、記者整理",i0e="兩大強權、美國與中國對新太空話語權的爭奪展現在月球探索領域。美中目前各自主導「阿提米絲計畫」（Artemis Program）與「國際月球科研站」（ILRS），各自拉攏盟友；此外，美國也與全球54個國家簽署《阿提米絲協議》（Artemis Accords），要求簽署國須遵循《外太空條約》，以及明訂進行太空活動時須遵循的準則和責任。",r0e="當各國都以行動承認太空是「作戰領域」，太空國安布局牽涉監視、偵察、SDA（太空領域感知）等能力，以及攸關金融系統、關鍵基礎設施、對外聯絡穩定的通訊安全。台灣在競爭局勢下，要如何發展具自主性的太空國防能力，並記取烏克蘭前車之鑑、避免受制於人，已是台灣無可迴避的課題。",s0e="深入解讀",o0e="太空「點穴戰」 中、美部署監視能力 台灣如何不受制於人？",a0e="https://vip.udn.com/vip/story/122870/8612234",l0e="川普暗示放棄登月？美國盟友擔心中國將掌控太空話語權",u0e="https://vip.udn.com/vip/story/122870/8597916",c0e="中國發展可回收火箭航太進步飛速 能追得上SpaceX？",h0e="https://vip.udn.com/vip/story/122870/8647943",f0e="台灣在內！一年30萬架客機遭GPS欺騙攻擊 國際專家解析",A0e="https://vip.udn.com/vip/story/121937/8673276",ki={title:qAe,subTitle:zAe,p1t1:HAe,p1t2:$Ae,g1Title:WAe,g1Caption:jAe,p2t1:XAe,g2Title:QAe,g2Caption:YAe,p3t1:ZAe,p3t2:KAe,g3Caption:JAe,p4t1:e0e,g4Caption1:t0e,g4Caption2:n0e,p5t1:i0e,p5t2:r0e,relatedTitle:s0e,related1Title:o0e,related1Link:a0e,related2Title:l0e,related2Link:u0e,related3Title:c0e,related3Link:h0e,related4Title:f0e,related4Link:A0e},d0e="重返月球",p0e="強權爭奪月面寶藏",m0e="在衛星與軍備之外，另一場關鍵競逐也在逐步升空——月球正成為強權爭奪的新前線。從1972年美國停止載人登月計畫之後，月球曾暫時消失在各國視野中，但過了半世紀，各國又重新燃起登月興趣，首要目的為展現國力，英國科學作家莫頓（Oliver Morton）接受BBC採訪時直言：「沒有什麼比『把人類從地球帶到月球』聽起來更壯觀。」其次，月球上蘊含的豐富資源，也是各國野心勃勃的原因。",g0e="在這波重返月球浪潮中，台灣沒有缺席，在今年上半年踏出關鍵一步。今年5月，日本太空新創ispace宣布旗下HAKUTO-R Mission 2成功進入月球軌道，載具外側搭載的，正是中央大學團隊研發的深太空輻射探測儀（DSRP）。雖然ispace於6月6日證實，登月小艇最後未能成功完成月球軟著陸，但這項合作仍寫下「Made in Taiwan」最接近月球的紀錄，也象徵台灣首次參與國際登月任務，為深空探索奠定重要基礎。",_0e="HAKUTO-R Mission 2「 RESILIENCE」著陸器",v0e="發射日期 2025.01.15",y0e="高度： 2.3公尺",x0e="寬度： 2.6公尺（支撐腳伸出）",b0e="重量：340公斤（乾） 1000公斤（濕）",w0e="預計登月地點：月球北半球冷海附近，月面座標北緯60.5度、西經4.6度",S0e="註：濕重量指滿載燃料、推進劑、耗材等所有任務所需附加物質的總重量，因此會比乾重量重。",T0e="根據國際太空市場情報公司Novaspace報告，2023年月球探索投資總額已達110億美元。其中美國投資金額最高，占85億美元。中國則投入近15億美元，並計畫大幅擴張，預估到2032年將提升至約40億美元，增幅達1.6倍。未來10年，全球月球探索投資預計每年將成長5％，角力持續升溫。",M0e="在冷戰高峰期的太空競賽中，蘇聯是史上首個將人造物體送上月球的國家。1959年9月14日，月球2號（Luna 2）成功撞擊月球表面，為人類探索月球揭開序幕。同年，月球3號（Luna 3）執行飛掠任務，拍攝並傳回史上第一張月背影像。",E0e="蘇聯月球3號傳回史上首張月背照片。圖／NASA",C0e="從1959年至1976年間，蘇聯共發射49次月球探測任務，其中有9次成功著陸月球，儘管蘇聯在登月領域創下許多壯舉，但最終未能實現載人登月。",R0e="繼蘇聯率先登月近5年之後，美國迎頭趕上，1964年7月31日，游騎兵7號成功撞擊月球表面，並傳回美國史上第一張由太空飛行器拍攝的月球影像。",N0e="游騎兵7號太空船傳回首張由美國太空飛行器拍攝的月球影像。圖／NASA",P0e="美蘇兩強太空競賽期間，美國共發射39次月球探測任務，最終在1969年7月21日迎來巔峰 —— 阿波羅11號登陸月球，太空人尼爾．阿姆斯壯（Neil Armstrong）和巴茲．艾德林（Buzz Aldrin）踏出歷史性的一步，成為人類首度登月的代表，也象徵美國在這場太空競賽爭取得領先。",L0e="太空人尼爾．阿姆斯壯和巴茲．艾德林成為史上首度登月的人類。圖／NASA、美聯社",D0e="然而，隨著冷戰結束與資源轉移，登月熱潮逐漸退去，人類似乎遺忘月球。",I0e="沉寂半世紀的登月競賽，隨著中國崛起再度被點燃。2013年12月14日，中國「嫦娥三號」探測器成功登月，搭載中國首輛月球車「玉兔號」，這輛原設計壽命僅三個月的月球車，最終在月面持續運作長達972日，突破技術極限。",B0e="圖為嫦娥三號所拍攝的月表照片。圖／嫦娥三號、新華社",F0e="在國家力量傾力扶植下，中國不僅加速追趕，更將探索範圍延伸至月球背面。2024年6月，中國探測器「嫦娥六號」成功攜回人類史上首批月球背面地質樣本，引發全球關注；今年5月中國更與俄羅斯國家航太集團簽訂合作備忘錄，計畫在月球建立核電廠，為中俄主導的國際月球科研站提供自主、穩定能源。",U0e="2024年，嫦娥六號成功攜回月球背面地質樣本。圖／新華社",O0e="月球南極則因可能蘊藏水冰資源，近年成為兵家必爭之地，2023年8月23日，印度探測器維克拉姆（Vikram）成功登陸月球南極，成為全球首個抵達該區域的國家，象徵新興國家在太空版圖的崛起；中國則預計在2026年發射「嫦娥七號」，針對月球南極展開資源探勘任務；由美國主導的阿提米絲計畫則預計在2027年將太空人送上月球南極。",k0e="印度維克拉姆探測器成功登陸月球南極。圖／印度太空研究組織（ISRO）、美聯社",V0e="日本則於2024年1月20日躋身登月第5國，有「月球狙擊手」之稱的探測器SLIM成功著陸。除了國家力量之外，私人企業也積極參與登月任務，如美國的直覺機器公司（Intuitive Machines）、螢火蟲太空（Firefly Aerospace）、日本iSpace等。如今，月球競逐不僅是科技實力的較量，更是月球開發權與太空經濟主導權的激烈爭奪。",G0e="無人探測器SLIM達成月球軟著陸，日本躋身登月第5國。圖／JAXA、美聯社",q0e="DSRP",z0e="DSRP可帶回太空游離輻射數據，由於深太空（距離地球2000公里以上）數據匱乏，DSRP此次任務吸引國內外產業界關注。",H0e="冷海(Mare Frigoris)",$0e="月球資源豐富 成各國競逐目標",W0e="陽光",j0e="主要用途：供電",X0e="月球大氣層稀薄，太陽光可以直射月表，提升太陽能轉換效率，且部分地區為永久日照，適合開發太陽能應用",Q0e="氦-3",Y0e="主要用途：核融合",Z0e="相較傳統核融合原料，氦-3不會產生中子輻射汙染，被視為未來各國能源競逐焦點",K0e="水冰",J0e="主要用途：飲用水、氧氣、火箭燃料",ede="主要分布在月球南北兩極永久陰影區，能分解為氫和氧，各國都想藉水冰資源打造前進火星的「深空加油站」",tde="稀土金屬",nde="主要用途：高科技產業原料",ide="包括鈧、釔和15種鑭系元素，地球上產量稀少，可用於智慧型手機、電腦等電子產品",rde="月壤",sde="主要用途：建築、工業應用",ode="有矽、鐵、鋁、鎂等元素，能進一步提煉做為工業原料或3D列印建材",ade="蘇聯",lde="美國",ude="中國",cde="印度",hde="日本",fde="民間",Ade="月球不僅是資源爭奪的新前線，更是科技與產業實力的全球秀場。太空技術牽動能源、通訊、材料、製造等產業競爭，月球是這場戰役的預備場，各國積極搶灘，不只是為了資源，更是為了先卡位、先整合，誰能率先在此落地、驗證、部署，誰就更有機會主導新太空時代的節奏。",dde="深入解讀",pde="台日攜手登月國際關注 獨家專訪日本太空新創公司",mde="https://vip.udn.com/vip/story/122861/8572969",gde="太空數據應用民生化 全球產業爭搶台灣科技合作",_de="https://vip.udn.com/vip/story/122861/8575364",tx={title:d0e,subTitle:p0e,p1t1:m0e,p1t2:g0e,p1ChartTitle:_0e,p1ChartText1:v0e,p1ChartText2:y0e,p1ChartText3:x0e,p1ChartText4:b0e,p1ChartText5:w0e,p1ChartCaption:S0e,p2t1:T0e,p3t1:M0e,p3Caption:E0e,p3t2:C0e,p4t1:R0e,p4Caption1:N0e,p4t2:P0e,p4Caption2:L0e,p4t3:D0e,p5t1:I0e,p5Caption1:B0e,p5t2:F0e,p5Caption2:U0e,p6t1:O0e,p6Caption1:k0e,p6t2:V0e,p6Caption2:G0e,falldownTitle:q0e,falldownDesc:z0e,satelliteLocation:H0e,moonTitle:$0e,moon1t1:W0e,moon1t2:j0e,moon1t3:X0e,moon2t1:Q0e,moon2t2:Y0e,moon2t3:Z0e,moon3t1:K0e,moon3t2:J0e,moon3t3:ede,moon4t1:tde,moon4t2:nde,moon4t3:ide,moon5t1:rde,moon5t2:sde,moon5t3:ode,moonLabelSoviet:ade,moonLabelUSA:lde,moonLabelChina:ude,moonLabelIndia:cde,moonLabelJapan:hde,moonLabelPrivate:fde,p7t1:Ade,relatedTitle:dde,related1Title:pde,related1Link:mde,related2Title:gde,related2Link:_de},vde="太空垃圾",yde="殘骸威脅直逼地表",xde="不過，過度開發太空也正在留下代價，人類正把太空推向更擁擠、更危險的臨界點。",bde="今年5月10日，一艘1972年、蘇聯時期發射的太空船殘骸Kosmos 482，經俄羅斯國家航太集團證實墜落在印尼雅加達以西的印度洋，雖未造成傷亡，但敲響了各界對太空垃圾危機的警鐘。Kosmos 482原本設定在金星著陸，卻因失敗在地球軌道中漫無目的的飛行數十年，台灣因靠近Kosmos 482再入預測窗口的尾端，在臉書太空社群引起討論，前氣象局長鄭明典也轉發相關訊息，直呼「有點特別」。",wde="太空垃圾墜落不是第一次發生。2025年元旦前夕，一個直徑約2.5公尺、重達500公斤的運載火箭分離環，從天而降到肯亞村莊，嚇壞當地居民；3月時，馬斯克旗下SpaceX的重型運載火箭星艦（Starship）在太空解體，炙熱的碎片劃過佛羅里達州南部與巴哈馬上空，讓美國聯邦航空總署（FAA）緊急針對多座機場發布停飛令。",Sde="1.4",Tde="大小超過1毫米的太空垃圾",Mde="註：資料統計截至2025年6月26日",Ede="資料來源／歐洲太空總署太空垃圾辦公室（ESA's Space Debris Office）",Cde="2.8",Rde="直到2035年，每年恐墜落至地球的危險碎片數量",Nde="資料來源／美國聯邦航空總署（FAA）",Pde="億",Lde="太空垃圾的種類五花八門，包括多節火箭分離時產生的碎片、固態火箭的燃燒殘渣，以及老舊、報廢，或因故障而失控的人造衛星，還有部分國家進行反衛星飛彈試驗時炸碎的殘骸等，都屬於太空垃圾。",Dde="雖然多數碎片在重返大氣層過程中會完全解體，但隨著各國發射愈來愈多物體到太空中，各國專家都在努力確保物體不會在太空中相撞，或墜落地表對人類造成危險。美國航太公司The Aerospace Corporation太空垃圾專家佐爾格（Marlon Sorge）指出，除了碎片本身，老舊的太空殘骸也可能漏出危險燃料，對人員或財產產生風險。",Ide="NASA數據顯示，截至2024年6月，漂浮在太空的廢棄火箭主體與碎片絕大多數來自俄羅斯、美國和中國，因軍事行動與退役設備處置問題，在太空製造大量垃圾。",Bde="國際間目前無論是太空治理架構或太空垃圾規範，都還未跟上太空活動的發射速度。俄羅斯、美國與中國雖需對太空垃圾負最大責任，但作為強權，這3大國都不希望有一個強而有力的機構管理太空、掌握太空話語權，聯合國及其他組織目前也尚未能推動完整的治理架構，只能仰賴各國自律。",Fde="現行《外空物體所造成損害的國際責任公約》規定，若太空設備對地球表面或其他飛行中的太空載具造成損害，發射國應負賠償責任，但該公約並非所有國家都簽署，導致缺乏強制約束力。隨美中太空競賽白熱化、地緣政治分歧，未來如何促成國際合作、制定規範，將是各國政府與企業無法迴避的未來難題。",Ude="恐成致命血滴子！1.3億太空垃圾天上飛 圖解究竟多危險",Ode="太空碎片看似微小，但在太空高速下都可能帶來致命破壞，當各國都在太空「塞」東西，一場新危機也因應而生。",kde="https://vip.udn.com/vip/story/122861/8642841",Pi={title:vde,subTitle:yde,p1t1:xde,p1t2:bde,p1t3:wde,p1t4:Sde,p1t5:Tde,p1tCaption1:Mde,p1tCaption2:Ede,p1t6:Cde,p1t7:Rde,p1tCaption3:Nde,p1tBillion:Pde,p2t1:Lde,p2t2:Dde,p2t3:Ide,p3t1:Bde,p3t2:Fde,related1Title:Ude,related1Desc:Ode,related1Link:kde},Vde={class:"ls-intro relative w-full h-screen min-h-[var(--hero-min-h)] flex flex-col justify-between"},Gde={class:"ls-intro__content h-full flex items-center justify-center md:grid md:grid-cols-5"},qde={class:"ls-intro__content-title md:col-span-4 text-center md:text-left md:pl-[107px] 3xl:pl-[300px]"},zde={key:0,class:"ls-intro__chapter hidden md:block montserrat"},Hde={class:"ls-intro__toc-wrap relative w-full max-md:flex max-md:justify-between max-md:items-end max-md:px-[40px]"},$de={class:"ls-intro__toc inline-grid max-md:grid-rows-4 md:grid-cols-4 gap-[18px] md:gap-10"},Wde=["href","onClick"],jde={class:"ls-intro__toc-item-content"},Xde={class:"ls-intro__toc-item-content-number montserrat"},Qde={key:0,class:"ls-intro__chapter montserrat md:hidden"},$b=_t({__name:"leo-section-intro",props:{chapter:{}},setup(n){const e=n,t=[{text:ex.title,link:"#ch1_economic"},{text:ki.title,link:"#ch2_security"},{text:tx.title,link:"#ch3_moon"},{text:Pi.title,link:"#ch4_debris"}];function i(r){const s={"#ch1_economic":"economic","#ch2_security":"security","#ch3_moon":"moon","#ch4_debris":"debris"},o=e.chapter?`ch${e.chapter}_${s[r.link]}`:s[r.link];o&&Hb({action:"click_anchor",category:"term",label:o})}return(r,s)=>(lt(),pt("div",Vde,[s[1]||(s[1]=ae("div",{class:"ls-intro__present-line ls-intro__present-line-1",role:"presentation"},null,-1)),s[2]||(s[2]=ae("div",{class:"ls-intro__present-line ls-intro__present-line-2",role:"presentation"},null,-1)),ae("div",Gde,[ae("div",qde,[Ti(r.$slots,"default")]),r.chapter?(lt(),pt("div",zde,Lt(r.chapter),1)):Ji("",!0)]),ae("div",Hde,[ae("ul",$de,[(lt(),pt(Di,null,Xc(t,(o,a)=>ae("li",{key:o.link,class:On(["ls-intro__toc-item relative",{"ls-intro__toc-item--active":r.chapter===`0${a+1}`}])},[ae("a",{href:o.link,onClick:l=>i(o)},[s[0]||(s[0]=ae("div",{class:"ls-intro__toc-item-dot",role:"presentation"},[ae("div",{class:"ls-intro__toc-item-dot-out"}),ae("div",{class:"ls-intro__toc-item-dot-in"})],-1)),ae("div",jde,[ae("span",Xde," 0"+Lt(a+1),1),ae("span",null,Lt(o.text),1)])],8,Wde)],2)),64))]),r.chapter?(lt(),pt("div",Qde,Lt(r.chapter),1)):Ji("",!0)])]))}}),Yde={class:"ls-layout relative"},Zde={key:1,class:"absolute inset-0 z-10"},Kde={key:3,class:"absolute inset-0 z-20 min-h-[568px] xs:min-h-[736px] md:min-h-[1024px] lg:min-h-[1280px]"},Jde={class:"ls-layout-before-article"},epe={key:1,class:"ls-layout-article relative z-30 mt-[calc(var(--init-screen-height)*0.8)] bg-black"},tpe={class:"ls-layout-article-wrap"},Wb=_t({__name:"leo-section-layout",props:{isCustomSpace:{type:Boolean},isCustomIntro:{type:Boolean},isCustomArticle:{type:Boolean},useSpaceBg:{type:Boolean}},emits:["changeSpace","changeArticle"],setup(n,{emit:e}){const t=e;function i(s){t("changeSpace",s)}function r(s){t("changeArticle",s)}return(s,o)=>(lt(),pt("div",Yde,[vt(Uf,{class:"absolute top-0 opacity-0 pointer-events-none","scroll-height":"var(--ls-layout-header-h)",onChange:i}),ae("div",{class:On(["sticky top-0 h-[var(--ls-layout-header-h)] overflow-hidden bg-[url('/img/bg_star.jpg')]",{"bg-none":!s.useSpaceBg,"bg-repeat":s.useSpaceBg}])},[s.isCustomSpace?Ti(s.$slots,"space",{key:0}):(lt(),pt("div",Zde,[Ti(s.$slots,"space")])),s.isCustomIntro?Ti(s.$slots,"intro",{key:2}):(lt(),pt("div",Kde,[Ti(s.$slots,"intro")]))],2),ae("div",Jde,[Ti(s.$slots,"before-article")]),vt(Uf,{class:"ls-layout-article-trigger",threshold:0,onChange:r},{default:zn(()=>[s.isCustomArticle?Ti(s.$slots,"article",{key:0}):(lt(),pt("div",epe,[o[0]||(o[0]=ae("div",{class:"h-[calc(var(--init-screen-height)*0.15)] -translate-y-[calc(var(--init-screen-height)*0.14)] bg-gradient-to-b from-transparent to-black pointer-events-none",role:"presentation"},null,-1)),ae("div",tpe,[Ti(s.$slots,"article")])]))]),_:3})]))}}),D1e="EARTH",I1e="APOGEE_2000",B1e="STARLINK",F1e="ONEWEB",U1e="KUIPER",O1e="ONEWEB_KUIPER",k1e="ALL",npe=1280,ipe=768,rpe={VITE_ASSETS_PATH:"https://nmdap.udn.com.tw/test/newspaceera/"},spe={class:"l-pic"},ope=["media","srcset"],ape=["media","srcset"],lpe=["id","src","alt","aria-labelledby","loading","width","height"],upe="jpg",ua=_t({__name:"leo-pic",props:{id:{},classname:{},src:{},srcset:{},default:{},ext:{},width:{},height:{},alt:{},altby:{},loading:{default:"lazy"},use2x:{type:Boolean,default:!0},usePrefix:{type:Boolean,default:!0},webp:{type:Boolean,default:!0},pcBreakpoint:{}},setup(n){const e=n,{VITE_ASSETS_PATH:t}=rpe,i=["pc","pad","mob"],r=er(()=>e.srcset??i),s=er(()=>e.ext??upe),o=er(()=>e.use2x??!0),a=er(()=>e.usePrefix??!0),l={pc:`(min-width: ${e.pcBreakpoint||npe}px)`,pad:`(min-width: ${ipe}px)`,mob:""},u=er(()=>r.value.map(x=>l[x]));function A(x,S,T,w){const R=w?`_${x}`:"",E=`${t}${e.src}${R}.${S} 1x`;if(!T)return E;const N=`${t}${e.src}${R}@2x.${S} 2x`;return`${E}, ${N}`}const p=er(()=>r.value.map(x=>A(x,s.value,o.value,a.value))),g=er(()=>e.webp?r.value.map(x=>A(x,"webp",o.value,a.value)):void 0),v=er(()=>{const x=e.default??"pc",S=a.value?`_${x}`:"";return`${t}${e.src}${S}.${s.value}`});return(x,S)=>(lt(),pt("picture",spe,[(lt(!0),pt(Di,null,Xc(u.value,(T,w)=>{var R;return lt(),pt(Di,{key:T+w},[x.webp?(lt(),pt("source",{key:0,media:T,srcset:(R=g.value)==null?void 0:R[w],type:"image/webp"},null,8,ope)):Ji("",!0),r.value.length>0?(lt(),pt("source",{key:1,media:T,srcset:p.value[w]},null,8,ape)):Ji("",!0)],64)}),128)),ae("img",{id:x.id,class:On(["l-pic-img",x.classname||""]),src:v.value,alt:x.alt,"aria-labelledby":x.altby,loading:x.loading,width:x.width,height:x.height},null,10,lpe)]))}}),cpe="圖解1.8兆美元太空商機：食衣住行全包 牽涉產業超乎想像",hpe="https://vip.udn.com/vip/story/122861/8688226",fpe="從遠洋漁業看到太空商機 台廠老牌力拚衛星應用新藍海",Ape="https://vip.udn.com/vip/story/121938/8702769",dpe="地緣政治下的太空經濟 台廠如何在供應鏈中突圍？",ppe="https://vip.udn.com/vip/story/121938/8733840",mpe="太空「點穴戰」 中、美部署監視能力 台灣如何不受制於人？",gpe="https://vip.udn.com/vip/story/122870/8612234",_pe="中國發展可回收火箭航太進步飛速 能追得上SpaceX？",vpe="https://vip.udn.com/vip/story/122870/8647943",ype="川普暗示放棄登月？美國盟友擔心中國將掌控太空話語權",xpe="https://vip.udn.com/vip/story/122870/8597916",bpe="台灣在內！一年30萬架客機遭GPS欺騙攻擊 國際專家解析",wpe="https://vip.udn.com/vip/story/121937/8673276",Spe="台日攜手登月國際關注 獨家專訪日本太空新創公司",Tpe="https://vip.udn.com/vip/story/122861/8572969",Mpe="太空數據應用民生化 全球產業爭搶台灣科技合作",Epe="https://vip.udn.com/vip/story/122861/8575364",Cpe="恐成致命血滴子！1.3億太空垃圾天上飛 圖解究竟多危險",Rpe="https://vip.udn.com/vip/story/122861/8642841",ar={text1_1:cpe,link1_1:hpe,text1_2:fpe,link1_2:Ape,text1_3:dpe,link1_3:ppe,text2_1:mpe,link2_1:gpe,text2_2:_pe,link2_2:vpe,text2_3:ype,link2_3:xpe,text2_4:bpe,link2_4:wpe,text3_1:Spe,link3_1:Tpe,text3_2:Mpe,link3_2:Epe,text4_1:Cpe,link4_1:Rpe},Npe={class:"l-outline"},Ppe={class:"text-3xl font-bold mb-4"},Lpe={class:"inline-flex items-center gap-2 mb-3 md:mb-6"},Dpe={class:"text-7xl text-[#00F4DC] montserrat"},Ipe={class:"text-2xl font-semibold mb-2"},Bpe={class:"text-lg mb-4"},Fpe={class:"flex flex-col md:grid md:grid-cols-2 gap-2 sm:gap-4"},Upe=["href","onClick"],Ope={class:"relative min-h-[74px] sm:min-h-[88px] aspect-[120/74] shrink-0 rounded-lg border border-[#808080] overflow-hidden"},kpe={class:"l-outline__card-text w-full flex items-center"},Vpe=_t({__name:"leo-outline",setup(n){const e=[{title:ex.title,subTitle:ex.subTitle,articles:[{text:ar.text1_1,link:ar.link1_1,bg:"img/newspaceera2025_pic2_1"},{text:ar.text1_2,link:ar.link1_2,bg:"img/newspaceera2025_pic2_2"},{text:ar.text1_3,link:ar.link1_3,bg:"img/newspaceera2025_pic2_3"}]},{title:ki.title,subTitle:ki.subTitle,articles:[{text:ar.text2_1,link:ar.link2_1,bg:"img/newspaceera2025_pic2_4"},{text:ar.text2_2,link:ar.link2_2,bg:"img/newspaceera2025_pic2_5"},{text:ar.text2_3,link:ar.link2_3,bg:"img/newspaceera2025_pic2_6"},{text:ar.text2_4,link:ar.link2_4,bg:"img/newspaceera2025_pic2_7"}]},{title:tx.title,subTitle:tx.subTitle,articles:[{text:ar.text3_1,link:ar.link3_1,bg:"img/newspaceera2025_pic2_8"},{text:ar.text3_2,link:ar.link3_2,bg:"img/newspaceera2025_pic2_9"}]},{title:Pi.title,subTitle:Pi.subTitle,articles:[{text:ar.text4_1,link:ar.link4_1,bg:"img/newspaceera2025_pic2_10"}]}];function t(i){Hb({action:"click_series",category:"term",label:i.text})}return(i,r)=>(lt(),pt("div",Npe,[ae("h2",Ppe,Lt(Ke(ar).title),1),(lt(),pt(Di,null,Xc(e,(s,o)=>ae("div",{key:o,class:"mb-7 sm:mb-9"},[ae("div",Lpe,[ae("div",Dpe,"0"+Lt(o+1),1),ae("div",null,[ae("h3",Ipe,Lt(s.title),1),ae("p",Bpe,Lt(s.subTitle),1)])]),ae("ul",Fpe,[(lt(!0),pt(Di,null,Xc(s.articles,a=>(lt(),pt("li",{key:a.text},[ae("a",{href:a.link,target:"_blank",class:"flex gap-3",onClick:l=>t(a)},[ae("div",Ope,[vt(ua,{src:a.bg,"use-prefix":!1,webp:!1,width:450,height:450},null,8,["src"])]),ae("p",kpe,Lt(a.text),1)],8,Upe)]))),128))])])),64))]))}}),Gpe=_t({__name:"leo-loading",props:{isLoading:{type:Boolean,default:!0}},setup(n){return(e,t)=>(lt(),pt("div",{id:"init-loading-udn-logo",class:On(["init-loading__container",{"init-loading__container--disabled":!n.isLoading}])},[ae("div",{class:On(["init-loading__mask",{"init-loading__mask--disabled":!n.isLoading}])},null,2),t[0]||(t[0]=ae("div",{class:"init-loading__logo-container"},[ae("i",{id:"init-loading-udn-logo",class:"icon-round_logo"})],-1)),t[1]||(t[1]=ae("div",{class:"init-loading__shadow-container"},null,-1))],2))}}),qpe="新太空時代",zpe="地緣角力、國安戰場、商業版圖 誰將搶占宇宙藍海？",Hpe="世界正進入「新太空時代」。",$pe="世界經濟論壇與調研機構麥肯錫預測，到2035年，全球太空經濟規模將成長近3倍，成為1.8兆美元的市場，年均成長率遠高於全球GDP成長速度。其中，低軌衛星帶來無限應用商機，60%成長將來自供應鏈和運輸、食品和飲料、國防、零售和消費、數位通訊等五大領域。",Wpe="2035年全球太空經濟規模將達1.8兆美元",jpe="資料來源／世界經濟論壇、麥肯錫報告",Xpe="2024年全球政府太空計畫支出總額達1350億美元",Qpe="各國政府投入太空支出的總額也在持續增加。2024年，全球政府太空預算達1350億美元，與2023年相比成長10％，創下政府太空投資的歷史新高。其中，國防太空支出占超過730億美元，在地緣政治緊繃情勢下，各國格外重視太空具備的情報、監視、偵察等能力，未來戰場將從地表、天空延伸至太空。",Ype="從經濟版圖到國安防線，太空儼然成為全球競逐新戰場。低軌衛星、月球探勘、太空資源開發快速推進，美中等大國布局不斷升級，台灣憑藉半導體和資通訊產業基礎，積極搶灘全球供應鏈，下一步挑戰將是發展自主能力、推動產業升級，以及突破地緣政治和國際現實困境。",Zpe="在這場太空戰役中，台灣的每一步選擇，攸關國安與產業未來。",yc={title:qpe,subTitle:zpe,p1t1:Hpe,p1t2:$pe,g1Title:Wpe,g1Caption:jpe,g2Title:Xpe,p2t1:Qpe,p3t1:Ype,p3t2:Zpe},Kpe={id:"overview",class:"ls-hero leo-article"},Jpe={class:"ls-hero__title-shadow max-w-[362px] sm:max-w-[448px]"},eme={class:"block leo-intro-h2"},tme={class:"block leo-intro-h2-sub-lg"},nme={class:"min-h-[calc(var(--init-screen-height)*1)]"},ime={class:"leo-container-pc"},rme={class:"leo-text-box"},sme={id:"contents"},ome={class:"leo-container-larger"},ame={class:"leo-section-chart"},lme={class:"flex justify-center"},ume={class:"w-full ls-hero__chart flex justify-center"},cme={class:"sticky top-0 w-full h-[calc(var(--init-screen-height)*1)] flex items-center"},hme={class:"leo-container-larger bg-black"},fme={class:"leo-section-chart"},Ame={class:"sticky top-0 w-full min-h-[calc(var(--init-screen-height)*1.15)] flex items-center"},dme={class:"leo-container-pc"},pme={class:"min-h-[calc(var(--init-screen-height)*1)]"},mme={class:"leo-text-box"},gme={class:"leo-section"},_me={class:"leo-container"},vme={class:"leo-section"},yme={class:"leo-container-lg"},xme=_t({__name:"section-hero",setup(n){const e=Ln(!1),t=Ln(!1),i=Ln(!1),r=Ln(!1);function s(u){t.value=u}function o(u){i.value=u}function a(u){r.value=u}function l(){e.value=!0}return(u,A)=>(lt(),pt("div",Kpe,[ae("div",{class:On(["relative z-10 transition-all duration-1000 ease-in-out",{"opacity-0 pointer-events-none":e.value,"opacity-100":!e.value}])},[vt(Gpe)],2),vt(Wb,{"use-space-bg":!0},{space:zn(()=>[vt(oAe,{"is-zoom-out":t.value,onOnReady:l},null,8,["is-zoom-out"])]),intro:zn(()=>[ae("div",{class:On(["ls-hero__intro transition-all duration-500 ease-in-out",{"opacity-0 pointer-events-none":t.value}])},[vt($b,null,{default:zn(()=>[ae("h1",Jpe,[ae("span",eme,Lt(Ke(yc).title),1),ae("span",tme,Lt(Ke(yc).subTitle),1)])]),_:1})],2)]),"before-article":zn(()=>[ae("div",nme,[vt(Uf,{threshold:0,"scroll-height":"calc(var(--init-screen-height)*1)",onChange:s},{default:zn(()=>[ae("div",ime,[ae("div",rme,[ae("p",null,Lt(Ke(yc).p1t1),1),ae("p",null,Lt(Ke(yc).p1t2),1)])])]),_:1})])]),article:zn(()=>[ae("div",sme,[ae("div",ome,[vt(Uf,{class:"w-full flex items-center justify-center mb-[100px] sm:mb-0","scroll-height":"calc(var(--init-screen-height)*1)",onChange:a},{default:zn(()=>[ae("div",ame,[ae("figure",{class:On(["w-full transition-all duration-500 ease-in-out",{"opacity-0":!r.value}])},[ae("div",lme,[ae("figure",ume,[vt(ua,{src:"img/newspaceera2025_pic1_1_chart",ext:"svg",use2x:!1,webp:!1,width:362,height:607})])])],2)])]),_:1})]),ae("div",cme,[ae("div",hme,[ae("div",fme,[vt(Uf,{class:"w-full",onChange:o},{default:zn(()=>[ae("figure",{class:On(["w-full flex items-center justify-center transition-all duration-500 ease-in-out",{"opacity-0":!i.value}])},A[0]||(A[0]=[ae("div",{class:"w-full flourish-embed flourish-chart","data-src":"visualisation/23264843"},null,-1)]),2)]),_:1})])])]),ae("div",Ame,[ae("div",dme,[ae("div",pme,[ae("div",mme,[ae("p",null,Lt(Ke(yc).p2t1),1)])])])])]),ae("div",gme,[ae("div",_me,[ae("p",null,Lt(Ke(yc).p3t1),1),ae("p",null,Lt(Ke(yc).p3t2),1)])]),ae("div",vme,[ae("div",yme,[vt(Vpe)])])]),_:1})]))}}),bme={class:"leo-read-more"},wme={key:0,class:"leo-h3 font-medium text-center"},Sme=["href","onClick"],Tme={class:"relative"},Mme={key:0,class:"leo-read-more-p"},lD=_t({__name:"leo-read-more",props:{chapter:{},title:{},data:{}},setup(n){function e(t){Hb({action:"click_news",category:"term",label:t.title})}return(t,i)=>(lt(),pt("div",bme,[t.title?(lt(),pt("h2",wme,Lt(t.title),1)):Ji("",!0),ae("div",{class:On({"mt-8 sm:mt-10":t.title})},[ae("ul",{class:On({"grid sm:grid-cols-2 gap-[13px]":t.data.length%2===0,"grid sm:grid-cols-2 md:grid-cols-3 gap-[13px]":t.data.length%3===0})},[(lt(!0),pt(Di,null,Xc(t.data,(r,s)=>(lt(),pt("li",{key:s},[ae("a",{href:r.link,class:On(["leo-read-more__link relative h-full min-h-[124px] md:min-h-[153px] flex flex-col justify-between border border-[#808080] rounded-[20px] overflow-hidden",{"px-[25px] py-[28px]":!r.desc,"leo-read-more__link--one":r.desc}]),target:"_blank",onClick:o=>e(r)},[ae("div",null,[vt(ua,{src:r.bg,"use-prefix":t.data.length===1,webp:!1,width:620,height:450},null,8,["src","use-prefix"]),ae("div",Tme,[ae("h3",{class:On({"leo-read-more-h3":!r.desc,"leo-read-more-h3-w-desc":r.desc})},Lt(r.title),3),r.desc?(lt(),pt("div",Mme,[ae("p",null,Lt(r.desc),1)])):Ji("",!0)])]),i[0]||(i[0]=ae("div",{class:"relative flex justify-end items-center"},[ae("svg",{width:"37",height:"30",viewBox:"0 0 37 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[ae("path",{d:"M21 1L35.3721 14.9084L21 28.8168",stroke:"white","stroke-width":"2"}),ae("path",{d:"M0.753529 14.6901H35.2465",stroke:"white","stroke-width":"2"})])],-1))],10,Sme)]))),128))],2)],2)]))}}),Eme={id:"ch2_security",class:"ls-two leo-article"},Cme={class:"relative w-full h-[calc(var(--init-screen-height)*1)]"},Rme={class:"max-w-[448px]"},Nme={class:"block leo-intro-h2"},Pme={class:"block leo-intro-h2-sub"},Lme={id:"ch2_overview",class:"leo-container"},Dme={class:"leo-section leo-section--pt leo-section--no-mt"},Ime={class:"min-h-[calc(var(--init-screen-height)*2)] w-full"},Bme={class:"leo-container-pc"},Fme={class:"leo-section leo-section--no-mb pb-[calc(var(--init-screen-height)*1)]"},Ume={class:"leo-text-box"},Ome={class:"min-h-[calc(var(--init-screen-height)*2)] w-full"},kme={class:"sticky top-0 w-full min-h-[calc(var(--init-screen-height)*1)] flex items-center"},Vme={class:"w-full"},Gme={class:"leo-container-pc"},qme={class:"leo-section leo-section--no-mb pb-[calc(var(--init-screen-height)*1)]"},zme={class:"leo-text-box"},Hme={class:"leo-container"},$me={class:"leo-container-card24"},Wme={class:"leo-section"},jme=_t({__name:"section-two",setup(n){const e=Ln(!1),t=Ln(!1);function i(s){e.value=s}function r(s){t.value=s}return(s,o)=>(lt(),pt("div",Eme,[vt(Wb,{onChangeSpace:i,onChangeArticle:r},{space:zn(()=>[ae("div",Cme,[ae("div",{class:On(["ls-two__space-pic-1",{"ls-two__space-pic-1--enter":e.value,"ls-two__space-pic-1--under":t.value}])},[vt(ua,{src:"img/newspaceera2025_pic5_1_bg",webp:!1,use2x:!1,width:720,height:1280})],2),ae("div",{class:On(["ls-two__space-pic-2",{"ls-two__space-pic-2--enter":e.value,"ls-two__space-pic-2--under":t.value}])},[vt(ua,{src:"img/newspaceera2025_pic5_2_bg",ext:"png",webp:!1,use2x:!1,width:256,height:240})],2),ae("div",{class:On(["ls-two__space-pic-3",{"ls-two__space-pic-3--enter":e.value,"ls-two__space-pic-3--under":t.value}])},[vt(ua,{src:"img/newspaceera2025_pic5_3_bg",ext:"png",webp:!1,use2x:!1,width:355,height:245})],2)])]),intro:zn(()=>[vt($b,{chapter:"02"},{default:zn(()=>[ae("h2",Rme,[ae("span",Nme,Lt(Ke(ki).title),1),ae("span",Pme,Lt(Ke(ki).subTitle),1)])]),_:1})]),article:zn(()=>[ae("div",Lme,[ae("div",Dme,[ae("p",null,Lt(Ke(ki).p1t1),1),ae("p",null,Lt(Ke(ki).p1t2),1),o[0]||(o[0]=ae("div",{class:"leo-section-sm"},[ae("figure",{class:"w-full"},[ae("div",{class:"flourish-embed flourish-chart","data-src":"visualisation/23266793"})])],-1)),ae("p",null,Lt(Ke(ki).p2t1),1),o[1]||(o[1]=ae("div",{class:"leo-section-sm"},[ae("figure",{class:"w-full"},[ae("div",{class:"flourish-embed flourish-chart","data-src":"visualisation/23267137"})])],-1)),ae("p",null,Lt(Ke(ki).p3t1),1),ae("p",null,Lt(Ke(ki).p3t2),1)])]),ae("div",Ime,[o[2]||(o[2]=ae("div",{class:"sticky top-0 w-full min-h-[calc(var(--init-screen-height)*1)] flex items-center"},[ae("div",{class:"leo-container"},[ae("figure",{class:"w-full"},[ae("div",{class:"flourish-embed flourish-chart","data-src":"visualisation/23265551"})])])],-1)),ae("div",Bme,[ae("div",Fme,[ae("p",Ume,Lt(Ke(ki).p4t1),1)])])]),ae("div",Ome,[ae("div",kme,[ae("figure",Vme,[ae("figcaption",null,Lt(Ke(ki).g4Title),1),vt(ua,{src:"img/newspaceera2025_pic6_chart",ext:"svg",use2x:!1,webp:!1,width:414,height:736}),ae("figcaption",null,Lt(Ke(ki).g4Caption),1)])]),ae("div",Gme,[ae("div",qme,[ae("p",zme,Lt(Ke(ki).p5t1),1)])])]),ae("div",Hme,[ae("p",null,Lt(Ke(ki).p5t2),1)]),ae("div",$me,[ae("div",Wme,[vt(lD,{chapter:"ch2",title:Ke(ki).relatedTitle,data:[{title:Ke(ki).related1Title,link:Ke(ki).related1Link,bg:"img/newspaceera2025_pic7_1"},{title:Ke(ki).related2Title,link:Ke(ki).related2Link,bg:"img/newspaceera2025_pic7_2"},{title:Ke(ki).related3Title,link:Ke(ki).related3Link,bg:"img/newspaceera2025_pic7_3"},{title:Ke(ki).related4Title,link:Ke(ki).related4Link,bg:"img/newspaceera2025_pic7_4"}]},null,8,["title","data"])])])]),_:1})]))}}),Xme={id:"ch4_debris",class:"ls-four leo-article"},Qme={class:"relative w-full h-[calc(var(--init-screen-height)*1)]"},Yme={class:"max-w-[448px]"},Zme={class:"block leo-intro-h2"},Kme={class:"block leo-intro-h2-sub"},Jme={id:"ch4_overview",class:"leo-section leo-section--no-mt leo-section--pt relative z-20"},e1e={class:"leo-container"},t1e={class:"ls-four__trash relative h-[calc(var(--init-screen-height)*1)] md:h-[calc(var(--init-screen-height)*1.5)]"},n1e={class:"ls-four__trash-bg absolute bottom-0 left-[50%] w-[200%] md:w-full flex translate-x-[-50%]"},i1e={class:"absolute top-0 left-0 w-full h-full flex items-center justify-center overflow-hidden"},r1e={class:"w-full max-w-[475px]"},s1e={class:"text-[80px] sm:text-[100px] leading-[100px] montserrat"},o1e={class:"text-[24px] leading-[36px]"},a1e={class:"mb-2 text-[24px] leading-[36px]"},l1e={class:"leo-caption"},u1e={class:"leo-caption"},c1e={class:"w-full max-w-[475px]"},h1e={class:"text-[80px] sm:text-[100px] leading-[100px] montserrat"},f1e={class:"text-[24px] leading-[36px]"},A1e={class:"mb-2 text-[24px] leading-[36px]"},d1e={class:"leo-caption"},p1e={class:"leo-section relative z-40"},m1e={class:"leo-container"},g1e={class:"leo-section leo-section--no-mb"},_1e=_t({__name:"section-four",setup(n){const e=Ln(!1),t=Ln(!1),i=Ln(!1);function r(a){e.value=a}function s(a){t.value=a}function o(a){i.value=a}return(a,l)=>(lt(),pt("div",Xme,[vt(Wb,{onChangeSpace:r,onChangeArticle:s},{space:zn(()=>[ae("div",Qme,[ae("div",{class:On(["ls-four__space-pic-1",{"ls-four__space-pic-1--enter":e.value,"ls-four__space-pic-1--under":t.value}])},[vt(ua,{class:"leo-section-bg",src:"img/newspaceera2025_pic13_1_bg",webp:!1,use2x:!1,width:720,height:1280})],2),ae("div",{class:On(["ls-four__space-pic-2",{"ls-four__space-pic-2--enter":e.value,"ls-four__space-pic-2--under":t.value}])},[vt(ua,{src:"img/newspaceera2025_pic13_2_bg",ext:"png",webp:!1,use2x:!1,width:369,height:370})],2),ae("div",{class:On(["ls-four__space-pic-3",{"ls-four__space-pic-3--enter":e.value,"ls-four__space-pic-3--under":t.value}])},[vt(ua,{src:"img/newspaceera2025_pic13_3_bg",srcset:["pc"],ext:"png",webp:!1,use2x:!1,width:298,height:316})],2)])]),intro:zn(()=>[vt($b,{chapter:"04"},{default:zn(()=>[ae("h2",Yme,[ae("span",Zme,Lt(Ke(Pi).title),1),ae("span",Kme,Lt(Ke(Pi).subTitle),1)])]),_:1})]),article:zn(()=>[ae("div",Jme,[ae("div",e1e,[ae("p",null,Lt(Ke(Pi).p1t1),1),ae("p",null,Lt(Ke(Pi).p1t2),1),ae("p",null,Lt(Ke(Pi).p1t3),1)])]),ae("div",t1e,[ae("div",n1e,[l[0]||(l[0]=ae("div",{class:"absolute top-0 left-0 w-full h-[5px] bg-black"},null,-1)),vt(ua,{src:"img/newspaceera2025_pic14_bg",webp:!1,use2x:!1,width:1144,height:2426,loading:"eager"})]),ae("div",i1e,[vt(Uf,{class:"w-full max-w-[800px] px-[26px]",onChange:o},{default:zn(()=>[ae("div",{class:On(["ls-four__trash-float ls-four__trash-float--1",{"ls-four__trash-float--enter":i.value}])},[ae("div",r1e,[ae("div",null,[ae("span",s1e,Lt(Ke(Pi).p1t4),1),ae("span",o1e,Lt(Ke(Pi).p1tBillion),1)]),ae("div",a1e,Lt(Ke(Pi).p1t5),1),ae("p",l1e,Lt(Ke(Pi).p1tCaption1),1),ae("p",u1e,Lt(Ke(Pi).p1tCaption2),1)])],2),ae("div",{class:On(["ls-four__trash-float ls-four__trash-float--2 flex justify-end",{"ls-four__trash-float--enter":i.value}])},[ae("div",c1e,[ae("div",null,[ae("span",h1e,Lt(Ke(Pi).p1t6),1),ae("span",f1e,Lt(Ke(Pi).p1tBillion),1)]),ae("div",A1e,Lt(Ke(Pi).p1t7),1),ae("p",d1e,Lt(Ke(Pi).p1tCaption3),1)])],2)]),_:1})])]),ae("div",p1e,[ae("div",m1e,[ae("p",null,Lt(Ke(Pi).p2t1),1),ae("p",null,Lt(Ke(Pi).p2t2),1),ae("p",null,Lt(Ke(Pi).p2t3),1),l[1]||(l[1]=ae("div",{class:"leo-section-chart-lg"},[ae("figure",null,[ae("div",{class:"flourish-embed flourish-chart","data-src":"visualisation/23290332"})])],-1)),ae("p",null,Lt(Ke(Pi).p3t1),1),ae("p",null,Lt(Ke(Pi).p3t2),1),ae("div",g1e,[vt(lD,{chapter:"ch4",data:[{title:Ke(Pi).related1Title,desc:Ke(Pi).related1Desc,link:Ke(Pi).related1Link,bg:"img/newspaceera2025_pic15"}]},null,8,["data"])])])]),l[2]||(l[2]=ae("div",{class:"gradient-bg",role:"presentation"},null,-1))]),_:1})]))}}),v1e={class:"leo-main"},y1e={class:"bg-black text-white"},x1e=_t({__name:"App",setup(n){const e=T_(()=>L_(()=>import("./section-one-D2RkjZUN.js"),__vite__mapDeps([0,1,2]))),t=T_(()=>L_(()=>import("./section-three-ogRKiRgT.js"),__vite__mapDeps([3,1,4]))),i=T_(()=>L_(()=>import("./section-tw-Dc0uVwEA.js"),__vite__mapDeps([5,6]))),r=Ln(null),s=window.innerHeight;Yl(()=>{o(),window.addEventListener("resize",o)}),Yd(()=>{window.removeEventListener("resize",o)});function o(){var a;(a=r.value)==null||a.style.setProperty("--init-screen-height",window.matchMedia("(min-width: 1024px)").matches?"100vh":`${s}px`)}return(a,l)=>(lt(),pt("div",{ref_key:"root",ref:r,class:"app"},[vt(KV),ae("main",v1e,[ae("div",y1e,[vt(xme),vt(Ke(e)),vt(jme),vt(Ke(t)),vt(_1e)]),vt(Ke(i))]),vt(uG)],512))}});_U(x1e).mount("#app");export{ua as $,Qc as A,Ai as B,Ya as C,_r as D,Qr as E,zn as F,Bs as G,Ji as H,n7 as I,Ti as J,U1 as K,SA as L,gE as M,Fs as N,vt as O,Br as P,Ke as Q,C1e as R,Zx as S,_E as T,ex as U,ie as V,fX as W,Lt as X,Di as Y,Xc as Z,Uf as _,o2 as a,lD as a0,$b as a1,On as a2,Wb as a3,Hb as a4,en as a5,tAe as a6,bA as a7,tx as a8,Es as a9,pa as aa,N1e as ab,w1e as ac,S1e as ad,R1e as ae,at as af,n2 as ag,bl as ah,Hx as ai,jg as aj,$u as b,Jn as c,nAe as d,wq as e,r2 as f,yE as g,xE as h,al as i,_t as j,k1e as k,Yd as l,D1e as m,B1e as n,Yl as o,F1e as p,U1e as q,Ln as r,O1e as s,I1e as t,pt as u,lt as v,jr as w,ae as x,AM as y,CM as z};
