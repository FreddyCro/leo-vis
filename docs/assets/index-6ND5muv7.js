var gF=Object.defineProperty;var _F=(n,e,t)=>e in n?gF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ei=(n,e,t)=>_F(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Yx(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Ri={},kf=[],rl=()=>{},vF=()=>!1,p2=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Zx=n=>n.startsWith("onUpdate:"),Wr=Object.assign,Kx=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},yF=Object.prototype.hasOwnProperty,Ai=(n,e)=>yF.call(n,e),mn=Array.isArray,Vf=n=>m2(n)==="[object Map]",f7=n=>m2(n)==="[object Set]",Pn=n=>typeof n=="function",cr=n=>typeof n=="string",cu=n=>typeof n=="symbol",Hi=n=>n!==null&&typeof n=="object",A7=n=>(Hi(n)||Pn(n))&&Pn(n.then)&&Pn(n.catch),d7=Object.prototype.toString,m2=n=>d7.call(n),xF=n=>m2(n).slice(8,-1),p7=n=>m2(n)==="[object Object]",Jx=n=>cr(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,X0=Yx(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),g2=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},bF=/-(\w)/g,ra=g2(n=>n.replace(bF,(e,t)=>t?t.toUpperCase():"")),TF=/\B([A-Z])/g,Th=g2(n=>n.replace(TF,"-$1").toLowerCase()),_2=g2(n=>n.charAt(0).toUpperCase()+n.slice(1)),K_=g2(n=>n?`on${_2(n)}`:""),Hu=(n,e)=>!Object.is(n,e),J_=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},m7=(n,e,t,i=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:i,value:t})},SF=n=>{const e=parseFloat(n);return isNaN(e)?n:e},wF=n=>{const e=cr(n)?Number(n):NaN;return isNaN(e)?n:e};let N8;const v2=()=>N8||(N8=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function hl(n){if(mn(n)){const e={};for(let t=0;t<n.length;t++){const i=n[t],r=cr(i)?RF(i):hl(i);if(r)for(const s in r)e[s]=r[s]}return e}else if(cr(n)||Hi(n))return n}const MF=/;(?![^(]*\))/g,EF=/:([^]+)/,CF=/\/\*[^]*?\*\//g;function RF(n){const e={};return n.replace(CF,"").split(MF).forEach(t=>{if(t){const i=t.split(EF);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function Os(n){let e="";if(cr(n))e=n;else if(mn(n))for(let t=0;t<n.length;t++){const i=Os(n[t]);i&&(e+=i+" ")}else if(Hi(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const NF="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",PF=Yx(NF);function g7(n){return!!n||n===""}const _7=n=>!!(n&&n.__v_isRef===!0),Ft=n=>cr(n)?n:n==null?"":mn(n)||Hi(n)&&(n.toString===d7||!Pn(n.toString))?_7(n)?Ft(n.value):JSON.stringify(n,v7,2):String(n),v7=(n,e)=>_7(e)?v7(n,e.value):Vf(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[i,r],s)=>(t[e3(i,s)+" =>"]=r,t),{})}:f7(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>e3(t))}:cu(e)?e3(e):Hi(e)&&!mn(e)&&!p7(e)?String(e):e,e3=(n,e="")=>{var t;return cu(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ds;class LF{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ds,!e&&Ds&&(this.index=(Ds.scopes||(Ds.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Ds;try{return Ds=this,e()}finally{Ds=t}}}on(){Ds=this}off(){Ds=this.parent}stop(e){if(this._active){this._active=!1;let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(this.effects.length=0,t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function y7(){return Ds}function DF(n,e=!1){Ds&&Ds.cleanups.push(n)}let Bi;const t3=new WeakSet;class x7{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ds&&Ds.active&&Ds.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,t3.has(this)&&(t3.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||T7(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,P8(this),S7(this);const e=Bi,t=wa;Bi=this,wa=!0;try{return this.fn()}finally{w7(this),Bi=e,wa=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)n4(e);this.deps=this.depsTail=void 0,P8(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?t3.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){fy(this)&&this.run()}get dirty(){return fy(this)}}let b7=0,Q0,Y0;function T7(n,e=!1){if(n.flags|=8,e){n.next=Y0,Y0=n;return}n.next=Q0,Q0=n}function e4(){b7++}function t4(){if(--b7>0)return;if(Y0){let e=Y0;for(Y0=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;Q0;){let e=Q0;for(Q0=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){n||(n=i)}e=t}}if(n)throw n}function S7(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function w7(n){let e,t=n.depsTail,i=t;for(;i;){const r=i.prevDep;i.version===-1?(i===t&&(t=r),n4(i),IF(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}n.deps=e,n.depsTail=t}function fy(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(M7(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function M7(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===dd))return;n.globalVersion=dd;const e=n.dep;if(n.flags|=2,e.version>0&&!n.isSSR&&n.deps&&!fy(n)){n.flags&=-3;return}const t=Bi,i=wa;Bi=n,wa=!0;try{S7(n);const r=n.fn(n._value);(e.version===0||Hu(r,n._value))&&(n._value=r,e.version++)}catch(r){throw e.version++,r}finally{Bi=t,wa=i,w7(n),n.flags&=-3}}function n4(n,e=!1){const{dep:t,prevSub:i,nextSub:r}=n;if(i&&(i.nextSub=r,n.prevSub=void 0),r&&(r.prevSub=i,n.nextSub=void 0),t.subs===n&&(t.subs=i,!i&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)n4(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function IF(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let wa=!0;const E7=[];function nc(){E7.push(wa),wa=!1}function ic(){const n=E7.pop();wa=n===void 0?!0:n}function P8(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Bi;Bi=void 0;try{e()}finally{Bi=t}}}let dd=0;class BF{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class i4{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Bi||!wa||Bi===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Bi)t=this.activeLink=new BF(Bi,this),Bi.deps?(t.prevDep=Bi.depsTail,Bi.depsTail.nextDep=t,Bi.depsTail=t):Bi.deps=Bi.depsTail=t,C7(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const i=t.nextDep;i.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=i),t.prevDep=Bi.depsTail,t.nextDep=void 0,Bi.depsTail.nextDep=t,Bi.depsTail=t,Bi.deps===t&&(Bi.deps=i)}return t}trigger(e){this.version++,dd++,this.notify(e)}notify(e){e4();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{t4()}}}function C7(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)C7(i)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const ig=new WeakMap,Zc=Symbol(""),Ay=Symbol(""),pd=Symbol("");function ps(n,e,t){if(wa&&Bi){let i=ig.get(n);i||ig.set(n,i=new Map);let r=i.get(t);r||(i.set(t,r=new i4),r.map=i,r.key=t),r.track()}}function zl(n,e,t,i,r,s){const o=ig.get(n);if(!o){dd++;return}const a=l=>{l&&l.trigger()};if(e4(),e==="clear")o.forEach(a);else{const l=mn(n),u=l&&Jx(t);if(l&&t==="length"){const A=Number(i);o.forEach((p,g)=>{(g==="length"||g===pd||!cu(g)&&g>=A)&&a(p)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),u&&a(o.get(pd)),e){case"add":l?u&&a(o.get("length")):(a(o.get(Zc)),Vf(n)&&a(o.get(Ay)));break;case"delete":l||(a(o.get(Zc)),Vf(n)&&a(o.get(Ay)));break;case"set":Vf(n)&&a(o.get(Zc));break}}t4()}function FF(n,e){const t=ig.get(n);return t&&t.get(e)}function kh(n){const e=ni(n);return e===n?e:(ps(e,"iterate",pd),ta(n)?e:e.map(ms))}function y2(n){return ps(n=ni(n),"iterate",pd),n}const UF={__proto__:null,[Symbol.iterator](){return n3(this,Symbol.iterator,ms)},concat(...n){return kh(this).concat(...n.map(e=>mn(e)?kh(e):e))},entries(){return n3(this,"entries",n=>(n[1]=ms(n[1]),n))},every(n,e){return El(this,"every",n,e,void 0,arguments)},filter(n,e){return El(this,"filter",n,e,t=>t.map(ms),arguments)},find(n,e){return El(this,"find",n,e,ms,arguments)},findIndex(n,e){return El(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return El(this,"findLast",n,e,ms,arguments)},findLastIndex(n,e){return El(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return El(this,"forEach",n,e,void 0,arguments)},includes(...n){return i3(this,"includes",n)},indexOf(...n){return i3(this,"indexOf",n)},join(n){return kh(this).join(n)},lastIndexOf(...n){return i3(this,"lastIndexOf",n)},map(n,e){return El(this,"map",n,e,void 0,arguments)},pop(){return t0(this,"pop")},push(...n){return t0(this,"push",n)},reduce(n,...e){return L8(this,"reduce",n,e)},reduceRight(n,...e){return L8(this,"reduceRight",n,e)},shift(){return t0(this,"shift")},some(n,e){return El(this,"some",n,e,void 0,arguments)},splice(...n){return t0(this,"splice",n)},toReversed(){return kh(this).toReversed()},toSorted(n){return kh(this).toSorted(n)},toSpliced(...n){return kh(this).toSpliced(...n)},unshift(...n){return t0(this,"unshift",n)},values(){return n3(this,"values",ms)}};function n3(n,e,t){const i=y2(n),r=i[e]();return i!==n&&!ta(n)&&(r._next=r.next,r.next=()=>{const s=r._next();return s.value&&(s.value=t(s.value)),s}),r}const OF=Array.prototype;function El(n,e,t,i,r,s){const o=y2(n),a=o!==n&&!ta(n),l=o[e];if(l!==OF[e]){const p=l.apply(n,s);return a?ms(p):p}let u=t;o!==n&&(a?u=function(p,g){return t.call(this,ms(p),g,n)}:t.length>2&&(u=function(p,g){return t.call(this,p,g,n)}));const A=l.call(o,u,i);return a&&r?r(A):A}function L8(n,e,t,i){const r=y2(n);let s=t;return r!==n&&(ta(n)?t.length>3&&(s=function(o,a,l){return t.call(this,o,a,l,n)}):s=function(o,a,l){return t.call(this,o,ms(a),l,n)}),r[e](s,...i)}function i3(n,e,t){const i=ni(n);ps(i,"iterate",pd);const r=i[e](...t);return(r===-1||r===!1)&&o4(t[0])?(t[0]=ni(t[0]),i[e](...t)):r}function t0(n,e,t=[]){nc(),e4();const i=ni(n)[e].apply(n,t);return t4(),ic(),i}const kF=Yx("__proto__,__v_isRef,__isVue"),R7=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(cu));function VF(n){cu(n)||(n=String(n));const e=ni(this);return ps(e,"has",n),e.hasOwnProperty(n)}class N7{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,i){if(t==="__v_skip")return e.__v_skip;const r=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!r;if(t==="__v_isReadonly")return r;if(t==="__v_isShallow")return s;if(t==="__v_raw")return i===(r?s?YF:I7:s?D7:L7).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=mn(e);if(!r){let l;if(o&&(l=UF[t]))return l;if(t==="hasOwnProperty")return VF}const a=Reflect.get(e,t,is(e)?e:i);return(cu(t)?R7.has(t):kF(t))||(r||ps(e,"get",t),s)?a:is(a)?o&&Jx(t)?a:a.value:Hi(a)?r?B7(a):Zu(a):a}}class P7 extends N7{constructor(e=!1){super(!1,e)}set(e,t,i,r){let s=e[t];if(!this._isShallow){const l=lh(s);if(!ta(i)&&!lh(i)&&(s=ni(s),i=ni(i)),!mn(e)&&is(s)&&!is(i))return l?!1:(s.value=i,!0)}const o=mn(e)&&Jx(t)?Number(t)<e.length:Ai(e,t),a=Reflect.set(e,t,i,is(e)?e:r);return e===ni(r)&&(o?Hu(i,s)&&zl(e,"set",t,i):zl(e,"add",t,i)),a}deleteProperty(e,t){const i=Ai(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&i&&zl(e,"delete",t,void 0),r}has(e,t){const i=Reflect.has(e,t);return(!cu(t)||!R7.has(t))&&ps(e,"has",t),i}ownKeys(e){return ps(e,"iterate",mn(e)?"length":Zc),Reflect.ownKeys(e)}}class zF extends N7{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const qF=new P7,GF=new zF,HF=new P7(!0);const dy=n=>n,Jp=n=>Reflect.getPrototypeOf(n);function WF(n,e,t){return function(...i){const r=this.__v_raw,s=ni(r),o=Vf(s),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,u=r[n](...i),A=t?dy:e?py:ms;return!e&&ps(s,"iterate",l?Ay:Zc),{next(){const{value:p,done:g}=u.next();return g?{value:p,done:g}:{value:a?[A(p[0]),A(p[1])]:A(p),done:g}},[Symbol.iterator](){return this}}}}function em(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function $F(n,e){const t={get(r){const s=this.__v_raw,o=ni(s),a=ni(r);n||(Hu(r,a)&&ps(o,"get",r),ps(o,"get",a));const{has:l}=Jp(o),u=e?dy:n?py:ms;if(l.call(o,r))return u(s.get(r));if(l.call(o,a))return u(s.get(a));s!==o&&s.get(r)},get size(){const r=this.__v_raw;return!n&&ps(ni(r),"iterate",Zc),Reflect.get(r,"size",r)},has(r){const s=this.__v_raw,o=ni(s),a=ni(r);return n||(Hu(r,a)&&ps(o,"has",r),ps(o,"has",a)),r===a?s.has(r):s.has(r)||s.has(a)},forEach(r,s){const o=this,a=o.__v_raw,l=ni(a),u=e?dy:n?py:ms;return!n&&ps(l,"iterate",Zc),a.forEach((A,p)=>r.call(s,u(A),u(p),o))}};return Wr(t,n?{add:em("add"),set:em("set"),delete:em("delete"),clear:em("clear")}:{add(r){!e&&!ta(r)&&!lh(r)&&(r=ni(r));const s=ni(this);return Jp(s).has.call(s,r)||(s.add(r),zl(s,"add",r,r)),this},set(r,s){!e&&!ta(s)&&!lh(s)&&(s=ni(s));const o=ni(this),{has:a,get:l}=Jp(o);let u=a.call(o,r);u||(r=ni(r),u=a.call(o,r));const A=l.call(o,r);return o.set(r,s),u?Hu(s,A)&&zl(o,"set",r,s):zl(o,"add",r,s),this},delete(r){const s=ni(this),{has:o,get:a}=Jp(s);let l=o.call(s,r);l||(r=ni(r),l=o.call(s,r)),a&&a.call(s,r);const u=s.delete(r);return l&&zl(s,"delete",r,void 0),u},clear(){const r=ni(this),s=r.size!==0,o=r.clear();return s&&zl(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=WF(r,n,e)}),t}function r4(n,e){const t=$F(n,e);return(i,r,s)=>r==="__v_isReactive"?!n:r==="__v_isReadonly"?n:r==="__v_raw"?i:Reflect.get(Ai(t,r)&&r in i?t:i,r,s)}const jF={get:r4(!1,!1)},XF={get:r4(!1,!0)},QF={get:r4(!0,!1)};const L7=new WeakMap,D7=new WeakMap,I7=new WeakMap,YF=new WeakMap;function ZF(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function KF(n){return n.__v_skip||!Object.isExtensible(n)?0:ZF(xF(n))}function Zu(n){return lh(n)?n:s4(n,!1,qF,jF,L7)}function JF(n){return s4(n,!1,HF,XF,D7)}function B7(n){return s4(n,!0,GF,QF,I7)}function s4(n,e,t,i,r){if(!Hi(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=r.get(n);if(s)return s;const o=KF(n);if(o===0)return n;const a=new Proxy(n,o===2?i:t);return r.set(n,a),a}function zf(n){return lh(n)?zf(n.__v_raw):!!(n&&n.__v_isReactive)}function lh(n){return!!(n&&n.__v_isReadonly)}function ta(n){return!!(n&&n.__v_isShallow)}function o4(n){return n?!!n.__v_raw:!1}function ni(n){const e=n&&n.__v_raw;return e?ni(e):n}function eU(n){return!Ai(n,"__v_skip")&&Object.isExtensible(n)&&m7(n,"__v_skip",!0),n}const ms=n=>Hi(n)?Zu(n):n,py=n=>Hi(n)?B7(n):n;function is(n){return n?n.__v_isRef===!0:!1}function Fi(n){return tU(n,!1)}function tU(n,e){return is(n)?n:new nU(n,e)}class nU{constructor(e,t){this.dep=new i4,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:ni(e),this._value=t?e:ms(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,i=this.__v_isShallow||ta(e)||lh(e);e=i?e:ni(e),Hu(e,t)&&(this._rawValue=e,this._value=i?e:ms(e),this.dep.trigger())}}function Ze(n){return is(n)?n.value:n}const iU={get:(n,e,t)=>e==="__v_raw"?n:Ze(Reflect.get(n,e,t)),set:(n,e,t,i)=>{const r=n[e];return is(r)&&!is(t)?(r.value=t,!0):Reflect.set(n,e,t,i)}};function F7(n){return zf(n)?n:new Proxy(n,iU)}function D8(n){const e=mn(n)?new Array(n.length):{};for(const t in n)e[t]=sU(n,t);return e}class rU{constructor(e,t,i){this._object=e,this._key=t,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return FF(ni(this._object),this._key)}}function sU(n,e,t){const i=n[e];return is(i)?i:new rU(n,e,t)}class oU{constructor(e,t,i){this.fn=e,this.setter=t,this._value=void 0,this.dep=new i4(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=dd-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Bi!==this)return T7(this,!0),!0}get value(){const e=this.dep.track();return M7(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function aU(n,e,t=!1){let i,r;return Pn(n)?i=n:(i=n.get,r=n.set),new oU(i,r,t)}const tm={},rg=new WeakMap;let Fc;function lU(n,e=!1,t=Fc){if(t){let i=rg.get(t);i||rg.set(t,i=[]),i.push(n)}}function uU(n,e,t=Ri){const{immediate:i,deep:r,once:s,scheduler:o,augmentJob:a,call:l}=t,u=R=>r?R:ta(R)||r===!1||r===0?ql(R,1):ql(R);let A,p,g,v,y=!1,b=!1;if(is(n)?(p=()=>n.value,y=ta(n)):zf(n)?(p=()=>u(n),y=!0):mn(n)?(b=!0,y=n.some(R=>zf(R)||ta(R)),p=()=>n.map(R=>{if(is(R))return R.value;if(zf(R))return u(R);if(Pn(R))return l?l(R,2):R()})):Pn(n)?e?p=l?()=>l(n,2):n:p=()=>{if(g){nc();try{g()}finally{ic()}}const R=Fc;Fc=A;try{return l?l(n,3,[v]):n(v)}finally{Fc=R}}:p=rl,e&&r){const R=p,D=r===!0?1/0:r;p=()=>ql(R(),D)}const w=y7(),S=()=>{A.stop(),w&&w.active&&Kx(w.effects,A)};if(s&&e){const R=e;e=(...D)=>{R(...D),S()}}let C=b?new Array(n.length).fill(tm):tm;const E=R=>{if(!(!(A.flags&1)||!A.dirty&&!R))if(e){const D=A.run();if(r||y||(b?D.some((B,L)=>Hu(B,C[L])):Hu(D,C))){g&&g();const B=Fc;Fc=A;try{const L=[D,C===tm?void 0:b&&C[0]===tm?[]:C,v];l?l(e,3,L):e(...L),C=D}finally{Fc=B}}}else A.run()};return a&&a(E),A=new x7(p),A.scheduler=o?()=>o(E,!1):E,v=R=>lU(R,!1,A),g=A.onStop=()=>{const R=rg.get(A);if(R){if(l)l(R,4);else for(const D of R)D();rg.delete(A)}},e?i?E(!0):C=A.run():o?o(E.bind(null,!0),!0):A.run(),S.pause=A.pause.bind(A),S.resume=A.resume.bind(A),S.stop=S,S}function ql(n,e=1/0,t){if(e<=0||!Hi(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,is(n))ql(n.value,e,t);else if(mn(n))for(let i=0;i<n.length;i++)ql(n[i],e,t);else if(f7(n)||Vf(n))n.forEach(i=>{ql(i,e,t)});else if(p7(n)){for(const i in n)ql(n[i],e,t);for(const i of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,i)&&ql(n[i],e,t)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ap(n,e,t,i){try{return i?n(...i):n()}catch(r){x2(r,e,t)}}function Na(n,e,t,i){if(Pn(n)){const r=Ap(n,e,t,i);return r&&A7(r)&&r.catch(s=>{x2(s,e,t)}),r}if(mn(n)){const r=[];for(let s=0;s<n.length;s++)r.push(Na(n[s],e,t,i));return r}}function x2(n,e,t,i=!0){const r=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Ri;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const A=a.ec;if(A){for(let p=0;p<A.length;p++)if(A[p](n,l,u)===!1)return}a=a.parent}if(s){nc(),Ap(s,null,10,[n,l,u]),ic();return}}cU(n,t,r,i,o)}function cU(n,e,t,i=!0,r=!1){if(r)throw n;console.error(n)}const Is=[];let Qa=-1;const qf=[];let Iu=null,Sf=0;const U7=Promise.resolve();let sg=null;function O7(n){const e=sg||U7;return n?e.then(this?n.bind(this):n):e}function hU(n){let e=Qa+1,t=Is.length;for(;e<t;){const i=e+t>>>1,r=Is[i],s=md(r);s<n||s===n&&r.flags&2?e=i+1:t=i}return e}function a4(n){if(!(n.flags&1)){const e=md(n),t=Is[Is.length-1];!t||!(n.flags&2)&&e>=md(t)?Is.push(n):Is.splice(hU(e),0,n),n.flags|=1,k7()}}function k7(){sg||(sg=U7.then(z7))}function fU(n){mn(n)?qf.push(...n):Iu&&n.id===-1?Iu.splice(Sf+1,0,n):n.flags&1||(qf.push(n),n.flags|=1),k7()}function I8(n,e,t=Qa+1){for(;t<Is.length;t++){const i=Is[t];if(i&&i.flags&2){if(n&&i.id!==n.uid)continue;Is.splice(t,1),t--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function V7(n){if(qf.length){const e=[...new Set(qf)].sort((t,i)=>md(t)-md(i));if(qf.length=0,Iu){Iu.push(...e);return}for(Iu=e,Sf=0;Sf<Iu.length;Sf++){const t=Iu[Sf];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}Iu=null,Sf=0}}const md=n=>n.id==null?n.flags&2?-1:1/0:n.id;function z7(n){try{for(Qa=0;Qa<Is.length;Qa++){const e=Is[Qa];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Ap(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Qa<Is.length;Qa++){const e=Is[Qa];e&&(e.flags&=-2)}Qa=-1,Is.length=0,V7(),sg=null,(Is.length||qf.length)&&z7()}}let Gr=null,q7=null;function og(n){const e=Gr;return Gr=n,q7=n&&n.type.__scopeId||null,e}function Sr(n,e=Gr,t){if(!e||n._n)return n;const i=(...r)=>{i._d&&X8(-1);const s=og(e);let o;try{o=n(...r)}finally{og(s),i._d&&X8(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function my(n,e){if(Gr===null)return n;const t=M2(Gr),i=n.dirs||(n.dirs=[]);for(let r=0;r<e.length;r++){let[s,o,a,l=Ri]=e[r];s&&(Pn(s)&&(s={mounted:s,updated:s}),s.deep&&ql(o),i.push({dir:s,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function gc(n,e,t,i){const r=n.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(nc(),Na(l,t,8,[n.el,a,n,e]),ic())}}const G7=Symbol("_vte"),H7=n=>n.__isTeleport,Z0=n=>n&&(n.disabled||n.disabled===""),B8=n=>n&&(n.defer||n.defer===""),F8=n=>typeof SVGElement<"u"&&n instanceof SVGElement,U8=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,gy=(n,e)=>{const t=n&&n.to;return cr(t)?e?e(t):null:t},W7={name:"Teleport",__isTeleport:!0,process(n,e,t,i,r,s,o,a,l,u){const{mc:A,pc:p,pbc:g,o:{insert:v,querySelector:y,createText:b,createComment:w}}=u,S=Z0(e.props);let{shapeFlag:C,children:E,dynamicChildren:R}=e;if(n==null){const D=e.el=b(""),B=e.anchor=b("");v(D,t,i),v(B,t,i);const L=(P,F)=>{C&16&&(r&&r.isCE&&(r.ce._teleportTarget=P),A(E,P,F,r,s,o,a,l))},U=()=>{const P=e.target=gy(e.props,y),F=$7(P,e,b,v);P&&(o!=="svg"&&F8(P)?o="svg":o!=="mathml"&&U8(P)&&(o="mathml"),S||(L(P,F),L1(e,!1)))};S&&(L(t,B),L1(e,!0)),B8(e.props)?Ls(()=>{U(),e.el.__isMounted=!0},s):U()}else{if(B8(e.props)&&!n.el.__isMounted){Ls(()=>{W7.process(n,e,t,i,r,s,o,a,l,u),delete n.el.__isMounted},s);return}e.el=n.el,e.targetStart=n.targetStart;const D=e.anchor=n.anchor,B=e.target=n.target,L=e.targetAnchor=n.targetAnchor,U=Z0(n.props),P=U?t:B,F=U?D:L;if(o==="svg"||F8(B)?o="svg":(o==="mathml"||U8(B))&&(o="mathml"),R?(g(n.dynamicChildren,R,P,r,s,o,a),h4(n,e,!0)):l||p(n,e,P,F,r,s,o,a,!1),S)U?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):nm(e,t,D,u,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const V=e.target=gy(e.props,y);V&&nm(e,V,null,u,0)}else U&&nm(e,B,L,u,1);L1(e,S)}},remove(n,e,t,{um:i,o:{remove:r}},s){const{shapeFlag:o,children:a,anchor:l,targetStart:u,targetAnchor:A,target:p,props:g}=n;if(p&&(r(u),r(A)),s&&r(l),o&16){const v=s||!Z0(g);for(let y=0;y<a.length;y++){const b=a[y];i(b,e,t,v,!!b.dynamicChildren)}}},move:nm,hydrate:AU};function nm(n,e,t,{o:{insert:i},m:r},s=2){s===0&&i(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:u,props:A}=n,p=s===2;if(p&&i(o,e,t),(!p||Z0(A))&&l&16)for(let g=0;g<u.length;g++)r(u[g],e,t,2);p&&i(a,e,t)}function AU(n,e,t,i,r,s,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:u,createText:A}},p){const g=e.target=gy(e.props,l);if(g){const v=Z0(e.props),y=g._lpa||g.firstChild;if(e.shapeFlag&16)if(v)e.anchor=p(o(n),e,a(n),t,i,r,s),e.targetStart=y,e.targetAnchor=y&&o(y);else{e.anchor=o(n);let b=y;for(;b;){if(b&&b.nodeType===8){if(b.data==="teleport start anchor")e.targetStart=b;else if(b.data==="teleport anchor"){e.targetAnchor=b,g._lpa=e.targetAnchor&&o(e.targetAnchor);break}}b=o(b)}e.targetAnchor||$7(g,e,A,u),p(y&&o(y),e,g,t,i,r,s)}L1(e,v)}return e.anchor&&o(e.anchor)}const dU=W7;function L1(n,e){const t=n.ctx;if(t&&t.ut){let i,r;for(e?(i=n.el,r=n.anchor):(i=n.targetStart,r=n.targetAnchor);i&&i!==r;)i.nodeType===1&&i.setAttribute("data-v-owner",t.uid),i=i.nextSibling;t.ut()}}function $7(n,e,t,i){const r=e.targetStart=t(""),s=e.targetAnchor=t("");return r[G7]=s,n&&(i(r,n),i(s,n)),s}const Bu=Symbol("_leaveCb"),im=Symbol("_enterCb");function pU(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return fu(()=>{n.isMounted=!0}),eE(()=>{n.isUnmounting=!0}),n}const Ho=[Function,Array],j7={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ho,onEnter:Ho,onAfterEnter:Ho,onEnterCancelled:Ho,onBeforeLeave:Ho,onLeave:Ho,onAfterLeave:Ho,onLeaveCancelled:Ho,onBeforeAppear:Ho,onAppear:Ho,onAfterAppear:Ho,onAppearCancelled:Ho},X7=n=>{const e=n.subTree;return e.component?X7(e.component):e},mU={name:"BaseTransition",props:j7,setup(n,{slots:e}){const t=bE(),i=pU();return()=>{const r=e.default&&Z7(e.default(),!0);if(!r||!r.length)return;const s=Q7(r),o=ni(n),{mode:a}=o;if(i.isLeaving)return r3(s);const l=O8(s);if(!l)return r3(s);let u=_y(l,o,i,t,p=>u=p);l.type!==ks&&gd(l,u);let A=t.subTree&&O8(t.subTree);if(A&&A.type!==ks&&!zc(l,A)&&X7(t).type!==ks){let p=_y(A,o,i,t);if(gd(A,p),a==="out-in"&&l.type!==ks)return i.isLeaving=!0,p.afterLeave=()=>{i.isLeaving=!1,t.job.flags&8||t.update(),delete p.afterLeave,A=void 0},r3(s);a==="in-out"&&l.type!==ks?p.delayLeave=(g,v,y)=>{const b=Y7(i,A);b[String(A.key)]=A,g[Bu]=()=>{v(),g[Bu]=void 0,delete u.delayedLeave,A=void 0},u.delayedLeave=()=>{y(),delete u.delayedLeave,A=void 0}}:A=void 0}else A&&(A=void 0);return s}}};function Q7(n){let e=n[0];if(n.length>1){for(const t of n)if(t.type!==ks){e=t;break}}return e}const gU=mU;function Y7(n,e){const{leavingVNodes:t}=n;let i=t.get(e.type);return i||(i=Object.create(null),t.set(e.type,i)),i}function _y(n,e,t,i,r){const{appear:s,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:u,onAfterEnter:A,onEnterCancelled:p,onBeforeLeave:g,onLeave:v,onAfterLeave:y,onLeaveCancelled:b,onBeforeAppear:w,onAppear:S,onAfterAppear:C,onAppearCancelled:E}=e,R=String(n.key),D=Y7(t,n),B=(P,F)=>{P&&Na(P,i,9,F)},L=(P,F)=>{const V=F[1];B(P,F),mn(P)?P.every(H=>H.length<=1)&&V():P.length<=1&&V()},U={mode:o,persisted:a,beforeEnter(P){let F=l;if(!t.isMounted)if(s)F=w||l;else return;P[Bu]&&P[Bu](!0);const V=D[R];V&&zc(n,V)&&V.el[Bu]&&V.el[Bu](),B(F,[P])},enter(P){let F=u,V=A,H=p;if(!t.isMounted)if(s)F=S||u,V=C||A,H=E||p;else return;let j=!1;const J=P[im]=Z=>{j||(j=!0,Z?B(H,[P]):B(V,[P]),U.delayedLeave&&U.delayedLeave(),P[im]=void 0)};F?L(F,[P,J]):J()},leave(P,F){const V=String(n.key);if(P[im]&&P[im](!0),t.isUnmounting)return F();B(g,[P]);let H=!1;const j=P[Bu]=J=>{H||(H=!0,F(),J?B(b,[P]):B(y,[P]),P[Bu]=void 0,D[V]===n&&delete D[V])};D[V]=n,v?L(v,[P,j]):j()},clone(P){const F=_y(P,e,t,i,r);return r&&r(F),F}};return U}function r3(n){if(b2(n))return n=Ku(n),n.children=null,n}function O8(n){if(!b2(n))return H7(n.type)&&n.children?Q7(n.children):n;const{shapeFlag:e,children:t}=n;if(t){if(e&16)return t[0];if(e&32&&Pn(t.default))return t.default()}}function gd(n,e){n.shapeFlag&6&&n.component?(n.transition=e,gd(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function Z7(n,e=!1,t){let i=[],r=0;for(let s=0;s<n.length;s++){let o=n[s];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===sr?(o.patchFlag&128&&r++,i=i.concat(Z7(o.children,e,a))):(e||o.type!==ks)&&i.push(a!=null?Ku(o,{key:a}):o)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function Ct(n,e){return Pn(n)?Wr({name:n.name},e,{setup:n}):n}function K7(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function ag(n,e,t,i,r=!1){if(mn(n)){n.forEach((y,b)=>ag(y,e&&(mn(e)?e[b]:e),t,i,r));return}if(Gf(i)&&!r){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&ag(n,e,t,i.component.subTree);return}const s=i.shapeFlag&4?M2(i.component):i.el,o=r?null:s,{i:a,r:l}=n,u=e&&e.r,A=a.refs===Ri?a.refs={}:a.refs,p=a.setupState,g=ni(p),v=p===Ri?()=>!1:y=>Ai(g,y);if(u!=null&&u!==l&&(cr(u)?(A[u]=null,v(u)&&(p[u]=null)):is(u)&&(u.value=null)),Pn(l))Ap(l,a,12,[o,A]);else{const y=cr(l),b=is(l);if(y||b){const w=()=>{if(n.f){const S=y?v(l)?p[l]:A[l]:l.value;r?mn(S)&&Kx(S,s):mn(S)?S.includes(s)||S.push(s):y?(A[l]=[s],v(l)&&(p[l]=A[l])):(l.value=[s],n.k&&(A[n.k]=l.value))}else y?(A[l]=o,v(l)&&(p[l]=o)):b&&(l.value=o,n.k&&(A[n.k]=o))};o?(w.id=-1,Ls(w,t)):w()}}}v2().requestIdleCallback;v2().cancelIdleCallback;const Gf=n=>!!n.type.__asyncLoader,b2=n=>n.type.__isKeepAlive;function _U(n,e){J7(n,"a",e)}function vU(n,e){J7(n,"da",e)}function J7(n,e,t=ns){const i=n.__wdc||(n.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return n()});if(T2(e,i,t),t){let r=t.parent;for(;r&&r.parent;)b2(r.parent.vnode)&&yU(i,e,t,r),r=r.parent}}function yU(n,e,t,i){const r=T2(e,n,i,!0);l4(()=>{Kx(i[e],r)},t)}function T2(n,e,t=ns,i=!1){if(t){const r=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{nc();const a=pp(t),l=Na(e,t,n,o);return a(),ic(),l});return i?r.unshift(s):r.push(s),s}}const hu=n=>(e,t=ns)=>{(!yd||n==="sp")&&T2(n,(...i)=>e(...i),t)},xU=hu("bm"),fu=hu("m"),bU=hu("bu"),TU=hu("u"),eE=hu("bum"),l4=hu("um"),SU=hu("sp"),wU=hu("rtg"),MU=hu("rtc");function EU(n,e=ns){T2("ec",n,e)}const CU="components";function tE(n,e){return NU(CU,n,!0,e)||n}const RU=Symbol.for("v-ndc");function NU(n,e,t=!0,i=!1){const r=Gr||ns;if(r){const s=r.type;{const a=pO(s,!1);if(a&&(a===e||a===ra(e)||a===_2(ra(e))))return s}const o=k8(r[n]||s[n],e)||k8(r.appContext[n],e);return!o&&i?s:o}}function k8(n,e){return n&&(n[e]||n[ra(e)]||n[_2(ra(e))])}function lg(n,e,t,i){let r;const s=t,o=mn(n);if(o||cr(n)){const a=o&&zf(n);let l=!1;a&&(l=!ta(n),n=y2(n)),r=new Array(n.length);for(let u=0,A=n.length;u<A;u++)r[u]=e(l?ms(n[u]):n[u],u,void 0,s)}else if(typeof n=="number"){r=new Array(n);for(let a=0;a<n;a++)r[a]=e(a+1,a,void 0,s)}else if(Hi(n))if(n[Symbol.iterator])r=Array.from(n,(a,l)=>e(a,l,void 0,s));else{const a=Object.keys(n);r=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const A=a[l];r[l]=e(n[A],A,l,s)}}else r=[];return r}function $r(n,e,t={},i,r){if(Gr.ce||Gr.parent&&Gf(Gr.parent)&&Gr.parent.ce)return e!=="default"&&(t.name=e),yt(),fl(sr,null,[Ut("slot",t,i&&i())],64);let s=n[e];s&&s._c&&(s._d=!1),yt();const o=s&&nE(s(t)),a=t.key||o&&o.key,l=fl(sr,{key:(a&&!cu(a)?a:`_${e}`)+(!o&&i?"_fb":"")},o||(i?i():[]),o&&n._===1?64:-2);return l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),s&&s._c&&(s._d=!0),l}function nE(n){return n.some(e=>vd(e)?!(e.type===ks||e.type===sr&&!nE(e.children)):!0)?n:null}const vy=n=>n?TE(n)?M2(n):vy(n.parent):null,K0=Wr(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>vy(n.parent),$root:n=>vy(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>rE(n),$forceUpdate:n=>n.f||(n.f=()=>{a4(n.update)}),$nextTick:n=>n.n||(n.n=O7.bind(n.proxy)),$watch:n=>ZU.bind(n)}),s3=(n,e)=>n!==Ri&&!n.__isScriptSetup&&Ai(n,e),PU={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=n;let u;if(e[0]!=="$"){const v=o[e];if(v!==void 0)switch(v){case 1:return i[e];case 2:return r[e];case 4:return t[e];case 3:return s[e]}else{if(s3(i,e))return o[e]=1,i[e];if(r!==Ri&&Ai(r,e))return o[e]=2,r[e];if((u=n.propsOptions[0])&&Ai(u,e))return o[e]=3,s[e];if(t!==Ri&&Ai(t,e))return o[e]=4,t[e];yy&&(o[e]=0)}}const A=K0[e];let p,g;if(A)return e==="$attrs"&&ps(n.attrs,"get",""),A(n);if((p=a.__cssModules)&&(p=p[e]))return p;if(t!==Ri&&Ai(t,e))return o[e]=4,t[e];if(g=l.config.globalProperties,Ai(g,e))return g[e]},set({_:n},e,t){const{data:i,setupState:r,ctx:s}=n;return s3(r,e)?(r[e]=t,!0):i!==Ri&&Ai(i,e)?(i[e]=t,!0):Ai(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!t[o]||n!==Ri&&Ai(n,o)||s3(e,o)||(a=s[0])&&Ai(a,o)||Ai(i,o)||Ai(K0,o)||Ai(r.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:Ai(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function V8(n){return mn(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let yy=!0;function LU(n){const e=rE(n),t=n.proxy,i=n.ctx;yy=!1,e.beforeCreate&&z8(e.beforeCreate,n,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:u,created:A,beforeMount:p,mounted:g,beforeUpdate:v,updated:y,activated:b,deactivated:w,beforeDestroy:S,beforeUnmount:C,destroyed:E,unmounted:R,render:D,renderTracked:B,renderTriggered:L,errorCaptured:U,serverPrefetch:P,expose:F,inheritAttrs:V,components:H,directives:j,filters:J}=e;if(u&&DU(u,i,null),o)for(const K in o){const ee=o[K];Pn(ee)&&(i[K]=ee.bind(t))}if(r){const K=r.call(t,t);Hi(K)&&(n.data=Zu(K))}if(yy=!0,s)for(const K in s){const ee=s[K],se=Pn(ee)?ee.bind(t,t):Pn(ee.get)?ee.get.bind(t,t):rl,ge=!Pn(ee)&&Pn(ee.set)?ee.set.bind(t):rl,de=eo({get:se,set:ge});Object.defineProperty(i,K,{enumerable:!0,configurable:!0,get:()=>de.value,set:Ae=>de.value=Ae})}if(a)for(const K in a)iE(a[K],i,t,K);if(l){const K=Pn(l)?l.call(t):l;Reflect.ownKeys(K).forEach(ee=>{u4(ee,K[ee])})}A&&z8(A,n,"c");function W(K,ee){mn(ee)?ee.forEach(se=>K(se.bind(t))):ee&&K(ee.bind(t))}if(W(xU,p),W(fu,g),W(bU,v),W(TU,y),W(_U,b),W(vU,w),W(EU,U),W(MU,B),W(wU,L),W(eE,C),W(l4,R),W(SU,P),mn(F))if(F.length){const K=n.exposed||(n.exposed={});F.forEach(ee=>{Object.defineProperty(K,ee,{get:()=>t[ee],set:se=>t[ee]=se})})}else n.exposed||(n.exposed={});D&&n.render===rl&&(n.render=D),V!=null&&(n.inheritAttrs=V),H&&(n.components=H),j&&(n.directives=j),P&&K7(n)}function DU(n,e,t=rl){mn(n)&&(n=xy(n));for(const i in n){const r=n[i];let s;Hi(r)?"default"in r?s=Wf(r.from||i,r.default,!0):s=Wf(r.from||i):s=Wf(r),is(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[i]=s}}function z8(n,e,t){Na(mn(n)?n.map(i=>i.bind(e.proxy)):n.bind(e.proxy),e,t)}function iE(n,e,t,i){let r=i.includes(".")?gE(t,i):()=>t[i];if(cr(n)){const s=e[n];Pn(s)&&qs(r,s)}else if(Pn(n))qs(r,n.bind(t));else if(Hi(n))if(mn(n))n.forEach(s=>iE(s,e,t,i));else{const s=Pn(n.handler)?n.handler.bind(t):e[n.handler];Pn(s)&&qs(r,s,n)}}function rE(n){const e=n.type,{mixins:t,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!t&&!i?l=e:(l={},r.length&&r.forEach(u=>ug(l,u,o,!0)),ug(l,e,o)),Hi(e)&&s.set(e,l),l}function ug(n,e,t,i=!1){const{mixins:r,extends:s}=e;s&&ug(n,s,t,!0),r&&r.forEach(o=>ug(n,o,t,!0));for(const o in e)if(!(i&&o==="expose")){const a=IU[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const IU={data:q8,props:G8,emits:G8,methods:O0,computed:O0,beforeCreate:Rs,created:Rs,beforeMount:Rs,mounted:Rs,beforeUpdate:Rs,updated:Rs,beforeDestroy:Rs,beforeUnmount:Rs,destroyed:Rs,unmounted:Rs,activated:Rs,deactivated:Rs,errorCaptured:Rs,serverPrefetch:Rs,components:O0,directives:O0,watch:FU,provide:q8,inject:BU};function q8(n,e){return e?n?function(){return Wr(Pn(n)?n.call(this,this):n,Pn(e)?e.call(this,this):e)}:e:n}function BU(n,e){return O0(xy(n),xy(e))}function xy(n){if(mn(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Rs(n,e){return n?[...new Set([].concat(n,e))]:e}function O0(n,e){return n?Wr(Object.create(null),n,e):e}function G8(n,e){return n?mn(n)&&mn(e)?[...new Set([...n,...e])]:Wr(Object.create(null),V8(n),V8(e??{})):e}function FU(n,e){if(!n)return e;if(!e)return n;const t=Wr(Object.create(null),n);for(const i in e)t[i]=Rs(n[i],e[i]);return t}function sE(){return{app:null,config:{isNativeTag:vF,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let UU=0;function OU(n,e){return function(i,r=null){Pn(i)||(i=Wr({},i)),r!=null&&!Hi(r)&&(r=null);const s=sE(),o=new WeakSet,a=[];let l=!1;const u=s.app={_uid:UU++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:gO,get config(){return s.config},set config(A){},use(A,...p){return o.has(A)||(A&&Pn(A.install)?(o.add(A),A.install(u,...p)):Pn(A)&&(o.add(A),A(u,...p))),u},mixin(A){return s.mixins.includes(A)||s.mixins.push(A),u},component(A,p){return p?(s.components[A]=p,u):s.components[A]},directive(A,p){return p?(s.directives[A]=p,u):s.directives[A]},mount(A,p,g){if(!l){const v=u._ceVNode||Ut(i,r);return v.appContext=s,g===!0?g="svg":g===!1&&(g=void 0),n(v,A,g),l=!0,u._container=A,A.__vue_app__=u,M2(v.component)}},onUnmount(A){a.push(A)},unmount(){l&&(Na(a,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(A,p){return s.provides[A]=p,u},runWithContext(A){const p=Hf;Hf=u;try{return A()}finally{Hf=p}}};return u}}let Hf=null;function u4(n,e){if(ns){let t=ns.provides;const i=ns.parent&&ns.parent.provides;i===t&&(t=ns.provides=Object.create(i)),t[n]=e}}function Wf(n,e,t=!1){const i=ns||Gr;if(i||Hf){const r=Hf?Hf._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&n in r)return r[n];if(arguments.length>1)return t&&Pn(e)?e.call(i&&i.proxy):e}}const oE={},aE=()=>Object.create(oE),lE=n=>Object.getPrototypeOf(n)===oE;function kU(n,e,t,i=!1){const r={},s=aE();n.propsDefaults=Object.create(null),uE(n,e,r,s);for(const o in n.propsOptions[0])o in r||(r[o]=void 0);t?n.props=i?r:JF(r):n.type.props?n.props=r:n.props=s,n.attrs=s}function VU(n,e,t,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=n,a=ni(r),[l]=n.propsOptions;let u=!1;if((i||o>0)&&!(o&16)){if(o&8){const A=n.vnode.dynamicProps;for(let p=0;p<A.length;p++){let g=A[p];if(S2(n.emitsOptions,g))continue;const v=e[g];if(l)if(Ai(s,g))v!==s[g]&&(s[g]=v,u=!0);else{const y=ra(g);r[y]=by(l,a,y,v,n,!1)}else v!==s[g]&&(s[g]=v,u=!0)}}}else{uE(n,e,r,s)&&(u=!0);let A;for(const p in a)(!e||!Ai(e,p)&&((A=Th(p))===p||!Ai(e,A)))&&(l?t&&(t[p]!==void 0||t[A]!==void 0)&&(r[p]=by(l,a,p,void 0,n,!0)):delete r[p]);if(s!==a)for(const p in s)(!e||!Ai(e,p))&&(delete s[p],u=!0)}u&&zl(n.attrs,"set","")}function uE(n,e,t,i){const[r,s]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(X0(l))continue;const u=e[l];let A;r&&Ai(r,A=ra(l))?!s||!s.includes(A)?t[A]=u:(a||(a={}))[A]=u:S2(n.emitsOptions,l)||(!(l in i)||u!==i[l])&&(i[l]=u,o=!0)}if(s){const l=ni(t),u=a||Ri;for(let A=0;A<s.length;A++){const p=s[A];t[p]=by(r,l,p,u[p],n,!Ai(u,p))}}return o}function by(n,e,t,i,r,s){const o=n[t];if(o!=null){const a=Ai(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Pn(l)){const{propsDefaults:u}=r;if(t in u)i=u[t];else{const A=pp(r);i=u[t]=l.call(null,e),A()}}else i=l;r.ce&&r.ce._setProp(t,i)}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===Th(t))&&(i=!0))}return i}const zU=new WeakMap;function cE(n,e,t=!1){const i=t?zU:e.propsCache,r=i.get(n);if(r)return r;const s=n.props,o={},a=[];let l=!1;if(!Pn(n)){const A=p=>{l=!0;const[g,v]=cE(p,e,!0);Wr(o,g),v&&a.push(...v)};!t&&e.mixins.length&&e.mixins.forEach(A),n.extends&&A(n.extends),n.mixins&&n.mixins.forEach(A)}if(!s&&!l)return Hi(n)&&i.set(n,kf),kf;if(mn(s))for(let A=0;A<s.length;A++){const p=ra(s[A]);H8(p)&&(o[p]=Ri)}else if(s)for(const A in s){const p=ra(A);if(H8(p)){const g=s[A],v=o[p]=mn(g)||Pn(g)?{type:g}:Wr({},g),y=v.type;let b=!1,w=!0;if(mn(y))for(let S=0;S<y.length;++S){const C=y[S],E=Pn(C)&&C.name;if(E==="Boolean"){b=!0;break}else E==="String"&&(w=!1)}else b=Pn(y)&&y.name==="Boolean";v[0]=b,v[1]=w,(b||Ai(v,"default"))&&a.push(p)}}const u=[o,a];return Hi(n)&&i.set(n,u),u}function H8(n){return n[0]!=="$"&&!X0(n)}const hE=n=>n[0]==="_"||n==="$stable",c4=n=>mn(n)?n.map(Ya):[Ya(n)],qU=(n,e,t)=>{if(e._n)return e;const i=Sr((...r)=>c4(e(...r)),t);return i._c=!1,i},fE=(n,e,t)=>{const i=n._ctx;for(const r in n){if(hE(r))continue;const s=n[r];if(Pn(s))e[r]=qU(r,s,i);else if(s!=null){const o=c4(s);e[r]=()=>o}}},AE=(n,e)=>{const t=c4(e);n.slots.default=()=>t},dE=(n,e,t)=>{for(const i in e)(t||i!=="_")&&(n[i]=e[i])},GU=(n,e,t)=>{const i=n.slots=aE();if(n.vnode.shapeFlag&32){const r=e._;r?(dE(i,e,t),t&&m7(i,"_",r,!0)):fE(e,i)}else e&&AE(n,e)},HU=(n,e,t)=>{const{vnode:i,slots:r}=n;let s=!0,o=Ri;if(i.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:dE(r,e,t):(s=!e.$stable,fE(e,r)),o=e}else e&&(AE(n,e),o={default:1});if(s)for(const a in r)!hE(a)&&o[a]==null&&delete r[a]},Ls=rO;function WU(n){return $U(n)}function $U(n,e){const t=v2();t.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:u,setElementText:A,parentNode:p,nextSibling:g,setScopeId:v=rl,insertStaticContent:y}=n,b=(ae,le,G,Te=null,pe=null,me=null,ve=void 0,qe=null,Me=!!le.dynamicChildren)=>{if(ae===le)return;ae&&!zc(ae,le)&&(Te=$e(ae),Ae(ae,pe,me,!0),ae=null),le.patchFlag===-2&&(Me=!1,le.dynamicChildren=null);const{type:$,ref:z,shapeFlag:fe}=le;switch($){case dp:w(ae,le,G,Te);break;case ks:S(ae,le,G,Te);break;case D1:ae==null&&C(le,G,Te,ve);break;case sr:H(ae,le,G,Te,pe,me,ve,qe,Me);break;default:fe&1?D(ae,le,G,Te,pe,me,ve,qe,Me):fe&6?j(ae,le,G,Te,pe,me,ve,qe,Me):(fe&64||fe&128)&&$.process(ae,le,G,Te,pe,me,ve,qe,Me,st)}z!=null&&pe&&ag(z,ae&&ae.ref,me,le||ae,!le)},w=(ae,le,G,Te)=>{if(ae==null)i(le.el=a(le.children),G,Te);else{const pe=le.el=ae.el;le.children!==ae.children&&u(pe,le.children)}},S=(ae,le,G,Te)=>{ae==null?i(le.el=l(le.children||""),G,Te):le.el=ae.el},C=(ae,le,G,Te)=>{[ae.el,ae.anchor]=y(ae.children,le,G,Te,ae.el,ae.anchor)},E=({el:ae,anchor:le},G,Te)=>{let pe;for(;ae&&ae!==le;)pe=g(ae),i(ae,G,Te),ae=pe;i(le,G,Te)},R=({el:ae,anchor:le})=>{let G;for(;ae&&ae!==le;)G=g(ae),r(ae),ae=G;r(le)},D=(ae,le,G,Te,pe,me,ve,qe,Me)=>{le.type==="svg"?ve="svg":le.type==="math"&&(ve="mathml"),ae==null?B(le,G,Te,pe,me,ve,qe,Me):P(ae,le,pe,me,ve,qe,Me)},B=(ae,le,G,Te,pe,me,ve,qe)=>{let Me,$;const{props:z,shapeFlag:fe,transition:xe,dirs:Le}=ae;if(Me=ae.el=o(ae.type,me,z&&z.is,z),fe&8?A(Me,ae.children):fe&16&&U(ae.children,Me,null,Te,pe,o3(ae,me),ve,qe),Le&&gc(ae,null,Te,"created"),L(Me,ae,ae.scopeId,ve,Te),z){for(const ot in z)ot!=="value"&&!X0(ot)&&s(Me,ot,null,z[ot],me,Te);"value"in z&&s(Me,"value",null,z.value,me),($=z.onVnodeBeforeMount)&&Va($,Te,ae)}Le&&gc(ae,null,Te,"beforeMount");const Ne=jU(pe,xe);Ne&&xe.beforeEnter(Me),i(Me,le,G),(($=z&&z.onVnodeMounted)||Ne||Le)&&Ls(()=>{$&&Va($,Te,ae),Ne&&xe.enter(Me),Le&&gc(ae,null,Te,"mounted")},pe)},L=(ae,le,G,Te,pe)=>{if(G&&v(ae,G),Te)for(let me=0;me<Te.length;me++)v(ae,Te[me]);if(pe){let me=pe.subTree;if(le===me||vE(me.type)&&(me.ssContent===le||me.ssFallback===le)){const ve=pe.vnode;L(ae,ve,ve.scopeId,ve.slotScopeIds,pe.parent)}}},U=(ae,le,G,Te,pe,me,ve,qe,Me=0)=>{for(let $=Me;$<ae.length;$++){const z=ae[$]=qe?Fu(ae[$]):Ya(ae[$]);b(null,z,le,G,Te,pe,me,ve,qe)}},P=(ae,le,G,Te,pe,me,ve)=>{const qe=le.el=ae.el;let{patchFlag:Me,dynamicChildren:$,dirs:z}=le;Me|=ae.patchFlag&16;const fe=ae.props||Ri,xe=le.props||Ri;let Le;if(G&&_c(G,!1),(Le=xe.onVnodeBeforeUpdate)&&Va(Le,G,le,ae),z&&gc(le,ae,G,"beforeUpdate"),G&&_c(G,!0),(fe.innerHTML&&xe.innerHTML==null||fe.textContent&&xe.textContent==null)&&A(qe,""),$?F(ae.dynamicChildren,$,qe,G,Te,o3(le,pe),me):ve||ee(ae,le,qe,null,G,Te,o3(le,pe),me,!1),Me>0){if(Me&16)V(qe,fe,xe,G,pe);else if(Me&2&&fe.class!==xe.class&&s(qe,"class",null,xe.class,pe),Me&4&&s(qe,"style",fe.style,xe.style,pe),Me&8){const Ne=le.dynamicProps;for(let ot=0;ot<Ne.length;ot++){const Qe=Ne[ot],xt=fe[Qe],bt=xe[Qe];(bt!==xt||Qe==="value")&&s(qe,Qe,xt,bt,pe,G)}}Me&1&&ae.children!==le.children&&A(qe,le.children)}else!ve&&$==null&&V(qe,fe,xe,G,pe);((Le=xe.onVnodeUpdated)||z)&&Ls(()=>{Le&&Va(Le,G,le,ae),z&&gc(le,ae,G,"updated")},Te)},F=(ae,le,G,Te,pe,me,ve)=>{for(let qe=0;qe<le.length;qe++){const Me=ae[qe],$=le[qe],z=Me.el&&(Me.type===sr||!zc(Me,$)||Me.shapeFlag&70)?p(Me.el):G;b(Me,$,z,null,Te,pe,me,ve,!0)}},V=(ae,le,G,Te,pe)=>{if(le!==G){if(le!==Ri)for(const me in le)!X0(me)&&!(me in G)&&s(ae,me,le[me],null,pe,Te);for(const me in G){if(X0(me))continue;const ve=G[me],qe=le[me];ve!==qe&&me!=="value"&&s(ae,me,qe,ve,pe,Te)}"value"in G&&s(ae,"value",le.value,G.value,pe)}},H=(ae,le,G,Te,pe,me,ve,qe,Me)=>{const $=le.el=ae?ae.el:a(""),z=le.anchor=ae?ae.anchor:a("");let{patchFlag:fe,dynamicChildren:xe,slotScopeIds:Le}=le;Le&&(qe=qe?qe.concat(Le):Le),ae==null?(i($,G,Te),i(z,G,Te),U(le.children||[],G,z,pe,me,ve,qe,Me)):fe>0&&fe&64&&xe&&ae.dynamicChildren?(F(ae.dynamicChildren,xe,G,pe,me,ve,qe),(le.key!=null||pe&&le===pe.subTree)&&h4(ae,le,!0)):ee(ae,le,G,z,pe,me,ve,qe,Me)},j=(ae,le,G,Te,pe,me,ve,qe,Me)=>{le.slotScopeIds=qe,ae==null?le.shapeFlag&512?pe.ctx.activate(le,G,Te,ve,Me):J(le,G,Te,pe,me,ve,Me):Z(ae,le,Me)},J=(ae,le,G,Te,pe,me,ve)=>{const qe=ae.component=cO(ae,Te,pe);if(b2(ae)&&(qe.ctx.renderer=st),hO(qe,!1,ve),qe.asyncDep){if(pe&&pe.registerDep(qe,W,ve),!ae.el){const Me=qe.subTree=Ut(ks);S(null,Me,le,G)}}else W(qe,ae,le,G,pe,me,ve)},Z=(ae,le,G)=>{const Te=le.component=ae.component;if(nO(ae,le,G))if(Te.asyncDep&&!Te.asyncResolved){K(Te,le,G);return}else Te.next=le,Te.update();else le.el=ae.el,Te.vnode=le},W=(ae,le,G,Te,pe,me,ve)=>{const qe=()=>{if(ae.isMounted){let{next:fe,bu:xe,u:Le,parent:Ne,vnode:ot}=ae;{const At=pE(ae);if(At){fe&&(fe.el=ot.el,K(ae,fe,ve)),At.asyncDep.then(()=>{ae.isUnmounted||qe()});return}}let Qe=fe,xt;_c(ae,!1),fe?(fe.el=ot.el,K(ae,fe,ve)):fe=ot,xe&&J_(xe),(xt=fe.props&&fe.props.onVnodeBeforeUpdate)&&Va(xt,Ne,fe,ot),_c(ae,!0);const bt=$8(ae),nt=ae.subTree;ae.subTree=bt,b(nt,bt,p(nt.el),$e(nt),ae,pe,me),fe.el=bt.el,Qe===null&&iO(ae,bt.el),Le&&Ls(Le,pe),(xt=fe.props&&fe.props.onVnodeUpdated)&&Ls(()=>Va(xt,Ne,fe,ot),pe)}else{let fe;const{el:xe,props:Le}=le,{bm:Ne,m:ot,parent:Qe,root:xt,type:bt}=ae,nt=Gf(le);_c(ae,!1),Ne&&J_(Ne),!nt&&(fe=Le&&Le.onVnodeBeforeMount)&&Va(fe,Qe,le),_c(ae,!0);{xt.ce&&xt.ce._injectChildStyle(bt);const At=ae.subTree=$8(ae);b(null,At,G,Te,ae,pe,me),le.el=At.el}if(ot&&Ls(ot,pe),!nt&&(fe=Le&&Le.onVnodeMounted)){const At=le;Ls(()=>Va(fe,Qe,At),pe)}(le.shapeFlag&256||Qe&&Gf(Qe.vnode)&&Qe.vnode.shapeFlag&256)&&ae.a&&Ls(ae.a,pe),ae.isMounted=!0,le=G=Te=null}};ae.scope.on();const Me=ae.effect=new x7(qe);ae.scope.off();const $=ae.update=Me.run.bind(Me),z=ae.job=Me.runIfDirty.bind(Me);z.i=ae,z.id=ae.uid,Me.scheduler=()=>a4(z),_c(ae,!0),$()},K=(ae,le,G)=>{le.component=ae;const Te=ae.vnode.props;ae.vnode=le,ae.next=null,VU(ae,le.props,Te,G),HU(ae,le.children,G),nc(),I8(ae),ic()},ee=(ae,le,G,Te,pe,me,ve,qe,Me=!1)=>{const $=ae&&ae.children,z=ae?ae.shapeFlag:0,fe=le.children,{patchFlag:xe,shapeFlag:Le}=le;if(xe>0){if(xe&128){ge($,fe,G,Te,pe,me,ve,qe,Me);return}else if(xe&256){se($,fe,G,Te,pe,me,ve,qe,Me);return}}Le&8?(z&16&&We($,pe,me),fe!==$&&A(G,fe)):z&16?Le&16?ge($,fe,G,Te,pe,me,ve,qe,Me):We($,pe,me,!0):(z&8&&A(G,""),Le&16&&U(fe,G,Te,pe,me,ve,qe,Me))},se=(ae,le,G,Te,pe,me,ve,qe,Me)=>{ae=ae||kf,le=le||kf;const $=ae.length,z=le.length,fe=Math.min($,z);let xe;for(xe=0;xe<fe;xe++){const Le=le[xe]=Me?Fu(le[xe]):Ya(le[xe]);b(ae[xe],Le,G,null,pe,me,ve,qe,Me)}$>z?We(ae,pe,me,!0,!1,fe):U(le,G,Te,pe,me,ve,qe,Me,fe)},ge=(ae,le,G,Te,pe,me,ve,qe,Me)=>{let $=0;const z=le.length;let fe=ae.length-1,xe=z-1;for(;$<=fe&&$<=xe;){const Le=ae[$],Ne=le[$]=Me?Fu(le[$]):Ya(le[$]);if(zc(Le,Ne))b(Le,Ne,G,null,pe,me,ve,qe,Me);else break;$++}for(;$<=fe&&$<=xe;){const Le=ae[fe],Ne=le[xe]=Me?Fu(le[xe]):Ya(le[xe]);if(zc(Le,Ne))b(Le,Ne,G,null,pe,me,ve,qe,Me);else break;fe--,xe--}if($>fe){if($<=xe){const Le=xe+1,Ne=Le<z?le[Le].el:Te;for(;$<=xe;)b(null,le[$]=Me?Fu(le[$]):Ya(le[$]),G,Ne,pe,me,ve,qe,Me),$++}}else if($>xe)for(;$<=fe;)Ae(ae[$],pe,me,!0),$++;else{const Le=$,Ne=$,ot=new Map;for($=Ne;$<=xe;$++){const dt=le[$]=Me?Fu(le[$]):Ya(le[$]);dt.key!=null&&ot.set(dt.key,$)}let Qe,xt=0;const bt=xe-Ne+1;let nt=!1,At=0;const Dt=new Array(bt);for($=0;$<bt;$++)Dt[$]=0;for($=Le;$<=fe;$++){const dt=ae[$];if(xt>=bt){Ae(dt,pe,me,!0);continue}let kt;if(dt.key!=null)kt=ot.get(dt.key);else for(Qe=Ne;Qe<=xe;Qe++)if(Dt[Qe-Ne]===0&&zc(dt,le[Qe])){kt=Qe;break}kt===void 0?Ae(dt,pe,me,!0):(Dt[kt-Ne]=$+1,kt>=At?At=kt:nt=!0,b(dt,le[kt],G,null,pe,me,ve,qe,Me),xt++)}const Ot=nt?XU(Dt):kf;for(Qe=Ot.length-1,$=bt-1;$>=0;$--){const dt=Ne+$,kt=le[dt],Lt=dt+1<z?le[dt+1].el:Te;Dt[$]===0?b(null,kt,G,Lt,pe,me,ve,qe,Me):nt&&(Qe<0||$!==Ot[Qe]?de(kt,G,Lt,2):Qe--)}}},de=(ae,le,G,Te,pe=null)=>{const{el:me,type:ve,transition:qe,children:Me,shapeFlag:$}=ae;if($&6){de(ae.component.subTree,le,G,Te);return}if($&128){ae.suspense.move(le,G,Te);return}if($&64){ve.move(ae,le,G,st);return}if(ve===sr){i(me,le,G);for(let fe=0;fe<Me.length;fe++)de(Me[fe],le,G,Te);i(ae.anchor,le,G);return}if(ve===D1){E(ae,le,G);return}if(Te!==2&&$&1&&qe)if(Te===0)qe.beforeEnter(me),i(me,le,G),Ls(()=>qe.enter(me),pe);else{const{leave:fe,delayLeave:xe,afterLeave:Le}=qe,Ne=()=>i(me,le,G),ot=()=>{fe(me,()=>{Ne(),Le&&Le()})};xe?xe(me,Ne,ot):ot()}else i(me,le,G)},Ae=(ae,le,G,Te=!1,pe=!1)=>{const{type:me,props:ve,ref:qe,children:Me,dynamicChildren:$,shapeFlag:z,patchFlag:fe,dirs:xe,cacheIndex:Le}=ae;if(fe===-2&&(pe=!1),qe!=null&&ag(qe,null,G,ae,!0),Le!=null&&(le.renderCache[Le]=void 0),z&256){le.ctx.deactivate(ae);return}const Ne=z&1&&xe,ot=!Gf(ae);let Qe;if(ot&&(Qe=ve&&ve.onVnodeBeforeUnmount)&&Va(Qe,le,ae),z&6)De(ae.component,G,Te);else{if(z&128){ae.suspense.unmount(G,Te);return}Ne&&gc(ae,null,le,"beforeUnmount"),z&64?ae.type.remove(ae,le,G,st,Te):$&&!$.hasOnce&&(me!==sr||fe>0&&fe&64)?We($,le,G,!1,!0):(me===sr&&fe&384||!pe&&z&16)&&We(Me,le,G),Te&&Be(ae)}(ot&&(Qe=ve&&ve.onVnodeUnmounted)||Ne)&&Ls(()=>{Qe&&Va(Qe,le,ae),Ne&&gc(ae,null,le,"unmounted")},G)},Be=ae=>{const{type:le,el:G,anchor:Te,transition:pe}=ae;if(le===sr){ye(G,Te);return}if(le===D1){R(ae);return}const me=()=>{r(G),pe&&!pe.persisted&&pe.afterLeave&&pe.afterLeave()};if(ae.shapeFlag&1&&pe&&!pe.persisted){const{leave:ve,delayLeave:qe}=pe,Me=()=>ve(G,me);qe?qe(ae.el,me,Me):Me()}else me()},ye=(ae,le)=>{let G;for(;ae!==le;)G=g(ae),r(ae),ae=G;r(le)},De=(ae,le,G)=>{const{bum:Te,scope:pe,job:me,subTree:ve,um:qe,m:Me,a:$}=ae;W8(Me),W8($),Te&&J_(Te),pe.stop(),me&&(me.flags|=8,Ae(ve,ae,le,G)),qe&&Ls(qe,le),Ls(()=>{ae.isUnmounted=!0},le),le&&le.pendingBranch&&!le.isUnmounted&&ae.asyncDep&&!ae.asyncResolved&&ae.suspenseId===le.pendingId&&(le.deps--,le.deps===0&&le.resolve())},We=(ae,le,G,Te=!1,pe=!1,me=0)=>{for(let ve=me;ve<ae.length;ve++)Ae(ae[ve],le,G,Te,pe)},$e=ae=>{if(ae.shapeFlag&6)return $e(ae.component.subTree);if(ae.shapeFlag&128)return ae.suspense.next();const le=g(ae.anchor||ae.el),G=le&&le[G7];return G?g(G):le};let Ke=!1;const Xe=(ae,le,G)=>{ae==null?le._vnode&&Ae(le._vnode,null,null,!0):b(le._vnode||null,ae,le,null,null,null,G),le._vnode=ae,Ke||(Ke=!0,I8(),V7(),Ke=!1)},st={p:b,um:Ae,m:de,r:Be,mt:J,mc:U,pc:ee,pbc:F,n:$e,o:n};return{render:Xe,hydrate:void 0,createApp:OU(Xe)}}function o3({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function _c({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function jU(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function h4(n,e,t=!1){const i=n.children,r=e.children;if(mn(i)&&mn(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=Fu(r[s]),a.el=o.el),!t&&a.patchFlag!==-2&&h4(o,a)),a.type===dp&&(a.el=o.el)}}function XU(n){const e=n.slice(),t=[0];let i,r,s,o,a;const l=n.length;for(i=0;i<l;i++){const u=n[i];if(u!==0){if(r=t[t.length-1],n[r]<u){e[i]=r,t.push(i);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,n[t[a]]<u?s=a+1:o=a;u<n[t[s]]&&(s>0&&(e[i]=t[s-1]),t[s]=i)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function pE(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:pE(e)}function W8(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const QU=Symbol.for("v-scx"),YU=()=>Wf(QU);function qs(n,e,t){return mE(n,e,t)}function mE(n,e,t=Ri){const{immediate:i,deep:r,flush:s,once:o}=t,a=Wr({},t),l=e&&i||!e&&s!=="post";let u;if(yd){if(s==="sync"){const v=YU();u=v.__watcherHandles||(v.__watcherHandles=[])}else if(!l){const v=()=>{};return v.stop=rl,v.resume=rl,v.pause=rl,v}}const A=ns;a.call=(v,y,b)=>Na(v,A,y,b);let p=!1;s==="post"?a.scheduler=v=>{Ls(v,A&&A.suspense)}:s!=="sync"&&(p=!0,a.scheduler=(v,y)=>{y?v():a4(v)}),a.augmentJob=v=>{e&&(v.flags|=4),p&&(v.flags|=2,A&&(v.id=A.uid,v.i=A))};const g=uU(n,e,a);return yd&&(u?u.push(g):l&&g()),g}function ZU(n,e,t){const i=this.proxy,r=cr(n)?n.includes(".")?gE(i,n):()=>i[n]:n.bind(i,i);let s;Pn(e)?s=e:(s=e.handler,t=e);const o=pp(this),a=mE(r,s.bind(i),t);return o(),a}function gE(n,e){const t=e.split(".");return()=>{let i=n;for(let r=0;r<t.length&&i;r++)i=i[t[r]];return i}}const KU=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${ra(e)}Modifiers`]||n[`${Th(e)}Modifiers`];function JU(n,e,...t){if(n.isUnmounted)return;const i=n.vnode.props||Ri;let r=t;const s=e.startsWith("update:"),o=s&&KU(i,e.slice(7));o&&(o.trim&&(r=t.map(A=>cr(A)?A.trim():A)),o.number&&(r=t.map(SF)));let a,l=i[a=K_(e)]||i[a=K_(ra(e))];!l&&s&&(l=i[a=K_(Th(e))]),l&&Na(l,n,6,r);const u=i[a+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Na(u,n,6,r)}}function _E(n,e,t=!1){const i=e.emitsCache,r=i.get(n);if(r!==void 0)return r;const s=n.emits;let o={},a=!1;if(!Pn(n)){const l=u=>{const A=_E(u,e,!0);A&&(a=!0,Wr(o,A))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!s&&!a?(Hi(n)&&i.set(n,null),null):(mn(s)?s.forEach(l=>o[l]=null):Wr(o,s),Hi(n)&&i.set(n,o),o)}function S2(n,e){return!n||!p2(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ai(n,e[0].toLowerCase()+e.slice(1))||Ai(n,Th(e))||Ai(n,e))}function $8(n){const{type:e,vnode:t,proxy:i,withProxy:r,propsOptions:[s],slots:o,attrs:a,emit:l,render:u,renderCache:A,props:p,data:g,setupState:v,ctx:y,inheritAttrs:b}=n,w=og(n);let S,C;try{if(t.shapeFlag&4){const R=r||i,D=R;S=Ya(u.call(D,R,A,p,v,g,y)),C=a}else{const R=e;S=Ya(R.length>1?R(p,{attrs:a,slots:o,emit:l}):R(p,null)),C=e.props?a:eO(a)}}catch(R){J0.length=0,x2(R,n,1),S=Ut(ks)}let E=S;if(C&&b!==!1){const R=Object.keys(C),{shapeFlag:D}=E;R.length&&D&7&&(s&&R.some(Zx)&&(C=tO(C,s)),E=Ku(E,C,!1,!0))}return t.dirs&&(E=Ku(E,null,!1,!0),E.dirs=E.dirs?E.dirs.concat(t.dirs):t.dirs),t.transition&&gd(E,t.transition),S=E,og(w),S}const eO=n=>{let e;for(const t in n)(t==="class"||t==="style"||p2(t))&&((e||(e={}))[t]=n[t]);return e},tO=(n,e)=>{const t={};for(const i in n)(!Zx(i)||!(i.slice(9)in e))&&(t[i]=n[i]);return t};function nO(n,e,t){const{props:i,children:r,component:s}=n,{props:o,children:a,patchFlag:l}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return i?j8(i,o,u):!!o;if(l&8){const A=e.dynamicProps;for(let p=0;p<A.length;p++){const g=A[p];if(o[g]!==i[g]&&!S2(u,g))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?j8(i,o,u):!0:!!o;return!1}function j8(n,e,t){const i=Object.keys(e);if(i.length!==Object.keys(n).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==n[s]&&!S2(t,s))return!0}return!1}function iO({vnode:n,parent:e},t){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===n&&(i.el=n.el),i===n)(n=e.vnode).el=t,e=e.parent;else break}}const vE=n=>n.__isSuspense;function rO(n,e){e&&e.pendingBranch?mn(n)?e.effects.push(...n):e.effects.push(n):fU(n)}const sr=Symbol.for("v-fgt"),dp=Symbol.for("v-txt"),ks=Symbol.for("v-cmt"),D1=Symbol.for("v-stc"),J0=[];let Lo=null;function yt(n=!1){J0.push(Lo=n?null:[])}function sO(){J0.pop(),Lo=J0[J0.length-1]||null}let _d=1;function X8(n,e=!1){_d+=n,n<0&&Lo&&e&&(Lo.hasOnce=!0)}function yE(n){return n.dynamicChildren=_d>0?Lo||kf:null,sO(),_d>0&&Lo&&Lo.push(n),n}function Rt(n,e,t,i,r,s){return yE(Ee(n,e,t,i,r,s,!0))}function fl(n,e,t,i,r){return yE(Ut(n,e,t,i,r,!0))}function vd(n){return n?n.__v_isVNode===!0:!1}function zc(n,e){return n.type===e.type&&n.key===e.key}const xE=({key:n})=>n??null,I1=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?cr(n)||is(n)||Pn(n)?{i:Gr,r:n,k:e,f:!!t}:n:null);function Ee(n,e=null,t=null,i=0,r=null,s=n===sr?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&xE(e),ref:e&&I1(e),scopeId:q7,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Gr};return a?(f4(l,t),s&128&&n.normalize(l)):t&&(l.shapeFlag|=cr(t)?8:16),_d>0&&!o&&Lo&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Lo.push(l),l}const Ut=oO;function oO(n,e=null,t=null,i=0,r=null,s=!1){if((!n||n===RU)&&(n=ks),vd(n)){const a=Ku(n,e,!0);return t&&f4(a,t),_d>0&&!s&&Lo&&(a.shapeFlag&6?Lo[Lo.indexOf(n)]=a:Lo.push(a)),a.patchFlag=-2,a}if(mO(n)&&(n=n.__vccOpts),e){e=aO(e);let{class:a,style:l}=e;a&&!cr(a)&&(e.class=Os(a)),Hi(l)&&(o4(l)&&!mn(l)&&(l=Wr({},l)),e.style=hl(l))}const o=cr(n)?1:vE(n)?128:H7(n)?64:Hi(n)?4:Pn(n)?2:0;return Ee(n,e,t,i,r,o,s,!0)}function aO(n){return n?o4(n)||lE(n)?Wr({},n):n:null}function Ku(n,e,t=!1,i=!1){const{props:r,ref:s,patchFlag:o,children:a,transition:l}=n,u=e?B1(r||{},e):r,A={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&xE(u),ref:e&&e.ref?t&&s?mn(s)?s.concat(I1(e)):[s,I1(e)]:I1(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==sr?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Ku(n.ssContent),ssFallback:n.ssFallback&&Ku(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&i&&gd(A,l.clone(A)),A}function Zs(n=" ",e=0){return Ut(dp,null,n,e)}function w2(n,e){const t=Ut(D1,null,n);return t.staticCount=e,t}function wr(n="",e=!1){return e?(yt(),fl(ks,null,n)):Ut(ks,null,n)}function Ya(n){return n==null||typeof n=="boolean"?Ut(ks):mn(n)?Ut(sr,null,n.slice()):vd(n)?Fu(n):Ut(dp,null,String(n))}function Fu(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Ku(n)}function f4(n,e){let t=0;const{shapeFlag:i}=n;if(e==null)e=null;else if(mn(e))t=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),f4(n,r()),r._c&&(r._d=!0));return}else{t=32;const r=e._;!r&&!lE(e)?e._ctx=Gr:r===3&&Gr&&(Gr.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Pn(e)?(e={default:e,_ctx:Gr},t=32):(e=String(e),i&64?(t=16,e=[Zs(e)]):t=8);n.children=e,n.shapeFlag|=t}function B1(...n){const e={};for(let t=0;t<n.length;t++){const i=n[t];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=Os([e.class,i.class]));else if(r==="style")e.style=hl([e.style,i.style]);else if(p2(r)){const s=e[r],o=i[r];o&&s!==o&&!(mn(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function Va(n,e,t,i=null){Na(n,e,7,[t,i])}const lO=sE();let uO=0;function cO(n,e,t){const i=n.type,r=(e?e.appContext:n.appContext)||lO,s={uid:uO++,vnode:n,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new LF(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:cE(i,r),emitsOptions:_E(i,r),emit:null,emitted:null,propsDefaults:Ri,inheritAttrs:i.inheritAttrs,ctx:Ri,data:Ri,props:Ri,attrs:Ri,slots:Ri,refs:Ri,setupState:Ri,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=JU.bind(null,s),n.ce&&n.ce(s),s}let ns=null;const bE=()=>ns||Gr;let cg,Ty;{const n=v2(),e=(t,i)=>{let r;return(r=n[t])||(r=n[t]=[]),r.push(i),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};cg=e("__VUE_INSTANCE_SETTERS__",t=>ns=t),Ty=e("__VUE_SSR_SETTERS__",t=>yd=t)}const pp=n=>{const e=ns;return cg(n),n.scope.on(),()=>{n.scope.off(),cg(e)}},Q8=()=>{ns&&ns.scope.off(),cg(null)};function TE(n){return n.vnode.shapeFlag&4}let yd=!1;function hO(n,e=!1,t=!1){e&&Ty(e);const{props:i,children:r}=n.vnode,s=TE(n);kU(n,i,s,e),GU(n,r,t);const o=s?fO(n,e):void 0;return e&&Ty(!1),o}function fO(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,PU);const{setup:i}=t;if(i){nc();const r=n.setupContext=i.length>1?dO(n):null,s=pp(n),o=Ap(i,n,0,[n.props,r]),a=A7(o);if(ic(),s(),(a||n.sp)&&!Gf(n)&&K7(n),a){if(o.then(Q8,Q8),e)return o.then(l=>{Y8(n,l)}).catch(l=>{x2(l,n,0)});n.asyncDep=o}else Y8(n,o)}else SE(n)}function Y8(n,e,t){Pn(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Hi(e)&&(n.setupState=F7(e)),SE(n)}function SE(n,e,t){const i=n.type;n.render||(n.render=i.render||rl);{const r=pp(n);nc();try{LU(n)}finally{ic(),r()}}}const AO={get(n,e){return ps(n,"get",""),n[e]}};function dO(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,AO),slots:n.slots,emit:n.emit,expose:e}}function M2(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(F7(eU(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in K0)return K0[t](n)},has(e,t){return t in e||t in K0}})):n.proxy}function pO(n,e=!0){return Pn(n)?n.displayName||n.name:n.name||e&&n.__name}function mO(n){return Pn(n)&&"__vccOpts"in n}const eo=(n,e)=>aU(n,e,yd);function Za(n,e,t){const i=arguments.length;return i===2?Hi(e)&&!mn(e)?vd(e)?Ut(n,null,[e]):Ut(n,e):Ut(n,null,e):(i>3?t=Array.prototype.slice.call(arguments,2):i===3&&vd(t)&&(t=[t]),Ut(n,e,t))}const gO="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Sy;const Z8=typeof window<"u"&&window.trustedTypes;if(Z8)try{Sy=Z8.createPolicy("vue",{createHTML:n=>n})}catch{}const wE=Sy?n=>Sy.createHTML(n):n=>n,_O="http://www.w3.org/2000/svg",vO="http://www.w3.org/1998/Math/MathML",Fl=typeof document<"u"?document:null,K8=Fl&&Fl.createElement("template"),yO={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,i)=>{const r=e==="svg"?Fl.createElementNS(_O,n):e==="mathml"?Fl.createElementNS(vO,n):t?Fl.createElement(n,{is:t}):Fl.createElement(n);return n==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:n=>Fl.createTextNode(n),createComment:n=>Fl.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Fl.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,i,r,s){const o=t?t.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),t),!(r===s||!(r=r.nextSibling)););else{K8.innerHTML=wE(i==="svg"?`<svg>${n}</svg>`:i==="mathml"?`<math>${n}</math>`:n);const a=K8.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},vu="transition",n0="animation",xd=Symbol("_vtc"),ME={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},xO=Wr({},j7,ME),bO=n=>(n.displayName="Transition",n.props=xO,n),hg=bO((n,{slots:e})=>Za(gU,TO(n),e)),vc=(n,e=[])=>{mn(n)?n.forEach(t=>t(...e)):n&&n(...e)},J8=n=>n?mn(n)?n.some(e=>e.length>1):n.length>1:!1;function TO(n){const e={};for(const H in n)H in ME||(e[H]=n[H]);if(n.css===!1)return e;const{name:t="v",type:i,duration:r,enterFromClass:s=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:u=o,appearToClass:A=a,leaveFromClass:p=`${t}-leave-from`,leaveActiveClass:g=`${t}-leave-active`,leaveToClass:v=`${t}-leave-to`}=n,y=SO(r),b=y&&y[0],w=y&&y[1],{onBeforeEnter:S,onEnter:C,onEnterCancelled:E,onLeave:R,onLeaveCancelled:D,onBeforeAppear:B=S,onAppear:L=C,onAppearCancelled:U=E}=e,P=(H,j,J,Z)=>{H._enterCancelled=Z,yc(H,j?A:a),yc(H,j?u:o),J&&J()},F=(H,j)=>{H._isLeaving=!1,yc(H,p),yc(H,v),yc(H,g),j&&j()},V=H=>(j,J)=>{const Z=H?L:C,W=()=>P(j,H,J);vc(Z,[j,W]),e6(()=>{yc(j,H?l:s),Cl(j,H?A:a),J8(Z)||t6(j,i,b,W)})};return Wr(e,{onBeforeEnter(H){vc(S,[H]),Cl(H,s),Cl(H,o)},onBeforeAppear(H){vc(B,[H]),Cl(H,l),Cl(H,u)},onEnter:V(!1),onAppear:V(!0),onLeave(H,j){H._isLeaving=!0;const J=()=>F(H,j);Cl(H,p),H._enterCancelled?(Cl(H,g),r6()):(r6(),Cl(H,g)),e6(()=>{H._isLeaving&&(yc(H,p),Cl(H,v),J8(R)||t6(H,i,w,J))}),vc(R,[H,J])},onEnterCancelled(H){P(H,!1,void 0,!0),vc(E,[H])},onAppearCancelled(H){P(H,!0,void 0,!0),vc(U,[H])},onLeaveCancelled(H){F(H),vc(D,[H])}})}function SO(n){if(n==null)return null;if(Hi(n))return[a3(n.enter),a3(n.leave)];{const e=a3(n);return[e,e]}}function a3(n){return wF(n)}function Cl(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[xd]||(n[xd]=new Set)).add(e)}function yc(n,e){e.split(/\s+/).forEach(i=>i&&n.classList.remove(i));const t=n[xd];t&&(t.delete(e),t.size||(n[xd]=void 0))}function e6(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let wO=0;function t6(n,e,t,i){const r=n._endId=++wO,s=()=>{r===n._endId&&i()};if(t!=null)return setTimeout(s,t);const{type:o,timeout:a,propCount:l}=MO(n,e);if(!o)return i();const u=o+"end";let A=0;const p=()=>{n.removeEventListener(u,g),s()},g=v=>{v.target===n&&++A>=l&&p()};setTimeout(()=>{A<l&&p()},a+1),n.addEventListener(u,g)}function MO(n,e){const t=window.getComputedStyle(n),i=y=>(t[y]||"").split(", "),r=i(`${vu}Delay`),s=i(`${vu}Duration`),o=n6(r,s),a=i(`${n0}Delay`),l=i(`${n0}Duration`),u=n6(a,l);let A=null,p=0,g=0;e===vu?o>0&&(A=vu,p=o,g=s.length):e===n0?u>0&&(A=n0,p=u,g=l.length):(p=Math.max(o,u),A=p>0?o>u?vu:n0:null,g=A?A===vu?s.length:l.length:0);const v=A===vu&&/\b(transform|all)(,|$)/.test(i(`${vu}Property`).toString());return{type:A,timeout:p,propCount:g,hasTransform:v}}function n6(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,i)=>i6(t)+i6(n[i])))}function i6(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function r6(){return document.body.offsetHeight}function EO(n,e,t){const i=n[xd];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const fg=Symbol("_vod"),EE=Symbol("_vsh"),wy={beforeMount(n,{value:e},{transition:t}){n[fg]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):i0(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:i}){!e!=!t&&(i?e?(i.beforeEnter(n),i0(n,!0),i.enter(n)):i.leave(n,()=>{i0(n,!1)}):i0(n,e))},beforeUnmount(n,{value:e}){i0(n,e)}};function i0(n,e){n.style.display=e?n[fg]:"none",n[EE]=!e}const CO=Symbol(""),RO=/(^|;)\s*display\s*:/;function NO(n,e,t){const i=n.style,r=cr(t);let s=!1;if(t&&!r){if(e)if(cr(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&F1(i,a,"")}else for(const o in e)t[o]==null&&F1(i,o,"");for(const o in t)o==="display"&&(s=!0),F1(i,o,t[o])}else if(r){if(e!==t){const o=i[CO];o&&(t+=";"+o),i.cssText=t,s=RO.test(t)}}else e&&n.removeAttribute("style");fg in n&&(n[fg]=s?i.display:"",n[EE]&&(i.display="none"))}const s6=/\s*!important$/;function F1(n,e,t){if(mn(t))t.forEach(i=>F1(n,e,i));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const i=PO(n,e);s6.test(t)?n.setProperty(Th(i),t.replace(s6,""),"important"):n[i]=t}}const o6=["Webkit","Moz","ms"],l3={};function PO(n,e){const t=l3[e];if(t)return t;let i=ra(e);if(i!=="filter"&&i in n)return l3[e]=i;i=_2(i);for(let r=0;r<o6.length;r++){const s=o6[r]+i;if(s in n)return l3[e]=s}return e}const a6="http://www.w3.org/1999/xlink";function l6(n,e,t,i,r,s=PF(e)){i&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(a6,e.slice(6,e.length)):n.setAttributeNS(a6,e,t):t==null||s&&!g7(t)?n.removeAttribute(e):n.setAttribute(e,s?"":cu(t)?String(t):t)}function u6(n,e,t,i,r){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?wE(t):t);return}const s=n.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const a=s==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=g7(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(r||e)}function LO(n,e,t,i){n.addEventListener(e,t,i)}function DO(n,e,t,i){n.removeEventListener(e,t,i)}const c6=Symbol("_vei");function IO(n,e,t,i,r=null){const s=n[c6]||(n[c6]={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=BO(e);if(i){const u=s[e]=OO(i,r);LO(n,a,u,l)}else o&&(DO(n,a,o,l),s[e]=void 0)}}const h6=/(?:Once|Passive|Capture)$/;function BO(n){let e;if(h6.test(n)){e={};let i;for(;i=n.match(h6);)n=n.slice(0,n.length-i[0].length),e[i[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Th(n.slice(2)),e]}let u3=0;const FO=Promise.resolve(),UO=()=>u3||(FO.then(()=>u3=0),u3=Date.now());function OO(n,e){const t=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=t.attached)return;Na(kO(i,t.value),e,5,[i])};return t.value=n,t.attached=UO(),t}function kO(n,e){if(mn(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const f6=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,VO=(n,e,t,i,r,s)=>{const o=r==="svg";e==="class"?EO(n,i,o):e==="style"?NO(n,t,i):p2(e)?Zx(e)||IO(n,e,t,i,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):zO(n,e,i,o))?(u6(n,e,i),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&l6(n,e,i,o,s,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!cr(i))?u6(n,ra(e),i,s,e):(e==="true-value"?n._trueValue=i:e==="false-value"&&(n._falseValue=i),l6(n,e,i,o))};function zO(n,e,t,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in n&&f6(e)&&Pn(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=n.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return f6(e)&&cr(t)?!1:e in n}const qO=["ctrl","shift","alt","meta"],GO={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>qO.some(t=>n[`${t}Key`]&&!e.includes(t))},CE=(n,e)=>{const t=n._withMods||(n._withMods={}),i=e.join(".");return t[i]||(t[i]=(r,...s)=>{for(let o=0;o<e.length;o++){const a=GO[e[o]];if(a&&a(r,e))return}return n(r,...s)})},HO=Wr({patchProp:VO},yO);let A6;function WO(){return A6||(A6=WU(HO))}const $O=(...n)=>{const e=WO().createApp(...n),{mount:t}=e;return e.mount=i=>{const r=XO(i);if(!r)return;const s=e._component;!Pn(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=t(r,!1,jO(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function jO(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function XO(n){return cr(n)?document.querySelector(n):n}var d6;const RE=typeof window<"u",QO=n=>typeof n=="string",ed=()=>{};RE&&((d6=window==null?void 0:window.navigator)!=null&&d6.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function NE(n,e){function t(...i){n(()=>e.apply(this,i),{fn:e,thisArg:this,args:i})}return t}function YO(n,e={}){let t,i;return s=>{const o=Ze(n),a=Ze(e.maxWait);if(t&&clearTimeout(t),o<=0||a!==void 0&&a<=0)return i&&(clearTimeout(i),i=null),s();a&&!i&&(i=setTimeout(()=>{t&&clearTimeout(t),i=null,s()},a)),t=setTimeout(()=>{i&&clearTimeout(i),i=null,s()},o)}}function ZO(n,e=!0,t=!0){let i=0,r,s=!0;const o=()=>{r&&(clearTimeout(r),r=void 0)};return l=>{const u=Ze(n),A=Date.now()-i;if(o(),u<=0)return i=Date.now(),l();A>u&&(t||!s)?(i=Date.now(),l()):e&&(r=setTimeout(()=>{i=Date.now(),s=!0,o(),l()},u)),!t&&!r&&(r=setTimeout(()=>s=!0,u)),s=!1}}function PE(n){return y7()?(DF(n),!0):!1}function KO(n,e=200,t={}){return NE(YO(e,t),n)}function JO(n,e=200,t=!0,i=!0){return NE(ZO(e,t,i),n)}function LE(n,e=!0){bE()?fu(n):e?n():O7(n)}function Ag(n){var e;const t=Ze(n);return(e=t==null?void 0:t.$el)!=null?e:t}const A4=RE?window:void 0;function nA(...n){let e,t,i,r;if(QO(n[0])?([t,i,r]=n,e=A4):[e,t,i,r]=n,!e)return ed;let s=ed;const o=qs(()=>Ag(e),l=>{s(),l&&(l.addEventListener(t,i,r),s=()=>{l.removeEventListener(t,i,r),s=ed})},{immediate:!0,flush:"post"}),a=()=>{o(),s()};return PE(a),a}const p6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m6="__vueuse_ssr_handlers__";p6[m6]=p6[m6]||{};var g6=Object.getOwnPropertySymbols,ek=Object.prototype.hasOwnProperty,tk=Object.prototype.propertyIsEnumerable,nk=(n,e)=>{var t={};for(var i in n)ek.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&g6)for(var i of g6(n))e.indexOf(i)<0&&tk.call(n,i)&&(t[i]=n[i]);return t};function ik(n,e,t={}){const i=t,{window:r=A4}=i,s=nk(i,["window"]);let o;const a=r&&"ResizeObserver"in r,l=()=>{o&&(o.disconnect(),o=void 0)},u=qs(()=>Ag(n),p=>{l(),a&&r&&p&&(o=new ResizeObserver(e),o.observe(p,s))},{immediate:!0,flush:"post"}),A=()=>{l(),u()};return PE(A),{isSupported:a,stop:A}}function DE(n,e={}){const{reset:t=!0,windowResize:i=!0,windowScroll:r=!0,immediate:s=!0}=e,o=Fi(0),a=Fi(0),l=Fi(0),u=Fi(0),A=Fi(0),p=Fi(0),g=Fi(0),v=Fi(0);function y(){const b=Ag(n);if(!b){t&&(o.value=0,a.value=0,l.value=0,u.value=0,A.value=0,p.value=0,g.value=0,v.value=0);return}const w=b.getBoundingClientRect();o.value=w.height,a.value=w.bottom,l.value=w.left,u.value=w.right,A.value=w.top,p.value=w.width,g.value=w.x,v.value=w.y}return ik(n,y),qs(()=>Ag(n),b=>!b&&y()),r&&nA("scroll",y,{passive:!0}),i&&nA("resize",y,{passive:!0}),LE(()=>{s&&y()}),{height:o,bottom:a,left:l,right:u,top:A,width:p,x:g,y:v,update:y}}function E2(n,e={}){const{throttle:t=0,idle:i=200,onStop:r=ed,onScroll:s=ed,offset:o={left:0,right:0,top:0,bottom:0},eventListenerOptions:a={capture:!1,passive:!0}}=e,l=Fi(0),u=Fi(0),A=Fi(!1),p=Zu({left:!0,right:!1,top:!0,bottom:!1}),g=Zu({left:!1,right:!1,top:!1,bottom:!1});if(n){const v=KO(b=>{A.value=!1,g.left=!1,g.right=!1,g.top=!1,g.bottom=!1,r(b)},t+i),y=b=>{const w=b.target===document?b.target.documentElement:b.target,S=w.scrollLeft;g.left=S<l.value,g.right=S>l.value,p.left=S<=0+(o.left||0),p.right=S+w.clientWidth>=w.scrollWidth-(o.right||0),l.value=S;let C=w.scrollTop;b.target===document&&!C&&(C=document.body.scrollTop),g.top=C<u.value,g.bottom=C>u.value,p.top=C<=0+(o.top||0),p.bottom=C+w.clientHeight>=w.scrollHeight-(o.bottom||0),u.value=C,A.value=!0,v(b),s(b)};nA(n,"scroll",t?JO(y,t):y,a)}return{x:l,y:u,isScrolling:A,arrivedState:p,directions:g}}var _6;(function(n){n.UP="UP",n.RIGHT="RIGHT",n.DOWN="DOWN",n.LEFT="LEFT",n.NONE="NONE"})(_6||(_6={}));function IE(n={}){const{window:e=A4,initialWidth:t=1/0,initialHeight:i=1/0,listenOrientation:r=!0}=n,s=Fi(t),o=Fi(i),a=()=>{e&&(s.value=e.innerWidth,o.value=e.innerHeight)};return a(),LE(a),nA("resize",a,{passive:!0}),r&&nA("orientationchange",a,{passive:!0}),{width:s,height:o}}function v6(n){return n!==null&&typeof n=="object"&&"constructor"in n&&n.constructor===Object}function d4(n={},e={}){Object.keys(e).forEach(t=>{typeof n[t]>"u"?n[t]=e[t]:v6(e[t])&&v6(n[t])&&Object.keys(e[t]).length>0&&d4(n[t],e[t])})}const BE={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function mp(){const n=typeof document<"u"?document:{};return d4(n,BE),n}const rk={document:BE,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(n){return typeof setTimeout>"u"?(n(),null):setTimeout(n,0)},cancelAnimationFrame(n){typeof setTimeout>"u"||clearTimeout(n)}};function UA(){const n=typeof window<"u"?window:{};return d4(n,rk),n}let _o;const FE=()=>{if(_o)return D8(_o);const n=s=>_o.hash=s,e=()=>_o.isShown=!_o.isDisabled&&!0,t=()=>_o.isShown=!_o.isDisabled&&!1,i=()=>_o.isDisabled=!1,r=()=>_o.isDisabled=!0;return _o=Zu({hash:mp().location.hash,setHash:n,isScrolling:!1,isShown:!1,isDisabled:!1,show:e,hide:t,enable:i,disable:r}),fu(()=>{_o.hash=document.location.hash}),nA("hashchange",()=>_o.hash=document.location.hash),D8(_o)},sk={class:"nmd-navigation nmd-navigation--side"},ok=Ct({});({...ok});function UE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var U1={exports:{}};/*!
  * vue-scrollto v2.20.0
  * (c) 2019 Randjelovic Igor
  * @license MIT
  */var ak=U1.exports,y6;function lk(){return y6||(y6=1,function(n,e){(function(t,i){n.exports=i()})(ak,function(){function t(de){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(Ae){return typeof Ae}:t=function(Ae){return Ae&&typeof Symbol=="function"&&Ae.constructor===Symbol&&Ae!==Symbol.prototype?"symbol":typeof Ae},t(de)}function i(){return i=Object.assign||function(de){for(var Ae=1;Ae<arguments.length;Ae++){var Be=arguments[Ae];for(var ye in Be)Object.prototype.hasOwnProperty.call(Be,ye)&&(de[ye]=Be[ye])}return de},i.apply(this,arguments)}var r=4,s=.001,o=1e-7,a=10,l=11,u=1/(l-1),A=typeof Float32Array=="function";function p(de,Ae){return 1-3*Ae+3*de}function g(de,Ae){return 3*Ae-6*de}function v(de){return 3*de}function y(de,Ae,Be){return((p(Ae,Be)*de+g(Ae,Be))*de+v(Ae))*de}function b(de,Ae,Be){return 3*p(Ae,Be)*de*de+2*g(Ae,Be)*de+v(Ae)}function w(de,Ae,Be,ye,De){var We,$e,Ke=0;do $e=Ae+(Be-Ae)/2,We=y($e,ye,De)-de,We>0?Be=$e:Ae=$e;while(Math.abs(We)>o&&++Ke<a);return $e}function S(de,Ae,Be,ye){for(var De=0;De<r;++De){var We=b(Ae,Be,ye);if(We===0)return Ae;var $e=y(Ae,Be,ye)-de;Ae-=$e/We}return Ae}function C(de){return de}var E=function(Ae,Be,ye,De){if(!(0<=Ae&&Ae<=1&&0<=ye&&ye<=1))throw new Error("bezier x values must be in [0, 1] range");if(Ae===Be&&ye===De)return C;for(var We=A?new Float32Array(l):new Array(l),$e=0;$e<l;++$e)We[$e]=y($e*u,Ae,ye);function Ke(Xe){for(var st=0,gt=1,ae=l-1;gt!==ae&&We[gt]<=Xe;++gt)st+=u;--gt;var le=(Xe-We[gt])/(We[gt+1]-We[gt]),G=st+le*u,Te=b(G,Ae,ye);return Te>=s?S(Xe,G,Ae,ye):Te===0?G:w(Xe,st,st+u,Ae,ye)}return function(st){return st===0?0:st===1?1:y(Ke(st),Be,De)}},R={ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},D=!1;try{var B=Object.defineProperty({},"passive",{get:function(){D=!0}});window.addEventListener("test",null,B)}catch{}var L={$:function(Ae){return typeof Ae!="string"?Ae:document.querySelector(Ae)},on:function(Ae,Be,ye){var De=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{passive:!1};Be instanceof Array||(Be=[Be]);for(var We=0;We<Be.length;We++)Ae.addEventListener(Be[We],ye,D?De:!1)},off:function(Ae,Be,ye){Be instanceof Array||(Be=[Be]);for(var De=0;De<Be.length;De++)Ae.removeEventListener(Be[De],ye)},cumulativeOffset:function(Ae){var Be=0,ye=0;do Be+=Ae.offsetTop||0,ye+=Ae.offsetLeft||0,Ae=Ae.offsetParent;while(Ae);return{top:Be,left:ye}}},U=["mousedown","wheel","DOMMouseScroll","mousewheel","keyup","touchmove"],P={container:"body",duration:500,lazy:!0,easing:"ease",offset:0,force:!0,cancelable:!0,onStart:!1,onDone:!1,onCancel:!1,x:!1,y:!0};function F(de){P=i({},P,de)}var V=function(){var Ae,Be,ye,De,We,$e,Ke,Xe,st,gt,ae,le,G,Te,pe,me,ve,qe,Me,$,z,fe,xe,Le=function($t){Xe&&(xe=$t,$=!0)},Ne,ot,Qe,xt;function bt(Lt){var $t=Lt.scrollTop;return Lt.tagName.toLowerCase()==="body"&&($t=$t||document.documentElement.scrollTop),$t}function nt(Lt){var $t=Lt.scrollLeft;return Lt.tagName.toLowerCase()==="body"&&($t=$t||document.documentElement.scrollLeft),$t}function At(){z=L.cumulativeOffset(Be),fe=L.cumulativeOffset(Ae),le&&(pe=fe.left-z.left+$e,qe=pe-Te),G&&(ve=fe.top-z.top+$e,Me=ve-me)}function Dt(Lt){if($)return Ot();ot||(ot=Lt),We||At(),Qe=Lt-ot,xt=Math.min(Qe/ye,1),xt=Ne(xt),dt(Be,me+Me*xt,Te+qe*xt),Qe<ye?window.requestAnimationFrame(Dt):Ot()}function Ot(){$||dt(Be,ve,pe),ot=!1,L.off(Be,U,Le),$&&ae&&ae(xe,Ae),!$&&gt&&gt(Ae)}function dt(Lt,$t,ie){G&&(Lt.scrollTop=$t),le&&(Lt.scrollLeft=ie),Lt.tagName.toLowerCase()==="body"&&(G&&(document.documentElement.scrollTop=$t),le&&(document.documentElement.scrollLeft=ie))}function kt(Lt,$t){var ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(t($t)==="object"?ie=$t:typeof $t=="number"&&(ie.duration=$t),Ae=L.$(Lt),!Ae)return console.warn("[vue-scrollto warn]: Trying to scroll to an element that is not on the page: "+Lt);if(Be=L.$(ie.container||P.container),ye=ie.hasOwnProperty("duration")?ie.duration:P.duration,We=ie.hasOwnProperty("lazy")?ie.lazy:P.lazy,De=ie.easing||P.easing,$e=ie.hasOwnProperty("offset")?ie.offset:P.offset,Ke=ie.hasOwnProperty("force")?ie.force!==!1:P.force,Xe=ie.hasOwnProperty("cancelable")?ie.cancelable!==!1:P.cancelable,st=ie.onStart||P.onStart,gt=ie.onDone||P.onDone,ae=ie.onCancel||P.onCancel,le=ie.x===void 0?P.x:ie.x,G=ie.y===void 0?P.y:ie.y,typeof $e=="function"&&($e=$e(Ae,Be)),Te=nt(Be),me=bt(Be),At(),$=!1,!Ke){var Mt=Be.tagName.toLowerCase()==="body"?document.documentElement.clientHeight||window.innerHeight:Be.offsetHeight,je=me,q=je+Mt,Pt=ve-$e,wt=Pt+Ae.offsetHeight;if(Pt>=je&&wt<=q){gt&&gt(Ae);return}}if(st&&st(Ae),!Me&&!qe){gt&&gt(Ae);return}return typeof De=="string"&&(De=R[De]||R.ease),Ne=E.apply(E,De),L.on(Be,U,Le,{passive:!0}),window.requestAnimationFrame(Dt),function(){xe=null,$=!0}}return kt},H=V(),j=[];function J(de){for(var Ae=0;Ae<j.length;++Ae)if(j[Ae].el===de)return j.splice(Ae,1),!0;return!1}function Z(de){for(var Ae=0;Ae<j.length;++Ae)if(j[Ae].el===de)return j[Ae]}function W(de){var Ae=Z(de);return Ae||(j.push(Ae={el:de,binding:{}}),Ae)}function K(de){var Ae=W(this).binding;if(Ae.value){if(de.preventDefault(),typeof Ae.value=="string")return H(Ae.value);H(Ae.value.el||Ae.value.element,Ae.value)}}var ee={bind:function(Ae,Be){W(Ae).binding=Be,L.on(Ae,"click",K)},unbind:function(Ae){J(Ae),L.off(Ae,"click",K)},update:function(Ae,Be){W(Ae).binding=Be}},se={bind:ee.bind,unbind:ee.unbind,update:ee.update,beforeMount:ee.bind,unmounted:ee.unbind,updated:ee.update,scrollTo:H,bindings:j},ge=function(Ae,Be){Be&&F(Be),Ae.directive("scroll-to",se);var ye=Ae.config.globalProperties||Ae.prototype;ye.$scrollTo=se.scrollTo};return typeof window<"u"&&window.Vue&&(window.VueScrollTo=se,window.VueScrollTo.setDefaults=F,window.VueScrollTo.scroller=V,window.Vue.use&&window.Vue.use(ge)),se.install=ge,se})}(U1)),U1.exports}var uk=lk();const My=UE(uk),ck=["href"],hk=Ct({});({...hk});const er=(n,e)=>{const t=n.__vccOpts||n;for(const[i,r]of e)t[i]=r;return t},fk=Ct({}),Ak={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 40 40"};function dk(n,e,t,i,r,s){return yt(),Rt("svg",Ak,e[0]||(e[0]=[Ee("g",{transform:"translate(10.766 22.833) rotate(-90)"},[Ee("path",{d:"M0,0,9.233,9.233,0,18.466",fill:"none",stroke:"#cb2529","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1)]))}const OE=er(fk,[["render",dk]]),pk=Ct({}),mk={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function gk(n,e,t,i,r,s){return yt(),Rt("svg",mk,e[0]||(e[0]=[Ee("g",{id:"close",transform:"translate(0 -4)"},[Ee("rect",{width:"36",height:"36",transform:"translate(0 4)",fill:"none"}),Ee("path",{d:"M15.316,16.816a1.5,1.5,0,0,1-1.061-.439L-1.061,1.061a1.5,1.5,0,0,1,0-2.121,1.5,1.5,0,0,1,2.121,0L16.377,14.256a1.5,1.5,0,0,1-1.061,2.561Z",transform:"translate(10.5 14.5)",fill:"#232323"}),Ee("path",{d:"M0,16.816a1.5,1.5,0,0,1-1.061-.439,1.5,1.5,0,0,1,0-2.121L14.256-1.061a1.5,1.5,0,0,1,2.121,0,1.5,1.5,0,0,1,0,2.121L1.061,16.377A1.5,1.5,0,0,1,0,16.816Z",transform:"translate(10.5 14.5)",fill:"#232323"})],-1)]))}const kE=er(pk,[["render",gk]]),_k=Ct({}),vk={width:"36",height:"36",viewBox:"0 0 36 36",xmlns:"http://www.w3.org/2000/svg"};function yk(n,e,t,i,r,s){return yt(),Rt("svg",vk,e[0]||(e[0]=[Ee("g",{transform:"translate(-32 -1)"},[Ee("rect",{width:"36",height:"36",transform:"translate(32 1)",fill:"none"}),Ee("g",{transform:"translate(38 7)"},[Ee("path",{d:"M24,12A12,12,0,1,0,10.16,23.84v-8.4H7.04V12h3.04V9.36c0-3.04,1.76-4.64,4.56-4.64a19.409,19.409,0,0,1,2.72.24V7.92H15.84a1.7,1.7,0,0,0-1.92,1.84V12h3.36l-.56,3.44h-2.8v8.4A11.976,11.976,0,0,0,24,12Z"})])],-1)]))}const VE=er(_k,[["render",yk]]),xk=Ct({}),bk={width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Tk(n,e,t,i,r,s){return yt(),Rt("svg",bk,e[0]||(e[0]=[Ee("path",{d:"M16.8986 32.0645H5.625C5.02826 32.0645 4.45597 31.8274 4.03401 31.4055C3.61205 30.9836 3.375 30.4113 3.375 29.8146V9.00329C3.375 8.40659 3.61205 7.83432 4.03401 7.41239C4.45597 6.99046 5.02826 6.75342 5.625 6.75342H26.4375C27.0342 6.75342 27.6065 6.99046 28.0285 7.41239C28.4504 7.83432 28.6875 8.40659 28.6875 9.00329V29.8146C28.6875 30.4113 28.4504 30.9836 28.0285 31.4055C27.6065 31.8274 27.0342 32.0645 26.4375 32.0645H20.6483V23.1989H23.5834L24.0446 19.6789H20.6471V17.2502C20.6471 16.2209 20.9531 15.5347 22.4471 15.5347H24.3698V12.3848C23.4396 12.2873 22.5048 12.2408 21.5696 12.2454C20.9444 12.1936 20.3155 12.2784 19.7263 12.4939C19.1372 12.7094 18.602 13.0505 18.1577 13.4934C17.7135 13.9363 17.3709 14.4705 17.1537 15.059C16.9365 15.6475 16.8498 16.2762 16.8998 16.9015V19.6778H13.8375V23.1977H16.8964V32.0645H16.8986Z",fill:"#2B66D8"},null,-1)]))}const Sk=er(xk,[["render",Tk]]),wk=Ct({}),Mk={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function Ek(n,e,t,i,r,s){return yt(),Rt("svg",Mk,e[0]||(e[0]=[Ee("rect",{width:"36",height:"36",fill:"none"},null,-1),Ee("path",{d:"M3.241,21V11.605H0V7.875H3.241V4.934A4.565,4.565,0,0,1,8.189,0a27.964,27.964,0,0,1,2.967.148V3.486H9.119c-1.6,0-1.906.738-1.906,1.817V7.875h3.6l-.49,3.73H7.213V21",transform:"translate(12.422 7.5)",fill:"#232323"},null,-1)]))}const zE=er(wk,[["render",Ek]]),Ck=Ct({}),Rk={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function Nk(n,e,t,i,r,s){return yt(),Rt("svg",Rk,e[0]||(e[0]=[w2('<g transform="translate(0 -1)"><rect width="36" height="36" transform="translate(0 1)" fill="none"></rect><g transform="translate(1.874 -1)"><path d="M15.063,1.5H0A1.5,1.5,0,0,1-1.5,0,1.5,1.5,0,0,1,0-1.5H15.063a1.5,1.5,0,0,1,1.5,1.5A1.5,1.5,0,0,1,15.063,1.5Z" transform="translate(8.126 27)" fill="#232323"></path><path d="M15.063,1.5H0A1.5,1.5,0,0,1-1.5,0,1.5,1.5,0,0,1,0-1.5H15.063a1.5,1.5,0,0,1,1.5,1.5A1.5,1.5,0,0,1,15.063,1.5Z" transform="translate(8.126 20)" fill="#232323"></path><path d="M15.063,1.5H0A1.5,1.5,0,0,1-1.5,0,1.5,1.5,0,0,1,0-1.5H15.063a1.5,1.5,0,0,1,1.5,1.5A1.5,1.5,0,0,1,15.063,1.5Z" transform="translate(8.126 13)" fill="#232323"></path></g></g>',1)]))}const qE=er(Ck,[["render",Nk]]),Pk=Ct({}),Lk={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36",width:"36",height:"36"};function Dk(n,e,t,i,r,s){return yt(),Rt("svg",Lk,e[0]||(e[0]=[w2('<g transform="translate(-32 -1)"><rect width="36" height="36" transform="translate(32 1)" fill="none"></rect><g transform="translate(38 7)"><path d="M12,2.1c3.2,0,3.6,0,4.88.078a7.583,7.583,0,0,1,2.24.389,4.006,4.006,0,0,1,1.36.856,3.876,3.876,0,0,1,.88,1.323,7.032,7.032,0,0,1,.4,2.18c.08,1.246.08,1.635.08,4.748s0,3.5-.08,4.748a7.032,7.032,0,0,1-.4,2.18,3.876,3.876,0,0,1-.88,1.323,4.006,4.006,0,0,1-1.36.856,7.583,7.583,0,0,1-2.24.389c-1.28.078-1.68.078-4.88.078s-3.6,0-4.88-.078a7.583,7.583,0,0,1-2.24-.389,4.006,4.006,0,0,1-1.36-.856A3.876,3.876,0,0,1,2.64,18.6a7.032,7.032,0,0,1-.4-2.18c-.08-1.246-.08-1.635-.08-4.748s0-3.5.08-4.748a7.032,7.032,0,0,1,.4-2.18,6.333,6.333,0,0,1,.88-1.323,4.006,4.006,0,0,1,1.36-.856A7.583,7.583,0,0,1,7.12,2.18C8.4,2.1,8.8,2.1,12,2.1M12,0C8.72,0,8.32,0,7.04.078A8.506,8.506,0,0,0,4.16.623,7.013,7.013,0,0,0,2,1.946a6.77,6.77,0,0,0-1.36,2.1,8.294,8.294,0,0,0-.56,2.8C0,8.1,0,8.485,0,11.677S0,15.257.08,16.5a7.893,7.893,0,0,0,.56,2.8A6.77,6.77,0,0,0,2,21.407,6.192,6.192,0,0,0,4.16,22.73a8.939,8.939,0,0,0,2.88.545c1.28.078,1.68.078,4.96.078s3.68,0,4.96-.078a8.505,8.505,0,0,0,2.88-.545A7.013,7.013,0,0,0,22,21.407a5.979,5.979,0,0,0,1.36-2.1,8.294,8.294,0,0,0,.56-2.8c.08-1.245.08-1.635.08-4.826S24,8.1,23.92,6.85a7.893,7.893,0,0,0-.56-2.8A6.77,6.77,0,0,0,22,1.946,6.192,6.192,0,0,0,19.84.623,8.939,8.939,0,0,0,16.96.078C15.68,0,15.28,0,12,0Z"></path><path d="M13.46,7.3a6,6,0,1,0,0,11.988,6,6,0,1,0,0-11.988Zm0,9.886a3.894,3.894,0,1,1,0-7.784,3.894,3.894,0,1,1,0,7.784Z" transform="translate(-1.46 -1.617)"></path><ellipse cx="1.44" cy="1.401" rx="1.44" ry="1.401" transform="translate(16.96 4.048)"></ellipse></g></g>',1)]))}const GE=er(Pk,[["render",Dk]]),Ik=Ct({}),Bk={width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Fk(n,e,t,i,r,s){return yt(),Rt("svg",Bk,e[0]||(e[0]=[Ee("path",{d:"M17.1945 32.3678C17.1217 32.3738 17.0485 32.3632 16.9803 32.3369C16.9121 32.3106 16.8507 32.2693 16.8008 32.216C16.6699 31.9651 16.6436 31.6727 16.7276 31.4026V31.3722C16.7648 31.1472 16.9357 30.1212 16.9357 30.1212C17.0255 29.6828 17.0093 29.2292 16.8885 28.7982C16.7276 28.4 16.101 28.1862 15.6004 28.0771C8.5185 27.1456 3.375 22.2204 3.375 16.3715C3.375 9.82739 9.936 4.50391 18 4.50391C26.064 4.50391 32.625 9.82739 32.625 16.3715C32.5661 19.1207 31.4419 21.7396 29.4896 23.6761C26.1178 27.079 22.2426 29.943 18 32.1676C17.7465 32.2845 17.4732 32.3524 17.1945 32.3678V32.3678ZM23.6554 13.2091C23.5814 13.2097 23.5105 13.2387 23.4574 13.2901L23.4495 13.298C23.399 13.3507 23.3708 13.4208 23.3708 13.4938V19.8657C23.3713 19.9397 23.4003 20.0106 23.4518 20.0637L23.4596 20.0716C23.5123 20.1228 23.5831 20.1511 23.6565 20.1504H27.7538C27.8291 20.1498 27.9011 20.1196 27.9544 20.0664C28.0076 20.0131 28.0378 19.9411 28.0384 19.8657V18.8431C28.0381 18.7678 28.008 18.6957 27.9546 18.6426C27.9013 18.5895 27.829 18.5596 27.7538 18.5596H24.9671V17.4785H27.7538C27.829 17.4785 27.9013 17.4487 27.9546 17.3955C28.008 17.3424 28.0381 17.2703 28.0384 17.195V16.1724C28.0378 16.0971 28.0076 16.025 27.9544 15.9718C27.9011 15.9185 27.8291 15.8883 27.7538 15.8878H24.9671V14.8078H27.7538C27.829 14.8078 27.9013 14.7779 27.9546 14.7248C28.008 14.6717 28.0381 14.5996 28.0384 14.5243V13.5039C28.0378 13.4286 28.0076 13.3565 27.9544 13.3033C27.9011 13.25 27.8291 13.2199 27.7538 13.2193L23.6554 13.2091ZM17.9032 16.0813L20.8282 20.0255C20.8483 20.0535 20.8731 20.0779 20.9014 20.0975L20.9216 20.1099H20.925L20.9385 20.1166H20.9846C21.0084 20.1235 21.033 20.1269 21.0578 20.1267H22.0804C22.1555 20.1265 22.2274 20.0965 22.2805 20.0434C22.3336 19.9903 22.3636 19.9183 22.3639 19.8432V13.4949C22.3636 13.4198 22.3336 13.3479 22.2805 13.2947C22.2274 13.2416 22.1555 13.2117 22.0804 13.2114H21.06C20.9849 13.2117 20.913 13.2416 20.8599 13.2947C20.8068 13.3479 20.7768 13.4198 20.7765 13.4949V17.2861L17.8582 13.3363L17.8459 13.3183L17.8369 13.307L17.8256 13.2958L17.8189 13.289L17.8087 13.2789H17.775L17.7593 13.2699H16.5949C16.5196 13.2699 16.4474 13.2997 16.394 13.3529C16.3407 13.406 16.3105 13.4781 16.3103 13.5534V19.8646C16.3105 19.9399 16.3407 20.012 16.394 20.0652C16.4474 20.1183 16.5196 20.1481 16.5949 20.1481H17.6175C17.6928 20.1481 17.765 20.1183 17.8184 20.0652C17.8717 20.012 17.9018 19.9399 17.9021 19.8646V16.0835L17.9032 16.0813ZM14.0018 13.2091C13.9265 13.2091 13.8542 13.239 13.8009 13.2921C13.7475 13.3452 13.7174 13.4173 13.7171 13.4926V19.8669C13.7174 19.9422 13.7475 20.0143 13.8009 20.0674C13.8542 20.1205 13.9265 20.1504 14.0018 20.1504H15.0244C15.0995 20.1501 15.1714 20.1201 15.2245 20.067C15.2776 20.0139 15.3076 19.942 15.3079 19.8669V13.4949C15.3076 13.4198 15.2776 13.3479 15.2245 13.2947C15.1714 13.2416 15.0995 13.2117 15.0244 13.2114L14.0018 13.2091ZM8.45663 13.2091C8.38133 13.2091 8.30911 13.239 8.25576 13.2921C8.20242 13.3452 8.1723 13.4173 8.172 13.4926V19.8646C8.1722 19.9382 8.20035 20.009 8.25075 20.0626L8.25863 20.0705C8.31159 20.1212 8.38216 20.1495 8.4555 20.1492H12.555C12.6305 20.1492 12.7029 20.1193 12.7563 20.0659C12.8096 20.0125 12.8396 19.9401 12.8396 19.8646V18.842C12.8393 18.7667 12.8092 18.6946 12.7559 18.6415C12.7025 18.5883 12.6303 18.5585 12.555 18.5585H9.76613V13.496C9.76583 13.4207 9.73571 13.3486 9.68236 13.2955C9.62902 13.2423 9.55679 13.2125 9.4815 13.2125L8.45663 13.2091Z",fill:"#10B82B"},null,-1)]))}const Uk=er(Ik,[["render",Fk]]),Ok=Ct({}),kk={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function Vk(n,e,t,i,r,s){return yt(),Rt("svg",kk,e[0]||(e[0]=[w2('<g transform="translate(1472 -130)"><g transform="translate(-1472.223 131)"><rect width="36" height="36" transform="translate(0.223 -1)" fill="none"></rect><g transform="translate(7.595 6.875)"><path d="M23.837,12.217c0-4.755-4.768-8.623-10.628-8.623S2.583,7.463,2.583,12.217c0,4.262,3.781,7.834,8.888,8.509.346.074.817.229.936.524a2.186,2.186,0,0,1,.034.96s-.124.75-.151.91c-.046.268-.214,1.05.92.572a34.271,34.271,0,0,0,8.349-6.17h0A7.667,7.667,0,0,0,23.837,12.217ZM9.05,15.047H6.939a.558.558,0,0,1-.558-.558V10.266a.557.557,0,1,1,1.115,0v3.665H9.05a.557.557,0,0,1,0,1.115Zm2.184-.558a.557.557,0,1,1-1.114,0V10.266a.557.557,0,1,1,1.114,0Zm5.083,0a.557.557,0,0,1-1,.335l-2.164-2.946v2.612a.557.557,0,1,1-1.114,0V10.266a.557.557,0,0,1,.38-.529.568.568,0,0,1,.177-.029.561.561,0,0,1,.446.223L15.2,12.88V10.266a.557.557,0,1,1,1.115,0Zm3.417-2.668a.557.557,0,1,1,0,1.114H18.179v1h1.554a.557.557,0,1,1,0,1.115H17.622a.558.558,0,0,1-.557-.558V12.379h0V10.266a.558.558,0,0,1,.557-.557h2.111a.558.558,0,0,1,0,1.115H18.179v1h1.554Z" transform="translate(-2.583 -3.594)" fill="#232323"></path></g></g></g>',1)]))}const HE=er(Ok,[["render",Vk]]),zk=Ct({}),qk={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36",width:"36",height:"36"};function Gk(n,e,t,i,r,s){return yt(),Rt("svg",qk,e[0]||(e[0]=[Ee("g",{transform:"translate(-30 31)"},[Ee("rect",{width:"36",height:"36",transform:"translate(30 -31)",fill:"none"}),Ee("g",{"data-name":"line",transform:"translate(36 -25)"},[Ee("path",{d:"M26.351,13.237c0-5.317-5.332-9.644-11.885-9.644S2.583,7.92,2.583,13.237c0,4.767,4.228,8.76,9.939,9.516.387.083.914.256,1.047.586a2.444,2.444,0,0,1,.038,1.074s-.139.839-.169,1.018c-.051.3-.239,1.175,1.029.64a38.324,38.324,0,0,0,9.337-6.9h0A8.574,8.574,0,0,0,26.351,13.237ZM9.815,16.4H7.454a.624.624,0,0,1-.624-.624V11.056a.623.623,0,1,1,1.246,0v4.1H9.815a.623.623,0,0,1,0,1.247Zm2.443-.624a.623.623,0,1,1-1.246,0V11.056a.623.623,0,1,1,1.246,0Zm5.684,0a.623.623,0,0,1-1.122.374L14.4,12.857v2.921a.623.623,0,1,1-1.246,0V11.056a.623.623,0,0,1,.425-.591.635.635,0,0,1,.2-.032.627.627,0,0,1,.5.25l2.42,3.3V11.056a.623.623,0,1,1,1.246,0Zm3.821-2.984a.623.623,0,1,1,0,1.246H20.024v1.115h1.738a.623.623,0,1,1,0,1.247H19.4a.624.624,0,0,1-.623-.624v-2.36h0v-2.36a.624.624,0,0,1,.623-.623h2.361a.623.623,0,0,1,0,1.247H20.024v1.115h1.738Z",transform:"translate(-2.583 -3.594)"})])],-1)]))}const WE=er(zk,[["render",Gk]]),Hk=Ct({}),Wk={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function $k(n,e,t,i,r,s){return yt(),Rt("svg",Wk,e[0]||(e[0]=[Ee("g",{transform:"translate(5 -1)"},[Ee("rect",{width:"36",height:"36",transform:"translate(-5 1)",fill:"none"}),Ee("path",{d:"M13.285,12.078a3.608,3.608,0,0,0-2.257.789L7.161,10.449a3.644,3.644,0,0,0,0-1.573l3.868-2.418A3.617,3.617,0,1,0,9.748,4.41L5.88,6.827a3.623,3.623,0,1,0,0,5.669l3.868,2.418a3.624,3.624,0,1,0,3.537-2.837Z",transform:"translate(3 9)",fill:"var(--color, #222222)"})],-1)]))}const $E=er(Hk,[["render",$k]]),jk=Ct({}),Xk={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function Qk(n,e,t,i,r,s){return yt(),Rt("svg",Xk,e[0]||(e[0]=[Ee("g",{transform:"translate(1472 -90)"},[Ee("g",{transform:"translate(-1472 86)"},[Ee("rect",{width:"36",height:"36",transform:"translate(0 4)",fill:"none"}),Ee("path",{d:"M17.55,52.041c.012.174.012.348.012.521A11.328,11.328,0,0,1,6.156,63.969,11.329,11.329,0,0,1,0,62.169a8.292,8.292,0,0,0,.968.05,8.029,8.029,0,0,0,4.977-1.713A4.016,4.016,0,0,1,2.2,57.726a5.057,5.057,0,0,0,.757.062,4.24,4.24,0,0,0,1.055-.137A4.01,4.01,0,0,1,.794,53.717v-.05a4.038,4.038,0,0,0,1.812.509,4.015,4.015,0,0,1-1.241-5.362,11.4,11.4,0,0,0,8.266,4.2,4.526,4.526,0,0,1-.1-.918,4.013,4.013,0,0,1,6.938-2.743,7.892,7.892,0,0,0,2.544-.968,4,4,0,0,1-1.762,2.209,8.037,8.037,0,0,0,2.309-.621A8.617,8.617,0,0,1,17.55,52.041Z",transform:"translate(8.22 -34.025)",fill:"#232323"})])],-1)]))}const jE=er(jk,[["render",Qk]]),Yk=Ct({}),Zk={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"37",viewBox:"0 0 36 37",fill:"none"};function Kk(n,e,t,i,r,s){return yt(),Rt("svg",Zk,e[0]||(e[0]=[Ee("path",{d:"M23.2033 9.875H25.96L19.9375 16.7583L27.0225 26.125H21.475L17.13 20.4442L12.1583 26.125H9.39998L15.8417 18.7625L9.04498 9.875H14.7333L18.6608 15.0675L23.2033 9.875ZM22.2358 24.475H23.7633L13.9033 11.4383H12.2641L22.2358 24.475Z",fill:"#0F1419"},null,-1)]))}const XE=er(Yk,[["render",Kk]]),Jk=Ct({}),eV={width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function tV(n,e,t,i,r,s){return yt(),Rt("svg",eV,e[0]||(e[0]=[Ee("path",{d:"M30.6281 12.9022C30.6473 13.1722 30.6473 13.4421 30.6473 13.7121C30.6634 16.042 30.2164 18.3518 29.3321 20.5075C28.4479 22.6632 27.144 24.6218 25.4963 26.2694C23.8486 27.917 21.8899 29.2209 19.734 30.1052C17.578 30.9896 15.2678 31.4368 12.9375 31.421C9.54733 31.4303 6.22666 30.4601 3.375 28.627C3.87406 28.6821 4.37592 28.708 4.878 28.7046C7.67991 28.7118 10.4025 27.7751 12.6068 26.0456C11.3076 26.022 10.0483 25.5933 9.00473 24.8193C7.96116 24.0453 7.18546 22.9648 6.786 21.7286C7.17489 21.7902 7.56788 21.8226 7.96163 21.8253C8.51434 21.8238 9.06466 21.7528 9.59962 21.6138C8.19055 21.3278 6.92392 20.563 6.01484 19.4492C5.10575 18.3355 4.61026 16.9415 4.6125 15.5039V15.4263C5.47493 15.9064 6.43858 16.1762 7.425 16.2136C6.10402 15.3325 5.16908 13.9807 4.81095 12.4339C4.45283 10.8871 4.69852 9.26196 5.49787 7.89009C7.06151 9.81451 9.01225 11.3888 11.2236 12.511C13.4349 13.6331 15.8575 14.278 18.3341 14.4038C18.2342 13.9349 18.1826 13.457 18.18 12.9776C18.1812 11.7292 18.5575 10.5099 19.2602 9.47788C19.9628 8.44587 20.9593 7.6487 22.1205 7.18973C23.2817 6.73076 24.554 6.63117 25.7725 6.90387C26.991 7.17656 28.0994 7.80896 28.9541 8.71908C30.3482 8.45075 31.6851 7.94227 32.9051 7.21634C32.4407 8.65452 31.4675 9.87392 30.168 10.6459C31.4032 10.5055 32.6106 10.1813 33.75 9.68416C32.8977 10.9247 31.8423 12.0126 30.6281 12.9022V12.9022Z",fill:"#49ADE4"},null,-1)]))}const QE=er(Jk,[["render",tV]]),nV=Ct({}),iV={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36",fill:"none"};function rV(n,e,t,i,r,s){return yt(),Rt("svg",iV,e[0]||(e[0]=[Ee("path",{d:"M25.2847 6.625H29.144L20.7125 16.2617L30.6315 29.375H22.865L16.782 21.4218L9.82168 29.375H5.96001L14.9783 19.0675L5.46301 6.625H13.4267L18.9252 13.8945L25.2847 6.625ZM23.9302 27.065H26.0687L12.2647 8.81367H9.96985L23.9302 27.065Z",fill:"#0F1419"},null,-1)]))}const YE=er(nV,[["render",rV]]),sV=Ct({}),oV={xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 36 36"};function aV(n,e,t,i,r,s){return yt(),Rt("svg",oV,e[0]||(e[0]=[Ee("g",{transform:"translate(-30 -1)"},[Ee("rect",{width:"36",height:"36",transform:"translate(30 1)",fill:"none"}),Ee("path",{d:"M23.52,3.659A3.855,3.855,0,0,0,21.36.7C19.52,0,12,0,12,0S4.48,0,2.64.7A3.855,3.855,0,0,0,.48,3.659,62.241,62.241,0,0,0,0,11.677a62.241,62.241,0,0,0,.48,8.018,3.855,3.855,0,0,0,2.16,2.958c1.84.7,9.36.7,9.36.7s7.52,0,9.36-.7a3.855,3.855,0,0,0,2.16-2.958A62.241,62.241,0,0,0,24,11.677,62.241,62.241,0,0,0,23.52,3.659ZM8.72,16.114V7.239l8,4.437Z",transform:"translate(36 7)"})],-1)]))}const ZE=er(sV,[["render",aV]]),lV={},uV={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none"};function cV(n,e){return yt(),Rt("svg",uV,e[0]||(e[0]=[Ee("path",{d:"M8.58984 16.58L13.1698 12L8.58984 7.41L9.99984 6L15.9998 12L9.99984 18L8.58984 16.58Z",fill:"currentColor"},null,-1)]))}const KE=er(lV,[["render",cV]]),hV=Ct({}),fV={xmlns:"http://www.w3.org/2000/svg",width:"81",height:"15",viewBox:"0 0 180 32.1"};function AV(n,e,t,i,r,s){return yt(),Rt("svg",fV,e[0]||(e[0]=[Ee("path",{d:"M156.778,16.817c-.271-.131-5.423.824-6.788.913A19.8,19.8,0,0,1,139.5,15.3a19.777,19.777,0,0,1-6.032-5.312c-.391-.469-1.01-.835-1.321-1.366-.535-.932-.433-2.636-1.152-3.422l-.5-.311-.823-.065-.254.145c-1.372.706-1.942,2.9-2.9,4.023a46.225,46.225,0,0,1-8.1,7.07c-1.763,1.3-3.692,1.741-6.614,2.052a11.047,11.047,0,0,1-3.143.214,14.378,14.378,0,0,1-3.8-1.813c-.31-.253-.424-.681-.754-.913a1.652,1.652,0,0,0-1.648,0c-.828.46-1.258,1.85-1.4,2.876a9.273,9.273,0,0,0,.41,3.275,4.3,4.3,0,0,0,.412,1.743c1.641,2.219,6.122.778,8.6.307.559-.119,1.576-.563,2.314-.228.814.368.115,2.463-.082,2.96-.416,1.073-.6,3.61.48,4.147l.8.17c2.457.713,4.943-.223,7.486-.514a106.06,106.06,0,0,1,11.54-.25c2.474.264,4.557.366,6.976.776,1.288.222,3.632.89,5.292.375,2.57-.785.054-5.186,1.249-6.988l.073-.068c.817-.589,1.53.1,2.565.068a11.648,11.648,0,0,0,4.546-.989c.694-.422,1.295-1.422,1.9-1.958C155.965,20.987,158.092,17.43,156.778,16.817ZM126.03,14.4c.47-.465,1.342-1.457,2.065-1.6,2.053-.4,3.3,1.711,4.223,2.511l-.171.454c-1.466.182-5.91.971-7.278.308l-.243-.542C125.016,15.082,125.6,14.8,126.03,14.4Zm14.136,11.913-.494.61c-1.3.5-3.429.07-4.4-.05-2.024-.233-3.126.094-5.516,0a38.135,38.135,0,0,0-6.974.43,9.087,9.087,0,0,1-3.693-.083c-.852-.3-.431-1.877.071-2.271.8-.611,3.811-.585,5.209-.689,1.773-.121,3.769-.22,5.386-.179,3.225.073,7.775-.438,10,.943A1.076,1.076,0,0,1,140.166,26.308Zm-3.885-5.315c-3.143.214-6.339-.075-9.673.152-1.966.139-5.872.7-7.607.163h-.163c-1.343-.785.691-1.91,1.322-2.293l1.076-.448c.5-.027.938.778,1.326.839,1.5.263,3.469-.318,5.12-.16.449.047,6.259-.521,6.285-.527.479-.192.937-.985,1.408-1.064.657-.132,4.726,2.376,4.909,3.13C140.5,21.625,137.73,20.891,136.281,20.993Z",transform:"translate(-40.407 -2.081)",fill:"#cb2529"},null,-1),Ee("path",{d:"M260.395,23.773a7.576,7.576,0,0,0-2.648.31,21.278,21.278,0,0,1-5.452.126,40.4,40.4,0,0,1-9.877-3.316,11.2,11.2,0,0,1-2.121-1.527l-.01-.743c.734-1.357,4.273-.353,5.9-.713a24.863,24.863,0,0,1,2.976-.616,8.223,8.223,0,0,0,2.38-.242c1.785-.889-.731-4.423-2.923-3.735-.913.29-1.512.892-2.281,1.123-1.417.422-5.3,1.274-3.8-.845a3.826,3.826,0,0,1,1.577-1.268,14.249,14.249,0,0,1,3.338-1.42A13.273,13.273,0,0,0,250,10.364a3.958,3.958,0,0,0,1.66-2.447c.073-1.238-2.633-1.014-4.054-.838a27,27,0,0,1-5.28.326c-1.729-.152-5.665-1.644-7.58-1.185-.43.1-.659.656-.959.9-.317.24-.973.469-1.048.892a11.6,11.6,0,0,0,.121,2.562c.1,1.429-.491.891-1.505.547a10.4,10.4,0,0,0-3.961-.125l-.442.094a12.357,12.357,0,0,1-3.343.243c-.533-.1-.658-.951-.627-.951.178-.521.146-1.5.692-1.711a3.882,3.882,0,0,1,1.065-.078c2.453-.172,4.242-.278,5.092-1.739.3-.514.14-1.615-.449-1.76-1.873-.492-3.863,1.291-5.64.631-1.314-.492-.447-2.126-.347-2.5.49-1.751-.553-2.173-2.4-2.042-1.384.1-1.179.356-1.721,1.115-.265.364-.553,3.463-.265,2.936-.835,1.483-4.173-.394-6.432.133-.647.159-1.152,1.311-1.583,1.72s-1.033.991-.6,1.7c.471.759,1.249.589,2.289.418,1.772-.286,6.6-.932,6.34.91-.089.686-.017,1.394-.776,1.553a42.924,42.924,0,0,1-9.067.078c-1.139-.106-2.169-.759-3.437-.634a3.879,3.879,0,0,0-1.922.819,8.485,8.485,0,0,0-1.657,2.447.887.887,0,0,0,.71,1.331c.677.04,1.33-.458,1.933-.542,2.354-.358,5.476-1.253,8.355-.733.554.1.913,1.094.63,1.62-.167.29-1.079.452-1.5.527-1.927.318-4.573-.656-5.969.417a2.215,2.215,0,0,0-.962,1.7l-.083.441c.113.436.828.6,1.5.575,1.1-.053,2.325-.442,3.421-.552,1.849-.174,3.426-.174,5.281-.182a8.961,8.961,0,0,1,2.292.049.927.927,0,0,1,.531.737,1.671,1.671,0,0,1-.254,1.478c-.6.662-7.207.4-8.8.509-2.547.179-3.512-.477-4.922.859-.552.5-.577.7-.076,1.247a2.805,2.805,0,0,0,1.321,1.025c2.21.535,5.974-.463,7.92-.732.6-.095,4.2-.569,4.571-.014a1.263,1.263,0,0,1-.081,1.093c-1.273,2.836-17.127.473-14.219,4.972a3.983,3.983,0,0,0,1.777,1.529c2.6.809,4.762-.619,6.414-1.088,3.025-.844,7-.631,8.79-2.441a4.2,4.2,0,0,0,.944-2.513c.052-.547.052-1.775.1-1.8.388-.106.532.033.943.026,2.71-.019,5.124.865,6.513-.65l.524-.5c1.181-2.794-6.445-.486-7.973-1.485.168-.723-.048-2.137.634-2.432,1.69-.773,6.71,1.235,7.649-.734a.939.939,0,0,0-.092-1.1c-.978-1.268-2.282-.673-3.613-1.445.055-.535.376-1.4,1.123-1.552,1.052-.209,1.975.1,2.992-.019.575-.08,1.44-.536,2.111-.391.834.171.714,4.1.6,4.993-.393,3-2.8,10.562-.629,12.86,1.012,1.09,3.865,1.031,3.328-.978-.284-1.075-.659-8,.4-8.448.607-.258.7-.1,1.2.067,1.144.414,2.062,1.71,2.833,2.5a23.92,23.92,0,0,0,5.3,3.638c.592.229,3.245,2.146,4.267,2.53,1.106.422,2.414-.175,3.146-.415,1.7-.592,4.484-3.053,5.777-4.133.451-.387.961-.715,1.388-1.123C260.517,24.835,261.306,23.975,260.395,23.773Zm-36.409-8.838a3.771,3.771,0,0,1-1.484.893c-.784.184-5.615.455-6.335.121-.641-.267.044-1.245.337-1.463a6.8,6.8,0,0,1,3.163-.686c.925-.047,1.979.007,2.908-.04C223.935,13.707,225.134,13.759,223.986,14.935Zm13.124,1.279c-.645.074-.637.1-.738-.272a34.2,34.2,0,0,1,.608-5.308,20.265,20.265,0,0,1,3.781-.409,1.871,1.871,0,0,1,1.417.346c-.279,1.319-1.34,2.2-1.74,3.419-.165.49.128.949-.165,1.314C239.951,15.707,237.722,16.144,237.11,16.214Z",transform:"translate(-80.821 -0.614)",fill:"#cb2529"},null,-1),Ee("path",{d:"M47.809,20.369c.049-.7-.007-1.4.265-1.649.512-.509,1.574-.124,2.824.053.664.086,1.151.631,2.09.463,2.475-.423-2.288-5.6-2.45-6.8-.263-2.076,3.223-.533,3.579-1.926.513-2-1.41-2.876-2.1-3.841C51.083,5.315,49.256.092,47.231.254A3.486,3.486,0,0,0,46.1.742a13.112,13.112,0,0,0-3.666,3.514c-.371.462-.991.763-1.384,1.216-.536.612-2.086,3.533-2.7,3.685h-.7c-1.5-.292-2.966-7.344-5.488-7.768a2.69,2.69,0,0,0-1.565.235c-2.02.99-3.572,3.45-5.406,4.8-.375.284-.637.706-1.139.889a4.138,4.138,0,0,1-2.077.23l-.181-.392.087-.158c0-1.358.01-2.517-.868-3.049-1.257-.737-3.229-.188-4.8-.067a12.592,12.592,0,0,1-1.916-.253c-1.06-.07-2.172.276-3.4.161-1.63-.154-3.6-.193-5.311-.321-1.69-.109-2.573.05-3.408.889A9.747,9.747,0,0,0,1.22,5.392c-.52.756-.037,4.27.082,5.281a28.014,28.014,0,0,1-.347,5.287C.843,17.341.269,18.1.085,19.237A6.074,6.074,0,0,0,1.3,24.056l.443.32a3.237,3.237,0,0,0,1.3.074c.989-.111,15.019-3.091,12.373,0a4.2,4.2,0,0,1-1.39.969,15.672,15.672,0,0,1-3.311.473c-2.258.367-5.89.193-7.49,1.2l-.181.079a4.972,4.972,0,0,0-1.483,1.288c-.356.5-.931,3.553,0,3.838a3.623,3.623,0,0,0,1.483-.159,39.847,39.847,0,0,0,7.231-1.6c2.158-.576,4.306-.656,6.11-1.515a9.3,9.3,0,0,0,3.045-2.814,11.15,11.15,0,0,0,1.828-4.006c.077-.548-.166-1.231,0-1.754l.179-.25a3.731,3.731,0,0,1,1.829-.16c4.053.472.4,2.588-.439,3.446l-.433.65c-.958,1.941,1.516,5,2.873,3.672.991-.971.391-3.149.26-4.723l.079-.562a19.074,19.074,0,0,1,.268-2.324c.272-.892,2.818-.759,3.574-.715a11.085,11.085,0,0,1,3.223.315c1,.434-1,2.958-1.393,3.686-.476.888-1.319,2.333-.611,3.609.926,1.671,2.863.567,3.14-.885s-.271-2.954-.179-4.4a2.477,2.477,0,0,1,1.823-2.584,8.762,8.762,0,0,1,3.584.1c1.838.39-.545,2.766-.7,3.369a17.1,17.1,0,0,0-.44,5.6,1.872,1.872,0,0,0,2.62.646c1.493-1.01.365-6.407.09-8.017-.09-.477-.686-1.514-.263-2.155.31-.518,3.089-.244,3.925-.244-.923.023,1.256-.027,1.474,0,2.108.218.89,2.754.437,3.833-.591,1.43-1.667,7.085.61,7.534a3.674,3.674,0,0,0,1.3-.158,3.663,3.663,0,0,0,2.186-.871c1.525-1.2,2.054-3.363,3.574-4.577a7.938,7.938,0,0,0,1.446-1.118C56.447,21.084,47.581,23.827,47.809,20.369Zm-31.865-.722c-1.133.652-5.965.006-7.84.244-.6.068-1.514.638-2.36.4-.736-.226-.434-1.981.1-2.247,1.07-.553,3.341-.529,4.7-.646,1.406-.116,4.947.176,5.5.881C16.318,18.655,16.433,19.362,15.943,19.647Zm-.263-4.241a10.826,10.826,0,0,1-2.605,0,36.156,36.156,0,0,0-6.978.236c-.293-.389-.369-.448-.171-.956.282-.76.751-.873,1.663-1.045a27.758,27.758,0,0,1,3.826-.488c1.079-.026,4.406.29,4.795.813A.951.951,0,0,1,15.68,15.407Zm1.052-5.286-.523.636c-1.607.5-3.827-.255-5.582-.084-.905.09-2.326.658-3.484.326-.512-.157-.512-.95-.44-1.445.108-.649.3-1.291.885-1.443a78.658,78.658,0,0,1,8.964.65C17.04,8.957,16.91,9.705,16.733,10.121Zm8.086,3.9a4.655,4.655,0,0,1-2.42,2.51c-1.987.625-1.432-3.019-.786-3.209a4.328,4.328,0,0,1,1.739.155,2.591,2.591,0,0,1,1.486.493Zm4.723,2.67c-1.374.155-2.143.138-2.36-.331-.431-.925,1.112-2.852,2.185-2.959C32.155,13.114,33.6,16.212,29.542,16.688Zm-2.179-6.567c-.689-.283-.1-1.042.178-1.36.306-.383.7-.7,1.038-1.045a3.454,3.454,0,0,1,1.659-.962c.923-.12,2.471,1.473,2.269,2.325C32.371,9.654,28.35,10.5,27.363,10.121Zm11.588,4.718c-.493.568-1.028,2.14-1.925,2.245L36.776,17a1.419,1.419,0,0,1-.873-.473,11.135,11.135,0,0,1-.962-2.245c-.274-.575-1.425-1.117-1.308-1.931.149-.961,2.554-.961,3.659-1.04a8.523,8.523,0,0,1,3.059.484c.749.209,1.289.2,1.228.819S39.455,14.269,38.951,14.838Zm6.283-9.7c1.5-.273,3.327,1.348,3.044,2.486-.139.547-1.771.99-2.353,1.135-1.4.325-2.374.19-2.7-.165C42.418,7.688,44.6,5.267,45.234,5.14Zm2.135,9.909c-.1.387-.678.588-1.529.677-1.575.159-2.437.109-2.633-.391-.4-.979,1.276-2.934,1.677-2.983C45.632,12.255,47.645,14.018,47.369,15.049Z",transform:"translate(0 -0.25)",fill:"#cb2529"},null,-1)]))}const JE=er(hV,[["render",AV]]),dV=Ct({}),pV=Ct({...dV,__name:"index",setup(n){const e=UA(),t=mp(),{y:i}=E2(e,{throttle:100}),r=Fi(0);function s(){if(typeof e>"u"&&typeof t>"u")return;const o=t.body.scrollHeight-e.innerHeight,a=e.scrollY;r.value=+(a/o*100).toFixed(2)}return qs(i,()=>s()),(o,a)=>(yt(),Rt("div",null,[Ee("div",{class:"nmd-progressbar",style:hl({width:`${r.value}%`})},null,4)]))}}),mV={class:"nmd-header__left"},gV=["href"],_V={class:"nmd-header__subscribe"},vV=["href"],yV={class:"nmd-header__right"},xV=Ct({components:{NmdLogo:JE}}),bV=Ct({...xV,__name:"index",props:{theme:{default:"light"},customBg:{},utmString:{default:""}},setup(n){const e=n,t=UA(),i=mp(),{y:r}=E2(t,{throttle:100}),s=Fi(!0);u4("isHeaderShown",s);const o=Fi(!0),a=eo(()=>({transform:s.value?"unset":"translateY(-60px)"})),l=eo(()=>({backgroundColor:o.value?"unset":e.customBg?e.customBg:e.theme==="dark"?"#232323":"#FFFFFF"})),u=eo(()=>e.utmString!==""?`https://vip.udn.com/vip/index?from=${e.utmString}`:"https://vip.udn.com/"),A=eo(()=>e.utmString!==""?`https://vip.udn.com/vip/order?from=${e.utmString}`:"https://vip.udn.com/vip/order?from=Newmedia");return qs(r,(p,g)=>{if(i.body.style.overflow!=="hidden"){if(p<=0)s.value=!0;else{const v=p>g;s.value=!v}o.value=r.value<=0}}),(p,g)=>(yt(),Rt("div",{class:"nmd-header",style:hl(a.value)},[Ee("div",{class:"nmd-header-nav",style:hl(l.value)},[Ee("div",mV,[Ee("a",{href:u.value,target:"_blank",rel:"noreferrer noopener",class:"nmd-header__logo","data-ga":"udn-logo"},[Ut(Ze(JE))],8,gV),Ee("div",_V,[Ee("a",{href:A.value,class:Os(["nmd-subscribe",{"nmd-header--dark":p.theme==="dark"}]),target:"_blank",rel:"noreferrer noopener","data-ga":"subscribe-top"},g[0]||(g[0]=[Ee("span",null,"",-1),Ee("span",null,"",-1)]),10,vV)])]),Ee("div",yV,[$r(p.$slots,"default")])],4),g[1]||(g[1]=Ee("div",{id:"header-teleport",class:"nmd-header-teleport"},null,-1))],4))}}),TV={class:"nmd-share-buttons"},SV=["href","tabindex"],wV=["href","target","tabindex"],MV=["href","tabindex"],EV=Ct({name:"NmdHeaderShare",components:{NmdIconFacebook:zE,NmdIconLineSmall:HE,NmdIconShare:$E,NmdIconTwitterSmall:jE,NmdIconTwitterSmallX:XE}}),CV=Ct({...EV,props:{facebook:{default:()=>({href:"https://www.facebook.com/sharer/sharer.php?kid_directed_site=0&sdk=joey&u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&display=popup&ref=plugin&src=share_button"})},line:{default:()=>({href:"https://social-plugins.line.me/lineit/share?url=https%3A%2F%2Fline.me%2Fen",target:"_blank"})},twitter:{default:()=>({href:"https://twitter.com/intent/tweet?text=Hello%20world"})},theme:{default:"light"},twitterIcon:{default:"x"}},setup(n){const e=n,t=Wf("isHeaderShown"),i=Fi(!1);qs(()=>t==null?void 0:t.value,o=>{o||(i.value=!1)});const r=eo(()=>({"nmd-share-buttons__share-button":!0,"nmd-share-buttons__share-button--shown":i.value})),s=eo(()=>i.value?"0":"-1");return(o,a)=>(yt(),Rt("div",TV,[Ee("a",{href:e.facebook.href,class:Os(["nmd-share-button",r.value]),target:"_blank",rel:"noreferrer noopener",tabindex:s.value,"data-ga":"share-facebook-top"},[Ut(Ze(zE),{class:"nmd-share-button__icon"})],10,SV),Ee("a",{href:e.line.href,class:Os(["nmd-share-button",r.value]),target:e.line.target||"_blank",rel:"noreferrer noopener",tabindex:s.value,"data-ga":"share-line-top"},[Ut(Ze(HE),{class:"nmd-share-button__icon"})],10,wV),Ee("a",{href:e.twitter.href,class:Os(["nmd-share-button",r.value]),target:"_blank",rel:"noreferrer noopener",tabindex:s.value,"data-ga":"share-twitter-top"},[o.twitterIcon==="x"?(yt(),fl(Ze(XE),{key:0,class:"nmd-share-button__icon"})):wr("",!0),o.twitterIcon==="bird"?(yt(),fl(Ze(jE),{key:1,class:"nmd-share-button__icon"})):wr("",!0)],10,MV),Ee("button",{class:Os(["nmd-share-button nmd-share-buttons__toggler",{"nmd-share-buttons__toggler--on":i.value}])},[Ut(Ze($E),{class:Os(["nmd-share-button__icon",{"nmd-share-button--dark":o.theme==="dark"}]),onClick:a[0]||(a[0]=l=>i.value=!i.value)},null,8,["class"])],2)]))}});let za;const e9=()=>za||(za=Zu({isShown:!1,isDisabled:!1,show:()=>za.isShown=!za.isDisabled&&!0,hide:()=>za.isShown=!za.isDisabled&&!1,enable:()=>za.isDisabled=!1,disable:()=>za.isDisabled=!0}),za),RV=Ct({name:"NmdHamburger",components:{NmdIconHamburger:qE}}),NV=Ct({...RV,props:{theme:{default:"light"}},setup(n){const e=e9(),t=UA(),i=mp();qs(()=>e.isShown,o=>o?r():s());function r(){if(!i.body.style||!i.body.getBoundingClientRect)return;const{width:o,top:a}=i.body.getBoundingClientRect();i.body.style.overflow="hidden",i.body.style.position="fixed",i.body.style.width=`${o}px`,i.body.style.top=`${a}px`}function s(){if(!i.body.style||!i.body.getBoundingClientRect||!t.scroll)return;const{top:o}=i.body.getBoundingClientRect();i.body.style.removeProperty("overflow"),i.body.style.removeProperty("position"),i.body.style.removeProperty("width"),i.body.style.removeProperty("top"),t.scroll(0,-o)}return(o,a)=>(yt(),Rt("button",{class:Os(["nmd-hamburger",{"nmd-hamburger--dark":o.theme==="dark"}]),onClick:a[0]||(a[0]=l=>Ze(e).show())},[Ut(Ze(qE))],2))}}),PV=Ct({name:"NmdHeroTitle"});({...PV});const LV=Ct({name:"NmdTitleA"});({...LV});const DV=Ct({name:"NmdTitleB"});({...DV});const IV=Ct({name:"NmdTitleC"});({...IV});const BV=Ct({name:"NmdTitleH"});({...BV});const t9=Ct({setup(n,{slots:e}){const t=FV(e);return()=>Za("nav",Za("ul",{class:["nmd-menu__list"]},t))}});function FV(n){n===void 0&&(n={});const e=[],t=(i,r)=>{Array.isArray(i)&&r==="default"&&i.forEach(s=>{typeof s.type=="symbol"&&s.children?t(s.children,"default"):s.type&&s.type.name==="NmdMenuItem"?e.push(s):s.type&&s.type.name==="NmdMenuGroup"&&e.push(Za("li",{class:"nmd-menu__list-item"},s))})};return Object.keys(n).forEach(i=>{if(typeof n[i]!="function")return;const r=n[i]();t(r,i)}),e}const UV={class:"nmd-menu-container"},OV={class:"nmd-menu"},kV=Ct({name:"NmdMenu",components:{NmdIconClose:kE,NmdMenuList:t9}}),VV=Ct({...kV,setup(n){const e=e9();return(t,i)=>(yt(),fl(hg,{name:"nmd-menu"},{default:Sr(()=>[Ze(e).isShown?(yt(),Rt("div",{key:0,class:"nmd-menu-wrapper",onClick:i[1]||(i[1]=CE(r=>Ze(e).hide(),["self"]))},[Ee("div",UV,[Ee("div",OV,[Ee("button",{class:"nmd-menu__button",onClick:i[0]||(i[0]=r=>Ze(e).hide())},[Ut(Ze(kE))]),Ut(Ze(t9),null,{default:Sr(()=>[$r(t.$slots,"default")]),_:3}),i[2]||(i[2]=Ee("a",{href:"https://vip.udn.com/vip/order?from=Newmedia",class:"nmd-subscribe nmd-menu__subscribe",target:"_blank",rel:"noreferrer noopener","data-ga":"subscribe-menu"},"  ",-1))])])])):wr("",!0)]),_:3}))}}),zV={class:"nmd-menu__list-item"},qV=["href"],GV=Ct({name:"NmdMenuItem"});({...GV});const HV=Ct({name:"NmdShareFacebook",components:{NmdIconFacebookSquare:Sk}}),WV={class:"nmd-share-button nmd-shares__nmd-share-button",target:"_blank",rel:"noreferrer noopener"};function $V(n,e,t,i,r,s){const o=tE("nmd-icon-facebook-square");return yt(),Rt("a",WV,[Ut(o)])}const n9=er(HV,[["render",$V]]),jV=Ct({name:"NmdShareLine",components:{NmdIconLineColorful:Uk}}),XV={class:"nmd-share-button nmd-shares__nmd-share-button",rel:"noreferrer noopener"};function QV(n,e,t,i,r,s){const o=tE("nmd-icon-line-colorful");return yt(),Rt("a",XV,[Ut(o)])}const i9=er(jV,[["render",QV]]),YV={class:"nmd-share-button nmd-shares__nmd-share-button",target:"_blank",rel:"noreferrer noopener"},ZV=Ct({name:"NmdShareTwitter",components:{NmdIconTwitter:QE,NmdIconTwitterX:YE}}),r9=Ct({...ZV,props:{twitterIcon:{default:"x"}},setup(n){return(e,t)=>(yt(),Rt("a",YV,[e.twitterIcon==="x"?(yt(),fl(Ze(YE),{key:0})):wr("",!0),e.twitterIcon==="bird"?(yt(),fl(Ze(QE),{key:1})):wr("",!0)]))}}),KV={class:"nmd-shares"},JV=Ct({name:"NmdShare",components:{NmdShareFacebook:n9,NmdShareLine:i9,NmdShareTwitter:r9}}),ez=Ct({...JV,props:{facebook:{default:()=>({href:"https://www.facebook.com/sharer/sharer.php?kid_directed_site=0&sdk=joey&u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&display=popup&ref=plugin&src=share_button"})},line:{default:()=>({href:"https://social-plugins.line.me/lineit/share?url=https%3A%2F%2Fline.me%2Fen",target:"_blank"})},twitter:{default:()=>({href:"https://twitter.com/intent/tweet?text=Hello%20world"})},twitterIcon:{default:"x"}},setup(n){const e=n;return(t,i)=>(yt(),Rt("div",KV,[Ut(Ze(n9),B1({"data-ga":"share-facebook-bottom"},e.facebook),null,16),Ut(Ze(i9),B1({"data-ga":"share-line-bottom"},e.line),null,16),Ut(Ze(r9),B1({"data-ga":"share-twitter-bottom"},e.twitter,{"twitter-icon":e.twitterIcon}),null,16,["twitter-icon"])]))}}),tz={class:"nmd-series__list-item"},nz=["href"],iz={class:"nmd-series__content"},rz={class:"nmd-series__img"},sz=Ct({name:"NmdSeriesItem"});({...sz});const oz=Ct({setup(n,{slots:e}){const{:t,...i}=e,r=Object.entries(i).map(([s,o])=>{let a;return o()[0].type===dp&&(a=o()[0].children.split(/([\s])/).map(A=>{switch(A){case"":case" ":return A;default:return Za("span",A)}})),[Za("div",{class:"author-grid__item"},Za("span",s)),Za("div",{class:"author-grid__item"},a)]});return()=>Za("div",{class:"author-grid"},[r,t?[Za("span",{class:"author-grid__item"}),t()[0]]:null])}}),az=Ct({name:"NmdToTop",components:{NmdIconArrow:OE}}),lz=Ct({...az,props:{duration:{}},setup(n){const e=n,t=UA(),{y:i}=E2(t,{throttle:100}),r=Fi(!0);qs(i,o=>r.value=o===0);const s=()=>{Number.isNaN(e.duration)&&My.scrollTo(t),My.scrollTo(t,{duration:e.duration})};return(o,a)=>(yt(),fl(hg,{name:"nmd-to-top"},{default:Sr(()=>[my(Ee("button",{class:"nmd-to-top","data-ga":"go-top",onClick:s},[Ut(Ze(OE),{width:"40px",height:"40px"})],512),[[wy,!r.value]])]),_:1}))}}),uz={class:"nmd-footer"},cz={class:"nmd-footer__links"},hz={href:"https://bit.ly/317wi2M",target:"_blank",rel:"noreferrer noopener","aria-label":"udn's facebook",title:"udn's facebook","data-ga":"udn-facebook"},fz={href:"https://bit.ly/2Q6gas5",target:"_blank",rel:"noreferrer noopener","aria-label":"udn's instagram",title:"udn's instagram","data-ga":"udn-instagram"},Az={href:"https://bit.ly/3hchIwv",target:"_blank",rel:"noreferrer noopener","aria-label":"udn's youtube",title:"udn's youtube","data-ga":"udn-youtube"},dz={href:"https://bit.ly/2XP6XZq",target:"_blank",rel:"noreferrer noopener","aria-label":"udn's line",title:"udn's line","data-ga":"udn-line"},pz={class:"nmd-footer__copyright"},mz=Ct({components:{NmdIconFacebookCircle:VE,NmdIconInstagram:GE,NmdIconLine:WE,NmdIconYoutube:ZE}}),gz=Ct({...mz,__name:"index",setup(n){const e=new Date().getFullYear();return(t,i)=>(yt(),Rt("div",uz,[Ee("div",cz,[Ee("a",hz,[Ut(Ze(VE))]),Ee("a",fz,[Ut(Ze(GE))]),Ee("a",Az,[Ut(Ze(ZE))]),Ee("a",dz,[Ut(Ze(WE))])]),i[0]||(i[0]=Ee("div",{class:"nmd-footer__nav"},[Ee("a",{class:"footer__link",href:"https://vip.udn.com?from=footer_Newmedia",target:"_blank",rel:"noreferrer noopener"},""),Zs("  "),Ee("a",{class:"footer__link",href:"http://www.udngroup.com/members/udn_privacy?from=footer_Newmedia",target:"_blank",rel:"noreferrer noopener"},""),Zs("  "),Ee("a",{class:"footer__link",href:"http://www.udngroup.com/members/service?from=footer_Newmedia",target:"_blank",rel:"noreferrer noopener"},"")],-1)),Ee("div",pz,"   2020-"+Ft(Ze(e))+" All Rights Reserved ",1)]))}}),_z=Ct({});({..._z});const vz={class:"nmd-quote"},yz=["src"],xz={class:"quote"},bz={class:"quote-title"},Tz=Ct({});({...Tz});const Sz={key:0,width:"56",height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},wz={key:1,width:"56",height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Mz={key:2,width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ez={key:3,width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Cz={key:4,width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Rz={key:5,width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Nz={key:6,width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Pz={key:7,width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Lz=Ct({});({...Lz});const Dz={class:"nmd-single-graphics"},Iz=["src"],Bz={class:"graphics-text"},Fz=Ct({});({...Fz});const Uz={class:"nmd-pair-graphics"},Oz=["src"],kz=["src"],Vz={class:"graphics-text"},zz=Ct({});({...zz});const qz=Ct({name:"NmdDigitalLogo"}),Gz={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 181 20",fill:"none"};function Hz(n,e,t,i,r,s){return yt(),Rt("svg",Gz,e[0]||(e[0]=[w2('<path d="M75.2998 9.18523C75.1248 9.10098 71.7924 9.69914 70.909 9.74969C68.0927 9.93503 65.8623 9.0757 64.1218 8.24165C62.4949 7.44972 61.3229 6.19442 60.2208 4.9307C59.9672 4.63584 59.5648 4.40837 59.3637 4.0798C59.0138 3.49849 59.0838 2.43697 58.6202 1.94833L58.2966 1.75456L57.7631 1.71243L57.5969 1.80511C56.7135 2.24319 56.3374 3.60801 55.7251 4.31569C54.2732 5.9838 52.3402 7.40759 50.486 8.72186C49.3489 9.53064 48.0982 9.80866 46.209 10.0024C45.6754 10.053 44.8882 10.2636 44.1798 10.1372C43.62 10.0361 42.1243 9.32002 41.722 9.00831C41.5208 8.84823 41.4509 8.58707 41.2322 8.44384C40.9436 8.24165 40.4625 8.28377 40.1651 8.44384C39.6316 8.73029 39.3517 9.59804 39.2555 10.2383C39.1418 11.005 39.4042 11.6874 39.5179 12.2771C39.5966 12.6731 39.5704 13.0859 39.789 13.3639C40.8474 14.7456 43.7512 13.8526 45.3518 13.5577C45.7104 13.4819 46.3751 13.2039 46.8475 13.4145C47.3722 13.6419 46.9174 14.9478 46.795 15.2595C46.5238 15.9251 46.4101 17.5089 47.1011 17.8459L47.6171 17.9554C49.209 18.402 50.8184 17.8206 52.4627 17.6353C53.9409 17.4668 58.9351 17.3826 59.9322 17.4752C61.5328 17.6437 62.8798 17.7027 64.4454 17.9554C65.2763 18.0902 66.7982 18.5115 67.874 18.1913C69.5358 17.7027 67.909 14.9562 68.6787 13.8357L68.7224 13.7936C69.2472 13.4229 69.7108 13.8526 70.3842 13.8357C71.2327 13.8189 72.7283 13.583 73.3231 13.2207C73.7691 12.9595 74.1627 12.3361 74.5563 11.9991C74.775 11.7969 76.1569 9.58119 75.2998 9.20208V9.18523ZM55.4103 7.67719C55.7164 7.39074 56.2762 6.76731 56.7485 6.68306C58.0779 6.43032 58.8826 7.75301 59.4774 8.25007L59.3637 8.53652C58.4191 8.64604 55.5415 9.1431 54.6581 8.73029L54.5006 8.3933C54.7543 8.11528 55.1304 7.93836 55.4103 7.68561V7.67719ZM64.5591 15.0994L64.2355 15.4785C63.3958 15.7903 62.0139 15.5207 61.3929 15.4448C60.0809 15.3016 59.3724 15.5038 57.8243 15.4448C56.3811 15.3943 54.7193 15.4954 53.3111 15.7144C52.6551 15.8155 51.5268 15.8829 50.9233 15.6639C50.3723 15.4785 50.6434 14.4928 50.967 14.2485C51.4831 13.8694 53.4336 13.8863 54.3344 13.8189C55.4802 13.743 56.7747 13.6841 57.8155 13.7093C59.906 13.7515 62.8448 13.4397 64.2792 14.2991C64.5329 14.4507 64.664 14.754 64.5503 15.0994H64.5591ZM62.0488 11.7885C60.0109 11.9233 57.9467 11.7379 55.7864 11.8812C54.5181 11.9654 51.9904 12.3193 50.8621 11.9823H50.7571C49.8912 11.4936 51.2032 10.7944 51.6143 10.55L52.314 10.272C52.6376 10.2552 52.9175 10.7607 53.1712 10.7944C54.142 10.9544 55.419 10.5922 56.4861 10.6933C56.7747 10.7185 60.5357 10.3647 60.5532 10.3647C60.8593 10.2467 61.1567 9.74969 61.4628 9.69914C61.8914 9.61489 64.5241 11.1819 64.6378 11.6537C64.7778 12.176 62.9847 11.7211 62.0488 11.7801V11.7885Z" fill="white" data-v-de8f7c19></path><path d="M116.199 14.4342C115.569 14.2994 114.948 14.5859 114.484 14.628C113.286 14.7544 111.983 14.8723 110.959 14.7038C108.545 14.2994 106.429 13.4485 104.566 12.6398C104.111 12.4376 103.28 11.7889 103.193 11.6878V11.2244C103.665 10.3819 105.948 11.0053 107.006 10.7779C107.645 10.6431 108.266 10.4577 108.93 10.3903C109.438 10.3482 110.102 10.4156 110.47 10.2387C111.624 9.68266 109.997 7.48378 108.58 7.91345C107.994 8.09037 107.601 8.46949 107.102 8.61271C106.184 8.87388 103.674 9.40464 104.644 8.08194C104.942 7.66913 105.178 7.55961 105.668 7.29001C106.271 6.96987 107.085 6.56548 107.828 6.40541C108.397 6.27061 109 6.28746 109.473 6.06842C109.901 5.86622 110.513 5.03217 110.548 4.54353C110.592 3.76845 108.843 3.91167 107.924 4.02119C106.936 4.12229 105.703 4.32449 104.505 4.22339C103.385 4.13072 100.84 3.19556 99.5977 3.48201C99.3179 3.54098 99.1692 3.89482 98.9767 4.03804C98.7756 4.18969 98.347 4.33291 98.2945 4.59408C98.2071 5.04902 98.3382 5.68088 98.3732 6.19479C98.4345 7.08782 98.0584 6.75083 97.4024 6.54021C96.7289 6.32116 95.7318 6.37171 94.8396 6.46438L94.551 6.52336C93.9912 6.59076 93.0729 6.79295 92.3906 6.675C92.0495 6.6076 91.9621 6.08527 91.9883 6.08527C92.102 5.7567 92.0845 5.15012 92.4344 5.01532C92.6355 4.94792 92.8454 4.98162 93.1253 4.96477C94.7085 4.85525 95.8717 4.78785 96.4228 3.87797C96.6152 3.55783 96.5102 2.87542 96.1341 2.78275C94.9184 2.47946 93.6326 3.5831 92.4868 3.17871C91.6384 2.87542 92.1982 1.85602 92.2594 1.62013C92.5743 0.524903 91.9008 0.263734 90.7026 0.347982C89.8104 0.406955 89.9416 0.567027 89.5918 1.04724C89.4168 1.27471 89.2332 3.20399 89.4168 2.87542C88.8745 3.80215 86.7142 2.6311 85.2535 2.95967C84.8337 3.06077 84.51 3.77687 84.2302 4.02962C83.9503 4.28236 83.5654 4.64463 83.8453 5.09114C84.1514 5.56293 84.65 5.46183 85.3235 5.35231C86.4693 5.17539 89.5918 4.771 89.4256 5.91677C89.3644 6.34644 89.4168 6.78453 88.927 6.88562C87.4751 7.16364 84.5625 7.05412 83.0581 6.93617C82.3234 6.86877 81.6587 6.46438 80.8365 6.54021C80.373 6.57391 79.8569 6.83507 79.5945 7.05412C79.1659 7.39954 78.7549 8.12407 78.5187 8.57901C78.335 8.92442 78.5187 9.37094 78.9735 9.40464C79.4108 9.42991 79.8307 9.11819 80.2243 9.06765C81.7462 8.84018 83.7666 8.28414 85.6296 8.61271C85.9882 8.67168 86.2244 9.29511 86.0407 9.62368C85.9357 9.8006 85.341 9.9017 85.0698 9.95225C83.8191 10.1544 82.1135 9.53943 81.2039 10.2134C80.819 10.4914 80.6616 10.7442 80.5829 11.2749L80.5304 11.553C80.6004 11.8226 81.0639 11.9237 81.5013 11.9152C82.2097 11.8815 83.0056 11.6372 83.7141 11.5698C84.9124 11.4603 85.927 11.4603 87.134 11.4603C87.5888 11.4603 88.2448 11.376 88.6209 11.494C88.8221 11.5614 88.9095 11.7383 88.962 11.9573C89.0495 12.2859 88.997 12.6566 88.7958 12.8757C88.411 13.2885 84.1339 13.1284 83.1019 13.1958C81.4575 13.3053 80.8278 12.9009 79.9181 13.735C79.5595 14.0467 79.542 14.1731 79.8657 14.5101C80.0843 14.746 80.338 15.0577 80.7228 15.1503C82.1485 15.4873 84.5888 14.8639 85.8483 14.6954C86.2419 14.6364 88.5684 14.3416 88.8046 14.687C88.9445 14.8892 88.8308 15.2093 88.7521 15.3694C87.9299 17.1386 77.6703 15.6643 79.5508 18.4697C79.7782 18.7983 80.2505 19.2953 80.6966 19.4217C82.3759 19.9272 83.7753 19.0342 84.8424 18.7477C86.8016 18.2254 89.3731 18.3518 90.5276 17.2228C90.895 16.8606 91.0962 16.2456 91.1399 15.6558C91.1749 15.3188 91.1749 14.5522 91.2011 14.5353C91.4548 14.4679 91.5422 14.5522 91.8134 14.5522C93.5627 14.5438 95.1283 15.0914 96.0292 14.1478L96.3703 13.8361C97.1312 12.0921 92.1982 13.5328 91.2099 12.9094C91.3148 12.4628 91.1749 11.5782 91.6209 11.3929C92.7143 10.9127 95.9592 12.1595 96.5715 10.938C96.7027 10.6768 96.6939 10.4662 96.5102 10.2471C95.8805 9.45519 95.0321 9.82588 94.1749 9.34566C94.2099 9.00867 94.4198 8.46948 94.9009 8.37681C95.5831 8.25044 96.1779 8.43579 96.8338 8.36839C97.2099 8.31784 97.7697 8.0314 98.1983 8.12407C98.7406 8.23359 98.6619 10.6768 98.5919 11.2328C98.3382 13.1031 96.7814 17.8126 98.1808 19.2448C98.8368 19.9272 100.682 19.8851 100.332 18.6382C100.149 17.9642 99.9039 13.6507 100.595 13.3727C100.988 13.2126 101.05 13.3137 101.373 13.4148C102.117 13.676 102.711 14.4764 103.21 14.9734C103.822 15.58 105.747 16.8859 106.639 17.2397C107.024 17.3829 108.738 18.5792 109.403 18.8151C110.12 19.0763 110.968 18.7056 111.44 18.554C112.543 18.1833 114.344 16.65 115.175 15.976C115.464 15.7317 115.796 15.5295 116.076 15.2767C116.269 15.1166 116.785 14.5775 116.19 14.4511L116.199 14.4342ZM92.6443 8.92442C92.4344 9.11819 92.0233 9.40464 91.6822 9.48046C91.1749 9.59841 88.0524 9.7669 87.5801 9.55628C87.169 9.38779 87.6063 8.7812 87.7987 8.64641C88.1748 8.35154 89.1807 8.24202 89.8454 8.21674C90.4402 8.19147 91.1224 8.21674 91.7259 8.19147C92.6093 8.15777 93.379 8.19147 92.6355 8.92442H92.6443ZM101.137 9.72478C100.717 9.77533 100.726 9.78375 100.656 9.55628C100.586 9.31196 100.962 6.27904 101.05 6.24534C101.434 6.07684 103.026 6.01787 103.499 5.9926C104.006 5.9589 104.163 6.05999 104.417 6.21164C104.233 7.03727 103.551 7.58488 103.289 8.34311C103.184 8.64641 103.367 8.93285 103.184 9.16032C102.974 9.41306 101.531 9.68266 101.137 9.72478Z" fill="white" data-v-de8f7c19></path><path d="M30.9461 12.5384C30.9811 12.1003 30.9461 11.6622 31.1211 11.5106C31.4534 11.1904 32.1357 11.4347 32.9491 11.5443C33.3777 11.5948 33.6925 11.9402 34.3048 11.8307C35.9054 11.5695 32.8266 8.34285 32.7217 7.59304C32.5555 6.29562 34.8033 7.26447 35.0395 6.39672C35.3719 5.14985 34.1299 4.60224 33.6838 4.00408C33.0628 3.1616 31.882 -0.0987971 30.57 0.00230044C30.3339 0.0275748 30.0278 0.196071 29.8353 0.305593C28.777 0.870054 28.1997 1.65356 27.465 2.49604C27.2289 2.78248 26.8266 2.96783 26.5729 3.25427C26.223 3.63339 25.2259 5.45314 24.8236 5.55424H24.3688C23.3979 5.3689 22.4533 0.979577 20.8177 0.709983C20.4329 0.642585 20.0305 0.743683 19.8031 0.853205C18.4999 1.46822 17.494 3.00153 16.3045 3.84401C16.0596 4.02093 15.8934 4.2821 15.5698 4.40004C15.185 4.54327 14.5552 4.62751 14.2229 4.54327L14.1092 4.29895L14.1616 4.19785C14.1616 3.35537 14.1616 2.63084 13.6019 2.30227C12.7884 1.83891 11.5115 2.18432 10.4969 2.26015C10.0071 2.28542 9.61346 2.12535 9.25486 2.10007C8.57263 2.05795 7.84667 2.26857 7.05074 2.20117C5.99242 2.1085 4.72418 2.08323 3.61337 1.99898C2.52006 1.93158 1.95154 2.03268 1.40926 2.55501C1.21684 2.74878 0.945695 2.9931 0.788258 3.20372C0.455892 3.67551 0.762019 5.86596 0.840737 6.49782C0.971935 7.52564 0.700794 8.75566 0.613329 9.79191C0.543357 10.6512 0.167258 11.1315 0.0535535 11.8307C-0.156362 13.0944 0.280962 14.1981 0.840737 14.8299L1.12937 15.0321C1.3043 15.0995 1.70664 15.1164 1.96903 15.0743C2.60753 15.0069 11.6864 13.145 9.97207 15.0743C9.76215 15.3102 9.38605 15.5461 9.07118 15.6808C8.46767 15.9252 7.68924 15.8578 6.92829 15.9757C5.46763 16.2032 3.11482 16.0937 2.08274 16.7255L1.96903 16.7761C1.63667 16.9446 1.21684 17.2984 1.00692 17.5764C0.779512 17.8881 0.403413 19.7921 1.00692 19.9691C1.33929 20.0702 1.73288 19.8932 1.96903 19.868C3.90201 19.691 5.13526 19.253 6.64841 18.8654C8.04784 18.5032 9.43853 18.4526 10.6018 17.9218C11.3015 17.5933 12.1587 16.7676 12.5698 16.1695C13.0246 15.5124 13.6281 14.5098 13.7506 13.6757C13.803 13.3303 13.6456 12.9091 13.7506 12.5805L13.8643 12.4205C14.0567 12.2857 14.6864 12.2857 15.045 12.3194C17.669 12.6142 15.2987 13.9285 14.7651 14.4677L14.4853 14.8721C13.8643 16.0852 15.4649 17.9892 16.3395 17.1636C16.978 16.557 16.5932 15.2006 16.5057 14.2234L16.5582 13.8695C16.6369 13.4146 16.5844 12.9175 16.7331 12.4205C16.908 11.8644 18.5524 11.9487 19.0422 11.9739C19.7506 12.0161 20.5728 11.9402 21.1238 12.1677C21.7711 12.4373 20.4766 14.0127 20.223 14.4677C19.9168 15.0237 19.3658 15.9252 19.8294 16.7171C20.4241 17.7618 21.6836 17.0709 21.8585 16.1695C22.0335 15.268 21.6836 14.3329 21.7448 13.4314C21.8061 12.5721 22.1297 12.0329 22.9256 11.8223C23.5116 11.6706 24.4213 11.7212 25.2434 11.8813C26.433 12.1256 24.8936 13.6083 24.7974 13.979C24.4125 15.4281 24.4213 17.2563 24.5087 17.4669C24.7186 17.9303 25.5583 18.2841 26.2056 17.8713C27.1677 17.2394 26.4417 13.8779 26.2668 12.8754C26.2056 12.5805 25.8207 11.9318 26.1006 11.5358C26.3018 11.2157 28.0948 11.3842 28.6371 11.3842C28.0423 11.401 29.4505 11.3674 29.5904 11.3842C30.9549 11.519 30.1677 13.1029 29.8703 13.7768C29.4855 14.6699 28.7945 18.1914 30.2639 18.4695C30.5788 18.5369 30.8937 18.3936 31.1036 18.3684C31.8383 18.2841 32.0832 18.1409 32.5205 17.8292C33.5089 17.0878 33.85 15.7314 34.8296 14.9732C35.022 14.8299 35.6605 14.4677 35.7655 14.2739C36.5002 12.9681 30.7712 14.6783 30.9112 12.53L30.9461 12.5384ZM10.3307 12.0919C9.59597 12.4963 6.47348 12.0919 5.25771 12.2435C4.87287 12.2857 4.27811 12.6395 3.72708 12.4963C3.25477 12.3531 3.44719 11.2578 3.7883 11.0978C4.47928 10.7523 5.94869 10.7692 6.83208 10.6934C7.74172 10.6175 10.0333 10.8029 10.3919 11.241C10.5668 11.4769 10.6455 11.915 10.3307 12.0919ZM10.1645 9.4465C9.62221 9.55602 8.93124 9.47177 8.47642 9.4465C6.99826 9.3454 5.2927 9.4128 3.96323 9.58972C3.77081 9.3454 3.72708 9.3117 3.84953 8.99156C4.03321 8.51977 4.33933 8.44395 4.92535 8.34285C5.59883 8.20805 6.63091 8.07326 7.4006 8.03956C8.10032 8.02271 10.252 8.21648 10.5056 8.54504C10.768 8.87361 10.5231 9.36225 10.1645 9.4465ZM10.8467 6.1524L10.5056 6.54837C9.46477 6.86008 8.03035 6.3883 6.89331 6.49782C6.30729 6.55679 5.38891 6.91063 4.63671 6.70001C4.30435 6.59892 4.30435 6.11028 4.34808 5.79856C4.41805 5.39417 4.5405 4.9982 4.9166 4.89711C5.24022 4.81286 10.4356 5.17513 10.7155 5.3015C11.0304 5.42787 10.9429 5.89123 10.8292 6.1524H10.8467ZM16.0771 8.57874C15.8147 9.20218 15.1762 9.93513 14.5115 10.1458C13.2258 10.5333 13.5844 8.26703 14.0042 8.14908C14.3628 8.03956 14.8614 8.21648 15.1325 8.24175C15.6136 8.30072 15.806 8.34285 16.0946 8.55347V8.58717L16.0771 8.57874ZM19.1209 10.2384C18.2288 10.3311 17.739 10.3227 17.5903 10.0362C17.3104 9.46335 18.3075 8.2586 19.0072 8.1912C20.809 8.01428 21.7448 9.94356 19.1209 10.2384ZM17.7127 6.14398C17.2666 5.96706 17.6515 5.49527 17.8264 5.29307C18.0276 5.05718 18.2812 4.85498 18.4999 4.64436C18.7186 4.42532 19.2084 4.08833 19.5757 4.0462C20.1705 3.97038 21.1763 4.96451 21.0451 5.49527C20.9577 5.85753 18.3512 6.37987 17.7215 6.14398H17.7127ZM25.2085 9.08423C24.8936 9.43807 24.5437 10.4153 23.9664 10.4827L23.8003 10.4322C23.5379 10.3648 23.3717 10.3058 23.2317 10.1373C22.8994 9.72451 22.8469 9.22745 22.6107 8.73881C22.4358 8.37655 21.6924 8.03956 21.7623 7.53407C21.8585 6.93591 23.4154 6.93591 24.1326 6.88536C24.9461 6.83481 25.5496 7.037 26.1093 7.18865C26.5904 7.31502 26.9403 7.3066 26.9053 7.70256C26.8703 8.09853 25.5321 8.73039 25.2085 9.08423ZM29.2756 3.04365C30.2464 2.87516 31.4272 3.88613 31.2435 4.59381C31.1561 4.93081 30.0977 5.20882 29.7216 5.3015C28.812 5.50369 28.1823 5.41944 27.9723 5.2004C27.4476 4.63594 28.8557 3.1279 29.2668 3.04365H29.2756ZM30.6575 9.21903C30.5875 9.46335 30.2202 9.58129 29.6692 9.64027C28.6458 9.74136 28.0948 9.70767 27.9636 9.39595C27.7099 8.78936 28.7858 7.56777 29.0482 7.53407C29.5292 7.47509 30.8324 8.57032 30.6575 9.21903Z" fill="white" data-v-de8f7c19></path><path d="M135.388 14.1954V14.5661L136.507 14.4987L136.49 15.1727L135.3 15.2401C135.134 16.0573 134.714 16.9166 133.612 17.7338C134.434 18.0877 135.186 18.4583 135.764 18.7785L135.143 19.3261C134.574 18.9723 133.787 18.5847 132.904 18.1972C131.749 18.8122 130.113 19.4188 127.726 19.8737C127.656 19.6799 127.472 19.4356 127.323 19.2755C129.475 18.8712 130.979 18.3741 132.046 17.8265C131.058 17.4221 129.991 17.0346 129.02 16.7818C129.335 16.4111 129.667 16.0067 129.991 15.5434L127.551 15.6697L127.437 14.9452C128.303 14.9115 129.344 14.8778 130.489 14.802C130.857 14.2881 131.189 13.7573 131.46 13.2434H128.303V10.539H131.88V9.67128H128.828V7.69145H127.656V6.98377H128.828V5.16401H131.88V3.85817H132.632V5.16401H135.869V6.98377H137.137V7.69145H135.869V9.67128H132.632V10.539H136.341V13.2434H132.352C132.099 13.7405 131.766 14.2544 131.452 14.7683C132.44 14.7177 133.525 14.6588 134.609 14.6082C134.627 14.465 134.627 14.3218 134.627 14.2038V13.6394H135.396V14.2038L135.388 14.1954ZM129.073 12.5863H131.863V11.2046H129.073V12.5863ZM129.606 5.82957V7.00062H131.863V5.82957H129.606ZM131.863 8.9973V7.6746H129.606V8.9973H131.863ZM130.927 15.4928C130.673 15.8298 130.454 16.15 130.21 16.4448C131.058 16.6891 131.95 17.0261 132.799 17.38C133.848 16.6891 134.285 15.9646 134.487 15.2906L130.927 15.4844V15.4928ZM132.615 5.838V7.00904H135.038V5.838H132.615ZM135.038 9.00572V7.68303H132.615V9.00572H135.038ZM132.615 11.213V12.5947H135.519V11.213H132.615ZM142.603 8.09584C142.253 10.7834 141.764 13.0833 140.933 14.9958C141.737 16.7818 142.787 18.1972 144.125 19.0481C143.924 19.1913 143.688 19.4525 143.539 19.6884C142.271 18.8206 141.283 17.5316 140.513 15.9056C139.682 17.5485 138.606 18.8796 137.154 19.9748C137.067 19.8147 136.787 19.4609 136.621 19.3008C138.178 18.2225 139.297 16.7734 140.093 14.9873C139.428 13.395 138.956 11.5584 138.606 9.59546C138.274 10.4969 137.889 11.3141 137.469 12.0049C137.32 11.8617 136.971 11.6006 136.769 11.4742C137.976 9.65443 138.737 6.8911 139.21 4.04351L140.032 4.16989C139.831 5.24826 139.595 6.30979 139.332 7.33761H143.924V8.11269H142.603V8.09584ZM139.096 8.12954C139.411 10.2357 139.848 12.2324 140.495 13.9679C141.116 12.2661 141.501 10.3031 141.781 8.09584H139.122L139.105 8.12954H139.096Z" fill="white" data-v-de8f7c19></path><path d="M151.35 4.12766C150.816 5.45035 150.143 6.74777 149.382 7.96937V19.8399H148.498V9.30891C147.799 10.303 147.064 11.2045 146.277 11.9459C146.207 11.769 145.909 11.3477 145.726 11.1876C147.632 9.40158 149.417 6.68037 150.501 3.90019L151.341 4.12766H151.35ZM162.423 18.2982V19.1154H150.93V18.2982H157.411C158.128 15.8718 158.915 11.9122 159.335 9.20781L160.254 9.38474C159.755 12.1481 158.95 15.8803 158.251 18.2982H162.423ZM161.6 8.00307H151.796V7.16901H161.6V8.00307ZM154.437 17.2703C154.253 15.4169 153.702 12.0722 153.081 9.56166L153.886 9.40158C154.525 11.9459 155.119 15.2231 155.32 17.026L154.437 17.2703ZM156.493 6.81517C156.326 6.07379 155.941 4.90274 155.609 4.00129L156.414 3.77382C156.746 4.67527 157.166 5.82947 157.332 6.57085L156.484 6.81517H156.493Z" fill="white" data-v-de8f7c19></path><path d="M169.271 4.28781H170.101V10.1093H166.244V11.1877C166.244 11.6258 166.244 12.106 166.227 12.5525H170.084V19.8568H169.262V13.3276H166.209C166.113 15.695 165.824 18.0708 164.958 20.0001C164.81 19.84 164.477 19.6294 164.259 19.5198C165.273 17.1103 165.413 13.9847 165.413 11.2046V3.84972H166.235V9.31741H169.262V4.28781H169.271ZM180.212 9.38481C179.714 12.3251 178.69 14.6587 177.326 16.4279C178.297 17.6495 179.513 18.5678 180.982 19.1323C180.781 19.3092 180.518 19.6294 180.361 19.84C178.927 19.225 177.755 18.2814 176.801 17.1188C175.717 18.3404 174.483 19.2418 173.163 19.8821C173.058 19.6715 172.795 19.3513 172.629 19.1913C173.95 18.6268 175.218 17.6917 176.268 16.4111C175.096 14.6924 174.3 12.5357 173.766 10.0419H173.084V11.3646C173.084 14.2291 172.883 17.4136 171.527 19.8568C171.361 19.7305 171.046 19.503 170.81 19.3935C172.078 17.0766 172.244 14.0016 172.244 11.3646V4.92809H180.247V5.72002H173.084V9.24159H179.513L179.679 9.20789L180.212 9.38481ZM174.553 10.0419C175.034 12.2155 175.752 14.1617 176.81 15.7371C177.93 14.2375 178.778 12.3251 179.233 10.0419H174.553Z" fill="white" data-v-de8f7c19></path>',6)]))}const Wz=er(qz,[["render",Hz],["__scopeId","data-v-de8f7c19"]]),$z=["href"],jz=["href"],Xz=Ct({name:"NmdDigitalHeader"});({...Xz});const Qz={class:"nmd-service","data-ga":"section-web_features"},Yz={class:"nmd-service-container"},Zz=Ct({name:"NmdService"});({...Zz});const Kz={class:"nmd-service-arrow-circle"},Jz={key:0,class:"nmd-service-svg",width:"43px",height:"43px",viewBox:"0 0 100 100"},eq=Ct({name:"NmdServiceArrowCircle",components:{NmdIconArrowRight:KE}}),s9=Ct({...eq,props:{hover:{type:Boolean,default:!0}},setup(n){return(e,t)=>(yt(),Rt("span",Kz,[Ut(Ze(KE),{class:"nmd-service-arrow"}),e.hover?(yt(),Rt("svg",Jz,t[0]||(t[0]=[Ee("circle",{class:"nmd-service-circle",cx:"50",cy:"50",r:"48","stroke-width":"3",fill:"none"},null,-1)]))):wr("",!0)]))}}),tq={class:"nmd-service-list"},nq=["href"],iq={class:"nmd-service-card-header"},rq={class:"nmd-service-card-title"},sq={class:"nmd-service-card-content"},oq=[{title:"",content:"",href:"https://vip.udn.com/member/mynews/epaper"},{title:"",content:"",href:"https://vip.udn.com/vip/story/122037/6208772"},{title:"",content:"",href:"https://vip.udn.com/vip/story/122037/7480959"},{title:"",content:"",href:"https://vip.udn.com/vip/story/122037/8502671"},{title:"",content:"",href:"https://vip.udn.com/vip/story/122037/8357783"},{title:"",content:"",href:"https://reading.udn.com/store/store/store_search.do?k_type=b&k=%E8%81%AF%E5%90%88%E5%A0%B1%E6%96%B0%E8%81%9E%E9%83%A8"}],aq=Ct({name:"NmdServiceList",components:{NmdServiceArrowCircle:s9}});({...aq});const lq="",uq="",cq="",p4={metaTitle:lq,metaDesc:uq,metaURL:cq};function hq(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}const fq=p4.metaTitle,Aq=p4.metaDesc,dq=p4.metaURL,pq=encodeURI(fq),mq=encodeURI(Aq),bd=encodeURI(dq),gq=`${pq}%0D%0A%0D%0A${mq}`,o9=hq()?`https://line.naver.jp/R/msg/text/?${bd}`:`https://social-plugins.line.me/lineit/share?url=${bd}`,a9=`https://www.facebook.com/dialog/share?app_id=1010324812347164&display=popup&href=${bd}&redirect_uri=${bd}`,l9=`https://twitter.com/intent/tweet/?text=${gq}%0D%0A%0D%0A${bd}`,_q={class:"ls-header"},vq={__name:"leo-header",setup(n){return(e,t)=>(yt(),Rt("div",_q,[Ut(Ze(pV)),Ut(Ze(bV),null,{default:Sr(()=>[Ut(Ze(CV),{facebook:{href:Ze(a9)},line:{href:Ze(o9),target:"_blank"},twitter:{href:Ze(l9)}},null,8,["facebook","line","twitter"]),Ut(Ze(NV))]),_:1}),Ut(Ze(VV))]))}},yq="",xq="",bq="",Tq="",Sq="",wq="",Mq="",Eq="2025",yu={editor1:yq,editor2:xq,editor3:bq,editor4:Tq,editor5:Sq,editor6:wq,editor7:Mq,editor8:Eq},Cq={class:"leo-footer"},Rq={class:"leo-footer__info"},Nq={__name:"leo-footer",setup(n){const e=new Date().getFullYear();return(t,i)=>(yt(),Rt("div",Cq,[Ee("div",Rq,[Ut(Ze(oz),null,{:Sr(()=>[Zs(Ft(Ze(yu).editor1),1)]),:Sr(()=>[Zs(Ft(Ze(yu).editor2),1)]),:Sr(()=>[Zs(Ft(Ze(yu).editor3),1)]),:Sr(()=>[Zs(Ft(Ze(yu).editor4),1)]),:Sr(()=>[Zs(Ft(Ze(yu).editor5),1)]),:Sr(()=>[Zs(Ft(Ze(yu).editor6),1)]),:Sr(()=>[Zs(Ft(Ze(yu).editor7),1)]),:Sr(()=>[Zs(Ft(Ze(yu).editor8),1)]),_:1}),Ut(Ze(ez),{facebook:{href:Ze(a9)},line:{href:Ze(o9),target:"_blank"},twitter:{href:Ze(l9)},"twitter-icon":"x"},null,8,["facebook","line","twitter"])]),Ut(Ze(lz)),Ut(Ze(gz),{year:Ze(e)},null,8,["year"])]))}};/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const gp="176",na={ROTATE:0,DOLLY:1,PAN:2},Ef={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},u9=0,Ey=1,c9=2,Pq=0,m4=1,Lq=2,wo=3,oo=0,wi=1,ar=2,Do=0,Gs=1,uh=2,iA=3,rA=4,$f=5,gs=100,g4=101,_4=102,h9=103,f9=104,Ul=200,v4=201,y4=202,x4=203,Td=204,Sd=205,b4=206,T4=207,S4=208,w4=209,M4=210,Dq=211,Iq=212,Bq=213,Fq=214,wd=0,Md=1,Ed=2,Ju=3,Cd=4,Rd=5,Nd=6,Pd=7,_p=0,A9=1,d9=2,ao=0,p9=1,m9=2,g9=3,_9=4,Uq=5,v9=6,y9=7,E4=300,Pa=301,La=302,ch=303,hh=304,fh=306,Ah=1e3,il=1001,dh=1002,Ui=1003,C4=1004,$l=1005,Lr=1006,jf=1007,to=1008,Oq=1008,Ji=1009,Kc=1010,Jc=1011,xa=1012,qr=1013,Ni=1014,mr=1015,Dr=1016,C2=1017,R2=1018,Io=1020,N2=35902,R4=1021,vp=1022,ur=1023,Bo=1026,Fo=1027,yp=1028,OA=1029,jl=1030,kA=1031,kq=1032,VA=1033,eh=33776,Wu=33777,$u=33778,ju=33779,Ld=35840,Dd=35841,Id=35842,Bd=35843,Fd=36196,sA=37492,oA=37496,aA=37808,lA=37809,uA=37810,cA=37811,hA=37812,fA=37813,AA=37814,dA=37815,pA=37816,mA=37817,gA=37818,_A=37819,vA=37820,yA=37821,th=36492,Cy=36494,Ry=36495,N4=36283,Ud=36284,Od=36285,kd=36286,Vq=0,zq=1,x6=2,qq=3200,Gq=3201,Jl=0,x9=1,Po="",Zt="srgb",Ma="srgb-linear",dg="linear",hi="srgb",Hq=0,Uc=7680,Wq=7681,$q=7682,jq=7683,Xq=34055,Qq=34056,Yq=5386,Zq=512,Kq=513,Jq=514,eG=515,tG=516,nG=517,iG=518,Ny=519,P4=512,P2=513,L4=514,L2=515,D4=516,I4=517,B4=518,F4=519,pg=35044,Cf=35048,b6="300 es",zs=2e3,Al=2001;class xl{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners;if(i===void 0)return;const r=i[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const i=t[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const cs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let T6=1234567;const td=Math.PI/180,ph=180/Math.PI;function sl(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(cs[n&255]+cs[n>>8&255]+cs[n>>16&255]+cs[n>>24&255]+"-"+cs[e&255]+cs[e>>8&255]+"-"+cs[e>>16&15|64]+cs[e>>24&255]+"-"+cs[t&63|128]+cs[t>>8&255]+"-"+cs[t>>16&255]+cs[t>>24&255]+cs[i&255]+cs[i>>8&255]+cs[i>>16&255]+cs[i>>24&255]).toLowerCase()}function In(n,e,t){return Math.max(e,Math.min(t,n))}function U4(n,e){return(n%e+e)%e}function rG(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function sG(n,e,t){return n!==e?(t-n)/(e-n):0}function nd(n,e,t){return(1-t)*n+t*e}function oG(n,e,t,i){return nd(n,e,1-Math.exp(-t*i))}function aG(n,e=1){return e-Math.abs(U4(n,e*2)-e)}function lG(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function uG(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function cG(n,e){return n+Math.floor(Math.random()*(e-n+1))}function hG(n,e){return n+Math.random()*(e-n)}function fG(n){return n*(.5-Math.random())}function AG(n){n!==void 0&&(T6=n);let e=T6+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function dG(n){return n*td}function pG(n){return n*ph}function mG(n){return(n&n-1)===0&&n!==0}function gG(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function _G(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function vG(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+i)/2),A=o((e+i)/2),p=s((e-i)/2),g=o((e-i)/2),v=s((i-e)/2),y=o((i-e)/2);switch(r){case"XYX":n.set(a*A,l*p,l*g,a*u);break;case"YZY":n.set(l*g,a*A,l*p,a*u);break;case"ZXZ":n.set(l*p,l*g,a*A,a*u);break;case"XZX":n.set(a*A,l*y,l*v,a*u);break;case"YXY":n.set(l*v,a*A,l*y,a*u);break;case"ZYZ":n.set(l*y,l*v,a*A,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Vs(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Fn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const xA={DEG2RAD:td,RAD2DEG:ph,generateUUID:sl,clamp:In,euclideanModulo:U4,mapLinear:rG,inverseLerp:sG,lerp:nd,damp:oG,pingpong:aG,smoothstep:lG,smootherstep:uG,randInt:cG,randFloat:hG,randFloatSpread:fG,seededRandom:AG,degToRad:dG,radToDeg:pG,isPowerOfTwo:mG,ceilPowerOfTwo:gG,floorPowerOfTwo:_G,setQuaternionFromProperEuler:vG,normalize:Fn,denormalize:Vs};class rt{constructor(e=0,t=0){rt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=In(this.x,e.x,t.x),this.y=In(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=In(this.x,e,t),this.y=In(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(In(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(In(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class bn{constructor(e,t,i,r,s,o,a,l,u){bn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u)}set(e,t,i,r,s,o,a,l,u){const A=this.elements;return A[0]=e,A[1]=r,A[2]=a,A[3]=t,A[4]=s,A[5]=l,A[6]=i,A[7]=o,A[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],u=i[1],A=i[4],p=i[7],g=i[2],v=i[5],y=i[8],b=r[0],w=r[3],S=r[6],C=r[1],E=r[4],R=r[7],D=r[2],B=r[5],L=r[8];return s[0]=o*b+a*C+l*D,s[3]=o*w+a*E+l*B,s[6]=o*S+a*R+l*L,s[1]=u*b+A*C+p*D,s[4]=u*w+A*E+p*B,s[7]=u*S+A*R+p*L,s[2]=g*b+v*C+y*D,s[5]=g*w+v*E+y*B,s[8]=g*S+v*R+y*L,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],A=e[8];return t*o*A-t*a*u-i*s*A+i*a*l+r*s*u-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],A=e[8],p=A*o-a*u,g=a*l-A*s,v=u*s-o*l,y=t*p+i*g+r*v;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/y;return e[0]=p*b,e[1]=(r*u-A*i)*b,e[2]=(a*i-r*o)*b,e[3]=g*b,e[4]=(A*t-r*l)*b,e[5]=(r*s-a*t)*b,e[6]=v*b,e[7]=(i*l-u*t)*b,e[8]=(o*t-i*s)*b,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(i*l,i*u,-i*(l*o+u*a)+o+e,-r*u,r*l,-r*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(c3.makeScale(e,t)),this}rotate(e){return this.premultiply(c3.makeRotation(-e)),this}translate(e,t){return this.premultiply(c3.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const c3=new bn;function O4(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Vd(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function b9(){const n=Vd("canvas");return n.style.display="block",n}const S6={};function Ea(n){n in S6||(S6[n]=!0,console.warn(n))}function yG(n,e,t){return new Promise(function(i,r){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:i()}}setTimeout(s,t)})}function xG(n){const e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function bG(n){const e=n.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const w6=new bn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),M6=new bn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function TG(){const n={enabled:!0,workingColorSpace:Ma,spaces:{},convert:function(r,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===hi&&(r.r=Xl(r.r),r.g=Xl(r.g),r.b=Xl(r.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===hi&&(r.r=Xf(r.r),r.g=Xf(r.g),r.b=Xf(r.b))),r},fromWorkingColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},toWorkingColorSpace:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Po?dg:this.spaces[r].transfer},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,o){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[Ma]:{primaries:e,whitePoint:i,transfer:dg,toXYZ:w6,fromXYZ:M6,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Zt},outputColorSpaceConfig:{drawingBufferColorSpace:Zt}},[Zt]:{primaries:e,whitePoint:i,transfer:hi,toXYZ:w6,fromXYZ:M6,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Zt}}}),n}const Un=TG();function Xl(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Xf(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Vh;class SG{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Vh===void 0&&(Vh=Vd("canvas")),Vh.width=e.width,Vh.height=e.height;const r=Vh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=Vh}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Vd("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Xl(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Xl(t[i]/255)*255):t[i]=Xl(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let wG=0;class k4{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:wG++}),this.uuid=sl(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(h3(r[o].image)):s.push(h3(r[o]))}else s=h3(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function h3(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?SG.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let MG=0;class Cr extends xl{constructor(e=Cr.DEFAULT_IMAGE,t=Cr.DEFAULT_MAPPING,i=il,r=il,s=Lr,o=to,a=ur,l=Ji,u=Cr.DEFAULT_ANISOTROPY,A=Po){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:MG++}),this.uuid=sl(),this.name="",this.source=new k4(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new rt(0,0),this.repeat=new rt(1,1),this.center=new rt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new bn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=A,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==E4)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ah:e.x=e.x-Math.floor(e.x);break;case il:e.x=e.x<0?0:1;break;case dh:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Ah:e.y=e.y-Math.floor(e.y);break;case il:e.y=e.y<0?0:1;break;case dh:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Cr.DEFAULT_IMAGE=null;Cr.DEFAULT_MAPPING=E4;Cr.DEFAULT_ANISOTROPY=1;class Kt{constructor(e=0,t=0,i=0,r=1){Kt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,u=l[0],A=l[4],p=l[8],g=l[1],v=l[5],y=l[9],b=l[2],w=l[6],S=l[10];if(Math.abs(A-g)<.01&&Math.abs(p-b)<.01&&Math.abs(y-w)<.01){if(Math.abs(A+g)<.1&&Math.abs(p+b)<.1&&Math.abs(y+w)<.1&&Math.abs(u+v+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const E=(u+1)/2,R=(v+1)/2,D=(S+1)/2,B=(A+g)/4,L=(p+b)/4,U=(y+w)/4;return E>R&&E>D?E<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(E),r=B/i,s=L/i):R>D?R<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(R),i=B/r,s=U/r):D<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(D),i=L/s,r=U/s),this.set(i,r,s,t),this}let C=Math.sqrt((w-y)*(w-y)+(p-b)*(p-b)+(g-A)*(g-A));return Math.abs(C)<.001&&(C=1),this.x=(w-y)/C,this.y=(p-b)/C,this.z=(g-A)/C,this.w=Math.acos((u+v+S-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=In(this.x,e.x,t.x),this.y=In(this.y,e.y,t.y),this.z=In(this.z,e.z,t.z),this.w=In(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=In(this.x,e,t),this.y=In(this.y,e,t),this.z=In(this.z,e,t),this.w=In(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(In(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class bl extends xl{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=i.depth?i.depth:1,this.scissor=new Kt(0,0,e,t),this.scissorTest=!1,this.viewport=new Kt(0,0,e,t);const r={width:e,height:t,depth:this.depth};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Lr,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},i);const s=new Cr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const o=i.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,i=e.textures.length;t<i;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new k4(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class mh extends bl{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class D2 extends Cr{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ui,this.minFilter=Ui,this.wrapR=il,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class EG extends Cr{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ui,this.minFilter=Ui,this.wrapR=il,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class eu{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],u=i[r+1],A=i[r+2],p=i[r+3];const g=s[o+0],v=s[o+1],y=s[o+2],b=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=A,e[t+3]=p;return}if(a===1){e[t+0]=g,e[t+1]=v,e[t+2]=y,e[t+3]=b;return}if(p!==b||l!==g||u!==v||A!==y){let w=1-a;const S=l*g+u*v+A*y+p*b,C=S>=0?1:-1,E=1-S*S;if(E>Number.EPSILON){const D=Math.sqrt(E),B=Math.atan2(D,S*C);w=Math.sin(w*B)/D,a=Math.sin(a*B)/D}const R=a*C;if(l=l*w+g*R,u=u*w+v*R,A=A*w+y*R,p=p*w+b*R,w===1-a){const D=1/Math.sqrt(l*l+u*u+A*A+p*p);l*=D,u*=D,A*=D,p*=D}}e[t]=l,e[t+1]=u,e[t+2]=A,e[t+3]=p}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],u=i[r+2],A=i[r+3],p=s[o],g=s[o+1],v=s[o+2],y=s[o+3];return e[t]=a*y+A*p+l*v-u*g,e[t+1]=l*y+A*g+u*p-a*v,e[t+2]=u*y+A*v+a*g-l*p,e[t+3]=A*y-a*p-l*g-u*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(i/2),A=a(r/2),p=a(s/2),g=l(i/2),v=l(r/2),y=l(s/2);switch(o){case"XYZ":this._x=g*A*p+u*v*y,this._y=u*v*p-g*A*y,this._z=u*A*y+g*v*p,this._w=u*A*p-g*v*y;break;case"YXZ":this._x=g*A*p+u*v*y,this._y=u*v*p-g*A*y,this._z=u*A*y-g*v*p,this._w=u*A*p+g*v*y;break;case"ZXY":this._x=g*A*p-u*v*y,this._y=u*v*p+g*A*y,this._z=u*A*y+g*v*p,this._w=u*A*p-g*v*y;break;case"ZYX":this._x=g*A*p-u*v*y,this._y=u*v*p+g*A*y,this._z=u*A*y-g*v*p,this._w=u*A*p+g*v*y;break;case"YZX":this._x=g*A*p+u*v*y,this._y=u*v*p+g*A*y,this._z=u*A*y-g*v*p,this._w=u*A*p-g*v*y;break;case"XZY":this._x=g*A*p-u*v*y,this._y=u*v*p-g*A*y,this._z=u*A*y+g*v*p,this._w=u*A*p+g*v*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],A=t[6],p=t[10],g=i+a+p;if(g>0){const v=.5/Math.sqrt(g+1);this._w=.25/v,this._x=(A-l)*v,this._y=(s-u)*v,this._z=(o-r)*v}else if(i>a&&i>p){const v=2*Math.sqrt(1+i-a-p);this._w=(A-l)/v,this._x=.25*v,this._y=(r+o)/v,this._z=(s+u)/v}else if(a>p){const v=2*Math.sqrt(1+a-i-p);this._w=(s-u)/v,this._x=(r+o)/v,this._y=.25*v,this._z=(l+A)/v}else{const v=2*Math.sqrt(1+p-i-a);this._w=(o-r)/v,this._x=(s+u)/v,this._y=(l+A)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(In(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,A=t._w;return this._x=i*A+o*a+r*u-s*l,this._y=r*A+o*l+s*a-i*u,this._z=s*A+o*u+i*l-r*a,this._w=o*A-i*a-r*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*i+t*this._x,this._y=v*r+t*this._y,this._z=v*s+t*this._z,this.normalize(),this}const u=Math.sqrt(l),A=Math.atan2(u,a),p=Math.sin((1-t)*A)/u,g=Math.sin(t*A)/u;return this._w=o*p+this._w*g,this._x=i*p+this._x*g,this._y=r*p+this._y*g,this._z=s*p+this._z*g,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class re{constructor(e=0,t=0,i=0){re.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(E6.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(E6.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*r-a*i),A=2*(a*t-s*r),p=2*(s*i-o*t);return this.x=t+l*u+o*p-a*A,this.y=i+l*A+a*u-s*p,this.z=r+l*p+s*A-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=In(this.x,e.x,t.x),this.y=In(this.y,e.y,t.y),this.z=In(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=In(this.x,e,t),this.y=In(this.y,e,t),this.z=In(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(In(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return f3.copy(this).projectOnVector(e),this.sub(f3)}reflect(e){return this.sub(f3.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(In(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const f3=new re,E6=new eu;class rc{constructor(e=new re(1/0,1/0,1/0),t=new re(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(ca.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(ca.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=ca.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,ca):ca.fromBufferAttribute(s,o),ca.applyMatrix4(e.matrixWorld),this.expandByPoint(ca);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),rm.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),rm.copy(i.boundingBox)),rm.applyMatrix4(e.matrixWorld),this.union(rm)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,ca),ca.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(r0),sm.subVectors(this.max,r0),zh.subVectors(e.a,r0),qh.subVectors(e.b,r0),Gh.subVectors(e.c,r0),xu.subVectors(qh,zh),bu.subVectors(Gh,qh),xc.subVectors(zh,Gh);let t=[0,-xu.z,xu.y,0,-bu.z,bu.y,0,-xc.z,xc.y,xu.z,0,-xu.x,bu.z,0,-bu.x,xc.z,0,-xc.x,-xu.y,xu.x,0,-bu.y,bu.x,0,-xc.y,xc.x,0];return!A3(t,zh,qh,Gh,sm)||(t=[1,0,0,0,1,0,0,0,1],!A3(t,zh,qh,Gh,sm))?!1:(om.crossVectors(xu,bu),t=[om.x,om.y,om.z],A3(t,zh,qh,Gh,sm))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ca).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ca).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Rl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Rl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Rl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Rl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Rl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Rl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Rl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Rl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Rl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Rl=[new re,new re,new re,new re,new re,new re,new re,new re],ca=new re,rm=new rc,zh=new re,qh=new re,Gh=new re,xu=new re,bu=new re,xc=new re,r0=new re,sm=new re,om=new re,bc=new re;function A3(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){bc.fromArray(n,s);const a=r.x*Math.abs(bc.x)+r.y*Math.abs(bc.y)+r.z*Math.abs(bc.z),l=e.dot(bc),u=t.dot(bc),A=i.dot(bc);if(Math.max(-Math.max(l,u,A),Math.min(l,u,A))>a)return!1}return!0}const CG=new rc,s0=new re,d3=new re;class sc{constructor(e=new re,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):CG.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;s0.subVectors(e,this.center);const t=s0.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(s0,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(d3.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(s0.copy(e.center).add(d3)),this.expandByPoint(s0.copy(e.center).sub(d3))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Nl=new re,p3=new re,am=new re,Tu=new re,m3=new re,lm=new re,g3=new re;class xp{constructor(e=new re,t=new re(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Nl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Nl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Nl.copy(this.origin).addScaledVector(this.direction,t),Nl.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){p3.copy(e).add(t).multiplyScalar(.5),am.copy(t).sub(e).normalize(),Tu.copy(this.origin).sub(p3);const s=e.distanceTo(t)*.5,o=-this.direction.dot(am),a=Tu.dot(this.direction),l=-Tu.dot(am),u=Tu.lengthSq(),A=Math.abs(1-o*o);let p,g,v,y;if(A>0)if(p=o*l-a,g=o*a-l,y=s*A,p>=0)if(g>=-y)if(g<=y){const b=1/A;p*=b,g*=b,v=p*(p+o*g+2*a)+g*(o*p+g+2*l)+u}else g=s,p=Math.max(0,-(o*g+a)),v=-p*p+g*(g+2*l)+u;else g=-s,p=Math.max(0,-(o*g+a)),v=-p*p+g*(g+2*l)+u;else g<=-y?(p=Math.max(0,-(-o*s+a)),g=p>0?-s:Math.min(Math.max(-s,-l),s),v=-p*p+g*(g+2*l)+u):g<=y?(p=0,g=Math.min(Math.max(-s,-l),s),v=g*(g+2*l)+u):(p=Math.max(0,-(o*s+a)),g=p>0?s:Math.min(Math.max(-s,-l),s),v=-p*p+g*(g+2*l)+u);else g=o>0?-s:s,p=Math.max(0,-(o*g+a)),v=-p*p+g*(g+2*l)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,p),r&&r.copy(p3).addScaledVector(am,g),v}intersectSphere(e,t){Nl.subVectors(e.center,this.origin);const i=Nl.dot(this.direction),r=Nl.dot(Nl)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const u=1/this.direction.x,A=1/this.direction.y,p=1/this.direction.z,g=this.origin;return u>=0?(i=(e.min.x-g.x)*u,r=(e.max.x-g.x)*u):(i=(e.max.x-g.x)*u,r=(e.min.x-g.x)*u),A>=0?(s=(e.min.y-g.y)*A,o=(e.max.y-g.y)*A):(s=(e.max.y-g.y)*A,o=(e.min.y-g.y)*A),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),p>=0?(a=(e.min.z-g.z)*p,l=(e.max.z-g.z)*p):(a=(e.max.z-g.z)*p,l=(e.min.z-g.z)*p),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,Nl)!==null}intersectTriangle(e,t,i,r,s){m3.subVectors(t,e),lm.subVectors(i,e),g3.crossVectors(m3,lm);let o=this.direction.dot(g3),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Tu.subVectors(this.origin,e);const l=a*this.direction.dot(lm.crossVectors(Tu,lm));if(l<0)return null;const u=a*this.direction.dot(m3.cross(Tu));if(u<0||l+u>o)return null;const A=-a*Tu.dot(g3);return A<0?null:this.at(A/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class on{constructor(e,t,i,r,s,o,a,l,u,A,p,g,v,y,b,w){on.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u,A,p,g,v,y,b,w)}set(e,t,i,r,s,o,a,l,u,A,p,g,v,y,b,w){const S=this.elements;return S[0]=e,S[4]=t,S[8]=i,S[12]=r,S[1]=s,S[5]=o,S[9]=a,S[13]=l,S[2]=u,S[6]=A,S[10]=p,S[14]=g,S[3]=v,S[7]=y,S[11]=b,S[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new on().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Hh.setFromMatrixColumn(e,0).length(),s=1/Hh.setFromMatrixColumn(e,1).length(),o=1/Hh.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),A=Math.cos(s),p=Math.sin(s);if(e.order==="XYZ"){const g=o*A,v=o*p,y=a*A,b=a*p;t[0]=l*A,t[4]=-l*p,t[8]=u,t[1]=v+y*u,t[5]=g-b*u,t[9]=-a*l,t[2]=b-g*u,t[6]=y+v*u,t[10]=o*l}else if(e.order==="YXZ"){const g=l*A,v=l*p,y=u*A,b=u*p;t[0]=g+b*a,t[4]=y*a-v,t[8]=o*u,t[1]=o*p,t[5]=o*A,t[9]=-a,t[2]=v*a-y,t[6]=b+g*a,t[10]=o*l}else if(e.order==="ZXY"){const g=l*A,v=l*p,y=u*A,b=u*p;t[0]=g-b*a,t[4]=-o*p,t[8]=y+v*a,t[1]=v+y*a,t[5]=o*A,t[9]=b-g*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const g=o*A,v=o*p,y=a*A,b=a*p;t[0]=l*A,t[4]=y*u-v,t[8]=g*u+b,t[1]=l*p,t[5]=b*u+g,t[9]=v*u-y,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const g=o*l,v=o*u,y=a*l,b=a*u;t[0]=l*A,t[4]=b-g*p,t[8]=y*p+v,t[1]=p,t[5]=o*A,t[9]=-a*A,t[2]=-u*A,t[6]=v*p+y,t[10]=g-b*p}else if(e.order==="XZY"){const g=o*l,v=o*u,y=a*l,b=a*u;t[0]=l*A,t[4]=-p,t[8]=u*A,t[1]=g*p+b,t[5]=o*A,t[9]=v*p-y,t[2]=y*p-v,t[6]=a*A,t[10]=b*p+g}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(RG,e,NG)}lookAt(e,t,i){const r=this.elements;return vo.subVectors(e,t),vo.lengthSq()===0&&(vo.z=1),vo.normalize(),Su.crossVectors(i,vo),Su.lengthSq()===0&&(Math.abs(i.z)===1?vo.x+=1e-4:vo.z+=1e-4,vo.normalize(),Su.crossVectors(i,vo)),Su.normalize(),um.crossVectors(vo,Su),r[0]=Su.x,r[4]=um.x,r[8]=vo.x,r[1]=Su.y,r[5]=um.y,r[9]=vo.y,r[2]=Su.z,r[6]=um.z,r[10]=vo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],u=i[12],A=i[1],p=i[5],g=i[9],v=i[13],y=i[2],b=i[6],w=i[10],S=i[14],C=i[3],E=i[7],R=i[11],D=i[15],B=r[0],L=r[4],U=r[8],P=r[12],F=r[1],V=r[5],H=r[9],j=r[13],J=r[2],Z=r[6],W=r[10],K=r[14],ee=r[3],se=r[7],ge=r[11],de=r[15];return s[0]=o*B+a*F+l*J+u*ee,s[4]=o*L+a*V+l*Z+u*se,s[8]=o*U+a*H+l*W+u*ge,s[12]=o*P+a*j+l*K+u*de,s[1]=A*B+p*F+g*J+v*ee,s[5]=A*L+p*V+g*Z+v*se,s[9]=A*U+p*H+g*W+v*ge,s[13]=A*P+p*j+g*K+v*de,s[2]=y*B+b*F+w*J+S*ee,s[6]=y*L+b*V+w*Z+S*se,s[10]=y*U+b*H+w*W+S*ge,s[14]=y*P+b*j+w*K+S*de,s[3]=C*B+E*F+R*J+D*ee,s[7]=C*L+E*V+R*Z+D*se,s[11]=C*U+E*H+R*W+D*ge,s[15]=C*P+E*j+R*K+D*de,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],A=e[2],p=e[6],g=e[10],v=e[14],y=e[3],b=e[7],w=e[11],S=e[15];return y*(+s*l*p-r*u*p-s*a*g+i*u*g+r*a*v-i*l*v)+b*(+t*l*v-t*u*g+s*o*g-r*o*v+r*u*A-s*l*A)+w*(+t*u*p-t*a*v-s*o*p+i*o*v+s*a*A-i*u*A)+S*(-r*a*A-t*l*p+t*a*g+r*o*p-i*o*g+i*l*A)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],A=e[8],p=e[9],g=e[10],v=e[11],y=e[12],b=e[13],w=e[14],S=e[15],C=p*w*u-b*g*u+b*l*v-a*w*v-p*l*S+a*g*S,E=y*g*u-A*w*u-y*l*v+o*w*v+A*l*S-o*g*S,R=A*b*u-y*p*u+y*a*v-o*b*v-A*a*S+o*p*S,D=y*p*l-A*b*l-y*a*g+o*b*g+A*a*w-o*p*w,B=t*C+i*E+r*R+s*D;if(B===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const L=1/B;return e[0]=C*L,e[1]=(b*g*s-p*w*s-b*r*v+i*w*v+p*r*S-i*g*S)*L,e[2]=(a*w*s-b*l*s+b*r*u-i*w*u-a*r*S+i*l*S)*L,e[3]=(p*l*s-a*g*s-p*r*u+i*g*u+a*r*v-i*l*v)*L,e[4]=E*L,e[5]=(A*w*s-y*g*s+y*r*v-t*w*v-A*r*S+t*g*S)*L,e[6]=(y*l*s-o*w*s-y*r*u+t*w*u+o*r*S-t*l*S)*L,e[7]=(o*g*s-A*l*s+A*r*u-t*g*u-o*r*v+t*l*v)*L,e[8]=R*L,e[9]=(y*p*s-A*b*s-y*i*v+t*b*v+A*i*S-t*p*S)*L,e[10]=(o*b*s-y*a*s+y*i*u-t*b*u-o*i*S+t*a*S)*L,e[11]=(A*a*s-o*p*s-A*i*u+t*p*u+o*i*v-t*a*v)*L,e[12]=D*L,e[13]=(A*b*r-y*p*r+y*i*g-t*b*g-A*i*w+t*p*w)*L,e[14]=(y*a*r-o*b*r-y*i*l+t*b*l+o*i*w-t*a*w)*L,e[15]=(o*p*r-A*a*r+A*i*l-t*p*l-o*i*g+t*a*g)*L,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,u=s*o,A=s*a;return this.set(u*o+i,u*a-r*l,u*l+r*a,0,u*a+r*l,A*a+i,A*l-r*o,0,u*l-r*a,A*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,A=o+o,p=a+a,g=s*u,v=s*A,y=s*p,b=o*A,w=o*p,S=a*p,C=l*u,E=l*A,R=l*p,D=i.x,B=i.y,L=i.z;return r[0]=(1-(b+S))*D,r[1]=(v+R)*D,r[2]=(y-E)*D,r[3]=0,r[4]=(v-R)*B,r[5]=(1-(g+S))*B,r[6]=(w+C)*B,r[7]=0,r[8]=(y+E)*L,r[9]=(w-C)*L,r[10]=(1-(g+b))*L,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Hh.set(r[0],r[1],r[2]).length();const o=Hh.set(r[4],r[5],r[6]).length(),a=Hh.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ha.copy(this);const u=1/s,A=1/o,p=1/a;return ha.elements[0]*=u,ha.elements[1]*=u,ha.elements[2]*=u,ha.elements[4]*=A,ha.elements[5]*=A,ha.elements[6]*=A,ha.elements[8]*=p,ha.elements[9]*=p,ha.elements[10]*=p,t.setFromRotationMatrix(ha),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=zs){const l=this.elements,u=2*s/(t-e),A=2*s/(i-r),p=(t+e)/(t-e),g=(i+r)/(i-r);let v,y;if(a===zs)v=-(o+s)/(o-s),y=-2*o*s/(o-s);else if(a===Al)v=-o/(o-s),y=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=p,l[12]=0,l[1]=0,l[5]=A,l[9]=g,l[13]=0,l[2]=0,l[6]=0,l[10]=v,l[14]=y,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=zs){const l=this.elements,u=1/(t-e),A=1/(i-r),p=1/(o-s),g=(t+e)*u,v=(i+r)*A;let y,b;if(a===zs)y=(o+s)*p,b=-2*p;else if(a===Al)y=s*p,b=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-g,l[1]=0,l[5]=2*A,l[9]=0,l[13]=-v,l[2]=0,l[6]=0,l[10]=b,l[14]=-y,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Hh=new re,ha=new on,RG=new re(0,0,0),NG=new re(1,1,1),Su=new re,um=new re,vo=new re,C6=new on,R6=new eu;class jr{constructor(e=0,t=0,i=0,r=jr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],u=r[5],A=r[9],p=r[2],g=r[6],v=r[10];switch(t){case"XYZ":this._y=Math.asin(In(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-A,v),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(g,u),this._z=0);break;case"YXZ":this._x=Math.asin(-In(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(a,v),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(In(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-p,v),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-In(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(g,v),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(In(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-A,u),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(a,v));break;case"XZY":this._z=Math.asin(-In(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(g,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-A,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return C6.makeRotationFromQuaternion(e),this.setFromRotationMatrix(C6,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return R6.setFromEuler(this),this.setFromQuaternion(R6,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}jr.DEFAULT_ORDER="XYZ";class V4{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let PG=0;const N6=new re,Wh=new eu,Pl=new on,cm=new re,o0=new re,LG=new re,DG=new eu,P6=new re(1,0,0),L6=new re(0,1,0),D6=new re(0,0,1),I6={type:"added"},IG={type:"removed"},$h={type:"childadded",child:null},_3={type:"childremoved",child:null};class ki extends xl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:PG++}),this.uuid=sl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ki.DEFAULT_UP.clone();const e=new re,t=new jr,i=new eu,r=new re(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new on},normalMatrix:{value:new bn}}),this.matrix=new on,this.matrixWorld=new on,this.matrixAutoUpdate=ki.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ki.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new V4,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Wh.setFromAxisAngle(e,t),this.quaternion.multiply(Wh),this}rotateOnWorldAxis(e,t){return Wh.setFromAxisAngle(e,t),this.quaternion.premultiply(Wh),this}rotateX(e){return this.rotateOnAxis(P6,e)}rotateY(e){return this.rotateOnAxis(L6,e)}rotateZ(e){return this.rotateOnAxis(D6,e)}translateOnAxis(e,t){return N6.copy(e).applyQuaternion(this.quaternion),this.position.add(N6.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(P6,e)}translateY(e){return this.translateOnAxis(L6,e)}translateZ(e){return this.translateOnAxis(D6,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Pl.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?cm.copy(e):cm.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),o0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Pl.lookAt(o0,cm,this.up):Pl.lookAt(cm,o0,this.up),this.quaternion.setFromRotationMatrix(Pl),r&&(Pl.extractRotation(r.matrixWorld),Wh.setFromRotationMatrix(Pl),this.quaternion.premultiply(Wh.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(I6),$h.child=e,this.dispatchEvent($h),$h.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(IG),_3.child=e,this.dispatchEvent(_3),_3.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Pl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Pl.multiply(e.parent.matrixWorld)),e.applyMatrix4(Pl),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(I6),$h.child=e,this.dispatchEvent($h),$h.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(o0,e,LG),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(o0,DG,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(a=>({...a,boundingBox:a.boundingBox?{min:a.boundingBox.min.toArray(),max:a.boundingBox.max.toArray()}:void 0,boundingSphere:a.boundingSphere?{radius:a.boundingSphere.radius,center:a.boundingSphere.center.toArray()}:void 0})),r.instanceInfo=this._instanceInfo.map(a=>({...a})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,A=l.length;u<A;u++){const p=l[u];s(e.shapes,p)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),A=o(e.images),p=o(e.shapes),g=o(e.skeletons),v=o(e.animations),y=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),A.length>0&&(i.images=A),p.length>0&&(i.shapes=p),g.length>0&&(i.skeletons=g),v.length>0&&(i.animations=v),y.length>0&&(i.nodes=y)}return i.object=r,i;function o(a){const l=[];for(const u in a){const A=a[u];delete A.metadata,l.push(A)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}ki.DEFAULT_UP=new re(0,1,0);ki.DEFAULT_MATRIX_AUTO_UPDATE=!0;ki.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const fa=new re,Ll=new re,v3=new re,Dl=new re,jh=new re,Xh=new re,B6=new re,y3=new re,x3=new re,b3=new re,T3=new Kt,S3=new Kt,w3=new Kt;class Yo{constructor(e=new re,t=new re,i=new re){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),fa.subVectors(e,t),r.cross(fa);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){fa.subVectors(r,t),Ll.subVectors(i,t),v3.subVectors(e,t);const o=fa.dot(fa),a=fa.dot(Ll),l=fa.dot(v3),u=Ll.dot(Ll),A=Ll.dot(v3),p=o*u-a*a;if(p===0)return s.set(0,0,0),null;const g=1/p,v=(u*l-a*A)*g,y=(o*A-a*l)*g;return s.set(1-v-y,y,v)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Dl)===null?!1:Dl.x>=0&&Dl.y>=0&&Dl.x+Dl.y<=1}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,Dl)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Dl.x),l.addScaledVector(o,Dl.y),l.addScaledVector(a,Dl.z),l)}static getInterpolatedAttribute(e,t,i,r,s,o){return T3.setScalar(0),S3.setScalar(0),w3.setScalar(0),T3.fromBufferAttribute(e,t),S3.fromBufferAttribute(e,i),w3.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(T3,s.x),o.addScaledVector(S3,s.y),o.addScaledVector(w3,s.z),o}static isFrontFacing(e,t,i,r){return fa.subVectors(i,t),Ll.subVectors(e,t),fa.cross(Ll).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return fa.subVectors(this.c,this.b),Ll.subVectors(this.a,this.b),fa.cross(Ll).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Yo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Yo.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return Yo.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Yo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Yo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;jh.subVectors(r,i),Xh.subVectors(s,i),y3.subVectors(e,i);const l=jh.dot(y3),u=Xh.dot(y3);if(l<=0&&u<=0)return t.copy(i);x3.subVectors(e,r);const A=jh.dot(x3),p=Xh.dot(x3);if(A>=0&&p<=A)return t.copy(r);const g=l*p-A*u;if(g<=0&&l>=0&&A<=0)return o=l/(l-A),t.copy(i).addScaledVector(jh,o);b3.subVectors(e,s);const v=jh.dot(b3),y=Xh.dot(b3);if(y>=0&&v<=y)return t.copy(s);const b=v*u-l*y;if(b<=0&&u>=0&&y<=0)return a=u/(u-y),t.copy(i).addScaledVector(Xh,a);const w=A*y-v*p;if(w<=0&&p-A>=0&&v-y>=0)return B6.subVectors(s,r),a=(p-A)/(p-A+(v-y)),t.copy(r).addScaledVector(B6,a);const S=1/(w+b+g);return o=b*S,a=g*S,t.copy(i).addScaledVector(jh,o).addScaledVector(Xh,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const T9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},wu={h:0,s:0,l:0},hm={h:0,s:0,l:0};function M3(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let Gt=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Zt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Un.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Un.workingColorSpace){return this.r=e,this.g=t,this.b=i,Un.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Un.workingColorSpace){if(e=U4(e,1),t=In(t,0,1),i=In(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=M3(o,s,e+1/3),this.g=M3(o,s,e),this.b=M3(o,s,e-1/3)}return Un.toWorkingColorSpace(this,r),this}setStyle(e,t=Zt){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Zt){const i=T9[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Xl(e.r),this.g=Xl(e.g),this.b=Xl(e.b),this}copyLinearToSRGB(e){return this.r=Xf(e.r),this.g=Xf(e.g),this.b=Xf(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Zt){return Un.fromWorkingColorSpace(hs.copy(this),e),Math.round(In(hs.r*255,0,255))*65536+Math.round(In(hs.g*255,0,255))*256+Math.round(In(hs.b*255,0,255))}getHexString(e=Zt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Un.workingColorSpace){Un.fromWorkingColorSpace(hs.copy(this),t);const i=hs.r,r=hs.g,s=hs.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,u;const A=(a+o)/2;if(a===o)l=0,u=0;else{const p=o-a;switch(u=A<=.5?p/(o+a):p/(2-o-a),o){case i:l=(r-s)/p+(r<s?6:0);break;case r:l=(s-i)/p+2;break;case s:l=(i-r)/p+4;break}l/=6}return e.h=l,e.s=u,e.l=A,e}getRGB(e,t=Un.workingColorSpace){return Un.fromWorkingColorSpace(hs.copy(this),t),e.r=hs.r,e.g=hs.g,e.b=hs.b,e}getStyle(e=Zt){Un.fromWorkingColorSpace(hs.copy(this),e);const t=hs.r,i=hs.g,r=hs.b;return e!==Zt?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(wu),this.setHSL(wu.h+e,wu.s+t,wu.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(wu),e.getHSL(hm);const i=nd(wu.h,hm.h,t),r=nd(wu.s,hm.s,t),s=nd(wu.l,hm.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const hs=new Gt;Gt.NAMES=T9;let BG=0;class bs extends xl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:BG++}),this.uuid=sl(),this.name="",this.type="Material",this.blending=Gs,this.side=oo,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Td,this.blendDst=Sd,this.blendEquation=gs,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Gt(0,0,0),this.blendAlpha=0,this.depthFunc=Ju,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Ny,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Uc,this.stencilZFail=Uc,this.stencilZPass=Uc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Gs&&(i.blending=this.blending),this.side!==oo&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Td&&(i.blendSrc=this.blendSrc),this.blendDst!==Sd&&(i.blendDst=this.blendDst),this.blendEquation!==gs&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Ju&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Ny&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Uc&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Uc&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Uc&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class va extends bs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Gt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new jr,this.combine=_p,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Gl=FG();function FG(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):u<-14?(i[l]=1024>>-u-14,i[l|256]=1024>>-u-14|32768,r[l]=-u-1,r[l|256]=-u-1):u<=15?(i[l]=u+15<<10,i[l|256]=u+15<<10|32768,r[l]=13,r[l|256]=13):u<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,A=0;for(;(u&8388608)===0;)u<<=1,A-=8388608;u&=-8388609,A+=947912704,s[l]=u|A}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function yo(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=In(n,-65504,65504),Gl.floatView[0]=n;const e=Gl.uint32View[0],t=e>>23&511;return Gl.baseTable[t]+((e&8388607)>>Gl.shiftTable[t])}function fm(n){const e=n>>10;return Gl.uint32View[0]=Gl.mantissaTable[Gl.offsetTable[e]+(n&1023)]+Gl.exponentTable[e],Gl.floatView[0]}const br=new re,Am=new rt;let UG=0;class Xi{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:UG++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=pg,this.updateRanges=[],this.gpuType=mr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Am.fromBufferAttribute(this,t),Am.applyMatrix3(e),this.setXY(t,Am.x,Am.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)br.fromBufferAttribute(this,t),br.applyMatrix3(e),this.setXYZ(t,br.x,br.y,br.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)br.fromBufferAttribute(this,t),br.applyMatrix4(e),this.setXYZ(t,br.x,br.y,br.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)br.fromBufferAttribute(this,t),br.applyNormalMatrix(e),this.setXYZ(t,br.x,br.y,br.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)br.fromBufferAttribute(this,t),br.transformDirection(e),this.setXYZ(t,br.x,br.y,br.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Vs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Fn(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Vs(t,this.array)),t}setX(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Vs(t,this.array)),t}setY(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Vs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Vs(t,this.array)),t}setW(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Fn(t,this.array),i=Fn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Fn(t,this.array),i=Fn(i,this.array),r=Fn(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Fn(t,this.array),i=Fn(i,this.array),r=Fn(r,this.array),s=Fn(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==pg&&(e.usage=this.usage),e}}class z4 extends Xi{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class q4 extends Xi{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class S9 extends Xi{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=fm(this.array[e*this.itemSize]);return this.normalized&&(t=Vs(t,this.array)),t}setX(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize]=yo(t),this}getY(e){let t=fm(this.array[e*this.itemSize+1]);return this.normalized&&(t=Vs(t,this.array)),t}setY(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize+1]=yo(t),this}getZ(e){let t=fm(this.array[e*this.itemSize+2]);return this.normalized&&(t=Vs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize+2]=yo(t),this}getW(e){let t=fm(this.array[e*this.itemSize+3]);return this.normalized&&(t=Vs(t,this.array)),t}setW(e,t){return this.normalized&&(t=Fn(t,this.array)),this.array[e*this.itemSize+3]=yo(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Fn(t,this.array),i=Fn(i,this.array)),this.array[e+0]=yo(t),this.array[e+1]=yo(i),this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Fn(t,this.array),i=Fn(i,this.array),r=Fn(r,this.array)),this.array[e+0]=yo(t),this.array[e+1]=yo(i),this.array[e+2]=yo(r),this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Fn(t,this.array),i=Fn(i,this.array),r=Fn(r,this.array),s=Fn(s,this.array)),this.array[e+0]=yo(t),this.array[e+1]=yo(i),this.array[e+2]=yo(r),this.array[e+3]=yo(s),this}}class ri extends Xi{constructor(e,t,i){super(new Float32Array(e),t,i)}}let OG=0;const Wo=new on,E3=new ki,Qh=new re,xo=new rc,a0=new rc,Or=new re;class pi extends xl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:OG++}),this.uuid=sl(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(O4(e)?q4:z4)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new bn().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Wo.makeRotationFromQuaternion(e),this.applyMatrix4(Wo),this}rotateX(e){return Wo.makeRotationX(e),this.applyMatrix4(Wo),this}rotateY(e){return Wo.makeRotationY(e),this.applyMatrix4(Wo),this}rotateZ(e){return Wo.makeRotationZ(e),this.applyMatrix4(Wo),this}translate(e,t,i){return Wo.makeTranslation(e,t,i),this.applyMatrix4(Wo),this}scale(e,t,i){return Wo.makeScale(e,t,i),this.applyMatrix4(Wo),this}lookAt(e){return E3.lookAt(e),E3.updateMatrix(),this.applyMatrix4(E3.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Qh).negate(),this.translate(Qh.x,Qh.y,Qh.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new ri(i,3))}else{const i=Math.min(e.length,t.count);for(let r=0;r<i;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new rc);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new re(-1/0,-1/0,-1/0),new re(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];xo.setFromBufferAttribute(s),this.morphTargetsRelative?(Or.addVectors(this.boundingBox.min,xo.min),this.boundingBox.expandByPoint(Or),Or.addVectors(this.boundingBox.max,xo.max),this.boundingBox.expandByPoint(Or)):(this.boundingBox.expandByPoint(xo.min),this.boundingBox.expandByPoint(xo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new sc);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new re,1/0);return}if(e){const i=this.boundingSphere.center;if(xo.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];a0.setFromBufferAttribute(a),this.morphTargetsRelative?(Or.addVectors(xo.min,a0.min),xo.expandByPoint(Or),Or.addVectors(xo.max,a0.max),xo.expandByPoint(Or)):(xo.expandByPoint(a0.min),xo.expandByPoint(a0.max))}xo.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Or.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Or));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,A=a.count;u<A;u++)Or.fromBufferAttribute(a,u),l&&(Qh.fromBufferAttribute(e,u),Or.add(Qh)),r=Math.max(r,i.distanceToSquared(Or))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Xi(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let U=0;U<i.count;U++)a[U]=new re,l[U]=new re;const u=new re,A=new re,p=new re,g=new rt,v=new rt,y=new rt,b=new re,w=new re;function S(U,P,F){u.fromBufferAttribute(i,U),A.fromBufferAttribute(i,P),p.fromBufferAttribute(i,F),g.fromBufferAttribute(s,U),v.fromBufferAttribute(s,P),y.fromBufferAttribute(s,F),A.sub(u),p.sub(u),v.sub(g),y.sub(g);const V=1/(v.x*y.y-y.x*v.y);isFinite(V)&&(b.copy(A).multiplyScalar(y.y).addScaledVector(p,-v.y).multiplyScalar(V),w.copy(p).multiplyScalar(v.x).addScaledVector(A,-y.x).multiplyScalar(V),a[U].add(b),a[P].add(b),a[F].add(b),l[U].add(w),l[P].add(w),l[F].add(w))}let C=this.groups;C.length===0&&(C=[{start:0,count:e.count}]);for(let U=0,P=C.length;U<P;++U){const F=C[U],V=F.start,H=F.count;for(let j=V,J=V+H;j<J;j+=3)S(e.getX(j+0),e.getX(j+1),e.getX(j+2))}const E=new re,R=new re,D=new re,B=new re;function L(U){D.fromBufferAttribute(r,U),B.copy(D);const P=a[U];E.copy(P),E.sub(D.multiplyScalar(D.dot(P))).normalize(),R.crossVectors(B,P);const V=R.dot(l[U])<0?-1:1;o.setXYZW(U,E.x,E.y,E.z,V)}for(let U=0,P=C.length;U<P;++U){const F=C[U],V=F.start,H=F.count;for(let j=V,J=V+H;j<J;j+=3)L(e.getX(j+0)),L(e.getX(j+1)),L(e.getX(j+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Xi(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let g=0,v=i.count;g<v;g++)i.setXYZ(g,0,0,0);const r=new re,s=new re,o=new re,a=new re,l=new re,u=new re,A=new re,p=new re;if(e)for(let g=0,v=e.count;g<v;g+=3){const y=e.getX(g+0),b=e.getX(g+1),w=e.getX(g+2);r.fromBufferAttribute(t,y),s.fromBufferAttribute(t,b),o.fromBufferAttribute(t,w),A.subVectors(o,s),p.subVectors(r,s),A.cross(p),a.fromBufferAttribute(i,y),l.fromBufferAttribute(i,b),u.fromBufferAttribute(i,w),a.add(A),l.add(A),u.add(A),i.setXYZ(y,a.x,a.y,a.z),i.setXYZ(b,l.x,l.y,l.z),i.setXYZ(w,u.x,u.y,u.z)}else for(let g=0,v=t.count;g<v;g+=3)r.fromBufferAttribute(t,g+0),s.fromBufferAttribute(t,g+1),o.fromBufferAttribute(t,g+2),A.subVectors(o,s),p.subVectors(r,s),A.cross(p),i.setXYZ(g+0,A.x,A.y,A.z),i.setXYZ(g+1,A.x,A.y,A.z),i.setXYZ(g+2,A.x,A.y,A.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Or.fromBufferAttribute(e,t),Or.normalize(),e.setXYZ(t,Or.x,Or.y,Or.z)}toNonIndexed(){function e(a,l){const u=a.array,A=a.itemSize,p=a.normalized,g=new u.constructor(l.length*A);let v=0,y=0;for(let b=0,w=l.length;b<w;b++){a.isInterleavedBufferAttribute?v=l[b]*a.data.stride+a.offset:v=l[b]*A;for(let S=0;S<A;S++)g[y++]=u[v++]}return new Xi(g,A,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new pi,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let A=0,p=u.length;A<p;A++){const g=u[A],v=e(g,i);l.push(v)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],A=[];for(let p=0,g=u.length;p<g;p++){const v=u[p];A.push(v.toJSON(e.data))}A.length>0&&(r[l]=A,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const r=e.attributes;for(const u in r){const A=r[u];this.setAttribute(u,A.clone(t))}const s=e.morphAttributes;for(const u in s){const A=[],p=s[u];for(let g=0,v=p.length;g<v;g++)A.push(p[g].clone(t));this.morphAttributes[u]=A}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,A=o.length;u<A;u++){const p=o[u];this.addGroup(p.start,p.count,p.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const F6=new on,Tc=new xp,dm=new sc,U6=new re,pm=new re,mm=new re,gm=new re,C3=new re,_m=new re,O6=new re,vm=new re;class Jn extends ki{constructor(e=new pi,t=new va){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){_m.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const A=a[l],p=s[l];A!==0&&(C3.fromBufferAttribute(p,e),o?_m.addScaledVector(C3,A):_m.addScaledVector(C3.sub(t),A))}t.add(_m)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),dm.copy(i.boundingSphere),dm.applyMatrix4(s),Tc.copy(e.ray).recast(e.near),!(dm.containsPoint(Tc.origin)===!1&&(Tc.intersectSphere(dm,U6)===null||Tc.origin.distanceToSquared(U6)>(e.far-e.near)**2))&&(F6.copy(s).invert(),Tc.copy(e.ray).applyMatrix4(F6),!(i.boundingBox!==null&&Tc.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Tc)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,A=s.attributes.uv1,p=s.attributes.normal,g=s.groups,v=s.drawRange;if(a!==null)if(Array.isArray(o))for(let y=0,b=g.length;y<b;y++){const w=g[y],S=o[w.materialIndex],C=Math.max(w.start,v.start),E=Math.min(a.count,Math.min(w.start+w.count,v.start+v.count));for(let R=C,D=E;R<D;R+=3){const B=a.getX(R),L=a.getX(R+1),U=a.getX(R+2);r=ym(this,S,e,i,u,A,p,B,L,U),r&&(r.faceIndex=Math.floor(R/3),r.face.materialIndex=w.materialIndex,t.push(r))}}else{const y=Math.max(0,v.start),b=Math.min(a.count,v.start+v.count);for(let w=y,S=b;w<S;w+=3){const C=a.getX(w),E=a.getX(w+1),R=a.getX(w+2);r=ym(this,o,e,i,u,A,p,C,E,R),r&&(r.faceIndex=Math.floor(w/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let y=0,b=g.length;y<b;y++){const w=g[y],S=o[w.materialIndex],C=Math.max(w.start,v.start),E=Math.min(l.count,Math.min(w.start+w.count,v.start+v.count));for(let R=C,D=E;R<D;R+=3){const B=R,L=R+1,U=R+2;r=ym(this,S,e,i,u,A,p,B,L,U),r&&(r.faceIndex=Math.floor(R/3),r.face.materialIndex=w.materialIndex,t.push(r))}}else{const y=Math.max(0,v.start),b=Math.min(l.count,v.start+v.count);for(let w=y,S=b;w<S;w+=3){const C=w,E=w+1,R=w+2;r=ym(this,o,e,i,u,A,p,C,E,R),r&&(r.faceIndex=Math.floor(w/3),t.push(r))}}}}function kG(n,e,t,i,r,s,o,a){let l;if(e.side===wi?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===oo,a),l===null)return null;vm.copy(a),vm.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(vm);return u<t.near||u>t.far?null:{distance:u,point:vm.clone(),object:n}}function ym(n,e,t,i,r,s,o,a,l,u){n.getVertexPosition(a,pm),n.getVertexPosition(l,mm),n.getVertexPosition(u,gm);const A=kG(n,e,t,i,pm,mm,gm,O6);if(A){const p=new re;Yo.getBarycoord(O6,pm,mm,gm,p),r&&(A.uv=Yo.getInterpolatedAttribute(r,a,l,u,p,new rt)),s&&(A.uv1=Yo.getInterpolatedAttribute(s,a,l,u,p,new rt)),o&&(A.normal=Yo.getInterpolatedAttribute(o,a,l,u,p,new re),A.normal.dot(i.direction)>0&&A.normal.multiplyScalar(-1));const g={a,b:l,c:u,normal:new re,materialIndex:0};Yo.getNormal(pm,mm,gm,g.normal),A.face=g,A.barycoord=p}return A}class oc extends pi{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],A=[],p=[];let g=0,v=0;y("z","y","x",-1,-1,i,t,e,o,s,0),y("z","y","x",1,-1,i,t,-e,o,s,1),y("x","z","y",1,1,e,i,t,r,o,2),y("x","z","y",1,-1,e,i,-t,r,o,3),y("x","y","z",1,-1,e,t,i,r,s,4),y("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new ri(u,3)),this.setAttribute("normal",new ri(A,3)),this.setAttribute("uv",new ri(p,2));function y(b,w,S,C,E,R,D,B,L,U,P){const F=R/L,V=D/U,H=R/2,j=D/2,J=B/2,Z=L+1,W=U+1;let K=0,ee=0;const se=new re;for(let ge=0;ge<W;ge++){const de=ge*V-j;for(let Ae=0;Ae<Z;Ae++){const Be=Ae*F-H;se[b]=Be*C,se[w]=de*E,se[S]=J,u.push(se.x,se.y,se.z),se[b]=0,se[w]=0,se[S]=B>0?1:-1,A.push(se.x,se.y,se.z),p.push(Ae/L),p.push(1-ge/U),K+=1}}for(let ge=0;ge<U;ge++)for(let de=0;de<L;de++){const Ae=g+de+Z*ge,Be=g+de+Z*(ge+1),ye=g+(de+1)+Z*(ge+1),De=g+(de+1)+Z*ge;l.push(Ae,Be,De),l.push(Be,ye,De),ee+=6}a.addGroup(v,ee,P),v+=ee,g+=K}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new oc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function bA(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function Ns(n){const e={};for(let t=0;t<n.length;t++){const i=bA(n[t]);for(const r in i)e[r]=i[r]}return e}function VG(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function w9(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Un.workingColorSpace}const G4={clone:bA,merge:Ns};var zG=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,qG=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class sa extends bs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=zG,this.fragmentShader=qG,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=bA(e.uniforms),this.uniformsGroups=VG(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class bp extends ki{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new on,this.projectionMatrix=new on,this.projectionMatrixInverse=new on,this.coordinateSystem=zs}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Mu=new re,k6=new rt,V6=new rt;class Er extends bp{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=ph*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(td*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return ph*2*Math.atan(Math.tan(td*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Mu.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Mu.x,Mu.y).multiplyScalar(-e/Mu.z),Mu.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Mu.x,Mu.y).multiplyScalar(-e/Mu.z)}getViewSize(e,t){return this.getViewBounds(e,k6,V6),t.subVectors(V6,k6)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(td*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/u,r*=o.width/l,i*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Yh=-90,Zh=1;class M9 extends ki{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Er(Yh,Zh,e,t);r.layers=this.layers,this.add(r);const s=new Er(Yh,Zh,e,t);s.layers=this.layers,this.add(s);const o=new Er(Yh,Zh,e,t);o.layers=this.layers,this.add(o);const a=new Er(Yh,Zh,e,t);a.layers=this.layers,this.add(a);const l=new Er(Yh,Zh,e,t);l.layers=this.layers,this.add(l);const u=new Er(Yh,Zh,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===zs)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Al)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,A]=this.children,p=e.getRenderTarget(),g=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const b=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,u),i.texture.generateMipmaps=b,e.setRenderTarget(i,5,r),e.render(t,A),e.setRenderTarget(p,g,v),e.xr.enabled=y,i.texture.needsPMREMUpdate=!0}}class I2 extends Cr{constructor(e=[],t=Pa,i,r,s,o,a,l,u,A){super(e,t,i,r,s,o,a,l,u,A),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class E9 extends mh{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new I2(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Lr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new oc(5,5,5),s=new sa({name:"CubemapFromEquirect",uniforms:bA(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:wi,blending:Do});s.uniforms.tEquirect.value=t;const o=new Jn(r,s),a=t.minFilter;return t.minFilter===to&&(t.minFilter=Lr),new M9(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,i=!0,r=!0){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}let vs=class extends ki{constructor(){super(),this.isGroup=!0,this.type="Group"}};const GG={type:"move"};class O1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new vs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new vs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new re,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new re),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new vs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new re,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new re),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const b of e.hand.values()){const w=t.getJointPose(b,i),S=this._getHandJoint(u,b);w!==null&&(S.matrix.fromArray(w.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=w.radius),S.visible=w!==null}const A=u.joints["index-finger-tip"],p=u.joints["thumb-tip"],g=A.position.distanceTo(p.position),v=.02,y=.005;u.inputState.pinching&&g>v+y?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&g<=v-y&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(GG)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new vs;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class zA extends ki{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new jr,this.environmentIntensity=1,this.environmentRotation=new jr,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class B2{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=pg,this.updateRanges=[],this.version=0,this.uuid=sl()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=sl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=sl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Es=new re;class Ko{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Es.fromBufferAttribute(this,t),Es.applyMatrix4(e),this.setXYZ(t,Es.x,Es.y,Es.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Es.fromBufferAttribute(this,t),Es.applyNormalMatrix(e),this.setXYZ(t,Es.x,Es.y,Es.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Es.fromBufferAttribute(this,t),Es.transformDirection(e),this.setXYZ(t,Es.x,Es.y,Es.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Vs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Fn(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=Fn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Fn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Fn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Fn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Vs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Vs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Vs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Vs(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Fn(t,this.array),i=Fn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Fn(t,this.array),i=Fn(i,this.array),r=Fn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Fn(t,this.array),i=Fn(i,this.array),r=Fn(r,this.array),s=Fn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Xi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ko(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Qf extends bs{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Gt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Kh;const l0=new re,Jh=new re,ef=new re,tf=new rt,u0=new rt,C9=new on,xm=new re,c0=new re,bm=new re,z6=new rt,R3=new rt,q6=new rt;class R9 extends ki{constructor(e=new Qf){if(super(),this.isSprite=!0,this.type="Sprite",Kh===void 0){Kh=new pi;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new B2(t,5);Kh.setIndex([0,1,2,0,2,3]),Kh.setAttribute("position",new Ko(i,3,0,!1)),Kh.setAttribute("uv",new Ko(i,2,3,!1))}this.geometry=Kh,this.material=e,this.center=new rt(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Jh.setFromMatrixScale(this.matrixWorld),C9.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ef.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Jh.multiplyScalar(-ef.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;Tm(xm.set(-.5,-.5,0),ef,o,Jh,r,s),Tm(c0.set(.5,-.5,0),ef,o,Jh,r,s),Tm(bm.set(.5,.5,0),ef,o,Jh,r,s),z6.set(0,0),R3.set(1,0),q6.set(1,1);let a=e.ray.intersectTriangle(xm,c0,bm,!1,l0);if(a===null&&(Tm(c0.set(-.5,.5,0),ef,o,Jh,r,s),R3.set(0,1),a=e.ray.intersectTriangle(xm,bm,c0,!1,l0),a===null))return;const l=e.ray.origin.distanceTo(l0);l<e.near||l>e.far||t.push({distance:l,point:l0.clone(),uv:Yo.getInterpolation(l0,xm,c0,bm,z6,R3,q6,new rt),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Tm(n,e,t,i,r,s){tf.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(u0.x=s*tf.x-r*tf.y,u0.y=r*tf.x+s*tf.y):u0.copy(tf),n.copy(e),n.x+=u0.x,n.y+=u0.y,n.applyMatrix4(C9)}class HG extends Cr{constructor(e=null,t=1,i=1,r,s,o,a,l,u=Ui,A=Ui,p,g){super(null,o,a,l,u,A,r,s,p,g),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Xu extends Xi{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const N3=new re,WG=new re,$G=new bn;class Ka{constructor(e=new re(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=N3.subVectors(i,t).cross(WG.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(N3),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||$G.getNormalMatrix(e),r=this.coplanarPoint(N3).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Sc=new sc,Sm=new re;class qA{constructor(e=new Ka,t=new Ka,i=new Ka,r=new Ka,s=new Ka,o=new Ka){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=zs){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],u=r[4],A=r[5],p=r[6],g=r[7],v=r[8],y=r[9],b=r[10],w=r[11],S=r[12],C=r[13],E=r[14],R=r[15];if(i[0].setComponents(l-s,g-u,w-v,R-S).normalize(),i[1].setComponents(l+s,g+u,w+v,R+S).normalize(),i[2].setComponents(l+o,g+A,w+y,R+C).normalize(),i[3].setComponents(l-o,g-A,w-y,R-C).normalize(),i[4].setComponents(l-a,g-p,w-b,R-E).normalize(),t===zs)i[5].setComponents(l+a,g+p,w+b,R+E).normalize();else if(t===Al)i[5].setComponents(a,p,b,E).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Sc.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Sc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Sc)}intersectsSprite(e){return Sc.center.set(0,0,0),Sc.radius=.7071067811865476,Sc.applyMatrix4(e.matrixWorld),this.intersectsSphere(Sc)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Sm.x=r.normal.x>0?e.max.x:e.min.x,Sm.y=r.normal.y>0?e.max.y:e.min.y,Sm.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Sm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const qa=new on,Ga=new qA;class H4{constructor(){this.coordinateSystem=zs}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(qa.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ga.setFromProjectionMatrix(qa,this.coordinateSystem),Ga.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(qa.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ga.setFromProjectionMatrix(qa,this.coordinateSystem),Ga.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(qa.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ga.setFromProjectionMatrix(qa,this.coordinateSystem),Ga.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(qa.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ga.setFromProjectionMatrix(qa,this.coordinateSystem),Ga.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const r=t.cameras[i];if(qa.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ga.setFromProjectionMatrix(qa,this.coordinateSystem),Ga.containsPoint(e))return!0}return!1}clone(){return new H4}}class Sh extends bs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Gt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const mg=new re,gg=new re,G6=new on,h0=new xp,wm=new sc,P3=new re,H6=new re;class Tp extends ki{constructor(e=new pi,t=new Sh){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)mg.fromBufferAttribute(t,r-1),gg.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=mg.distanceTo(gg);e.setAttribute("lineDistance",new ri(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),wm.copy(i.boundingSphere),wm.applyMatrix4(r),wm.radius+=s,e.ray.intersectsSphere(wm)===!1)return;G6.copy(r).invert(),h0.copy(e.ray).applyMatrix4(G6);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=this.isLineSegments?2:1,A=i.index,g=i.attributes.position;if(A!==null){const v=Math.max(0,o.start),y=Math.min(A.count,o.start+o.count);for(let b=v,w=y-1;b<w;b+=u){const S=A.getX(b),C=A.getX(b+1),E=Mm(this,e,h0,l,S,C,b);E&&t.push(E)}if(this.isLineLoop){const b=A.getX(y-1),w=A.getX(v),S=Mm(this,e,h0,l,b,w,y-1);S&&t.push(S)}}else{const v=Math.max(0,o.start),y=Math.min(g.count,o.start+o.count);for(let b=v,w=y-1;b<w;b+=u){const S=Mm(this,e,h0,l,b,b+1,b);S&&t.push(S)}if(this.isLineLoop){const b=Mm(this,e,h0,l,y-1,v,y-1);b&&t.push(b)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function Mm(n,e,t,i,r,s,o){const a=n.geometry.attributes.position;if(mg.fromBufferAttribute(a,r),gg.fromBufferAttribute(a,s),t.distanceSqToSegment(mg,gg,P3,H6)>i)return;P3.applyMatrix4(n.matrixWorld);const u=e.ray.origin.distanceTo(P3);if(!(u<e.near||u>e.far))return{distance:u,point:H6.clone().applyMatrix4(n.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:n}}const W6=new re,$6=new re;class N9 extends Tp{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)W6.fromBufferAttribute(t,r),$6.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+W6.distanceTo($6);e.setAttribute("lineDistance",new ri(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class W4 extends bs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Gt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const j6=new on,Py=new xp,Em=new sc,Cm=new re;class jG extends ki{constructor(e=new pi,t=new W4){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Em.copy(i.boundingSphere),Em.applyMatrix4(r),Em.radius+=s,e.ray.intersectsSphere(Em)===!1)return;j6.copy(r).invert(),Py.copy(e.ray).applyMatrix4(j6);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=i.index,p=i.attributes.position;if(u!==null){const g=Math.max(0,o.start),v=Math.min(u.count,o.start+o.count);for(let y=g,b=v;y<b;y++){const w=u.getX(y);Cm.fromBufferAttribute(p,w),X6(Cm,w,l,r,e,t,this)}}else{const g=Math.max(0,o.start),v=Math.min(p.count,o.start+o.count);for(let y=g,b=v;y<b;y++)Cm.fromBufferAttribute(p,y),X6(Cm,y,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function X6(n,e,t,i,r,s,o){const a=Py.distanceSqToPoint(n);if(a<t){const l=new re;Py.closestPointToPoint(n,l),l.applyMatrix4(i);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class P9 extends Cr{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ui,this.minFilter=Ui,this.generateMipmaps=!1,this.needsUpdate=!0}}class XG extends Cr{constructor(e,t,i,r,s,o,a,l,u){super(e,t,i,r,s,o,a,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class lo extends Cr{constructor(e,t,i=Ni,r,s,o,a=Ui,l=Ui,u,A=Bo){if(A!==Bo&&A!==Fo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,r,s,o,a,l,A,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new k4(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class L9 extends lo{constructor(e=1,t=1,i=1){super(e,t),this.isDepthArrayTexture=!0,this.image={width:e,height:t,depth:i},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class F2 extends pi{constructor(e=1,t=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],u=new re,A=new rt;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let p=0,g=3;p<=t;p++,g+=3){const v=i+p/t*r;u.x=e*Math.cos(v),u.y=e*Math.sin(v),o.push(u.x,u.y,u.z),a.push(0,0,1),A.x=(o[g]/e+1)/2,A.y=(o[g+1]/e+1)/2,l.push(A.x,A.y)}for(let p=1;p<=t;p++)s.push(p,p+1,0);this.setIndex(s),this.setAttribute("position",new ri(o,3)),this.setAttribute("normal",new ri(a,3)),this.setAttribute("uv",new ri(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new F2(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class U2 extends pi{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const u=this;r=Math.floor(r),s=Math.floor(s);const A=[],p=[],g=[],v=[];let y=0;const b=[],w=i/2;let S=0;C(),o===!1&&(e>0&&E(!0),t>0&&E(!1)),this.setIndex(A),this.setAttribute("position",new ri(p,3)),this.setAttribute("normal",new ri(g,3)),this.setAttribute("uv",new ri(v,2));function C(){const R=new re,D=new re;let B=0;const L=(t-e)/i;for(let U=0;U<=s;U++){const P=[],F=U/s,V=F*(t-e)+e;for(let H=0;H<=r;H++){const j=H/r,J=j*l+a,Z=Math.sin(J),W=Math.cos(J);D.x=V*Z,D.y=-F*i+w,D.z=V*W,p.push(D.x,D.y,D.z),R.set(Z,L,W).normalize(),g.push(R.x,R.y,R.z),v.push(j,1-F),P.push(y++)}b.push(P)}for(let U=0;U<r;U++)for(let P=0;P<s;P++){const F=b[P][U],V=b[P+1][U],H=b[P+1][U+1],j=b[P][U+1];(e>0||P!==0)&&(A.push(F,V,j),B+=3),(t>0||P!==s-1)&&(A.push(V,H,j),B+=3)}u.addGroup(S,B,0),S+=B}function E(R){const D=y,B=new rt,L=new re;let U=0;const P=R===!0?e:t,F=R===!0?1:-1;for(let H=1;H<=r;H++)p.push(0,w*F,0),g.push(0,F,0),v.push(.5,.5),y++;const V=y;for(let H=0;H<=r;H++){const J=H/r*l+a,Z=Math.cos(J),W=Math.sin(J);L.x=P*W,L.y=w*F,L.z=P*Z,p.push(L.x,L.y,L.z),g.push(0,F,0),B.x=Z*.5+.5,B.y=W*.5*F+.5,v.push(B.x,B.y),y++}for(let H=0;H<r;H++){const j=D+H,J=V+H;R===!0?A.push(J,J+1,j):A.push(J+1,J,j),U+=3}u.addGroup(S,U,R===!0?1:2),S+=U}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new U2(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ba{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const i=this.getLengths();let r=0;const s=i.length;let o;t?o=t:o=e*i[s-1];let a=0,l=s-1,u;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),u=i[r]-o,u<0)a=r+1;else if(u>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const A=i[r],g=i[r+1]-A,v=(o-A)/g;return(r+v)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new rt:new re);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t=!1){const i=new re,r=[],s=[],o=[],a=new re,l=new on;for(let v=0;v<=e;v++){const y=v/e;r[v]=this.getTangentAt(y,new re)}s[0]=new re,o[0]=new re;let u=Number.MAX_VALUE;const A=Math.abs(r[0].x),p=Math.abs(r[0].y),g=Math.abs(r[0].z);A<=u&&(u=A,i.set(1,0,0)),p<=u&&(u=p,i.set(0,1,0)),g<=u&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let v=1;v<=e;v++){if(s[v]=s[v-1].clone(),o[v]=o[v-1].clone(),a.crossVectors(r[v-1],r[v]),a.length()>Number.EPSILON){a.normalize();const y=Math.acos(In(r[v-1].dot(r[v]),-1,1));s[v].applyMatrix4(l.makeRotationAxis(a,y))}o[v].crossVectors(r[v],s[v])}if(t===!0){let v=Math.acos(In(s[0].dot(s[e]),-1,1));v/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(v=-v);for(let y=1;y<=e;y++)s[y].applyMatrix4(l.makeRotationAxis(r[y],v*y)),o[y].crossVectors(r[y],s[y])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class $4 extends Ba{constructor(e=0,t=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new rt){const i=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const A=Math.cos(this.aRotation),p=Math.sin(this.aRotation),g=l-this.aX,v=u-this.aY;l=g*A-v*p+this.aX,u=g*p+v*A+this.aY}return i.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class QG extends $4{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function j4(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){r(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,A,p){let g=(o-s)/u-(a-s)/(u+A)+(a-o)/A,v=(a-o)/A-(l-o)/(A+p)+(l-a)/p;g*=A,v*=A,r(o,a,g,v)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+i*a}}}const Rm=new re,L3=new j4,D3=new j4,I3=new j4;class YG extends Ba{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new re){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let u,A;this.closed||a>0?u=r[(a-1)%s]:(Rm.subVectors(r[0],r[1]).add(r[0]),u=Rm);const p=r[a%s],g=r[(a+1)%s];if(this.closed||a+2<s?A=r[(a+2)%s]:(Rm.subVectors(r[s-1],r[s-2]).add(r[s-1]),A=Rm),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let y=Math.pow(u.distanceToSquared(p),v),b=Math.pow(p.distanceToSquared(g),v),w=Math.pow(g.distanceToSquared(A),v);b<1e-4&&(b=1),y<1e-4&&(y=b),w<1e-4&&(w=b),L3.initNonuniformCatmullRom(u.x,p.x,g.x,A.x,y,b,w),D3.initNonuniformCatmullRom(u.y,p.y,g.y,A.y,y,b,w),I3.initNonuniformCatmullRom(u.z,p.z,g.z,A.z,y,b,w)}else this.curveType==="catmullrom"&&(L3.initCatmullRom(u.x,p.x,g.x,A.x,this.tension),D3.initCatmullRom(u.y,p.y,g.y,A.y,this.tension),I3.initCatmullRom(u.z,p.z,g.z,A.z,this.tension));return i.set(L3.calc(l),D3.calc(l),I3.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new re().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Q6(n,e,t,i,r){const s=(i-e)*.5,o=(r-t)*.5,a=n*n,l=n*a;return(2*t-2*i+s+o)*l+(-3*t+3*i-2*s-o)*a+s*n+t}function ZG(n,e){const t=1-n;return t*t*e}function KG(n,e){return 2*(1-n)*n*e}function JG(n,e){return n*n*e}function id(n,e,t,i){return ZG(n,e)+KG(n,t)+JG(n,i)}function eH(n,e){const t=1-n;return t*t*t*e}function tH(n,e){const t=1-n;return 3*t*t*n*e}function nH(n,e){return 3*(1-n)*n*n*e}function iH(n,e){return n*n*n*e}function rd(n,e,t,i,r){return eH(n,e)+tH(n,t)+nH(n,i)+iH(n,r)}class D9 extends Ba{constructor(e=new rt,t=new rt,i=new rt,r=new rt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new rt){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(rd(e,r.x,s.x,o.x,a.x),rd(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class I9 extends Ba{constructor(e=new re,t=new re,i=new re,r=new re){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new re){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(rd(e,r.x,s.x,o.x,a.x),rd(e,r.y,s.y,o.y,a.y),rd(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class B9 extends Ba{constructor(e=new rt,t=new rt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new rt){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new rt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class rH extends Ba{constructor(e=new re,t=new re){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new re){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new re){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class F9 extends Ba{constructor(e=new rt,t=new rt,i=new rt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new rt){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(id(e,r.x,s.x,o.x),id(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class U9 extends Ba{constructor(e=new re,t=new re,i=new re){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new re){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(id(e,r.x,s.x,o.x),id(e,r.y,s.y,o.y),id(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class O9 extends Ba{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new rt){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],u=r[o],A=r[o>r.length-2?r.length-1:o+1],p=r[o>r.length-3?r.length-1:o+2];return i.set(Q6(a,l.x,u.x,A.x,p.x),Q6(a,l.y,u.y,A.y,p.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new rt().fromArray(r))}return this}}var _g=Object.freeze({__proto__:null,ArcCurve:QG,CatmullRomCurve3:YG,CubicBezierCurve:D9,CubicBezierCurve3:I9,EllipseCurve:$4,LineCurve:B9,LineCurve3:rH,QuadraticBezierCurve:F9,QuadraticBezierCurve3:U9,SplineCurve:O9});class sH extends Ba{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new _g[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),u=l===0?0:1-o/l;return a.getPointAt(u,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let u=0;u<l.length;u++){const A=l[u];i&&i.equals(A)||(t.push(A),i=A)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new _g[r.type]().fromJSON(r))}return this}}let Ly=class extends sH{constructor(e){super(),this.type="Path",this.currentPoint=new rt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new B9(this.currentPoint.clone(),new rt(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new F9(this.currentPoint.clone(),new rt(e,t),new rt(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new D9(this.currentPoint.clone(),new rt(e,t),new rt(i,r),new rt(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new O9(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){const u=this.currentPoint.x,A=this.currentPoint.y;return this.absellipse(e+u,t+A,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const u=new $4(e,t,i,r,s,o,a,l);if(this.curves.length>0){const p=u.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(u);const A=u.getPoint(1);return this.currentPoint.copy(A),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};class k1 extends Ly{constructor(e){super(e),this.uuid=sl(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new Ly().fromJSON(r))}return this}}function oH(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=k9(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u;if(i&&(s=hH(n,e,s,t)),n.length>80*t){a=1/0,l=1/0;let A=-1/0,p=-1/0;for(let g=t;g<r;g+=t){const v=n[g],y=n[g+1];v<a&&(a=v),y<l&&(l=y),v>A&&(A=v),y>p&&(p=y)}u=Math.max(A-a,p-l),u=u!==0?32767/u:0}return zd(s,o,t,a,l,u,0),o}function k9(n,e,t,i,r){let s;if(r===bH(n,e,t,i)>0)for(let o=e;o<t;o+=i)s=Y6(o/i|0,n[o],n[o+1],s);else for(let o=t-i;o>=e;o-=i)s=Y6(o/i|0,n[o],n[o+1],s);return s&&TA(s,s.next)&&(Gd(s),s=s.next),s}function gh(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(TA(t,t.next)||Zi(t.prev,t,t.next)===0)){if(Gd(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function zd(n,e,t,i,r,s,o){if(!n)return;!o&&s&&mH(n,i,r,s);let a=n;for(;n.prev!==n.next;){const l=n.prev,u=n.next;if(s?lH(n,i,r,s):aH(n)){e.push(l.i,n.i,u.i),Gd(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=uH(gh(n),e),zd(n,e,t,i,r,s,2)):o===2&&cH(n,e,t,i,r,s):zd(gh(n),e,t,i,r,s,1);break}}}function aH(n){const e=n.prev,t=n,i=n.next;if(Zi(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,A=Math.min(r,s,o),p=Math.min(a,l,u),g=Math.max(r,s,o),v=Math.max(a,l,u);let y=i.next;for(;y!==e;){if(y.x>=A&&y.x<=g&&y.y>=p&&y.y<=v&&k0(r,a,s,l,o,u,y.x,y.y)&&Zi(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function lH(n,e,t,i){const r=n.prev,s=n,o=n.next;if(Zi(r,s,o)>=0)return!1;const a=r.x,l=s.x,u=o.x,A=r.y,p=s.y,g=o.y,v=Math.min(a,l,u),y=Math.min(A,p,g),b=Math.max(a,l,u),w=Math.max(A,p,g),S=Dy(v,y,e,t,i),C=Dy(b,w,e,t,i);let E=n.prevZ,R=n.nextZ;for(;E&&E.z>=S&&R&&R.z<=C;){if(E.x>=v&&E.x<=b&&E.y>=y&&E.y<=w&&E!==r&&E!==o&&k0(a,A,l,p,u,g,E.x,E.y)&&Zi(E.prev,E,E.next)>=0||(E=E.prevZ,R.x>=v&&R.x<=b&&R.y>=y&&R.y<=w&&R!==r&&R!==o&&k0(a,A,l,p,u,g,R.x,R.y)&&Zi(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;E&&E.z>=S;){if(E.x>=v&&E.x<=b&&E.y>=y&&E.y<=w&&E!==r&&E!==o&&k0(a,A,l,p,u,g,E.x,E.y)&&Zi(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;R&&R.z<=C;){if(R.x>=v&&R.x<=b&&R.y>=y&&R.y<=w&&R!==r&&R!==o&&k0(a,A,l,p,u,g,R.x,R.y)&&Zi(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function uH(n,e){let t=n;do{const i=t.prev,r=t.next.next;!TA(i,r)&&z9(i,t,t.next,r)&&qd(i,r)&&qd(r,i)&&(e.push(i.i,t.i,r.i),Gd(t),Gd(t.next),t=n=r),t=t.next}while(t!==n);return gh(t)}function cH(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&vH(o,a)){let l=q9(o,a);o=gh(o,o.next),l=gh(l,l.next),zd(o,e,t,i,r,s,0),zd(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function hH(n,e,t,i){const r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,u=k9(n,a,l,i,!1);u===u.next&&(u.steiner=!0),r.push(_H(u))}r.sort(fH);for(let s=0;s<r.length;s++)t=AH(r[s],t);return t}function fH(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const i=(n.next.y-n.y)/(n.next.x-n.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=i-r}return t}function AH(n,e){const t=dH(n,e);if(!t)return e;const i=q9(t,n);return gh(i,i.next),gh(t,t.next)}function dH(n,e){let t=e;const i=n.x,r=n.y;let s=-1/0,o;if(TA(n,t))return t;do{if(TA(n,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const p=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=i&&p>s&&(s=p,o=t.x<t.next.x?t:t.next,p===i))return o}t=t.next}while(t!==e);if(!o)return null;const a=o,l=o.x,u=o.y;let A=1/0;t=o;do{if(i>=t.x&&t.x>=l&&i!==t.x&&V9(r<u?i:s,r,l,u,r<u?s:i,r,t.x,t.y)){const p=Math.abs(r-t.y)/(i-t.x);qd(t,n)&&(p<A||p===A&&(t.x>o.x||t.x===o.x&&pH(o,t)))&&(o=t,A=p)}t=t.next}while(t!==a);return o}function pH(n,e){return Zi(n.prev,n,e.prev)<0&&Zi(e.next,n,n.next)<0}function mH(n,e,t,i){let r=n;do r.z===0&&(r.z=Dy(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,gH(r)}function gH(n){let e,t=1;do{let i=n,r;n=null;let s=null;for(e=0;i;){e++;let o=i,a=0;for(let u=0;u<t&&(a++,o=o.nextZ,!!o);u++);let l=t;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||i.z<=o.z)?(r=i,i=i.nextZ,a--):(r=o,o=o.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;i=o}s.nextZ=null,t*=2}while(e>1);return n}function Dy(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function _H(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function V9(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function k0(n,e,t,i,r,s,o,a){return!(n===o&&e===a)&&V9(n,e,t,i,r,s,o,a)}function vH(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!yH(n,e)&&(qd(n,e)&&qd(e,n)&&xH(n,e)&&(Zi(n.prev,n,e.prev)||Zi(n,e.prev,e))||TA(n,e)&&Zi(n.prev,n,n.next)>0&&Zi(e.prev,e,e.next)>0)}function Zi(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function TA(n,e){return n.x===e.x&&n.y===e.y}function z9(n,e,t,i){const r=Pm(Zi(n,e,t)),s=Pm(Zi(n,e,i)),o=Pm(Zi(t,i,n)),a=Pm(Zi(t,i,e));return!!(r!==s&&o!==a||r===0&&Nm(n,t,e)||s===0&&Nm(n,i,e)||o===0&&Nm(t,n,i)||a===0&&Nm(t,e,i))}function Nm(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Pm(n){return n>0?1:n<0?-1:0}function yH(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&z9(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function qd(n,e){return Zi(n.prev,n,n.next)<0?Zi(n,e,n.next)>=0&&Zi(n,n.prev,e)>=0:Zi(n,e,n.prev)<0||Zi(n,n.next,e)<0}function xH(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function q9(n,e){const t=Iy(n.i,n.x,n.y),i=Iy(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function Y6(n,e,t,i){const r=Iy(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Gd(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Iy(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function bH(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}class TH{static triangulate(e,t,i=2){return oH(e,t,i)}}class $c{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return $c.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];Z6(e),K6(i,e);let o=e.length;t.forEach(Z6);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,K6(i,t[l]);const a=TH.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function Z6(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function K6(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class X4 extends pi{constructor(e=new k1([new rt(.5,.5),new rt(-.5,.5),new rt(-.5,-.5),new rt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];o(u)}this.setAttribute("position",new ri(r,3)),this.setAttribute("uv",new ri(s,2)),this.computeVertexNormals();function o(a){const l=[],u=t.curveSegments!==void 0?t.curveSegments:12,A=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1;let g=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.bevelThickness!==void 0?t.bevelThickness:.2,y=t.bevelSize!==void 0?t.bevelSize:v-.1,b=t.bevelOffset!==void 0?t.bevelOffset:0,w=t.bevelSegments!==void 0?t.bevelSegments:3;const S=t.extrudePath,C=t.UVGenerator!==void 0?t.UVGenerator:SH;let E,R=!1,D,B,L,U;S&&(E=S.getSpacedPoints(A),R=!0,g=!1,D=S.computeFrenetFrames(A,!1),B=new re,L=new re,U=new re),g||(w=0,v=0,y=0,b=0);const P=a.extractPoints(u);let F=P.shape;const V=P.holes;if(!$c.isClockWise(F)){F=F.reverse();for(let G=0,Te=V.length;G<Te;G++){const pe=V[G];$c.isClockWise(pe)&&(V[G]=pe.reverse())}}function j(G){const pe=10000000000000001e-36;let me=G[0];for(let ve=1;ve<=G.length;ve++){const qe=ve%G.length,Me=G[qe],$=Me.x-me.x,z=Me.y-me.y,fe=$*$+z*z,xe=Math.max(Math.abs(Me.x),Math.abs(Me.y),Math.abs(me.x),Math.abs(me.y)),Le=pe*xe*xe;if(fe<=Le){G.splice(qe,1),ve--;continue}me=Me}}j(F),V.forEach(j);const J=V.length,Z=F;for(let G=0;G<J;G++){const Te=V[G];F=F.concat(Te)}function W(G,Te,pe){return Te||console.error("THREE.ExtrudeGeometry: vec does not exist"),G.clone().addScaledVector(Te,pe)}const K=F.length;function ee(G,Te,pe){let me,ve,qe;const Me=G.x-Te.x,$=G.y-Te.y,z=pe.x-G.x,fe=pe.y-G.y,xe=Me*Me+$*$,Le=Me*fe-$*z;if(Math.abs(Le)>Number.EPSILON){const Ne=Math.sqrt(xe),ot=Math.sqrt(z*z+fe*fe),Qe=Te.x-$/Ne,xt=Te.y+Me/Ne,bt=pe.x-fe/ot,nt=pe.y+z/ot,At=((bt-Qe)*fe-(nt-xt)*z)/(Me*fe-$*z);me=Qe+Me*At-G.x,ve=xt+$*At-G.y;const Dt=me*me+ve*ve;if(Dt<=2)return new rt(me,ve);qe=Math.sqrt(Dt/2)}else{let Ne=!1;Me>Number.EPSILON?z>Number.EPSILON&&(Ne=!0):Me<-Number.EPSILON?z<-Number.EPSILON&&(Ne=!0):Math.sign($)===Math.sign(fe)&&(Ne=!0),Ne?(me=-$,ve=Me,qe=Math.sqrt(xe)):(me=Me,ve=$,qe=Math.sqrt(xe/2))}return new rt(me/qe,ve/qe)}const se=[];for(let G=0,Te=Z.length,pe=Te-1,me=G+1;G<Te;G++,pe++,me++)pe===Te&&(pe=0),me===Te&&(me=0),se[G]=ee(Z[G],Z[pe],Z[me]);const ge=[];let de,Ae=se.concat();for(let G=0,Te=J;G<Te;G++){const pe=V[G];de=[];for(let me=0,ve=pe.length,qe=ve-1,Me=me+1;me<ve;me++,qe++,Me++)qe===ve&&(qe=0),Me===ve&&(Me=0),de[me]=ee(pe[me],pe[qe],pe[Me]);ge.push(de),Ae=Ae.concat(de)}let Be;if(w===0)Be=$c.triangulateShape(Z,V);else{const G=[],Te=[];for(let pe=0;pe<w;pe++){const me=pe/w,ve=v*Math.cos(me*Math.PI/2),qe=y*Math.sin(me*Math.PI/2)+b;for(let Me=0,$=Z.length;Me<$;Me++){const z=W(Z[Me],se[Me],qe);Xe(z.x,z.y,-ve),me===0&&G.push(z)}for(let Me=0,$=J;Me<$;Me++){const z=V[Me];de=ge[Me];const fe=[];for(let xe=0,Le=z.length;xe<Le;xe++){const Ne=W(z[xe],de[xe],qe);Xe(Ne.x,Ne.y,-ve),me===0&&fe.push(Ne)}me===0&&Te.push(fe)}}Be=$c.triangulateShape(G,Te)}const ye=Be.length,De=y+b;for(let G=0;G<K;G++){const Te=g?W(F[G],Ae[G],De):F[G];R?(L.copy(D.normals[0]).multiplyScalar(Te.x),B.copy(D.binormals[0]).multiplyScalar(Te.y),U.copy(E[0]).add(L).add(B),Xe(U.x,U.y,U.z)):Xe(Te.x,Te.y,0)}for(let G=1;G<=A;G++)for(let Te=0;Te<K;Te++){const pe=g?W(F[Te],Ae[Te],De):F[Te];R?(L.copy(D.normals[G]).multiplyScalar(pe.x),B.copy(D.binormals[G]).multiplyScalar(pe.y),U.copy(E[G]).add(L).add(B),Xe(U.x,U.y,U.z)):Xe(pe.x,pe.y,p/A*G)}for(let G=w-1;G>=0;G--){const Te=G/w,pe=v*Math.cos(Te*Math.PI/2),me=y*Math.sin(Te*Math.PI/2)+b;for(let ve=0,qe=Z.length;ve<qe;ve++){const Me=W(Z[ve],se[ve],me);Xe(Me.x,Me.y,p+pe)}for(let ve=0,qe=V.length;ve<qe;ve++){const Me=V[ve];de=ge[ve];for(let $=0,z=Me.length;$<z;$++){const fe=W(Me[$],de[$],me);R?Xe(fe.x,fe.y+E[A-1].y,E[A-1].x+pe):Xe(fe.x,fe.y,p+pe)}}}We(),$e();function We(){const G=r.length/3;if(g){let Te=0,pe=K*Te;for(let me=0;me<ye;me++){const ve=Be[me];st(ve[2]+pe,ve[1]+pe,ve[0]+pe)}Te=A+w*2,pe=K*Te;for(let me=0;me<ye;me++){const ve=Be[me];st(ve[0]+pe,ve[1]+pe,ve[2]+pe)}}else{for(let Te=0;Te<ye;Te++){const pe=Be[Te];st(pe[2],pe[1],pe[0])}for(let Te=0;Te<ye;Te++){const pe=Be[Te];st(pe[0]+K*A,pe[1]+K*A,pe[2]+K*A)}}i.addGroup(G,r.length/3-G,0)}function $e(){const G=r.length/3;let Te=0;Ke(Z,Te),Te+=Z.length;for(let pe=0,me=V.length;pe<me;pe++){const ve=V[pe];Ke(ve,Te),Te+=ve.length}i.addGroup(G,r.length/3-G,1)}function Ke(G,Te){let pe=G.length;for(;--pe>=0;){const me=pe;let ve=pe-1;ve<0&&(ve=G.length-1);for(let qe=0,Me=A+w*2;qe<Me;qe++){const $=K*qe,z=K*(qe+1),fe=Te+me+$,xe=Te+ve+$,Le=Te+ve+z,Ne=Te+me+z;gt(fe,xe,Le,Ne)}}}function Xe(G,Te,pe){l.push(G),l.push(Te),l.push(pe)}function st(G,Te,pe){ae(G),ae(Te),ae(pe);const me=r.length/3,ve=C.generateTopUV(i,r,me-3,me-2,me-1);le(ve[0]),le(ve[1]),le(ve[2])}function gt(G,Te,pe,me){ae(G),ae(Te),ae(me),ae(Te),ae(pe),ae(me);const ve=r.length/3,qe=C.generateSideWallUV(i,r,ve-6,ve-3,ve-2,ve-1);le(qe[0]),le(qe[1]),le(qe[3]),le(qe[1]),le(qe[2]),le(qe[3])}function ae(G){r.push(l[G*3+0]),r.push(l[G*3+1]),r.push(l[G*3+2])}function le(G){s.push(G.x),s.push(G.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return wH(t,i,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new _g[r.type]().fromJSON(r)),new X4(i,e.options)}}const SH={generateTopUV:function(n,e,t,i,r){const s=e[t*3],o=e[t*3+1],a=e[i*3],l=e[i*3+1],u=e[r*3],A=e[r*3+1];return[new rt(s,o),new rt(a,l),new rt(u,A)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],u=e[i*3],A=e[i*3+1],p=e[i*3+2],g=e[r*3],v=e[r*3+1],y=e[r*3+2],b=e[s*3],w=e[s*3+1],S=e[s*3+2];return Math.abs(a-A)<Math.abs(o-u)?[new rt(o,1-l),new rt(u,1-p),new rt(g,1-y),new rt(b,1-S)]:[new rt(a,1-l),new rt(A,1-p),new rt(v,1-y),new rt(w,1-S)]}};function wH(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const s=n[i];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Sp extends pi{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),u=a+1,A=l+1,p=e/a,g=t/l,v=[],y=[],b=[],w=[];for(let S=0;S<A;S++){const C=S*g-o;for(let E=0;E<u;E++){const R=E*p-s;y.push(R,-C,0),b.push(0,0,1),w.push(E/a),w.push(1-S/l)}}for(let S=0;S<l;S++)for(let C=0;C<a;C++){const E=C+u*S,R=C+u*(S+1),D=C+1+u*(S+1),B=C+1+u*S;v.push(E,R,B),v.push(R,D,B)}this.setIndex(v),this.setAttribute("position",new ri(y,3)),this.setAttribute("normal",new ri(b,3)),this.setAttribute("uv",new ri(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sp(e.width,e.height,e.widthSegments,e.heightSegments)}}class Fa extends pi{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let u=0;const A=[],p=new re,g=new re,v=[],y=[],b=[],w=[];for(let S=0;S<=i;S++){const C=[],E=S/i;let R=0;S===0&&o===0?R=.5/t:S===i&&l===Math.PI&&(R=-.5/t);for(let D=0;D<=t;D++){const B=D/t;p.x=-e*Math.cos(r+B*s)*Math.sin(o+E*a),p.y=e*Math.cos(o+E*a),p.z=e*Math.sin(r+B*s)*Math.sin(o+E*a),y.push(p.x,p.y,p.z),g.copy(p).normalize(),b.push(g.x,g.y,g.z),w.push(B+R,1-E),C.push(u++)}A.push(C)}for(let S=0;S<i;S++)for(let C=0;C<t;C++){const E=A[S][C+1],R=A[S][C],D=A[S+1][C],B=A[S+1][C+1];(S!==0||o>0)&&v.push(E,R,B),(S!==i-1||l<Math.PI)&&v.push(R,D,B)}this.setIndex(v),this.setAttribute("position",new ri(y,3)),this.setAttribute("normal",new ri(b,3)),this.setAttribute("uv",new ri(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fa(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Q4 extends pi{constructor(e=new U9(new re(-1,-1,0),new re(-1,1,0),new re(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new re,l=new re,u=new rt;let A=new re;const p=[],g=[],v=[],y=[];b(),this.setIndex(y),this.setAttribute("position",new ri(p,3)),this.setAttribute("normal",new ri(g,3)),this.setAttribute("uv",new ri(v,2));function b(){for(let E=0;E<t;E++)w(E);w(s===!1?t:0),C(),S()}function w(E){A=e.getPointAt(E/t,A);const R=o.normals[E],D=o.binormals[E];for(let B=0;B<=r;B++){const L=B/r*Math.PI*2,U=Math.sin(L),P=-Math.cos(L);l.x=P*R.x+U*D.x,l.y=P*R.y+U*D.y,l.z=P*R.z+U*D.z,l.normalize(),g.push(l.x,l.y,l.z),a.x=A.x+i*l.x,a.y=A.y+i*l.y,a.z=A.z+i*l.z,p.push(a.x,a.y,a.z)}}function S(){for(let E=1;E<=t;E++)for(let R=1;R<=r;R++){const D=(r+1)*(E-1)+(R-1),B=(r+1)*E+(R-1),L=(r+1)*E+R,U=(r+1)*(E-1)+R;y.push(D,B,U),y.push(B,L,U)}}function C(){for(let E=0;E<=t;E++)for(let R=0;R<=r;R++)u.x=E/t,u.y=R/r,v.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Q4(new _g[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class MH extends pi{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new re,s=new re;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,A=l.length;u<A;++u){const p=l[u],g=p.start,v=p.count;for(let y=g,b=g+v;y<b;y+=3)for(let w=0;w<3;w++){const S=a.getX(y+w),C=a.getX(y+(w+1)%3);r.fromBufferAttribute(o,S),s.fromBufferAttribute(o,C),J6(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let u=0;u<3;u++){const A=3*a+u,p=3*a+(u+1)%3;r.fromBufferAttribute(o,A),s.fromBufferAttribute(o,p),J6(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new ri(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function J6(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}class EH extends bs{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Gt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class G9 extends bs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Gt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jl,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new jr,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class CH extends G9{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new rt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return In(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Gt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Gt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Gt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class vg extends bs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Gt(16777215),this.specular=new Gt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jl,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new jr,this.combine=_p,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class RH extends bs{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Gt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jl,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class NH extends bs{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jl,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Tl extends bs{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Gt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jl,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new jr,this.combine=_p,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class PH extends bs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=qq,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class LH extends bs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class DH extends bs{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Gt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jl,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class IH extends Sh{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const eT={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class BH{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(A){a++,s===!1&&r.onStart!==void 0&&r.onStart(A,o,a),s=!0},this.itemEnd=function(A){o++,r.onProgress!==void 0&&r.onProgress(A,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(A){r.onError!==void 0&&r.onError(A)},this.resolveURL=function(A){return l?l(A):A},this.setURLModifier=function(A){return l=A,this},this.addHandler=function(A,p){return u.push(A,p),this},this.removeHandler=function(A){const p=u.indexOf(A);return p!==-1&&u.splice(p,2),this},this.getHandler=function(A){for(let p=0,g=u.length;p<g;p+=2){const v=u[p],y=u[p+1];if(v.global&&(v.lastIndex=0),v.test(A))return y}return null}}}const FH=new BH;class Y4{constructor(e){this.manager=e!==void 0?e:FH,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Y4.DEFAULT_MATERIAL_NAME="__DEFAULT";class UH extends Y4{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=eT.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Vd("img");function l(){A(),eT.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(p){A(),r&&r(p),s.manager.itemError(e),s.manager.itemEnd(e)}function A(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class yg extends Y4{constructor(e){super(e)}load(e,t,i,r){const s=new Cr,o=new UH(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class wh extends ki{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Gt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class OH extends wh{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ki.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Gt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const B3=new on,tT=new re,nT=new re;class Z4{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new rt(512,512),this.mapType=Ji,this.map=null,this.mapPass=null,this.matrix=new on,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new qA,this._frameExtents=new rt(1,1),this._viewportCount=1,this._viewports=[new Kt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;tT.setFromMatrixPosition(e.matrixWorld),t.position.copy(tT),nT.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(nT),t.updateMatrixWorld(),B3.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(B3),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(B3)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class kH extends Z4{constructor(){super(new Er(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=ph*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class H9 extends wh{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ki.DEFAULT_UP),this.updateMatrix(),this.target=new ki,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new kH}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const iT=new on,f0=new re,F3=new re;class VH extends Z4{constructor(){super(new Er(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new rt(4,2),this._viewportCount=6,this._viewports=[new Kt(2,1,1,1),new Kt(0,1,1,1),new Kt(3,1,1,1),new Kt(1,1,1,1),new Kt(3,0,1,1),new Kt(1,0,1,1)],this._cubeDirections=[new re(1,0,0),new re(-1,0,0),new re(0,0,1),new re(0,0,-1),new re(0,1,0),new re(0,-1,0)],this._cubeUps=[new re(0,1,0),new re(0,1,0),new re(0,1,0),new re(0,1,0),new re(0,0,1),new re(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),f0.setFromMatrixPosition(e.matrixWorld),i.position.copy(f0),F3.copy(i.position),F3.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(F3),i.updateMatrixWorld(),r.makeTranslation(-f0.x,-f0.y,-f0.z),iT.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iT)}}class W9 extends wh{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new VH}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class O2 extends bp{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,A=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=A*this.view.offsetY,l=a-A*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class zH extends Z4{constructor(){super(new O2(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class K4 extends wh{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ki.DEFAULT_UP),this.updateMatrix(),this.target=new ki,this.shadow=new zH}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class k2 extends wh{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class qH extends wh{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class GH{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new re)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],1.092548*(i*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(i*s)),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*i),t.addScaledVector(o[4],2*.429043*i*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class HH extends wh{constructor(e=new GH,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class WH extends pi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class $9 extends Er{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class $H extends bl{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isRenderTargetArray=!0,this.depth=i,this.texture=new D2(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class xg extends B2{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}const rT=new on;class jH{constructor(e,t,i=0,r=1/0){this.ray=new xp(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new V4,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return rT.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(rT),this}intersectObject(e,t=!0,i=[]){return By(e,this,i,t),i.sort(sT),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)By(e[r],this,i,t);return i.sort(sT),i}}function sT(n,e){return n.distance-e.distance}function By(n,e,t,i){let r=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(r=!1),r===!0&&i===!0){const s=n.children;for(let o=0,a=s.length;o<a;o++)By(s[o],e,t,!0)}}class oT{constructor(e=1,t=0,i=0){this.radius=e,this.phi=t,this.theta=i}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=In(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(In(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class V2{constructor(e,t,i,r){V2.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let i=0;i<4;i++)this.elements[i]=e[i+t];return this}set(e,t,i,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=i,s[3]=r,this}}const aT=new re,Lm=new re;class XH{constructor(e=new re,t=new re){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){aT.subVectors(e,this.start),Lm.subVectors(this.end,this.start);const i=Lm.dot(Lm);let s=Lm.dot(aT)/i;return t&&(s=In(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class QH{constructor(){this.type="ShapePath",this.color=new Gt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Ly,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(S){const C=[];for(let E=0,R=S.length;E<R;E++){const D=S[E],B=new k1;B.curves=D.curves,C.push(B)}return C}function i(S,C){const E=C.length;let R=!1;for(let D=E-1,B=0;B<E;D=B++){let L=C[D],U=C[B],P=U.x-L.x,F=U.y-L.y;if(Math.abs(F)>Number.EPSILON){if(F<0&&(L=C[B],P=-P,U=C[D],F=-F),S.y<L.y||S.y>U.y)continue;if(S.y===L.y){if(S.x===L.x)return!0}else{const V=F*(S.x-L.x)-P*(S.y-L.y);if(V===0)return!0;if(V<0)continue;R=!R}}else{if(S.y!==L.y)continue;if(U.x<=S.x&&S.x<=L.x||L.x<=S.x&&S.x<=U.x)return!0}}return R}const r=$c.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const u=[];if(s.length===1)return a=s[0],l=new k1,l.curves=a.curves,u.push(l),u;let A=!r(s[0].getPoints());A=e?!A:A;const p=[],g=[];let v=[],y=0,b;g[y]=void 0,v[y]=[];for(let S=0,C=s.length;S<C;S++)a=s[S],b=a.getPoints(),o=r(b),o=e?!o:o,o?(!A&&g[y]&&y++,g[y]={s:new k1,p:b},g[y].s.curves=a.curves,A&&y++,v[y]=[]):v[y].push({h:a,p:b[0]});if(!g[0])return t(s);if(g.length>1){let S=!1,C=0;for(let E=0,R=g.length;E<R;E++)p[E]=[];for(let E=0,R=g.length;E<R;E++){const D=v[E];for(let B=0;B<D.length;B++){const L=D[B];let U=!0;for(let P=0;P<g.length;P++)i(L.p,g[P].p)&&(E!==P&&C++,U?(U=!1,p[P].push(L)):S=!0);U&&p[E].push(L)}}C>0&&S===!1&&(v=p)}let w;for(let S=0,C=g.length;S<C;S++){l=g[S].s,u.push(l),w=v[S];for(let E=0,R=w.length;E<R;E++)l.holes.push(w[E].h)}return u}}class j9 extends xl{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function lT(n,e,t,i){const r=YH(i);switch(t){case R4:return n*e;case yp:return n*e/r.components*r.byteLength;case OA:return n*e/r.components*r.byteLength;case jl:return n*e*2/r.components*r.byteLength;case kA:return n*e*2/r.components*r.byteLength;case vp:return n*e*3/r.components*r.byteLength;case ur:return n*e*4/r.components*r.byteLength;case VA:return n*e*4/r.components*r.byteLength;case eh:case Wu:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case $u:case ju:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Dd:case Bd:return Math.max(n,16)*Math.max(e,8)/4;case Ld:case Id:return Math.max(n,8)*Math.max(e,8)/2;case Fd:case sA:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case oA:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case aA:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case lA:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case uA:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case cA:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case hA:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case fA:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case AA:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case dA:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case pA:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case mA:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case gA:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case _A:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case vA:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case yA:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case th:case Cy:case Ry:return Math.ceil(n/4)*Math.ceil(e/4)*16;case N4:case Ud:return Math.ceil(n/4)*Math.ceil(e/4)*8;case Od:case kd:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function YH(n){switch(n){case Ji:case Kc:return{byteLength:1,components:1};case xa:case Jc:case Dr:return{byteLength:2,components:1};case C2:case R2:return{byteLength:2,components:4};case Ni:case qr:case mr:return{byteLength:4,components:1};case N2:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:gp}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=gp);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function X9(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function ZH(n){const e=new WeakMap;function t(a,l){const u=a.array,A=a.usage,p=u.byteLength,g=n.createBuffer();n.bindBuffer(l,g),n.bufferData(l,u,A),a.onUploadCallback();let v;if(u instanceof Float32Array)v=n.FLOAT;else if(u instanceof Uint16Array)a.isFloat16BufferAttribute?v=n.HALF_FLOAT:v=n.UNSIGNED_SHORT;else if(u instanceof Int16Array)v=n.SHORT;else if(u instanceof Uint32Array)v=n.UNSIGNED_INT;else if(u instanceof Int32Array)v=n.INT;else if(u instanceof Int8Array)v=n.BYTE;else if(u instanceof Uint8Array)v=n.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)v=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:g,type:v,bytesPerElement:u.BYTES_PER_ELEMENT,version:a.version,size:p}}function i(a,l,u){const A=l.array,p=l.updateRanges;if(n.bindBuffer(u,a),p.length===0)n.bufferSubData(u,0,A);else{p.sort((v,y)=>v.start-y.start);let g=0;for(let v=1;v<p.length;v++){const y=p[g],b=p[v];b.start<=y.start+y.count+1?y.count=Math.max(y.count,b.start+b.count-y.start):(++g,p[g]=b)}p.length=g+1;for(let v=0,y=p.length;v<y;v++){const b=p[v];n.bufferSubData(u,b.start*A.BYTES_PER_ELEMENT,A,b.start,b.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(n.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const A=e.get(a);(!A||A.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const u=e.get(a);if(u===void 0)e.set(a,t(a,l));else if(u.version<a.version){if(u.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(u.buffer,a,l),u.version=a.version}}return{get:r,remove:s,update:o}}var KH=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,JH=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,eW=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,tW=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,nW=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,iW=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,rW=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,sW=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,oW=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,aW=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,lW=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,uW=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,cW=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,hW=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,fW=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,AW=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,dW=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,pW=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,mW=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,gW=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,_W=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,vW=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,yW=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,xW=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,bW=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,TW=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,SW=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,wW=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,MW=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,EW=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,CW="gl_FragColor = linearToOutputTexel( gl_FragColor );",RW=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,NW=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,PW=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,LW=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,DW=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,IW=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,BW=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,FW=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,UW=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,OW=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,kW=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,VW=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,zW=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,qW=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,GW=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,HW=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,WW=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,$W=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,jW=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,XW=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,QW=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,YW=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,ZW=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,KW=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,JW=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,e$=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,t$=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,n$=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,i$=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,r$=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,s$=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,o$=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,a$=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,l$=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,u$=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,c$=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,h$=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,f$=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,A$=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,d$=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,p$=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,m$=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,g$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,_$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,v$=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,y$=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,x$=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,b$=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,T$=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,S$=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,w$=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,M$=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,E$=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,C$=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,R$=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,N$=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,P$=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,L$=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,D$=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,I$=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,B$=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,F$=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,U$=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,O$=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,k$=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,V$=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,z$=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,q$=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,G$=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,H$=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,W$=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,$$=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,j$=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,X$=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Q$=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Y$=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Z$=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,K$=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,J$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,ej=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,tj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,nj=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,ij=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,rj=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,sj=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,oj=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,aj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,lj=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,uj=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,cj=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,hj=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fj=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Aj=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,dj=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pj=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,mj=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gj=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,_j=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vj=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,yj=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xj=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,bj=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Tj=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Sj=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wj=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Mj=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Ej=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Cj=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Rj=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Nj=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,kn={alphahash_fragment:KH,alphahash_pars_fragment:JH,alphamap_fragment:eW,alphamap_pars_fragment:tW,alphatest_fragment:nW,alphatest_pars_fragment:iW,aomap_fragment:rW,aomap_pars_fragment:sW,batching_pars_vertex:oW,batching_vertex:aW,begin_vertex:lW,beginnormal_vertex:uW,bsdfs:cW,iridescence_fragment:hW,bumpmap_pars_fragment:fW,clipping_planes_fragment:AW,clipping_planes_pars_fragment:dW,clipping_planes_pars_vertex:pW,clipping_planes_vertex:mW,color_fragment:gW,color_pars_fragment:_W,color_pars_vertex:vW,color_vertex:yW,common:xW,cube_uv_reflection_fragment:bW,defaultnormal_vertex:TW,displacementmap_pars_vertex:SW,displacementmap_vertex:wW,emissivemap_fragment:MW,emissivemap_pars_fragment:EW,colorspace_fragment:CW,colorspace_pars_fragment:RW,envmap_fragment:NW,envmap_common_pars_fragment:PW,envmap_pars_fragment:LW,envmap_pars_vertex:DW,envmap_physical_pars_fragment:HW,envmap_vertex:IW,fog_vertex:BW,fog_pars_vertex:FW,fog_fragment:UW,fog_pars_fragment:OW,gradientmap_pars_fragment:kW,lightmap_pars_fragment:VW,lights_lambert_fragment:zW,lights_lambert_pars_fragment:qW,lights_pars_begin:GW,lights_toon_fragment:WW,lights_toon_pars_fragment:$W,lights_phong_fragment:jW,lights_phong_pars_fragment:XW,lights_physical_fragment:QW,lights_physical_pars_fragment:YW,lights_fragment_begin:ZW,lights_fragment_maps:KW,lights_fragment_end:JW,logdepthbuf_fragment:e$,logdepthbuf_pars_fragment:t$,logdepthbuf_pars_vertex:n$,logdepthbuf_vertex:i$,map_fragment:r$,map_pars_fragment:s$,map_particle_fragment:o$,map_particle_pars_fragment:a$,metalnessmap_fragment:l$,metalnessmap_pars_fragment:u$,morphinstance_vertex:c$,morphcolor_vertex:h$,morphnormal_vertex:f$,morphtarget_pars_vertex:A$,morphtarget_vertex:d$,normal_fragment_begin:p$,normal_fragment_maps:m$,normal_pars_fragment:g$,normal_pars_vertex:_$,normal_vertex:v$,normalmap_pars_fragment:y$,clearcoat_normal_fragment_begin:x$,clearcoat_normal_fragment_maps:b$,clearcoat_pars_fragment:T$,iridescence_pars_fragment:S$,opaque_fragment:w$,packing:M$,premultiplied_alpha_fragment:E$,project_vertex:C$,dithering_fragment:R$,dithering_pars_fragment:N$,roughnessmap_fragment:P$,roughnessmap_pars_fragment:L$,shadowmap_pars_fragment:D$,shadowmap_pars_vertex:I$,shadowmap_vertex:B$,shadowmask_pars_fragment:F$,skinbase_vertex:U$,skinning_pars_vertex:O$,skinning_vertex:k$,skinnormal_vertex:V$,specularmap_fragment:z$,specularmap_pars_fragment:q$,tonemapping_fragment:G$,tonemapping_pars_fragment:H$,transmission_fragment:W$,transmission_pars_fragment:$$,uv_pars_fragment:j$,uv_pars_vertex:X$,uv_vertex:Q$,worldpos_vertex:Y$,background_vert:Z$,background_frag:K$,backgroundCube_vert:J$,backgroundCube_frag:ej,cube_vert:tj,cube_frag:nj,depth_vert:ij,depth_frag:rj,distanceRGBA_vert:sj,distanceRGBA_frag:oj,equirect_vert:aj,equirect_frag:lj,linedashed_vert:uj,linedashed_frag:cj,meshbasic_vert:hj,meshbasic_frag:fj,meshlambert_vert:Aj,meshlambert_frag:dj,meshmatcap_vert:pj,meshmatcap_frag:mj,meshnormal_vert:gj,meshnormal_frag:_j,meshphong_vert:vj,meshphong_frag:yj,meshphysical_vert:xj,meshphysical_frag:bj,meshtoon_vert:Tj,meshtoon_frag:Sj,points_vert:wj,points_frag:Mj,shadow_vert:Ej,shadow_frag:Cj,sprite_vert:Rj,sprite_frag:Nj},It={common:{diffuse:{value:new Gt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new bn},alphaMap:{value:null},alphaMapTransform:{value:new bn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new bn}},envmap:{envMap:{value:null},envMapRotation:{value:new bn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new bn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new bn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new bn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new bn},normalScale:{value:new rt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new bn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new bn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new bn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new bn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Gt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Gt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new bn},alphaTest:{value:0},uvTransform:{value:new bn}},sprite:{diffuse:{value:new Gt(16777215)},opacity:{value:1},center:{value:new rt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new bn},alphaMap:{value:null},alphaMapTransform:{value:new bn},alphaTest:{value:0}}},Ks={basic:{uniforms:Ns([It.common,It.specularmap,It.envmap,It.aomap,It.lightmap,It.fog]),vertexShader:kn.meshbasic_vert,fragmentShader:kn.meshbasic_frag},lambert:{uniforms:Ns([It.common,It.specularmap,It.envmap,It.aomap,It.lightmap,It.emissivemap,It.bumpmap,It.normalmap,It.displacementmap,It.fog,It.lights,{emissive:{value:new Gt(0)}}]),vertexShader:kn.meshlambert_vert,fragmentShader:kn.meshlambert_frag},phong:{uniforms:Ns([It.common,It.specularmap,It.envmap,It.aomap,It.lightmap,It.emissivemap,It.bumpmap,It.normalmap,It.displacementmap,It.fog,It.lights,{emissive:{value:new Gt(0)},specular:{value:new Gt(1118481)},shininess:{value:30}}]),vertexShader:kn.meshphong_vert,fragmentShader:kn.meshphong_frag},standard:{uniforms:Ns([It.common,It.envmap,It.aomap,It.lightmap,It.emissivemap,It.bumpmap,It.normalmap,It.displacementmap,It.roughnessmap,It.metalnessmap,It.fog,It.lights,{emissive:{value:new Gt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:kn.meshphysical_vert,fragmentShader:kn.meshphysical_frag},toon:{uniforms:Ns([It.common,It.aomap,It.lightmap,It.emissivemap,It.bumpmap,It.normalmap,It.displacementmap,It.gradientmap,It.fog,It.lights,{emissive:{value:new Gt(0)}}]),vertexShader:kn.meshtoon_vert,fragmentShader:kn.meshtoon_frag},matcap:{uniforms:Ns([It.common,It.bumpmap,It.normalmap,It.displacementmap,It.fog,{matcap:{value:null}}]),vertexShader:kn.meshmatcap_vert,fragmentShader:kn.meshmatcap_frag},points:{uniforms:Ns([It.points,It.fog]),vertexShader:kn.points_vert,fragmentShader:kn.points_frag},dashed:{uniforms:Ns([It.common,It.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:kn.linedashed_vert,fragmentShader:kn.linedashed_frag},depth:{uniforms:Ns([It.common,It.displacementmap]),vertexShader:kn.depth_vert,fragmentShader:kn.depth_frag},normal:{uniforms:Ns([It.common,It.bumpmap,It.normalmap,It.displacementmap,{opacity:{value:1}}]),vertexShader:kn.meshnormal_vert,fragmentShader:kn.meshnormal_frag},sprite:{uniforms:Ns([It.sprite,It.fog]),vertexShader:kn.sprite_vert,fragmentShader:kn.sprite_frag},background:{uniforms:{uvTransform:{value:new bn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:kn.background_vert,fragmentShader:kn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new bn}},vertexShader:kn.backgroundCube_vert,fragmentShader:kn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:kn.cube_vert,fragmentShader:kn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:kn.equirect_vert,fragmentShader:kn.equirect_frag},distanceRGBA:{uniforms:Ns([It.common,It.displacementmap,{referencePosition:{value:new re},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:kn.distanceRGBA_vert,fragmentShader:kn.distanceRGBA_frag},shadow:{uniforms:Ns([It.lights,It.fog,{color:{value:new Gt(0)},opacity:{value:1}}]),vertexShader:kn.shadow_vert,fragmentShader:kn.shadow_frag}};Ks.physical={uniforms:Ns([Ks.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new bn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new bn},clearcoatNormalScale:{value:new rt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new bn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new bn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new bn},sheen:{value:0},sheenColor:{value:new Gt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new bn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new bn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new bn},transmissionSamplerSize:{value:new rt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new bn},attenuationDistance:{value:0},attenuationColor:{value:new Gt(0)},specularColor:{value:new Gt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new bn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new bn},anisotropyVector:{value:new rt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new bn}}]),vertexShader:kn.meshphysical_vert,fragmentShader:kn.meshphysical_frag};const Dm={r:0,b:0,g:0},wc=new jr,Pj=new on;function Lj(n,e,t,i,r,s,o){const a=new Gt(0);let l=s===!0?0:1,u,A,p=null,g=0,v=null;function y(E){let R=E.isScene===!0?E.background:null;return R&&R.isTexture&&(R=(E.backgroundBlurriness>0?t:e).get(R)),R}function b(E){let R=!1;const D=y(E);D===null?S(a,l):D&&D.isColor&&(S(D,1),R=!0);const B=n.xr.getEnvironmentBlendMode();B==="additive"?i.buffers.color.setClear(0,0,0,1,o):B==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||R)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function w(E,R){const D=y(R);D&&(D.isCubeTexture||D.mapping===fh)?(A===void 0&&(A=new Jn(new oc(1,1,1),new sa({name:"BackgroundCubeMaterial",uniforms:bA(Ks.backgroundCube.uniforms),vertexShader:Ks.backgroundCube.vertexShader,fragmentShader:Ks.backgroundCube.fragmentShader,side:wi,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),A.geometry.deleteAttribute("normal"),A.geometry.deleteAttribute("uv"),A.onBeforeRender=function(B,L,U){this.matrixWorld.copyPosition(U.matrixWorld)},Object.defineProperty(A.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(A)),wc.copy(R.backgroundRotation),wc.x*=-1,wc.y*=-1,wc.z*=-1,D.isCubeTexture&&D.isRenderTargetTexture===!1&&(wc.y*=-1,wc.z*=-1),A.material.uniforms.envMap.value=D,A.material.uniforms.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,A.material.uniforms.backgroundBlurriness.value=R.backgroundBlurriness,A.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,A.material.uniforms.backgroundRotation.value.setFromMatrix4(Pj.makeRotationFromEuler(wc)),A.material.toneMapped=Un.getTransfer(D.colorSpace)!==hi,(p!==D||g!==D.version||v!==n.toneMapping)&&(A.material.needsUpdate=!0,p=D,g=D.version,v=n.toneMapping),A.layers.enableAll(),E.unshift(A,A.geometry,A.material,0,0,null)):D&&D.isTexture&&(u===void 0&&(u=new Jn(new Sp(2,2),new sa({name:"BackgroundMaterial",uniforms:bA(Ks.background.uniforms),vertexShader:Ks.background.vertexShader,fragmentShader:Ks.background.fragmentShader,side:oo,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=D,u.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,u.material.toneMapped=Un.getTransfer(D.colorSpace)!==hi,D.matrixAutoUpdate===!0&&D.updateMatrix(),u.material.uniforms.uvTransform.value.copy(D.matrix),(p!==D||g!==D.version||v!==n.toneMapping)&&(u.material.needsUpdate=!0,p=D,g=D.version,v=n.toneMapping),u.layers.enableAll(),E.unshift(u,u.geometry,u.material,0,0,null))}function S(E,R){E.getRGB(Dm,w9(n)),i.buffers.color.setClear(Dm.r,Dm.g,Dm.b,R,o)}function C(){A!==void 0&&(A.geometry.dispose(),A.material.dispose(),A=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return a},setClearColor:function(E,R=1){a.set(E),l=R,S(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(E){l=E,S(a,l)},render:b,addToRenderList:w,dispose:C}}function Dj(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=g(null);let s=r,o=!1;function a(F,V,H,j,J){let Z=!1;const W=p(j,H,V);s!==W&&(s=W,u(s.object)),Z=v(F,j,H,J),Z&&y(F,j,H,J),J!==null&&e.update(J,n.ELEMENT_ARRAY_BUFFER),(Z||o)&&(o=!1,R(F,V,H,j),J!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(J).buffer))}function l(){return n.createVertexArray()}function u(F){return n.bindVertexArray(F)}function A(F){return n.deleteVertexArray(F)}function p(F,V,H){const j=H.wireframe===!0;let J=i[F.id];J===void 0&&(J={},i[F.id]=J);let Z=J[V.id];Z===void 0&&(Z={},J[V.id]=Z);let W=Z[j];return W===void 0&&(W=g(l()),Z[j]=W),W}function g(F){const V=[],H=[],j=[];for(let J=0;J<t;J++)V[J]=0,H[J]=0,j[J]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:H,attributeDivisors:j,object:F,attributes:{},index:null}}function v(F,V,H,j){const J=s.attributes,Z=V.attributes;let W=0;const K=H.getAttributes();for(const ee in K)if(K[ee].location>=0){const ge=J[ee];let de=Z[ee];if(de===void 0&&(ee==="instanceMatrix"&&F.instanceMatrix&&(de=F.instanceMatrix),ee==="instanceColor"&&F.instanceColor&&(de=F.instanceColor)),ge===void 0||ge.attribute!==de||de&&ge.data!==de.data)return!0;W++}return s.attributesNum!==W||s.index!==j}function y(F,V,H,j){const J={},Z=V.attributes;let W=0;const K=H.getAttributes();for(const ee in K)if(K[ee].location>=0){let ge=Z[ee];ge===void 0&&(ee==="instanceMatrix"&&F.instanceMatrix&&(ge=F.instanceMatrix),ee==="instanceColor"&&F.instanceColor&&(ge=F.instanceColor));const de={};de.attribute=ge,ge&&ge.data&&(de.data=ge.data),J[ee]=de,W++}s.attributes=J,s.attributesNum=W,s.index=j}function b(){const F=s.newAttributes;for(let V=0,H=F.length;V<H;V++)F[V]=0}function w(F){S(F,0)}function S(F,V){const H=s.newAttributes,j=s.enabledAttributes,J=s.attributeDivisors;H[F]=1,j[F]===0&&(n.enableVertexAttribArray(F),j[F]=1),J[F]!==V&&(n.vertexAttribDivisor(F,V),J[F]=V)}function C(){const F=s.newAttributes,V=s.enabledAttributes;for(let H=0,j=V.length;H<j;H++)V[H]!==F[H]&&(n.disableVertexAttribArray(H),V[H]=0)}function E(F,V,H,j,J,Z,W){W===!0?n.vertexAttribIPointer(F,V,H,J,Z):n.vertexAttribPointer(F,V,H,j,J,Z)}function R(F,V,H,j){b();const J=j.attributes,Z=H.getAttributes(),W=V.defaultAttributeValues;for(const K in Z){const ee=Z[K];if(ee.location>=0){let se=J[K];if(se===void 0&&(K==="instanceMatrix"&&F.instanceMatrix&&(se=F.instanceMatrix),K==="instanceColor"&&F.instanceColor&&(se=F.instanceColor)),se!==void 0){const ge=se.normalized,de=se.itemSize,Ae=e.get(se);if(Ae===void 0)continue;const Be=Ae.buffer,ye=Ae.type,De=Ae.bytesPerElement,We=ye===n.INT||ye===n.UNSIGNED_INT||se.gpuType===qr;if(se.isInterleavedBufferAttribute){const $e=se.data,Ke=$e.stride,Xe=se.offset;if($e.isInstancedInterleavedBuffer){for(let st=0;st<ee.locationSize;st++)S(ee.location+st,$e.meshPerAttribute);F.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=$e.meshPerAttribute*$e.count)}else for(let st=0;st<ee.locationSize;st++)w(ee.location+st);n.bindBuffer(n.ARRAY_BUFFER,Be);for(let st=0;st<ee.locationSize;st++)E(ee.location+st,de/ee.locationSize,ye,ge,Ke*De,(Xe+de/ee.locationSize*st)*De,We)}else{if(se.isInstancedBufferAttribute){for(let $e=0;$e<ee.locationSize;$e++)S(ee.location+$e,se.meshPerAttribute);F.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=se.meshPerAttribute*se.count)}else for(let $e=0;$e<ee.locationSize;$e++)w(ee.location+$e);n.bindBuffer(n.ARRAY_BUFFER,Be);for(let $e=0;$e<ee.locationSize;$e++)E(ee.location+$e,de/ee.locationSize,ye,ge,de*De,de/ee.locationSize*$e*De,We)}}else if(W!==void 0){const ge=W[K];if(ge!==void 0)switch(ge.length){case 2:n.vertexAttrib2fv(ee.location,ge);break;case 3:n.vertexAttrib3fv(ee.location,ge);break;case 4:n.vertexAttrib4fv(ee.location,ge);break;default:n.vertexAttrib1fv(ee.location,ge)}}}}C()}function D(){U();for(const F in i){const V=i[F];for(const H in V){const j=V[H];for(const J in j)A(j[J].object),delete j[J];delete V[H]}delete i[F]}}function B(F){if(i[F.id]===void 0)return;const V=i[F.id];for(const H in V){const j=V[H];for(const J in j)A(j[J].object),delete j[J];delete V[H]}delete i[F.id]}function L(F){for(const V in i){const H=i[V];if(H[F.id]===void 0)continue;const j=H[F.id];for(const J in j)A(j[J].object),delete j[J];delete H[F.id]}}function U(){P(),o=!0,s!==r&&(s=r,u(s.object))}function P(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:U,resetDefaultState:P,dispose:D,releaseStatesOfGeometry:B,releaseStatesOfProgram:L,initAttributes:b,enableAttribute:w,disableUnusedAttributes:C}}function Ij(n,e,t){let i;function r(u){i=u}function s(u,A){n.drawArrays(i,u,A),t.update(A,i,1)}function o(u,A,p){p!==0&&(n.drawArraysInstanced(i,u,A,p),t.update(A,i,p))}function a(u,A,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,u,0,A,0,p);let v=0;for(let y=0;y<p;y++)v+=A[y];t.update(v,i,1)}function l(u,A,p,g){if(p===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let y=0;y<u.length;y++)o(u[y],A[y],g[y]);else{v.multiDrawArraysInstancedWEBGL(i,u,0,A,0,g,0,p);let y=0;for(let b=0;b<p;b++)y+=A[b]*g[b];t.update(y,i,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function Bj(n,e,t,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const L=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(L.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(L){return!(L!==ur&&i.convert(L)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(L){const U=L===Dr&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(L!==Ji&&i.convert(L)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&L!==mr&&!U)}function l(L){if(L==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";L="mediump"}return L==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=t.precision!==void 0?t.precision:"highp";const A=l(u);A!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",A,"instead."),u=A);const p=t.logarithmicDepthBuffer===!0,g=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),v=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),y=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),b=n.getParameter(n.MAX_TEXTURE_SIZE),w=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),S=n.getParameter(n.MAX_VERTEX_ATTRIBS),C=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),E=n.getParameter(n.MAX_VARYING_VECTORS),R=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),D=y>0,B=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:u,logarithmicDepthBuffer:p,reverseDepthBuffer:g,maxTextures:v,maxVertexTextures:y,maxTextureSize:b,maxCubemapSize:w,maxAttributes:S,maxVertexUniforms:C,maxVaryings:E,maxFragmentUniforms:R,vertexTextures:D,maxSamples:B}}function Fj(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Ka,a=new bn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(p,g){const v=p.length!==0||g||i!==0||r;return r=g,i=p.length,v},this.beginShadows=function(){s=!0,A(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(p,g){t=A(p,g,0)},this.setState=function(p,g,v){const y=p.clippingPlanes,b=p.clipIntersection,w=p.clipShadows,S=n.get(p);if(!r||y===null||y.length===0||s&&!w)s?A(null):u();else{const C=s?0:i,E=C*4;let R=S.clippingState||null;l.value=R,R=A(y,g,E,v);for(let D=0;D!==E;++D)R[D]=t[D];S.clippingState=R,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=C}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function A(p,g,v,y){const b=p!==null?p.length:0;let w=null;if(b!==0){if(w=l.value,y!==!0||w===null){const S=v+b*4,C=g.matrixWorldInverse;a.getNormalMatrix(C),(w===null||w.length<S)&&(w=new Float32Array(S));for(let E=0,R=v;E!==b;++E,R+=4)o.copy(p[E]).applyMatrix4(C,a),o.normal.toArray(w,R),w[R+3]=o.constant}l.value=w,l.needsUpdate=!0}return e.numPlanes=b,e.numIntersection=0,w}}function Uj(n){let e=new WeakMap;function t(o,a){return a===ch?o.mapping=Pa:a===hh&&(o.mapping=La),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===ch||a===hh)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new E9(l.height);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",r),t(u.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}const Rf=4,uT=[.125,.215,.35,.446,.526,.582],qc=20,U3=new O2,cT=new Gt;let O3=null,k3=0,V3=0,z3=!1;const Oc=(1+Math.sqrt(5))/2,nf=1/Oc,hT=[new re(-Oc,nf,0),new re(Oc,nf,0),new re(-nf,0,Oc),new re(nf,0,Oc),new re(0,Oc,-nf),new re(0,Oc,nf),new re(-1,1,-1),new re(1,1,-1),new re(-1,1,1),new re(1,1,1)],Oj=new re;let fT=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100,s={}){const{size:o=256,position:a=Oj}=s;O3=this._renderer.getRenderTarget(),k3=this._renderer.getActiveCubeFace(),V3=this._renderer.getActiveMipmapLevel(),z3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,i,r,l,a),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=pT(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=dT(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(O3,k3,V3),this._renderer.xr.enabled=z3,e.scissorTest=!1,Im(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Pa||e.mapping===La?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),O3=this._renderer.getRenderTarget(),k3=this._renderer.getActiveCubeFace(),V3=this._renderer.getActiveMipmapLevel(),z3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Lr,minFilter:Lr,generateMipmaps:!1,type:Dr,format:ur,colorSpace:Ma,depthBuffer:!1},r=AT(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=AT(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=kj(s)),this._blurMaterial=Vj(s,e,t)}return r}_compileMaterial(e){const t=new Jn(this._lodPlanes[0],e);this._renderer.compile(t,U3)}_sceneToCubeUV(e,t,i,r,s){const l=new Er(90,1,t,i),u=[1,-1,1,1,1,1],A=[1,1,1,-1,-1,-1],p=this._renderer,g=p.autoClear,v=p.toneMapping;p.getClearColor(cT),p.toneMapping=ao,p.autoClear=!1;const y=new va({name:"PMREM.Background",side:wi,depthWrite:!1,depthTest:!1}),b=new Jn(new oc,y);let w=!1;const S=e.background;S?S.isColor&&(y.color.copy(S),e.background=null,w=!0):(y.color.copy(cT),w=!0);for(let C=0;C<6;C++){const E=C%3;E===0?(l.up.set(0,u[C],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+A[C],s.y,s.z)):E===1?(l.up.set(0,0,u[C]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+A[C],s.z)):(l.up.set(0,u[C],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+A[C]));const R=this._cubeSize;Im(r,E*R,C>2?R:0,R,R),p.setRenderTarget(r),w&&p.render(b,l),p.render(e,l)}b.geometry.dispose(),b.material.dispose(),p.toneMapping=v,p.autoClear=g,e.background=S}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Pa||e.mapping===La;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=pT()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=dT());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Jn(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;Im(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,U3)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=hT[(r-s-1)%hT.length];this._blur(e,s-1,s,o,a)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const A=3,p=new Jn(this._lodPlanes[r],u),g=u.uniforms,v=this._sizeLods[i]-1,y=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*qc-1),b=s/y,w=isFinite(s)?1+Math.floor(A*b):qc;w>qc&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${qc}`);const S=[];let C=0;for(let L=0;L<qc;++L){const U=L/b,P=Math.exp(-U*U/2);S.push(P),L===0?C+=P:L<w&&(C+=2*P)}for(let L=0;L<S.length;L++)S[L]=S[L]/C;g.envMap.value=e.texture,g.samples.value=w,g.weights.value=S,g.latitudinal.value=o==="latitudinal",a&&(g.poleAxis.value=a);const{_lodMax:E}=this;g.dTheta.value=y,g.mipInt.value=E-i;const R=this._sizeLods[r],D=3*R*(r>E-Rf?r-E+Rf:0),B=4*(this._cubeSize-R);Im(t,D,B,3*R,2*R),l.setRenderTarget(t),l.render(p,U3)}};function kj(n){const e=[],t=[],i=[];let r=n;const s=n-Rf+1+uT.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-Rf?l=uT[o-n+Rf-1]:o===0&&(l=0),i.push(l);const u=1/(a-2),A=-u,p=1+u,g=[A,A,p,A,p,p,A,A,p,p,A,p],v=6,y=6,b=3,w=2,S=1,C=new Float32Array(b*y*v),E=new Float32Array(w*y*v),R=new Float32Array(S*y*v);for(let B=0;B<v;B++){const L=B%3*2/3-1,U=B>2?0:-1,P=[L,U,0,L+2/3,U,0,L+2/3,U+1,0,L,U,0,L+2/3,U+1,0,L,U+1,0];C.set(P,b*y*B),E.set(g,w*y*B);const F=[B,B,B,B,B,B];R.set(F,S*y*B)}const D=new pi;D.setAttribute("position",new Xi(C,b)),D.setAttribute("uv",new Xi(E,w)),D.setAttribute("faceIndex",new Xi(R,S)),e.push(D),r>Rf&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function AT(n,e,t){const i=new mh(n,e,t);return i.texture.mapping=fh,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Im(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function Vj(n,e,t){const i=new Float32Array(qc),r=new re(0,1,0);return new sa({name:"SphericalGaussianBlur",defines:{n:qc,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:J4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Do,depthTest:!1,depthWrite:!1})}function dT(){return new sa({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:J4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Do,depthTest:!1,depthWrite:!1})}function pT(){return new sa({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:J4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Do,depthTest:!1,depthWrite:!1})}function J4(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function zj(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,u=l===ch||l===hh,A=l===Pa||l===La;if(u||A){let p=e.get(a);const g=p!==void 0?p.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==g)return t===null&&(t=new fT(n)),p=u?t.fromEquirectangular(a,p):t.fromCubemap(a,p),p.texture.pmremVersion=a.pmremVersion,e.set(a,p),p.texture;if(p!==void 0)return p.texture;{const v=a.image;return u&&v&&v.height>0||A&&v&&r(v)?(t===null&&(t=new fT(n)),p=u?t.fromEquirectangular(a):t.fromCubemap(a),p.texture.pmremVersion=a.pmremVersion,e.set(a,p),a.addEventListener("dispose",s),p.texture):null}}}return a}function r(a){let l=0;const u=6;for(let A=0;A<u;A++)a[A]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function qj(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const r=t(i);return r===null&&Ea("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Gj(n,e,t,i){const r={},s=new WeakMap;function o(p){const g=p.target;g.index!==null&&e.remove(g.index);for(const y in g.attributes)e.remove(g.attributes[y]);g.removeEventListener("dispose",o),delete r[g.id];const v=s.get(g);v&&(e.remove(v),s.delete(g)),i.releaseStatesOfGeometry(g),g.isInstancedBufferGeometry===!0&&delete g._maxInstanceCount,t.memory.geometries--}function a(p,g){return r[g.id]===!0||(g.addEventListener("dispose",o),r[g.id]=!0,t.memory.geometries++),g}function l(p){const g=p.attributes;for(const v in g)e.update(g[v],n.ARRAY_BUFFER)}function u(p){const g=[],v=p.index,y=p.attributes.position;let b=0;if(v!==null){const C=v.array;b=v.version;for(let E=0,R=C.length;E<R;E+=3){const D=C[E+0],B=C[E+1],L=C[E+2];g.push(D,B,B,L,L,D)}}else if(y!==void 0){const C=y.array;b=y.version;for(let E=0,R=C.length/3-1;E<R;E+=3){const D=E+0,B=E+1,L=E+2;g.push(D,B,B,L,L,D)}}else return;const w=new(O4(g)?q4:z4)(g,1);w.version=b;const S=s.get(p);S&&e.remove(S),s.set(p,w)}function A(p){const g=s.get(p);if(g){const v=p.index;v!==null&&g.version<v.version&&u(p)}else u(p);return s.get(p)}return{get:a,update:l,getWireframeAttribute:A}}function Hj(n,e,t){let i;function r(g){i=g}let s,o;function a(g){s=g.type,o=g.bytesPerElement}function l(g,v){n.drawElements(i,v,s,g*o),t.update(v,i,1)}function u(g,v,y){y!==0&&(n.drawElementsInstanced(i,v,s,g*o,y),t.update(v,i,y))}function A(g,v,y){if(y===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,v,0,s,g,0,y);let w=0;for(let S=0;S<y;S++)w+=v[S];t.update(w,i,1)}function p(g,v,y,b){if(y===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let S=0;S<g.length;S++)u(g[S]/o,v[S],b[S]);else{w.multiDrawElementsInstancedWEBGL(i,v,0,s,g,0,b,0,y);let S=0;for(let C=0;C<y;C++)S+=v[C]*b[C];t.update(S,i,1)}}this.setMode=r,this.setIndex=a,this.render=l,this.renderInstances=u,this.renderMultiDraw=A,this.renderMultiDrawInstances=p}function Wj(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function $j(n,e,t){const i=new WeakMap,r=new Kt;function s(o,a,l){const u=o.morphTargetInfluences,A=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,p=A!==void 0?A.length:0;let g=i.get(a);if(g===void 0||g.count!==p){let F=function(){U.dispose(),i.delete(a),a.removeEventListener("dispose",F)};var v=F;g!==void 0&&g.texture.dispose();const y=a.morphAttributes.position!==void 0,b=a.morphAttributes.normal!==void 0,w=a.morphAttributes.color!==void 0,S=a.morphAttributes.position||[],C=a.morphAttributes.normal||[],E=a.morphAttributes.color||[];let R=0;y===!0&&(R=1),b===!0&&(R=2),w===!0&&(R=3);let D=a.attributes.position.count*R,B=1;D>e.maxTextureSize&&(B=Math.ceil(D/e.maxTextureSize),D=e.maxTextureSize);const L=new Float32Array(D*B*4*p),U=new D2(L,D,B,p);U.type=mr,U.needsUpdate=!0;const P=R*4;for(let V=0;V<p;V++){const H=S[V],j=C[V],J=E[V],Z=D*B*4*V;for(let W=0;W<H.count;W++){const K=W*P;y===!0&&(r.fromBufferAttribute(H,W),L[Z+K+0]=r.x,L[Z+K+1]=r.y,L[Z+K+2]=r.z,L[Z+K+3]=0),b===!0&&(r.fromBufferAttribute(j,W),L[Z+K+4]=r.x,L[Z+K+5]=r.y,L[Z+K+6]=r.z,L[Z+K+7]=0),w===!0&&(r.fromBufferAttribute(J,W),L[Z+K+8]=r.x,L[Z+K+9]=r.y,L[Z+K+10]=r.z,L[Z+K+11]=J.itemSize===4?r.w:1)}}g={count:p,texture:U,size:new rt(D,B)},i.set(a,g),a.addEventListener("dispose",F)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(n,"morphTexture",o.morphTexture,t);else{let y=0;for(let w=0;w<u.length;w++)y+=u[w];const b=a.morphTargetsRelative?1:1-y;l.getUniforms().setValue(n,"morphTargetBaseInfluence",b),l.getUniforms().setValue(n,"morphTargetInfluences",u)}l.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}return{update:s}}function jj(n,e,t,i){let r=new WeakMap;function s(l){const u=i.render.frame,A=l.geometry,p=e.get(l,A);if(r.get(p)!==u&&(e.update(p),r.set(p,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,u))),l.isSkinnedMesh){const g=l.skeleton;r.get(g)!==u&&(g.update(),r.set(g,u))}return p}function o(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}const Q9=new Cr,mT=new lo(1,1),Y9=new D2,Z9=new EG,K9=new I2,gT=[],_T=[],vT=new Float32Array(16),yT=new Float32Array(9),xT=new Float32Array(4);function GA(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=gT[r];if(s===void 0&&(s=new Float32Array(r),gT[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Ir(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Br(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function z2(n,e){let t=_T[e];t===void 0&&(t=new Int32Array(e),_T[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Xj(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Qj(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ir(t,e))return;n.uniform2fv(this.addr,e),Br(t,e)}}function Yj(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ir(t,e))return;n.uniform3fv(this.addr,e),Br(t,e)}}function Zj(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ir(t,e))return;n.uniform4fv(this.addr,e),Br(t,e)}}function Kj(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ir(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Br(t,e)}else{if(Ir(t,i))return;xT.set(i),n.uniformMatrix2fv(this.addr,!1,xT),Br(t,i)}}function Jj(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ir(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Br(t,e)}else{if(Ir(t,i))return;yT.set(i),n.uniformMatrix3fv(this.addr,!1,yT),Br(t,i)}}function eX(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ir(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Br(t,e)}else{if(Ir(t,i))return;vT.set(i),n.uniformMatrix4fv(this.addr,!1,vT),Br(t,i)}}function tX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function nX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ir(t,e))return;n.uniform2iv(this.addr,e),Br(t,e)}}function iX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ir(t,e))return;n.uniform3iv(this.addr,e),Br(t,e)}}function rX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ir(t,e))return;n.uniform4iv(this.addr,e),Br(t,e)}}function sX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function oX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ir(t,e))return;n.uniform2uiv(this.addr,e),Br(t,e)}}function aX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ir(t,e))return;n.uniform3uiv(this.addr,e),Br(t,e)}}function lX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ir(t,e))return;n.uniform4uiv(this.addr,e),Br(t,e)}}function uX(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);let s;this.type===n.SAMPLER_2D_SHADOW?(mT.compareFunction=L2,s=mT):s=Q9,t.setTexture2D(e||s,r)}function cX(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||Z9,r)}function hX(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||K9,r)}function fX(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||Y9,r)}function AX(n){switch(n){case 5126:return Xj;case 35664:return Qj;case 35665:return Yj;case 35666:return Zj;case 35674:return Kj;case 35675:return Jj;case 35676:return eX;case 5124:case 35670:return tX;case 35667:case 35671:return nX;case 35668:case 35672:return iX;case 35669:case 35673:return rX;case 5125:return sX;case 36294:return oX;case 36295:return aX;case 36296:return lX;case 35678:case 36198:case 36298:case 36306:case 35682:return uX;case 35679:case 36299:case 36307:return cX;case 35680:case 36300:case 36308:case 36293:return hX;case 36289:case 36303:case 36311:case 36292:return fX}}function dX(n,e){n.uniform1fv(this.addr,e)}function pX(n,e){const t=GA(e,this.size,2);n.uniform2fv(this.addr,t)}function mX(n,e){const t=GA(e,this.size,3);n.uniform3fv(this.addr,t)}function gX(n,e){const t=GA(e,this.size,4);n.uniform4fv(this.addr,t)}function _X(n,e){const t=GA(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function vX(n,e){const t=GA(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function yX(n,e){const t=GA(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function xX(n,e){n.uniform1iv(this.addr,e)}function bX(n,e){n.uniform2iv(this.addr,e)}function TX(n,e){n.uniform3iv(this.addr,e)}function SX(n,e){n.uniform4iv(this.addr,e)}function wX(n,e){n.uniform1uiv(this.addr,e)}function MX(n,e){n.uniform2uiv(this.addr,e)}function EX(n,e){n.uniform3uiv(this.addr,e)}function CX(n,e){n.uniform4uiv(this.addr,e)}function RX(n,e,t){const i=this.cache,r=e.length,s=z2(t,r);Ir(i,s)||(n.uniform1iv(this.addr,s),Br(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||Q9,s[o])}function NX(n,e,t){const i=this.cache,r=e.length,s=z2(t,r);Ir(i,s)||(n.uniform1iv(this.addr,s),Br(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||Z9,s[o])}function PX(n,e,t){const i=this.cache,r=e.length,s=z2(t,r);Ir(i,s)||(n.uniform1iv(this.addr,s),Br(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||K9,s[o])}function LX(n,e,t){const i=this.cache,r=e.length,s=z2(t,r);Ir(i,s)||(n.uniform1iv(this.addr,s),Br(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||Y9,s[o])}function DX(n){switch(n){case 5126:return dX;case 35664:return pX;case 35665:return mX;case 35666:return gX;case 35674:return _X;case 35675:return vX;case 35676:return yX;case 5124:case 35670:return xX;case 35667:case 35671:return bX;case 35668:case 35672:return TX;case 35669:case 35673:return SX;case 5125:return wX;case 36294:return MX;case 36295:return EX;case 36296:return CX;case 35678:case 36198:case 36298:case 36306:case 35682:return RX;case 35679:case 36299:case 36307:return NX;case 35680:case 36300:case 36308:case 36293:return PX;case 36289:case 36303:case 36311:case 36292:return LX}}class IX{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=AX(t.type)}}class BX{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=DX(t.type)}}class FX{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const q3=/(\w+)(\])?(\[|\.)?/g;function bT(n,e){n.seq.push(e),n.map[e.id]=e}function UX(n,e,t){const i=n.name,r=i.length;for(q3.lastIndex=0;;){const s=q3.exec(i),o=q3.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===r){bT(t,u===void 0?new IX(a,n,e):new BX(a,n,e));break}else{let p=t.map[a];p===void 0&&(p=new FX(a),bT(t,p)),t=p}}}class V1{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);UX(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function TT(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const OX=37297;let kX=0;function VX(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}const ST=new bn;function zX(n){Un._getMatrix(ST,Un.workingColorSpace,n);const e=`mat3( ${ST.elements.map(t=>t.toFixed(4))} )`;switch(Un.getTransfer(n)){case dg:return[e,"LinearTransferOETF"];case hi:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function wT(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+VX(n.getShaderSource(e),o)}else return r}function qX(n,e){const t=zX(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function GX(n,e){let t;switch(e){case p9:t="Linear";break;case m9:t="Reinhard";break;case g9:t="Cineon";break;case _9:t="ACESFilmic";break;case v9:t="AgX";break;case y9:t="Neutral";break;case Uq:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Bm=new re;function HX(){Un.getLuminanceCoefficients(Bm);const n=Bm.x.toFixed(4),e=Bm.y.toFixed(4),t=Bm.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function WX(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(V0).join(`
`)}function $X(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function jX(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function V0(n){return n!==""}function MT(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function ET(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const XX=/^[ \t]*#include +<([\w\d./]+)>/gm;function Fy(n){return n.replace(XX,YX)}const QX=new Map;function YX(n,e){let t=kn[e];if(t===void 0){const i=QX.get(e);if(i!==void 0)t=kn[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return Fy(t)}const ZX=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function CT(n){return n.replace(ZX,KX)}function KX(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function RT(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function JX(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===m4?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===Lq?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===wo&&(e="SHADOWMAP_TYPE_VSM"),e}function eQ(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Pa:case La:e="ENVMAP_TYPE_CUBE";break;case fh:e="ENVMAP_TYPE_CUBE_UV";break}return e}function tQ(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case La:e="ENVMAP_MODE_REFRACTION";break}return e}function nQ(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case _p:e="ENVMAP_BLENDING_MULTIPLY";break;case A9:e="ENVMAP_BLENDING_MIX";break;case d9:e="ENVMAP_BLENDING_ADD";break}return e}function iQ(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function rQ(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=JX(t),u=eQ(t),A=tQ(t),p=nQ(t),g=iQ(t),v=WX(t),y=$X(s),b=r.createProgram();let w,S,C=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(V0).join(`
`),w.length>0&&(w+=`
`),S=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(V0).join(`
`),S.length>0&&(S+=`
`)):(w=[RT(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+A:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(V0).join(`
`),S=[RT(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+A:"",t.envMap?"#define "+p:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ao?"#define TONE_MAPPING":"",t.toneMapping!==ao?kn.tonemapping_pars_fragment:"",t.toneMapping!==ao?GX("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",kn.colorspace_pars_fragment,qX("linearToOutputTexel",t.outputColorSpace),HX(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(V0).join(`
`)),o=Fy(o),o=MT(o,t),o=ET(o,t),a=Fy(a),a=MT(a,t),a=ET(a,t),o=CT(o),a=CT(a),t.isRawShaderMaterial!==!0&&(C=`#version 300 es
`,w=[v,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,S=["#define varying in",t.glslVersion===b6?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===b6?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const E=C+w+o,R=C+S+a,D=TT(r,r.VERTEX_SHADER,E),B=TT(r,r.FRAGMENT_SHADER,R);r.attachShader(b,D),r.attachShader(b,B),t.index0AttributeName!==void 0?r.bindAttribLocation(b,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(b,0,"position"),r.linkProgram(b);function L(V){if(n.debug.checkShaderErrors){const H=r.getProgramInfoLog(b).trim(),j=r.getShaderInfoLog(D).trim(),J=r.getShaderInfoLog(B).trim();let Z=!0,W=!0;if(r.getProgramParameter(b,r.LINK_STATUS)===!1)if(Z=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,b,D,B);else{const K=wT(r,D,"vertex"),ee=wT(r,B,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(b,r.VALIDATE_STATUS)+`

Material Name: `+V.name+`
Material Type: `+V.type+`

Program Info Log: `+H+`
`+K+`
`+ee)}else H!==""?console.warn("THREE.WebGLProgram: Program Info Log:",H):(j===""||J==="")&&(W=!1);W&&(V.diagnostics={runnable:Z,programLog:H,vertexShader:{log:j,prefix:w},fragmentShader:{log:J,prefix:S}})}r.deleteShader(D),r.deleteShader(B),U=new V1(r,b),P=jX(r,b)}let U;this.getUniforms=function(){return U===void 0&&L(this),U};let P;this.getAttributes=function(){return P===void 0&&L(this),P};let F=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return F===!1&&(F=r.getProgramParameter(b,OX)),F},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(b),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=kX++,this.cacheKey=e,this.usedTimes=1,this.program=b,this.vertexShader=D,this.fragmentShader=B,this}let sQ=0;class oQ{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new aQ(e),t.set(e,i)),i}}class aQ{constructor(e){this.id=sQ++,this.code=e,this.usedTimes=0}}function lQ(n,e,t,i,r,s,o){const a=new V4,l=new oQ,u=new Set,A=[],p=r.logarithmicDepthBuffer,g=r.vertexTextures;let v=r.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function b(P){return u.add(P),P===0?"uv":`uv${P}`}function w(P,F,V,H,j){const J=H.fog,Z=j.geometry,W=P.isMeshStandardMaterial?H.environment:null,K=(P.isMeshStandardMaterial?t:e).get(P.envMap||W),ee=K&&K.mapping===fh?K.image.height:null,se=y[P.type];P.precision!==null&&(v=r.getMaxPrecision(P.precision),v!==P.precision&&console.warn("THREE.WebGLProgram.getParameters:",P.precision,"not supported, using",v,"instead."));const ge=Z.morphAttributes.position||Z.morphAttributes.normal||Z.morphAttributes.color,de=ge!==void 0?ge.length:0;let Ae=0;Z.morphAttributes.position!==void 0&&(Ae=1),Z.morphAttributes.normal!==void 0&&(Ae=2),Z.morphAttributes.color!==void 0&&(Ae=3);let Be,ye,De,We;if(se){const tn=Ks[se];Be=tn.vertexShader,ye=tn.fragmentShader}else Be=P.vertexShader,ye=P.fragmentShader,l.update(P),De=l.getVertexShaderID(P),We=l.getFragmentShaderID(P);const $e=n.getRenderTarget(),Ke=n.state.buffers.depth.getReversed(),Xe=j.isInstancedMesh===!0,st=j.isBatchedMesh===!0,gt=!!P.map,ae=!!P.matcap,le=!!K,G=!!P.aoMap,Te=!!P.lightMap,pe=!!P.bumpMap,me=!!P.normalMap,ve=!!P.displacementMap,qe=!!P.emissiveMap,Me=!!P.metalnessMap,$=!!P.roughnessMap,z=P.anisotropy>0,fe=P.clearcoat>0,xe=P.dispersion>0,Le=P.iridescence>0,Ne=P.sheen>0,ot=P.transmission>0,Qe=z&&!!P.anisotropyMap,xt=fe&&!!P.clearcoatMap,bt=fe&&!!P.clearcoatNormalMap,nt=fe&&!!P.clearcoatRoughnessMap,At=Le&&!!P.iridescenceMap,Dt=Le&&!!P.iridescenceThicknessMap,Ot=Ne&&!!P.sheenColorMap,dt=Ne&&!!P.sheenRoughnessMap,kt=!!P.specularMap,Lt=!!P.specularColorMap,$t=!!P.specularIntensityMap,ie=ot&&!!P.transmissionMap,Mt=ot&&!!P.thicknessMap,je=!!P.gradientMap,q=!!P.alphaMap,Pt=P.alphaTest>0,wt=!!P.alphaHash,sn=!!P.extensions;let $n=ao;P.toneMapped&&($e===null||$e.isXRRenderTarget===!0)&&($n=n.toneMapping);const Rn={shaderID:se,shaderType:P.type,shaderName:P.name,vertexShader:Be,fragmentShader:ye,defines:P.defines,customVertexShaderID:De,customFragmentShaderID:We,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:v,batching:st,batchingColor:st&&j._colorsTexture!==null,instancing:Xe,instancingColor:Xe&&j.instanceColor!==null,instancingMorph:Xe&&j.morphTexture!==null,supportsVertexTextures:g,outputColorSpace:$e===null?n.outputColorSpace:$e.isXRRenderTarget===!0?$e.texture.colorSpace:Ma,alphaToCoverage:!!P.alphaToCoverage,map:gt,matcap:ae,envMap:le,envMapMode:le&&K.mapping,envMapCubeUVHeight:ee,aoMap:G,lightMap:Te,bumpMap:pe,normalMap:me,displacementMap:g&&ve,emissiveMap:qe,normalMapObjectSpace:me&&P.normalMapType===x9,normalMapTangentSpace:me&&P.normalMapType===Jl,metalnessMap:Me,roughnessMap:$,anisotropy:z,anisotropyMap:Qe,clearcoat:fe,clearcoatMap:xt,clearcoatNormalMap:bt,clearcoatRoughnessMap:nt,dispersion:xe,iridescence:Le,iridescenceMap:At,iridescenceThicknessMap:Dt,sheen:Ne,sheenColorMap:Ot,sheenRoughnessMap:dt,specularMap:kt,specularColorMap:Lt,specularIntensityMap:$t,transmission:ot,transmissionMap:ie,thicknessMap:Mt,gradientMap:je,opaque:P.transparent===!1&&P.blending===Gs&&P.alphaToCoverage===!1,alphaMap:q,alphaTest:Pt,alphaHash:wt,combine:P.combine,mapUv:gt&&b(P.map.channel),aoMapUv:G&&b(P.aoMap.channel),lightMapUv:Te&&b(P.lightMap.channel),bumpMapUv:pe&&b(P.bumpMap.channel),normalMapUv:me&&b(P.normalMap.channel),displacementMapUv:ve&&b(P.displacementMap.channel),emissiveMapUv:qe&&b(P.emissiveMap.channel),metalnessMapUv:Me&&b(P.metalnessMap.channel),roughnessMapUv:$&&b(P.roughnessMap.channel),anisotropyMapUv:Qe&&b(P.anisotropyMap.channel),clearcoatMapUv:xt&&b(P.clearcoatMap.channel),clearcoatNormalMapUv:bt&&b(P.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:nt&&b(P.clearcoatRoughnessMap.channel),iridescenceMapUv:At&&b(P.iridescenceMap.channel),iridescenceThicknessMapUv:Dt&&b(P.iridescenceThicknessMap.channel),sheenColorMapUv:Ot&&b(P.sheenColorMap.channel),sheenRoughnessMapUv:dt&&b(P.sheenRoughnessMap.channel),specularMapUv:kt&&b(P.specularMap.channel),specularColorMapUv:Lt&&b(P.specularColorMap.channel),specularIntensityMapUv:$t&&b(P.specularIntensityMap.channel),transmissionMapUv:ie&&b(P.transmissionMap.channel),thicknessMapUv:Mt&&b(P.thicknessMap.channel),alphaMapUv:q&&b(P.alphaMap.channel),vertexTangents:!!Z.attributes.tangent&&(me||z),vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&!!Z.attributes.color&&Z.attributes.color.itemSize===4,pointsUvs:j.isPoints===!0&&!!Z.attributes.uv&&(gt||q),fog:!!J,useFog:P.fog===!0,fogExp2:!!J&&J.isFogExp2,flatShading:P.flatShading===!0,sizeAttenuation:P.sizeAttenuation===!0,logarithmicDepthBuffer:p,reverseDepthBuffer:Ke,skinning:j.isSkinnedMesh===!0,morphTargets:Z.morphAttributes.position!==void 0,morphNormals:Z.morphAttributes.normal!==void 0,morphColors:Z.morphAttributes.color!==void 0,morphTargetsCount:de,morphTextureStride:Ae,numDirLights:F.directional.length,numPointLights:F.point.length,numSpotLights:F.spot.length,numSpotLightMaps:F.spotLightMap.length,numRectAreaLights:F.rectArea.length,numHemiLights:F.hemi.length,numDirLightShadows:F.directionalShadowMap.length,numPointLightShadows:F.pointShadowMap.length,numSpotLightShadows:F.spotShadowMap.length,numSpotLightShadowsWithMaps:F.numSpotLightShadowsWithMaps,numLightProbes:F.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:P.dithering,shadowMapEnabled:n.shadowMap.enabled&&V.length>0,shadowMapType:n.shadowMap.type,toneMapping:$n,decodeVideoTexture:gt&&P.map.isVideoTexture===!0&&Un.getTransfer(P.map.colorSpace)===hi,decodeVideoTextureEmissive:qe&&P.emissiveMap.isVideoTexture===!0&&Un.getTransfer(P.emissiveMap.colorSpace)===hi,premultipliedAlpha:P.premultipliedAlpha,doubleSided:P.side===ar,flipSided:P.side===wi,useDepthPacking:P.depthPacking>=0,depthPacking:P.depthPacking||0,index0AttributeName:P.index0AttributeName,extensionClipCullDistance:sn&&P.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(sn&&P.extensions.multiDraw===!0||st)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:P.customProgramCacheKey()};return Rn.vertexUv1s=u.has(1),Rn.vertexUv2s=u.has(2),Rn.vertexUv3s=u.has(3),u.clear(),Rn}function S(P){const F=[];if(P.shaderID?F.push(P.shaderID):(F.push(P.customVertexShaderID),F.push(P.customFragmentShaderID)),P.defines!==void 0)for(const V in P.defines)F.push(V),F.push(P.defines[V]);return P.isRawShaderMaterial===!1&&(C(F,P),E(F,P),F.push(n.outputColorSpace)),F.push(P.customProgramCacheKey),F.join()}function C(P,F){P.push(F.precision),P.push(F.outputColorSpace),P.push(F.envMapMode),P.push(F.envMapCubeUVHeight),P.push(F.mapUv),P.push(F.alphaMapUv),P.push(F.lightMapUv),P.push(F.aoMapUv),P.push(F.bumpMapUv),P.push(F.normalMapUv),P.push(F.displacementMapUv),P.push(F.emissiveMapUv),P.push(F.metalnessMapUv),P.push(F.roughnessMapUv),P.push(F.anisotropyMapUv),P.push(F.clearcoatMapUv),P.push(F.clearcoatNormalMapUv),P.push(F.clearcoatRoughnessMapUv),P.push(F.iridescenceMapUv),P.push(F.iridescenceThicknessMapUv),P.push(F.sheenColorMapUv),P.push(F.sheenRoughnessMapUv),P.push(F.specularMapUv),P.push(F.specularColorMapUv),P.push(F.specularIntensityMapUv),P.push(F.transmissionMapUv),P.push(F.thicknessMapUv),P.push(F.combine),P.push(F.fogExp2),P.push(F.sizeAttenuation),P.push(F.morphTargetsCount),P.push(F.morphAttributeCount),P.push(F.numDirLights),P.push(F.numPointLights),P.push(F.numSpotLights),P.push(F.numSpotLightMaps),P.push(F.numHemiLights),P.push(F.numRectAreaLights),P.push(F.numDirLightShadows),P.push(F.numPointLightShadows),P.push(F.numSpotLightShadows),P.push(F.numSpotLightShadowsWithMaps),P.push(F.numLightProbes),P.push(F.shadowMapType),P.push(F.toneMapping),P.push(F.numClippingPlanes),P.push(F.numClipIntersection),P.push(F.depthPacking)}function E(P,F){a.disableAll(),F.supportsVertexTextures&&a.enable(0),F.instancing&&a.enable(1),F.instancingColor&&a.enable(2),F.instancingMorph&&a.enable(3),F.matcap&&a.enable(4),F.envMap&&a.enable(5),F.normalMapObjectSpace&&a.enable(6),F.normalMapTangentSpace&&a.enable(7),F.clearcoat&&a.enable(8),F.iridescence&&a.enable(9),F.alphaTest&&a.enable(10),F.vertexColors&&a.enable(11),F.vertexAlphas&&a.enable(12),F.vertexUv1s&&a.enable(13),F.vertexUv2s&&a.enable(14),F.vertexUv3s&&a.enable(15),F.vertexTangents&&a.enable(16),F.anisotropy&&a.enable(17),F.alphaHash&&a.enable(18),F.batching&&a.enable(19),F.dispersion&&a.enable(20),F.batchingColor&&a.enable(21),P.push(a.mask),a.disableAll(),F.fog&&a.enable(0),F.useFog&&a.enable(1),F.flatShading&&a.enable(2),F.logarithmicDepthBuffer&&a.enable(3),F.reverseDepthBuffer&&a.enable(4),F.skinning&&a.enable(5),F.morphTargets&&a.enable(6),F.morphNormals&&a.enable(7),F.morphColors&&a.enable(8),F.premultipliedAlpha&&a.enable(9),F.shadowMapEnabled&&a.enable(10),F.doubleSided&&a.enable(11),F.flipSided&&a.enable(12),F.useDepthPacking&&a.enable(13),F.dithering&&a.enable(14),F.transmission&&a.enable(15),F.sheen&&a.enable(16),F.opaque&&a.enable(17),F.pointsUvs&&a.enable(18),F.decodeVideoTexture&&a.enable(19),F.decodeVideoTextureEmissive&&a.enable(20),F.alphaToCoverage&&a.enable(21),P.push(a.mask)}function R(P){const F=y[P.type];let V;if(F){const H=Ks[F];V=G4.clone(H.uniforms)}else V=P.uniforms;return V}function D(P,F){let V;for(let H=0,j=A.length;H<j;H++){const J=A[H];if(J.cacheKey===F){V=J,++V.usedTimes;break}}return V===void 0&&(V=new rQ(n,F,P,s),A.push(V)),V}function B(P){if(--P.usedTimes===0){const F=A.indexOf(P);A[F]=A[A.length-1],A.pop(),P.destroy()}}function L(P){l.remove(P)}function U(){l.dispose()}return{getParameters:w,getProgramCacheKey:S,getUniforms:R,acquireProgram:D,releaseProgram:B,releaseShaderCache:L,programs:A,dispose:U}}function uQ(){let n=new WeakMap;function e(o){return n.has(o)}function t(o){let a=n.get(o);return a===void 0&&(a={},n.set(o,a)),a}function i(o){n.delete(o)}function r(o,a,l){n.get(o)[a]=l}function s(){n=new WeakMap}return{has:e,get:t,remove:i,update:r,dispose:s}}function cQ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function NT(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function PT(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(p,g,v,y,b,w){let S=n[e];return S===void 0?(S={id:p.id,object:p,geometry:g,material:v,groupOrder:y,renderOrder:p.renderOrder,z:b,group:w},n[e]=S):(S.id=p.id,S.object=p,S.geometry=g,S.material=v,S.groupOrder=y,S.renderOrder=p.renderOrder,S.z=b,S.group=w),e++,S}function a(p,g,v,y,b,w){const S=o(p,g,v,y,b,w);v.transmission>0?i.push(S):v.transparent===!0?r.push(S):t.push(S)}function l(p,g,v,y,b,w){const S=o(p,g,v,y,b,w);v.transmission>0?i.unshift(S):v.transparent===!0?r.unshift(S):t.unshift(S)}function u(p,g){t.length>1&&t.sort(p||cQ),i.length>1&&i.sort(g||NT),r.length>1&&r.sort(g||NT)}function A(){for(let p=e,g=n.length;p<g;p++){const v=n[p];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:A,sort:u}}function hQ(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new PT,n.set(i,[o])):r>=s.length?(o=new PT,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function fQ(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new re,color:new Gt};break;case"SpotLight":t={position:new re,direction:new re,color:new Gt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new re,color:new Gt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new re,skyColor:new Gt,groundColor:new Gt};break;case"RectAreaLight":t={color:new Gt,position:new re,halfWidth:new re,halfHeight:new re};break}return n[e.id]=t,t}}}function AQ(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new rt};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new rt};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new rt,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let dQ=0;function pQ(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function mQ(n){const e=new fQ,t=AQ(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new re);const r=new re,s=new on,o=new on;function a(u){let A=0,p=0,g=0;for(let P=0;P<9;P++)i.probe[P].set(0,0,0);let v=0,y=0,b=0,w=0,S=0,C=0,E=0,R=0,D=0,B=0,L=0;u.sort(pQ);for(let P=0,F=u.length;P<F;P++){const V=u[P],H=V.color,j=V.intensity,J=V.distance,Z=V.shadow&&V.shadow.map?V.shadow.map.texture:null;if(V.isAmbientLight)A+=H.r*j,p+=H.g*j,g+=H.b*j;else if(V.isLightProbe){for(let W=0;W<9;W++)i.probe[W].addScaledVector(V.sh.coefficients[W],j);L++}else if(V.isDirectionalLight){const W=e.get(V);if(W.color.copy(V.color).multiplyScalar(V.intensity),V.castShadow){const K=V.shadow,ee=t.get(V);ee.shadowIntensity=K.intensity,ee.shadowBias=K.bias,ee.shadowNormalBias=K.normalBias,ee.shadowRadius=K.radius,ee.shadowMapSize=K.mapSize,i.directionalShadow[v]=ee,i.directionalShadowMap[v]=Z,i.directionalShadowMatrix[v]=V.shadow.matrix,C++}i.directional[v]=W,v++}else if(V.isSpotLight){const W=e.get(V);W.position.setFromMatrixPosition(V.matrixWorld),W.color.copy(H).multiplyScalar(j),W.distance=J,W.coneCos=Math.cos(V.angle),W.penumbraCos=Math.cos(V.angle*(1-V.penumbra)),W.decay=V.decay,i.spot[b]=W;const K=V.shadow;if(V.map&&(i.spotLightMap[D]=V.map,D++,K.updateMatrices(V),V.castShadow&&B++),i.spotLightMatrix[b]=K.matrix,V.castShadow){const ee=t.get(V);ee.shadowIntensity=K.intensity,ee.shadowBias=K.bias,ee.shadowNormalBias=K.normalBias,ee.shadowRadius=K.radius,ee.shadowMapSize=K.mapSize,i.spotShadow[b]=ee,i.spotShadowMap[b]=Z,R++}b++}else if(V.isRectAreaLight){const W=e.get(V);W.color.copy(H).multiplyScalar(j),W.halfWidth.set(V.width*.5,0,0),W.halfHeight.set(0,V.height*.5,0),i.rectArea[w]=W,w++}else if(V.isPointLight){const W=e.get(V);if(W.color.copy(V.color).multiplyScalar(V.intensity),W.distance=V.distance,W.decay=V.decay,V.castShadow){const K=V.shadow,ee=t.get(V);ee.shadowIntensity=K.intensity,ee.shadowBias=K.bias,ee.shadowNormalBias=K.normalBias,ee.shadowRadius=K.radius,ee.shadowMapSize=K.mapSize,ee.shadowCameraNear=K.camera.near,ee.shadowCameraFar=K.camera.far,i.pointShadow[y]=ee,i.pointShadowMap[y]=Z,i.pointShadowMatrix[y]=V.shadow.matrix,E++}i.point[y]=W,y++}else if(V.isHemisphereLight){const W=e.get(V);W.skyColor.copy(V.color).multiplyScalar(j),W.groundColor.copy(V.groundColor).multiplyScalar(j),i.hemi[S]=W,S++}}w>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=It.LTC_FLOAT_1,i.rectAreaLTC2=It.LTC_FLOAT_2):(i.rectAreaLTC1=It.LTC_HALF_1,i.rectAreaLTC2=It.LTC_HALF_2)),i.ambient[0]=A,i.ambient[1]=p,i.ambient[2]=g;const U=i.hash;(U.directionalLength!==v||U.pointLength!==y||U.spotLength!==b||U.rectAreaLength!==w||U.hemiLength!==S||U.numDirectionalShadows!==C||U.numPointShadows!==E||U.numSpotShadows!==R||U.numSpotMaps!==D||U.numLightProbes!==L)&&(i.directional.length=v,i.spot.length=b,i.rectArea.length=w,i.point.length=y,i.hemi.length=S,i.directionalShadow.length=C,i.directionalShadowMap.length=C,i.pointShadow.length=E,i.pointShadowMap.length=E,i.spotShadow.length=R,i.spotShadowMap.length=R,i.directionalShadowMatrix.length=C,i.pointShadowMatrix.length=E,i.spotLightMatrix.length=R+D-B,i.spotLightMap.length=D,i.numSpotLightShadowsWithMaps=B,i.numLightProbes=L,U.directionalLength=v,U.pointLength=y,U.spotLength=b,U.rectAreaLength=w,U.hemiLength=S,U.numDirectionalShadows=C,U.numPointShadows=E,U.numSpotShadows=R,U.numSpotMaps=D,U.numLightProbes=L,i.version=dQ++)}function l(u,A){let p=0,g=0,v=0,y=0,b=0;const w=A.matrixWorldInverse;for(let S=0,C=u.length;S<C;S++){const E=u[S];if(E.isDirectionalLight){const R=i.directional[p];R.direction.setFromMatrixPosition(E.matrixWorld),r.setFromMatrixPosition(E.target.matrixWorld),R.direction.sub(r),R.direction.transformDirection(w),p++}else if(E.isSpotLight){const R=i.spot[v];R.position.setFromMatrixPosition(E.matrixWorld),R.position.applyMatrix4(w),R.direction.setFromMatrixPosition(E.matrixWorld),r.setFromMatrixPosition(E.target.matrixWorld),R.direction.sub(r),R.direction.transformDirection(w),v++}else if(E.isRectAreaLight){const R=i.rectArea[y];R.position.setFromMatrixPosition(E.matrixWorld),R.position.applyMatrix4(w),o.identity(),s.copy(E.matrixWorld),s.premultiply(w),o.extractRotation(s),R.halfWidth.set(E.width*.5,0,0),R.halfHeight.set(0,E.height*.5,0),R.halfWidth.applyMatrix4(o),R.halfHeight.applyMatrix4(o),y++}else if(E.isPointLight){const R=i.point[g];R.position.setFromMatrixPosition(E.matrixWorld),R.position.applyMatrix4(w),g++}else if(E.isHemisphereLight){const R=i.hemi[b];R.direction.setFromMatrixPosition(E.matrixWorld),R.direction.transformDirection(w),b++}}}return{setup:a,setupView:l,state:i}}function LT(n){const e=new mQ(n),t=[],i=[];function r(A){u.camera=A,t.length=0,i.length=0}function s(A){t.push(A)}function o(A){i.push(A)}function a(){e.setup(t)}function l(A){e.setupView(t,A)}const u={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:u,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function gQ(n){let e=new WeakMap;function t(r,s=0){const o=e.get(r);let a;return o===void 0?(a=new LT(n),e.set(r,[a])):s>=o.length?(a=new LT(n),o.push(a)):a=o[s],a}function i(){e=new WeakMap}return{get:t,dispose:i}}const _Q=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,vQ=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function yQ(n,e,t){let i=new qA;const r=new rt,s=new rt,o=new Kt,a=new PH({depthPacking:Gq}),l=new LH,u={},A=t.maxTextureSize,p={[oo]:wi,[wi]:oo,[ar]:ar},g=new sa({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new rt},radius:{value:4}},vertexShader:_Q,fragmentShader:vQ}),v=g.clone();v.defines.HORIZONTAL_PASS=1;const y=new pi;y.setAttribute("position",new Xi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new Jn(y,g),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=m4;let S=this.type;this.render=function(B,L,U){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||B.length===0)return;const P=n.getRenderTarget(),F=n.getActiveCubeFace(),V=n.getActiveMipmapLevel(),H=n.state;H.setBlending(Do),H.buffers.color.setClear(1,1,1,1),H.buffers.depth.setTest(!0),H.setScissorTest(!1);const j=S!==wo&&this.type===wo,J=S===wo&&this.type!==wo;for(let Z=0,W=B.length;Z<W;Z++){const K=B[Z],ee=K.shadow;if(ee===void 0){console.warn("THREE.WebGLShadowMap:",K,"has no shadow.");continue}if(ee.autoUpdate===!1&&ee.needsUpdate===!1)continue;r.copy(ee.mapSize);const se=ee.getFrameExtents();if(r.multiply(se),s.copy(ee.mapSize),(r.x>A||r.y>A)&&(r.x>A&&(s.x=Math.floor(A/se.x),r.x=s.x*se.x,ee.mapSize.x=s.x),r.y>A&&(s.y=Math.floor(A/se.y),r.y=s.y*se.y,ee.mapSize.y=s.y)),ee.map===null||j===!0||J===!0){const de=this.type!==wo?{minFilter:Ui,magFilter:Ui}:{};ee.map!==null&&ee.map.dispose(),ee.map=new mh(r.x,r.y,de),ee.map.texture.name=K.name+".shadowMap",ee.camera.updateProjectionMatrix()}n.setRenderTarget(ee.map),n.clear();const ge=ee.getViewportCount();for(let de=0;de<ge;de++){const Ae=ee.getViewport(de);o.set(s.x*Ae.x,s.y*Ae.y,s.x*Ae.z,s.y*Ae.w),H.viewport(o),ee.updateMatrices(K,de),i=ee.getFrustum(),R(L,U,ee.camera,K,this.type)}ee.isPointLightShadow!==!0&&this.type===wo&&C(ee,U),ee.needsUpdate=!1}S=this.type,w.needsUpdate=!1,n.setRenderTarget(P,F,V)};function C(B,L){const U=e.update(b);g.defines.VSM_SAMPLES!==B.blurSamples&&(g.defines.VSM_SAMPLES=B.blurSamples,v.defines.VSM_SAMPLES=B.blurSamples,g.needsUpdate=!0,v.needsUpdate=!0),B.mapPass===null&&(B.mapPass=new mh(r.x,r.y)),g.uniforms.shadow_pass.value=B.map.texture,g.uniforms.resolution.value=B.mapSize,g.uniforms.radius.value=B.radius,n.setRenderTarget(B.mapPass),n.clear(),n.renderBufferDirect(L,null,U,g,b,null),v.uniforms.shadow_pass.value=B.mapPass.texture,v.uniforms.resolution.value=B.mapSize,v.uniforms.radius.value=B.radius,n.setRenderTarget(B.map),n.clear(),n.renderBufferDirect(L,null,U,v,b,null)}function E(B,L,U,P){let F=null;const V=U.isPointLight===!0?B.customDistanceMaterial:B.customDepthMaterial;if(V!==void 0)F=V;else if(F=U.isPointLight===!0?l:a,n.localClippingEnabled&&L.clipShadows===!0&&Array.isArray(L.clippingPlanes)&&L.clippingPlanes.length!==0||L.displacementMap&&L.displacementScale!==0||L.alphaMap&&L.alphaTest>0||L.map&&L.alphaTest>0||L.alphaToCoverage===!0){const H=F.uuid,j=L.uuid;let J=u[H];J===void 0&&(J={},u[H]=J);let Z=J[j];Z===void 0&&(Z=F.clone(),J[j]=Z,L.addEventListener("dispose",D)),F=Z}if(F.visible=L.visible,F.wireframe=L.wireframe,P===wo?F.side=L.shadowSide!==null?L.shadowSide:L.side:F.side=L.shadowSide!==null?L.shadowSide:p[L.side],F.alphaMap=L.alphaMap,F.alphaTest=L.alphaToCoverage===!0?.5:L.alphaTest,F.map=L.map,F.clipShadows=L.clipShadows,F.clippingPlanes=L.clippingPlanes,F.clipIntersection=L.clipIntersection,F.displacementMap=L.displacementMap,F.displacementScale=L.displacementScale,F.displacementBias=L.displacementBias,F.wireframeLinewidth=L.wireframeLinewidth,F.linewidth=L.linewidth,U.isPointLight===!0&&F.isMeshDistanceMaterial===!0){const H=n.properties.get(F);H.light=U}return F}function R(B,L,U,P,F){if(B.visible===!1)return;if(B.layers.test(L.layers)&&(B.isMesh||B.isLine||B.isPoints)&&(B.castShadow||B.receiveShadow&&F===wo)&&(!B.frustumCulled||i.intersectsObject(B))){B.modelViewMatrix.multiplyMatrices(U.matrixWorldInverse,B.matrixWorld);const j=e.update(B),J=B.material;if(Array.isArray(J)){const Z=j.groups;for(let W=0,K=Z.length;W<K;W++){const ee=Z[W],se=J[ee.materialIndex];if(se&&se.visible){const ge=E(B,se,P,F);B.onBeforeShadow(n,B,L,U,j,ge,ee),n.renderBufferDirect(U,null,j,ge,B,ee),B.onAfterShadow(n,B,L,U,j,ge,ee)}}}else if(J.visible){const Z=E(B,J,P,F);B.onBeforeShadow(n,B,L,U,j,Z,null),n.renderBufferDirect(U,null,j,Z,B,null),B.onAfterShadow(n,B,L,U,j,Z,null)}}const H=B.children;for(let j=0,J=H.length;j<J;j++)R(H[j],L,U,P,F)}function D(B){B.target.removeEventListener("dispose",D);for(const U in u){const P=u[U],F=B.target.uuid;F in P&&(P[F].dispose(),delete P[F])}}}const xQ={[wd]:Md,[Ed]:Nd,[Cd]:Pd,[Ju]:Rd,[Md]:wd,[Nd]:Ed,[Pd]:Cd,[Rd]:Ju};function bQ(n,e){function t(){let ie=!1;const Mt=new Kt;let je=null;const q=new Kt(0,0,0,0);return{setMask:function(Pt){je!==Pt&&!ie&&(n.colorMask(Pt,Pt,Pt,Pt),je=Pt)},setLocked:function(Pt){ie=Pt},setClear:function(Pt,wt,sn,$n,Rn){Rn===!0&&(Pt*=$n,wt*=$n,sn*=$n),Mt.set(Pt,wt,sn,$n),q.equals(Mt)===!1&&(n.clearColor(Pt,wt,sn,$n),q.copy(Mt))},reset:function(){ie=!1,je=null,q.set(-1,0,0,0)}}}function i(){let ie=!1,Mt=!1,je=null,q=null,Pt=null;return{setReversed:function(wt){if(Mt!==wt){const sn=e.get("EXT_clip_control");wt?sn.clipControlEXT(sn.LOWER_LEFT_EXT,sn.ZERO_TO_ONE_EXT):sn.clipControlEXT(sn.LOWER_LEFT_EXT,sn.NEGATIVE_ONE_TO_ONE_EXT),Mt=wt;const $n=Pt;Pt=null,this.setClear($n)}},getReversed:function(){return Mt},setTest:function(wt){wt?$e(n.DEPTH_TEST):Ke(n.DEPTH_TEST)},setMask:function(wt){je!==wt&&!ie&&(n.depthMask(wt),je=wt)},setFunc:function(wt){if(Mt&&(wt=xQ[wt]),q!==wt){switch(wt){case wd:n.depthFunc(n.NEVER);break;case Md:n.depthFunc(n.ALWAYS);break;case Ed:n.depthFunc(n.LESS);break;case Ju:n.depthFunc(n.LEQUAL);break;case Cd:n.depthFunc(n.EQUAL);break;case Rd:n.depthFunc(n.GEQUAL);break;case Nd:n.depthFunc(n.GREATER);break;case Pd:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}q=wt}},setLocked:function(wt){ie=wt},setClear:function(wt){Pt!==wt&&(Mt&&(wt=1-wt),n.clearDepth(wt),Pt=wt)},reset:function(){ie=!1,je=null,q=null,Pt=null,Mt=!1}}}function r(){let ie=!1,Mt=null,je=null,q=null,Pt=null,wt=null,sn=null,$n=null,Rn=null;return{setTest:function(tn){ie||(tn?$e(n.STENCIL_TEST):Ke(n.STENCIL_TEST))},setMask:function(tn){Mt!==tn&&!ie&&(n.stencilMask(tn),Mt=tn)},setFunc:function(tn,vi,Wn){(je!==tn||q!==vi||Pt!==Wn)&&(n.stencilFunc(tn,vi,Wn),je=tn,q=vi,Pt=Wn)},setOp:function(tn,vi,Wn){(wt!==tn||sn!==vi||$n!==Wn)&&(n.stencilOp(tn,vi,Wn),wt=tn,sn=vi,$n=Wn)},setLocked:function(tn){ie=tn},setClear:function(tn){Rn!==tn&&(n.clearStencil(tn),Rn=tn)},reset:function(){ie=!1,Mt=null,je=null,q=null,Pt=null,wt=null,sn=null,$n=null,Rn=null}}}const s=new t,o=new i,a=new r,l=new WeakMap,u=new WeakMap;let A={},p={},g=new WeakMap,v=[],y=null,b=!1,w=null,S=null,C=null,E=null,R=null,D=null,B=null,L=new Gt(0,0,0),U=0,P=!1,F=null,V=null,H=null,j=null,J=null;const Z=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,K=0;const ee=n.getParameter(n.VERSION);ee.indexOf("WebGL")!==-1?(K=parseFloat(/^WebGL (\d)/.exec(ee)[1]),W=K>=1):ee.indexOf("OpenGL ES")!==-1&&(K=parseFloat(/^OpenGL ES (\d)/.exec(ee)[1]),W=K>=2);let se=null,ge={};const de=n.getParameter(n.SCISSOR_BOX),Ae=n.getParameter(n.VIEWPORT),Be=new Kt().fromArray(de),ye=new Kt().fromArray(Ae);function De(ie,Mt,je,q){const Pt=new Uint8Array(4),wt=n.createTexture();n.bindTexture(ie,wt),n.texParameteri(ie,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ie,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let sn=0;sn<je;sn++)ie===n.TEXTURE_3D||ie===n.TEXTURE_2D_ARRAY?n.texImage3D(Mt,0,n.RGBA,1,1,q,0,n.RGBA,n.UNSIGNED_BYTE,Pt):n.texImage2D(Mt+sn,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Pt);return wt}const We={};We[n.TEXTURE_2D]=De(n.TEXTURE_2D,n.TEXTURE_2D,1),We[n.TEXTURE_CUBE_MAP]=De(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),We[n.TEXTURE_2D_ARRAY]=De(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),We[n.TEXTURE_3D]=De(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),$e(n.DEPTH_TEST),o.setFunc(Ju),pe(!1),me(Ey),$e(n.CULL_FACE),G(Do);function $e(ie){A[ie]!==!0&&(n.enable(ie),A[ie]=!0)}function Ke(ie){A[ie]!==!1&&(n.disable(ie),A[ie]=!1)}function Xe(ie,Mt){return p[ie]!==Mt?(n.bindFramebuffer(ie,Mt),p[ie]=Mt,ie===n.DRAW_FRAMEBUFFER&&(p[n.FRAMEBUFFER]=Mt),ie===n.FRAMEBUFFER&&(p[n.DRAW_FRAMEBUFFER]=Mt),!0):!1}function st(ie,Mt){let je=v,q=!1;if(ie){je=g.get(Mt),je===void 0&&(je=[],g.set(Mt,je));const Pt=ie.textures;if(je.length!==Pt.length||je[0]!==n.COLOR_ATTACHMENT0){for(let wt=0,sn=Pt.length;wt<sn;wt++)je[wt]=n.COLOR_ATTACHMENT0+wt;je.length=Pt.length,q=!0}}else je[0]!==n.BACK&&(je[0]=n.BACK,q=!0);q&&n.drawBuffers(je)}function gt(ie){return y!==ie?(n.useProgram(ie),y=ie,!0):!1}const ae={[gs]:n.FUNC_ADD,[g4]:n.FUNC_SUBTRACT,[_4]:n.FUNC_REVERSE_SUBTRACT};ae[h9]=n.MIN,ae[f9]=n.MAX;const le={[Ul]:n.ZERO,[v4]:n.ONE,[y4]:n.SRC_COLOR,[Td]:n.SRC_ALPHA,[M4]:n.SRC_ALPHA_SATURATE,[S4]:n.DST_COLOR,[b4]:n.DST_ALPHA,[x4]:n.ONE_MINUS_SRC_COLOR,[Sd]:n.ONE_MINUS_SRC_ALPHA,[w4]:n.ONE_MINUS_DST_COLOR,[T4]:n.ONE_MINUS_DST_ALPHA,[Dq]:n.CONSTANT_COLOR,[Iq]:n.ONE_MINUS_CONSTANT_COLOR,[Bq]:n.CONSTANT_ALPHA,[Fq]:n.ONE_MINUS_CONSTANT_ALPHA};function G(ie,Mt,je,q,Pt,wt,sn,$n,Rn,tn){if(ie===Do){b===!0&&(Ke(n.BLEND),b=!1);return}if(b===!1&&($e(n.BLEND),b=!0),ie!==$f){if(ie!==w||tn!==P){if((S!==gs||R!==gs)&&(n.blendEquation(n.FUNC_ADD),S=gs,R=gs),tn)switch(ie){case Gs:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case uh:n.blendFunc(n.ONE,n.ONE);break;case iA:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case rA:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ie);break}else switch(ie){case Gs:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case uh:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case iA:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case rA:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ie);break}C=null,E=null,D=null,B=null,L.set(0,0,0),U=0,w=ie,P=tn}return}Pt=Pt||Mt,wt=wt||je,sn=sn||q,(Mt!==S||Pt!==R)&&(n.blendEquationSeparate(ae[Mt],ae[Pt]),S=Mt,R=Pt),(je!==C||q!==E||wt!==D||sn!==B)&&(n.blendFuncSeparate(le[je],le[q],le[wt],le[sn]),C=je,E=q,D=wt,B=sn),($n.equals(L)===!1||Rn!==U)&&(n.blendColor($n.r,$n.g,$n.b,Rn),L.copy($n),U=Rn),w=ie,P=!1}function Te(ie,Mt){ie.side===ar?Ke(n.CULL_FACE):$e(n.CULL_FACE);let je=ie.side===wi;Mt&&(je=!je),pe(je),ie.blending===Gs&&ie.transparent===!1?G(Do):G(ie.blending,ie.blendEquation,ie.blendSrc,ie.blendDst,ie.blendEquationAlpha,ie.blendSrcAlpha,ie.blendDstAlpha,ie.blendColor,ie.blendAlpha,ie.premultipliedAlpha),o.setFunc(ie.depthFunc),o.setTest(ie.depthTest),o.setMask(ie.depthWrite),s.setMask(ie.colorWrite);const q=ie.stencilWrite;a.setTest(q),q&&(a.setMask(ie.stencilWriteMask),a.setFunc(ie.stencilFunc,ie.stencilRef,ie.stencilFuncMask),a.setOp(ie.stencilFail,ie.stencilZFail,ie.stencilZPass)),qe(ie.polygonOffset,ie.polygonOffsetFactor,ie.polygonOffsetUnits),ie.alphaToCoverage===!0?$e(n.SAMPLE_ALPHA_TO_COVERAGE):Ke(n.SAMPLE_ALPHA_TO_COVERAGE)}function pe(ie){F!==ie&&(ie?n.frontFace(n.CW):n.frontFace(n.CCW),F=ie)}function me(ie){ie!==u9?($e(n.CULL_FACE),ie!==V&&(ie===Ey?n.cullFace(n.BACK):ie===c9?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Ke(n.CULL_FACE),V=ie}function ve(ie){ie!==H&&(W&&n.lineWidth(ie),H=ie)}function qe(ie,Mt,je){ie?($e(n.POLYGON_OFFSET_FILL),(j!==Mt||J!==je)&&(n.polygonOffset(Mt,je),j=Mt,J=je)):Ke(n.POLYGON_OFFSET_FILL)}function Me(ie){ie?$e(n.SCISSOR_TEST):Ke(n.SCISSOR_TEST)}function $(ie){ie===void 0&&(ie=n.TEXTURE0+Z-1),se!==ie&&(n.activeTexture(ie),se=ie)}function z(ie,Mt,je){je===void 0&&(se===null?je=n.TEXTURE0+Z-1:je=se);let q=ge[je];q===void 0&&(q={type:void 0,texture:void 0},ge[je]=q),(q.type!==ie||q.texture!==Mt)&&(se!==je&&(n.activeTexture(je),se=je),n.bindTexture(ie,Mt||We[ie]),q.type=ie,q.texture=Mt)}function fe(){const ie=ge[se];ie!==void 0&&ie.type!==void 0&&(n.bindTexture(ie.type,null),ie.type=void 0,ie.texture=void 0)}function xe(){try{n.compressedTexImage2D(...arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function Le(){try{n.compressedTexImage3D(...arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function Ne(){try{n.texSubImage2D(...arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function ot(){try{n.texSubImage3D(...arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function Qe(){try{n.compressedTexSubImage2D(...arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function xt(){try{n.compressedTexSubImage3D(...arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function bt(){try{n.texStorage2D(...arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function nt(){try{n.texStorage3D(...arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function At(){try{n.texImage2D(...arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function Dt(){try{n.texImage3D(...arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function Ot(ie){Be.equals(ie)===!1&&(n.scissor(ie.x,ie.y,ie.z,ie.w),Be.copy(ie))}function dt(ie){ye.equals(ie)===!1&&(n.viewport(ie.x,ie.y,ie.z,ie.w),ye.copy(ie))}function kt(ie,Mt){let je=u.get(Mt);je===void 0&&(je=new WeakMap,u.set(Mt,je));let q=je.get(ie);q===void 0&&(q=n.getUniformBlockIndex(Mt,ie.name),je.set(ie,q))}function Lt(ie,Mt){const q=u.get(Mt).get(ie);l.get(Mt)!==q&&(n.uniformBlockBinding(Mt,q,ie.__bindingPointIndex),l.set(Mt,q))}function $t(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),o.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),A={},se=null,ge={},p={},g=new WeakMap,v=[],y=null,b=!1,w=null,S=null,C=null,E=null,R=null,D=null,B=null,L=new Gt(0,0,0),U=0,P=!1,F=null,V=null,H=null,j=null,J=null,Be.set(0,0,n.canvas.width,n.canvas.height),ye.set(0,0,n.canvas.width,n.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:$e,disable:Ke,bindFramebuffer:Xe,drawBuffers:st,useProgram:gt,setBlending:G,setMaterial:Te,setFlipSided:pe,setCullFace:me,setLineWidth:ve,setPolygonOffset:qe,setScissorTest:Me,activeTexture:$,bindTexture:z,unbindTexture:fe,compressedTexImage2D:xe,compressedTexImage3D:Le,texImage2D:At,texImage3D:Dt,updateUBOMapping:kt,uniformBlockBinding:Lt,texStorage2D:bt,texStorage3D:nt,texSubImage2D:Ne,texSubImage3D:ot,compressedTexSubImage2D:Qe,compressedTexSubImage3D:xt,scissor:Ot,viewport:dt,reset:$t}}function TQ(n,e,t,i,r,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new rt,A=new WeakMap;let p;const g=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y($,z){return v?new OffscreenCanvas($,z):Vd("canvas")}function b($,z,fe){let xe=1;const Le=Me($);if((Le.width>fe||Le.height>fe)&&(xe=fe/Math.max(Le.width,Le.height)),xe<1)if(typeof HTMLImageElement<"u"&&$ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&$ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&$ instanceof ImageBitmap||typeof VideoFrame<"u"&&$ instanceof VideoFrame){const Ne=Math.floor(xe*Le.width),ot=Math.floor(xe*Le.height);p===void 0&&(p=y(Ne,ot));const Qe=z?y(Ne,ot):p;return Qe.width=Ne,Qe.height=ot,Qe.getContext("2d").drawImage($,0,0,Ne,ot),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Le.width+"x"+Le.height+") to ("+Ne+"x"+ot+")."),Qe}else return"data"in $&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Le.width+"x"+Le.height+")."),$;return $}function w($){return $.generateMipmaps}function S($){n.generateMipmap($)}function C($){return $.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:$.isWebGL3DRenderTarget?n.TEXTURE_3D:$.isWebGLArrayRenderTarget||$.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function E($,z,fe,xe,Le=!1){if($!==null){if(n[$]!==void 0)return n[$];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+$+"'")}let Ne=z;if(z===n.RED&&(fe===n.FLOAT&&(Ne=n.R32F),fe===n.HALF_FLOAT&&(Ne=n.R16F),fe===n.UNSIGNED_BYTE&&(Ne=n.R8)),z===n.RED_INTEGER&&(fe===n.UNSIGNED_BYTE&&(Ne=n.R8UI),fe===n.UNSIGNED_SHORT&&(Ne=n.R16UI),fe===n.UNSIGNED_INT&&(Ne=n.R32UI),fe===n.BYTE&&(Ne=n.R8I),fe===n.SHORT&&(Ne=n.R16I),fe===n.INT&&(Ne=n.R32I)),z===n.RG&&(fe===n.FLOAT&&(Ne=n.RG32F),fe===n.HALF_FLOAT&&(Ne=n.RG16F),fe===n.UNSIGNED_BYTE&&(Ne=n.RG8)),z===n.RG_INTEGER&&(fe===n.UNSIGNED_BYTE&&(Ne=n.RG8UI),fe===n.UNSIGNED_SHORT&&(Ne=n.RG16UI),fe===n.UNSIGNED_INT&&(Ne=n.RG32UI),fe===n.BYTE&&(Ne=n.RG8I),fe===n.SHORT&&(Ne=n.RG16I),fe===n.INT&&(Ne=n.RG32I)),z===n.RGB_INTEGER&&(fe===n.UNSIGNED_BYTE&&(Ne=n.RGB8UI),fe===n.UNSIGNED_SHORT&&(Ne=n.RGB16UI),fe===n.UNSIGNED_INT&&(Ne=n.RGB32UI),fe===n.BYTE&&(Ne=n.RGB8I),fe===n.SHORT&&(Ne=n.RGB16I),fe===n.INT&&(Ne=n.RGB32I)),z===n.RGBA_INTEGER&&(fe===n.UNSIGNED_BYTE&&(Ne=n.RGBA8UI),fe===n.UNSIGNED_SHORT&&(Ne=n.RGBA16UI),fe===n.UNSIGNED_INT&&(Ne=n.RGBA32UI),fe===n.BYTE&&(Ne=n.RGBA8I),fe===n.SHORT&&(Ne=n.RGBA16I),fe===n.INT&&(Ne=n.RGBA32I)),z===n.RGB&&fe===n.UNSIGNED_INT_5_9_9_9_REV&&(Ne=n.RGB9_E5),z===n.RGBA){const ot=Le?dg:Un.getTransfer(xe);fe===n.FLOAT&&(Ne=n.RGBA32F),fe===n.HALF_FLOAT&&(Ne=n.RGBA16F),fe===n.UNSIGNED_BYTE&&(Ne=ot===hi?n.SRGB8_ALPHA8:n.RGBA8),fe===n.UNSIGNED_SHORT_4_4_4_4&&(Ne=n.RGBA4),fe===n.UNSIGNED_SHORT_5_5_5_1&&(Ne=n.RGB5_A1)}return(Ne===n.R16F||Ne===n.R32F||Ne===n.RG16F||Ne===n.RG32F||Ne===n.RGBA16F||Ne===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Ne}function R($,z){let fe;return $?z===null||z===Ni||z===Io?fe=n.DEPTH24_STENCIL8:z===mr?fe=n.DEPTH32F_STENCIL8:z===xa&&(fe=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):z===null||z===Ni||z===Io?fe=n.DEPTH_COMPONENT24:z===mr?fe=n.DEPTH_COMPONENT32F:z===xa&&(fe=n.DEPTH_COMPONENT16),fe}function D($,z){return w($)===!0||$.isFramebufferTexture&&$.minFilter!==Ui&&$.minFilter!==Lr?Math.log2(Math.max(z.width,z.height))+1:$.mipmaps!==void 0&&$.mipmaps.length>0?$.mipmaps.length:$.isCompressedTexture&&Array.isArray($.image)?z.mipmaps.length:1}function B($){const z=$.target;z.removeEventListener("dispose",B),U(z),z.isVideoTexture&&A.delete(z)}function L($){const z=$.target;z.removeEventListener("dispose",L),F(z)}function U($){const z=i.get($);if(z.__webglInit===void 0)return;const fe=$.source,xe=g.get(fe);if(xe){const Le=xe[z.__cacheKey];Le.usedTimes--,Le.usedTimes===0&&P($),Object.keys(xe).length===0&&g.delete(fe)}i.remove($)}function P($){const z=i.get($);n.deleteTexture(z.__webglTexture);const fe=$.source,xe=g.get(fe);delete xe[z.__cacheKey],o.memory.textures--}function F($){const z=i.get($);if($.depthTexture&&($.depthTexture.dispose(),i.remove($.depthTexture)),$.isWebGLCubeRenderTarget)for(let xe=0;xe<6;xe++){if(Array.isArray(z.__webglFramebuffer[xe]))for(let Le=0;Le<z.__webglFramebuffer[xe].length;Le++)n.deleteFramebuffer(z.__webglFramebuffer[xe][Le]);else n.deleteFramebuffer(z.__webglFramebuffer[xe]);z.__webglDepthbuffer&&n.deleteRenderbuffer(z.__webglDepthbuffer[xe])}else{if(Array.isArray(z.__webglFramebuffer))for(let xe=0;xe<z.__webglFramebuffer.length;xe++)n.deleteFramebuffer(z.__webglFramebuffer[xe]);else n.deleteFramebuffer(z.__webglFramebuffer);if(z.__webglDepthbuffer&&n.deleteRenderbuffer(z.__webglDepthbuffer),z.__webglMultisampledFramebuffer&&n.deleteFramebuffer(z.__webglMultisampledFramebuffer),z.__webglColorRenderbuffer)for(let xe=0;xe<z.__webglColorRenderbuffer.length;xe++)z.__webglColorRenderbuffer[xe]&&n.deleteRenderbuffer(z.__webglColorRenderbuffer[xe]);z.__webglDepthRenderbuffer&&n.deleteRenderbuffer(z.__webglDepthRenderbuffer)}const fe=$.textures;for(let xe=0,Le=fe.length;xe<Le;xe++){const Ne=i.get(fe[xe]);Ne.__webglTexture&&(n.deleteTexture(Ne.__webglTexture),o.memory.textures--),i.remove(fe[xe])}i.remove($)}let V=0;function H(){V=0}function j(){const $=V;return $>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+$+" texture units while this GPU supports only "+r.maxTextures),V+=1,$}function J($){const z=[];return z.push($.wrapS),z.push($.wrapT),z.push($.wrapR||0),z.push($.magFilter),z.push($.minFilter),z.push($.anisotropy),z.push($.internalFormat),z.push($.format),z.push($.type),z.push($.generateMipmaps),z.push($.premultiplyAlpha),z.push($.flipY),z.push($.unpackAlignment),z.push($.colorSpace),z.join()}function Z($,z){const fe=i.get($);if($.isVideoTexture&&ve($),$.isRenderTargetTexture===!1&&$.version>0&&fe.__version!==$.version){const xe=$.image;if(xe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(xe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ye(fe,$,z);return}}t.bindTexture(n.TEXTURE_2D,fe.__webglTexture,n.TEXTURE0+z)}function W($,z){const fe=i.get($);if($.version>0&&fe.__version!==$.version){ye(fe,$,z);return}t.bindTexture(n.TEXTURE_2D_ARRAY,fe.__webglTexture,n.TEXTURE0+z)}function K($,z){const fe=i.get($);if($.version>0&&fe.__version!==$.version){ye(fe,$,z);return}t.bindTexture(n.TEXTURE_3D,fe.__webglTexture,n.TEXTURE0+z)}function ee($,z){const fe=i.get($);if($.version>0&&fe.__version!==$.version){De(fe,$,z);return}t.bindTexture(n.TEXTURE_CUBE_MAP,fe.__webglTexture,n.TEXTURE0+z)}const se={[Ah]:n.REPEAT,[il]:n.CLAMP_TO_EDGE,[dh]:n.MIRRORED_REPEAT},ge={[Ui]:n.NEAREST,[C4]:n.NEAREST_MIPMAP_NEAREST,[$l]:n.NEAREST_MIPMAP_LINEAR,[Lr]:n.LINEAR,[jf]:n.LINEAR_MIPMAP_NEAREST,[to]:n.LINEAR_MIPMAP_LINEAR},de={[P4]:n.NEVER,[F4]:n.ALWAYS,[P2]:n.LESS,[L2]:n.LEQUAL,[L4]:n.EQUAL,[B4]:n.GEQUAL,[D4]:n.GREATER,[I4]:n.NOTEQUAL};function Ae($,z){if(z.type===mr&&e.has("OES_texture_float_linear")===!1&&(z.magFilter===Lr||z.magFilter===jf||z.magFilter===$l||z.magFilter===to||z.minFilter===Lr||z.minFilter===jf||z.minFilter===$l||z.minFilter===to)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri($,n.TEXTURE_WRAP_S,se[z.wrapS]),n.texParameteri($,n.TEXTURE_WRAP_T,se[z.wrapT]),($===n.TEXTURE_3D||$===n.TEXTURE_2D_ARRAY)&&n.texParameteri($,n.TEXTURE_WRAP_R,se[z.wrapR]),n.texParameteri($,n.TEXTURE_MAG_FILTER,ge[z.magFilter]),n.texParameteri($,n.TEXTURE_MIN_FILTER,ge[z.minFilter]),z.compareFunction&&(n.texParameteri($,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri($,n.TEXTURE_COMPARE_FUNC,de[z.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(z.magFilter===Ui||z.minFilter!==$l&&z.minFilter!==to||z.type===mr&&e.has("OES_texture_float_linear")===!1)return;if(z.anisotropy>1||i.get(z).__currentAnisotropy){const fe=e.get("EXT_texture_filter_anisotropic");n.texParameterf($,fe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(z.anisotropy,r.getMaxAnisotropy())),i.get(z).__currentAnisotropy=z.anisotropy}}}function Be($,z){let fe=!1;$.__webglInit===void 0&&($.__webglInit=!0,z.addEventListener("dispose",B));const xe=z.source;let Le=g.get(xe);Le===void 0&&(Le={},g.set(xe,Le));const Ne=J(z);if(Ne!==$.__cacheKey){Le[Ne]===void 0&&(Le[Ne]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,fe=!0),Le[Ne].usedTimes++;const ot=Le[$.__cacheKey];ot!==void 0&&(Le[$.__cacheKey].usedTimes--,ot.usedTimes===0&&P(z)),$.__cacheKey=Ne,$.__webglTexture=Le[Ne].texture}return fe}function ye($,z,fe){let xe=n.TEXTURE_2D;(z.isDataArrayTexture||z.isCompressedArrayTexture)&&(xe=n.TEXTURE_2D_ARRAY),z.isData3DTexture&&(xe=n.TEXTURE_3D);const Le=Be($,z),Ne=z.source;t.bindTexture(xe,$.__webglTexture,n.TEXTURE0+fe);const ot=i.get(Ne);if(Ne.version!==ot.__version||Le===!0){t.activeTexture(n.TEXTURE0+fe);const Qe=Un.getPrimaries(Un.workingColorSpace),xt=z.colorSpace===Po?null:Un.getPrimaries(z.colorSpace),bt=z.colorSpace===Po||Qe===xt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,z.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,z.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,bt);let nt=b(z.image,!1,r.maxTextureSize);nt=qe(z,nt);const At=s.convert(z.format,z.colorSpace),Dt=s.convert(z.type);let Ot=E(z.internalFormat,At,Dt,z.colorSpace,z.isVideoTexture);Ae(xe,z);let dt;const kt=z.mipmaps,Lt=z.isVideoTexture!==!0,$t=ot.__version===void 0||Le===!0,ie=Ne.dataReady,Mt=D(z,nt);if(z.isDepthTexture)Ot=R(z.format===Fo,z.type),$t&&(Lt?t.texStorage2D(n.TEXTURE_2D,1,Ot,nt.width,nt.height):t.texImage2D(n.TEXTURE_2D,0,Ot,nt.width,nt.height,0,At,Dt,null));else if(z.isDataTexture)if(kt.length>0){Lt&&$t&&t.texStorage2D(n.TEXTURE_2D,Mt,Ot,kt[0].width,kt[0].height);for(let je=0,q=kt.length;je<q;je++)dt=kt[je],Lt?ie&&t.texSubImage2D(n.TEXTURE_2D,je,0,0,dt.width,dt.height,At,Dt,dt.data):t.texImage2D(n.TEXTURE_2D,je,Ot,dt.width,dt.height,0,At,Dt,dt.data);z.generateMipmaps=!1}else Lt?($t&&t.texStorage2D(n.TEXTURE_2D,Mt,Ot,nt.width,nt.height),ie&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,nt.width,nt.height,At,Dt,nt.data)):t.texImage2D(n.TEXTURE_2D,0,Ot,nt.width,nt.height,0,At,Dt,nt.data);else if(z.isCompressedTexture)if(z.isCompressedArrayTexture){Lt&&$t&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Mt,Ot,kt[0].width,kt[0].height,nt.depth);for(let je=0,q=kt.length;je<q;je++)if(dt=kt[je],z.format!==ur)if(At!==null)if(Lt){if(ie)if(z.layerUpdates.size>0){const Pt=lT(dt.width,dt.height,z.format,z.type);for(const wt of z.layerUpdates){const sn=dt.data.subarray(wt*Pt/dt.data.BYTES_PER_ELEMENT,(wt+1)*Pt/dt.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,je,0,0,wt,dt.width,dt.height,1,At,sn)}z.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,je,0,0,0,dt.width,dt.height,nt.depth,At,dt.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,je,Ot,dt.width,dt.height,nt.depth,0,dt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Lt?ie&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,je,0,0,0,dt.width,dt.height,nt.depth,At,Dt,dt.data):t.texImage3D(n.TEXTURE_2D_ARRAY,je,Ot,dt.width,dt.height,nt.depth,0,At,Dt,dt.data)}else{Lt&&$t&&t.texStorage2D(n.TEXTURE_2D,Mt,Ot,kt[0].width,kt[0].height);for(let je=0,q=kt.length;je<q;je++)dt=kt[je],z.format!==ur?At!==null?Lt?ie&&t.compressedTexSubImage2D(n.TEXTURE_2D,je,0,0,dt.width,dt.height,At,dt.data):t.compressedTexImage2D(n.TEXTURE_2D,je,Ot,dt.width,dt.height,0,dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Lt?ie&&t.texSubImage2D(n.TEXTURE_2D,je,0,0,dt.width,dt.height,At,Dt,dt.data):t.texImage2D(n.TEXTURE_2D,je,Ot,dt.width,dt.height,0,At,Dt,dt.data)}else if(z.isDataArrayTexture)if(Lt){if($t&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Mt,Ot,nt.width,nt.height,nt.depth),ie)if(z.layerUpdates.size>0){const je=lT(nt.width,nt.height,z.format,z.type);for(const q of z.layerUpdates){const Pt=nt.data.subarray(q*je/nt.data.BYTES_PER_ELEMENT,(q+1)*je/nt.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,q,nt.width,nt.height,1,At,Dt,Pt)}z.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,nt.width,nt.height,nt.depth,At,Dt,nt.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,Ot,nt.width,nt.height,nt.depth,0,At,Dt,nt.data);else if(z.isData3DTexture)Lt?($t&&t.texStorage3D(n.TEXTURE_3D,Mt,Ot,nt.width,nt.height,nt.depth),ie&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,nt.width,nt.height,nt.depth,At,Dt,nt.data)):t.texImage3D(n.TEXTURE_3D,0,Ot,nt.width,nt.height,nt.depth,0,At,Dt,nt.data);else if(z.isFramebufferTexture){if($t)if(Lt)t.texStorage2D(n.TEXTURE_2D,Mt,Ot,nt.width,nt.height);else{let je=nt.width,q=nt.height;for(let Pt=0;Pt<Mt;Pt++)t.texImage2D(n.TEXTURE_2D,Pt,Ot,je,q,0,At,Dt,null),je>>=1,q>>=1}}else if(kt.length>0){if(Lt&&$t){const je=Me(kt[0]);t.texStorage2D(n.TEXTURE_2D,Mt,Ot,je.width,je.height)}for(let je=0,q=kt.length;je<q;je++)dt=kt[je],Lt?ie&&t.texSubImage2D(n.TEXTURE_2D,je,0,0,At,Dt,dt):t.texImage2D(n.TEXTURE_2D,je,Ot,At,Dt,dt);z.generateMipmaps=!1}else if(Lt){if($t){const je=Me(nt);t.texStorage2D(n.TEXTURE_2D,Mt,Ot,je.width,je.height)}ie&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,At,Dt,nt)}else t.texImage2D(n.TEXTURE_2D,0,Ot,At,Dt,nt);w(z)&&S(xe),ot.__version=Ne.version,z.onUpdate&&z.onUpdate(z)}$.__version=z.version}function De($,z,fe){if(z.image.length!==6)return;const xe=Be($,z),Le=z.source;t.bindTexture(n.TEXTURE_CUBE_MAP,$.__webglTexture,n.TEXTURE0+fe);const Ne=i.get(Le);if(Le.version!==Ne.__version||xe===!0){t.activeTexture(n.TEXTURE0+fe);const ot=Un.getPrimaries(Un.workingColorSpace),Qe=z.colorSpace===Po?null:Un.getPrimaries(z.colorSpace),xt=z.colorSpace===Po||ot===Qe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,z.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,z.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,xt);const bt=z.isCompressedTexture||z.image[0].isCompressedTexture,nt=z.image[0]&&z.image[0].isDataTexture,At=[];for(let q=0;q<6;q++)!bt&&!nt?At[q]=b(z.image[q],!0,r.maxCubemapSize):At[q]=nt?z.image[q].image:z.image[q],At[q]=qe(z,At[q]);const Dt=At[0],Ot=s.convert(z.format,z.colorSpace),dt=s.convert(z.type),kt=E(z.internalFormat,Ot,dt,z.colorSpace),Lt=z.isVideoTexture!==!0,$t=Ne.__version===void 0||xe===!0,ie=Le.dataReady;let Mt=D(z,Dt);Ae(n.TEXTURE_CUBE_MAP,z);let je;if(bt){Lt&&$t&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Mt,kt,Dt.width,Dt.height);for(let q=0;q<6;q++){je=At[q].mipmaps;for(let Pt=0;Pt<je.length;Pt++){const wt=je[Pt];z.format!==ur?Ot!==null?Lt?ie&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Pt,0,0,wt.width,wt.height,Ot,wt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Pt,kt,wt.width,wt.height,0,wt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Lt?ie&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Pt,0,0,wt.width,wt.height,Ot,dt,wt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Pt,kt,wt.width,wt.height,0,Ot,dt,wt.data)}}}else{if(je=z.mipmaps,Lt&&$t){je.length>0&&Mt++;const q=Me(At[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Mt,kt,q.width,q.height)}for(let q=0;q<6;q++)if(nt){Lt?ie&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,0,0,At[q].width,At[q].height,Ot,dt,At[q].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,kt,At[q].width,At[q].height,0,Ot,dt,At[q].data);for(let Pt=0;Pt<je.length;Pt++){const sn=je[Pt].image[q].image;Lt?ie&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Pt+1,0,0,sn.width,sn.height,Ot,dt,sn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Pt+1,kt,sn.width,sn.height,0,Ot,dt,sn.data)}}else{Lt?ie&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,0,0,Ot,dt,At[q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,kt,Ot,dt,At[q]);for(let Pt=0;Pt<je.length;Pt++){const wt=je[Pt];Lt?ie&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Pt+1,0,0,Ot,dt,wt.image[q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Pt+1,kt,Ot,dt,wt.image[q])}}}w(z)&&S(n.TEXTURE_CUBE_MAP),Ne.__version=Le.version,z.onUpdate&&z.onUpdate(z)}$.__version=z.version}function We($,z,fe,xe,Le,Ne){const ot=s.convert(fe.format,fe.colorSpace),Qe=s.convert(fe.type),xt=E(fe.internalFormat,ot,Qe,fe.colorSpace),bt=i.get(z),nt=i.get(fe);if(nt.__renderTarget=z,!bt.__hasExternalTextures){const At=Math.max(1,z.width>>Ne),Dt=Math.max(1,z.height>>Ne);Le===n.TEXTURE_3D||Le===n.TEXTURE_2D_ARRAY?t.texImage3D(Le,Ne,xt,At,Dt,z.depth,0,ot,Qe,null):t.texImage2D(Le,Ne,xt,At,Dt,0,ot,Qe,null)}t.bindFramebuffer(n.FRAMEBUFFER,$),me(z)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,xe,Le,nt.__webglTexture,0,pe(z)):(Le===n.TEXTURE_2D||Le>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Le<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,xe,Le,nt.__webglTexture,Ne),t.bindFramebuffer(n.FRAMEBUFFER,null)}function $e($,z,fe){if(n.bindRenderbuffer(n.RENDERBUFFER,$),z.depthBuffer){const xe=z.depthTexture,Le=xe&&xe.isDepthTexture?xe.type:null,Ne=R(z.stencilBuffer,Le),ot=z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Qe=pe(z);me(z)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Qe,Ne,z.width,z.height):fe?n.renderbufferStorageMultisample(n.RENDERBUFFER,Qe,Ne,z.width,z.height):n.renderbufferStorage(n.RENDERBUFFER,Ne,z.width,z.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,ot,n.RENDERBUFFER,$)}else{const xe=z.textures;for(let Le=0;Le<xe.length;Le++){const Ne=xe[Le],ot=s.convert(Ne.format,Ne.colorSpace),Qe=s.convert(Ne.type),xt=E(Ne.internalFormat,ot,Qe,Ne.colorSpace),bt=pe(z);fe&&me(z)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,bt,xt,z.width,z.height):me(z)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,bt,xt,z.width,z.height):n.renderbufferStorage(n.RENDERBUFFER,xt,z.width,z.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Ke($,z){if(z&&z.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,$),!(z.depthTexture&&z.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const xe=i.get(z.depthTexture);xe.__renderTarget=z,(!xe.__webglTexture||z.depthTexture.image.width!==z.width||z.depthTexture.image.height!==z.height)&&(z.depthTexture.image.width=z.width,z.depthTexture.image.height=z.height,z.depthTexture.needsUpdate=!0),Z(z.depthTexture,0);const Le=xe.__webglTexture,Ne=pe(z);if(z.depthTexture.format===Bo)me(z)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Le,0,Ne):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Le,0);else if(z.depthTexture.format===Fo)me(z)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Le,0,Ne):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Le,0);else throw new Error("Unknown depthTexture format")}function Xe($){const z=i.get($),fe=$.isWebGLCubeRenderTarget===!0;if(z.__boundDepthTexture!==$.depthTexture){const xe=$.depthTexture;if(z.__depthDisposeCallback&&z.__depthDisposeCallback(),xe){const Le=()=>{delete z.__boundDepthTexture,delete z.__depthDisposeCallback,xe.removeEventListener("dispose",Le)};xe.addEventListener("dispose",Le),z.__depthDisposeCallback=Le}z.__boundDepthTexture=xe}if($.depthTexture&&!z.__autoAllocateDepthBuffer){if(fe)throw new Error("target.depthTexture not supported in Cube render targets");const xe=$.texture.mipmaps;xe&&xe.length>0?Ke(z.__webglFramebuffer[0],$):Ke(z.__webglFramebuffer,$)}else if(fe){z.__webglDepthbuffer=[];for(let xe=0;xe<6;xe++)if(t.bindFramebuffer(n.FRAMEBUFFER,z.__webglFramebuffer[xe]),z.__webglDepthbuffer[xe]===void 0)z.__webglDepthbuffer[xe]=n.createRenderbuffer(),$e(z.__webglDepthbuffer[xe],$,!1);else{const Le=$.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ne=z.__webglDepthbuffer[xe];n.bindRenderbuffer(n.RENDERBUFFER,Ne),n.framebufferRenderbuffer(n.FRAMEBUFFER,Le,n.RENDERBUFFER,Ne)}}else{const xe=$.texture.mipmaps;if(xe&&xe.length>0?t.bindFramebuffer(n.FRAMEBUFFER,z.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,z.__webglFramebuffer),z.__webglDepthbuffer===void 0)z.__webglDepthbuffer=n.createRenderbuffer(),$e(z.__webglDepthbuffer,$,!1);else{const Le=$.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ne=z.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,Ne),n.framebufferRenderbuffer(n.FRAMEBUFFER,Le,n.RENDERBUFFER,Ne)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function st($,z,fe){const xe=i.get($);z!==void 0&&We(xe.__webglFramebuffer,$,$.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),fe!==void 0&&Xe($)}function gt($){const z=$.texture,fe=i.get($),xe=i.get(z);$.addEventListener("dispose",L);const Le=$.textures,Ne=$.isWebGLCubeRenderTarget===!0,ot=Le.length>1;if(ot||(xe.__webglTexture===void 0&&(xe.__webglTexture=n.createTexture()),xe.__version=z.version,o.memory.textures++),Ne){fe.__webglFramebuffer=[];for(let Qe=0;Qe<6;Qe++)if(z.mipmaps&&z.mipmaps.length>0){fe.__webglFramebuffer[Qe]=[];for(let xt=0;xt<z.mipmaps.length;xt++)fe.__webglFramebuffer[Qe][xt]=n.createFramebuffer()}else fe.__webglFramebuffer[Qe]=n.createFramebuffer()}else{if(z.mipmaps&&z.mipmaps.length>0){fe.__webglFramebuffer=[];for(let Qe=0;Qe<z.mipmaps.length;Qe++)fe.__webglFramebuffer[Qe]=n.createFramebuffer()}else fe.__webglFramebuffer=n.createFramebuffer();if(ot)for(let Qe=0,xt=Le.length;Qe<xt;Qe++){const bt=i.get(Le[Qe]);bt.__webglTexture===void 0&&(bt.__webglTexture=n.createTexture(),o.memory.textures++)}if($.samples>0&&me($)===!1){fe.__webglMultisampledFramebuffer=n.createFramebuffer(),fe.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,fe.__webglMultisampledFramebuffer);for(let Qe=0;Qe<Le.length;Qe++){const xt=Le[Qe];fe.__webglColorRenderbuffer[Qe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,fe.__webglColorRenderbuffer[Qe]);const bt=s.convert(xt.format,xt.colorSpace),nt=s.convert(xt.type),At=E(xt.internalFormat,bt,nt,xt.colorSpace,$.isXRRenderTarget===!0),Dt=pe($);n.renderbufferStorageMultisample(n.RENDERBUFFER,Dt,At,$.width,$.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Qe,n.RENDERBUFFER,fe.__webglColorRenderbuffer[Qe])}n.bindRenderbuffer(n.RENDERBUFFER,null),$.depthBuffer&&(fe.__webglDepthRenderbuffer=n.createRenderbuffer(),$e(fe.__webglDepthRenderbuffer,$,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Ne){t.bindTexture(n.TEXTURE_CUBE_MAP,xe.__webglTexture),Ae(n.TEXTURE_CUBE_MAP,z);for(let Qe=0;Qe<6;Qe++)if(z.mipmaps&&z.mipmaps.length>0)for(let xt=0;xt<z.mipmaps.length;xt++)We(fe.__webglFramebuffer[Qe][xt],$,z,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,xt);else We(fe.__webglFramebuffer[Qe],$,z,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,0);w(z)&&S(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ot){for(let Qe=0,xt=Le.length;Qe<xt;Qe++){const bt=Le[Qe],nt=i.get(bt);t.bindTexture(n.TEXTURE_2D,nt.__webglTexture),Ae(n.TEXTURE_2D,bt),We(fe.__webglFramebuffer,$,bt,n.COLOR_ATTACHMENT0+Qe,n.TEXTURE_2D,0),w(bt)&&S(n.TEXTURE_2D)}t.unbindTexture()}else{let Qe=n.TEXTURE_2D;if(($.isWebGL3DRenderTarget||$.isWebGLArrayRenderTarget)&&(Qe=$.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Qe,xe.__webglTexture),Ae(Qe,z),z.mipmaps&&z.mipmaps.length>0)for(let xt=0;xt<z.mipmaps.length;xt++)We(fe.__webglFramebuffer[xt],$,z,n.COLOR_ATTACHMENT0,Qe,xt);else We(fe.__webglFramebuffer,$,z,n.COLOR_ATTACHMENT0,Qe,0);w(z)&&S(Qe),t.unbindTexture()}$.depthBuffer&&Xe($)}function ae($){const z=$.textures;for(let fe=0,xe=z.length;fe<xe;fe++){const Le=z[fe];if(w(Le)){const Ne=C($),ot=i.get(Le).__webglTexture;t.bindTexture(Ne,ot),S(Ne),t.unbindTexture()}}}const le=[],G=[];function Te($){if($.samples>0){if(me($)===!1){const z=$.textures,fe=$.width,xe=$.height;let Le=n.COLOR_BUFFER_BIT;const Ne=$.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ot=i.get($),Qe=z.length>1;if(Qe)for(let bt=0;bt<z.length;bt++)t.bindFramebuffer(n.FRAMEBUFFER,ot.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+bt,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,ot.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+bt,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,ot.__webglMultisampledFramebuffer);const xt=$.texture.mipmaps;xt&&xt.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,ot.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,ot.__webglFramebuffer);for(let bt=0;bt<z.length;bt++){if($.resolveDepthBuffer&&($.depthBuffer&&(Le|=n.DEPTH_BUFFER_BIT),$.stencilBuffer&&$.resolveStencilBuffer&&(Le|=n.STENCIL_BUFFER_BIT)),Qe){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,ot.__webglColorRenderbuffer[bt]);const nt=i.get(z[bt]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,nt,0)}n.blitFramebuffer(0,0,fe,xe,0,0,fe,xe,Le,n.NEAREST),l===!0&&(le.length=0,G.length=0,le.push(n.COLOR_ATTACHMENT0+bt),$.depthBuffer&&$.resolveDepthBuffer===!1&&(le.push(Ne),G.push(Ne),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,G)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,le))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Qe)for(let bt=0;bt<z.length;bt++){t.bindFramebuffer(n.FRAMEBUFFER,ot.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+bt,n.RENDERBUFFER,ot.__webglColorRenderbuffer[bt]);const nt=i.get(z[bt]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,ot.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+bt,n.TEXTURE_2D,nt,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,ot.__webglMultisampledFramebuffer)}else if($.depthBuffer&&$.resolveDepthBuffer===!1&&l){const z=$.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[z])}}}function pe($){return Math.min(r.maxSamples,$.samples)}function me($){const z=i.get($);return $.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&z.__useRenderToTexture!==!1}function ve($){const z=o.render.frame;A.get($)!==z&&(A.set($,z),$.update())}function qe($,z){const fe=$.colorSpace,xe=$.format,Le=$.type;return $.isCompressedTexture===!0||$.isVideoTexture===!0||fe!==Ma&&fe!==Po&&(Un.getTransfer(fe)===hi?(xe!==ur||Le!==Ji)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",fe)),z}function Me($){return typeof HTMLImageElement<"u"&&$ instanceof HTMLImageElement?(u.width=$.naturalWidth||$.width,u.height=$.naturalHeight||$.height):typeof VideoFrame<"u"&&$ instanceof VideoFrame?(u.width=$.displayWidth,u.height=$.displayHeight):(u.width=$.width,u.height=$.height),u}this.allocateTextureUnit=j,this.resetTextureUnits=H,this.setTexture2D=Z,this.setTexture2DArray=W,this.setTexture3D=K,this.setTextureCube=ee,this.rebindTextures=st,this.setupRenderTarget=gt,this.updateRenderTargetMipmap=ae,this.updateMultisampleRenderTarget=Te,this.setupDepthRenderbuffer=Xe,this.setupFrameBufferTexture=We,this.useMultisampledRTT=me}function SQ(n,e){function t(i,r=Po){let s;const o=Un.getTransfer(r);if(i===Ji)return n.UNSIGNED_BYTE;if(i===C2)return n.UNSIGNED_SHORT_4_4_4_4;if(i===R2)return n.UNSIGNED_SHORT_5_5_5_1;if(i===N2)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===Kc)return n.BYTE;if(i===Jc)return n.SHORT;if(i===xa)return n.UNSIGNED_SHORT;if(i===qr)return n.INT;if(i===Ni)return n.UNSIGNED_INT;if(i===mr)return n.FLOAT;if(i===Dr)return n.HALF_FLOAT;if(i===R4)return n.ALPHA;if(i===vp)return n.RGB;if(i===ur)return n.RGBA;if(i===Bo)return n.DEPTH_COMPONENT;if(i===Fo)return n.DEPTH_STENCIL;if(i===yp)return n.RED;if(i===OA)return n.RED_INTEGER;if(i===jl)return n.RG;if(i===kA)return n.RG_INTEGER;if(i===VA)return n.RGBA_INTEGER;if(i===eh||i===Wu||i===$u||i===ju)if(o===hi)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===eh)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Wu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===$u)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===ju)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===eh)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Wu)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===$u)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===ju)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===Ld||i===Dd||i===Id||i===Bd)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===Ld)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Dd)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===Id)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===Bd)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===Fd||i===sA||i===oA)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===Fd||i===sA)return o===hi?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===oA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===aA||i===lA||i===uA||i===cA||i===hA||i===fA||i===AA||i===dA||i===pA||i===mA||i===gA||i===_A||i===vA||i===yA)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===aA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===lA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===uA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===cA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===hA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===fA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===AA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===dA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===pA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===mA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===gA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===_A)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===vA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===yA)return o===hi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===th||i===Cy||i===Ry)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===th)return o===hi?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===Cy)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===Ry)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===N4||i===Ud||i===Od||i===kd)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===th)return s.COMPRESSED_RED_RGTC1_EXT;if(i===Ud)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===Od)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===kd)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===Io?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}const wQ=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,MQ=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class EQ{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(this.texture===null){const r=new Cr,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!==i.depthNear||t.depthFar!==i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,i=new sa({vertexShader:wQ,fragmentShader:MQ,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Jn(new Sp(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class CQ extends xl{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,u=null,A=null,p=null,g=null,v=null,y=null;const b=new EQ,w=t.getContextAttributes();let S=null,C=null;const E=[],R=[],D=new rt;let B=null;const L=new Er;L.viewport=new Kt;const U=new Er;U.viewport=new Kt;const P=[L,U],F=new $9;let V=null,H=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ye){let De=E[ye];return De===void 0&&(De=new O1,E[ye]=De),De.getTargetRaySpace()},this.getControllerGrip=function(ye){let De=E[ye];return De===void 0&&(De=new O1,E[ye]=De),De.getGripSpace()},this.getHand=function(ye){let De=E[ye];return De===void 0&&(De=new O1,E[ye]=De),De.getHandSpace()};function j(ye){const De=R.indexOf(ye.inputSource);if(De===-1)return;const We=E[De];We!==void 0&&(We.update(ye.inputSource,ye.frame,u||o),We.dispatchEvent({type:ye.type,data:ye.inputSource}))}function J(){r.removeEventListener("select",j),r.removeEventListener("selectstart",j),r.removeEventListener("selectend",j),r.removeEventListener("squeeze",j),r.removeEventListener("squeezestart",j),r.removeEventListener("squeezeend",j),r.removeEventListener("end",J),r.removeEventListener("inputsourceschange",Z);for(let ye=0;ye<E.length;ye++){const De=R[ye];De!==null&&(R[ye]=null,E[ye].disconnect(De))}V=null,H=null,b.reset(),e.setRenderTarget(S),v=null,g=null,p=null,r=null,C=null,Be.stop(),i.isPresenting=!1,e.setPixelRatio(B),e.setSize(D.width,D.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ye){s=ye,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ye){a=ye,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(ye){u=ye},this.getBaseLayer=function(){return g!==null?g:v},this.getBinding=function(){return p},this.getFrame=function(){return y},this.getSession=function(){return r},this.setSession=async function(ye){if(r=ye,r!==null){if(S=e.getRenderTarget(),r.addEventListener("select",j),r.addEventListener("selectstart",j),r.addEventListener("selectend",j),r.addEventListener("squeeze",j),r.addEventListener("squeezestart",j),r.addEventListener("squeezeend",j),r.addEventListener("end",J),r.addEventListener("inputsourceschange",Z),w.xrCompatible!==!0&&await t.makeXRCompatible(),B=e.getPixelRatio(),e.getSize(D),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let We=null,$e=null,Ke=null;w.depth&&(Ke=w.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,We=w.stencil?Fo:Bo,$e=w.stencil?Io:Ni);const Xe={colorFormat:t.RGBA8,depthFormat:Ke,scaleFactor:s};p=new XRWebGLBinding(r,t),g=p.createProjectionLayer(Xe),r.updateRenderState({layers:[g]}),e.setPixelRatio(1),e.setSize(g.textureWidth,g.textureHeight,!1),C=new mh(g.textureWidth,g.textureHeight,{format:ur,type:Ji,depthTexture:new lo(g.textureWidth,g.textureHeight,$e,void 0,void 0,void 0,void 0,void 0,void 0,We),stencilBuffer:w.stencil,colorSpace:e.outputColorSpace,samples:w.antialias?4:0,resolveDepthBuffer:g.ignoreDepthValues===!1,resolveStencilBuffer:g.ignoreDepthValues===!1})}else{const We={antialias:w.antialias,alpha:!0,depth:w.depth,stencil:w.stencil,framebufferScaleFactor:s};v=new XRWebGLLayer(r,t,We),r.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),C=new mh(v.framebufferWidth,v.framebufferHeight,{format:ur,type:Ji,colorSpace:e.outputColorSpace,stencilBuffer:w.stencil,resolveDepthBuffer:v.ignoreDepthValues===!1,resolveStencilBuffer:v.ignoreDepthValues===!1})}C.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await r.requestReferenceSpace(a),Be.setContext(r),Be.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return b.getDepthTexture()};function Z(ye){for(let De=0;De<ye.removed.length;De++){const We=ye.removed[De],$e=R.indexOf(We);$e>=0&&(R[$e]=null,E[$e].disconnect(We))}for(let De=0;De<ye.added.length;De++){const We=ye.added[De];let $e=R.indexOf(We);if($e===-1){for(let Xe=0;Xe<E.length;Xe++)if(Xe>=R.length){R.push(We),$e=Xe;break}else if(R[Xe]===null){R[Xe]=We,$e=Xe;break}if($e===-1)break}const Ke=E[$e];Ke&&Ke.connect(We)}}const W=new re,K=new re;function ee(ye,De,We){W.setFromMatrixPosition(De.matrixWorld),K.setFromMatrixPosition(We.matrixWorld);const $e=W.distanceTo(K),Ke=De.projectionMatrix.elements,Xe=We.projectionMatrix.elements,st=Ke[14]/(Ke[10]-1),gt=Ke[14]/(Ke[10]+1),ae=(Ke[9]+1)/Ke[5],le=(Ke[9]-1)/Ke[5],G=(Ke[8]-1)/Ke[0],Te=(Xe[8]+1)/Xe[0],pe=st*G,me=st*Te,ve=$e/(-G+Te),qe=ve*-G;if(De.matrixWorld.decompose(ye.position,ye.quaternion,ye.scale),ye.translateX(qe),ye.translateZ(ve),ye.matrixWorld.compose(ye.position,ye.quaternion,ye.scale),ye.matrixWorldInverse.copy(ye.matrixWorld).invert(),Ke[10]===-1)ye.projectionMatrix.copy(De.projectionMatrix),ye.projectionMatrixInverse.copy(De.projectionMatrixInverse);else{const Me=st+ve,$=gt+ve,z=pe-qe,fe=me+($e-qe),xe=ae*gt/$*Me,Le=le*gt/$*Me;ye.projectionMatrix.makePerspective(z,fe,xe,Le,Me,$),ye.projectionMatrixInverse.copy(ye.projectionMatrix).invert()}}function se(ye,De){De===null?ye.matrixWorld.copy(ye.matrix):ye.matrixWorld.multiplyMatrices(De.matrixWorld,ye.matrix),ye.matrixWorldInverse.copy(ye.matrixWorld).invert()}this.updateCamera=function(ye){if(r===null)return;let De=ye.near,We=ye.far;b.texture!==null&&(b.depthNear>0&&(De=b.depthNear),b.depthFar>0&&(We=b.depthFar)),F.near=U.near=L.near=De,F.far=U.far=L.far=We,(V!==F.near||H!==F.far)&&(r.updateRenderState({depthNear:F.near,depthFar:F.far}),V=F.near,H=F.far),L.layers.mask=ye.layers.mask|2,U.layers.mask=ye.layers.mask|4,F.layers.mask=L.layers.mask|U.layers.mask;const $e=ye.parent,Ke=F.cameras;se(F,$e);for(let Xe=0;Xe<Ke.length;Xe++)se(Ke[Xe],$e);Ke.length===2?ee(F,L,U):F.projectionMatrix.copy(L.projectionMatrix),ge(ye,F,$e)};function ge(ye,De,We){We===null?ye.matrix.copy(De.matrixWorld):(ye.matrix.copy(We.matrixWorld),ye.matrix.invert(),ye.matrix.multiply(De.matrixWorld)),ye.matrix.decompose(ye.position,ye.quaternion,ye.scale),ye.updateMatrixWorld(!0),ye.projectionMatrix.copy(De.projectionMatrix),ye.projectionMatrixInverse.copy(De.projectionMatrixInverse),ye.isPerspectiveCamera&&(ye.fov=ph*2*Math.atan(1/ye.projectionMatrix.elements[5]),ye.zoom=1)}this.getCamera=function(){return F},this.getFoveation=function(){if(!(g===null&&v===null))return l},this.setFoveation=function(ye){l=ye,g!==null&&(g.fixedFoveation=ye),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=ye)},this.hasDepthSensing=function(){return b.texture!==null},this.getDepthSensingMesh=function(){return b.getMesh(F)};let de=null;function Ae(ye,De){if(A=De.getViewerPose(u||o),y=De,A!==null){const We=A.views;v!==null&&(e.setRenderTargetFramebuffer(C,v.framebuffer),e.setRenderTarget(C));let $e=!1;We.length!==F.cameras.length&&(F.cameras.length=0,$e=!0);for(let st=0;st<We.length;st++){const gt=We[st];let ae=null;if(v!==null)ae=v.getViewport(gt);else{const G=p.getViewSubImage(g,gt);ae=G.viewport,st===0&&(e.setRenderTargetTextures(C,G.colorTexture,G.depthStencilTexture),e.setRenderTarget(C))}let le=P[st];le===void 0&&(le=new Er,le.layers.enable(st),le.viewport=new Kt,P[st]=le),le.matrix.fromArray(gt.transform.matrix),le.matrix.decompose(le.position,le.quaternion,le.scale),le.projectionMatrix.fromArray(gt.projectionMatrix),le.projectionMatrixInverse.copy(le.projectionMatrix).invert(),le.viewport.set(ae.x,ae.y,ae.width,ae.height),st===0&&(F.matrix.copy(le.matrix),F.matrix.decompose(F.position,F.quaternion,F.scale)),$e===!0&&F.cameras.push(le)}const Ke=r.enabledFeatures;if(Ke&&Ke.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&p){const st=p.getDepthInformation(We[0]);st&&st.isValid&&st.texture&&b.init(e,st,r.renderState)}}for(let We=0;We<E.length;We++){const $e=R[We],Ke=E[We];$e!==null&&Ke!==void 0&&Ke.update($e,De,u||o)}de&&de(ye,De),De.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:De}),y=null}const Be=new X9;Be.setAnimationLoop(Ae),this.setAnimationLoop=function(ye){de=ye},this.dispose=function(){}}}const Mc=new jr,RQ=new on;function NQ(n,e){function t(w,S){w.matrixAutoUpdate===!0&&w.updateMatrix(),S.value.copy(w.matrix)}function i(w,S){S.color.getRGB(w.fogColor.value,w9(n)),S.isFog?(w.fogNear.value=S.near,w.fogFar.value=S.far):S.isFogExp2&&(w.fogDensity.value=S.density)}function r(w,S,C,E,R){S.isMeshBasicMaterial||S.isMeshLambertMaterial?s(w,S):S.isMeshToonMaterial?(s(w,S),p(w,S)):S.isMeshPhongMaterial?(s(w,S),A(w,S)):S.isMeshStandardMaterial?(s(w,S),g(w,S),S.isMeshPhysicalMaterial&&v(w,S,R)):S.isMeshMatcapMaterial?(s(w,S),y(w,S)):S.isMeshDepthMaterial?s(w,S):S.isMeshDistanceMaterial?(s(w,S),b(w,S)):S.isMeshNormalMaterial?s(w,S):S.isLineBasicMaterial?(o(w,S),S.isLineDashedMaterial&&a(w,S)):S.isPointsMaterial?l(w,S,C,E):S.isSpriteMaterial?u(w,S):S.isShadowMaterial?(w.color.value.copy(S.color),w.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}function s(w,S){w.opacity.value=S.opacity,S.color&&w.diffuse.value.copy(S.color),S.emissive&&w.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(w.map.value=S.map,t(S.map,w.mapTransform)),S.alphaMap&&(w.alphaMap.value=S.alphaMap,t(S.alphaMap,w.alphaMapTransform)),S.bumpMap&&(w.bumpMap.value=S.bumpMap,t(S.bumpMap,w.bumpMapTransform),w.bumpScale.value=S.bumpScale,S.side===wi&&(w.bumpScale.value*=-1)),S.normalMap&&(w.normalMap.value=S.normalMap,t(S.normalMap,w.normalMapTransform),w.normalScale.value.copy(S.normalScale),S.side===wi&&w.normalScale.value.negate()),S.displacementMap&&(w.displacementMap.value=S.displacementMap,t(S.displacementMap,w.displacementMapTransform),w.displacementScale.value=S.displacementScale,w.displacementBias.value=S.displacementBias),S.emissiveMap&&(w.emissiveMap.value=S.emissiveMap,t(S.emissiveMap,w.emissiveMapTransform)),S.specularMap&&(w.specularMap.value=S.specularMap,t(S.specularMap,w.specularMapTransform)),S.alphaTest>0&&(w.alphaTest.value=S.alphaTest);const C=e.get(S),E=C.envMap,R=C.envMapRotation;E&&(w.envMap.value=E,Mc.copy(R),Mc.x*=-1,Mc.y*=-1,Mc.z*=-1,E.isCubeTexture&&E.isRenderTargetTexture===!1&&(Mc.y*=-1,Mc.z*=-1),w.envMapRotation.value.setFromMatrix4(RQ.makeRotationFromEuler(Mc)),w.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,w.reflectivity.value=S.reflectivity,w.ior.value=S.ior,w.refractionRatio.value=S.refractionRatio),S.lightMap&&(w.lightMap.value=S.lightMap,w.lightMapIntensity.value=S.lightMapIntensity,t(S.lightMap,w.lightMapTransform)),S.aoMap&&(w.aoMap.value=S.aoMap,w.aoMapIntensity.value=S.aoMapIntensity,t(S.aoMap,w.aoMapTransform))}function o(w,S){w.diffuse.value.copy(S.color),w.opacity.value=S.opacity,S.map&&(w.map.value=S.map,t(S.map,w.mapTransform))}function a(w,S){w.dashSize.value=S.dashSize,w.totalSize.value=S.dashSize+S.gapSize,w.scale.value=S.scale}function l(w,S,C,E){w.diffuse.value.copy(S.color),w.opacity.value=S.opacity,w.size.value=S.size*C,w.scale.value=E*.5,S.map&&(w.map.value=S.map,t(S.map,w.uvTransform)),S.alphaMap&&(w.alphaMap.value=S.alphaMap,t(S.alphaMap,w.alphaMapTransform)),S.alphaTest>0&&(w.alphaTest.value=S.alphaTest)}function u(w,S){w.diffuse.value.copy(S.color),w.opacity.value=S.opacity,w.rotation.value=S.rotation,S.map&&(w.map.value=S.map,t(S.map,w.mapTransform)),S.alphaMap&&(w.alphaMap.value=S.alphaMap,t(S.alphaMap,w.alphaMapTransform)),S.alphaTest>0&&(w.alphaTest.value=S.alphaTest)}function A(w,S){w.specular.value.copy(S.specular),w.shininess.value=Math.max(S.shininess,1e-4)}function p(w,S){S.gradientMap&&(w.gradientMap.value=S.gradientMap)}function g(w,S){w.metalness.value=S.metalness,S.metalnessMap&&(w.metalnessMap.value=S.metalnessMap,t(S.metalnessMap,w.metalnessMapTransform)),w.roughness.value=S.roughness,S.roughnessMap&&(w.roughnessMap.value=S.roughnessMap,t(S.roughnessMap,w.roughnessMapTransform)),S.envMap&&(w.envMapIntensity.value=S.envMapIntensity)}function v(w,S,C){w.ior.value=S.ior,S.sheen>0&&(w.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),w.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(w.sheenColorMap.value=S.sheenColorMap,t(S.sheenColorMap,w.sheenColorMapTransform)),S.sheenRoughnessMap&&(w.sheenRoughnessMap.value=S.sheenRoughnessMap,t(S.sheenRoughnessMap,w.sheenRoughnessMapTransform))),S.clearcoat>0&&(w.clearcoat.value=S.clearcoat,w.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(w.clearcoatMap.value=S.clearcoatMap,t(S.clearcoatMap,w.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,t(S.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(w.clearcoatNormalMap.value=S.clearcoatNormalMap,t(S.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),S.side===wi&&w.clearcoatNormalScale.value.negate())),S.dispersion>0&&(w.dispersion.value=S.dispersion),S.iridescence>0&&(w.iridescence.value=S.iridescence,w.iridescenceIOR.value=S.iridescenceIOR,w.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(w.iridescenceMap.value=S.iridescenceMap,t(S.iridescenceMap,w.iridescenceMapTransform)),S.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=S.iridescenceThicknessMap,t(S.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),S.transmission>0&&(w.transmission.value=S.transmission,w.transmissionSamplerMap.value=C.texture,w.transmissionSamplerSize.value.set(C.width,C.height),S.transmissionMap&&(w.transmissionMap.value=S.transmissionMap,t(S.transmissionMap,w.transmissionMapTransform)),w.thickness.value=S.thickness,S.thicknessMap&&(w.thicknessMap.value=S.thicknessMap,t(S.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=S.attenuationDistance,w.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(w.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(w.anisotropyMap.value=S.anisotropyMap,t(S.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=S.specularIntensity,w.specularColor.value.copy(S.specularColor),S.specularColorMap&&(w.specularColorMap.value=S.specularColorMap,t(S.specularColorMap,w.specularColorMapTransform)),S.specularIntensityMap&&(w.specularIntensityMap.value=S.specularIntensityMap,t(S.specularIntensityMap,w.specularIntensityMapTransform))}function y(w,S){S.matcap&&(w.matcap.value=S.matcap)}function b(w,S){const C=e.get(S).light;w.referencePosition.value.setFromMatrixPosition(C.matrixWorld),w.nearDistance.value=C.shadow.camera.near,w.farDistance.value=C.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function PQ(n,e,t,i){let r={},s={},o=[];const a=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function l(C,E){const R=E.program;i.uniformBlockBinding(C,R)}function u(C,E){let R=r[C.id];R===void 0&&(y(C),R=A(C),r[C.id]=R,C.addEventListener("dispose",w));const D=E.program;i.updateUBOMapping(C,D);const B=e.render.frame;s[C.id]!==B&&(g(C),s[C.id]=B)}function A(C){const E=p();C.__bindingPointIndex=E;const R=n.createBuffer(),D=C.__size,B=C.usage;return n.bindBuffer(n.UNIFORM_BUFFER,R),n.bufferData(n.UNIFORM_BUFFER,D,B),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,E,R),R}function p(){for(let C=0;C<a;C++)if(o.indexOf(C)===-1)return o.push(C),C;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function g(C){const E=r[C.id],R=C.uniforms,D=C.__cache;n.bindBuffer(n.UNIFORM_BUFFER,E);for(let B=0,L=R.length;B<L;B++){const U=Array.isArray(R[B])?R[B]:[R[B]];for(let P=0,F=U.length;P<F;P++){const V=U[P];if(v(V,B,P,D)===!0){const H=V.__offset,j=Array.isArray(V.value)?V.value:[V.value];let J=0;for(let Z=0;Z<j.length;Z++){const W=j[Z],K=b(W);typeof W=="number"||typeof W=="boolean"?(V.__data[0]=W,n.bufferSubData(n.UNIFORM_BUFFER,H+J,V.__data)):W.isMatrix3?(V.__data[0]=W.elements[0],V.__data[1]=W.elements[1],V.__data[2]=W.elements[2],V.__data[3]=0,V.__data[4]=W.elements[3],V.__data[5]=W.elements[4],V.__data[6]=W.elements[5],V.__data[7]=0,V.__data[8]=W.elements[6],V.__data[9]=W.elements[7],V.__data[10]=W.elements[8],V.__data[11]=0):(W.toArray(V.__data,J),J+=K.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,H,V.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function v(C,E,R,D){const B=C.value,L=E+"_"+R;if(D[L]===void 0)return typeof B=="number"||typeof B=="boolean"?D[L]=B:D[L]=B.clone(),!0;{const U=D[L];if(typeof B=="number"||typeof B=="boolean"){if(U!==B)return D[L]=B,!0}else if(U.equals(B)===!1)return U.copy(B),!0}return!1}function y(C){const E=C.uniforms;let R=0;const D=16;for(let L=0,U=E.length;L<U;L++){const P=Array.isArray(E[L])?E[L]:[E[L]];for(let F=0,V=P.length;F<V;F++){const H=P[F],j=Array.isArray(H.value)?H.value:[H.value];for(let J=0,Z=j.length;J<Z;J++){const W=j[J],K=b(W),ee=R%D,se=ee%K.boundary,ge=ee+se;R+=se,ge!==0&&D-ge<K.storage&&(R+=D-ge),H.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),H.__offset=R,R+=K.storage}}}const B=R%D;return B>0&&(R+=D-B),C.__size=R,C.__cache={},this}function b(C){const E={boundary:0,storage:0};return typeof C=="number"||typeof C=="boolean"?(E.boundary=4,E.storage=4):C.isVector2?(E.boundary=8,E.storage=8):C.isVector3||C.isColor?(E.boundary=16,E.storage=12):C.isVector4?(E.boundary=16,E.storage=16):C.isMatrix3?(E.boundary=48,E.storage=48):C.isMatrix4?(E.boundary=64,E.storage=64):C.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",C),E}function w(C){const E=C.target;E.removeEventListener("dispose",w);const R=o.indexOf(E.__bindingPointIndex);o.splice(R,1),n.deleteBuffer(r[E.id]),delete r[E.id],delete s[E.id]}function S(){for(const C in r)n.deleteBuffer(r[C]);o=[],r={},s={}}return{bind:l,update:u,dispose:S}}class eb{constructor(e={}){const{canvas:t=b9(),context:i=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:A="default",failIfMajorPerformanceCaveat:p=!1,reverseDepthBuffer:g=!1}=e;this.isWebGLRenderer=!0;let v;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");v=i.getContextAttributes().alpha}else v=o;const y=new Uint32Array(4),b=new Int32Array(4);let w=null,S=null;const C=[],E=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=ao,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const R=this;let D=!1;this._outputColorSpace=Zt;let B=0,L=0,U=null,P=-1,F=null;const V=new Kt,H=new Kt;let j=null;const J=new Gt(0);let Z=0,W=t.width,K=t.height,ee=1,se=null,ge=null;const de=new Kt(0,0,W,K),Ae=new Kt(0,0,W,K);let Be=!1;const ye=new qA;let De=!1,We=!1;const $e=new on,Ke=new on,Xe=new re,st=new Kt,gt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ae=!1;function le(){return U===null?ee:1}let G=i;function Te(ne,Re){return t.getContext(ne,Re)}try{const ne={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:A,failIfMajorPerformanceCaveat:p};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${gp}`),t.addEventListener("webglcontextlost",q,!1),t.addEventListener("webglcontextrestored",Pt,!1),t.addEventListener("webglcontextcreationerror",wt,!1),G===null){const Re="webgl2";if(G=Te(Re,ne),G===null)throw Te(Re)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ne){throw console.error("THREE.WebGLRenderer: "+ne.message),ne}let pe,me,ve,qe,Me,$,z,fe,xe,Le,Ne,ot,Qe,xt,bt,nt,At,Dt,Ot,dt,kt,Lt,$t,ie;function Mt(){pe=new qj(G),pe.init(),Lt=new SQ(G,pe),me=new Bj(G,pe,e,Lt),ve=new bQ(G,pe),me.reverseDepthBuffer&&g&&ve.buffers.depth.setReversed(!0),qe=new Wj(G),Me=new uQ,$=new TQ(G,pe,ve,Me,me,Lt,qe),z=new Uj(R),fe=new zj(R),xe=new ZH(G),$t=new Dj(G,xe),Le=new Gj(G,xe,qe,$t),Ne=new jj(G,Le,xe,qe),Ot=new $j(G,me,$),nt=new Fj(Me),ot=new lQ(R,z,fe,pe,me,$t,nt),Qe=new NQ(R,Me),xt=new hQ,bt=new gQ(pe),Dt=new Lj(R,z,fe,ve,Ne,v,l),At=new yQ(R,Ne,me),ie=new PQ(G,qe,me,ve),dt=new Ij(G,pe,qe),kt=new Hj(G,pe,qe),qe.programs=ot.programs,R.capabilities=me,R.extensions=pe,R.properties=Me,R.renderLists=xt,R.shadowMap=At,R.state=ve,R.info=qe}Mt();const je=new CQ(R,G);this.xr=je,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){const ne=pe.get("WEBGL_lose_context");ne&&ne.loseContext()},this.forceContextRestore=function(){const ne=pe.get("WEBGL_lose_context");ne&&ne.restoreContext()},this.getPixelRatio=function(){return ee},this.setPixelRatio=function(ne){ne!==void 0&&(ee=ne,this.setSize(W,K,!1))},this.getSize=function(ne){return ne.set(W,K)},this.setSize=function(ne,Re,Ve=!0){if(je.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}W=ne,K=Re,t.width=Math.floor(ne*ee),t.height=Math.floor(Re*ee),Ve===!0&&(t.style.width=ne+"px",t.style.height=Re+"px"),this.setViewport(0,0,ne,Re)},this.getDrawingBufferSize=function(ne){return ne.set(W*ee,K*ee).floor()},this.setDrawingBufferSize=function(ne,Re,Ve){W=ne,K=Re,ee=Ve,t.width=Math.floor(ne*Ve),t.height=Math.floor(Re*Ve),this.setViewport(0,0,ne,Re)},this.getCurrentViewport=function(ne){return ne.copy(V)},this.getViewport=function(ne){return ne.copy(de)},this.setViewport=function(ne,Re,Ve,Ge){ne.isVector4?de.set(ne.x,ne.y,ne.z,ne.w):de.set(ne,Re,Ve,Ge),ve.viewport(V.copy(de).multiplyScalar(ee).round())},this.getScissor=function(ne){return ne.copy(Ae)},this.setScissor=function(ne,Re,Ve,Ge){ne.isVector4?Ae.set(ne.x,ne.y,ne.z,ne.w):Ae.set(ne,Re,Ve,Ge),ve.scissor(H.copy(Ae).multiplyScalar(ee).round())},this.getScissorTest=function(){return Be},this.setScissorTest=function(ne){ve.setScissorTest(Be=ne)},this.setOpaqueSort=function(ne){se=ne},this.setTransparentSort=function(ne){ge=ne},this.getClearColor=function(ne){return ne.copy(Dt.getClearColor())},this.setClearColor=function(){Dt.setClearColor(...arguments)},this.getClearAlpha=function(){return Dt.getClearAlpha()},this.setClearAlpha=function(){Dt.setClearAlpha(...arguments)},this.clear=function(ne=!0,Re=!0,Ve=!0){let Ge=0;if(ne){let Fe=!1;if(U!==null){const Tt=U.texture.format;Fe=Tt===VA||Tt===kA||Tt===OA}if(Fe){const Tt=U.texture.type,Nt=Tt===Ji||Tt===Ni||Tt===xa||Tt===Io||Tt===C2||Tt===R2,lt=Dt.getClearColor(),Y=Dt.getClearAlpha(),mt=lt.r,ln=lt.g,Qt=lt.b;Nt?(y[0]=mt,y[1]=ln,y[2]=Qt,y[3]=Y,G.clearBufferuiv(G.COLOR,0,y)):(b[0]=mt,b[1]=ln,b[2]=Qt,b[3]=Y,G.clearBufferiv(G.COLOR,0,b))}else Ge|=G.COLOR_BUFFER_BIT}Re&&(Ge|=G.DEPTH_BUFFER_BIT),Ve&&(Ge|=G.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),G.clear(Ge)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",q,!1),t.removeEventListener("webglcontextrestored",Pt,!1),t.removeEventListener("webglcontextcreationerror",wt,!1),Dt.dispose(),xt.dispose(),bt.dispose(),Me.dispose(),z.dispose(),fe.dispose(),Ne.dispose(),$t.dispose(),ie.dispose(),ot.dispose(),je.dispose(),je.removeEventListener("sessionstart",ke),je.removeEventListener("sessionend",it),pt.stop()};function q(ne){ne.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function Pt(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1;const ne=qe.autoReset,Re=At.enabled,Ve=At.autoUpdate,Ge=At.needsUpdate,Fe=At.type;Mt(),qe.autoReset=ne,At.enabled=Re,At.autoUpdate=Ve,At.needsUpdate=Ge,At.type=Fe}function wt(ne){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ne.statusMessage)}function sn(ne){const Re=ne.target;Re.removeEventListener("dispose",sn),$n(Re)}function $n(ne){Rn(ne),Me.remove(ne)}function Rn(ne){const Re=Me.get(ne).programs;Re!==void 0&&(Re.forEach(function(Ve){ot.releaseProgram(Ve)}),ne.isShaderMaterial&&ot.releaseShaderCache(ne))}this.renderBufferDirect=function(ne,Re,Ve,Ge,Fe,Tt){Re===null&&(Re=gt);const Nt=Fe.isMesh&&Fe.matrixWorld.determinant()<0,lt=tr(ne,Re,Ve,Ge,Fe);ve.setMaterial(Ge,Nt);let Y=Ve.index,mt=1;if(Ge.wireframe===!0){if(Y=Le.getWireframeAttribute(Ve),Y===void 0)return;mt=2}const ln=Ve.drawRange,Qt=Ve.attributes.position;let Bn=ln.start*mt,zn=(ln.start+ln.count)*mt;Tt!==null&&(Bn=Math.max(Bn,Tt.start*mt),zn=Math.min(zn,(Tt.start+Tt.count)*mt)),Y!==null?(Bn=Math.max(Bn,0),zn=Math.min(zn,Y.count)):Qt!=null&&(Bn=Math.max(Bn,0),zn=Math.min(zn,Qt.count));const Li=zn-Bn;if(Li<0||Li===1/0)return;$t.setup(Fe,Ge,lt,Ve,Y);let Q,qn=dt;if(Y!==null&&(Q=xe.get(Y),qn=kt,qn.setIndex(Q)),Fe.isMesh)Ge.wireframe===!0?(ve.setLineWidth(Ge.wireframeLinewidth*le()),qn.setMode(G.LINES)):qn.setMode(G.TRIANGLES);else if(Fe.isLine){let Yt=Ge.linewidth;Yt===void 0&&(Yt=1),ve.setLineWidth(Yt*le()),Fe.isLineSegments?qn.setMode(G.LINES):Fe.isLineLoop?qn.setMode(G.LINE_LOOP):qn.setMode(G.LINE_STRIP)}else Fe.isPoints?qn.setMode(G.POINTS):Fe.isSprite&&qn.setMode(G.TRIANGLES);if(Fe.isBatchedMesh)if(Fe._multiDrawInstances!==null)Ea("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),qn.renderMultiDrawInstances(Fe._multiDrawStarts,Fe._multiDrawCounts,Fe._multiDrawCount,Fe._multiDrawInstances);else if(pe.get("WEBGL_multi_draw"))qn.renderMultiDraw(Fe._multiDrawStarts,Fe._multiDrawCounts,Fe._multiDrawCount);else{const Yt=Fe._multiDrawStarts,Di=Fe._multiDrawCounts,jn=Fe._multiDrawCount,Qr=Y?xe.get(Y).bytesPerElement:1,Ws=Me.get(Ge).currentProgram.getUniforms();for(let Ar=0;Ar<jn;Ar++)Ws.setValue(G,"_gl_DrawID",Ar),qn.render(Yt[Ar]/Qr,Di[Ar])}else if(Fe.isInstancedMesh)qn.renderInstances(Bn,Li,Fe.count);else if(Ve.isInstancedBufferGeometry){const Yt=Ve._maxInstanceCount!==void 0?Ve._maxInstanceCount:1/0,Di=Math.min(Ve.instanceCount,Yt);qn.renderInstances(Bn,Li,Di)}else qn.render(Bn,Li)};function tn(ne,Re,Ve){ne.transparent===!0&&ne.side===ar&&ne.forceSinglePass===!1?(ne.side=wi,ne.needsUpdate=!0,Kn(ne,Re,Ve),ne.side=oo,ne.needsUpdate=!0,Kn(ne,Re,Ve),ne.side=ar):Kn(ne,Re,Ve)}this.compile=function(ne,Re,Ve=null){Ve===null&&(Ve=ne),S=bt.get(Ve),S.init(Re),E.push(S),Ve.traverseVisible(function(Fe){Fe.isLight&&Fe.layers.test(Re.layers)&&(S.pushLight(Fe),Fe.castShadow&&S.pushShadow(Fe))}),ne!==Ve&&ne.traverseVisible(function(Fe){Fe.isLight&&Fe.layers.test(Re.layers)&&(S.pushLight(Fe),Fe.castShadow&&S.pushShadow(Fe))}),S.setupLights();const Ge=new Set;return ne.traverse(function(Fe){if(!(Fe.isMesh||Fe.isPoints||Fe.isLine||Fe.isSprite))return;const Tt=Fe.material;if(Tt)if(Array.isArray(Tt))for(let Nt=0;Nt<Tt.length;Nt++){const lt=Tt[Nt];tn(lt,Ve,Fe),Ge.add(lt)}else tn(Tt,Ve,Fe),Ge.add(Tt)}),S=E.pop(),Ge},this.compileAsync=function(ne,Re,Ve=null){const Ge=this.compile(ne,Re,Ve);return new Promise(Fe=>{function Tt(){if(Ge.forEach(function(Nt){Me.get(Nt).currentProgram.isReady()&&Ge.delete(Nt)}),Ge.size===0){Fe(ne);return}setTimeout(Tt,10)}pe.get("KHR_parallel_shader_compile")!==null?Tt():setTimeout(Tt,10)})};let vi=null;function Wn(ne){vi&&vi(ne)}function ke(){pt.stop()}function it(){pt.start()}const pt=new X9;pt.setAnimationLoop(Wn),typeof self<"u"&&pt.setContext(self),this.setAnimationLoop=function(ne){vi=ne,je.setAnimationLoop(ne),ne===null?pt.stop():pt.start()},je.addEventListener("sessionstart",ke),je.addEventListener("sessionend",it),this.render=function(ne,Re){if(Re!==void 0&&Re.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(D===!0)return;if(ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),Re.parent===null&&Re.matrixWorldAutoUpdate===!0&&Re.updateMatrixWorld(),je.enabled===!0&&je.isPresenting===!0&&(je.cameraAutoUpdate===!0&&je.updateCamera(Re),Re=je.getCamera()),ne.isScene===!0&&ne.onBeforeRender(R,ne,Re,U),S=bt.get(ne,E.length),S.init(Re),E.push(S),Ke.multiplyMatrices(Re.projectionMatrix,Re.matrixWorldInverse),ye.setFromProjectionMatrix(Ke),We=this.localClippingEnabled,De=nt.init(this.clippingPlanes,We),w=xt.get(ne,C.length),w.init(),C.push(w),je.enabled===!0&&je.isPresenting===!0){const Tt=R.xr.getDepthSensingMesh();Tt!==null&&et(Tt,Re,-1/0,R.sortObjects)}et(ne,Re,0,R.sortObjects),w.finish(),R.sortObjects===!0&&w.sort(se,ge),ae=je.enabled===!1||je.isPresenting===!1||je.hasDepthSensing()===!1,ae&&Dt.addToRenderList(w,ne),this.info.render.frame++,De===!0&&nt.beginShadows();const Ve=S.state.shadowsArray;At.render(Ve,ne,Re),De===!0&&nt.endShadows(),this.info.autoReset===!0&&this.info.reset();const Ge=w.opaque,Fe=w.transmissive;if(S.setupLights(),Re.isArrayCamera){const Tt=Re.cameras;if(Fe.length>0)for(let Nt=0,lt=Tt.length;Nt<lt;Nt++){const Y=Tt[Nt];X(Ge,Fe,ne,Y)}ae&&Dt.render(ne);for(let Nt=0,lt=Tt.length;Nt<lt;Nt++){const Y=Tt[Nt];c(w,ne,Y,Y.viewport)}}else Fe.length>0&&X(Ge,Fe,ne,Re),ae&&Dt.render(ne),c(w,ne,Re);U!==null&&L===0&&($.updateMultisampleRenderTarget(U),$.updateRenderTargetMipmap(U)),ne.isScene===!0&&ne.onAfterRender(R,ne,Re),$t.resetDefaultState(),P=-1,F=null,E.pop(),E.length>0?(S=E[E.length-1],De===!0&&nt.setGlobalState(R.clippingPlanes,S.state.camera)):S=null,C.pop(),C.length>0?w=C[C.length-1]:w=null};function et(ne,Re,Ve,Ge){if(ne.visible===!1)return;if(ne.layers.test(Re.layers)){if(ne.isGroup)Ve=ne.renderOrder;else if(ne.isLOD)ne.autoUpdate===!0&&ne.update(Re);else if(ne.isLight)S.pushLight(ne),ne.castShadow&&S.pushShadow(ne);else if(ne.isSprite){if(!ne.frustumCulled||ye.intersectsSprite(ne)){Ge&&st.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(Ke);const Nt=Ne.update(ne),lt=ne.material;lt.visible&&w.push(ne,Nt,lt,Ve,st.z,null)}}else if((ne.isMesh||ne.isLine||ne.isPoints)&&(!ne.frustumCulled||ye.intersectsObject(ne))){const Nt=Ne.update(ne),lt=ne.material;if(Ge&&(ne.boundingSphere!==void 0?(ne.boundingSphere===null&&ne.computeBoundingSphere(),st.copy(ne.boundingSphere.center)):(Nt.boundingSphere===null&&Nt.computeBoundingSphere(),st.copy(Nt.boundingSphere.center)),st.applyMatrix4(ne.matrixWorld).applyMatrix4(Ke)),Array.isArray(lt)){const Y=Nt.groups;for(let mt=0,ln=Y.length;mt<ln;mt++){const Qt=Y[mt],Bn=lt[Qt.materialIndex];Bn&&Bn.visible&&w.push(ne,Nt,Bn,Ve,st.z,Qt)}}else lt.visible&&w.push(ne,Nt,lt,Ve,st.z,null)}}const Tt=ne.children;for(let Nt=0,lt=Tt.length;Nt<lt;Nt++)et(Tt[Nt],Re,Ve,Ge)}function c(ne,Re,Ve,Ge){const Fe=ne.opaque,Tt=ne.transmissive,Nt=ne.transparent;S.setupLightsView(Ve),De===!0&&nt.setGlobalState(R.clippingPlanes,Ve),Ge&&ve.viewport(V.copy(Ge)),Fe.length>0&&dn(Fe,Re,Ve),Tt.length>0&&dn(Tt,Re,Ve),Nt.length>0&&dn(Nt,Re,Ve),ve.buffers.depth.setTest(!0),ve.buffers.depth.setMask(!0),ve.buffers.color.setMask(!0),ve.setPolygonOffset(!1)}function X(ne,Re,Ve,Ge){if((Ve.isScene===!0?Ve.overrideMaterial:null)!==null)return;S.state.transmissionRenderTarget[Ge.id]===void 0&&(S.state.transmissionRenderTarget[Ge.id]=new mh(1,1,{generateMipmaps:!0,type:pe.has("EXT_color_buffer_half_float")||pe.has("EXT_color_buffer_float")?Dr:Ji,minFilter:to,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Un.workingColorSpace}));const Tt=S.state.transmissionRenderTarget[Ge.id],Nt=Ge.viewport||V;Tt.setSize(Nt.z*R.transmissionResolutionScale,Nt.w*R.transmissionResolutionScale);const lt=R.getRenderTarget();R.setRenderTarget(Tt),R.getClearColor(J),Z=R.getClearAlpha(),Z<1&&R.setClearColor(16777215,.5),R.clear(),ae&&Dt.render(Ve);const Y=R.toneMapping;R.toneMapping=ao;const mt=Ge.viewport;if(Ge.viewport!==void 0&&(Ge.viewport=void 0),S.setupLightsView(Ge),De===!0&&nt.setGlobalState(R.clippingPlanes,Ge),dn(ne,Ve,Ge),$.updateMultisampleRenderTarget(Tt),$.updateRenderTargetMipmap(Tt),pe.has("WEBGL_multisampled_render_to_texture")===!1){let ln=!1;for(let Qt=0,Bn=Re.length;Qt<Bn;Qt++){const zn=Re[Qt],Li=zn.object,Q=zn.geometry,qn=zn.material,Yt=zn.group;if(qn.side===ar&&Li.layers.test(Ge.layers)){const Di=qn.side;qn.side=wi,qn.needsUpdate=!0,Nn(Li,Ve,Ge,Q,qn,Yt),qn.side=Di,qn.needsUpdate=!0,ln=!0}}ln===!0&&($.updateMultisampleRenderTarget(Tt),$.updateRenderTargetMipmap(Tt))}R.setRenderTarget(lt),R.setClearColor(J,Z),mt!==void 0&&(Ge.viewport=mt),R.toneMapping=Y}function dn(ne,Re,Ve){const Ge=Re.isScene===!0?Re.overrideMaterial:null;for(let Fe=0,Tt=ne.length;Fe<Tt;Fe++){const Nt=ne[Fe],lt=Nt.object,Y=Nt.geometry,mt=Nt.group;let ln=Nt.material;ln.allowOverride===!0&&Ge!==null&&(ln=Ge),lt.layers.test(Ve.layers)&&Nn(lt,Re,Ve,Y,ln,mt)}}function Nn(ne,Re,Ve,Ge,Fe,Tt){ne.onBeforeRender(R,Re,Ve,Ge,Fe,Tt),ne.modelViewMatrix.multiplyMatrices(Ve.matrixWorldInverse,ne.matrixWorld),ne.normalMatrix.getNormalMatrix(ne.modelViewMatrix),Fe.onBeforeRender(R,Re,Ve,Ge,ne,Tt),Fe.transparent===!0&&Fe.side===ar&&Fe.forceSinglePass===!1?(Fe.side=wi,Fe.needsUpdate=!0,R.renderBufferDirect(Ve,Re,Ge,Fe,ne,Tt),Fe.side=oo,Fe.needsUpdate=!0,R.renderBufferDirect(Ve,Re,Ge,Fe,ne,Tt),Fe.side=ar):R.renderBufferDirect(Ve,Re,Ge,Fe,ne,Tt),ne.onAfterRender(R,Re,Ve,Ge,Fe,Tt)}function Kn(ne,Re,Ve){Re.isScene!==!0&&(Re=gt);const Ge=Me.get(ne),Fe=S.state.lights,Tt=S.state.shadowsArray,Nt=Fe.state.version,lt=ot.getParameters(ne,Fe.state,Tt,Re,Ve),Y=ot.getProgramCacheKey(lt);let mt=Ge.programs;Ge.environment=ne.isMeshStandardMaterial?Re.environment:null,Ge.fog=Re.fog,Ge.envMap=(ne.isMeshStandardMaterial?fe:z).get(ne.envMap||Ge.environment),Ge.envMapRotation=Ge.environment!==null&&ne.envMap===null?Re.environmentRotation:ne.envMapRotation,mt===void 0&&(ne.addEventListener("dispose",sn),mt=new Map,Ge.programs=mt);let ln=mt.get(Y);if(ln!==void 0){if(Ge.currentProgram===ln&&Ge.lightsStateVersion===Nt)return ht(ne,lt),ln}else lt.uniforms=ot.getUniforms(ne),ne.onBeforeCompile(lt,R),ln=ot.acquireProgram(lt,Y),mt.set(Y,ln),Ge.uniforms=lt.uniforms;const Qt=Ge.uniforms;return(!ne.isShaderMaterial&&!ne.isRawShaderMaterial||ne.clipping===!0)&&(Qt.clippingPlanes=nt.uniform),ht(ne,lt),Ge.needsLights=qt(ne),Ge.lightsStateVersion=Nt,Ge.needsLights&&(Qt.ambientLightColor.value=Fe.state.ambient,Qt.lightProbe.value=Fe.state.probe,Qt.directionalLights.value=Fe.state.directional,Qt.directionalLightShadows.value=Fe.state.directionalShadow,Qt.spotLights.value=Fe.state.spot,Qt.spotLightShadows.value=Fe.state.spotShadow,Qt.rectAreaLights.value=Fe.state.rectArea,Qt.ltc_1.value=Fe.state.rectAreaLTC1,Qt.ltc_2.value=Fe.state.rectAreaLTC2,Qt.pointLights.value=Fe.state.point,Qt.pointLightShadows.value=Fe.state.pointShadow,Qt.hemisphereLights.value=Fe.state.hemi,Qt.directionalShadowMap.value=Fe.state.directionalShadowMap,Qt.directionalShadowMatrix.value=Fe.state.directionalShadowMatrix,Qt.spotShadowMap.value=Fe.state.spotShadowMap,Qt.spotLightMatrix.value=Fe.state.spotLightMatrix,Qt.spotLightMap.value=Fe.state.spotLightMap,Qt.pointShadowMap.value=Fe.state.pointShadowMap,Qt.pointShadowMatrix.value=Fe.state.pointShadowMatrix),Ge.currentProgram=ln,Ge.uniformsList=null,ln}function an(ne){if(ne.uniformsList===null){const Re=ne.currentProgram.getUniforms();ne.uniformsList=V1.seqWithValue(Re.seq,ne.uniforms)}return ne.uniformsList}function ht(ne,Re){const Ve=Me.get(ne);Ve.outputColorSpace=Re.outputColorSpace,Ve.batching=Re.batching,Ve.batchingColor=Re.batchingColor,Ve.instancing=Re.instancing,Ve.instancingColor=Re.instancingColor,Ve.instancingMorph=Re.instancingMorph,Ve.skinning=Re.skinning,Ve.morphTargets=Re.morphTargets,Ve.morphNormals=Re.morphNormals,Ve.morphColors=Re.morphColors,Ve.morphTargetsCount=Re.morphTargetsCount,Ve.numClippingPlanes=Re.numClippingPlanes,Ve.numIntersection=Re.numClipIntersection,Ve.vertexAlphas=Re.vertexAlphas,Ve.vertexTangents=Re.vertexTangents,Ve.toneMapping=Re.toneMapping}function tr(ne,Re,Ve,Ge,Fe){Re.isScene!==!0&&(Re=gt),$.resetTextureUnits();const Tt=Re.fog,Nt=Ge.isMeshStandardMaterial?Re.environment:null,lt=U===null?R.outputColorSpace:U.isXRRenderTarget===!0?U.texture.colorSpace:Ma,Y=(Ge.isMeshStandardMaterial?fe:z).get(Ge.envMap||Nt),mt=Ge.vertexColors===!0&&!!Ve.attributes.color&&Ve.attributes.color.itemSize===4,ln=!!Ve.attributes.tangent&&(!!Ge.normalMap||Ge.anisotropy>0),Qt=!!Ve.morphAttributes.position,Bn=!!Ve.morphAttributes.normal,zn=!!Ve.morphAttributes.color;let Li=ao;Ge.toneMapped&&(U===null||U.isXRRenderTarget===!0)&&(Li=R.toneMapping);const Q=Ve.morphAttributes.position||Ve.morphAttributes.normal||Ve.morphAttributes.color,qn=Q!==void 0?Q.length:0,Yt=Me.get(Ge),Di=S.state.lights;if(De===!0&&(We===!0||ne!==F)){const dr=ne===F&&Ge.id===P;nt.setState(Ge,ne,dr)}let jn=!1;Ge.version===Yt.__version?(Yt.needsLights&&Yt.lightsStateVersion!==Di.state.version||Yt.outputColorSpace!==lt||Fe.isBatchedMesh&&Yt.batching===!1||!Fe.isBatchedMesh&&Yt.batching===!0||Fe.isBatchedMesh&&Yt.batchingColor===!0&&Fe.colorTexture===null||Fe.isBatchedMesh&&Yt.batchingColor===!1&&Fe.colorTexture!==null||Fe.isInstancedMesh&&Yt.instancing===!1||!Fe.isInstancedMesh&&Yt.instancing===!0||Fe.isSkinnedMesh&&Yt.skinning===!1||!Fe.isSkinnedMesh&&Yt.skinning===!0||Fe.isInstancedMesh&&Yt.instancingColor===!0&&Fe.instanceColor===null||Fe.isInstancedMesh&&Yt.instancingColor===!1&&Fe.instanceColor!==null||Fe.isInstancedMesh&&Yt.instancingMorph===!0&&Fe.morphTexture===null||Fe.isInstancedMesh&&Yt.instancingMorph===!1&&Fe.morphTexture!==null||Yt.envMap!==Y||Ge.fog===!0&&Yt.fog!==Tt||Yt.numClippingPlanes!==void 0&&(Yt.numClippingPlanes!==nt.numPlanes||Yt.numIntersection!==nt.numIntersection)||Yt.vertexAlphas!==mt||Yt.vertexTangents!==ln||Yt.morphTargets!==Qt||Yt.morphNormals!==Bn||Yt.morphColors!==zn||Yt.toneMapping!==Li||Yt.morphTargetsCount!==qn)&&(jn=!0):(jn=!0,Yt.__version=Ge.version);let Qr=Yt.currentProgram;jn===!0&&(Qr=Kn(Ge,Re,Fe));let Ws=!1,Ar=!1,$s=!1;const si=Qr.getUniforms(),Ii=Yt.uniforms;if(ve.useProgram(Qr.program)&&(Ws=!0,Ar=!0,$s=!0),Ge.id!==P&&(P=Ge.id,Ar=!0),Ws||F!==ne){ve.buffers.depth.getReversed()?($e.copy(ne.projectionMatrix),xG($e),bG($e),si.setValue(G,"projectionMatrix",$e)):si.setValue(G,"projectionMatrix",ne.projectionMatrix),si.setValue(G,"viewMatrix",ne.matrixWorldInverse);const Ur=si.map.cameraPosition;Ur!==void 0&&Ur.setValue(G,Xe.setFromMatrixPosition(ne.matrixWorld)),me.logarithmicDepthBuffer&&si.setValue(G,"logDepthBufFC",2/(Math.log(ne.far+1)/Math.LN2)),(Ge.isMeshPhongMaterial||Ge.isMeshToonMaterial||Ge.isMeshLambertMaterial||Ge.isMeshBasicMaterial||Ge.isMeshStandardMaterial||Ge.isShaderMaterial)&&si.setValue(G,"isOrthographic",ne.isOrthographicCamera===!0),F!==ne&&(F=ne,Ar=!0,$s=!0)}if(Fe.isSkinnedMesh){si.setOptional(G,Fe,"bindMatrix"),si.setOptional(G,Fe,"bindMatrixInverse");const dr=Fe.skeleton;dr&&(dr.boneTexture===null&&dr.computeBoneTexture(),si.setValue(G,"boneTexture",dr.boneTexture,$))}Fe.isBatchedMesh&&(si.setOptional(G,Fe,"batchingTexture"),si.setValue(G,"batchingTexture",Fe._matricesTexture,$),si.setOptional(G,Fe,"batchingIdTexture"),si.setValue(G,"batchingIdTexture",Fe._indirectTexture,$),si.setOptional(G,Fe,"batchingColorTexture"),Fe._colorsTexture!==null&&si.setValue(G,"batchingColorTexture",Fe._colorsTexture,$));const ei=Ve.morphAttributes;if((ei.position!==void 0||ei.normal!==void 0||ei.color!==void 0)&&Ot.update(Fe,Ve,Qr),(Ar||Yt.receiveShadow!==Fe.receiveShadow)&&(Yt.receiveShadow=Fe.receiveShadow,si.setValue(G,"receiveShadow",Fe.receiveShadow)),Ge.isMeshGouraudMaterial&&Ge.envMap!==null&&(Ii.envMap.value=Y,Ii.flipEnvMap.value=Y.isCubeTexture&&Y.isRenderTargetTexture===!1?-1:1),Ge.isMeshStandardMaterial&&Ge.envMap===null&&Re.environment!==null&&(Ii.envMapIntensity.value=Re.environmentIntensity),Ar&&(si.setValue(G,"toneMappingExposure",R.toneMappingExposure),Yt.needsLights&&un(Ii,$s),Tt&&Ge.fog===!0&&Qe.refreshFogUniforms(Ii,Tt),Qe.refreshMaterialUniforms(Ii,Ge,ee,K,S.state.transmissionRenderTarget[ne.id]),V1.upload(G,an(Yt),Ii,$)),Ge.isShaderMaterial&&Ge.uniformsNeedUpdate===!0&&(V1.upload(G,an(Yt),Ii,$),Ge.uniformsNeedUpdate=!1),Ge.isSpriteMaterial&&si.setValue(G,"center",Fe.center),si.setValue(G,"modelViewMatrix",Fe.modelViewMatrix),si.setValue(G,"normalMatrix",Fe.normalMatrix),si.setValue(G,"modelMatrix",Fe.matrixWorld),Ge.isShaderMaterial||Ge.isRawShaderMaterial){const dr=Ge.uniformsGroups;for(let Ur=0,cc=dr.length;Ur<cc;Ur++){const Vo=dr[Ur];ie.update(Vo,Qr),ie.bind(Vo,Qr)}}return Qr}function un(ne,Re){ne.ambientLightColor.needsUpdate=Re,ne.lightProbe.needsUpdate=Re,ne.directionalLights.needsUpdate=Re,ne.directionalLightShadows.needsUpdate=Re,ne.pointLights.needsUpdate=Re,ne.pointLightShadows.needsUpdate=Re,ne.spotLights.needsUpdate=Re,ne.spotLightShadows.needsUpdate=Re,ne.rectAreaLights.needsUpdate=Re,ne.hemisphereLights.needsUpdate=Re}function qt(ne){return ne.isMeshLambertMaterial||ne.isMeshToonMaterial||ne.isMeshPhongMaterial||ne.isMeshStandardMaterial||ne.isShadowMaterial||ne.isShaderMaterial&&ne.lights===!0}this.getActiveCubeFace=function(){return B},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return U},this.setRenderTargetTextures=function(ne,Re,Ve){const Ge=Me.get(ne);Ge.__autoAllocateDepthBuffer=ne.resolveDepthBuffer===!1,Ge.__autoAllocateDepthBuffer===!1&&(Ge.__useRenderToTexture=!1),Me.get(ne.texture).__webglTexture=Re,Me.get(ne.depthTexture).__webglTexture=Ge.__autoAllocateDepthBuffer?void 0:Ve,Ge.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(ne,Re){const Ve=Me.get(ne);Ve.__webglFramebuffer=Re,Ve.__useDefaultFramebuffer=Re===void 0};const cn=G.createFramebuffer();this.setRenderTarget=function(ne,Re=0,Ve=0){U=ne,B=Re,L=Ve;let Ge=!0,Fe=null,Tt=!1,Nt=!1;if(ne){const Y=Me.get(ne);if(Y.__useDefaultFramebuffer!==void 0)ve.bindFramebuffer(G.FRAMEBUFFER,null),Ge=!1;else if(Y.__webglFramebuffer===void 0)$.setupRenderTarget(ne);else if(Y.__hasExternalTextures)$.rebindTextures(ne,Me.get(ne.texture).__webglTexture,Me.get(ne.depthTexture).__webglTexture);else if(ne.depthBuffer){const Qt=ne.depthTexture;if(Y.__boundDepthTexture!==Qt){if(Qt!==null&&Me.has(Qt)&&(ne.width!==Qt.image.width||ne.height!==Qt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");$.setupDepthRenderbuffer(ne)}}const mt=ne.texture;(mt.isData3DTexture||mt.isDataArrayTexture||mt.isCompressedArrayTexture)&&(Nt=!0);const ln=Me.get(ne).__webglFramebuffer;ne.isWebGLCubeRenderTarget?(Array.isArray(ln[Re])?Fe=ln[Re][Ve]:Fe=ln[Re],Tt=!0):ne.samples>0&&$.useMultisampledRTT(ne)===!1?Fe=Me.get(ne).__webglMultisampledFramebuffer:Array.isArray(ln)?Fe=ln[Ve]:Fe=ln,V.copy(ne.viewport),H.copy(ne.scissor),j=ne.scissorTest}else V.copy(de).multiplyScalar(ee).floor(),H.copy(Ae).multiplyScalar(ee).floor(),j=Be;if(Ve!==0&&(Fe=cn),ve.bindFramebuffer(G.FRAMEBUFFER,Fe)&&Ge&&ve.drawBuffers(ne,Fe),ve.viewport(V),ve.scissor(H),ve.setScissorTest(j),Tt){const Y=Me.get(ne.texture);G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Y.__webglTexture,Ve)}else if(Nt){const Y=Me.get(ne.texture),mt=Re;G.framebufferTextureLayer(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,Y.__webglTexture,Ve,mt)}else if(ne!==null&&Ve!==0){const Y=Me.get(ne.texture);G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,Y.__webglTexture,Ve)}P=-1},this.readRenderTargetPixels=function(ne,Re,Ve,Ge,Fe,Tt,Nt){if(!(ne&&ne.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let lt=Me.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&Nt!==void 0&&(lt=lt[Nt]),lt){ve.bindFramebuffer(G.FRAMEBUFFER,lt);try{const Y=ne.texture,mt=Y.format,ln=Y.type;if(!me.textureFormatReadable(mt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!me.textureTypeReadable(ln)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Re>=0&&Re<=ne.width-Ge&&Ve>=0&&Ve<=ne.height-Fe&&G.readPixels(Re,Ve,Ge,Fe,Lt.convert(mt),Lt.convert(ln),Tt)}finally{const Y=U!==null?Me.get(U).__webglFramebuffer:null;ve.bindFramebuffer(G.FRAMEBUFFER,Y)}}},this.readRenderTargetPixelsAsync=async function(ne,Re,Ve,Ge,Fe,Tt,Nt){if(!(ne&&ne.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let lt=Me.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&Nt!==void 0&&(lt=lt[Nt]),lt)if(Re>=0&&Re<=ne.width-Ge&&Ve>=0&&Ve<=ne.height-Fe){ve.bindFramebuffer(G.FRAMEBUFFER,lt);const Y=ne.texture,mt=Y.format,ln=Y.type;if(!me.textureFormatReadable(mt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!me.textureTypeReadable(ln))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Qt=G.createBuffer();G.bindBuffer(G.PIXEL_PACK_BUFFER,Qt),G.bufferData(G.PIXEL_PACK_BUFFER,Tt.byteLength,G.STREAM_READ),G.readPixels(Re,Ve,Ge,Fe,Lt.convert(mt),Lt.convert(ln),0);const Bn=U!==null?Me.get(U).__webglFramebuffer:null;ve.bindFramebuffer(G.FRAMEBUFFER,Bn);const zn=G.fenceSync(G.SYNC_GPU_COMMANDS_COMPLETE,0);return G.flush(),await yG(G,zn,4),G.bindBuffer(G.PIXEL_PACK_BUFFER,Qt),G.getBufferSubData(G.PIXEL_PACK_BUFFER,0,Tt),G.deleteBuffer(Qt),G.deleteSync(zn),Tt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(ne,Re=null,Ve=0){const Ge=Math.pow(2,-Ve),Fe=Math.floor(ne.image.width*Ge),Tt=Math.floor(ne.image.height*Ge),Nt=Re!==null?Re.x:0,lt=Re!==null?Re.y:0;$.setTexture2D(ne,0),G.copyTexSubImage2D(G.TEXTURE_2D,Ve,0,0,Nt,lt,Fe,Tt),ve.unbindTexture()};const mo=G.createFramebuffer(),Oa=G.createFramebuffer();this.copyTextureToTexture=function(ne,Re,Ve=null,Ge=null,Fe=0,Tt=null){Tt===null&&(Fe!==0?(Ea("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Tt=Fe,Fe=0):Tt=0);let Nt,lt,Y,mt,ln,Qt,Bn,zn,Li;const Q=ne.isCompressedTexture?ne.mipmaps[Tt]:ne.image;if(Ve!==null)Nt=Ve.max.x-Ve.min.x,lt=Ve.max.y-Ve.min.y,Y=Ve.isBox3?Ve.max.z-Ve.min.z:1,mt=Ve.min.x,ln=Ve.min.y,Qt=Ve.isBox3?Ve.min.z:0;else{const ei=Math.pow(2,-Fe);Nt=Math.floor(Q.width*ei),lt=Math.floor(Q.height*ei),ne.isDataArrayTexture?Y=Q.depth:ne.isData3DTexture?Y=Math.floor(Q.depth*ei):Y=1,mt=0,ln=0,Qt=0}Ge!==null?(Bn=Ge.x,zn=Ge.y,Li=Ge.z):(Bn=0,zn=0,Li=0);const qn=Lt.convert(Re.format),Yt=Lt.convert(Re.type);let Di;Re.isData3DTexture?($.setTexture3D(Re,0),Di=G.TEXTURE_3D):Re.isDataArrayTexture||Re.isCompressedArrayTexture?($.setTexture2DArray(Re,0),Di=G.TEXTURE_2D_ARRAY):($.setTexture2D(Re,0),Di=G.TEXTURE_2D),G.pixelStorei(G.UNPACK_FLIP_Y_WEBGL,Re.flipY),G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Re.premultiplyAlpha),G.pixelStorei(G.UNPACK_ALIGNMENT,Re.unpackAlignment);const jn=G.getParameter(G.UNPACK_ROW_LENGTH),Qr=G.getParameter(G.UNPACK_IMAGE_HEIGHT),Ws=G.getParameter(G.UNPACK_SKIP_PIXELS),Ar=G.getParameter(G.UNPACK_SKIP_ROWS),$s=G.getParameter(G.UNPACK_SKIP_IMAGES);G.pixelStorei(G.UNPACK_ROW_LENGTH,Q.width),G.pixelStorei(G.UNPACK_IMAGE_HEIGHT,Q.height),G.pixelStorei(G.UNPACK_SKIP_PIXELS,mt),G.pixelStorei(G.UNPACK_SKIP_ROWS,ln),G.pixelStorei(G.UNPACK_SKIP_IMAGES,Qt);const si=ne.isDataArrayTexture||ne.isData3DTexture,Ii=Re.isDataArrayTexture||Re.isData3DTexture;if(ne.isDepthTexture){const ei=Me.get(ne),dr=Me.get(Re),Ur=Me.get(ei.__renderTarget),cc=Me.get(dr.__renderTarget);ve.bindFramebuffer(G.READ_FRAMEBUFFER,Ur.__webglFramebuffer),ve.bindFramebuffer(G.DRAW_FRAMEBUFFER,cc.__webglFramebuffer);for(let Vo=0;Vo<Y;Vo++)si&&(G.framebufferTextureLayer(G.READ_FRAMEBUFFER,G.COLOR_ATTACHMENT0,Me.get(ne).__webglTexture,Fe,Qt+Vo),G.framebufferTextureLayer(G.DRAW_FRAMEBUFFER,G.COLOR_ATTACHMENT0,Me.get(Re).__webglTexture,Tt,Li+Vo)),G.blitFramebuffer(mt,ln,Nt,lt,Bn,zn,Nt,lt,G.DEPTH_BUFFER_BIT,G.NEAREST);ve.bindFramebuffer(G.READ_FRAMEBUFFER,null),ve.bindFramebuffer(G.DRAW_FRAMEBUFFER,null)}else if(Fe!==0||ne.isRenderTargetTexture||Me.has(ne)){const ei=Me.get(ne),dr=Me.get(Re);ve.bindFramebuffer(G.READ_FRAMEBUFFER,mo),ve.bindFramebuffer(G.DRAW_FRAMEBUFFER,Oa);for(let Ur=0;Ur<Y;Ur++)si?G.framebufferTextureLayer(G.READ_FRAMEBUFFER,G.COLOR_ATTACHMENT0,ei.__webglTexture,Fe,Qt+Ur):G.framebufferTexture2D(G.READ_FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,ei.__webglTexture,Fe),Ii?G.framebufferTextureLayer(G.DRAW_FRAMEBUFFER,G.COLOR_ATTACHMENT0,dr.__webglTexture,Tt,Li+Ur):G.framebufferTexture2D(G.DRAW_FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,dr.__webglTexture,Tt),Fe!==0?G.blitFramebuffer(mt,ln,Nt,lt,Bn,zn,Nt,lt,G.COLOR_BUFFER_BIT,G.NEAREST):Ii?G.copyTexSubImage3D(Di,Tt,Bn,zn,Li+Ur,mt,ln,Nt,lt):G.copyTexSubImage2D(Di,Tt,Bn,zn,mt,ln,Nt,lt);ve.bindFramebuffer(G.READ_FRAMEBUFFER,null),ve.bindFramebuffer(G.DRAW_FRAMEBUFFER,null)}else Ii?ne.isDataTexture||ne.isData3DTexture?G.texSubImage3D(Di,Tt,Bn,zn,Li,Nt,lt,Y,qn,Yt,Q.data):Re.isCompressedArrayTexture?G.compressedTexSubImage3D(Di,Tt,Bn,zn,Li,Nt,lt,Y,qn,Q.data):G.texSubImage3D(Di,Tt,Bn,zn,Li,Nt,lt,Y,qn,Yt,Q):ne.isDataTexture?G.texSubImage2D(G.TEXTURE_2D,Tt,Bn,zn,Nt,lt,qn,Yt,Q.data):ne.isCompressedTexture?G.compressedTexSubImage2D(G.TEXTURE_2D,Tt,Bn,zn,Q.width,Q.height,qn,Q.data):G.texSubImage2D(G.TEXTURE_2D,Tt,Bn,zn,Nt,lt,qn,Yt,Q);G.pixelStorei(G.UNPACK_ROW_LENGTH,jn),G.pixelStorei(G.UNPACK_IMAGE_HEIGHT,Qr),G.pixelStorei(G.UNPACK_SKIP_PIXELS,Ws),G.pixelStorei(G.UNPACK_SKIP_ROWS,Ar),G.pixelStorei(G.UNPACK_SKIP_IMAGES,$s),Tt===0&&Re.generateMipmaps&&G.generateMipmap(Di),ve.unbindTexture()},this.copyTextureToTexture3D=function(ne,Re,Ve=null,Ge=null,Fe=0){return Ea('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(ne,Re,Ve,Ge,Fe)},this.initRenderTarget=function(ne){Me.get(ne).__webglFramebuffer===void 0&&$.setupRenderTarget(ne)},this.initTexture=function(ne){ne.isCubeTexture?$.setTextureCube(ne,0):ne.isData3DTexture?$.setTexture3D(ne,0):ne.isDataArrayTexture||ne.isCompressedArrayTexture?$.setTexture2DArray(ne,0):$.setTexture2D(ne,0),ve.unbindTexture()},this.resetState=function(){B=0,L=0,U=null,ve.reset(),$t.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return zs}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Un._getDrawingBufferColorSpace(e),t.unpackColorSpace=Un._getUnpackColorSpace()}}function Uy(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var LQ=typeof global=="object"&&global&&global.Object===Object&&global,DQ=typeof self=="object"&&self&&self.Object===Object&&self,J9=LQ||DQ||Function("return this")(),G3=function(){return J9.Date.now()},IQ=/\s/;function BQ(n){for(var e=n.length;e--&&IQ.test(n.charAt(e)););return e}var FQ=/^\s+/;function UQ(n){return n&&n.slice(0,BQ(n)+1).replace(FQ,"")}var bg=J9.Symbol,eC=Object.prototype,OQ=eC.hasOwnProperty,kQ=eC.toString,A0=bg?bg.toStringTag:void 0;function VQ(n){var e=OQ.call(n,A0),t=n[A0];try{n[A0]=void 0;var i=!0}catch{}var r=kQ.call(n);return i&&(e?n[A0]=t:delete n[A0]),r}var zQ=Object.prototype,qQ=zQ.toString;function GQ(n){return qQ.call(n)}var HQ="[object Null]",WQ="[object Undefined]",DT=bg?bg.toStringTag:void 0;function $Q(n){return n==null?n===void 0?WQ:HQ:DT&&DT in Object(n)?VQ(n):GQ(n)}function jQ(n){return n!=null&&typeof n=="object"}var XQ="[object Symbol]";function QQ(n){return typeof n=="symbol"||jQ(n)&&$Q(n)==XQ}var IT=NaN,YQ=/^[-+]0x[0-9a-f]+$/i,ZQ=/^0b[01]+$/i,KQ=/^0o[0-7]+$/i,JQ=parseInt;function BT(n){if(typeof n=="number")return n;if(QQ(n))return IT;if(Uy(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=Uy(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=UQ(n);var t=ZQ.test(n);return t||KQ.test(n)?JQ(n.slice(2),t?2:8):YQ.test(n)?IT:+n}var eY="Expected a function",tY=Math.max,nY=Math.min;function iY(n,e,t){var i,r,s,o,a,l,u=0,A=!1,p=!1,g=!0;if(typeof n!="function")throw new TypeError(eY);e=BT(e)||0,Uy(t)&&(A=!!t.leading,p="maxWait"in t,s=p?tY(BT(t.maxWait)||0,e):s,g="trailing"in t?!!t.trailing:g);function v(B){var L=i,U=r;return i=r=void 0,u=B,o=n.apply(U,L),o}function y(B){return u=B,a=setTimeout(S,e),A?v(B):o}function b(B){var L=B-l,U=B-u,P=e-L;return p?nY(P,s-U):P}function w(B){var L=B-l,U=B-u;return l===void 0||L>=e||L<0||p&&U>=s}function S(){var B=G3();if(w(B))return C(B);a=setTimeout(S,b(B))}function C(B){return a=void 0,g&&i?v(B):(i=r=void 0,o)}function E(){a!==void 0&&clearTimeout(a),u=0,i=l=r=a=void 0}function R(){return a===void 0?o:C(G3())}function D(){var B=G3(),L=w(B);if(i=arguments,r=this,l=B,L){if(a===void 0)return y(l);if(p)return clearTimeout(a),a=setTimeout(S,e),v(l)}return a===void 0&&(a=setTimeout(S,e)),o}return D.cancel=E,D.flush=R,D}function FT(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function rY(n){if(Array.isArray(n))return n}function sY(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function oY(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function aY(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function lY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uY(n,e){return rY(n)||aY(n,e)||cY(n,e)||lY()}function cY(n,e){if(n){if(typeof n=="string")return FT(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?FT(n,e):void 0}}var hY=oY(function n(e,t){var i=t.default,r=i===void 0?null:i,s=t.triggerUpdate,o=s===void 0?!0:s,a=t.onChange,l=a===void 0?function(u,A){}:a;sY(this,n),this.name=e,this.defaultVal=r,this.triggerUpdate=o,this.onChange=l});function Ss(n){var e=n.stateInit,t=e===void 0?function(){return{}}:e,i=n.props,r=i===void 0?{}:i,s=n.methods,o=s===void 0?{}:s,a=n.aliases,l=a===void 0?{}:a,u=n.init,A=u===void 0?function(){}:u,p=n.update,g=p===void 0?function(){}:p,v=Object.keys(r).map(function(y){return new hY(y,r[y])});return function y(){for(var b=arguments.length,w=new Array(b),S=0;S<b;S++)w[S]=arguments[S];var C=!!(this instanceof y&&this.constructor),E=C?w.shift():void 0,R=w[0],D=R===void 0?{}:R,B=Object.assign({},t instanceof Function?t(D):t,{initialised:!1}),L={};function U(V){return P(V,D),F(),U}var P=function(H,j){A.call(U,H,B,j),B.initialised=!0},F=iY(function(){B.initialised&&(g.call(U,B,L),L={})},1);return v.forEach(function(V){U[V.name]=H(V);function H(j){var J=j.name,Z=j.triggerUpdate,W=Z===void 0?!1:Z,K=j.onChange,ee=K===void 0?function(de,Ae){}:K,se=j.defaultVal,ge=se===void 0?null:se;return function(de){var Ae=B[J];if(!arguments.length)return Ae;var Be=de===void 0?ge:de;return B[J]=Be,ee.call(U,Be,B,Ae),!L.hasOwnProperty(J)&&(L[J]=Ae),W&&F(),U}}}),Object.keys(o).forEach(function(V){U[V]=function(){for(var H,j=arguments.length,J=new Array(j),Z=0;Z<j;Z++)J[Z]=arguments[Z];return(H=o[V]).call.apply(H,[U,B].concat(J))}}),Object.entries(l).forEach(function(V){var H=uY(V,2),j=H[0],J=H[1];return U[j]=U[J]}),U.resetProps=function(){return v.forEach(function(V){U[V.name](V.defaultVal)}),U},U.resetProps(),B._rerender=F,C&&E&&U(E),U}}var rs=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return n},Out:function(n){return n},InOut:function(n){return n}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(n){var e=1.70158;return n===1?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return n===0?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-rs.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?rs.Bounce.In(n*2)*.5:rs.Bounce.Out(n*2-1)*.5+.5}}),generatePow:function(n){return n===void 0&&(n=4),n=n<Number.EPSILON?Number.EPSILON:n,n=n>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(e*2,n)/2:(1-Math.pow(2-e*2,n))/2+.5}}}}),z0=function(){return performance.now()},tC=function(){function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var r=0,s=t;r<s.length;r++){var o=s[r];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},n.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,r=e;i<r.length;i++){var s=r[i];s._group=void 0,delete this._tweens[s.getId()],delete this._tweensAddedDuringUpdate[s.getId()]}},n.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},n.prototype.update=function(e,t){e===void 0&&(e=z0()),t===void 0&&(t=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]],o=!t;s&&s.update(e,o)===!1&&!t&&this.remove(s)}i=Object.keys(this._tweensAddedDuringUpdate)}},n}(),Oy={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=Oy.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n}}},nC=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),ky=new tC,Uo=function(){function n(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=rs.Linear.None,this._interpolationFunction=Oy.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=nC.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof t=="object"?(this._group=t,t.add(this)):t===!0&&(this._group=ky,ky.add(this))}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(e===void 0&&(e=z0()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var o in i){var a=e[o],l=Array.isArray(a),u=l?"array":typeof a,A=!l&&Array.isArray(i[o]);if(!(u==="undefined"||u==="function")){if(A){var p=i[o];if(p.length===0)continue;for(var g=[a],v=0,y=p.length;v<y;v+=1){var b=this._handleRelativeValue(a,p[v]);if(isNaN(b)){A=!1,console.warn("Found invalid interpolation list. Skipping.");break}g.push(b)}A&&(i[o]=g)}if((u==="object"||l)&&a&&!A){t[o]=l?[]:{};var w=a;for(var S in w)t[o][S]=w[S];r[o]=l?[]:{};var p=i[o];if(!this._isDynamic){var C={};for(var S in p)C[S]=p[S];i[o]=p=C}this._setupProperties(w,t[o],p,r[o],s)}else(typeof t[o]>"u"||s)&&(t[o]=a),l||(t[o]*=1),A?r[o]=i[o].slice().reverse():r[o]=t[o]||0}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},n.prototype.pause=function(e){return e===void 0&&(e=z0()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},n.prototype.resume=function(e){return e===void 0&&(e=z0()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},n.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},n.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return e===void 0&&(e=rs.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return e===void 0&&(e=Oy.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var i=this,r;if(e===void 0&&(e=z0()),t===void 0&&(t=n.autoStartOnUpdate),this._isPaused)return!0;var s;if(!this._goToEnd&&!this._isPlaying)if(t)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,a=this._duration+((r=this._repeatDelayTime)!==null&&r!==void 0?r:this._delayTime),l=this._duration+this._repeat*a,u=function(){if(i._duration===0||o>l)return 1;var b=Math.trunc(o/a),w=o-b*a,S=Math.min(w/i._duration,1);return S===0&&o===i._duration?1:S},A=u(),p=this._easingFunction(A);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,p),this._onUpdateCallback&&this._onUpdateCallback(this._object,A),this._duration===0||o>=this._duration)if(this._repeat>0){var g=Math.min(Math.trunc((o-this._duration)/a)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=g);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*g,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var v=0,y=this._chainedTweens.length;v<y;v++)this._chainedTweens[v].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(t[s]!==void 0){var o=t[s]||0,a=i[s],l=Array.isArray(e[s]),u=Array.isArray(a),A=!l&&u;A?e[s]=this._interpolationFunction(a,r):typeof a=="object"&&a?this._updateProperties(e[s],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(e[s]=o+(a-o)*r))}},n.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},n.autoStartOnUpdate=!1,n}();nC.nextId;var dl=ky;dl.getAll.bind(dl);dl.removeAll.bind(dl);dl.add.bind(dl);dl.remove.bind(dl);dl.update.bind(dl);function fY(n){const e=+this._x.call(null,n),t=+this._y.call(null,n),i=+this._z.call(null,n);return iC(this.cover(e,t,i),e,t,i,n)}function iC(n,e,t,i,r){if(isNaN(e)||isNaN(t)||isNaN(i))return n;var s,o=n._root,a={data:r},l=n._x0,u=n._y0,A=n._z0,p=n._x1,g=n._y1,v=n._z1,y,b,w,S,C,E,R,D,B,L,U;if(!o)return n._root=a,n;for(;o.length;)if((R=e>=(y=(l+p)/2))?l=y:p=y,(D=t>=(b=(u+g)/2))?u=b:g=b,(B=i>=(w=(A+v)/2))?A=w:v=w,s=o,!(o=o[L=B<<2|D<<1|R]))return s[L]=a,n;if(S=+n._x.call(null,o.data),C=+n._y.call(null,o.data),E=+n._z.call(null,o.data),e===S&&t===C&&i===E)return a.next=o,s?s[L]=a:n._root=a,n;do s=s?s[L]=new Array(8):n._root=new Array(8),(R=e>=(y=(l+p)/2))?l=y:p=y,(D=t>=(b=(u+g)/2))?u=b:g=b,(B=i>=(w=(A+v)/2))?A=w:v=w;while((L=B<<2|D<<1|R)===(U=(E>=w)<<2|(C>=b)<<1|S>=y));return s[U]=o,s[L]=a,n}function AY(n){Array.isArray(n)||(n=Array.from(n));const e=n.length,t=new Float64Array(e),i=new Float64Array(e),r=new Float64Array(e);let s=1/0,o=1/0,a=1/0,l=-1/0,u=-1/0,A=-1/0;for(let p=0,g,v,y,b;p<e;++p)isNaN(v=+this._x.call(null,g=n[p]))||isNaN(y=+this._y.call(null,g))||isNaN(b=+this._z.call(null,g))||(t[p]=v,i[p]=y,r[p]=b,v<s&&(s=v),v>l&&(l=v),y<o&&(o=y),y>u&&(u=y),b<a&&(a=b),b>A&&(A=b));if(s>l||o>u||a>A)return this;this.cover(s,o,a).cover(l,u,A);for(let p=0;p<e;++p)iC(this,t[p],i[p],r[p],n[p]);return this}function dY(n,e,t){if(isNaN(n=+n)||isNaN(e=+e)||isNaN(t=+t))return this;var i=this._x0,r=this._y0,s=this._z0,o=this._x1,a=this._y1,l=this._z1;if(isNaN(i))o=(i=Math.floor(n))+1,a=(r=Math.floor(e))+1,l=(s=Math.floor(t))+1;else{for(var u=o-i||1,A=this._root,p,g;i>n||n>=o||r>e||e>=a||s>t||t>=l;)switch(g=(t<s)<<2|(e<r)<<1|n<i,p=new Array(8),p[g]=A,A=p,u*=2,g){case 0:o=i+u,a=r+u,l=s+u;break;case 1:i=o-u,a=r+u,l=s+u;break;case 2:o=i+u,r=a-u,l=s+u;break;case 3:i=o-u,r=a-u,l=s+u;break;case 4:o=i+u,a=r+u,s=l-u;break;case 5:i=o-u,a=r+u,s=l-u;break;case 6:o=i+u,r=a-u,s=l-u;break;case 7:i=o-u,r=a-u,s=l-u;break}this._root&&this._root.length&&(this._root=A)}return this._x0=i,this._y0=r,this._z0=s,this._x1=o,this._y1=a,this._z1=l,this}function pY(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function mY(n){return arguments.length?this.cover(+n[0][0],+n[0][1],+n[0][2]).cover(+n[1][0],+n[1][1],+n[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Ci(n,e,t,i,r,s,o){this.node=n,this.x0=e,this.y0=t,this.z0=i,this.x1=r,this.y1=s,this.z1=o}function gY(n,e,t,i){var r,s=this._x0,o=this._y0,a=this._z0,l,u,A,p,g,v,y=this._x1,b=this._y1,w=this._z1,S=[],C=this._root,E,R;for(C&&S.push(new Ci(C,s,o,a,y,b,w)),i==null?i=1/0:(s=n-i,o=e-i,a=t-i,y=n+i,b=e+i,w=t+i,i*=i);E=S.pop();)if(!(!(C=E.node)||(l=E.x0)>y||(u=E.y0)>b||(A=E.z0)>w||(p=E.x1)<s||(g=E.y1)<o||(v=E.z1)<a))if(C.length){var D=(l+p)/2,B=(u+g)/2,L=(A+v)/2;S.push(new Ci(C[7],D,B,L,p,g,v),new Ci(C[6],l,B,L,D,g,v),new Ci(C[5],D,u,L,p,B,v),new Ci(C[4],l,u,L,D,B,v),new Ci(C[3],D,B,A,p,g,L),new Ci(C[2],l,B,A,D,g,L),new Ci(C[1],D,u,A,p,B,L),new Ci(C[0],l,u,A,D,B,L)),(R=(t>=L)<<2|(e>=B)<<1|n>=D)&&(E=S[S.length-1],S[S.length-1]=S[S.length-1-R],S[S.length-1-R]=E)}else{var U=n-+this._x.call(null,C.data),P=e-+this._y.call(null,C.data),F=t-+this._z.call(null,C.data),V=U*U+P*P+F*F;if(V<i){var H=Math.sqrt(i=V);s=n-H,o=e-H,a=t-H,y=n+H,b=e+H,w=t+H,r=C.data}}return r}const _Y=(n,e,t,i,r,s)=>Math.sqrt((n-i)**2+(e-r)**2+(t-s)**2);function vY(n,e,t,i){const r=[],s=n-i,o=e-i,a=t-i,l=n+i,u=e+i,A=t+i;return this.visit((p,g,v,y,b,w,S)=>{if(!p.length)do{const C=p.data;_Y(n,e,t,this._x(C),this._y(C),this._z(C))<=i&&r.push(C)}while(p=p.next);return g>l||v>u||y>A||b<s||w<o||S<a}),r}function yY(n){if(isNaN(g=+this._x.call(null,n))||isNaN(v=+this._y.call(null,n))||isNaN(y=+this._z.call(null,n)))return this;var e,t=this._root,i,r,s,o=this._x0,a=this._y0,l=this._z0,u=this._x1,A=this._y1,p=this._z1,g,v,y,b,w,S,C,E,R,D,B;if(!t)return this;if(t.length)for(;;){if((C=g>=(b=(o+u)/2))?o=b:u=b,(E=v>=(w=(a+A)/2))?a=w:A=w,(R=y>=(S=(l+p)/2))?l=S:p=S,e=t,!(t=t[D=R<<2|E<<1|C]))return this;if(!t.length)break;(e[D+1&7]||e[D+2&7]||e[D+3&7]||e[D+4&7]||e[D+5&7]||e[D+6&7]||e[D+7&7])&&(i=e,B=D)}for(;t.data!==n;)if(r=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,r?(s?r.next=s:delete r.next,this):e?(s?e[D]=s:delete e[D],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(i?i[B]=t:this._root=t),this):(this._root=s,this)}function xY(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function bY(){return this._root}function TY(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function SY(n){var e=[],t,i=this._root,r,s,o,a,l,u,A;for(i&&e.push(new Ci(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!n(i=t.node,s=t.x0,o=t.y0,a=t.z0,l=t.x1,u=t.y1,A=t.z1)&&i.length){var p=(s+l)/2,g=(o+u)/2,v=(a+A)/2;(r=i[7])&&e.push(new Ci(r,p,g,v,l,u,A)),(r=i[6])&&e.push(new Ci(r,s,g,v,p,u,A)),(r=i[5])&&e.push(new Ci(r,p,o,v,l,g,A)),(r=i[4])&&e.push(new Ci(r,s,o,v,p,g,A)),(r=i[3])&&e.push(new Ci(r,p,g,a,l,u,v)),(r=i[2])&&e.push(new Ci(r,s,g,a,p,u,v)),(r=i[1])&&e.push(new Ci(r,p,o,a,l,g,v)),(r=i[0])&&e.push(new Ci(r,s,o,a,p,g,v))}return this}function wY(n){var e=[],t=[],i;for(this._root&&e.push(new Ci(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=e.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,l=i.z0,u=i.x1,A=i.y1,p=i.z1,g=(o+u)/2,v=(a+A)/2,y=(l+p)/2;(s=r[0])&&e.push(new Ci(s,o,a,l,g,v,y)),(s=r[1])&&e.push(new Ci(s,g,a,l,u,v,y)),(s=r[2])&&e.push(new Ci(s,o,v,l,g,A,y)),(s=r[3])&&e.push(new Ci(s,g,v,l,u,A,y)),(s=r[4])&&e.push(new Ci(s,o,a,y,g,v,p)),(s=r[5])&&e.push(new Ci(s,g,a,y,u,v,p)),(s=r[6])&&e.push(new Ci(s,o,v,y,g,A,p)),(s=r[7])&&e.push(new Ci(s,g,v,y,u,A,p))}t.push(i)}for(;i=t.pop();)n(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function MY(n){return n[0]}function EY(n){return arguments.length?(this._x=n,this):this._x}function CY(n){return n[1]}function RY(n){return arguments.length?(this._y=n,this):this._y}function NY(n){return n[2]}function PY(n){return arguments.length?(this._z=n,this):this._z}function rC(n,e,t,i){var r=new tb(e??MY,t??CY,i??NY,NaN,NaN,NaN,NaN,NaN,NaN);return n==null?r:r.addAll(n)}function tb(n,e,t,i,r,s,o,a,l){this._x=n,this._y=e,this._z=t,this._x0=i,this._y0=r,this._z0=s,this._x1=o,this._y1=a,this._z1=l,this._root=void 0}function UT(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var ss=rC.prototype=tb.prototype;ss.copy=function(){var n=new tb(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,i;if(!e)return n;if(!e.length)return n._root=UT(e),n;for(t=[{source:e,target:n._root=new Array(8)}];e=t.pop();)for(var r=0;r<8;++r)(i=e.source[r])&&(i.length?t.push({source:i,target:e.target[r]=new Array(8)}):e.target[r]=UT(i));return n};ss.add=fY;ss.addAll=AY;ss.cover=dY;ss.data=pY;ss.extent=mY;ss.find=gY;ss.findAllWithinRadius=vY;ss.remove=yY;ss.removeAll=xY;ss.root=bY;ss.size=TY;ss.visit=SY;ss.visitAfter=wY;ss.x=EY;ss.y=RY;ss.z=PY;function z1(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function LY(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function sC(n){let e,t,i;n.length!==2?(e=z1,t=(a,l)=>z1(n(a),l),i=(a,l)=>n(a)-l):(e=n===z1||n===LY?n:DY,t=n,i=n);function r(a,l,u=0,A=a.length){if(u<A){if(e(l,l)!==0)return A;do{const p=u+A>>>1;t(a[p],l)<0?u=p+1:A=p}while(u<A)}return u}function s(a,l,u=0,A=a.length){if(u<A){if(e(l,l)!==0)return A;do{const p=u+A>>>1;t(a[p],l)<=0?u=p+1:A=p}while(u<A)}return u}function o(a,l,u=0,A=a.length){const p=r(a,l,u,A-1);return p>u&&i(a[p-1],l)>-i(a[p],l)?p-1:p}return{left:r,center:o,right:s}}function DY(){return 0}function IY(n){return n===null?NaN:+n}const BY=sC(z1),oC=BY.right;sC(IY).center;function Tg(n,e){let t,i;if(e===void 0)for(const r of n)r!=null&&(t===void 0?r>=r&&(t=i=r):(t>r&&(t=r),i<r&&(i=r)));else{let r=-1;for(let s of n)(s=e(s,++r,n))!=null&&(t===void 0?s>=s&&(t=i=s):(t>s&&(t=s),i<s&&(i=s)))}return[t,i]}class Ql{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=t[r],o=e+s,a=Math.abs(e)<Math.abs(s)?e-(o-s):s-(o-e);a&&(t[i++]=a),e=o}return t[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let t=this._n,i,r,s,o=0;if(t>0){for(o=e[--t];t>0&&(i=o,r=e[--t],o=i+r,s=r-(o-i),!s););t>0&&(s<0&&e[t-1]<0||s>0&&e[t-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}const FY=Math.sqrt(50),UY=Math.sqrt(10),OY=Math.sqrt(2);function Sg(n,e,t){const i=(e-n)/Math.max(0,t),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=FY?10:s>=UY?5:s>=OY?2:1;let a,l,u;return r<0?(u=Math.pow(10,-r)/o,a=Math.round(n*u),l=Math.round(e*u),a/u<n&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,r)*o,a=Math.round(n/u),l=Math.round(e/u),a*u<n&&++a,l*u>e&&--l),l<a&&.5<=t&&t<2?Sg(n,e,t*2):[a,l,u]}function kY(n,e,t){if(e=+e,n=+n,t=+t,!(t>0))return[];if(n===e)return[n];const i=e<n,[r,s,o]=i?Sg(e,n,t):Sg(n,e,t);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(i)if(o<0)for(let u=0;u<a;++u)l[u]=(s-u)/-o;else for(let u=0;u<a;++u)l[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)l[u]=(r+u)/-o;else for(let u=0;u<a;++u)l[u]=(r+u)*o;return l}function Vy(n,e,t){return e=+e,n=+n,t=+t,Sg(n,e,t)[2]}function VY(n,e,t){e=+e,n=+n,t=+t;const i=e<n,r=i?Vy(e,n,t):Vy(n,e,t);return(i?-1:1)*(r<0?1/-r:r)}function zY(n,e){let t;for(const i of n)i!=null&&(t<i||t===void 0&&i>=i)&&(t=i);return t}function qY(n,e){let t=0,i=0;if(e===void 0)for(let r of n)r!=null&&(r=+r)>=r&&(++t,i+=r);else{let r=-1;for(let s of n)(s=e(s,++r,n))!=null&&(s=+s)>=s&&(++t,i+=s)}if(t)return i/t}function*GY(n){for(const e of n)yield*e}function Hd(n){return Array.from(GY(n))}function Nf(n,e,t){n=+n,e=+e,t=(r=arguments.length)<2?(e=n,n=0,1):r<3?1:+t;for(var i=-1,r=Math.max(0,Math.ceil((e-n)/t))|0,s=new Array(r);++i<r;)s[i]=n+i*t;return s}function HY(n,e){let t=0;for(let i of n)(i=+i)&&(t+=i);return t}function aC(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}function nb(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function lC(n,e){var t=Object.create(n.prototype);for(var i in e)t[i]=e[i];return t}function wp(){}var Wd=.7,wg=1/Wd,Yf="\\s*([+-]?\\d+)\\s*",$d="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ol="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",WY=/^#([0-9a-f]{3,8})$/,$Y=new RegExp(`^rgb\\(${Yf},${Yf},${Yf}\\)$`),jY=new RegExp(`^rgb\\(${ol},${ol},${ol}\\)$`),XY=new RegExp(`^rgba\\(${Yf},${Yf},${Yf},${$d}\\)$`),QY=new RegExp(`^rgba\\(${ol},${ol},${ol},${$d}\\)$`),YY=new RegExp(`^hsl\\(${$d},${ol},${ol}\\)$`),ZY=new RegExp(`^hsla\\(${$d},${ol},${ol},${$d}\\)$`),OT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};nb(wp,_h,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:kT,formatHex:kT,formatHex8:KY,formatHsl:JY,formatRgb:VT,toString:VT});function kT(){return this.rgb().formatHex()}function KY(){return this.rgb().formatHex8()}function JY(){return uC(this).formatHsl()}function VT(){return this.rgb().formatRgb()}function _h(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=WY.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?zT(e):t===3?new no(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Fm(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Fm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=$Y.exec(n))?new no(e[1],e[2],e[3],1):(e=jY.exec(n))?new no(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=XY.exec(n))?Fm(e[1],e[2],e[3],e[4]):(e=QY.exec(n))?Fm(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=YY.exec(n))?HT(e[1],e[2]/100,e[3]/100,1):(e=ZY.exec(n))?HT(e[1],e[2]/100,e[3]/100,e[4]):OT.hasOwnProperty(n)?zT(OT[n]):n==="transparent"?new no(NaN,NaN,NaN,0):null}function zT(n){return new no(n>>16&255,n>>8&255,n&255,1)}function Fm(n,e,t,i){return i<=0&&(n=e=t=NaN),new no(n,e,t,i)}function eZ(n){return n instanceof wp||(n=_h(n)),n?(n=n.rgb(),new no(n.r,n.g,n.b,n.opacity)):new no}function zy(n,e,t,i){return arguments.length===1?eZ(n):new no(n,e,t,i??1)}function no(n,e,t,i){this.r=+n,this.g=+e,this.b=+t,this.opacity=+i}nb(no,zy,lC(wp,{brighter(n){return n=n==null?wg:Math.pow(wg,n),new no(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?Wd:Math.pow(Wd,n),new no(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new no(nh(this.r),nh(this.g),nh(this.b),Mg(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qT,formatHex:qT,formatHex8:tZ,formatRgb:GT,toString:GT}));function qT(){return`#${jc(this.r)}${jc(this.g)}${jc(this.b)}`}function tZ(){return`#${jc(this.r)}${jc(this.g)}${jc(this.b)}${jc((isNaN(this.opacity)?1:this.opacity)*255)}`}function GT(){const n=Mg(this.opacity);return`${n===1?"rgb(":"rgba("}${nh(this.r)}, ${nh(this.g)}, ${nh(this.b)}${n===1?")":`, ${n})`}`}function Mg(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function nh(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function jc(n){return n=nh(n),(n<16?"0":"")+n.toString(16)}function HT(n,e,t,i){return i<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new ya(n,e,t,i)}function uC(n){if(n instanceof ya)return new ya(n.h,n.s,n.l,n.opacity);if(n instanceof wp||(n=_h(n)),!n)return new ya;if(n instanceof ya)return n;n=n.rgb();var e=n.r/255,t=n.g/255,i=n.b/255,r=Math.min(e,t,i),s=Math.max(e,t,i),o=NaN,a=s-r,l=(s+r)/2;return a?(e===s?o=(t-i)/a+(t<i)*6:t===s?o=(i-e)/a+2:o=(e-t)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new ya(o,a,l,n.opacity)}function nZ(n,e,t,i){return arguments.length===1?uC(n):new ya(n,e,t,i??1)}function ya(n,e,t,i){this.h=+n,this.s=+e,this.l=+t,this.opacity=+i}nb(ya,nZ,lC(wp,{brighter(n){return n=n==null?wg:Math.pow(wg,n),new ya(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Wd:Math.pow(Wd,n),new ya(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*e,r=2*t-i;return new no(H3(n>=240?n-240:n+120,r,i),H3(n,r,i),H3(n<120?n+240:n-120,r,i),this.opacity)},clamp(){return new ya(WT(this.h),Um(this.s),Um(this.l),Mg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Mg(this.opacity);return`${n===1?"hsl(":"hsla("}${WT(this.h)}, ${Um(this.s)*100}%, ${Um(this.l)*100}%${n===1?")":`, ${n})`}`}}));function WT(n){return n=(n||0)%360,n<0?n+360:n}function Um(n){return Math.max(0,Math.min(1,n||0))}function H3(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const ib=n=>()=>n;function iZ(n,e){return function(t){return n+t*e}}function rZ(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(i){return Math.pow(n+i*e,t)}}function sZ(n){return(n=+n)==1?cC:function(e,t){return t-e?rZ(e,t,n):ib(isNaN(e)?t:e)}}function cC(n,e){var t=e-n;return t?iZ(n,t):ib(isNaN(n)?e:n)}const $T=function n(e){var t=sZ(e);function i(r,s){var o=t((r=zy(r)).r,(s=zy(s)).r),a=t(r.g,s.g),l=t(r.b,s.b),u=cC(r.opacity,s.opacity);return function(A){return r.r=o(A),r.g=a(A),r.b=l(A),r.opacity=u(A),r+""}}return i.gamma=n,i}(1);function hC(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,i=e.slice(),r;return function(s){for(r=0;r<t;++r)i[r]=n[r]*(1-s)+e[r]*s;return i}}function fC(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function oZ(n,e){return(fC(e)?hC:AC)(n,e)}function AC(n,e){var t=e?e.length:0,i=n?Math.min(t,n.length):0,r=new Array(i),s=new Array(t),o;for(o=0;o<i;++o)r[o]=rb(n[o],e[o]);for(;o<t;++o)s[o]=e[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function aZ(n,e){var t=new Date;return n=+n,e=+e,function(i){return t.setTime(n*(1-i)+e*i),t}}function jd(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function lZ(n,e){var t={},i={},r;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in n?t[r]=rb(n[r],e[r]):i[r]=e[r];return function(s){for(r in t)i[r]=t[r](s);return i}}var qy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,W3=new RegExp(qy.source,"g");function uZ(n){return function(){return n}}function cZ(n){return function(e){return n(e)+""}}function hZ(n,e){var t=qy.lastIndex=W3.lastIndex=0,i,r,s,o=-1,a=[],l=[];for(n=n+"",e=e+"";(i=qy.exec(n))&&(r=W3.exec(e));)(s=r.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:jd(i,r)})),t=W3.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?cZ(l[0].x):uZ(e):(e=l.length,function(u){for(var A=0,p;A<e;++A)a[(p=l[A]).i]=p.x(u);return a.join("")})}function rb(n,e){var t=typeof e,i;return e==null||t==="boolean"?ib(e):(t==="number"?jd:t==="string"?(i=_h(e))?(e=i,$T):hZ:e instanceof _h?$T:e instanceof Date?aZ:fC(e)?hC:Array.isArray(e)?AC:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?lZ:jd)(n,e)}function fZ(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}function AZ(n){return function(){return n}}function dZ(n){return+n}var jT=[0,1];function Pf(n){return n}function Gy(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:AZ(isNaN(e)?NaN:.5)}function pZ(n,e){var t;return n>e&&(t=n,n=e,e=t),function(i){return Math.max(n,Math.min(e,i))}}function mZ(n,e,t){var i=n[0],r=n[1],s=e[0],o=e[1];return r<i?(i=Gy(r,i),s=t(o,s)):(i=Gy(i,r),s=t(s,o)),function(a){return s(i(a))}}function gZ(n,e,t){var i=Math.min(n.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=Gy(n[o],n[o+1]),s[o]=t(e[o],e[o+1]);return function(a){var l=oC(n,a,1,i)-1;return s[l](r[l](a))}}function _Z(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function vZ(){var n=jT,e=jT,t=rb,i,r,s,o=Pf,a,l,u;function A(){var g=Math.min(n.length,e.length);return o!==Pf&&(o=pZ(n[0],n[g-1])),a=g>2?gZ:mZ,l=u=null,p}function p(g){return g==null||isNaN(g=+g)?s:(l||(l=a(n.map(i),e,t)))(i(o(g)))}return p.invert=function(g){return o(r((u||(u=a(e,n.map(i),jd)))(g)))},p.domain=function(g){return arguments.length?(n=Array.from(g,dZ),A()):n.slice()},p.range=function(g){return arguments.length?(e=Array.from(g),A()):e.slice()},p.rangeRound=function(g){return e=Array.from(g),t=fZ,A()},p.clamp=function(g){return arguments.length?(o=g?!0:Pf,A()):o!==Pf},p.interpolate=function(g){return arguments.length?(t=g,A()):t},p.unknown=function(g){return arguments.length?(s=g,p):s},function(g,v){return i=g,r=v,A()}}function yZ(){return vZ()(Pf,Pf)}function xZ(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Eg(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,i=n.slice(0,t);return[i.length>1?i[0]+i.slice(2):i,+n.slice(t+1)]}function SA(n){return n=Eg(Math.abs(n)),n?n[1]:NaN}function bZ(n,e){return function(t,i){for(var r=t.length,s=[],o=0,a=n[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=n[o=(o+1)%n.length];return s.reverse().join(e)}}function TZ(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var SZ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Cg(n){if(!(e=SZ.exec(n)))throw new Error("invalid format: "+n);var e;return new sb({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Cg.prototype=sb.prototype;function sb(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}sb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function wZ(n){e:for(var e=n.length,t=1,i=-1,r;t<e;++t)switch(n[t]){case".":i=r=t;break;case"0":i===0&&(i=t),r=t;break;default:if(!+n[t])break e;i>0&&(i=0);break}return i>0?n.slice(0,i)+n.slice(r+1):n}var dC;function MZ(n,e){var t=Eg(n,e);if(!t)return n+"";var i=t[0],r=t[1],s=r-(dC=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Eg(n,Math.max(0,e+s-1))[0]}function XT(n,e){var t=Eg(n,e);if(!t)return n+"";var i=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const QT={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:xZ,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>XT(n*100,e),r:XT,s:MZ,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function YT(n){return n}var ZT=Array.prototype.map,KT=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function EZ(n){var e=n.grouping===void 0||n.thousands===void 0?YT:bZ(ZT.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",i=n.currency===void 0?"":n.currency[1]+"",r=n.decimal===void 0?".":n.decimal+"",s=n.numerals===void 0?YT:TZ(ZT.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function u(p){p=Cg(p);var g=p.fill,v=p.align,y=p.sign,b=p.symbol,w=p.zero,S=p.width,C=p.comma,E=p.precision,R=p.trim,D=p.type;D==="n"?(C=!0,D="g"):QT[D]||(E===void 0&&(E=12),R=!0,D="g"),(w||g==="0"&&v==="=")&&(w=!0,g="0",v="=");var B=b==="$"?t:b==="#"&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",L=b==="$"?i:/[%p]/.test(D)?o:"",U=QT[D],P=/[defgprs%]/.test(D);E=E===void 0?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function F(V){var H=B,j=L,J,Z,W;if(D==="c")j=U(V)+j,V="";else{V=+V;var K=V<0||1/V<0;if(V=isNaN(V)?l:U(Math.abs(V),E),R&&(V=wZ(V)),K&&+V==0&&y!=="+"&&(K=!1),H=(K?y==="("?y:a:y==="-"||y==="("?"":y)+H,j=(D==="s"?KT[8+dC/3]:"")+j+(K&&y==="("?")":""),P){for(J=-1,Z=V.length;++J<Z;)if(W=V.charCodeAt(J),48>W||W>57){j=(W===46?r+V.slice(J+1):V.slice(J))+j,V=V.slice(0,J);break}}}C&&!w&&(V=e(V,1/0));var ee=H.length+V.length+j.length,se=ee<S?new Array(S-ee+1).join(g):"";switch(C&&w&&(V=e(se+V,se.length?S-j.length:1/0),se=""),v){case"<":V=H+V+j+se;break;case"=":V=H+se+V+j;break;case"^":V=se.slice(0,ee=se.length>>1)+H+V+j+se.slice(ee);break;default:V=se+H+V+j;break}return s(V)}return F.toString=function(){return p+""},F}function A(p,g){var v=u((p=Cg(p),p.type="f",p)),y=Math.max(-8,Math.min(8,Math.floor(SA(g)/3)))*3,b=Math.pow(10,-y),w=KT[8+y/3];return function(S){return v(b*S)+w}}return{format:u,formatPrefix:A}}var Om,pC,mC;CZ({thousands:",",grouping:[3],currency:["$",""]});function CZ(n){return Om=EZ(n),pC=Om.format,mC=Om.formatPrefix,Om}function RZ(n){return Math.max(0,-SA(Math.abs(n)))}function NZ(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(SA(e)/3)))*3-SA(Math.abs(n)))}function PZ(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,SA(e)-SA(n))+1}function LZ(n,e,t,i){var r=VY(n,e,t),s;switch(i=Cg(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(e));return i.precision==null&&!isNaN(s=NZ(r,o))&&(i.precision=s),mC(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=PZ(r,Math.max(Math.abs(n),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=RZ(r))&&(i.precision=s-(i.type==="%")*2);break}}return pC(i)}function gC(n){var e=n.domain;return n.ticks=function(t){var i=e();return kY(i[0],i[i.length-1],t??10)},n.tickFormat=function(t,i){var r=e();return LZ(r[0],r[r.length-1],t??10,i)},n.nice=function(t){t==null&&(t=10);var i=e(),r=0,s=i.length-1,o=i[r],a=i[s],l,u,A=10;for(a<o&&(u=o,o=a,a=u,u=r,r=s,s=u);A-- >0;){if(u=Vy(o,a,t),u===l)return i[r]=o,i[s]=a,e(i);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;l=u}return n},n}function tu(){var n=yZ();return n.copy=function(){return _Z(n,tu())},aC.apply(n,arguments),gC(n)}function _C(){var n=0,e=1,t=1,i=[.5],r=[0,1],s;function o(l){return l!=null&&l<=l?r[oC(i,l,0,t)]:s}function a(){var l=-1;for(i=new Array(t);++l<t;)i[l]=((l+1)*e-(l-t)*n)/(t+1);return o}return o.domain=function(l){return arguments.length?([n,e]=l,n=+n,e=+e,a()):[n,e]},o.range=function(l){return arguments.length?(t=(r=Array.from(l)).length-1,a()):r.slice()},o.invertExtent=function(l){var u=r.indexOf(l);return u<0?[NaN,NaN]:u<1?[n,i[0]]:u>=t?[i[t-1],e]:[i[u-1],i[u]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return i.slice()},o.copy=function(){return _C().domain([n,e]).range(r).unknown(s)},aC.apply(gC(o),arguments)}var Qn=1e-6,Hy=1e-12,ti=Math.PI,io=ti/2,Rg=ti/4,Oo=ti*2,rr=180/ti,Tn=ti/180,Si=Math.abs,ob=Math.atan,oa=Math.atan2,Ln=Math.cos,km=Math.ceil,DZ=Math.exp,Wy=Math.hypot,IZ=Math.log,pn=Math.sin,BZ=Math.sign||function(n){return n>0?1:n<0?-1:0},nu=Math.sqrt,FZ=Math.tan;function UZ(n){return n>1?0:n<-1?ti:Math.acos(n)}function iu(n){return n>1?io:n<-1?-io:Math.asin(n)}function JT(n){return(n=pn(n/2))*n}function _s(){}function Ng(n,e){n&&tS.hasOwnProperty(n.type)&&tS[n.type](n,e)}var eS={Feature:function(n,e){Ng(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,i=-1,r=t.length;++i<r;)Ng(t[i].geometry,e)}},tS={Sphere:function(n,e){e.sphere()},Point:function(n,e){n=n.coordinates,e.point(n[0],n[1],n[2])},MultiPoint:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)n=t[i],e.point(n[0],n[1],n[2])},LineString:function(n,e){$y(n.coordinates,e,0)},MultiLineString:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)$y(t[i],e,0)},Polygon:function(n,e){nS(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)nS(t[i],e)},GeometryCollection:function(n,e){for(var t=n.geometries,i=-1,r=t.length;++i<r;)Ng(t[i],e)}};function $y(n,e,t){var i=-1,r=n.length-t,s;for(e.lineStart();++i<r;)s=n[i],e.point(s[0],s[1],s[2]);e.lineEnd()}function nS(n,e){var t=-1,i=n.length;for(e.polygonStart();++t<i;)$y(n[t],e,1);e.polygonEnd()}function q2(n,e){n&&eS.hasOwnProperty(n.type)?eS[n.type](n,e):Ng(n,e)}var Pg=new Ql,iS=new Ql,vC,yC,jy,Xy,Qy,ru={point:_s,lineStart:_s,lineEnd:_s,polygonStart:function(){Pg=new Ql,ru.lineStart=OZ,ru.lineEnd=kZ},polygonEnd:function(){var n=+Pg;iS.add(n<0?Oo+n:n),this.lineStart=this.lineEnd=this.point=_s},sphere:function(){iS.add(Oo)}};function OZ(){ru.point=VZ}function kZ(){xC(vC,yC)}function VZ(n,e){ru.point=xC,vC=n,yC=e,n*=Tn,e*=Tn,jy=n,Xy=Ln(e=e/2+Rg),Qy=pn(e)}function xC(n,e){n*=Tn,e*=Tn,e=e/2+Rg;var t=n-jy,i=t>=0?1:-1,r=i*t,s=Ln(e),o=pn(e),a=Qy*o,l=Xy*s+a*Ln(r),u=a*i*pn(r);Pg.add(oa(u,l)),jy=n,Xy=s,Qy=o}function Lg(n){return[oa(n[1],n[0]),iu(n[2])]}function vh(n){var e=n[0],t=n[1],i=Ln(t);return[i*Ln(e),i*pn(e),pn(t)]}function Vm(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function wA(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function $3(n,e){n[0]+=e[0],n[1]+=e[1],n[2]+=e[2]}function zm(n,e){return[n[0]*e,n[1]*e,n[2]*e]}function Dg(n){var e=nu(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=e,n[1]/=e,n[2]/=e}var Yi,Js,nr,Ro,kc,bC,TC,Zf,sd,Uu,su,Ol={point:Yy,lineStart:rS,lineEnd:sS,polygonStart:function(){Ol.point=wC,Ol.lineStart=zZ,Ol.lineEnd=qZ,sd=new Ql,ru.polygonStart()},polygonEnd:function(){ru.polygonEnd(),Ol.point=Yy,Ol.lineStart=rS,Ol.lineEnd=sS,Pg<0?(Yi=-(nr=180),Js=-(Ro=90)):sd>Qn?Ro=90:sd<-1e-6&&(Js=-90),su[0]=Yi,su[1]=nr},sphere:function(){Yi=-(nr=180),Js=-(Ro=90)}};function Yy(n,e){Uu.push(su=[Yi=n,nr=n]),e<Js&&(Js=e),e>Ro&&(Ro=e)}function SC(n,e){var t=vh([n*Tn,e*Tn]);if(Zf){var i=wA(Zf,t),r=[i[1],-i[0],0],s=wA(r,i);Dg(s),s=Lg(s);var o=n-kc,a=o>0?1:-1,l=s[0]*rr*a,u,A=Si(o)>180;A^(a*kc<l&&l<a*n)?(u=s[1]*rr,u>Ro&&(Ro=u)):(l=(l+360)%360-180,A^(a*kc<l&&l<a*n)?(u=-s[1]*rr,u<Js&&(Js=u)):(e<Js&&(Js=e),e>Ro&&(Ro=e))),A?n<kc?Mo(Yi,n)>Mo(Yi,nr)&&(nr=n):Mo(n,nr)>Mo(Yi,nr)&&(Yi=n):nr>=Yi?(n<Yi&&(Yi=n),n>nr&&(nr=n)):n>kc?Mo(Yi,n)>Mo(Yi,nr)&&(nr=n):Mo(n,nr)>Mo(Yi,nr)&&(Yi=n)}else Uu.push(su=[Yi=n,nr=n]);e<Js&&(Js=e),e>Ro&&(Ro=e),Zf=t,kc=n}function rS(){Ol.point=SC}function sS(){su[0]=Yi,su[1]=nr,Ol.point=Yy,Zf=null}function wC(n,e){if(Zf){var t=n-kc;sd.add(Si(t)>180?t+(t>0?360:-360):t)}else bC=n,TC=e;ru.point(n,e),SC(n,e)}function zZ(){ru.lineStart()}function qZ(){wC(bC,TC),ru.lineEnd(),Si(sd)>Qn&&(Yi=-(nr=180)),su[0]=Yi,su[1]=nr,Zf=null}function Mo(n,e){return(e-=n)<0?e+360:e}function GZ(n,e){return n[0]-e[0]}function oS(n,e){return n[0]<=n[1]?n[0]<=e&&e<=n[1]:e<n[0]||n[1]<e}function MC(n){var e,t,i,r,s,o,a;if(Ro=nr=-(Yi=Js=1/0),Uu=[],q2(n,Ol),t=Uu.length){for(Uu.sort(GZ),e=1,i=Uu[0],s=[i];e<t;++e)r=Uu[e],oS(i,r[0])||oS(i,r[1])?(Mo(i[0],r[1])>Mo(i[0],i[1])&&(i[1]=r[1]),Mo(r[0],i[1])>Mo(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,t=s.length-1,e=0,i=s[t];e<=t;i=r,++e)r=s[e],(a=Mo(i[1],r[0]))>o&&(o=a,Yi=r[0],nr=i[1])}return Uu=su=null,Yi===1/0||Js===1/0?[[NaN,NaN],[NaN,NaN]]:[[Yi,Js],[nr,Ro]]}var q0,Ig,Bg,Fg,Ug,Og,kg,Vg,Zy,Ky,Jy,EC,CC,Bs,Fs,Us,ba={sphere:_s,point:ab,lineStart:aS,lineEnd:lS,polygonStart:function(){ba.lineStart=$Z,ba.lineEnd=jZ},polygonEnd:function(){ba.lineStart=aS,ba.lineEnd=lS}};function ab(n,e){n*=Tn,e*=Tn;var t=Ln(e);Mp(t*Ln(n),t*pn(n),pn(e))}function Mp(n,e,t){++q0,Bg+=(n-Bg)/q0,Fg+=(e-Fg)/q0,Ug+=(t-Ug)/q0}function aS(){ba.point=HZ}function HZ(n,e){n*=Tn,e*=Tn;var t=Ln(e);Bs=t*Ln(n),Fs=t*pn(n),Us=pn(e),ba.point=WZ,Mp(Bs,Fs,Us)}function WZ(n,e){n*=Tn,e*=Tn;var t=Ln(e),i=t*Ln(n),r=t*pn(n),s=pn(e),o=oa(nu((o=Fs*s-Us*r)*o+(o=Us*i-Bs*s)*o+(o=Bs*r-Fs*i)*o),Bs*i+Fs*r+Us*s);Ig+=o,Og+=o*(Bs+(Bs=i)),kg+=o*(Fs+(Fs=r)),Vg+=o*(Us+(Us=s)),Mp(Bs,Fs,Us)}function lS(){ba.point=ab}function $Z(){ba.point=XZ}function jZ(){RC(EC,CC),ba.point=ab}function XZ(n,e){EC=n,CC=e,n*=Tn,e*=Tn,ba.point=RC;var t=Ln(e);Bs=t*Ln(n),Fs=t*pn(n),Us=pn(e),Mp(Bs,Fs,Us)}function RC(n,e){n*=Tn,e*=Tn;var t=Ln(e),i=t*Ln(n),r=t*pn(n),s=pn(e),o=Fs*s-Us*r,a=Us*i-Bs*s,l=Bs*r-Fs*i,u=Wy(o,a,l),A=iu(u),p=u&&-A/u;Zy.add(p*o),Ky.add(p*a),Jy.add(p*l),Ig+=A,Og+=A*(Bs+(Bs=i)),kg+=A*(Fs+(Fs=r)),Vg+=A*(Us+(Us=s)),Mp(Bs,Fs,Us)}function uS(n){q0=Ig=Bg=Fg=Ug=Og=kg=Vg=0,Zy=new Ql,Ky=new Ql,Jy=new Ql,q2(n,ba);var e=+Zy,t=+Ky,i=+Jy,r=Wy(e,t,i);return r<Hy&&(e=Og,t=kg,i=Vg,Ig<Qn&&(e=Bg,t=Fg,i=Ug),r=Wy(e,t,i),r<Hy)?[NaN,NaN]:[oa(t,e)*rr,iu(i/r)*rr]}function ex(n,e){function t(i,r){return i=n(i,r),e(i[0],i[1])}return n.invert&&e.invert&&(t.invert=function(i,r){return i=e.invert(i,r),i&&n.invert(i[0],i[1])}),t}function tx(n,e){return Si(n)>ti&&(n-=Math.round(n/Oo)*Oo),[n,e]}tx.invert=tx;function NC(n,e,t){return(n%=Oo)?e||t?ex(hS(n),fS(e,t)):hS(n):e||t?fS(e,t):tx}function cS(n){return function(e,t){return e+=n,Si(e)>ti&&(e-=Math.round(e/Oo)*Oo),[e,t]}}function hS(n){var e=cS(n);return e.invert=cS(-n),e}function fS(n,e){var t=Ln(n),i=pn(n),r=Ln(e),s=pn(e);function o(a,l){var u=Ln(l),A=Ln(a)*u,p=pn(a)*u,g=pn(l),v=g*t+A*i;return[oa(p*r-v*s,A*t-g*i),iu(v*r+p*s)]}return o.invert=function(a,l){var u=Ln(l),A=Ln(a)*u,p=pn(a)*u,g=pn(l),v=g*r-p*s;return[oa(p*r+g*s,A*t+v*i),iu(v*t-A*i)]},o}function QZ(n){n=NC(n[0]*Tn,n[1]*Tn,n.length>2?n[2]*Tn:0);function e(t){return t=n(t[0]*Tn,t[1]*Tn),t[0]*=rr,t[1]*=rr,t}return e.invert=function(t){return t=n.invert(t[0]*Tn,t[1]*Tn),t[0]*=rr,t[1]*=rr,t},e}function YZ(n,e,t,i,r,s){if(t){var o=Ln(e),a=pn(e),l=i*t;r==null?(r=e+i*Oo,s=e-l/2):(r=AS(o,r),s=AS(o,s),(i>0?r<s:r>s)&&(r+=i*Oo));for(var u,A=r;i>0?A>s:A<s;A-=l)u=Lg([o,-a*Ln(A),-a*pn(A)]),n.point(u[0],u[1])}}function AS(n,e){e=vh(e),e[0]-=n,Dg(e);var t=UZ(-e[1]);return((-e[2]<0?-t:t)+Oo-Qn)%Oo}function PC(){var n=[],e;return{point:function(t,i,r){e.push([t,i,r])},lineStart:function(){n.push(e=[])},lineEnd:_s,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var t=n;return n=[],e=null,t}}}function q1(n,e){return Si(n[0]-e[0])<Qn&&Si(n[1]-e[1])<Qn}function qm(n,e,t,i){this.x=n,this.z=e,this.o=t,this.e=i,this.v=!1,this.n=this.p=null}function LC(n,e,t,i,r){var s=[],o=[],a,l;if(n.forEach(function(y){if(!((b=y.length-1)<=0)){var b,w=y[0],S=y[b],C;if(q1(w,S)){if(!w[2]&&!S[2]){for(r.lineStart(),a=0;a<b;++a)r.point((w=y[a])[0],w[1]);r.lineEnd();return}S[0]+=2*Qn}s.push(C=new qm(w,y,null,!0)),o.push(C.o=new qm(w,null,C,!1)),s.push(C=new qm(S,y,null,!1)),o.push(C.o=new qm(S,null,C,!0))}}),!!s.length){for(o.sort(e),dS(s),dS(o),a=0,l=o.length;a<l;++a)o[a].e=t=!t;for(var u=s[0],A,p;;){for(var g=u,v=!0;g.v;)if((g=g.n)===u)return;A=g.z,r.lineStart();do{if(g.v=g.o.v=!0,g.e){if(v)for(a=0,l=A.length;a<l;++a)r.point((p=A[a])[0],p[1]);else i(g.x,g.n.x,1,r);g=g.n}else{if(v)for(A=g.p.z,a=A.length-1;a>=0;--a)r.point((p=A[a])[0],p[1]);else i(g.x,g.p.x,-1,r);g=g.p}g=g.o,A=g.z,v=!v}while(!g.v);r.lineEnd()}}}function dS(n){if(e=n.length){for(var e,t=0,i=n[0],r;++t<e;)i.n=r=n[t],r.p=i,i=r;i.n=r=n[0],r.p=i}}function j3(n){return Si(n[0])<=ti?n[0]:BZ(n[0])*((Si(n[0])+ti)%Oo-ti)}function DC(n,e){var t=j3(e),i=e[1],r=pn(i),s=[pn(t),-Ln(t),0],o=0,a=0,l=new Ql;r===1?i=io+Qn:r===-1&&(i=-io-Qn);for(var u=0,A=n.length;u<A;++u)if(g=(p=n[u]).length)for(var p,g,v=p[g-1],y=j3(v),b=v[1]/2+Rg,w=pn(b),S=Ln(b),C=0;C<g;++C,y=R,w=B,S=L,v=E){var E=p[C],R=j3(E),D=E[1]/2+Rg,B=pn(D),L=Ln(D),U=R-y,P=U>=0?1:-1,F=P*U,V=F>ti,H=w*B;if(l.add(oa(H*P*pn(F),S*L+H*Ln(F))),o+=V?U+P*Oo:U,V^y>=t^R>=t){var j=wA(vh(v),vh(E));Dg(j);var J=wA(s,j);Dg(J);var Z=(V^U>=0?-1:1)*iu(J[2]);(i>Z||i===Z&&(j[0]||j[1]))&&(a+=V^U>=0?1:-1)}}return(o<-1e-6||o<Qn&&l<-1e-12)^a&1}function IC(n,e,t,i){return function(r){var s=e(r),o=PC(),a=e(o),l=!1,u,A,p,g={point:v,lineStart:b,lineEnd:w,polygonStart:function(){g.point=S,g.lineStart=C,g.lineEnd=E,A=[],u=[]},polygonEnd:function(){g.point=v,g.lineStart=b,g.lineEnd=w,A=Hd(A);var R=DC(u,i);A.length?(l||(r.polygonStart(),l=!0),LC(A,KZ,R,t,r)):R&&(l||(r.polygonStart(),l=!0),r.lineStart(),t(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),A=u=null},sphere:function(){r.polygonStart(),r.lineStart(),t(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function v(R,D){n(R,D)&&r.point(R,D)}function y(R,D){s.point(R,D)}function b(){g.point=y,s.lineStart()}function w(){g.point=v,s.lineEnd()}function S(R,D){p.push([R,D]),a.point(R,D)}function C(){a.lineStart(),p=[]}function E(){S(p[0][0],p[0][1]),a.lineEnd();var R=a.clean(),D=o.result(),B,L=D.length,U,P,F;if(p.pop(),u.push(p),p=null,!!L){if(R&1){if(P=D[0],(U=P.length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),B=0;B<U;++B)r.point((F=P[B])[0],F[1]);r.lineEnd()}return}L>1&&R&2&&D.push(D.pop().concat(D.shift())),A.push(D.filter(ZZ))}}return g}}function ZZ(n){return n.length>1}function KZ(n,e){return((n=n.x)[0]<0?n[1]-io-Qn:io-n[1])-((e=e.x)[0]<0?e[1]-io-Qn:io-e[1])}const pS=IC(function(){return!0},JZ,tK,[-ti,-io]);function JZ(n){var e=NaN,t=NaN,i=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(s,o){var a=s>0?ti:-ti,l=Si(s-e);Si(l-ti)<Qn?(n.point(e,t=(t+o)/2>0?io:-io),n.point(i,t),n.lineEnd(),n.lineStart(),n.point(a,t),n.point(s,t),r=0):i!==a&&l>=ti&&(Si(e-i)<Qn&&(e-=i*Qn),Si(s-a)<Qn&&(s-=a*Qn),t=eK(e,t,s,o),n.point(i,t),n.lineEnd(),n.lineStart(),n.point(a,t),r=0),n.point(e=s,t=o),i=a},lineEnd:function(){n.lineEnd(),e=t=NaN},clean:function(){return 2-r}}}function eK(n,e,t,i){var r,s,o=pn(n-t);return Si(o)>Qn?ob((pn(e)*(s=Ln(i))*pn(t)-pn(i)*(r=Ln(e))*pn(n))/(r*s*o)):(e+i)/2}function tK(n,e,t,i){var r;if(n==null)r=t*io,i.point(-ti,r),i.point(0,r),i.point(ti,r),i.point(ti,0),i.point(ti,-r),i.point(0,-r),i.point(-ti,-r),i.point(-ti,0),i.point(-ti,r);else if(Si(n[0]-e[0])>Qn){var s=n[0]<e[0]?ti:-ti;r=t*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(e[0],e[1])}function nK(n){var e=Ln(n),t=2*Tn,i=e>0,r=Si(e)>Qn;function s(A,p,g,v){YZ(v,n,t,g,A,p)}function o(A,p){return Ln(A)*Ln(p)>e}function a(A){var p,g,v,y,b;return{lineStart:function(){y=v=!1,b=1},point:function(w,S){var C=[w,S],E,R=o(w,S),D=i?R?0:u(w,S):R?u(w+(w<0?ti:-ti),S):0;if(!p&&(y=v=R)&&A.lineStart(),R!==v&&(E=l(p,C),(!E||q1(p,E)||q1(C,E))&&(C[2]=1)),R!==v)b=0,R?(A.lineStart(),E=l(C,p),A.point(E[0],E[1])):(E=l(p,C),A.point(E[0],E[1],2),A.lineEnd()),p=E;else if(r&&p&&i^R){var B;!(D&g)&&(B=l(C,p,!0))&&(b=0,i?(A.lineStart(),A.point(B[0][0],B[0][1]),A.point(B[1][0],B[1][1]),A.lineEnd()):(A.point(B[1][0],B[1][1]),A.lineEnd(),A.lineStart(),A.point(B[0][0],B[0][1],3)))}R&&(!p||!q1(p,C))&&A.point(C[0],C[1]),p=C,v=R,g=D},lineEnd:function(){v&&A.lineEnd(),p=null},clean:function(){return b|(y&&v)<<1}}}function l(A,p,g){var v=vh(A),y=vh(p),b=[1,0,0],w=wA(v,y),S=Vm(w,w),C=w[0],E=S-C*C;if(!E)return!g&&A;var R=e*S/E,D=-e*C/E,B=wA(b,w),L=zm(b,R),U=zm(w,D);$3(L,U);var P=B,F=Vm(L,P),V=Vm(P,P),H=F*F-V*(Vm(L,L)-1);if(!(H<0)){var j=nu(H),J=zm(P,(-F-j)/V);if($3(J,L),J=Lg(J),!g)return J;var Z=A[0],W=p[0],K=A[1],ee=p[1],se;W<Z&&(se=Z,Z=W,W=se);var ge=W-Z,de=Si(ge-ti)<Qn,Ae=de||ge<Qn;if(!de&&ee<K&&(se=K,K=ee,ee=se),Ae?de?K+ee>0^J[1]<(Si(J[0]-Z)<Qn?K:ee):K<=J[1]&&J[1]<=ee:ge>ti^(Z<=J[0]&&J[0]<=W)){var Be=zm(P,(-F+j)/V);return $3(Be,L),[J,Lg(Be)]}}}function u(A,p){var g=i?n:ti-n,v=0;return A<-g?v|=1:A>g&&(v|=2),p<-g?v|=4:p>g&&(v|=8),v}return IC(o,a,s,i?[0,-n]:[-ti,n-ti])}function iK(n,e,t,i,r,s){var o=n[0],a=n[1],l=e[0],u=e[1],A=0,p=1,g=l-o,v=u-a,y;if(y=t-o,!(!g&&y>0)){if(y/=g,g<0){if(y<A)return;y<p&&(p=y)}else if(g>0){if(y>p)return;y>A&&(A=y)}if(y=r-o,!(!g&&y<0)){if(y/=g,g<0){if(y>p)return;y>A&&(A=y)}else if(g>0){if(y<A)return;y<p&&(p=y)}if(y=i-a,!(!v&&y>0)){if(y/=v,v<0){if(y<A)return;y<p&&(p=y)}else if(v>0){if(y>p)return;y>A&&(A=y)}if(y=s-a,!(!v&&y<0)){if(y/=v,v<0){if(y>p)return;y>A&&(A=y)}else if(v>0){if(y<A)return;y<p&&(p=y)}return A>0&&(n[0]=o+A*g,n[1]=a+A*v),p<1&&(e[0]=o+p*g,e[1]=a+p*v),!0}}}}}var Gm=1e9,Hm=-1e9;function rK(n,e,t,i){function r(u,A){return n<=u&&u<=t&&e<=A&&A<=i}function s(u,A,p,g){var v=0,y=0;if(u==null||(v=o(u,p))!==(y=o(A,p))||l(u,A)<0^p>0)do g.point(v===0||v===3?n:t,v>1?i:e);while((v=(v+p+4)%4)!==y);else g.point(A[0],A[1])}function o(u,A){return Si(u[0]-n)<Qn?A>0?0:3:Si(u[0]-t)<Qn?A>0?2:1:Si(u[1]-e)<Qn?A>0?1:0:A>0?3:2}function a(u,A){return l(u.x,A.x)}function l(u,A){var p=o(u,1),g=o(A,1);return p!==g?p-g:p===0?A[1]-u[1]:p===1?u[0]-A[0]:p===2?u[1]-A[1]:A[0]-u[0]}return function(u){var A=u,p=PC(),g,v,y,b,w,S,C,E,R,D,B,L={point:U,lineStart:H,lineEnd:j,polygonStart:F,polygonEnd:V};function U(Z,W){r(Z,W)&&A.point(Z,W)}function P(){for(var Z=0,W=0,K=v.length;W<K;++W)for(var ee=v[W],se=1,ge=ee.length,de=ee[0],Ae,Be,ye=de[0],De=de[1];se<ge;++se)Ae=ye,Be=De,de=ee[se],ye=de[0],De=de[1],Be<=i?De>i&&(ye-Ae)*(i-Be)>(De-Be)*(n-Ae)&&++Z:De<=i&&(ye-Ae)*(i-Be)<(De-Be)*(n-Ae)&&--Z;return Z}function F(){A=p,g=[],v=[],B=!0}function V(){var Z=P(),W=B&&Z,K=(g=Hd(g)).length;(W||K)&&(u.polygonStart(),W&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),K&&LC(g,a,Z,s,u),u.polygonEnd()),A=u,g=v=y=null}function H(){L.point=J,v&&v.push(y=[]),D=!0,R=!1,C=E=NaN}function j(){g&&(J(b,w),S&&R&&p.rejoin(),g.push(p.result())),L.point=U,R&&A.lineEnd()}function J(Z,W){var K=r(Z,W);if(v&&y.push([Z,W]),D)b=Z,w=W,S=K,D=!1,K&&(A.lineStart(),A.point(Z,W));else if(K&&R)A.point(Z,W);else{var ee=[C=Math.max(Hm,Math.min(Gm,C)),E=Math.max(Hm,Math.min(Gm,E))],se=[Z=Math.max(Hm,Math.min(Gm,Z)),W=Math.max(Hm,Math.min(Gm,W))];iK(ee,se,n,e,t,i)?(R||(A.lineStart(),A.point(ee[0],ee[1])),A.point(se[0],se[1]),K||A.lineEnd(),B=!1):K&&(A.lineStart(),A.point(Z,W),B=!1)}C=Z,E=W,R=K}return L}}var nx,ix,G1,H1,MA={sphere:_s,point:_s,lineStart:sK,lineEnd:_s,polygonStart:_s,polygonEnd:_s};function sK(){MA.point=aK,MA.lineEnd=oK}function oK(){MA.point=MA.lineEnd=_s}function aK(n,e){n*=Tn,e*=Tn,ix=n,G1=pn(e),H1=Ln(e),MA.point=lK}function lK(n,e){n*=Tn,e*=Tn;var t=pn(e),i=Ln(e),r=Si(n-ix),s=Ln(r),o=pn(r),a=i*o,l=H1*t-G1*i*s,u=G1*t+H1*i*s;nx.add(oa(nu(a*a+l*l),u)),ix=n,G1=t,H1=i}function uK(n){return nx=new Ql,q2(n,MA),+nx}var rx=[null,null],cK={type:"LineString",coordinates:rx};function ec(n,e){return rx[0]=n,rx[1]=e,uK(cK)}var mS={Feature:function(n,e){return zg(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,i=-1,r=t.length;++i<r;)if(zg(t[i].geometry,e))return!0;return!1}},gS={Sphere:function(){return!0},Point:function(n,e){return _S(n.coordinates,e)},MultiPoint:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)if(_S(t[i],e))return!0;return!1},LineString:function(n,e){return vS(n.coordinates,e)},MultiLineString:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)if(vS(t[i],e))return!0;return!1},Polygon:function(n,e){return yS(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)if(yS(t[i],e))return!0;return!1},GeometryCollection:function(n,e){for(var t=n.geometries,i=-1,r=t.length;++i<r;)if(zg(t[i],e))return!0;return!1}};function zg(n,e){return n&&gS.hasOwnProperty(n.type)?gS[n.type](n,e):!1}function _S(n,e){return ec(n,e)===0}function vS(n,e){for(var t,i,r,s=0,o=n.length;s<o;s++){if(i=ec(n[s],e),i===0||s>0&&(r=ec(n[s],n[s-1]),r>0&&t<=r&&i<=r&&(t+i-r)*(1-Math.pow((t-i)/r,2))<Hy*r))return!0;t=i}return!1}function yS(n,e){return!!DC(n.map(hK),BC(e))}function hK(n){return n=n.map(BC),n.pop(),n}function BC(n){return[n[0]*Tn,n[1]*Tn]}function fK(n,e){return(n&&mS.hasOwnProperty(n.type)?mS[n.type]:zg)(n,e)}function xS(n,e,t){var i=Nf(n,e-Qn,t).concat(e);return function(r){return i.map(function(s){return[r,s]})}}function bS(n,e,t){var i=Nf(n,e-Qn,t).concat(e);return function(r){return i.map(function(s){return[s,r]})}}function AK(){var n,e,t,i,r,s,o,a,l=10,u=l,A=90,p=360,g,v,y,b,w=2.5;function S(){return{type:"MultiLineString",coordinates:C()}}function C(){return Nf(km(i/A)*A,t,A).map(y).concat(Nf(km(a/p)*p,o,p).map(b)).concat(Nf(km(e/l)*l,n,l).filter(function(E){return Si(E%A)>Qn}).map(g)).concat(Nf(km(s/u)*u,r,u).filter(function(E){return Si(E%p)>Qn}).map(v))}return S.lines=function(){return C().map(function(E){return{type:"LineString",coordinates:E}})},S.outline=function(){return{type:"Polygon",coordinates:[y(i).concat(b(o).slice(1),y(t).reverse().slice(1),b(a).reverse().slice(1))]}},S.extent=function(E){return arguments.length?S.extentMajor(E).extentMinor(E):S.extentMinor()},S.extentMajor=function(E){return arguments.length?(i=+E[0][0],t=+E[1][0],a=+E[0][1],o=+E[1][1],i>t&&(E=i,i=t,t=E),a>o&&(E=a,a=o,o=E),S.precision(w)):[[i,a],[t,o]]},S.extentMinor=function(E){return arguments.length?(e=+E[0][0],n=+E[1][0],s=+E[0][1],r=+E[1][1],e>n&&(E=e,e=n,n=E),s>r&&(E=s,s=r,r=E),S.precision(w)):[[e,s],[n,r]]},S.step=function(E){return arguments.length?S.stepMajor(E).stepMinor(E):S.stepMinor()},S.stepMajor=function(E){return arguments.length?(A=+E[0],p=+E[1],S):[A,p]},S.stepMinor=function(E){return arguments.length?(l=+E[0],u=+E[1],S):[l,u]},S.precision=function(E){return arguments.length?(w=+E,g=xS(s,r,90),v=bS(e,n,w),y=xS(a,o,90),b=bS(i,t,w),S):w},S.extentMajor([[-180,-90+Qn],[180,90-Qn]]).extentMinor([[-180,-80-Qn],[180,80+Qn]])}function dK(){return AK()()}function lb(n,e){var t=n[0]*Tn,i=n[1]*Tn,r=e[0]*Tn,s=e[1]*Tn,o=Ln(i),a=pn(i),l=Ln(s),u=pn(s),A=o*Ln(t),p=o*pn(t),g=l*Ln(r),v=l*pn(r),y=2*iu(nu(JT(s-i)+o*l*JT(r-t))),b=pn(y),w=y?function(S){var C=pn(S*=y)/b,E=pn(y-S)/b,R=E*A+C*g,D=E*p+C*v,B=E*a+C*u;return[oa(D,R)*rr,oa(B,nu(R*R+D*D))*rr]}:function(){return[t*rr,i*rr]};return w.distance=y,w}const TS=n=>n;var EA=1/0,qg=EA,Xd=-EA,Gg=Xd,SS={point:pK,lineStart:_s,lineEnd:_s,polygonStart:_s,polygonEnd:_s,result:function(){var n=[[EA,qg],[Xd,Gg]];return Xd=Gg=-(qg=EA=1/0),n}};function pK(n,e){n<EA&&(EA=n),n>Xd&&(Xd=n),e<qg&&(qg=e),e>Gg&&(Gg=e)}function ub(n){return function(e){var t=new sx;for(var i in n)t[i]=n[i];return t.stream=e,t}}function sx(){}sx.prototype={constructor:sx,point:function(n,e){this.stream.point(n,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function cb(n,e,t){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),i!=null&&n.clipExtent(null),q2(t,n.stream(SS)),e(SS.result()),i!=null&&n.clipExtent(i),n}function FC(n,e,t){return cb(n,function(i){var r=e[1][0]-e[0][0],s=e[1][1]-e[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+e[0][0]+(r-o*(i[1][0]+i[0][0]))/2,l=+e[0][1]+(s-o*(i[1][1]+i[0][1]))/2;n.scale(150*o).translate([a,l])},t)}function mK(n,e,t){return FC(n,[[0,0],e],t)}function gK(n,e,t){return cb(n,function(i){var r=+e,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];n.scale(150*s).translate([o,a])},t)}function _K(n,e,t){return cb(n,function(i){var r=+e,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;n.scale(150*s).translate([o,a])},t)}var wS=16,vK=Ln(30*Tn);function MS(n,e){return+e?xK(n,e):yK(n)}function yK(n){return ub({point:function(e,t){e=n(e,t),this.stream.point(e[0],e[1])}})}function xK(n,e){function t(i,r,s,o,a,l,u,A,p,g,v,y,b,w){var S=u-i,C=A-r,E=S*S+C*C;if(E>4*e&&b--){var R=o+g,D=a+v,B=l+y,L=nu(R*R+D*D+B*B),U=iu(B/=L),P=Si(Si(B)-1)<Qn||Si(s-p)<Qn?(s+p)/2:oa(D,R),F=n(P,U),V=F[0],H=F[1],j=V-i,J=H-r,Z=C*j-S*J;(Z*Z/E>e||Si((S*j+C*J)/E-.5)>.3||o*g+a*v+l*y<vK)&&(t(i,r,s,o,a,l,V,H,P,R/=L,D/=L,B,b,w),w.point(V,H),t(V,H,P,R,D,B,u,A,p,g,v,y,b,w))}}return function(i){var r,s,o,a,l,u,A,p,g,v,y,b,w={point:S,lineStart:C,lineEnd:R,polygonStart:function(){i.polygonStart(),w.lineStart=D},polygonEnd:function(){i.polygonEnd(),w.lineStart=C}};function S(U,P){U=n(U,P),i.point(U[0],U[1])}function C(){p=NaN,w.point=E,i.lineStart()}function E(U,P){var F=vh([U,P]),V=n(U,P);t(p,g,A,v,y,b,p=V[0],g=V[1],A=U,v=F[0],y=F[1],b=F[2],wS,i),i.point(p,g)}function R(){w.point=S,i.lineEnd()}function D(){C(),w.point=B,w.lineEnd=L}function B(U,P){E(r=U,P),s=p,o=g,a=v,l=y,u=b,w.point=E}function L(){t(p,g,A,v,y,b,s,o,r,a,l,u,wS,i),w.lineEnd=R,R()}return w}}var bK=ub({point:function(n,e){this.stream.point(n*Tn,e*Tn)}});function TK(n){return ub({point:function(e,t){var i=n(e,t);return this.stream.point(i[0],i[1])}})}function SK(n,e,t,i,r){function s(o,a){return o*=i,a*=r,[e+n*o,t-n*a]}return s.invert=function(o,a){return[(o-e)/n*i,(t-a)/n*r]},s}function ES(n,e,t,i,r,s){if(!s)return SK(n,e,t,i,r);var o=Ln(s),a=pn(s),l=o*n,u=a*n,A=o/n,p=a/n,g=(a*t-o*e)/n,v=(a*e+o*t)/n;function y(b,w){return b*=i,w*=r,[l*b-u*w+e,t-u*b-l*w]}return y.invert=function(b,w){return[i*(A*b-p*w+g),r*(v-p*b-A*w)]},y}function wK(n){return MK(function(){return n})()}function MK(n){var e,t=150,i=480,r=250,s=0,o=0,a=0,l=0,u=0,A,p=0,g=1,v=1,y=null,b=pS,w=null,S,C,E,R=TS,D=.5,B,L,U,P,F;function V(Z){return U(Z[0]*Tn,Z[1]*Tn)}function H(Z){return Z=U.invert(Z[0],Z[1]),Z&&[Z[0]*rr,Z[1]*rr]}V.stream=function(Z){return P&&F===Z?P:P=bK(TK(A)(b(B(R(F=Z)))))},V.preclip=function(Z){return arguments.length?(b=Z,y=void 0,J()):b},V.postclip=function(Z){return arguments.length?(R=Z,w=S=C=E=null,J()):R},V.clipAngle=function(Z){return arguments.length?(b=+Z?nK(y=Z*Tn):(y=null,pS),J()):y*rr},V.clipExtent=function(Z){return arguments.length?(R=Z==null?(w=S=C=E=null,TS):rK(w=+Z[0][0],S=+Z[0][1],C=+Z[1][0],E=+Z[1][1]),J()):w==null?null:[[w,S],[C,E]]},V.scale=function(Z){return arguments.length?(t=+Z,j()):t},V.translate=function(Z){return arguments.length?(i=+Z[0],r=+Z[1],j()):[i,r]},V.center=function(Z){return arguments.length?(s=Z[0]%360*Tn,o=Z[1]%360*Tn,j()):[s*rr,o*rr]},V.rotate=function(Z){return arguments.length?(a=Z[0]%360*Tn,l=Z[1]%360*Tn,u=Z.length>2?Z[2]%360*Tn:0,j()):[a*rr,l*rr,u*rr]},V.angle=function(Z){return arguments.length?(p=Z%360*Tn,j()):p*rr},V.reflectX=function(Z){return arguments.length?(g=Z?-1:1,j()):g<0},V.reflectY=function(Z){return arguments.length?(v=Z?-1:1,j()):v<0},V.precision=function(Z){return arguments.length?(B=MS(L,D=Z*Z),J()):nu(D)},V.fitExtent=function(Z,W){return FC(V,Z,W)},V.fitSize=function(Z,W){return mK(V,Z,W)},V.fitWidth=function(Z,W){return gK(V,Z,W)},V.fitHeight=function(Z,W){return _K(V,Z,W)};function j(){var Z=ES(t,0,0,g,v,p).apply(null,e(s,o)),W=ES(t,i-Z[0],r-Z[1],g,v,p);return A=NC(a,l,u),L=ex(e,W),U=ex(A,L),B=MS(L,D),J()}function J(){return P=F=null,V}return function(){return e=n.apply(this,arguments),V.invert=e.invert&&H,j()}}function EK(n){return function(e,t){var i=nu(e*e+t*t),r=n(i),s=pn(r),o=Ln(r);return[oa(e*s,i*o),iu(i&&t*s/i)]}}function hb(n,e){return[n,IZ(FZ((io+e)/2))]}hb.invert=function(n,e){return[n,2*ob(DZ(e))-io]};function UC(n,e){var t=Ln(e),i=1+Ln(n)*t;return[t*pn(n)/i,pn(e)/i]}UC.invert=EK(function(n){return 2*ob(n)});function CK(){return wK(UC).scale(250).clipAngle(142)}function ox(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function RK(n){if(Array.isArray(n))return n}function NK(n){if(Array.isArray(n))return ox(n)}function od(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function PK(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function LK(n,e,t){return e=Hg(e),qK(n,kC()?Reflect.construct(e,[],Hg(n).constructor):e.apply(n,t))}function OC(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DK(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Gn(n,e){return n.get(od(n,e))}function Eu(n,e,t){OC(n,e),e.set(n,t)}function Cu(n,e,t){return n.set(od(n,e),t),t}function IK(n,e){OC(n,e),e.add(n)}function BK(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,zC(i.key),i)}}function FK(n,e,t){return BK(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function rf(n,e,t){return(e=zC(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hg(n){return Hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hg(n)}function UK(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&ax(n,e)}function kC(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kC=function(){return!!n})()}function OK(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function kK(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function VK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qK(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PK(n)}function ax(n,e){return ax=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},ax(n,e)}function W1(n,e){return RK(n)||kK(n,e)||qC(n,e)||VK()}function VC(n){return NK(n)||OK(n)||qC(n)||zK()}function GK(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function zC(n){var e=GK(n,"string");return typeof e=="symbol"?e:e+""}function qC(n,e){if(n){if(typeof n=="string")return ox(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ox(n,e):void 0}}var GC=function(e){e instanceof Array?e.forEach(GC):(e.map&&e.map.dispose(),e.dispose())},HC=function(e){e.geometry&&e.geometry.dispose(),e.material&&GC(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(HC)},CS=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),HC(t)}};function WC(n,e,t){var i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180;return{x:t*Math.sin(i)*Math.cos(r),y:t*Math.cos(i),z:t*Math.sin(i)*Math.sin(r)}}function HK(n){var e=n.x,t=n.y,i=n.z,r=Math.sqrt(e*e+t*t+i*i),s=Math.acos(t/r),o=Math.atan2(i,e);return{lat:90-s*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),r}}function Ec(n){return n*Math.PI/180}var $C=function(e){return 1-(hb(0,(.5-e)*Math.PI)[1]/Math.PI+1)/2},X3=function(e){return Math.max(0,Math.min(1,$C(e)))},RS=function(e){return .5-hb.invert(0,(2*(1-e)-1)*Math.PI)[1]/Math.PI},WK=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=tu().domain([1,0]).range([t,i]).clamp(!0),s=tu().domain([X3(t),X3(i)]).range([1,0]).clamp(!0),o=function(p){return s(X3(r(p)))},a=e.array,l=0,u=a.length;l<u;l+=2)a[l+1]=o(a[l+1]);e.needsUpdate=!0},NS=function(e,t,i,r){var s=Math.pow(2,e),o=Math.max(0,Math.min(s-1,Math.floor((i+180)*s/360))),a=(90-r)/180;t&&(a=Math.max(0,Math.min(1,$C(a))));var l=Math.floor(a*s);return[o,l]},lx=function(e,t){for(var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=[],l=Math.pow(2,e),u=360/l,A=180/l,p=s===void 0?l-1:s,g=o===void 0?l-1:o,v=i,y=Math.min(l-1,p);v<=y;v++)for(var b=r,w=Math.min(l-1,g);b<=w;b++){var S=b,C=A;if(t){S=b===0?b:RS(b/l)*l;var E=b+1===l?b+1:RS((b+1)/l)*l;C=(E-S)*180/l}var R=-180+(v+.5)*u,D=90-(S*180/l+C/2),B=C;a.push({x:v,y:b,lng:R,lat:D,latLen:B})}return a},$K=6,jK=7,XK=3,QK=90,Ja=new WeakMap,ku=new WeakMap,Q3=new WeakMap,Wm=new WeakMap,$o=new WeakMap,Wg=new WeakMap,Kf=new WeakMap,Cc=new WeakMap,$m=new WeakSet,YK=function(n){function e(t){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.tileUrl,o=r.minLevel,a=o===void 0?0:o,l=r.maxLevel,u=l===void 0?17:l,A=r.mercatorProjection,p=A===void 0?!0:A;return DK(this,e),i=LK(this,e),IK(i,$m),Eu(i,Ja,void 0),Eu(i,ku,void 0),Eu(i,Q3,void 0),Eu(i,Wm,void 0),Eu(i,$o,{}),Eu(i,Wg,void 0),Eu(i,Kf,void 0),Eu(i,Cc,void 0),rf(i,"minLevel",void 0),rf(i,"maxLevel",void 0),rf(i,"thresholds",VC(new Array(30)).map(function(g,v){return 8/Math.pow(2,v)})),rf(i,"curvatureResolution",5),rf(i,"tileMargin",0),rf(i,"clearTiles",function(){Object.values(Gn($o,i)).forEach(function(g){g.forEach(function(v){v.obj&&(i.remove(v.obj),CS(v.obj),delete v.obj)})}),Cu($o,i,{})}),Cu(Ja,i,t),i.tileUrl=s,Cu(ku,i,p),i.minLevel=a,i.maxLevel=u,i.level=0,i.add(Cu(Cc,i,new Jn(new Fa(Gn(Ja,i)*.99,180,90),new va({color:0})))),Gn(Cc,i).visible=!1,Gn(Cc,i).material.polygonOffset=!0,Gn(Cc,i).material.polygonOffsetUnits=3,Gn(Cc,i).material.polygonOffsetFactor=1,i}return UK(e,n),FK(e,[{key:"tileUrl",get:function(){return Gn(Q3,this)},set:function(i){Cu(Q3,this,i),this.updatePov(Gn(Kf,this))}},{key:"level",get:function(){return Gn(Wm,this)},set:function(i){var r=this;Gn($o,this)[i]||od($m,this,ZK).call(this,i);var s=Gn(Wm,this);if(Cu(Wm,this,i),!(i===s||s===void 0)){if(Gn(Cc,this).visible=i>0,Gn($o,this)[i].forEach(function(a){return a.obj&&(a.obj.material.depthWrite=!0)}),s<i&&Gn($o,this)[s].forEach(function(a){return a.obj&&(a.obj.material.depthWrite=!1)}),s>i)for(var o=i+1;o<=s;o++)Gn($o,this)[o]&&Gn($o,this)[o].forEach(function(a){a.obj&&(r.remove(a.obj),CS(a.obj),delete a.obj)});od($m,this,PS).call(this)}}},{key:"updatePov",value:function(i){var r=this;if(!(!i||!(i instanceof bp))){Cu(Kf,this,i);var s;if(Cu(Wg,this,function(A){if(!A.hullPnts){var p=360/Math.pow(2,r.level),g=A.lng,v=A.lat,y=A.latLen,b=g-p/2,w=g+p/2,S=v-y/2,C=v+y/2;A.hullPnts=[[v,g],[S,b],[C,b],[S,w],[C,w]].map(function(E){var R=W1(E,2),D=R[0],B=R[1];return WC(D,B,Gn(Ja,r))}).map(function(E){var R=E.x,D=E.y,B=E.z;return new re(R,D,B)})}return s||(s=new qA,i.updateMatrix(),i.updateMatrixWorld(),s.setFromProjectionMatrix(new on().multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse))),A.hullPnts.some(function(E){return s.containsPoint(E.clone().applyMatrix4(r.matrixWorld))})}),this.tileUrl){var o=i.position.clone(),a=o.distanceTo(this.getWorldPosition(new re)),l=(a-Gn(Ja,this))/Gn(Ja,this),u=this.thresholds.findIndex(function(A){return A&&A<=l});this.level=Math.min(this.maxLevel,Math.max(this.minLevel,u<0?this.thresholds.length:u)),od($m,this,PS).call(this)}}}}])}(vs);function ZK(n){var e=this;if(n>jK){Gn($o,this)[n]=[];return}var t=Gn($o,this)[n]=lx(n,Gn(ku,this));t.forEach(function(i){return i.centroid=WC(i.lat,i.lng,Gn(Ja,e))}),t.octree=rC().x(function(i){return i.centroid.x}).y(function(i){return i.centroid.y}).z(function(i){return i.centroid.z}).addAll(t)}function PS(){var n=this;if(!(!this.tileUrl||this.level===void 0||!Gn($o,this).hasOwnProperty(this.level))&&!(!Gn(Wg,this)&&this.level>$K)){var e=Gn($o,this)[this.level];if(Gn(Kf,this)){var t=this.worldToLocal(Gn(Kf,this).position.clone());if(e.octree){var i,r=this.worldToLocal(Gn(Kf,this).position.clone()),s=(r.length()-Gn(Ja,this))*XK;e=(i=e.octree).findAllWithinRadius.apply(i,VC(r).concat([s]))}else{var o=HK(t),a=(o.r/Gn(Ja,this)-1)*QK,l=a/Math.cos(Ec(o.lat)),u=[o.lng-l,o.lng+l],A=[o.lat+a,o.lat-a],p=NS(this.level,Gn(ku,this),u[0],A[0]),g=W1(p,2),v=g[0],y=g[1],b=NS(this.level,Gn(ku,this),u[1],A[1]),w=W1(b,2),S=w[0],C=w[1];!e.record&&(e.record={});var E=e.record;if(!E.hasOwnProperty("".concat(Math.round((v+S)/2),"_").concat(Math.round((y+C)/2))))e=lx(this.level,Gn(ku,this),v,y,S,C).map(function(U){var P="".concat(U.x,"_").concat(U.y);return E.hasOwnProperty(P)?E[P]:(E[P]=U,e.push(U),U)});else{for(var R=[],D=v;D<=S;D++)for(var B=y;B<=C;B++){var L="".concat(D,"_").concat(B);E.hasOwnProperty(L)||(E[L]=lx(this.level,Gn(ku,this),D,B,D,B)[0],e.push(E[L])),R.push(E[L])}e=R}}}e.filter(function(U){return!U.obj}).filter(Gn(Wg,this)||function(){return!0}).forEach(function(U){var P=U.x,F=U.y,V=U.lng,H=U.lat,j=U.latLen,J=360/Math.pow(2,n.level);if(!U.obj){var Z=J*(1-n.tileMargin),W=j*(1-n.tileMargin),K=Ec(V),ee=Ec(-H),se=new Jn(new Fa(Gn(Ja,n),Math.ceil(Z/n.curvatureResolution),Math.ceil(W/n.curvatureResolution),Ec(90-Z/2)+K,Ec(Z),Ec(90-W/2)+ee,Ec(W)),new Tl);if(Gn(ku,n)){var ge=[H+j/2,H-j/2].map(function(ye){return .5-ye/180}),de=W1(ge,2),Ae=de[0],Be=de[1];WK(se.geometry.attributes.uv,Ae,Be)}U.obj=se}U.loading||(U.loading=!0,new yg().load(n.tileUrl(P,F,n.level),function(ye){var De=U.obj;De&&(ye.colorSpace=Zt,De.material.map=ye,De.material.color=null,De.material.needsUpdate=!0,n.add(De)),U.loading=!1}))})}}function KK(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=jC(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u;if(i&&(s=iJ(n,e,s,t)),n.length>80*t){a=1/0,l=1/0;let A=-1/0,p=-1/0;for(let g=t;g<r;g+=t){const v=n[g],y=n[g+1];v<a&&(a=v),y<l&&(l=y),v>A&&(A=v),y>p&&(p=y)}u=Math.max(A-a,p-l),u=u!==0?32767/u:0}return Qd(s,o,t,a,l,u,0),o}function jC(n,e,t,i,r){let s;if(r===dJ(n,e,t,i)>0)for(let o=e;o<t;o+=i)s=LS(o/i|0,n[o],n[o+1],s);else for(let o=t-i;o>=e;o-=i)s=LS(o/i|0,n[o],n[o+1],s);return s&&CA(s,s.next)&&(Zd(s),s=s.next),s}function yh(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(CA(t,t.next)||Ki(t.prev,t,t.next)===0)){if(Zd(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Qd(n,e,t,i,r,s,o){if(!n)return;!o&&s&&lJ(n,i,r,s);let a=n;for(;n.prev!==n.next;){const l=n.prev,u=n.next;if(s?eJ(n,i,r,s):JK(n)){e.push(l.i,n.i,u.i),Zd(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=tJ(yh(n),e),Qd(n,e,t,i,r,s,2)):o===2&&nJ(n,e,t,i,r,s):Qd(yh(n),e,t,i,r,s,1);break}}}function JK(n){const e=n.prev,t=n,i=n.next;if(Ki(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,A=Math.min(r,s,o),p=Math.min(a,l,u),g=Math.max(r,s,o),v=Math.max(a,l,u);let y=i.next;for(;y!==e;){if(y.x>=A&&y.x<=g&&y.y>=p&&y.y<=v&&G0(r,a,s,l,o,u,y.x,y.y)&&Ki(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function eJ(n,e,t,i){const r=n.prev,s=n,o=n.next;if(Ki(r,s,o)>=0)return!1;const a=r.x,l=s.x,u=o.x,A=r.y,p=s.y,g=o.y,v=Math.min(a,l,u),y=Math.min(A,p,g),b=Math.max(a,l,u),w=Math.max(A,p,g),S=ux(v,y,e,t,i),C=ux(b,w,e,t,i);let E=n.prevZ,R=n.nextZ;for(;E&&E.z>=S&&R&&R.z<=C;){if(E.x>=v&&E.x<=b&&E.y>=y&&E.y<=w&&E!==r&&E!==o&&G0(a,A,l,p,u,g,E.x,E.y)&&Ki(E.prev,E,E.next)>=0||(E=E.prevZ,R.x>=v&&R.x<=b&&R.y>=y&&R.y<=w&&R!==r&&R!==o&&G0(a,A,l,p,u,g,R.x,R.y)&&Ki(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;E&&E.z>=S;){if(E.x>=v&&E.x<=b&&E.y>=y&&E.y<=w&&E!==r&&E!==o&&G0(a,A,l,p,u,g,E.x,E.y)&&Ki(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;R&&R.z<=C;){if(R.x>=v&&R.x<=b&&R.y>=y&&R.y<=w&&R!==r&&R!==o&&G0(a,A,l,p,u,g,R.x,R.y)&&Ki(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function tJ(n,e){let t=n;do{const i=t.prev,r=t.next.next;!CA(i,r)&&QC(i,t,t.next,r)&&Yd(i,r)&&Yd(r,i)&&(e.push(i.i,t.i,r.i),Zd(t),Zd(t.next),t=n=r),t=t.next}while(t!==n);return yh(t)}function nJ(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&hJ(o,a)){let l=YC(o,a);o=yh(o,o.next),l=yh(l,l.next),Qd(o,e,t,i,r,s,0),Qd(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function iJ(n,e,t,i){const r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,u=jC(n,a,l,i,!1);u===u.next&&(u.steiner=!0),r.push(cJ(u))}r.sort(rJ);for(let s=0;s<r.length;s++)t=sJ(r[s],t);return t}function rJ(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const i=(n.next.y-n.y)/(n.next.x-n.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=i-r}return t}function sJ(n,e){const t=oJ(n,e);if(!t)return e;const i=YC(t,n);return yh(i,i.next),yh(t,t.next)}function oJ(n,e){let t=e;const i=n.x,r=n.y;let s=-1/0,o;if(CA(n,t))return t;do{if(CA(n,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const p=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=i&&p>s&&(s=p,o=t.x<t.next.x?t:t.next,p===i))return o}t=t.next}while(t!==e);if(!o)return null;const a=o,l=o.x,u=o.y;let A=1/0;t=o;do{if(i>=t.x&&t.x>=l&&i!==t.x&&XC(r<u?i:s,r,l,u,r<u?s:i,r,t.x,t.y)){const p=Math.abs(r-t.y)/(i-t.x);Yd(t,n)&&(p<A||p===A&&(t.x>o.x||t.x===o.x&&aJ(o,t)))&&(o=t,A=p)}t=t.next}while(t!==a);return o}function aJ(n,e){return Ki(n.prev,n,e.prev)<0&&Ki(e.next,n,n.next)<0}function lJ(n,e,t,i){let r=n;do r.z===0&&(r.z=ux(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,uJ(r)}function uJ(n){let e,t=1;do{let i=n,r;n=null;let s=null;for(e=0;i;){e++;let o=i,a=0;for(let u=0;u<t&&(a++,o=o.nextZ,!!o);u++);let l=t;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||i.z<=o.z)?(r=i,i=i.nextZ,a--):(r=o,o=o.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;i=o}s.nextZ=null,t*=2}while(e>1);return n}function ux(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function cJ(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function XC(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function G0(n,e,t,i,r,s,o,a){return!(n===o&&e===a)&&XC(n,e,t,i,r,s,o,a)}function hJ(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!fJ(n,e)&&(Yd(n,e)&&Yd(e,n)&&AJ(n,e)&&(Ki(n.prev,n,e.prev)||Ki(n,e.prev,e))||CA(n,e)&&Ki(n.prev,n,n.next)>0&&Ki(e.prev,e,e.next)>0)}function Ki(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function CA(n,e){return n.x===e.x&&n.y===e.y}function QC(n,e,t,i){const r=Xm(Ki(n,e,t)),s=Xm(Ki(n,e,i)),o=Xm(Ki(t,i,n)),a=Xm(Ki(t,i,e));return!!(r!==s&&o!==a||r===0&&jm(n,t,e)||s===0&&jm(n,i,e)||o===0&&jm(t,n,i)||a===0&&jm(t,e,i))}function jm(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Xm(n){return n>0?1:n<0?-1:0}function fJ(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&QC(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Yd(n,e){return Ki(n.prev,n,n.next)<0?Ki(n,e,n.next)>=0&&Ki(n,n.prev,e)>=0:Ki(n,e,n.prev)<0||Ki(n,n.next,e)<0}function AJ(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function YC(n,e){const t=cx(n.i,n.x,n.y),i=cx(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function LS(n,e,t,i){const r=cx(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Zd(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function cx(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function dJ(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}function $g(n){const e=[],t=[],i=n[0][0].length;let r=0,s=0;for(const o of n){for(const a of o)for(let l=0;l<i;l++)e.push(a[l]);s&&(r+=s,t.push(r)),s=o.length}return{vertices:e,holes:t,dimensions:i}}function hx(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function pJ(n){if(Array.isArray(n))return n}function mJ(n){if(Array.isArray(n))return hx(n)}function gJ(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _J(n,e,t){return e=jg(e),EJ(n,ZC()?Reflect.construct(e,[],jg(n).constructor):e.apply(n,t))}function vJ(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function yJ(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function xJ(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=fb(n))||e){t&&(n=t);var i=0,r=function(){};return{s:r,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){t=t.call(n)},n:function(){var l=t.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||t.return==null||t.return()}finally{if(a)throw s}}}}function jg(n){return jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jg(n)}function bJ(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&fx(n,e)}function ZC(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZC=function(){return!!n})()}function TJ(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function SJ(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function wJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EJ(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gJ(n)}function fx(n,e){return fx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},fx(n,e)}function d0(n,e){return pJ(n)||SJ(n,e)||fb(n,e)||wJ()}function CJ(n){return mJ(n)||TJ(n)||fb(n)||MJ()}function fb(n,e){if(n){if(typeof n=="string")return hx(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?hx(n,e):void 0}}var DS=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=[],r=null;return e.forEach(function(s){if(r){var o=ec(s,r)*180/Math.PI;if(o>t)for(var a=lb(r,s),l=r.length>2||s.length>2?jd(r[2]||0,s[2]||0):null,u=l?function(g){return[].concat(CJ(a(g)),[l(g)])}:a,A=1/Math.ceil(o/t),p=A;p<1;)i.push(u(p)),p+=A}i.push(r=s)}),i},Ax=typeof window<"u"&&window.THREE?window.THREE:{BufferGeometry:pi,Float32BufferAttribute:ri},RJ=new Ax.BufferGeometry().setAttribute?"setAttribute":"addAttribute",KC=function(n){function e(t){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;vJ(this,e),i=_J(this,e),i.type="GeoJsonGeometry",i.parameters={geoJson:t,radius:r,resolution:s};var o=({Point:A,MultiPoint:p,LineString:g,MultiLineString:v,Polygon:y,MultiPolygon:b}[t.type]||function(){return[]})(t.coordinates,r),a=[],l=[],u=0;o.forEach(function(w){var S=a.length;p0({indices:a,vertices:l},w),i.addGroup(S,a.length-S,u++)}),a.length&&i.setIndex(a),l.length&&i[RJ]("position",new Ax.Float32BufferAttribute(l,3));function A(w,S){var C=Y3(w[1],w[0],S+(w[2]||0)),E=[];return[{vertices:C,indices:E}]}function p(w,S){var C={vertices:[],indices:[]};return w.map(function(E){return A(E,S)}).forEach(function(E){var R=d0(E,1),D=R[0];p0(C,D)}),[C]}function g(w,S){for(var C=DS(w,s).map(function(U){var P=d0(U,3),F=P[0],V=P[1],H=P[2],j=H===void 0?0:H;return Y3(V,F,S+j)}),E=$g([C]),R=E.vertices,D=Math.round(R.length/3),B=[],L=1;L<D;L++)B.push(L-1,L);return[{vertices:R,indices:B}]}function v(w,S){var C={vertices:[],indices:[]};return w.map(function(E){return g(E,S)}).forEach(function(E){var R=d0(E,1),D=R[0];p0(C,D)}),[C]}function y(w,S){for(var C=w.map(function(Z){return DS(Z,s).map(function(W){var K=d0(W,3),ee=K[0],se=K[1],ge=K[2],de=ge===void 0?0:ge;return Y3(se,ee,S+de)})}),E=$g(C),R=E.vertices,D=E.holes,B=D[0]||1/0,L=R.slice(0,B*3),U=R.slice(B*3),P=new Set(D),F=Math.round(R.length/3),V=[],H=[],j=1;j<F;j++)P.has(j)||(j<B?V.push(j-1,j):H.push(j-1-B,j-B));var J=[{indices:V,vertices:L}];return D.length&&J.push({indices:H,vertices:U}),J}function b(w,S){var C={vertices:[],indices:[]},E={vertices:[],indices:[]};w.map(function(D){return y(D,S)}).forEach(function(D){var B=d0(D,2),L=B[0],U=B[1];p0(C,L),U&&p0(E,U)});var R=[C];return E.vertices.length&&R.push(E),R}return i}return bJ(e,n),yJ(e)}(Ax.BufferGeometry);function p0(n,e){var t=Math.round(n.vertices.length/3);IS(n.vertices,e.vertices),IS(n.indices,e.indices.map(function(i){return i+t}))}function IS(n,e){var t=xJ(e),i;try{for(t.s();!(i=t.n()).done;){var r=i.value;n.push(r)}}catch(s){t.e(s)}finally{t.f()}}function Y3(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180;return[t*Math.sin(i)*Math.cos(r),t*Math.cos(i),t*Math.sin(i)*Math.sin(r)]}function NJ(n,e,t=!0){if(!e||!e.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!n.hasAttribute("position")||!n.hasAttribute("normal")||!n.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function i(o){if(o.normalized||o.isInterleavedBufferAttribute){const a=new Float32Array(o.count*o.itemSize);for(let l=0,u=0;l<o.count;l++)a[u++]=o.getX(l),a[u++]=o.getY(l),o.itemSize>2&&(a[u++]=o.getZ(l));return a}return o.array instanceof Float32Array?o.array:new Float32Array(o.array)}const r=n.index?n.toNonIndexed():n,s=e.generateTangents(i(r.attributes.position),i(r.attributes.normal),i(r.attributes.uv));if(t)for(let o=3;o<s.length;o+=4)s[o]*=-1;return r.setAttribute("tangent",new Xi(s,4)),n!==r&&n.copy(r),n}function PJ(n,e=!1){const t=n[0].index!==null,i=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),s={},o={},a=n[0].morphTargetsRelative,l=new pi;let u=0;for(let A=0;A<n.length;++A){const p=n[A];let g=0;if(t!==(p.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const v in p.attributes){if(!i.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+'. All geometries must have compatible attributes; make sure "'+v+'" attribute exists among all geometries, or in none of them.'),null;s[v]===void 0&&(s[v]=[]),s[v].push(p.attributes[v]),g++}if(g!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+". Make sure all geometries have the same number of attributes."),null;if(a!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const v in p.morphAttributes){if(!r.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+".  .morphAttributes must be consistent throughout all geometries."),null;o[v]===void 0&&(o[v]=[]),o[v].push(p.morphAttributes[v])}if(e){let v;if(t)v=p.index.count;else if(p.attributes.position!==void 0)v=p.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+A+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,v,A),u+=v}}if(t){let A=0;const p=[];for(let g=0;g<n.length;++g){const v=n[g].index;for(let y=0;y<v.count;++y)p.push(v.getX(y)+A);A+=n[g].attributes.position.count}l.setIndex(p)}for(const A in s){const p=dx(s[A]);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+A+" attribute."),null;l.setAttribute(A,p)}for(const A in o){const p=o[A][0].length;if(p===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[A]=[];for(let g=0;g<p;++g){const v=[];for(let b=0;b<o[A].length;++b)v.push(o[A][b][g]);const y=dx(v);if(!y)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+A+" morphAttribute."),null;l.morphAttributes[A].push(y)}}return l}function dx(n){let e,t,i,r=-1,s=0;for(let u=0;u<n.length;++u){const A=n[u];if(e===void 0&&(e=A.array.constructor),e!==A.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=A.itemSize),t!==A.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=A.normalized),i!==A.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(r===-1&&(r=A.gpuType),r!==A.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=A.count*t}const o=new e(s),a=new Xi(o,t,i);let l=0;for(let u=0;u<n.length;++u){const A=n[u];if(A.isInterleavedBufferAttribute){const p=l/t;for(let g=0,v=A.count;g<v;g++)for(let y=0;y<t;y++){const b=A.getComponent(g,y);a.setComponent(g+p,y,b)}}else o.set(A.array,l);l+=A.count*t}return r!==void 0&&(a.gpuType=r),a}function LJ(n){return n.isInstancedInterleavedBufferAttribute||n.isInterleavedBufferAttribute?Xg(n):n.isInstancedBufferAttribute?new Xu().copy(n):new Xi().copy(n)}function DJ(n){let e,t=0,i=0;for(let u=0,A=n.length;u<A;++u){const p=n[u];if(e===void 0&&(e=p.array.constructor),e!==p.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;t+=p.array.length,i+=p.itemSize}const r=new B2(new e(t),i);let s=0;const o=[],a=["getX","getY","getZ","getW"],l=["setX","setY","setZ","setW"];for(let u=0,A=n.length;u<A;u++){const p=n[u],g=p.itemSize,v=p.count,y=new Ko(r,g,s,p.normalized);o.push(y),s+=g;for(let b=0;b<v;b++)for(let w=0;w<g;w++)y[l[w]](b,p[a[w]](b))}return o}function Xg(n){const e=n.data.array.constructor,t=n.count,i=n.itemSize,r=n.normalized,s=new e(t*i);let o;n.isInstancedInterleavedBufferAttribute?o=new Xu(s,i,r,n.meshPerAttribute):o=new Xi(s,i,r);for(let a=0;a<t;a++)o.setX(a,n.getX(a)),i>=2&&o.setY(a,n.getY(a)),i>=3&&o.setZ(a,n.getZ(a)),i>=4&&o.setW(a,n.getW(a));return o}function IJ(n){const e=n.attributes,t=n.morphTargets,i=new Map;for(const r in e){const s=e[r];s.isInterleavedBufferAttribute&&(i.has(s)||i.set(s,Xg(s)),e[r]=i.get(s))}for(const r in t){const s=t[r];s.isInterleavedBufferAttribute&&(i.has(s)||i.set(s,Xg(s)),t[r]=i.get(s))}}function BJ(n){let e=0;for(const i in n.attributes){const r=n.getAttribute(i);e+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}const t=n.getIndex();return e+=t?t.count*t.itemSize*t.array.BYTES_PER_ELEMENT:0,e}function FJ(n,e=1e-4){e=Math.max(e,Number.EPSILON);const t={},i=n.getIndex(),r=n.getAttribute("position"),s=i?i.count:r.count;let o=0;const a=Object.keys(n.attributes),l={},u={},A=[],p=["getX","getY","getZ","getW"],g=["setX","setY","setZ","setW"];for(let C=0,E=a.length;C<E;C++){const R=a[C],D=n.attributes[R];l[R]=new D.constructor(new D.array.constructor(D.count*D.itemSize),D.itemSize,D.normalized);const B=n.morphAttributes[R];B&&(u[R]||(u[R]=[]),B.forEach((L,U)=>{const P=new L.array.constructor(L.count*L.itemSize);u[R][U]=new L.constructor(P,L.itemSize,L.normalized)}))}const v=e*.5,y=Math.log10(1/e),b=Math.pow(10,y),w=v*b;for(let C=0;C<s;C++){const E=i?i.getX(C):C;let R="";for(let D=0,B=a.length;D<B;D++){const L=a[D],U=n.getAttribute(L),P=U.itemSize;for(let F=0;F<P;F++)R+=`${~~(U[p[F]](E)*b+w)},`}if(R in t)A.push(t[R]);else{for(let D=0,B=a.length;D<B;D++){const L=a[D],U=n.getAttribute(L),P=n.morphAttributes[L],F=U.itemSize,V=l[L],H=u[L];for(let j=0;j<F;j++){const J=p[j],Z=g[j];if(V[Z](o,U[J](E)),P)for(let W=0,K=P.length;W<K;W++)H[W][Z](o,P[W][J](E))}}t[R]=o,A.push(o),o++}}const S=n.clone();for(const C in n.attributes){const E=l[C];if(S.setAttribute(C,new E.constructor(E.array.slice(0,o*E.itemSize),E.itemSize,E.normalized)),C in u)for(let R=0;R<u[C].length;R++){const D=u[C][R];S.morphAttributes[C][R]=new D.constructor(D.array.slice(0,o*D.itemSize),D.itemSize,D.normalized)}}return S.setIndex(A),S}function UJ(n,e){if(e===Vq)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===x6||e===zq){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(e===x6)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}function OJ(n){const e=new re,t=new re,i=new re,r=new re,s=new re,o=new re,a=new re,l=new re,u=new re;function A(se,ge,de,Ae,Be,ye,De,We){e.fromBufferAttribute(ge,Be),t.fromBufferAttribute(ge,ye),i.fromBufferAttribute(ge,De);const $e=se.morphTargetInfluences;if(de&&$e){a.set(0,0,0),l.set(0,0,0),u.set(0,0,0);for(let Ke=0,Xe=de.length;Ke<Xe;Ke++){const st=$e[Ke],gt=de[Ke];st!==0&&(r.fromBufferAttribute(gt,Be),s.fromBufferAttribute(gt,ye),o.fromBufferAttribute(gt,De),Ae?(a.addScaledVector(r,st),l.addScaledVector(s,st),u.addScaledVector(o,st)):(a.addScaledVector(r.sub(e),st),l.addScaledVector(s.sub(t),st),u.addScaledVector(o.sub(i),st)))}e.add(a),t.add(l),i.add(u)}se.isSkinnedMesh&&(se.applyBoneTransform(Be,e),se.applyBoneTransform(ye,t),se.applyBoneTransform(De,i)),We[Be*3+0]=e.x,We[Be*3+1]=e.y,We[Be*3+2]=e.z,We[ye*3+0]=t.x,We[ye*3+1]=t.y,We[ye*3+2]=t.z,We[De*3+0]=i.x,We[De*3+1]=i.y,We[De*3+2]=i.z}const p=n.geometry,g=n.material;let v,y,b;const w=p.index,S=p.attributes.position,C=p.morphAttributes.position,E=p.morphTargetsRelative,R=p.attributes.normal,D=p.morphAttributes.position,B=p.groups,L=p.drawRange;let U,P,F,V,H,j,J;const Z=new Float32Array(S.count*S.itemSize),W=new Float32Array(R.count*R.itemSize);if(w!==null)if(Array.isArray(g))for(U=0,F=B.length;U<F;U++)for(H=B[U],j=Math.max(H.start,L.start),J=Math.min(H.start+H.count,L.start+L.count),P=j,V=J;P<V;P+=3)v=w.getX(P),y=w.getX(P+1),b=w.getX(P+2),A(n,S,C,E,v,y,b,Z),A(n,R,D,E,v,y,b,W);else for(j=Math.max(0,L.start),J=Math.min(w.count,L.start+L.count),U=j,F=J;U<F;U+=3)v=w.getX(U),y=w.getX(U+1),b=w.getX(U+2),A(n,S,C,E,v,y,b,Z),A(n,R,D,E,v,y,b,W);else if(Array.isArray(g))for(U=0,F=B.length;U<F;U++)for(H=B[U],j=Math.max(H.start,L.start),J=Math.min(H.start+H.count,L.start+L.count),P=j,V=J;P<V;P+=3)v=P,y=P+1,b=P+2,A(n,S,C,E,v,y,b,Z),A(n,R,D,E,v,y,b,W);else for(j=Math.max(0,L.start),J=Math.min(S.count,L.start+L.count),U=j,F=J;U<F;U+=3)v=U,y=U+1,b=U+2,A(n,S,C,E,v,y,b,Z),A(n,R,D,E,v,y,b,W);const K=new ri(Z,3),ee=new ri(W,3);return{positionAttribute:S,normalAttribute:R,morphedPositionAttribute:K,morphedNormalAttribute:ee}}function kJ(n){if(n.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),n;let e=n.groups;if(e=e.sort((o,a)=>o.materialIndex!==a.materialIndex?o.materialIndex-a.materialIndex:o.start-a.start),n.getIndex()===null){const o=n.getAttribute("position"),a=[];for(let l=0;l<o.count;l+=3)a.push(l,l+1,l+2);n.setIndex(a)}const t=n.getIndex(),i=[];for(let o=0;o<e.length;o++){const a=e[o],l=a.start,u=l+a.count;for(let A=l;A<u;A++)i.push(t.getX(A))}n.dispose(),n.setIndex(i);let r=0;for(let o=0;o<e.length;o++){const a=e[o];a.start=r,r+=a.count}let s=e[0];n.groups=[s];for(let o=1;o<e.length;o++){const a=e[o];s.materialIndex===a.materialIndex?s.count+=a.count:(s=a,n.groups.push(s))}return n}function VJ(n,e=Math.PI/3){const t=Math.cos(e),i=(1+1e-10)*100,r=[new re,new re,new re],s=new re,o=new re,a=new re,l=new re;function u(b){const w=~~(b.x*i),S=~~(b.y*i),C=~~(b.z*i);return`${w},${S},${C}`}const A=n.index?n.toNonIndexed():n,p=A.attributes.position,g={};for(let b=0,w=p.count/3;b<w;b++){const S=3*b,C=r[0].fromBufferAttribute(p,S+0),E=r[1].fromBufferAttribute(p,S+1),R=r[2].fromBufferAttribute(p,S+2);s.subVectors(R,E),o.subVectors(C,E);const D=new re().crossVectors(s,o).normalize();for(let B=0;B<3;B++){const L=r[B],U=u(L);U in g||(g[U]=[]),g[U].push(D)}}const v=new Float32Array(p.count*3),y=new Xi(v,3,!1);for(let b=0,w=p.count/3;b<w;b++){const S=3*b,C=r[0].fromBufferAttribute(p,S+0),E=r[1].fromBufferAttribute(p,S+1),R=r[2].fromBufferAttribute(p,S+2);s.subVectors(R,E),o.subVectors(C,E),a.crossVectors(s,o).normalize();for(let D=0;D<3;D++){const B=r[D],L=u(B),U=g[L];l.set(0,0,0);for(let P=0,F=U.length;P<F;P++){const V=U[P];a.dot(V)>t&&l.add(V)}l.normalize(),y.setXYZ(S+D,l.x,l.y,l.z)}}return A.setAttribute("normal",y),A}const Ab=Object.freeze(Object.defineProperty({__proto__:null,computeMikkTSpaceTangents:NJ,computeMorphedAttributes:OJ,deepCloneAttribute:LJ,deinterleaveAttribute:Xg,deinterleaveGeometry:IJ,estimateBytesUsed:BJ,interleaveAttributes:DJ,mergeAttributes:dx,mergeGeometries:PJ,mergeGroups:kJ,mergeVertices:FJ,toCreasedNormals:VJ,toTrianglesDrawMode:UJ},Symbol.toStringTag,{value:"Module"}));var ft=function(n){return typeof n=="function"?n:typeof n=="string"?function(e){return e[n]}:function(e){return n}};function Qg(n){"@babel/helpers - typeof";return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qg(n)}var zJ=/^\s+/,qJ=/\s+$/;function Jt(n,e){if(n=n||"",e=e||{},n instanceof Jt)return n;if(!(this instanceof Jt))return new Jt(n,e);var t=GJ(n);this._originalInput=n,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}Jt.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),t,i,r,s,o,a;return t=e.r/255,i=e.g/255,r=e.b/255,t<=.03928?s=t/12.92:s=Math.pow((t+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),.2126*s+.7152*o+.0722*a},setAlpha:function(e){return this._a=JC(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=FS(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=FS(this._r,this._g,this._b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.v*100);return this._a==1?"hsv("+t+", "+i+"%, "+r+"%)":"hsva("+t+", "+i+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=BS(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=BS(this._r,this._g,this._b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.l*100);return this._a==1?"hsl("+t+", "+i+"%, "+r+"%)":"hsla("+t+", "+i+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return US(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return jJ(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ji(this._r,255)*100)+"%",g:Math.round(ji(this._g,255)*100)+"%",b:Math.round(ji(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ji(this._r,255)*100)+"%, "+Math.round(ji(this._g,255)*100)+"%, "+Math.round(ji(this._b,255)*100)+"%)":"rgba("+Math.round(ji(this._r,255)*100)+"%, "+Math.round(ji(this._g,255)*100)+"%, "+Math.round(ji(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:see[US(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+OS(this._r,this._g,this._b,this._a),i=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var s=Jt(e);i="#"+OS(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){var t=!!e;e=e||this._format;var i=!1,r=this._a<1&&this._a>=0,s=!t&&r&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return Jt(this.toString())},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(ZJ,arguments)},brighten:function(){return this._applyModification(KJ,arguments)},darken:function(){return this._applyModification(JJ,arguments)},desaturate:function(){return this._applyModification(XJ,arguments)},saturate:function(){return this._applyModification(QJ,arguments)},greyscale:function(){return this._applyModification(YJ,arguments)},spin:function(){return this._applyModification(eee,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(iee,arguments)},complement:function(){return this._applyCombination(tee,arguments)},monochromatic:function(){return this._applyCombination(ree,arguments)},splitcomplement:function(){return this._applyCombination(nee,arguments)},triad:function(){return this._applyCombination(kS,[3])},tetrad:function(){return this._applyCombination(kS,[4])}};Jt.fromRatio=function(n,e){if(Qg(n)=="object"){var t={};for(var i in n)n.hasOwnProperty(i)&&(i==="a"?t[i]=n[i]:t[i]=H0(n[i]));n=t}return Jt(n,e)};function GJ(n){var e={r:0,g:0,b:0},t=1,i=null,r=null,s=null,o=!1,a=!1;return typeof n=="string"&&(n=uee(n)),Qg(n)=="object"&&(Il(n.r)&&Il(n.g)&&Il(n.b)?(e=HJ(n.r,n.g,n.b),o=!0,a=String(n.r).substr(-1)==="%"?"prgb":"rgb"):Il(n.h)&&Il(n.s)&&Il(n.v)?(i=H0(n.s),r=H0(n.v),e=$J(n.h,i,r),o=!0,a="hsv"):Il(n.h)&&Il(n.s)&&Il(n.l)&&(i=H0(n.s),s=H0(n.l),e=WJ(n.h,i,s),o=!0,a="hsl"),n.hasOwnProperty("a")&&(t=n.a)),t=JC(t),{ok:o,format:n.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}function HJ(n,e,t){return{r:ji(n,255)*255,g:ji(e,255)*255,b:ji(t,255)*255}}function BS(n,e,t){n=ji(n,255),e=ji(e,255),t=ji(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s,o,a=(i+r)/2;if(i==r)s=o=0;else{var l=i-r;switch(o=a>.5?l/(2-i-r):l/(i+r),i){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,l:a}}function WJ(n,e,t){var i,r,s;n=ji(n,360),e=ji(e,100),t=ji(t,100);function o(u,A,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?u+(A-u)*6*p:p<1/2?A:p<2/3?u+(A-u)*(2/3-p)*6:u}if(e===0)i=r=s=t;else{var a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;i=o(l,a,n+1/3),r=o(l,a,n),s=o(l,a,n-1/3)}return{r:i*255,g:r*255,b:s*255}}function FS(n,e,t){n=ji(n,255),e=ji(e,255),t=ji(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s,o,a=i,l=i-r;if(o=i===0?0:l/i,i==r)s=0;else{switch(i){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,v:a}}function $J(n,e,t){n=ji(n,360)*6,e=ji(e,100),t=ji(t,100);var i=Math.floor(n),r=n-i,s=t*(1-e),o=t*(1-r*e),a=t*(1-(1-r)*e),l=i%6,u=[t,o,s,s,a,t][l],A=[a,t,t,o,s,s][l],p=[s,s,a,t,t,o][l];return{r:u*255,g:A*255,b:p*255}}function US(n,e,t,i){var r=[Ta(Math.round(n).toString(16)),Ta(Math.round(e).toString(16)),Ta(Math.round(t).toString(16))];return i&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function jJ(n,e,t,i,r){var s=[Ta(Math.round(n).toString(16)),Ta(Math.round(e).toString(16)),Ta(Math.round(t).toString(16)),Ta(eR(i))];return r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function OS(n,e,t,i){var r=[Ta(eR(i)),Ta(Math.round(n).toString(16)),Ta(Math.round(e).toString(16)),Ta(Math.round(t).toString(16))];return r.join("")}Jt.equals=function(n,e){return!n||!e?!1:Jt(n).toRgbString()==Jt(e).toRgbString()};Jt.random=function(){return Jt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function XJ(n,e){e=e===0?0:e||10;var t=Jt(n).toHsl();return t.s-=e/100,t.s=G2(t.s),Jt(t)}function QJ(n,e){e=e===0?0:e||10;var t=Jt(n).toHsl();return t.s+=e/100,t.s=G2(t.s),Jt(t)}function YJ(n){return Jt(n).desaturate(100)}function ZJ(n,e){e=e===0?0:e||10;var t=Jt(n).toHsl();return t.l+=e/100,t.l=G2(t.l),Jt(t)}function KJ(n,e){e=e===0?0:e||10;var t=Jt(n).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),Jt(t)}function JJ(n,e){e=e===0?0:e||10;var t=Jt(n).toHsl();return t.l-=e/100,t.l=G2(t.l),Jt(t)}function eee(n,e){var t=Jt(n).toHsl(),i=(t.h+e)%360;return t.h=i<0?360+i:i,Jt(t)}function tee(n){var e=Jt(n).toHsl();return e.h=(e.h+180)%360,Jt(e)}function kS(n,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=Jt(n).toHsl(),i=[Jt(n)],r=360/e,s=1;s<e;s++)i.push(Jt({h:(t.h+s*r)%360,s:t.s,l:t.l}));return i}function nee(n){var e=Jt(n).toHsl(),t=e.h;return[Jt(n),Jt({h:(t+72)%360,s:e.s,l:e.l}),Jt({h:(t+216)%360,s:e.s,l:e.l})]}function iee(n,e,t){e=e||6,t=t||30;var i=Jt(n).toHsl(),r=360/t,s=[Jt(n)];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,s.push(Jt(i));return s}function ree(n,e){e=e||6;for(var t=Jt(n).toHsv(),i=t.h,r=t.s,s=t.v,o=[],a=1/e;e--;)o.push(Jt({h:i,s:r,v:s})),s=(s+a)%1;return o}Jt.mix=function(n,e,t){t=t===0?0:t||50;var i=Jt(n).toRgb(),r=Jt(e).toRgb(),s=t/100,o={r:(r.r-i.r)*s+i.r,g:(r.g-i.g)*s+i.g,b:(r.b-i.b)*s+i.b,a:(r.a-i.a)*s+i.a};return Jt(o)};Jt.readability=function(n,e){var t=Jt(n),i=Jt(e);return(Math.max(t.getLuminance(),i.getLuminance())+.05)/(Math.min(t.getLuminance(),i.getLuminance())+.05)};Jt.isReadable=function(n,e,t){var i=Jt.readability(n,e),r,s;switch(s=!1,r=cee(t),r.level+r.size){case"AAsmall":case"AAAlarge":s=i>=4.5;break;case"AAlarge":s=i>=3;break;case"AAAsmall":s=i>=7;break}return s};Jt.mostReadable=function(n,e,t){var i=null,r=0,s,o,a,l;t=t||{},o=t.includeFallbackColors,a=t.level,l=t.size;for(var u=0;u<e.length;u++)s=Jt.readability(n,e[u]),s>r&&(r=s,i=Jt(e[u]));return Jt.isReadable(n,i,{level:a,size:l})||!o?i:(t.includeFallbackColors=!1,Jt.mostReadable(n,["#fff","#000"],t))};var px=Jt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},see=Jt.hexNames=oee(px);function oee(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function JC(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function ji(n,e){aee(n)&&(n="100%");var t=lee(n);return n=Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(n*e,10)/100),Math.abs(n-e)<1e-6?1:n%e/parseFloat(e)}function G2(n){return Math.min(1,Math.max(0,n))}function To(n){return parseInt(n,16)}function aee(n){return typeof n=="string"&&n.indexOf(".")!=-1&&parseFloat(n)===1}function lee(n){return typeof n=="string"&&n.indexOf("%")!=-1}function Ta(n){return n.length==1?"0"+n:""+n}function H0(n){return n<=1&&(n=n*100+"%"),n}function eR(n){return Math.round(parseFloat(n)*255).toString(16)}function VS(n){return To(n)/255}var ga=function(){var n="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+n+")",i="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Il(n){return!!ga.CSS_UNIT.exec(n)}function uee(n){n=n.replace(zJ,"").replace(qJ,"").toLowerCase();var e=!1;if(px[n])n=px[n],e=!0;else if(n=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=ga.rgb.exec(n))?{r:t[1],g:t[2],b:t[3]}:(t=ga.rgba.exec(n))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=ga.hsl.exec(n))?{h:t[1],s:t[2],l:t[3]}:(t=ga.hsla.exec(n))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=ga.hsv.exec(n))?{h:t[1],s:t[2],v:t[3]}:(t=ga.hsva.exec(n))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=ga.hex8.exec(n))?{r:To(t[1]),g:To(t[2]),b:To(t[3]),a:VS(t[4]),format:e?"name":"hex8"}:(t=ga.hex6.exec(n))?{r:To(t[1]),g:To(t[2]),b:To(t[3]),format:e?"name":"hex"}:(t=ga.hex4.exec(n))?{r:To(t[1]+""+t[1]),g:To(t[2]+""+t[2]),b:To(t[3]+""+t[3]),a:VS(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=ga.hex3.exec(n))?{r:To(t[1]+""+t[1]),g:To(t[2]+""+t[2]),b:To(t[3]+""+t[3]),format:e?"name":"hex"}:!1}function cee(n){var e,t;return n=n||{level:"AA",size:"small"},e=(n.level||"AA").toUpperCase(),t=(n.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}function mx(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function hee(n){if(Array.isArray(n))return n}function fee(n){if(Array.isArray(n))return mx(n)}function tR(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function Aee(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dee(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function fs(n,e){return n.get(tR(n,e))}function sf(n,e,t){Aee(n,e),e.set(n,t)}function Qm(n,e,t){return n.set(tR(n,e),t),t}function pee(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,See(i.key),i)}}function mee(n,e,t){return e&&pee(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function gee(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function _ee(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function vee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xee(n,e){return hee(n)||_ee(n,e)||nR(n,e)||vee()}function bee(n){return fee(n)||gee(n)||nR(n)||yee()}function Tee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function See(n){var e=Tee(n,"string");return typeof e=="symbol"?e:e+""}function nR(n,e){if(n){if(typeof n=="string")return mx(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?mx(n,e):void 0}}var of=new WeakMap,m0=new WeakMap,af=new WeakMap,Z3=new WeakMap,K3=new WeakMap,J3=new WeakMap,wee=function(){function n(){dee(this,n),sf(this,of,new Map),sf(this,m0,new Map),sf(this,af,function(e){return e}),sf(this,Z3,function(){return{}}),sf(this,K3,function(){}),sf(this,J3,function(){})}return mee(n,[{key:"getObj",value:function(t){return fs(of,this).get(fs(af,this).call(this,t))}},{key:"getData",value:function(t){return fs(m0,this).get(t)}},{key:"entries",value:function(){return bee(fs(m0,this).entries()).map(function(t){var i=xee(t,2),r=i[0],s=i[1];return[s,r]})}},{key:"id",value:function(t){return Qm(af,this,ft(t)),this}},{key:"onCreateObj",value:function(t){return Qm(Z3,this,t),this}},{key:"onUpdateObj",value:function(t){return Qm(K3,this,t),this}},{key:"onRemoveObj",value:function(t){return Qm(J3,this,t),this}},{key:"digest",value:function(t){var i=this;t.filter(function(s){return!fs(of,i).has(fs(af,i).call(i,s))}).forEach(function(s){var o=fs(Z3,i).call(i,s);fs(of,i).set(fs(af,i).call(i,s),o),fs(m0,i).set(o,s)});var r=new Map(t.map(function(s){return[fs(af,i).call(i,s),s]}));return fs(of,this).forEach(function(s,o){r.has(o)?fs(K3,i).call(i,s,r.get(o)):(fs(J3,i).call(i,s,o),fs(of,i).delete(o),fs(m0,i).delete(s))}),this}},{key:"clear",value:function(){return this.digest([]),this}}])}(),$1={exports:{}},Mee=$1.exports,zS;function Eee(){return zS||(zS=1,function(n,e){(function(t,i){n.exports=i()})(Mee,function(){return function(t){function i(s){if(r[s])return r[s].exports;var o=r[s]={exports:{},id:s,loaded:!1};return t[s].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var r={};return i.m=t,i.c=r,i.p="",i(0)}([function(t,i,r){var s=r(1),o=function(){function a(l,u,A){l===void 0&&(l=NaN),u===void 0&&(u=NaN),A===void 0&&(A=!1),this._minFPS=u,this._maxFPS=l,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new s.default,this._onPause=new s.default,this._onTick=new s.default,this._onTickOncePerFrame=new s.default,A||this.resume()}return a.prototype.updateOnce=function(l){l(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},a.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},a.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(a.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"timeScale",{get:function(){return this._timeScale},set:function(l){this._timeScale!==l&&(this._timeScale=l)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),a.prototype.animateOnce=function(){var l=this;this._animationFrameHandle=window.requestAnimationFrame(function(){return l.onFrame()})},a.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},a.prototype.update=function(l,u){u===void 0&&(u=!0),this._currentTick++,this._currentTime+=l,this._tickDeltaTime=l,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),u&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.getTimer=function(){return Date.now()},a}();Object.defineProperty(i,"__esModule",{value:!0}),i.default=o},function(t,i,r){(function(s,o){t.exports=o()})(this,function(){return function(s){function o(l){if(a[l])return a[l].exports;var u=a[l]={exports:{},id:l,loaded:!1};return s[l].call(u.exports,u,u.exports,o),u.loaded=!0,u.exports}var a={};return o.m=s,o.c=a,o.p="",o(0)}([function(s,o){var a=function(){function l(){this.functions=[]}return l.prototype.add=function(u){return this.functions.indexOf(u)===-1&&(this.functions.push(u),!0)},l.prototype.remove=function(u){var A=this.functions.indexOf(u);return A>-1&&(this.functions.splice(A,1),!0)},l.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},l.prototype.dispatch=function(){for(var u=[],A=0;A<arguments.length;A++)u[A]=arguments[A];var p=this.functions.concat();p.forEach(function(g){g.apply(void 0,u)})},Object.defineProperty(l.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),l}();Object.defineProperty(o,"__esModule",{value:!0}),o.default=a}])})}])})}($1)),$1.exports}var Cee=Eee();const RA=UE(Cee),Yl=11102230246251565e-32,As=134217729,Ree=(3+8*Yl)*Yl;function ev(n,e,t,i,r){let s,o,a,l,u=e[0],A=i[0],p=0,g=0;A>u==A>-u?(s=u,u=e[++p]):(s=A,A=i[++g]);let v=0;if(p<n&&g<t)for(A>u==A>-u?(o=u+s,a=s-(o-u),u=e[++p]):(o=A+s,a=s-(o-A),A=i[++g]),s=o,a!==0&&(r[v++]=a);p<n&&g<t;)A>u==A>-u?(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=e[++p]):(o=s+A,l=o-s,a=s-(o-l)+(A-l),A=i[++g]),s=o,a!==0&&(r[v++]=a);for(;p<n;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=e[++p],s=o,a!==0&&(r[v++]=a);for(;g<t;)o=s+A,l=o-s,a=s-(o-l)+(A-l),A=i[++g],s=o,a!==0&&(r[v++]=a);return(s!==0||v===0)&&(r[v++]=s),v}function Nee(n,e){let t=e[0];for(let i=1;i<n;i++)t+=e[i];return t}function Ep(n){return new Float64Array(n)}const Pee=(3+16*Yl)*Yl,Lee=(2+12*Yl)*Yl,Dee=(9+64*Yl)*Yl*Yl,lf=Ep(4),qS=Ep(8),GS=Ep(12),HS=Ep(16),Cs=Ep(4);function Iee(n,e,t,i,r,s,o){let a,l,u,A,p,g,v,y,b,w,S,C,E,R,D,B,L,U;const P=n-r,F=t-r,V=e-s,H=i-s;R=P*H,g=As*P,v=g-(g-P),y=P-v,g=As*H,b=g-(g-H),w=H-b,D=y*w-(R-v*b-y*b-v*w),B=V*F,g=As*V,v=g-(g-V),y=V-v,g=As*F,b=g-(g-F),w=F-b,L=y*w-(B-v*b-y*b-v*w),S=D-L,p=D-S,lf[0]=D-(S+p)+(p-L),C=R+S,p=C-R,E=R-(C-p)+(S-p),S=E-B,p=E-S,lf[1]=E-(S+p)+(p-B),U=C+S,p=U-C,lf[2]=C-(U-p)+(S-p),lf[3]=U;let j=Nee(4,lf),J=Lee*o;if(j>=J||-j>=J||(p=n-P,a=n-(P+p)+(p-r),p=t-F,u=t-(F+p)+(p-r),p=e-V,l=e-(V+p)+(p-s),p=i-H,A=i-(H+p)+(p-s),a===0&&l===0&&u===0&&A===0)||(J=Dee*o+Ree*Math.abs(j),j+=P*A+H*a-(V*u+F*l),j>=J||-j>=J))return j;R=a*H,g=As*a,v=g-(g-a),y=a-v,g=As*H,b=g-(g-H),w=H-b,D=y*w-(R-v*b-y*b-v*w),B=l*F,g=As*l,v=g-(g-l),y=l-v,g=As*F,b=g-(g-F),w=F-b,L=y*w-(B-v*b-y*b-v*w),S=D-L,p=D-S,Cs[0]=D-(S+p)+(p-L),C=R+S,p=C-R,E=R-(C-p)+(S-p),S=E-B,p=E-S,Cs[1]=E-(S+p)+(p-B),U=C+S,p=U-C,Cs[2]=C-(U-p)+(S-p),Cs[3]=U;const Z=ev(4,lf,4,Cs,qS);R=P*A,g=As*P,v=g-(g-P),y=P-v,g=As*A,b=g-(g-A),w=A-b,D=y*w-(R-v*b-y*b-v*w),B=V*u,g=As*V,v=g-(g-V),y=V-v,g=As*u,b=g-(g-u),w=u-b,L=y*w-(B-v*b-y*b-v*w),S=D-L,p=D-S,Cs[0]=D-(S+p)+(p-L),C=R+S,p=C-R,E=R-(C-p)+(S-p),S=E-B,p=E-S,Cs[1]=E-(S+p)+(p-B),U=C+S,p=U-C,Cs[2]=C-(U-p)+(S-p),Cs[3]=U;const W=ev(Z,qS,4,Cs,GS);R=a*A,g=As*a,v=g-(g-a),y=a-v,g=As*A,b=g-(g-A),w=A-b,D=y*w-(R-v*b-y*b-v*w),B=l*u,g=As*l,v=g-(g-l),y=l-v,g=As*u,b=g-(g-u),w=u-b,L=y*w-(B-v*b-y*b-v*w),S=D-L,p=D-S,Cs[0]=D-(S+p)+(p-L),C=R+S,p=C-R,E=R-(C-p)+(S-p),S=E-B,p=E-S,Cs[1]=E-(S+p)+(p-B),U=C+S,p=U-C,Cs[2]=C-(U-p)+(S-p),Cs[3]=U;const K=ev(W,GS,4,Cs,HS);return HS[K-1]}function W0(n,e,t,i,r,s){const o=(e-s)*(t-r),a=(n-r)*(i-s),l=o-a,u=Math.abs(o+a);return Math.abs(l)>=Pee*u?l:-Iee(n,e,t,i,r,s,u)}const WS=Math.pow(2,-52),Ym=new Uint32Array(512);class Kd{static from(e,t=kee,i=Vee){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=e[o];s[2*o]=t(a),s[2*o+1]=i(a)}return new Kd(s)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const i=Math.max(2*t-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=e.length>>1;let a=1/0,l=1/0,u=-1/0,A=-1/0;for(let P=0;P<o;P++){const F=e[2*P],V=e[2*P+1];F<a&&(a=F),V<l&&(l=V),F>u&&(u=F),V>A&&(A=V),this._ids[P]=P}const p=(a+u)/2,g=(l+A)/2;let v,y,b;for(let P=0,F=1/0;P<o;P++){const V=tv(p,g,e[2*P],e[2*P+1]);V<F&&(v=P,F=V)}const w=e[2*v],S=e[2*v+1];for(let P=0,F=1/0;P<o;P++){if(P===v)continue;const V=tv(w,S,e[2*P],e[2*P+1]);V<F&&V>0&&(y=P,F=V)}let C=e[2*y],E=e[2*y+1],R=1/0;for(let P=0;P<o;P++){if(P===v||P===y)continue;const F=Uee(w,S,C,E,e[2*P],e[2*P+1]);F<R&&(b=P,R=F)}let D=e[2*b],B=e[2*b+1];if(R===1/0){for(let V=0;V<o;V++)this._dists[V]=e[2*V]-e[0]||e[2*V+1]-e[1];Lf(this._ids,this._dists,0,o-1);const P=new Uint32Array(o);let F=0;for(let V=0,H=-1/0;V<o;V++){const j=this._ids[V],J=this._dists[j];J>H&&(P[F++]=j,H=J)}this.hull=P.subarray(0,F),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(W0(w,S,C,E,D,B)<0){const P=y,F=C,V=E;y=b,C=D,E=B,b=P,D=F,B=V}const L=Oee(w,S,C,E,D,B);this._cx=L.x,this._cy=L.y;for(let P=0;P<o;P++)this._dists[P]=tv(e[2*P],e[2*P+1],L.x,L.y);Lf(this._ids,this._dists,0,o-1),this._hullStart=v;let U=3;i[v]=t[b]=y,i[y]=t[v]=b,i[b]=t[y]=v,r[v]=0,r[y]=1,r[b]=2,s.fill(-1),s[this._hashKey(w,S)]=v,s[this._hashKey(C,E)]=y,s[this._hashKey(D,B)]=b,this.trianglesLen=0,this._addTriangle(v,y,b,-1,-1,-1);for(let P=0,F,V;P<this._ids.length;P++){const H=this._ids[P],j=e[2*H],J=e[2*H+1];if(P>0&&Math.abs(j-F)<=WS&&Math.abs(J-V)<=WS||(F=j,V=J,H===v||H===y||H===b))continue;let Z=0;for(let ge=0,de=this._hashKey(j,J);ge<this._hashSize&&(Z=s[(de+ge)%this._hashSize],!(Z!==-1&&Z!==i[Z]));ge++);Z=t[Z];let W=Z,K;for(;K=i[W],W0(j,J,e[2*W],e[2*W+1],e[2*K],e[2*K+1])>=0;)if(W=K,W===Z){W=-1;break}if(W===-1)continue;let ee=this._addTriangle(W,H,i[W],-1,-1,r[W]);r[H]=this._legalize(ee+2),r[W]=ee,U++;let se=i[W];for(;K=i[se],W0(j,J,e[2*se],e[2*se+1],e[2*K],e[2*K+1])<0;)ee=this._addTriangle(se,H,K,r[H],-1,r[se]),r[H]=this._legalize(ee+2),i[se]=se,U--,se=K;if(W===Z)for(;K=t[W],W0(j,J,e[2*K],e[2*K+1],e[2*W],e[2*W+1])<0;)ee=this._addTriangle(K,H,W,-1,r[W],r[K]),this._legalize(ee+2),r[K]=ee,i[W]=W,U--,W=K;this._hullStart=t[H]=W,i[W]=t[se]=H,i[H]=se,s[this._hashKey(j,J)]=H,s[this._hashKey(e[2*W],e[2*W+1])]=W}this.hull=new Uint32Array(U);for(let P=0,F=this._hullStart;P<U;P++)this.hull[P]=F,F=i[F];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(Bee(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[e],l=e-e%3;if(o=l+(e+2)%3,a===-1){if(s===0)break;e=Ym[--s];continue}const u=a-a%3,A=l+(e+1)%3,p=u+(a+2)%3,g=t[o],v=t[e],y=t[A],b=t[p];if(Fee(r[2*g],r[2*g+1],r[2*v],r[2*v+1],r[2*y],r[2*y+1],r[2*b],r[2*b+1])){t[e]=b,t[a]=g;const S=i[p];if(S===-1){let E=this._hullStart;do{if(this._hullTri[E]===p){this._hullTri[E]=e;break}E=this._hullPrev[E]}while(E!==this._hullStart)}this._link(e,S),this._link(a,i[o]),this._link(o,p);const C=u+(a+1)%3;s<Ym.length&&(Ym[s++]=C)}else{if(s===0)break;e=Ym[--s]}}return o}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function Bee(n,e){const t=n/(Math.abs(n)+Math.abs(e));return(e>0?3-t:1+t)/4}function tv(n,e,t,i){const r=n-t,s=e-i;return r*r+s*s}function Fee(n,e,t,i,r,s,o,a){const l=n-o,u=e-a,A=t-o,p=i-a,g=r-o,v=s-a,y=l*l+u*u,b=A*A+p*p,w=g*g+v*v;return l*(p*w-b*v)-u*(A*w-b*g)+y*(A*v-p*g)<0}function Uee(n,e,t,i,r,s){const o=t-n,a=i-e,l=r-n,u=s-e,A=o*o+a*a,p=l*l+u*u,g=.5/(o*u-a*l),v=(u*A-a*p)*g,y=(o*p-l*A)*g;return v*v+y*y}function Oee(n,e,t,i,r,s){const o=t-n,a=i-e,l=r-n,u=s-e,A=o*o+a*a,p=l*l+u*u,g=.5/(o*u-a*l),v=n+(u*A-a*p)*g,y=e+(o*p-l*A)*g;return{x:v,y}}function Lf(n,e,t,i){if(i-t<=20)for(let r=t+1;r<=i;r++){const s=n[r],o=e[s];let a=r-1;for(;a>=t&&e[n[a]]>o;)n[a+1]=n[a--];n[a+1]=s}else{const r=t+i>>1;let s=t+1,o=i;g0(n,r,s),e[n[t]]>e[n[i]]&&g0(n,t,i),e[n[s]]>e[n[i]]&&g0(n,s,i),e[n[t]]>e[n[s]]&&g0(n,t,s);const a=n[s],l=e[a];for(;;){do s++;while(e[n[s]]<l);do o--;while(e[n[o]]>l);if(o<s)break;g0(n,s,o)}n[t+1]=n[o],n[o]=a,i-s+1>=o-t?(Lf(n,e,s,i),Lf(n,e,t,o-1)):(Lf(n,e,t,o-1),Lf(n,e,s,i))}}function g0(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function kee(n){return n[0]}function Vee(n){return n[1]}function zee(n,e){var t,i,r=0,s,o,a,l,u,A,p,g=n[0],v=n[1],y=e.length;for(t=0;t<y;t++){i=0;var b=e[t],w=b.length-1;if(A=b[0],A[0]!==b[w][0]&&A[1]!==b[w][1])throw new Error("First and last coordinates in a ring must be the same");for(o=A[0]-g,a=A[1]-v,i;i<w;i++){if(p=b[i+1],l=p[0]-g,u=p[1]-v,a===0&&u===0){if(l<=0&&o>=0||o<=0&&l>=0)return 0}else if(u>=0&&a<=0||u<=0&&a>=0){if(s=W0(o,l,a,u,0,0),s===0)return 0;(s>0&&u>0&&a<=0||s<0&&u<=0&&a>0)&&r++}A=p,a=u,o=l}}return r%2!==0}function qee(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Gee(n){return n.type==="Feature"?n.geometry:n}function Hee(n,e,t={}){if(!n)throw new Error("point is required");if(!e)throw new Error("polygon is required");const i=qee(n),r=Gee(e),s=r.type,o=e.bbox;let a=r.coordinates;if(o&&Wee(i,o)===!1)return!1;s==="Polygon"&&(a=[a]);let l=!1;for(var u=0;u<a.length;++u){const A=zee(i,a[u]);if(A===0)return!t.ignoreBoundary;A&&(l=!0)}return l}function Wee(n,e){return e[0]<=n[0]&&e[1]<=n[1]&&e[2]>=n[0]&&e[3]>=n[1]}var $ee=Hee;const $S=1e-6;class Xc{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,i){e=+e,t=+t,i=+i;const r=e+i,s=t;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>$S||Math.abs(this._y1-s)>$S)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${e-i},${t}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(e,t,i,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class gx{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class jee{constructor(e,[t,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(t=+t))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=r,this.xmin=t,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:i},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let b=0,w=0,S=i.length,C,E;b<S;b+=3,w+=2){const R=i[b]*2,D=i[b+1]*2,B=i[b+2]*2,L=e[R],U=e[R+1],P=e[D],F=e[D+1],V=e[B],H=e[B+1],j=P-L,J=F-U,Z=V-L,W=H-U,K=(j*W-J*Z)*2;if(Math.abs(K)<1e-9){if(s===void 0){s=o=0;for(const se of t)s+=e[se*2],o+=e[se*2+1];s/=t.length,o/=t.length}const ee=1e9*Math.sign((s-L)*W-(o-U)*Z);C=(L+V)/2-ee*W,E=(U+H)/2+ee*Z}else{const ee=1/K,se=j*j+J*J,ge=Z*Z+W*W;C=L+(W*se-J*ge)*ee,E=U+(j*ge-Z*se)*ee}a[w]=C,a[w+1]=E}let l=t[t.length-1],u,A=l*4,p,g=e[2*l],v,y=e[2*l+1];r.fill(0);for(let b=0;b<t.length;++b)l=t[b],u=A,p=g,v=y,A=l*4,g=e[2*l],y=e[2*l+1],r[u+2]=r[A]=v-y,r[u+3]=r[A+1]=g-p}render(e){const t=e==null?e=new Xc:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let A=0,p=i.length;A<p;++A){const g=i[A];if(g<A)continue;const v=Math.floor(A/3)*2,y=Math.floor(g/3)*2,b=o[v],w=o[v+1],S=o[y],C=o[y+1];this._renderSegment(b,w,S,C,e)}let l,u=s[s.length-1];for(let A=0;A<s.length;++A){l=u,u=s[A];const p=Math.floor(r[u]/3)*2,g=o[p],v=o[p+1],y=l*4,b=this._project(g,v,a[y+2],a[y+3]);b&&this._renderSegment(g,v,b[0],b[1],e)}return t&&t.value()}renderBounds(e){const t=e==null?e=new Xc:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const i=t==null?t=new Xc:void 0,r=this._clip(e);if(r===null||!r.length)return;t.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&t.lineTo(r[o],r[o+1]);return t.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,i=e.length/2;t<i;++t){const r=this.cellPolygon(t);r&&(r.index=t,yield r)}}cellPolygon(e){const t=new gx;return this.renderCell(e,t),t.value()}_renderSegment(e,t,i,r,s){let o;const a=this._regioncode(e,t),l=this._regioncode(i,r);a===0&&l===0?(s.moveTo(e,t),s.lineTo(i,r)):(o=this._clipSegment(e,t,i,r,a,l))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(e,t,i){return t=+t,t!==t||(i=+i,i!==i)?!1:this.delaunay._step(e,t,i)===e}*neighbors(e){const t=this._clip(e);if(t)for(const i of this.delaunay.neighbors(e)){const r=this._clip(i);if(r){e:for(let s=0,o=t.length;s<o;s+=2)for(let a=0,l=r.length;a<l;a+=2)if(t[s]===r[a]&&t[s+1]===r[a+1]&&t[(s+2)%o]===r[(a+l-2)%l]&&t[(s+3)%o]===r[(a+l-1)%l]){yield i;break e}}}}_cell(e){const{circumcenters:t,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[e];if(o===-1)return null;const a=[];let l=o;do{const u=Math.floor(l/3);if(a.push(t[u*2],t[u*2+1]),l=l%3===2?l-2:l+1,s[l]!==e)break;l=r[l]}while(l!==o&&l!==-1);return a}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(t===null)return null;const{vectors:i}=this,r=e*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(e,t,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(e,t))}_clipFinite(e,t){const i=t.length;let r=null,s,o,a=t[i-2],l=t[i-1],u,A=this._regioncode(a,l),p,g=0;for(let v=0;v<i;v+=2)if(s=a,o=l,a=t[v],l=t[v+1],u=A,A=this._regioncode(a,l),u===0&&A===0)p=g,g=0,r?r.push(a,l):r=[a,l];else{let y,b,w,S,C;if(u===0){if((y=this._clipSegment(s,o,a,l,u,A))===null)continue;[b,w,S,C]=y}else{if((y=this._clipSegment(a,l,s,o,A,u))===null)continue;[S,C,b,w]=y,p=g,g=this._edgecode(b,w),p&&g&&this._edge(e,p,g,r,r.length),r?r.push(b,w):r=[b,w]}p=g,g=this._edgecode(S,C),p&&g&&this._edge(e,p,g,r,r.length),r?r.push(S,C):r=[S,C]}if(r)p=g,g=this._edgecode(r[0],r[1]),p&&g&&this._edge(e,p,g,r,r.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(e,t,i,r,s,o){const a=s<o;for(a&&([e,t,i,r,s,o]=[i,r,e,t,o,s]);;){if(s===0&&o===0)return a?[i,r,e,t]:[e,t,i,r];if(s&o)return null;let l,u,A=s||o;A&8?(l=e+(i-e)*(this.ymax-t)/(r-t),u=this.ymax):A&4?(l=e+(i-e)*(this.ymin-t)/(r-t),u=this.ymin):A&2?(u=t+(r-t)*(this.xmax-e)/(i-e),l=this.xmax):(u=t+(r-t)*(this.xmin-e)/(i-e),l=this.xmin),s?(e=l,t=u,s=this._regioncode(e,t)):(i=l,r=u,o=this._regioncode(i,r))}}_clipInfinite(e,t,i,r,s,o){let a=Array.from(t),l;if((l=this._project(a[0],a[1],i,r))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(l[0],l[1]),a=this._clipFinite(e,a))for(let u=0,A=a.length,p,g=this._edgecode(a[A-2],a[A-1]);u<A;u+=2)p=g,g=this._edgecode(a[u],a[u+1]),p&&g&&(u=this._edge(e,p,g,a,u),A=a.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(e,t,i,r,s){for(;t!==i;){let o,a;switch(t){case 5:t=4;continue;case 4:t=6,o=this.xmax,a=this.ymin;break;case 6:t=2;continue;case 2:t=10,o=this.xmax,a=this.ymax;break;case 10:t=8;continue;case 8:t=9,o=this.xmin,a=this.ymax;break;case 9:t=1;continue;case 1:t=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(e,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(e,t,i,r){let s=1/0,o,a,l;if(r<0){if(t<=this.ymin)return null;(o=(this.ymin-t)/r)<s&&(l=this.ymin,a=e+(s=o)*i)}else if(r>0){if(t>=this.ymax)return null;(o=(this.ymax-t)/r)<s&&(l=this.ymax,a=e+(s=o)*i)}if(i>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/i)<s&&(a=this.xmax,l=t+(s=o)*r)}else if(i<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/i)<s&&(a=this.xmin,l=t+(s=o)*r)}return[a,l]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const i=(t+2)%e.length,r=(t+4)%e.length;(e[t]===e[i]&&e[i]===e[r]||e[t+1]===e[i+1]&&e[i+1]===e[r+1])&&(e.splice(i,2),t-=2)}e.length||(e=null)}return e}}const Xee=2*Math.PI,uf=Math.pow;function Qee(n){return n[0]}function Yee(n){return n[1]}function Zee(n){const{triangles:e,coords:t}=n;for(let i=0;i<e.length;i+=3){const r=2*e[i],s=2*e[i+1],o=2*e[i+2];if((t[o]-t[r])*(t[s+1]-t[r+1])-(t[s]-t[r])*(t[o+1]-t[r+1])>1e-10)return!1}return!0}function Kee(n,e,t){return[n+Math.sin(n+e)*t,e+Math.cos(n-e)*t]}class db{static from(e,t=Qee,i=Yee,r){return new db("length"in e?Jee(e,t,i,r):Float64Array.from(ete(e,t,i,r)))}constructor(e){this._delaunator=new Kd(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&Zee(e)){this.collinear=Int32Array.from({length:t.length/2},(g,v)=>v).sort((g,v)=>t[2*g]-t[2*v]||t[2*g+1]-t[2*v+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],A=[t[2*l],t[2*l+1],t[2*u],t[2*u+1]],p=1e-8*Math.hypot(A[3]-A[1],A[2]-A[0]);for(let g=0,v=t.length/2;g<v;++g){const y=Kee(t[2*g],t[2*g+1],p);t[2*g]=y[0],t[2*g+1]=y[1]}this._delaunator=new Kd(t)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=i.length;l<u;++l){const A=s[l%3===2?l-2:l+1];(i[l]===-1||o[A]===-1)&&(o[A]=l)}for(let l=0,u=r.length;l<u;++l)a[r[l]]=l;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(e){return new jee(this,e)}*neighbors(e){const{inedges:t,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const p=a.indexOf(e);p>0&&(yield a[p-1]),p<a.length-1&&(yield a[p+1]);return}const l=t[e];if(l===-1)return;let u=l,A=-1;do{if(yield A=o[u],u=u%3===2?u-2:u+1,o[u]!==e)return;if(u=s[u],u===-1){const p=i[(r[e]+1)%i.length];p!==A&&(yield p);return}}while(u!==l)}find(e,t,i=0){if(e=+e,e!==e||(t=+t,t!==t))return-1;const r=i;let s;for(;(s=this._step(i,e,t))>=0&&s!==i&&s!==r;)i=s;return s}_step(e,t,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:l,points:u}=this;if(r[e]===-1||!u.length)return(e+1)%(u.length>>1);let A=e,p=uf(t-u[e*2],2)+uf(i-u[e*2+1],2);const g=r[e];let v=g;do{let y=l[v];const b=uf(t-u[y*2],2)+uf(i-u[y*2+1],2);if(b<p&&(p=b,A=y),v=v%3===2?v-2:v+1,l[v]!==e)break;if(v=a[v],v===-1){if(v=s[(o[e]+1)%s.length],v!==y&&uf(t-u[v*2],2)+uf(i-u[v*2+1],2)<p)return v;break}}while(v!==g);return A}render(e){const t=e==null?e=new Xc:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l<o)continue;const u=s[o]*2,A=s[l]*2;e.moveTo(i[u],i[u+1]),e.lineTo(i[A],i[A+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){t===void 0&&(!e||typeof e.moveTo!="function")&&(t=e,e=null),t=t==null?2:+t;const i=e==null?e=new Xc:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],l=r[s+1];e.moveTo(a+t,l),e.arc(a,l,t,0,Xee)}return i&&i.value()}renderHull(e){const t=e==null?e=new Xc:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;e.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const l=2*i[a];e.lineTo(r[l],r[l+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new gx;return this.renderHull(e),e.value()}renderTriangle(e,t){const i=t==null?t=new Xc:void 0,{points:r,triangles:s}=this,o=s[e*=3]*2,a=s[e+1]*2,l=s[e+2]*2;return t.moveTo(r[o],r[o+1]),t.lineTo(r[a],r[a+1]),t.lineTo(r[l],r[l+1]),t.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,i=e.length/3;t<i;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new gx;return this.renderTriangle(e,t),t.value()}}function Jee(n,e,t,i){const r=n.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=n[o];s[o*2]=e.call(i,a,o,n),s[o*2+1]=t.call(i,a,o,n)}return s}function*ete(n,e,t,i){let r=0;for(const s of n)yield e.call(i,s,r,n),yield t.call(i,s,r,n),++r}const pb=Math.PI,jS=pb/2,XS=180/pb,QS=pb/180,tte=Math.atan2,YS=Math.cos,nte=Math.max,ite=Math.min,ZS=Math.sin,rte=Math.sign||function(n){return n>0?1:n<0?-1:0},iR=Math.sqrt;function ste(n){return n>1?jS:n<-1?-jS:Math.asin(n)}function rR(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Eo(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function Yg(n,e){return[n[0]+e[0],n[1]+e[1],n[2]+e[2]]}function Zg(n){var e=iR(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);return[n[0]/e,n[1]/e,n[2]/e]}function mb(n){return[tte(n[1],n[0])*XS,ste(nte(-1,ite(1,n[2])))*XS]}function al(n){const e=n[0]*QS,t=n[1]*QS,i=YS(t);return[i*YS(e),i*ZS(e),ZS(t)]}function gb(n){return n=n.map(e=>al(e)),rR(n[0],Eo(n[2],n[1]))}function ote(n){const e=lte(n),t=cte(e),i=ute(t,n),r=fte(t,n.length),s=ate(r,n),o=hte(t,n),{polygons:a,centers:l}=Ate(o,t,n),u=dte(a),A=mte(t,n),p=pte(i,t);return{delaunay:e,edges:i,triangles:t,centers:l,neighbors:r,polygons:a,mesh:u,hull:A,urquhart:p,find:s}}function ate(n,e){function t(i,r){let s=i[0]-r[0],o=i[1]-r[1],a=i[2]-r[2];return s*s+o*o+a*a}return function(r,s,o){o===void 0&&(o=0);let a,l,u=o;const A=al([r,s]);do a=o,o=null,l=t(A,al(e[a])),n[a].forEach(p=>{let g=t(A,al(e[p]));if(g<l){l=g,o=p,u=p;return}});while(o!==null);return u}}function lte(n){if(n.length<2)return{};let e=0;for(;isNaN(n[e][0]+n[e][1])&&e++<n.length;);const t=QZ(n[e]),i=CK().translate([0,0]).scale(1).rotate(t.invert([180,0]));n=n.map(i);const r=[];let s=1;for(let p=0,g=n.length;p<g;p++){let v=n[p][0]**2+n[p][1]**2;!isFinite(v)||v>1e32?r.push(p):v>s&&(s=v)}const o=1e6*iR(s);r.forEach(p=>n[p]=[o,0]),n.push([0,o]),n.push([-o,0]),n.push([0,-o]);const a=db.from(n);a.projection=i;const{triangles:l,halfedges:u,inedges:A}=a;for(let p=0,g=u.length;p<g;p++)if(u[p]<0){const v=p%3==2?p-2:p+1,y=p%3==0?p+2:p-1,b=u[v],w=u[y];u[b]=w,u[w]=b,u[v]=u[y]=-1,l[p]=l[v]=l[y]=e,A[l[b]]=b%3==0?b+2:b-1,A[l[w]]=w%3==0?w+2:w-1,p+=2-p%3}else l[p]>n.length-3-1&&(l[p]=e);return a}function ute(n,e){const t=new Set;return e.length===2?[[0,1]]:(n.forEach(i=>{if(i[0]!==i[1]&&!(gb(i.map(r=>e[r]))<0))for(let r=0,s;r<3;r++)s=(r+1)%3,t.add(Tg([i[r],i[s]]).join("-"))}),Array.from(t,i=>i.split("-").map(Number)))}function cte(n){const{triangles:e}=n;if(!e)return[];const t=[];for(let i=0,r=e.length/3;i<r;i++){const s=e[3*i],o=e[3*i+1],a=e[3*i+2];s!==o&&o!==a&&t.push([s,a,o])}return t}function hte(n,e){return n.map(t=>{const i=t.map(s=>e[s]).map(al),r=Yg(Yg(Eo(i[1],i[0]),Eo(i[2],i[1])),Eo(i[0],i[2]));return mb(Zg(r))})}function fte(n,e){const t=[];return n.forEach(i=>{for(let r=0;r<3;r++){const s=i[r],o=i[(r+1)%3];t[s]=t[s]||[],t[s].push(o)}}),n.length===0&&(e===2?(t[0]=[1],t[1]=[0]):e===1&&(t[0]=[])),t}function Ate(n,e,t){const i=[],r=n.slice();if(e.length===0){if(t.length<2)return{polygons:i,centers:r};if(t.length===2){const a=al(t[0]),l=al(t[1]),u=Zg(Yg(a,l)),A=Zg(Eo(a,l)),p=Eo(u,A),g=[u,Eo(u,p),Eo(Eo(u,p),p),Eo(Eo(Eo(u,p),p),p)].map(mb).map(o);return i.push(g),i.push(g.slice().reverse()),{polygons:i,centers:r}}}e.forEach((a,l)=>{for(let u=0;u<3;u++){const A=a[u],p=a[(u+1)%3],g=a[(u+2)%3];i[A]=i[A]||[],i[A].push([p,g,l,[A,p,g]])}});const s=i.map(a=>{const l=[a[0][2]];let u=a[0][1];for(let A=1;A<a.length;A++)for(let p=0;p<a.length;p++)if(a[p][0]==u){u=a[p][1],l.push(a[p][2]);break}if(l.length>2)return l;if(l.length==2){const A=KS(t[a[0][3][0]],t[a[0][3][1]],r[l[0]]),p=KS(t[a[0][3][2]],t[a[0][3][0]],r[l[0]]),g=o(A),v=o(p);return[l[0],v,l[1],g]}});function o(a){let l=-1;return r.slice(e.length,1/0).forEach((u,A)=>{u[0]===a[0]&&u[1]===a[1]&&(l=A+e.length)}),l<0&&(l=r.length,r.push(a)),l}return{polygons:s,centers:r}}function KS(n,e,t){n=al(n),e=al(e),t=al(t);const i=rte(rR(Eo(e,n),t));return mb(Zg(Yg(n,e)).map(r=>i*r))}function dte(n){const e=[];return n.forEach(t=>{if(!t)return;let i=t[t.length-1];for(let r of t)r>i&&e.push([i,r]),i=r}),e}function pte(n,e){return function(t){const i=new Map,r=new Map;return n.forEach((s,o)=>{const a=s.join("-");i.set(a,t[o]),r.set(a,!0)}),e.forEach(s=>{let o=0,a=-1;for(let l=0;l<3;l++){let u=Tg([s[l],s[(l+1)%3]]).join("-");i.get(u)>o&&(o=i.get(u),a=u)}r.set(a,!1)}),n.map(s=>r.get(s.join("-")))}}function mte(n,e){const t=new Set,i=[];n.map(a=>{if(!(gb(a.map(l=>e[l>e.length?0:l]))>1e-12))for(let l=0;l<3;l++){let u=[a[l],a[(l+1)%3]],A=`${u[0]}-${u[1]}`;t.has(A)?t.delete(A):t.add(`${u[1]}-${u[0]}`)}});const r=new Map;let s;if(t.forEach(a=>{a=a.split("-").map(Number),r.set(a[0],a[1]),s=a[0]}),s===void 0)return i;let o=s;do{i.push(o);let a=r.get(o);r.set(o,-1),o=a}while(o>-1&&o!==s);return i}function gte(n){const e=function(t){if(e.delaunay=null,e._data=t,typeof e._data=="object"&&e._data.type==="FeatureCollection"&&(e._data=e._data.features),typeof e._data=="object"){const i=e._data.map(r=>[e._vx(r),e._vy(r),r]).filter(r=>isFinite(r[0]+r[1]));e.points=i.map(r=>[r[0],r[1]]),e.valid=i.map(r=>r[2]),e.delaunay=ote(e.points)}return e};return e._vx=function(t){if(typeof t=="object"&&"type"in t)return uS(t)[0];if(0 in t)return t[0]},e._vy=function(t){if(typeof t=="object"&&"type"in t)return uS(t)[1];if(1 in t)return t[1]},e.x=function(t){return t?(e._vx=t,e):e._vx},e.y=function(t){return t?(e._vy=t,e):e._vy},e.polygons=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const i={type:"FeatureCollection",features:[]};return e.valid.length===0||(e.delaunay.polygons.forEach((r,s)=>i.features.push({type:"Feature",geometry:r?{type:"Polygon",coordinates:[[...r,r[0]].map(o=>e.delaunay.centers[o])]}:null,properties:{site:e.valid[s],sitecoordinates:e.points[s],neighbours:e.delaunay.neighbors[s]}})),e.valid.length===1&&i.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:e.valid[0],sitecoordinates:e.points[0],neighbours:[]}})),i},e.triangles=function(t){return t!==void 0&&e(t),e.delaunay?{type:"FeatureCollection",features:e.delaunay.triangles.map((i,r)=>(i=i.map(s=>e.points[s]),i.center=e.delaunay.centers[r],i)).filter(i=>gb(i)>0).map(i=>({type:"Feature",properties:{circumcenter:i.center},geometry:{type:"Polygon",coordinates:[[...i,i[0]]]}}))}:!1},e.links=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const i=e.delaunay.edges.map(s=>ec(e.points[s[0]],e.points[s[1]])),r=e.delaunay.urquhart(i);return{type:"FeatureCollection",features:e.delaunay.edges.map((s,o)=>({type:"Feature",properties:{source:e.valid[s[0]],target:e.valid[s[1]],length:i[o],urquhart:!!r[o]},geometry:{type:"LineString",coordinates:[e.points[s[0]],e.points[s[1]]]}}))}},e.mesh=function(t){return t!==void 0&&e(t),e.delaunay?{type:"MultiLineString",coordinates:e.delaunay.edges.map(i=>[e.points[i[0]],e.points[i[1]]])}:!1},e.cellMesh=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const{centers:i,polygons:r}=e.delaunay,s=[];for(const o of r)if(o)for(let a=o.length,l=o[a-1],u=o[0],A=0;A<a;l=u,u=o[++A])u>l&&s.push([i[l],i[u]]);return{type:"MultiLineString",coordinates:s}},e._found=void 0,e.find=function(t,i,r){if(e._found=e.delaunay.find(t,i,e._found),!r||ec([t,i],e.points[e._found])<r)return e._found},e.hull=function(t){t!==void 0&&e(t);const i=e.delaunay.hull,r=e.points;return i.length===0?null:{type:"Polygon",coordinates:[[...i.map(s=>r[s]),r[i[0]]]]}},n?e(n):e}function _x(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function _te(n){if(Array.isArray(n))return n}function vte(n){if(Array.isArray(n))return _x(n)}function yte(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function xte(n,e,t){return e=Kg(e),Rte(n,sR()?Reflect.construct(e,[],Kg(n).constructor):e.apply(n,t))}function bte(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Tte(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function Kg(n){return Kg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Kg(n)}function Ste(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&vx(n,e)}function sR(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sR=function(){return!!n})()}function wte(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Mte(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Ete(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rte(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yte(n)}function vx(n,e){return vx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},vx(n,e)}function el(n,e){return _te(n)||Mte(n,e)||oR(n,e)||Ete()}function nv(n){return vte(n)||wte(n)||oR(n)||Cte()}function oR(n,e){if(n){if(typeof n=="string")return _x(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_x(n,e):void 0}}function Nte(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.resolution,i=t===void 0?1/0:t,r=Pte(n,i),s=Hd(r),o=Lte(n,i),a=[].concat(nv(s),nv(o)),l={type:"Polygon",coordinates:n},u=MC(l),A=el(u,2),p=el(A[0],2),g=p[0],v=p[1],y=el(A[1],2),b=y[0],w=y[1],S=g>b||w>=89||v<=-89,C=[];if(S){var E=gte(a).triangles(),R=new Map(a.map(function(K,ee){var se=el(K,2),ge=se[0],de=se[1];return["".concat(ge,"-").concat(de),ee]}));E.features.forEach(function(K){var ee,se=K.geometry.coordinates[0].slice(0,3).reverse(),ge=[];if(se.forEach(function(Ae){var Be=el(Ae,2),ye=Be[0],De=Be[1],We="".concat(ye,"-").concat(De);R.has(We)&&ge.push(R.get(We))}),ge.length===3){if(ge.some(function(Ae){return Ae<s.length})){var de=K.properties.circumcenter;if(!yx(de,l,S))return}(ee=C).push.apply(ee,ge)}})}else if(o.length)for(var P=Kd.from(a),F=function(ee){var se,ge=[2,1,0].map(function(Be){return P.triangles[ee+Be]}),de=ge.map(function(Be){return a[Be]});if(ge.some(function(Be){return Be<s.length})){var Ae=[0,1].map(function(Be){return qY(de,function(ye){return ye[Be]})});if(!yx(Ae,l,S))return 1}(se=C).push.apply(se,nv(ge))},V=0,H=P.triangles.length;V<H;V+=3)F(V);else{var D=$g(r),B=D.vertices,L=D.holes,U=L===void 0?[]:L;C=KK(B,U,2)}var j=tu(Tg(a,function(K){return K[0]}),[0,1]),J=tu(Tg(a,function(K){return K[1]}),[0,1]),Z=a.map(function(K){var ee=el(K,2),se=ee[0],ge=ee[1];return[j(se),J(ge)]}),W={points:a,indices:C,uvs:Z};return{contour:r,triangles:W}}function Pte(n,e){return n.map(function(t){var i=[],r;return t.forEach(function(s){if(r){var o=ec(s,r)*180/Math.PI;if(o>e)for(var a=lb(r,s),l=1/Math.ceil(o/e),u=l;u<1;)i.push(a(u)),u+=l}i.push(r=s)}),i})}function Lte(n,e){var t={type:"Polygon",coordinates:n},i=MC(t),r=el(i,2),s=el(r[0],2),o=s[0],a=s[1],l=el(r[1],2),u=l[0],A=l[1];if(Math.min(Math.abs(u-o),Math.abs(A-a))<e)return[];var p=o>u||A>=89||a<=-89;return Dte(e,{minLng:o,maxLng:u,minLat:a,maxLat:A}).filter(function(g){return yx(g,t,p)})}function Dte(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.minLng,i=e.maxLng,r=e.minLat,s=e.maxLat,o=Math.round(Math.pow(360/n,2)/Math.PI),a=(1+Math.sqrt(5))/2,l=function(S){return S/a*360%360-180},u=function(S){return Math.acos(2*S/o-1)/Math.PI*180-90},A=function(S){return o*(Math.cos((S+90)*Math.PI/180)+1)/2},p=[s!==void 0?Math.ceil(A(s)):0,r!==void 0?Math.floor(A(r)):o-1],g=t===void 0&&i===void 0?function(){return!0}:t===void 0?function(w){return w<=i}:i===void 0?function(w){return w>=t}:i>=t?function(w){return w>=t&&w<=i}:function(w){return w>=t||w<=i},v=[],y=p[0];y<=p[1];y++){var b=l(y);g(b)&&v.push([b,u(y)])}return v}function yx(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?fK(e,n):$ee(n,e)}var j1=window.THREE?window.THREE:{BufferGeometry:pi,Float32BufferAttribute:ri},JS=new j1.BufferGeometry().setAttribute?"setAttribute":"addAttribute",_b=function(n){function e(t,i,r,s,o,a,l){var u;bte(this,e),u=xte(this,e),u.type="ConicPolygonGeometry",u.parameters={polygonGeoJson:t,bottomHeight:i,topHeight:r,closedBottom:s,closedTop:o,includeSides:a,curvatureResolution:l},i=i||0,r=r||1,s=s!==void 0?s:!0,o=o!==void 0?o:!0,a=a!==void 0?a:!0,l=l||5;var A=Nte(t,{resolution:l}),p=A.contour,g=A.triangles,v=Hd(g.uvs),y=[],b=[],w=[],S=0,C=function(L){var U=Math.round(y.length/3),P=w.length;y=y.concat(L.vertices),b=b.concat(L.uvs),w=w.concat(U?L.indices.map(function(F){return F+U}):L.indices),u.addGroup(P,w.length-P,S++)};a&&C(R()),s&&C(D(i,!1)),o&&C(D(r,!0)),u.setIndex(w),u[JS]("position",new j1.Float32BufferAttribute(y,3)),u[JS]("uv",new j1.Float32BufferAttribute(b,2)),u.computeVertexNormals();function E(B,L){var U=typeof L=="function"?L:function(){return L},P=B.map(function(F){return F.map(function(V){var H=el(V,2),j=H[0],J=H[1];return Ite(J,j,U(j,J))})});return $g(P)}function R(){for(var B=E(p,i),L=B.vertices,U=B.holes,P=E(p,r),F=P.vertices,V=Hd([F,L]),H=Math.round(F.length/3),j=new Set(U),J=0,Z=[],W=0;W<H;W++){var K=W+1;if(K===H)K=J;else if(j.has(K)){var ee=K;K=J,J=ee}Z.push(W,W+H,K+H),Z.push(K+H,K,W)}for(var se=[],ge=1;ge>=0;ge--)for(var de=0;de<H;de+=1)se.push(de/(H-1),ge);return{indices:Z,vertices:V,uvs:se}}function D(B){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{indices:L?g.indices:g.indices.slice().reverse(),vertices:E([g.points],B).vertices,uvs:v}}return u}return Ste(e,n),Tte(e)}(j1.BufferGeometry);function Ite(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180;return[t*Math.sin(i)*Math.cos(r),t*Math.cos(i),t*Math.sin(i)*Math.sin(r)]}function xx(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function Bte(n){if(Array.isArray(n))return n}function Fte(n){if(Array.isArray(n))return xx(n)}function Ute(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Ote(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function kte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zte(n,e){if(n==null)return{};var t,i,r=qte(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function qte(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.includes(i))continue;t[i]=n[i]}return t}function Gte(n,e){return Bte(n)||Ote(n,e)||aR(n,e)||kte()}function Hte(n){return Fte(n)||Ute(n)||aR(n)||Vte()}function Wte(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function $te(n){var e=Wte(n,"string");return typeof e=="symbol"?e:e+""}function aR(n,e){if(n){if(typeof n=="string")return xx(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?xx(n,e):void 0}}var jte=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(a){return{keyAccessor:a,isProp:!(a instanceof Function)}}),s=n.reduce(function(a,l){var u=a,A=l;return r.forEach(function(p,g){var v=p.keyAccessor,y=p.isProp,b;if(y){var w=A,S=w[v],C=zte(w,[v].map($te));b=S,A=C}else b=v(A,g);g+1<r.length?(u.hasOwnProperty(b)||(u[b]={}),u=u[b]):t?(u.hasOwnProperty(b)||(u[b]=[]),u[b].push(A)):u[b]=A}),a},{});t instanceof Function&&function a(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;u===r.length?Object.keys(l).forEach(function(A){return l[A]=t(l[A])}):Object.values(l).forEach(function(A){return a(A,u+1)})}(s);var o=s;return i&&(o=[],function a(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];u.length===r.length?o.push({keys:u,vals:l}):Object.entries(l).forEach(function(A){var p=Gte(A,2),g=p[0],v=p[1];return a(v,[].concat(Hte(u),[g]))})}(s),e instanceof Array&&e.length===0&&o.length===1&&(o[0].keys=[])),o},Xn=function(n){n=n||{};var e=typeof n<"u"?n:{},t={},i;for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);var r="";function s(ke){return e.locateFile?e.locateFile(ke,r):r+ke}var o;typeof document<"u"&&document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",o=function(it,pt,et){var c=new XMLHttpRequest;c.open("GET",it,!0),c.responseType="arraybuffer",c.onload=function(){if(c.status==200||c.status==0&&c.response){pt(c.response);return}var dn=kt(it);if(dn){pt(dn.buffer);return}et()},c.onerror=et,c.send(null)};var a=e.print||console.log.bind(console),l=e.printErr||console.warn.bind(console);for(i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);t=null,e.arguments&&e.arguments;var u=0,A=function(ke){u=ke},p=function(){return u},g=8;function v(ke,it,pt,et){switch(pt=pt||"i8",pt.charAt(pt.length-1)==="*"&&(pt="i32"),pt){case"i1":H[ke>>0]=it;break;case"i8":H[ke>>0]=it;break;case"i16":J[ke>>1]=it;break;case"i32":Z[ke>>2]=it;break;case"i64":Le=[it>>>0,(xe=it,+le(xe)>=1?xe>0?(pe(+Te(xe/4294967296),4294967295)|0)>>>0:~~+G((xe-+(~~xe>>>0))/4294967296)>>>0:0)],Z[ke>>2]=Le[0],Z[ke+4>>2]=Le[1];break;case"float":W[ke>>2]=it;break;case"double":K[ke>>3]=it;break;default:Wn("invalid type for setValue: "+pt)}}function y(ke,it,pt){switch(it=it||"i8",it.charAt(it.length-1)==="*"&&(it="i32"),it){case"i1":return H[ke>>0];case"i8":return H[ke>>0];case"i16":return J[ke>>1];case"i32":return Z[ke>>2];case"i64":return Z[ke>>2];case"float":return W[ke>>2];case"double":return K[ke>>3];default:Wn("invalid type for getValue: "+it)}return null}var b=!1;function w(ke,it){ke||Wn("Assertion failed: "+it)}function S(ke){var it=e["_"+ke];return w(it,"Cannot call unknown function "+ke+", make sure it is exported"),it}function C(ke,it,pt,et,c){var X={string:function(qt){var cn=0;if(qt!=null&&qt!==0){var mo=(qt.length<<2)+1;cn=je(mo),U(qt,cn,mo)}return cn},array:function(qt){var cn=je(qt.length);return P(qt,cn),cn}};function dn(qt){return it==="string"?B(qt):it==="boolean"?!!qt:qt}var Nn=S(ke),Kn=[],an=0;if(et)for(var ht=0;ht<et.length;ht++){var tr=X[pt[ht]];tr?(an===0&&(an=Pt()),Kn[ht]=tr(et[ht])):Kn[ht]=et[ht]}var un=Nn.apply(null,Kn);return un=dn(un),an!==0&&q(an),un}function E(ke,it,pt,et){pt=pt||[];var c=pt.every(function(dn){return dn==="number"}),X=it!=="string";return X&&c&&!et?S(ke):function(){return C(ke,it,pt,arguments)}}var R=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function D(ke,it,pt){for(var et=it+pt,c=it;ke[c]&&!(c>=et);)++c;if(c-it>16&&ke.subarray&&R)return R.decode(ke.subarray(it,c));for(var X="";it<c;){var dn=ke[it++];if(!(dn&128)){X+=String.fromCharCode(dn);continue}var Nn=ke[it++]&63;if((dn&224)==192){X+=String.fromCharCode((dn&31)<<6|Nn);continue}var Kn=ke[it++]&63;if((dn&240)==224?dn=(dn&15)<<12|Nn<<6|Kn:dn=(dn&7)<<18|Nn<<12|Kn<<6|ke[it++]&63,dn<65536)X+=String.fromCharCode(dn);else{var an=dn-65536;X+=String.fromCharCode(55296|an>>10,56320|an&1023)}}return X}function B(ke,it){return ke?D(j,ke,it):""}function L(ke,it,pt,et){if(!(et>0))return 0;for(var c=pt,X=pt+et-1,dn=0;dn<ke.length;++dn){var Nn=ke.charCodeAt(dn);if(Nn>=55296&&Nn<=57343){var Kn=ke.charCodeAt(++dn);Nn=65536+((Nn&1023)<<10)|Kn&1023}if(Nn<=127){if(pt>=X)break;it[pt++]=Nn}else if(Nn<=2047){if(pt+1>=X)break;it[pt++]=192|Nn>>6,it[pt++]=128|Nn&63}else if(Nn<=65535){if(pt+2>=X)break;it[pt++]=224|Nn>>12,it[pt++]=128|Nn>>6&63,it[pt++]=128|Nn&63}else{if(pt+3>=X)break;it[pt++]=240|Nn>>18,it[pt++]=128|Nn>>12&63,it[pt++]=128|Nn>>6&63,it[pt++]=128|Nn&63}}return it[pt]=0,pt-c}function U(ke,it,pt){return L(ke,j,it,pt)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function P(ke,it){H.set(ke,it)}function F(ke,it){return ke%it>0&&(ke+=it-ke%it),ke}var V,H,j,J,Z,W,K;function ee(ke){V=ke,e.HEAP8=H=new Int8Array(ke),e.HEAP16=J=new Int16Array(ke),e.HEAP32=Z=new Int32Array(ke),e.HEAPU8=j=new Uint8Array(ke),e.HEAPU16=new Uint16Array(ke),e.HEAPU32=new Uint32Array(ke),e.HEAPF32=W=new Float32Array(ke),e.HEAPF64=K=new Float64Array(ke)}var se=5271520,ge=28608,de=e.TOTAL_MEMORY||33554432;e.buffer?V=e.buffer:V=new ArrayBuffer(de),de=V.byteLength,ee(V),Z[ge>>2]=se;function Ae(ke){for(;ke.length>0;){var it=ke.shift();if(typeof it=="function"){it();continue}var pt=it.func;typeof pt=="number"?it.arg===void 0?e.dynCall_v(pt):e.dynCall_vi(pt,it.arg):pt(it.arg===void 0?null:it.arg)}}var Be=[],ye=[],De=[],We=[];function $e(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)gt(e.preRun.shift());Ae(Be)}function Ke(){Ae(ye)}function Xe(){Ae(De)}function st(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)ae(e.postRun.shift());Ae(We)}function gt(ke){Be.unshift(ke)}function ae(ke){We.unshift(ke)}var le=Math.abs,G=Math.ceil,Te=Math.floor,pe=Math.min,me=0,ve=null;function qe(ke){me++,e.monitorRunDependencies&&e.monitorRunDependencies(me)}function Me(ke){if(me--,e.monitorRunDependencies&&e.monitorRunDependencies(me),me==0&&ve){var it=ve;ve=null,it()}}e.preloadedImages={},e.preloadedAudios={};var $=null,z="data:application/octet-stream;base64,";function fe(ke){return String.prototype.startsWith?ke.startsWith(z):ke.indexOf(z)===0}var xe,Le;$="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Ne=28624;function ot(ke,it,pt,et){Wn("Assertion failed: "+B(ke)+", at: "+[it?B(it):"unknown filename",pt,et?B(et):"unknown function"])}function Qe(){return H.length}function xt(ke,it,pt){j.set(j.subarray(it,it+pt),ke)}function bt(ke){return e.___errno_location&&(Z[e.___errno_location()>>2]=ke),ke}function nt(ke){Wn("OOM")}function At(ke){try{var it=new ArrayBuffer(ke);return it.byteLength!=ke?void 0:(new Int8Array(it).set(H),Mt(it),ee(it),1)}catch{}}function Dt(ke){var it=Qe(),pt=16777216,et=2147483648-pt;if(ke>et)return!1;for(var c=16777216,X=Math.max(it,c);X<ke;)X<=536870912?X=F(2*X,pt):X=Math.min(F((3*X+2147483648)/4,pt),et);var dn=At(X);return!!dn}var Ot=typeof atob=="function"?atob:function(ke){var it="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",pt="",et,c,X,dn,Nn,Kn,an,ht=0;ke=ke.replace(/[^A-Za-z0-9\+\/\=]/g,"");do dn=it.indexOf(ke.charAt(ht++)),Nn=it.indexOf(ke.charAt(ht++)),Kn=it.indexOf(ke.charAt(ht++)),an=it.indexOf(ke.charAt(ht++)),et=dn<<2|Nn>>4,c=(Nn&15)<<4|Kn>>2,X=(Kn&3)<<6|an,pt=pt+String.fromCharCode(et),Kn!==64&&(pt=pt+String.fromCharCode(c)),an!==64&&(pt=pt+String.fromCharCode(X));while(ht<ke.length);return pt};function dt(ke){try{for(var it=Ot(ke),pt=new Uint8Array(it.length),et=0;et<it.length;++et)pt[et]=it.charCodeAt(et);return pt}catch{throw new Error("Converting base64 string to bytes failed.")}}function kt(ke){if(fe(ke))return dt(ke.slice(z.length))}var Lt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},$t={b:A,c:p,d:ot,e:bt,f:Qe,g:xt,h:Dt,i:nt,o:Ne,p:ge},ie=function(ke,it,pt){"almost asm";var et=new ke.Int8Array(pt),c=new ke.Int32Array(pt);new ke.Uint8Array(pt),new ke.Float32Array(pt);var X=new ke.Float64Array(pt),dn=it.o|0,Nn=it.p|0,Kn=ke.Math.floor,an=ke.Math.abs,ht=ke.Math.sqrt,tr=ke.Math.pow,un=ke.Math.cos,qt=ke.Math.sin,cn=ke.Math.tan,mo=ke.Math.acos,Oa=ke.Math.asin,ne=ke.Math.atan,Re=ke.Math.atan2,Ve=ke.Math.ceil,Ge=ke.Math.imul,Fe=ke.Math.min,Tt=ke.Math.max,Nt=ke.Math.clz32,lt=it.b,Y=it.c,mt=it.d,ln=it.e,Qt=it.f,Bn=it.g,zn=it.h,Li=it.i,Q=28640;function qn(h){return et=new Int8Array(h),c=new Int32Array(h),X=new Float64Array(h),pt=h,!0}function Yt(h){h=h|0;var f=0;return f=Q,Q=Q+h|0,Q=Q+15&-16,f|0}function Di(){return Q|0}function jn(h){h=h|0,Q=h}function Qr(h,f){h=h|0,Q=h}function Ws(h,f){h=h|0,f=f|0;var d=0,m=0,_=0;return(h|0)<0?(f=2,f|0):(h|0)>13780509?(f=$_(15,f)|0,f|0):(d=((h|0)<0)<<31>>31,_=us(h|0,d|0,3,0)|0,m=Y()|0,d=rn(h|0,d|0,1,0)|0,d=us(_|0,m|0,d|0,Y()|0)|0,d=rn(d|0,Y()|0,1,0)|0,h=Y()|0,c[f>>2]=d,c[f+4>>2]=h,f=0,f|0)}function Ar(h,f,d,m){return h=h|0,f=f|0,d=d|0,m=m|0,$s(h,f,d,m,0)|0}function $s(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0;if(N=Q,Q=Q+16|0,T=N,!(si(h,f,d,m,_)|0))return m=0,Q=N,m|0;do if((d|0)>=0){if((d|0)>13780509){if(x=$_(15,T)|0,x|0)break;M=T,T=c[M>>2]|0,M=c[M+4>>2]|0}else x=((d|0)<0)<<31>>31,I=us(d|0,x|0,3,0)|0,M=Y()|0,x=rn(d|0,x|0,1,0)|0,x=us(I|0,M|0,x|0,Y()|0)|0,x=rn(x|0,Y()|0,1,0)|0,M=Y()|0,c[T>>2]=x,c[T+4>>2]=M,T=x;if(mc(m|0,0,T<<3|0)|0,_|0){mc(_|0,0,T<<2|0)|0,x=Ii(h,f,d,m,_,T,M,0)|0;break}x=Go(T,4)|0,x?(I=Ii(h,f,d,m,x,T,M,0)|0,hn(x),x=I):x=13}else x=2;while(!1);return I=x,Q=N,I|0}function si(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0;if(be=Q,Q=Q+16|0,ue=be,ce=be+8|0,he=ue,c[he>>2]=h,c[he+4>>2]=f,(d|0)<0)return ce=2,Q=be,ce|0;if(x=m,c[x>>2]=h,c[x+4>>2]=f,x=(_|0)!=0,x&&(c[_>>2]=0),yi(h,f)|0)return ce=9,Q=be,ce|0;c[ce>>2]=0;e:do if((d|0)>=1)if(x)for(k=1,I=0,te=0,he=1,x=h;;){if(!(I|te)){if(x=ei(x,f,4,ce,ue)|0,x|0)break e;if(f=ue,x=c[f>>2]|0,f=c[f+4>>2]|0,yi(x,f)|0){x=9;break e}}if(x=ei(x,f,c[26800+(te<<2)>>2]|0,ce,ue)|0,x|0)break e;if(f=ue,x=c[f>>2]|0,f=c[f+4>>2]|0,h=m+(k<<3)|0,c[h>>2]=x,c[h+4>>2]=f,c[_+(k<<2)>>2]=he,h=I+1|0,T=(h|0)==(he|0),M=te+1|0,N=(M|0)==6,yi(x,f)|0){x=9;break e}if(he=he+(N&T&1)|0,(he|0)>(d|0)){x=0;break}else k=k+1|0,I=T?0:h,te=T?N?0:M:te}else for(k=1,I=0,te=0,he=1,x=h;;){if(!(I|te)){if(x=ei(x,f,4,ce,ue)|0,x|0)break e;if(f=ue,x=c[f>>2]|0,f=c[f+4>>2]|0,yi(x,f)|0){x=9;break e}}if(x=ei(x,f,c[26800+(te<<2)>>2]|0,ce,ue)|0,x|0)break e;if(f=ue,x=c[f>>2]|0,f=c[f+4>>2]|0,h=m+(k<<3)|0,c[h>>2]=x,c[h+4>>2]=f,h=I+1|0,T=(h|0)==(he|0),M=te+1|0,N=(M|0)==6,yi(x,f)|0){x=9;break e}if(he=he+(N&T&1)|0,(he|0)>(d|0)){x=0;break}else k=k+1|0,I=T?0:h,te=T?N?0:M:te}else x=0;while(!1);return ce=x,Q=be,ce|0}function Ii(h,f,d,m,_,x,T,M){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0,x=x|0,T=T|0,M=M|0;var N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0;if(be=Q,Q=Q+16|0,ue=be+8|0,ce=be,N=Uh(h|0,f|0,x|0,T|0)|0,k=Y()|0,te=m+(N<<3)|0,Pe=te,He=c[Pe>>2]|0,Pe=c[Pe+4>>2]|0,I=(He|0)==(h|0)&(Pe|0)==(f|0),!((He|0)==0&(Pe|0)==0|I))do N=rn(N|0,k|0,1,0)|0,N=Fh(N|0,Y()|0,x|0,T|0)|0,k=Y()|0,te=m+(N<<3)|0,He=te,Pe=c[He>>2]|0,He=c[He+4>>2]|0,I=(Pe|0)==(h|0)&(He|0)==(f|0);while(!((Pe|0)==0&(He|0)==0|I));if(N=_+(N<<2)|0,I&&(c[N>>2]|0)<=(M|0)||(He=te,c[He>>2]=h,c[He+4>>2]=f,c[N>>2]=M,(M|0)>=(d|0)))return He=0,Q=be,He|0;switch(I=M+1|0,c[ue>>2]=0,N=ei(h,f,2,ue,ce)|0,N|0){case 9:{he=9;break}case 0:{N=ce,N=Ii(c[N>>2]|0,c[N+4>>2]|0,d,m,_,x,T,I)|0,N||(he=9);break}}e:do if((he|0)==9){switch(c[ue>>2]=0,N=ei(h,f,3,ue,ce)|0,N|0){case 9:break;case 0:{if(N=ce,N=Ii(c[N>>2]|0,c[N+4>>2]|0,d,m,_,x,T,I)|0,N|0)break e;break}default:break e}switch(c[ue>>2]=0,N=ei(h,f,1,ue,ce)|0,N|0){case 9:break;case 0:{if(N=ce,N=Ii(c[N>>2]|0,c[N+4>>2]|0,d,m,_,x,T,I)|0,N|0)break e;break}default:break e}switch(c[ue>>2]=0,N=ei(h,f,5,ue,ce)|0,N|0){case 9:break;case 0:{if(N=ce,N=Ii(c[N>>2]|0,c[N+4>>2]|0,d,m,_,x,T,I)|0,N|0)break e;break}default:break e}switch(c[ue>>2]=0,N=ei(h,f,4,ue,ce)|0,N|0){case 9:break;case 0:{if(N=ce,N=Ii(c[N>>2]|0,c[N+4>>2]|0,d,m,_,x,T,I)|0,N|0)break e;break}default:break e}switch(c[ue>>2]=0,N=ei(h,f,6,ue,ce)|0,N|0){case 9:break;case 0:{if(N=ce,N=Ii(c[N>>2]|0,c[N+4>>2]|0,d,m,_,x,T,I)|0,N|0)break e;break}default:break e}return He=0,Q=be,He|0}while(!1);return He=N,Q=be,He|0}function ei(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0;if(d>>>0>6)return _=1,_|0;if(te=(c[m>>2]|0)%6|0,c[m>>2]=te,(te|0)>0){x=0;do d=Ac(d)|0,x=x+1|0;while((x|0)<(c[m>>2]|0))}if(te=ct(h|0,f|0,45)|0,Y()|0,k=te&127,k>>>0>121)return _=5,_|0;N=js(h,f)|0,x=ct(h|0,f|0,52)|0,Y()|0,x=x&15;e:do if(!x)I=8;else{for(;;){if(T=(15-x|0)*3|0,M=ct(h|0,f|0,T|0)|0,Y()|0,M=M&7,(M|0)==7){f=5;break}if(ce=(zo(x)|0)==0,x=x+-1|0,he=St(7,0,T|0)|0,f=f&~(Y()|0),ue=St(c[(ce?432:16)+(M*28|0)+(d<<2)>>2]|0,0,T|0)|0,T=Y()|0,d=c[(ce?640:224)+(M*28|0)+(d<<2)>>2]|0,h=ue|h&~he,f=T|f,!d){d=0;break e}if(!x){I=8;break e}}return f|0}while(!1);(I|0)==8&&(ce=c[848+(k*28|0)+(d<<2)>>2]|0,ue=St(ce|0,0,45)|0,h=ue|h,f=Y()|0|f&-1040385,d=c[4272+(k*28|0)+(d<<2)>>2]|0,(ce&127|0)==127&&(ce=St(c[848+(k*28|0)+20>>2]|0,0,45)|0,f=Y()|0|f&-1040385,d=c[4272+(k*28|0)+20>>2]|0,h=dc(ce|h,f)|0,f=Y()|0,c[m>>2]=(c[m>>2]|0)+1)),M=ct(h|0,f|0,45)|0,Y()|0,M=M&127;e:do if(Mi(M)|0){t:do if((js(h,f)|0)==1){if((k|0)!=(M|0))if(H5(M,c[7696+(k*28|0)>>2]|0)|0){h=V_(h,f)|0,T=1,f=Y()|0;break}else mt(27795,26864,436,26872);switch(N|0){case 3:{h=dc(h,f)|0,f=Y()|0,c[m>>2]=(c[m>>2]|0)+1,T=0;break t}case 5:{h=V_(h,f)|0,f=Y()|0,c[m>>2]=(c[m>>2]|0)+5,T=0;break t}case 0:return ce=9,ce|0;default:return ce=1,ce|0}}else T=0;while(!1);if((d|0)>0){x=0;do h=k_(h,f)|0,f=Y()|0,x=x+1|0;while((x|0)!=(d|0))}if((k|0)!=(M|0)){if(!(E_(M)|0)){if((T|0)!=0|(js(h,f)|0)!=5)break;c[m>>2]=(c[m>>2]|0)+1;break}switch(te&127){case 8:case 118:break e}(js(h,f)|0)!=3&&(c[m>>2]=(c[m>>2]|0)+1)}}else if((d|0)>0){x=0;do h=dc(h,f)|0,f=Y()|0,x=x+1|0;while((x|0)!=(d|0))}while(!1);return c[m>>2]=((c[m>>2]|0)+d|0)%6|0,ce=_,c[ce>>2]=h,c[ce+4>>2]=f,ce=0,ce|0}function dr(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0;for(M=Q,Q=Q+16|0,x=M,T=M+8|0,_=(yi(h,f)|0)==0,_=_?1:2;;){if(c[T>>2]=0,I=(ei(h,f,_,T,x)|0)==0,N=x,I&((c[N>>2]|0)==(d|0)?(c[N+4>>2]|0)==(m|0):0)){h=4;break}if(_=_+1|0,_>>>0>=7){_=7,h=4;break}}return(h|0)==4?(Q=M,_|0):0}function Ur(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0;if(ce=Q,Q=Q+16|0,he=ce,ue=ce+8|0,te=he,c[te>>2]=h,c[te+4>>2]=f,!d)return ue=m,c[ue>>2]=h,c[ue+4>>2]=f,ue=0,Q=ce,ue|0;c[ue>>2]=0;e:do if(yi(h,f)|0)h=9;else{if(x=(d|0)>0,x){_=0,te=h;do{if(h=ei(te,f,4,ue,he)|0,h|0)break e;if(f=he,te=c[f>>2]|0,f=c[f+4>>2]|0,_=_+1|0,yi(te,f)|0){h=9;break e}}while((_|0)<(d|0));if(k=m,c[k>>2]=te,c[k+4>>2]=f,k=d+-1|0,x){I=0,h=1;do{if(_=26800+(I<<2)|0,(I|0)==5)for(T=c[_>>2]|0,x=0,_=h;;){if(h=he,h=ei(c[h>>2]|0,c[h+4>>2]|0,T,ue,he)|0,h|0)break e;if((x|0)!=(k|0))if(N=he,M=c[N>>2]|0,N=c[N+4>>2]|0,h=m+(_<<3)|0,c[h>>2]=M,c[h+4>>2]=N,!(yi(M,N)|0))h=_+1|0;else{h=9;break e}else h=_;if(x=x+1|0,(x|0)>=(d|0))break;_=h}else for(T=he,N=c[_>>2]|0,M=0,_=h,x=c[T>>2]|0,T=c[T+4>>2]|0;;){if(h=ei(x,T,N,ue,he)|0,h|0)break e;if(T=he,x=c[T>>2]|0,T=c[T+4>>2]|0,h=m+(_<<3)|0,c[h>>2]=x,c[h+4>>2]=T,h=_+1|0,yi(x,T)|0){h=9;break e}if(M=M+1|0,(M|0)>=(d|0))break;_=h}I=I+1|0}while(I>>>0<6);h=he,T=te,_=c[h>>2]|0,x=f,h=c[h+4>>2]|0}else T=te,_=te,x=f,h=f}else T=m,c[T>>2]=h,c[T+4>>2]=f,T=h,_=h,x=f,h=f;h=(T|0)==(_|0)&(x|0)==(h|0)?0:9}while(!1);return ue=h,Q=ce,ue|0}function cc(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0;if(M=Q,Q=Q+48|0,_=M+16|0,x=M+8|0,T=M,d=JA(d)|0,d|0)return T=d,Q=M,T|0;if(I=h,N=c[I+4>>2]|0,d=x,c[d>>2]=c[I>>2],c[d+4>>2]=N,p8(x,_),d=X5(_,f,T)|0,!d){if(f=c[x>>2]|0,x=c[h+8>>2]|0,(x|0)>0){_=c[h+12>>2]|0,d=0;do f=(c[_+(d<<3)>>2]|0)+f|0,d=d+1|0;while((d|0)<(x|0))}d=T,_=c[d>>2]|0,d=c[d+4>>2]|0,x=((f|0)<0)<<31>>31,(d|0)<(x|0)|(d|0)==(x|0)&_>>>0<f>>>0?(d=T,c[d>>2]=f,c[d+4>>2]=x,d=x):f=_,N=rn(f|0,d|0,12,0)|0,I=Y()|0,d=T,c[d>>2]=N,c[d+4>>2]=I,d=m,c[d>>2]=N,c[d+4>>2]=I,d=0}return I=d,Q=M,I|0}function Vo(h,f,d,m,_,x,T){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0,x=x|0,T=T|0;var M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0,vt=0,Ht=0,Vt=0,gn=0,xn=0,On=0,fn=0,Wt=0,_t=0,Dn=0,mi=0,Mn=0,gi=0,Ms=0,R8=0;if(mi=Q,Q=Q+64|0,fn=mi+48|0,Wt=mi+32|0,_t=mi+24|0,vt=mi+8|0,Ht=mi,N=c[h>>2]|0,(N|0)<=0)return Dn=0,Q=mi,Dn|0;for(Vt=h+4|0,gn=fn+8|0,xn=Wt+8|0,On=vt+8|0,M=0,Ue=0;;){I=c[Vt>>2]|0,ze=I+(Ue<<4)|0,c[fn>>2]=c[ze>>2],c[fn+4>>2]=c[ze+4>>2],c[fn+8>>2]=c[ze+8>>2],c[fn+12>>2]=c[ze+12>>2],(Ue|0)==(N+-1|0)?(c[Wt>>2]=c[I>>2],c[Wt+4>>2]=c[I+4>>2],c[Wt+8>>2]=c[I+8>>2],c[Wt+12>>2]=c[I+12>>2]):(ze=I+(Ue+1<<4)|0,c[Wt>>2]=c[ze>>2],c[Wt+4>>2]=c[ze+4>>2],c[Wt+8>>2]=c[ze+8>>2],c[Wt+12>>2]=c[ze+12>>2]),N=QI(fn,Wt,m,_t)|0;e:do if(N)I=0,M=N;else if(N=_t,I=c[N>>2]|0,N=c[N+4>>2]|0,(N|0)>0|(N|0)==0&I>>>0>0){He=0,ze=0;t:for(;;){if(gi=1/(+(I>>>0)+4294967296*+(N|0)),R8=+X[fn>>3],N=Yr(I|0,N|0,He|0,ze|0)|0,Ms=+(N>>>0)+4294967296*+(Y()|0),Mn=+(He>>>0)+4294967296*+(ze|0),X[vt>>3]=gi*(R8*Ms)+gi*(+X[Wt>>3]*Mn),X[On>>3]=gi*(+X[gn>>3]*Ms)+gi*(+X[xn>>3]*Mn),N=z_(vt,m,Ht)|0,N|0){M=N;break}Pe=Ht,be=c[Pe>>2]|0,Pe=c[Pe+4>>2]|0,he=Uh(be|0,Pe|0,f|0,d|0)|0,k=Y()|0,N=T+(he<<3)|0,te=N,I=c[te>>2]|0,te=c[te+4>>2]|0;n:do if((I|0)==0&(te|0)==0)Se=N,Dn=16;else for(ue=0,ce=0;;){if((ue|0)>(d|0)|(ue|0)==(d|0)&ce>>>0>f>>>0){M=1;break t}if((I|0)==(be|0)&(te|0)==(Pe|0))break n;if(N=rn(he|0,k|0,1,0)|0,he=Fh(N|0,Y()|0,f|0,d|0)|0,k=Y()|0,ce=rn(ce|0,ue|0,1,0)|0,ue=Y()|0,N=T+(he<<3)|0,te=N,I=c[te>>2]|0,te=c[te+4>>2]|0,(I|0)==0&(te|0)==0){Se=N,Dn=16;break}}while(!1);if((Dn|0)==16&&(Dn=0,!((be|0)==0&(Pe|0)==0))&&(ce=Se,c[ce>>2]=be,c[ce+4>>2]=Pe,ce=x+(c[_>>2]<<3)|0,c[ce>>2]=be,c[ce+4>>2]=Pe,ce=_,ce=rn(c[ce>>2]|0,c[ce+4>>2]|0,1,0)|0,be=Y()|0,Pe=_,c[Pe>>2]=ce,c[Pe+4>>2]=be),He=rn(He|0,ze|0,1,0)|0,ze=Y()|0,N=_t,I=c[N>>2]|0,N=c[N+4>>2]|0,!((N|0)>(ze|0)|(N|0)==(ze|0)&I>>>0>He>>>0)){I=1;break e}}I=0}else I=1;while(!1);if(Ue=Ue+1|0,!I){Dn=21;break}if(N=c[h>>2]|0,(Ue|0)>=(N|0)){M=0,Dn=21;break}}return(Dn|0)==21?(Q=mi,M|0):0}function S_(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0,vt=0,Ht=0,Vt=0,gn=0,xn=0,On=0,fn=0,Wt=0,_t=0,Dn=0,mi=0,Mn=0,gi=0,Ms=0;if(Ms=Q,Q=Q+112|0,Dn=Ms+80|0,N=Ms+72|0,mi=Ms,Mn=Ms+56|0,_=JA(d)|0,_|0)return gi=_,Q=Ms,gi|0;if(I=h+8|0,gi=ka((c[I>>2]<<5)+32|0)|0,!gi)return gi=13,Q=Ms,gi|0;if(Q_(h,gi),_=JA(d)|0,!_){if(Wt=h,_t=c[Wt+4>>2]|0,_=N,c[_>>2]=c[Wt>>2],c[_+4>>2]=_t,p8(N,Dn),_=X5(Dn,f,mi)|0,_)Wt=0,_t=0;else{if(_=c[N>>2]|0,x=c[I>>2]|0,(x|0)>0){T=c[h+12>>2]|0,d=0;do _=(c[T+(d<<3)>>2]|0)+_|0,d=d+1|0;while((d|0)!=(x|0));d=_}else d=_;_=mi,x=c[_>>2]|0,_=c[_+4>>2]|0,T=((d|0)<0)<<31>>31,(_|0)<(T|0)|(_|0)==(T|0)&x>>>0<d>>>0?(_=mi,c[_>>2]=d,c[_+4>>2]=T,_=T):d=x,Wt=rn(d|0,_|0,12,0)|0,_t=Y()|0,_=mi,c[_>>2]=Wt,c[_+4>>2]=_t,_=0}if(!_){if(d=Go(Wt,8)|0,!d)return hn(gi),gi=13,Q=Ms,gi|0;if(M=Go(Wt,8)|0,!M)return hn(gi),hn(d),gi=13,Q=Ms,gi|0;On=Dn,c[On>>2]=0,c[On+4>>2]=0,On=h,fn=c[On+4>>2]|0,_=N,c[_>>2]=c[On>>2],c[_+4>>2]=fn,_=Vo(N,Wt,_t,f,Dn,d,M)|0;e:do if(_)hn(d),hn(M),hn(gi);else{t:do if((c[I>>2]|0)>0){for(T=h+12|0,x=0;_=Vo((c[T>>2]|0)+(x<<3)|0,Wt,_t,f,Dn,d,M)|0,x=x+1|0,!(_|0);)if((x|0)>=(c[I>>2]|0))break t;hn(d),hn(M),hn(gi);break e}while(!1);(_t|0)>0|(_t|0)==0&Wt>>>0>0&&mc(M|0,0,Wt<<3|0)|0,fn=Dn,On=c[fn+4>>2]|0;t:do if((On|0)>0|(On|0)==0&(c[fn>>2]|0)>>>0>0){Vt=d,gn=M,xn=d,On=M,fn=d,_=d,Se=d,vt=M,Ht=M,d=M;n:for(;;){for(Pe=0,He=0,ze=0,Ue=0,x=0,T=0;;){M=mi,N=M+56|0;do c[M>>2]=0,M=M+4|0;while((M|0)<(N|0));if(f=Vt+(Pe<<3)|0,I=c[f>>2]|0,f=c[f+4>>2]|0,si(I,f,1,mi,0)|0){M=mi,N=M+56|0;do c[M>>2]=0,M=M+4|0;while((M|0)<(N|0));M=Go(7,4)|0,M|0&&(Ii(I,f,1,mi,M,7,0,0)|0,hn(M))}for(be=0;;){ce=mi+(be<<3)|0,ue=c[ce>>2]|0,ce=c[ce+4>>2]|0;i:do if((ue|0)==0&(ce|0)==0)M=x,N=T;else{if(k=Uh(ue|0,ce|0,Wt|0,_t|0)|0,I=Y()|0,M=m+(k<<3)|0,f=M,N=c[f>>2]|0,f=c[f+4>>2]|0,!((N|0)==0&(f|0)==0)){te=0,he=0;do{if((te|0)>(_t|0)|(te|0)==(_t|0)&he>>>0>Wt>>>0)break n;if((N|0)==(ue|0)&(f|0)==(ce|0)){M=x,N=T;break i}M=rn(k|0,I|0,1,0)|0,k=Fh(M|0,Y()|0,Wt|0,_t|0)|0,I=Y()|0,he=rn(he|0,te|0,1,0)|0,te=Y()|0,M=m+(k<<3)|0,f=M,N=c[f>>2]|0,f=c[f+4>>2]|0}while(!((N|0)==0&(f|0)==0))}if((ue|0)==0&(ce|0)==0){M=x,N=T;break}pc(ue,ce,Mn)|0,Y_(h,gi,Mn)|0&&(he=rn(x|0,T|0,1,0)|0,T=Y()|0,te=M,c[te>>2]=ue,c[te+4>>2]=ce,x=gn+(x<<3)|0,c[x>>2]=ue,c[x+4>>2]=ce,x=he),M=x,N=T}while(!1);if(be=be+1|0,be>>>0>=7)break;x=M,T=N}if(Pe=rn(Pe|0,He|0,1,0)|0,He=Y()|0,ze=rn(ze|0,Ue|0,1,0)|0,Ue=Y()|0,T=Dn,x=c[T>>2]|0,T=c[T+4>>2]|0,(Ue|0)<(T|0)|(Ue|0)==(T|0)&ze>>>0<x>>>0)x=M,T=N;else break}if((T|0)>0|(T|0)==0&x>>>0>0){x=0,T=0;do Ue=Vt+(x<<3)|0,c[Ue>>2]=0,c[Ue+4>>2]=0,x=rn(x|0,T|0,1,0)|0,T=Y()|0,Ue=Dn,ze=c[Ue+4>>2]|0;while((T|0)<(ze|0)|((T|0)==(ze|0)?x>>>0<(c[Ue>>2]|0)>>>0:0))}if(Ue=Dn,c[Ue>>2]=M,c[Ue+4>>2]=N,(N|0)>0|(N|0)==0&M>>>0>0)be=d,Pe=Ht,He=fn,ze=vt,Ue=gn,d=Se,Ht=_,vt=xn,Se=be,_=Pe,fn=On,On=He,xn=ze,gn=Vt,Vt=Ue;else break t}hn(xn),hn(On),hn(gi),_=1;break e}else _=M;while(!1);hn(gi),hn(d),hn(_),_=0}while(!1);return gi=_,Q=Ms,gi|0}}return hn(gi),gi=_,Q=Ms,gi|0}function w_(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0;if(k=Q,Q=Q+176|0,N=k,(f|0)<1)return y8(d,0,0),I=0,Q=k,I|0;for(M=h,M=ct(c[M>>2]|0,c[M+4>>2]|0,52)|0,Y()|0,y8(d,(f|0)>6?f:6,M&15),M=0;m=h+(M<<3)|0,m=Ih(c[m>>2]|0,c[m+4>>2]|0,N)|0,!(m|0);){if(m=c[N>>2]|0,(m|0)>0){T=0;do x=N+8+(T<<4)|0,T=T+1|0,m=N+8+(((T|0)%(m|0)|0)<<4)|0,_=AF(d,m,x)|0,_?T8(d,_)|0:fF(d,x,m)|0,m=c[N>>2]|0;while((T|0)<(m|0))}if(M=M+1|0,(M|0)>=(f|0)){m=0,I=13;break}}return(I|0)==13?(Q=k,m|0):(x8(d),I=m,Q=k,I|0)}function M_(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0;if(x=Q,Q=Q+32|0,m=x,_=x+16|0,h=w_(h,f,_)|0,h|0)return d=h,Q=x,d|0;if(c[d>>2]=0,c[d+4>>2]=0,c[d+8>>2]=0,h=b8(_)|0,h|0)do{f=zB(d)|0;do qB(f,h)|0,T=h+16|0,c[m>>2]=c[T>>2],c[m+4>>2]=c[T+4>>2],c[m+8>>2]=c[T+8>>2],c[m+12>>2]=c[T+12>>2],T8(_,h)|0,h=dF(_,m)|0;while((h|0)!=0);h=b8(_)|0}while((h|0)!=0);return x8(_),h=GB(d)|0,h?(h8(d),T=h,Q=x,T|0):(T=0,Q=x,T|0)}function Mi(h){return h=h|0,h>>>0>121?(h=0,h|0):(h=c[7696+(h*28|0)+16>>2]|0,h|0)}function E_(h){return h=h|0,(h|0)==4|(h|0)==117|0}function G5(h){return h=h|0,c[11120+((c[h>>2]|0)*216|0)+((c[h+4>>2]|0)*72|0)+((c[h+8>>2]|0)*24|0)+(c[h+12>>2]<<3)>>2]|0}function zI(h){return h=h|0,c[11120+((c[h>>2]|0)*216|0)+((c[h+4>>2]|0)*72|0)+((c[h+8>>2]|0)*24|0)+(c[h+12>>2]<<3)+4>>2]|0}function qI(h,f){h=h|0,f=f|0,h=7696+(h*28|0)|0,c[f>>2]=c[h>>2],c[f+4>>2]=c[h+4>>2],c[f+8>>2]=c[h+8>>2],c[f+12>>2]=c[h+12>>2]}function GI(h,f){h=h|0,f=f|0;var d=0,m=0;if(f>>>0>20)return f=-1,f|0;do if((c[11120+(f*216|0)>>2]|0)!=(h|0))if((c[11120+(f*216|0)+8>>2]|0)!=(h|0))if((c[11120+(f*216|0)+16>>2]|0)!=(h|0))if((c[11120+(f*216|0)+24>>2]|0)!=(h|0))if((c[11120+(f*216|0)+32>>2]|0)!=(h|0))if((c[11120+(f*216|0)+40>>2]|0)!=(h|0))if((c[11120+(f*216|0)+48>>2]|0)!=(h|0))if((c[11120+(f*216|0)+56>>2]|0)!=(h|0))if((c[11120+(f*216|0)+64>>2]|0)!=(h|0))if((c[11120+(f*216|0)+72>>2]|0)!=(h|0))if((c[11120+(f*216|0)+80>>2]|0)!=(h|0))if((c[11120+(f*216|0)+88>>2]|0)!=(h|0))if((c[11120+(f*216|0)+96>>2]|0)!=(h|0))if((c[11120+(f*216|0)+104>>2]|0)!=(h|0))if((c[11120+(f*216|0)+112>>2]|0)!=(h|0))if((c[11120+(f*216|0)+120>>2]|0)!=(h|0))if((c[11120+(f*216|0)+128>>2]|0)!=(h|0))if((c[11120+(f*216|0)+136>>2]|0)==(h|0))h=2,d=1,m=2;else{if((c[11120+(f*216|0)+144>>2]|0)==(h|0)){h=0,d=2,m=0;break}if((c[11120+(f*216|0)+152>>2]|0)==(h|0)){h=0,d=2,m=1;break}if((c[11120+(f*216|0)+160>>2]|0)==(h|0)){h=0,d=2,m=2;break}if((c[11120+(f*216|0)+168>>2]|0)==(h|0)){h=1,d=2,m=0;break}if((c[11120+(f*216|0)+176>>2]|0)==(h|0)){h=1,d=2,m=1;break}if((c[11120+(f*216|0)+184>>2]|0)==(h|0)){h=1,d=2,m=2;break}if((c[11120+(f*216|0)+192>>2]|0)==(h|0)){h=2,d=2,m=0;break}if((c[11120+(f*216|0)+200>>2]|0)==(h|0)){h=2,d=2,m=1;break}if((c[11120+(f*216|0)+208>>2]|0)==(h|0)){h=2,d=2,m=2;break}else h=-1;return h|0}else h=2,d=1,m=1;else h=2,d=1,m=0;else h=1,d=1,m=2;else h=1,d=1,m=1;else h=1,d=1,m=0;else h=0,d=1,m=2;else h=0,d=1,m=1;else h=0,d=1,m=0;else h=2,d=0,m=2;else h=2,d=0,m=1;else h=2,d=0,m=0;else h=1,d=0,m=2;else h=1,d=0,m=1;else h=1,d=0,m=0;else h=0,d=0,m=2;else h=0,d=0,m=1;else h=0,d=0,m=0;while(!1);return f=c[11120+(f*216|0)+(d*72|0)+(h*24|0)+(m<<3)+4>>2]|0,f|0}function H5(h,f){return h=h|0,f=f|0,(c[7696+(h*28|0)+20>>2]|0)==(f|0)?(f=1,f|0):(f=(c[7696+(h*28|0)+24>>2]|0)==(f|0),f|0)}function C_(h,f){return h=h|0,f=f|0,c[848+(h*28|0)+(f<<2)>>2]|0}function R_(h,f){return h=h|0,f=f|0,(c[848+(h*28|0)>>2]|0)==(f|0)?(f=0,f|0):(c[848+(h*28|0)+4>>2]|0)==(f|0)?(f=1,f|0):(c[848+(h*28|0)+8>>2]|0)==(f|0)?(f=2,f|0):(c[848+(h*28|0)+12>>2]|0)==(f|0)?(f=3,f|0):(c[848+(h*28|0)+16>>2]|0)==(f|0)?(f=4,f|0):(c[848+(h*28|0)+20>>2]|0)==(f|0)?(f=5,f|0):((c[848+(h*28|0)+24>>2]|0)==(f|0)?6:7)|0}function HI(){return 122}function WI(h){h=h|0;var f=0,d=0,m=0;f=0;do St(f|0,0,45)|0,m=Y()|0|134225919,d=h+(f<<3)|0,c[d>>2]=-1,c[d+4>>2]=m,f=f+1|0;while((f|0)!=122);return 0}function $I(h){h=h|0;var f=0,d=0,m=0;return m=+X[h+16>>3],d=+X[h+24>>3],f=m-d,+(m<d?f+6.283185307179586:f)}function W5(h){return h=h|0,+X[h+16>>3]<+X[h+24>>3]|0}function jI(h){return h=h|0,+(+X[h>>3]-+X[h+8>>3])}function N_(h,f){h=h|0,f=f|0;var d=0,m=0,_=0;return d=+X[f>>3],!(d>=+X[h+8>>3])||!(d<=+X[h>>3])?(f=0,f|0):(m=+X[h+16>>3],d=+X[h+24>>3],_=+X[f+8>>3],f=_>=d,h=_<=m&1,m<d?f&&(h=1):f||(h=0),f=(h|0)!=0,f|0)}function P_(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0;return+X[h>>3]<+X[f+8>>3]||+X[h+8>>3]>+X[f>>3]?(m=0,m|0):(x=+X[h+16>>3],d=h+24|0,k=+X[d>>3],T=x<k,m=f+16|0,I=+X[m>>3],_=f+24|0,N=+X[_>>3],M=I<N,f=k-I<N-x,h=T?M|f?1:2:0,f=M?T?1:f?2:1:0,x=+go(x,h),x<+go(+X[_>>3],f)||(k=+go(+X[d>>3],h),k>+go(+X[m>>3],f))?(M=0,M|0):(M=1,M|0))}function XI(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0;x=+X[h+16>>3],N=+X[h+24>>3],h=x<N,M=+X[f+16>>3],T=+X[f+24>>3],_=M<T,f=N-M<T-x,c[d>>2]=h?_|f?1:2:0,c[m>>2]=_?h?1:f?2:1:0}function $5(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0;return+X[h>>3]<+X[f>>3]||+X[h+8>>3]>+X[f+8>>3]?(m=0,m|0):(m=h+16|0,N=+X[m>>3],x=+X[h+24>>3],T=N<x,d=f+16|0,k=+X[d>>3],_=f+24|0,I=+X[_>>3],M=k<I,f=x-k<I-N,h=T?M|f?1:2:0,f=M?T?1:f?2:1:0,x=+go(x,h),x<=+go(+X[_>>3],f)?(k=+go(+X[m>>3],h),M=k>=+go(+X[d>>3],f),M|0):(M=0,M|0))}function j5(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0;_=Q,Q=Q+176|0,m=_,c[m>>2]=4,M=+X[f>>3],X[m+8>>3]=M,x=+X[f+16>>3],X[m+16>>3]=x,X[m+24>>3]=M,M=+X[f+24>>3],X[m+32>>3]=M,T=+X[f+8>>3],X[m+40>>3]=T,X[m+48>>3]=M,X[m+56>>3]=T,X[m+64>>3]=x,f=m+72|0,d=f+96|0;do c[f>>2]=0,f=f+4|0;while((f|0)<(d|0));Oh(h|0,m|0,168)|0,Q=_}function X5(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0;ce=Q,Q=Q+288|0,k=ce+264|0,te=ce+96|0,I=ce,M=I,N=M+96|0;do c[M>>2]=0,M=M+4|0;while((M|0)<(N|0));return f=G_(f,I)|0,f|0?(ue=f,Q=ce,ue|0):(N=I,I=c[N>>2]|0,N=c[N+4>>2]|0,pc(I,N,k)|0,Ih(I,N,te)|0,T=+ZA(k,te+8|0),X[k>>3]=+X[h>>3],N=k+8|0,X[N>>3]=+X[h+16>>3],X[te>>3]=+X[h+8>>3],I=te+8|0,X[I>>3]=+X[h+24>>3],_=+ZA(k,te),Pe=+X[N>>3]-+X[I>>3],x=+an(+Pe),be=+X[k>>3]-+X[te>>3],m=+an(+be),!(Pe==0|be==0)&&(Pe=+E8(+x,+m),Pe=+Ve(+(_*_/+Zp(+(Pe/+Zp(+x,+m)),3)/(T*(T*2.59807621135)*.8))),X[dn>>3]=Pe,he=~~Pe>>>0,ue=+an(Pe)>=1?Pe>0?~~+Fe(+Kn(Pe/4294967296),4294967295)>>>0:~~+Ve((Pe-+(~~Pe>>>0))/4294967296)>>>0:0,(c[dn+4>>2]&2146435072|0)!=2146435072)?(te=(he|0)==0&(ue|0)==0,f=d,c[f>>2]=te?1:he,c[f+4>>2]=te?0:ue,f=0):f=1,ue=f,Q=ce,ue|0)}function QI(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0;I=Q,Q=Q+288|0,T=I+264|0,M=I+96|0,N=I,_=N,x=_+96|0;do c[_>>2]=0,_=_+4|0;while((_|0)<(x|0));return d=G_(d,N)|0,d|0?(m=d,Q=I,m|0):(d=N,_=c[d>>2]|0,d=c[d+4>>2]|0,pc(_,d,T)|0,Ih(_,d,M)|0,k=+ZA(T,M+8|0),k=+Ve(+(+ZA(h,f)/(k*2))),X[dn>>3]=k,d=~~k>>>0,_=+an(k)>=1?k>0?~~+Fe(+Kn(k/4294967296),4294967295)>>>0:~~+Ve((k-+(~~k>>>0))/4294967296)>>>0:0,(c[dn+4>>2]&2146435072|0)==2146435072?(m=1,Q=I,m|0):(N=(d|0)==0&(_|0)==0,c[m>>2]=N?1:d,c[m+4>>2]=N?0:_,m=0,Q=I,m|0))}function YI(h,f){h=h|0,f=+f;var d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0;x=h+16|0,T=+X[x>>3],d=h+24|0,_=+X[d>>3],m=T-_,m=T<_?m+6.283185307179586:m,I=+X[h>>3],M=h+8|0,N=+X[M>>3],k=I-N,m=(m*f-m)*.5,f=(k*f-k)*.5,I=I+f,X[h>>3]=I>1.5707963267948966?1.5707963267948966:I,f=N-f,X[M>>3]=f<-1.5707963267948966?-1.5707963267948966:f,f=T+m,f=f>3.141592653589793?f+-6.283185307179586:f,X[x>>3]=f<-3.141592653589793?f+6.283185307179586:f,f=_-m,f=f>3.141592653589793?f+-6.283185307179586:f,X[d>>3]=f<-3.141592653589793?f+6.283185307179586:f}function ZI(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0,c[h>>2]=f,c[h+4>>2]=d,c[h+8>>2]=m}function KI(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0;te=f+8|0,c[te>>2]=0,N=+X[h>>3],T=+an(+N),I=+X[h+8>>3],M=+an(+I)*1.1547005383792515,T=T+M*.5,d=~~T,h=~~M,T=T-+(d|0),M=M-+(h|0);do if(T<.5)if(T<.3333333333333333)if(c[f>>2]=d,M<(T+1)*.5){c[f+4>>2]=h;break}else{h=h+1|0,c[f+4>>2]=h;break}else if(he=1-T,h=(!(M<he)&1)+h|0,c[f+4>>2]=h,he<=M&M<T*2){d=d+1|0,c[f>>2]=d;break}else{c[f>>2]=d;break}else{if(!(T<.6666666666666666))if(d=d+1|0,c[f>>2]=d,M<T*.5){c[f+4>>2]=h;break}else{h=h+1|0,c[f+4>>2]=h;break}if(M<1-T){if(c[f+4>>2]=h,T*2+-1<M){c[f>>2]=d;break}}else h=h+1|0,c[f+4>>2]=h;d=d+1|0,c[f>>2]=d}while(!1);do if(N<0)if(h&1){k=(h+1|0)/2|0,k=Yr(d|0,((d|0)<0)<<31>>31|0,k|0,((k|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-((+(k>>>0)+4294967296*+(Y()|0))*2+1)),c[f>>2]=d;break}else{k=(h|0)/2|0,k=Yr(d|0,((d|0)<0)<<31>>31|0,k|0,((k|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-(+(k>>>0)+4294967296*+(Y()|0))*2),c[f>>2]=d;break}while(!1);k=f+4|0,I<0&&(d=d-((h<<1|1|0)/2|0)|0,c[f>>2]=d,h=0-h|0,c[k>>2]=h),m=h-d|0,(d|0)<0?(_=0-d|0,c[k>>2]=m,c[te>>2]=_,c[f>>2]=0,h=m,d=0):_=0,(h|0)<0&&(d=d-h|0,c[f>>2]=d,_=_-h|0,c[te>>2]=_,c[k>>2]=0,h=0),x=d-_|0,m=h-_|0,(_|0)<0&&(c[f>>2]=x,c[k>>2]=m,c[te>>2]=0,h=m,d=x,_=0),m=(h|0)<(d|0)?h:d,m=(_|0)<(m|0)?_:m,!((m|0)<=0)&&(c[f>>2]=d-m,c[k>>2]=h-m,c[te>>2]=_-m)}function ls(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0;f=c[h>>2]|0,T=h+4|0,d=c[T>>2]|0,(f|0)<0&&(d=d-f|0,c[T>>2]=d,x=h+8|0,c[x>>2]=(c[x>>2]|0)-f,c[h>>2]=0,f=0),(d|0)<0?(f=f-d|0,c[h>>2]=f,x=h+8|0,_=(c[x>>2]|0)-d|0,c[x>>2]=_,c[T>>2]=0,d=0):(_=h+8|0,x=_,_=c[_>>2]|0),(_|0)<0&&(f=f-_|0,c[h>>2]=f,d=d-_|0,c[T>>2]=d,c[x>>2]=0,_=0),m=(d|0)<(f|0)?d:f,m=(_|0)<(m|0)?_:m,!((m|0)<=0)&&(c[h>>2]=f-m,c[T>>2]=d-m,c[x>>2]=_-m)}function hc(h,f){h=h|0,f=f|0;var d=0,m=0;m=c[h+8>>2]|0,d=+((c[h+4>>2]|0)-m|0),X[f>>3]=+((c[h>>2]|0)-m|0)-d*.5,X[f+8>>3]=d*.8660254037844386}function ws(h,f,d){h=h|0,f=f|0,d=d|0,c[d>>2]=(c[f>>2]|0)+(c[h>>2]|0),c[d+4>>2]=(c[f+4>>2]|0)+(c[h+4>>2]|0),c[d+8>>2]=(c[f+8>>2]|0)+(c[h+8>>2]|0)}function L_(h,f,d){h=h|0,f=f|0,d=d|0,c[d>>2]=(c[h>>2]|0)-(c[f>>2]|0),c[d+4>>2]=(c[h+4>>2]|0)-(c[f+4>>2]|0),c[d+8>>2]=(c[h+8>>2]|0)-(c[f+8>>2]|0)}function Q5(h,f){h=h|0,f=f|0;var d=0,m=0;d=Ge(c[h>>2]|0,f)|0,c[h>>2]=d,d=h+4|0,m=Ge(c[d>>2]|0,f)|0,c[d>>2]=m,h=h+8|0,f=Ge(c[h>>2]|0,f)|0,c[h>>2]=f}function Wp(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;T=c[h>>2]|0,M=(T|0)<0,m=(c[h+4>>2]|0)-(M?T:0)|0,x=(m|0)<0,_=(x?0-m|0:0)+((c[h+8>>2]|0)-(M?T:0))|0,d=(_|0)<0,h=d?0:_,f=(x?0:m)-(d?_:0)|0,_=(M?0:T)-(x?m:0)-(d?_:0)|0,d=(f|0)<(_|0)?f:_,d=(h|0)<(d|0)?h:d,m=(d|0)>0,h=h-(m?d:0)|0,f=f-(m?d:0)|0;e:do switch(_-(m?d:0)|0){case 0:switch(f|0){case 0:return M=(h|0)==0?0:(h|0)==1?1:7,M|0;case 1:return M=(h|0)==0?2:(h|0)==1?3:7,M|0;default:break e}case 1:switch(f|0){case 0:return M=(h|0)==0?4:(h|0)==1?5:7,M|0;case 1:{if(!h)h=6;else break e;return h|0}default:break e}}while(!1);return M=7,M|0}function JI(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0;if(N=h+8|0,T=c[N>>2]|0,M=(c[h>>2]|0)-T|0,I=h+4|0,T=(c[I>>2]|0)-T|0,M>>>0>715827881|T>>>0>715827881){if(m=(M|0)>0,_=2147483647-M|0,x=-2147483648-M|0,(m?(_|0)<(M|0):(x|0)>(M|0))||(d=M<<1,m?(2147483647-d|0)<(M|0):(-2147483648-d|0)>(M|0))||((T|0)>0?(2147483647-T|0)<(T|0):(-2147483648-T|0)>(T|0))||(f=M*3|0,d=T<<1,(m?(_|0)<(d|0):(x|0)>(d|0))||((M|0)>-1?(f|-2147483648|0)>=(T|0):(f^-2147483648|0)<(T|0))))return I=1,I|0}else d=T<<1,f=M*3|0;return m=mu(+(f-T|0)*.14285714285714285)|0,c[h>>2]=m,_=mu(+(d+M|0)*.14285714285714285)|0,c[I>>2]=_,c[N>>2]=0,d=(_|0)<(m|0),f=d?m:_,d=d?_:m,(d|0)<0&&(((d|0)==-2147483648||((f|0)>0?(2147483647-f|0)<(d|0):(-2147483648-f|0)>(d|0)))&&mt(27795,26892,354,26903),((f|0)>-1?(f|-2147483648|0)>=(d|0):(f^-2147483648|0)<(d|0))&&mt(27795,26892,354,26903)),f=_-m|0,(m|0)<0?(d=0-m|0,c[I>>2]=f,c[N>>2]=d,c[h>>2]=0,m=0):(f=_,d=0),(f|0)<0&&(m=m-f|0,c[h>>2]=m,d=d-f|0,c[N>>2]=d,c[I>>2]=0,f=0),x=m-d|0,_=f-d|0,(d|0)<0?(c[h>>2]=x,c[I>>2]=_,c[N>>2]=0,f=_,_=x,d=0):_=m,m=(f|0)<(_|0)?f:_,m=(d|0)<(m|0)?d:m,(m|0)<=0?(I=0,I|0):(c[h>>2]=_-m,c[I>>2]=f-m,c[N>>2]=d-m,I=0,I|0)}function eB(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0,N=0;if(T=h+8|0,_=c[T>>2]|0,x=(c[h>>2]|0)-_|0,M=h+4|0,_=(c[M>>2]|0)-_|0,x>>>0>715827881|_>>>0>715827881){if(d=(x|0)>0,(d?(2147483647-x|0)<(x|0):(-2147483648-x|0)>(x|0))||(f=x<<1,m=(_|0)>0,m?(2147483647-_|0)<(_|0):(-2147483648-_|0)>(_|0)))return M=1,M|0;if(N=_<<1,(m?(2147483647-N|0)<(_|0):(-2147483648-N|0)>(_|0))||(d?(2147483647-f|0)<(_|0):(-2147483648-f|0)>(_|0))||(d=_*3|0,(_|0)>-1?(d|-2147483648|0)>=(x|0):(d^-2147483648|0)<(x|0)))return N=1,N|0}else d=_*3|0,f=x<<1;return m=mu(+(f+_|0)*.14285714285714285)|0,c[h>>2]=m,_=mu(+(d-x|0)*.14285714285714285)|0,c[M>>2]=_,c[T>>2]=0,d=(_|0)<(m|0),f=d?m:_,d=d?_:m,(d|0)<0&&(((d|0)==-2147483648||((f|0)>0?(2147483647-f|0)<(d|0):(-2147483648-f|0)>(d|0)))&&mt(27795,26892,402,26917),((f|0)>-1?(f|-2147483648|0)>=(d|0):(f^-2147483648|0)<(d|0))&&mt(27795,26892,402,26917)),f=_-m|0,(m|0)<0?(d=0-m|0,c[M>>2]=f,c[T>>2]=d,c[h>>2]=0,m=0):(f=_,d=0),(f|0)<0&&(m=m-f|0,c[h>>2]=m,d=d-f|0,c[T>>2]=d,c[M>>2]=0,f=0),x=m-d|0,_=f-d|0,(d|0)<0?(c[h>>2]=x,c[M>>2]=_,c[T>>2]=0,f=_,_=x,d=0):_=m,m=(f|0)<(_|0)?f:_,m=(d|0)<(m|0)?d:m,(m|0)<=0?(N=0,N|0):(c[h>>2]=_-m,c[M>>2]=f-m,c[T>>2]=d-m,N=0,N|0)}function tB(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;T=h+8|0,d=c[T>>2]|0,f=(c[h>>2]|0)-d|0,M=h+4|0,d=(c[M>>2]|0)-d|0,m=mu(+((f*3|0)-d|0)*.14285714285714285)|0,c[h>>2]=m,f=mu(+((d<<1)+f|0)*.14285714285714285)|0,c[M>>2]=f,c[T>>2]=0,d=f-m|0,(m|0)<0?(x=0-m|0,c[M>>2]=d,c[T>>2]=x,c[h>>2]=0,f=d,m=0,d=x):d=0,(f|0)<0&&(m=m-f|0,c[h>>2]=m,d=d-f|0,c[T>>2]=d,c[M>>2]=0,f=0),x=m-d|0,_=f-d|0,(d|0)<0?(c[h>>2]=x,c[M>>2]=_,c[T>>2]=0,f=_,_=x,d=0):_=m,m=(f|0)<(_|0)?f:_,m=(d|0)<(m|0)?d:m,!((m|0)<=0)&&(c[h>>2]=_-m,c[M>>2]=f-m,c[T>>2]=d-m)}function Y5(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;T=h+8|0,d=c[T>>2]|0,f=(c[h>>2]|0)-d|0,M=h+4|0,d=(c[M>>2]|0)-d|0,m=mu(+((f<<1)+d|0)*.14285714285714285)|0,c[h>>2]=m,f=mu(+((d*3|0)-f|0)*.14285714285714285)|0,c[M>>2]=f,c[T>>2]=0,d=f-m|0,(m|0)<0?(x=0-m|0,c[M>>2]=d,c[T>>2]=x,c[h>>2]=0,f=d,m=0,d=x):d=0,(f|0)<0&&(m=m-f|0,c[h>>2]=m,d=d-f|0,c[T>>2]=d,c[M>>2]=0,f=0),x=m-d|0,_=f-d|0,(d|0)<0?(c[h>>2]=x,c[M>>2]=_,c[T>>2]=0,f=_,_=x,d=0):_=m,m=(f|0)<(_|0)?f:_,m=(d|0)<(m|0)?d:m,!((m|0)<=0)&&(c[h>>2]=_-m,c[M>>2]=f-m,c[T>>2]=d-m)}function $p(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;f=c[h>>2]|0,T=h+4|0,d=c[T>>2]|0,M=h+8|0,m=c[M>>2]|0,_=d+(f*3|0)|0,c[h>>2]=_,d=m+(d*3|0)|0,c[T>>2]=d,f=(m*3|0)+f|0,c[M>>2]=f,m=d-_|0,(_|0)<0?(f=f-_|0,c[T>>2]=m,c[M>>2]=f,c[h>>2]=0,d=m,m=0):m=_,(d|0)<0&&(m=m-d|0,c[h>>2]=m,f=f-d|0,c[M>>2]=f,c[T>>2]=0,d=0),x=m-f|0,_=d-f|0,(f|0)<0?(c[h>>2]=x,c[T>>2]=_,c[M>>2]=0,m=x,f=0):_=d,d=(_|0)<(m|0)?_:m,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(c[h>>2]=m-d,c[T>>2]=_-d,c[M>>2]=f-d)}function fc(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;_=c[h>>2]|0,T=h+4|0,f=c[T>>2]|0,M=h+8|0,d=c[M>>2]|0,m=(f*3|0)+_|0,_=d+(_*3|0)|0,c[h>>2]=_,c[T>>2]=m,f=(d*3|0)+f|0,c[M>>2]=f,d=m-_|0,(_|0)<0?(f=f-_|0,c[T>>2]=d,c[M>>2]=f,c[h>>2]=0,_=0):d=m,(d|0)<0&&(_=_-d|0,c[h>>2]=_,f=f-d|0,c[M>>2]=f,c[T>>2]=0,d=0),x=_-f|0,m=d-f|0,(f|0)<0?(c[h>>2]=x,c[T>>2]=m,c[M>>2]=0,_=x,f=0):m=d,d=(m|0)<(_|0)?m:_,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(c[h>>2]=_-d,c[T>>2]=m-d,c[M>>2]=f-d)}function Z5(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0;(f+-1|0)>>>0>=6||(_=(c[15440+(f*12|0)>>2]|0)+(c[h>>2]|0)|0,c[h>>2]=_,M=h+4|0,m=(c[15440+(f*12|0)+4>>2]|0)+(c[M>>2]|0)|0,c[M>>2]=m,T=h+8|0,f=(c[15440+(f*12|0)+8>>2]|0)+(c[T>>2]|0)|0,c[T>>2]=f,d=m-_|0,(_|0)<0?(f=f-_|0,c[M>>2]=d,c[T>>2]=f,c[h>>2]=0,m=0):(d=m,m=_),(d|0)<0&&(m=m-d|0,c[h>>2]=m,f=f-d|0,c[T>>2]=f,c[M>>2]=0,d=0),x=m-f|0,_=d-f|0,(f|0)<0?(c[h>>2]=x,c[M>>2]=_,c[T>>2]=0,m=x,f=0):_=d,d=(_|0)<(m|0)?_:m,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(c[h>>2]=m-d,c[M>>2]=_-d,c[T>>2]=f-d))}function K5(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;_=c[h>>2]|0,T=h+4|0,f=c[T>>2]|0,M=h+8|0,d=c[M>>2]|0,m=f+_|0,_=d+_|0,c[h>>2]=_,c[T>>2]=m,f=d+f|0,c[M>>2]=f,d=m-_|0,(_|0)<0?(f=f-_|0,c[T>>2]=d,c[M>>2]=f,c[h>>2]=0,m=0):(d=m,m=_),(d|0)<0&&(m=m-d|0,c[h>>2]=m,f=f-d|0,c[M>>2]=f,c[T>>2]=0,d=0),x=m-f|0,_=d-f|0,(f|0)<0?(c[h>>2]=x,c[T>>2]=_,c[M>>2]=0,m=x,f=0):_=d,d=(_|0)<(m|0)?_:m,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(c[h>>2]=m-d,c[T>>2]=_-d,c[M>>2]=f-d)}function jp(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;f=c[h>>2]|0,T=h+4|0,m=c[T>>2]|0,M=h+8|0,d=c[M>>2]|0,_=m+f|0,c[h>>2]=_,m=d+m|0,c[T>>2]=m,f=d+f|0,c[M>>2]=f,d=m-_|0,(_|0)<0?(f=f-_|0,c[T>>2]=d,c[M>>2]=f,c[h>>2]=0,m=0):(d=m,m=_),(d|0)<0&&(m=m-d|0,c[h>>2]=m,f=f-d|0,c[M>>2]=f,c[T>>2]=0,d=0),x=m-f|0,_=d-f|0,(f|0)<0?(c[h>>2]=x,c[T>>2]=_,c[M>>2]=0,m=x,f=0):_=d,d=(_|0)<(m|0)?_:m,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(c[h>>2]=m-d,c[T>>2]=_-d,c[M>>2]=f-d)}function Ac(h){switch(h=h|0,h|0){case 1:{h=5;break}case 5:{h=4;break}case 4:{h=6;break}case 6:{h=2;break}case 2:{h=3;break}case 3:{h=1;break}}return h|0}function du(h){switch(h=h|0,h|0){case 1:{h=3;break}case 3:{h=2;break}case 2:{h=6;break}case 6:{h=4;break}case 4:{h=5;break}case 5:{h=1;break}}return h|0}function J5(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;f=c[h>>2]|0,T=h+4|0,d=c[T>>2]|0,M=h+8|0,m=c[M>>2]|0,_=d+(f<<1)|0,c[h>>2]=_,d=m+(d<<1)|0,c[T>>2]=d,f=(m<<1)+f|0,c[M>>2]=f,m=d-_|0,(_|0)<0?(f=f-_|0,c[T>>2]=m,c[M>>2]=f,c[h>>2]=0,d=m,m=0):m=_,(d|0)<0&&(m=m-d|0,c[h>>2]=m,f=f-d|0,c[M>>2]=f,c[T>>2]=0,d=0),x=m-f|0,_=d-f|0,(f|0)<0?(c[h>>2]=x,c[T>>2]=_,c[M>>2]=0,m=x,f=0):_=d,d=(_|0)<(m|0)?_:m,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(c[h>>2]=m-d,c[T>>2]=_-d,c[M>>2]=f-d)}function e8(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;_=c[h>>2]|0,T=h+4|0,f=c[T>>2]|0,M=h+8|0,d=c[M>>2]|0,m=(f<<1)+_|0,_=d+(_<<1)|0,c[h>>2]=_,c[T>>2]=m,f=(d<<1)+f|0,c[M>>2]=f,d=m-_|0,(_|0)<0?(f=f-_|0,c[T>>2]=d,c[M>>2]=f,c[h>>2]=0,_=0):d=m,(d|0)<0&&(_=_-d|0,c[h>>2]=_,f=f-d|0,c[M>>2]=f,c[T>>2]=0,d=0),x=_-f|0,m=d-f|0,(f|0)<0?(c[h>>2]=x,c[T>>2]=m,c[M>>2]=0,_=x,f=0):m=d,d=(m|0)<(_|0)?m:_,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(c[h>>2]=_-d,c[T>>2]=m-d,c[M>>2]=f-d)}function D_(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0;return T=(c[h>>2]|0)-(c[f>>2]|0)|0,M=(T|0)<0,m=(c[h+4>>2]|0)-(c[f+4>>2]|0)-(M?T:0)|0,x=(m|0)<0,_=(M?0-T|0:0)+(c[h+8>>2]|0)-(c[f+8>>2]|0)+(x?0-m|0:0)|0,h=(_|0)<0,f=h?0:_,d=(x?0:m)-(h?_:0)|0,_=(M?0:T)-(x?m:0)-(h?_:0)|0,h=(d|0)<(_|0)?d:_,h=(f|0)<(h|0)?f:h,m=(h|0)>0,f=f-(m?h:0)|0,d=d-(m?h:0)|0,h=_-(m?h:0)|0,h=(h|0)>-1?h:0-h|0,d=(d|0)>-1?d:0-d|0,f=(f|0)>-1?f:0-f|0,f=(d|0)>(f|0)?d:f,((h|0)>(f|0)?h:f)|0}function nB(h,f){h=h|0,f=f|0;var d=0;d=c[h+8>>2]|0,c[f>>2]=(c[h>>2]|0)-d,c[f+4>>2]=(c[h+4>>2]|0)-d}function iB(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0;return m=c[h>>2]|0,c[f>>2]=m,_=c[h+4>>2]|0,T=f+4|0,c[T>>2]=_,M=f+8|0,c[M>>2]=0,d=(_|0)<(m|0),h=d?m:_,d=d?_:m,(d|0)<0&&((d|0)==-2147483648||((h|0)>0?(2147483647-h|0)<(d|0):(-2147483648-h|0)>(d|0))||((h|0)>-1?(h|-2147483648|0)>=(d|0):(h^-2147483648|0)<(d|0)))?(f=1,f|0):(h=_-m|0,(m|0)<0?(d=0-m|0,c[T>>2]=h,c[M>>2]=d,c[f>>2]=0,m=0):(h=_,d=0),(h|0)<0&&(m=m-h|0,c[f>>2]=m,d=d-h|0,c[M>>2]=d,c[T>>2]=0,h=0),x=m-d|0,_=h-d|0,(d|0)<0?(c[f>>2]=x,c[T>>2]=_,c[M>>2]=0,h=_,_=x,d=0):_=m,m=(h|0)<(_|0)?h:_,m=(d|0)<(m|0)?d:m,(m|0)<=0?(f=0,f|0):(c[f>>2]=_-m,c[T>>2]=h-m,c[M>>2]=d-m,f=0,f|0))}function t8(h){h=h|0;var f=0,d=0,m=0,_=0;f=h+8|0,_=c[f>>2]|0,d=_-(c[h>>2]|0)|0,c[h>>2]=d,m=h+4|0,h=(c[m>>2]|0)-_|0,c[m>>2]=h,c[f>>2]=0-(h+d)}function rB(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;d=c[h>>2]|0,f=0-d|0,c[h>>2]=f,T=h+8|0,c[T>>2]=0,M=h+4|0,m=c[M>>2]|0,_=m+d|0,(d|0)>0?(c[M>>2]=_,c[T>>2]=d,c[h>>2]=0,f=0,m=_):d=0,(m|0)<0?(x=f-m|0,c[h>>2]=x,d=d-m|0,c[T>>2]=d,c[M>>2]=0,_=x-d|0,f=0-d|0,(d|0)<0?(c[h>>2]=_,c[M>>2]=f,c[T>>2]=0,m=f,d=0):(m=0,_=x)):_=f,f=(m|0)<(_|0)?m:_,f=(d|0)<(f|0)?d:f,!((f|0)<=0)&&(c[h>>2]=_-f,c[M>>2]=m-f,c[T>>2]=d-f)}function sB(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0,k=0,te=0;if(te=Q,Q=Q+64|0,k=te,M=te+56|0,!(!0&(f&2013265920|0)==134217728&(!0&(m&2013265920|0)==134217728)))return _=5,Q=te,_|0;if((h|0)==(d|0)&(f|0)==(m|0))return c[_>>2]=0,_=0,Q=te,_|0;if(T=ct(h|0,f|0,52)|0,Y()|0,T=T&15,I=ct(d|0,m|0,52)|0,Y()|0,(T|0)!=(I&15|0))return _=12,Q=te,_|0;if(x=T+-1|0,T>>>0>1){O_(h,f,x,k)|0,O_(d,m,x,M)|0,I=k,N=c[I>>2]|0,I=c[I+4>>2]|0;e:do if((N|0)==(c[M>>2]|0)&&(I|0)==(c[M+4>>2]|0)){T=(T^15)*3|0,x=ct(h|0,f|0,T|0)|0,Y()|0,x=x&7,T=ct(d|0,m|0,T|0)|0,Y()|0,T=T&7;do if((x|0)==0|(T|0)==0)c[_>>2]=1,x=0;else if((x|0)==7)x=5;else{if((x|0)==1|(T|0)==1&&yi(N,I)|0){x=5;break}if((c[15536+(x<<2)>>2]|0)!=(T|0)&&(c[15568+(x<<2)>>2]|0)!=(T|0))break e;c[_>>2]=1,x=0}while(!1);return _=x,Q=te,_|0}while(!1)}x=k,T=x+56|0;do c[x>>2]=0,x=x+4|0;while((x|0)<(T|0));return Ar(h,f,1,k)|0,f=k,!((c[f>>2]|0)==(d|0)&&(c[f+4>>2]|0)==(m|0))&&(f=k+8|0,!((c[f>>2]|0)==(d|0)&&(c[f+4>>2]|0)==(m|0)))&&(f=k+16|0,!((c[f>>2]|0)==(d|0)&&(c[f+4>>2]|0)==(m|0)))&&(f=k+24|0,!((c[f>>2]|0)==(d|0)&&(c[f+4>>2]|0)==(m|0)))&&(f=k+32|0,!((c[f>>2]|0)==(d|0)&&(c[f+4>>2]|0)==(m|0)))&&(f=k+40|0,!((c[f>>2]|0)==(d|0)&&(c[f+4>>2]|0)==(m|0)))?(x=k+48|0,x=((c[x>>2]|0)==(d|0)?(c[x+4>>2]|0)==(m|0):0)&1):x=1,c[_>>2]=x,_=0,Q=te,_|0}function oB(h,f,d,m,_){return h=h|0,f=f|0,d=d|0,m=m|0,_=_|0,d=dr(h,f,d,m)|0,(d|0)==7?(_=11,_|0):(m=St(d|0,0,56)|0,f=f&-2130706433|(Y()|0)|268435456,c[_>>2]=h|m,c[_+4>>2]=f,_=0,_|0)}function aB(h,f,d){return h=h|0,f=f|0,d=d|0,!0&(f&2013265920|0)==268435456?(c[d>>2]=h,c[d+4>>2]=f&-2130706433|134217728,d=0,d|0):(d=6,d|0)}function lB(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0;return _=Q,Q=Q+16|0,m=_,c[m>>2]=0,!0&(f&2013265920|0)==268435456?(x=ct(h|0,f|0,56)|0,Y()|0,m=ei(h,f&-2130706433|134217728,x&7,m,d)|0,Q=_,m|0):(m=6,Q=_,m|0)}function uB(h,f){h=h|0,f=f|0;var d=0;switch(d=ct(h|0,f|0,56)|0,Y()|0,d&7){case 0:case 7:return d=0,d|0}return d=f&-2130706433|134217728,!(!0&(f&2013265920|0)==268435456)||!0&(f&117440512|0)==16777216&(yi(h,d)|0)!=0?(d=0,d|0):(d=F_(h,d)|0,d|0)}function cB(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0;return _=Q,Q=Q+16|0,m=_,!0&(f&2013265920|0)==268435456?(x=f&-2130706433|134217728,T=d,c[T>>2]=h,c[T+4>>2]=x,c[m>>2]=0,f=ct(h|0,f|0,56)|0,Y()|0,m=ei(h,x,f&7,m,d+8|0)|0,Q=_,m|0):(m=6,Q=_,m|0)}function hB(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0;return _=(yi(h,f)|0)==0,f=f&-2130706433,m=d,c[m>>2]=_?h:0,c[m+4>>2]=_?f|285212672:0,m=d+8|0,c[m>>2]=h,c[m+4>>2]=f|301989888,m=d+16|0,c[m>>2]=h,c[m+4>>2]=f|318767104,m=d+24|0,c[m>>2]=h,c[m+4>>2]=f|335544320,m=d+32|0,c[m>>2]=h,c[m+4>>2]=f|352321536,d=d+40|0,c[d>>2]=h,c[d+4>>2]=f|369098752,0}function Xp(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0;return T=Q,Q=Q+16|0,_=T,x=f&-2130706433|134217728,!0&(f&2013265920|0)==268435456?(m=ct(h|0,f|0,56)|0,Y()|0,m=lF(h,x,m&7)|0,(m|0)==-1?(c[d>>2]=0,x=6,Q=T,x|0):(Dh(h,x,_)|0&&mt(27795,26932,282,26947),f=ct(h|0,f|0,52)|0,Y()|0,f=f&15,yi(h,x)|0?I_(_,f,m,2,d):B_(_,f,m,2,d),x=0,Q=T,x|0)):(x=6,Q=T,x|0)}function fB(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0;m=Q,Q=Q+16|0,_=m,AB(h,f,d,_),KI(_,d+4|0),Q=m}function AB(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0;if(M=Q,Q=Q+16|0,N=M,dB(h,d,N),x=+mo(+(1-+X[N>>3]*.5)),x<1e-16){c[m>>2]=0,c[m+4>>2]=0,c[m+8>>2]=0,c[m+12>>2]=0,Q=M;return}if(N=c[d>>2]|0,_=+X[15920+(N*24|0)>>3],_=+YA(_-+YA(+PB(15600+(N<<4)|0,h))),zo(f)|0?T=+YA(_+-.3334731722518321):T=_,_=+cn(+x)*2.618033988749896,(f|0)>0){h=0;do _=_*2.6457513110645907,h=h+1|0;while((h|0)!=(f|0))}x=+un(+T)*_,X[m>>3]=x,T=+qt(+T)*_,X[m+8>>3]=T,Q=M}function dB(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0;if(x=Q,Q=Q+32|0,_=x,aF(h,_),c[f>>2]=0,X[d>>3]=5,m=+xr(16400,_),m<+X[d>>3]&&(c[f>>2]=0,X[d>>3]=m),m=+xr(16424,_),m<+X[d>>3]&&(c[f>>2]=1,X[d>>3]=m),m=+xr(16448,_),m<+X[d>>3]&&(c[f>>2]=2,X[d>>3]=m),m=+xr(16472,_),m<+X[d>>3]&&(c[f>>2]=3,X[d>>3]=m),m=+xr(16496,_),m<+X[d>>3]&&(c[f>>2]=4,X[d>>3]=m),m=+xr(16520,_),m<+X[d>>3]&&(c[f>>2]=5,X[d>>3]=m),m=+xr(16544,_),m<+X[d>>3]&&(c[f>>2]=6,X[d>>3]=m),m=+xr(16568,_),m<+X[d>>3]&&(c[f>>2]=7,X[d>>3]=m),m=+xr(16592,_),m<+X[d>>3]&&(c[f>>2]=8,X[d>>3]=m),m=+xr(16616,_),m<+X[d>>3]&&(c[f>>2]=9,X[d>>3]=m),m=+xr(16640,_),m<+X[d>>3]&&(c[f>>2]=10,X[d>>3]=m),m=+xr(16664,_),m<+X[d>>3]&&(c[f>>2]=11,X[d>>3]=m),m=+xr(16688,_),m<+X[d>>3]&&(c[f>>2]=12,X[d>>3]=m),m=+xr(16712,_),m<+X[d>>3]&&(c[f>>2]=13,X[d>>3]=m),m=+xr(16736,_),m<+X[d>>3]&&(c[f>>2]=14,X[d>>3]=m),m=+xr(16760,_),m<+X[d>>3]&&(c[f>>2]=15,X[d>>3]=m),m=+xr(16784,_),m<+X[d>>3]&&(c[f>>2]=16,X[d>>3]=m),m=+xr(16808,_),m<+X[d>>3]&&(c[f>>2]=17,X[d>>3]=m),m=+xr(16832,_),m<+X[d>>3]&&(c[f>>2]=18,X[d>>3]=m),m=+xr(16856,_),!(m<+X[d>>3])){Q=x;return}c[f>>2]=19,X[d>>3]=m,Q=x}function XA(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0;if(x=+oF(h),x<1e-16){f=15600+(f<<4)|0,c[_>>2]=c[f>>2],c[_+4>>2]=c[f+4>>2],c[_+8>>2]=c[f+8>>2],c[_+12>>2]=c[f+12>>2];return}if(T=+Re(+ +X[h+8>>3],+ +X[h>>3]),(d|0)>0){h=0;do x=x*.37796447300922725,h=h+1|0;while((h|0)!=(d|0))}M=x*.3333333333333333,m?(d=(zo(d)|0)==0,x=+ne(+((d?M:M*.37796447300922725)*.381966011250105))):(x=+ne(+(x*.381966011250105)),zo(d)|0&&(T=+YA(T+.3334731722518321))),LB(15600+(f<<4)|0,+YA(+X[15920+(f*24|0)>>3]-T),x,_)}function pB(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0;m=Q,Q=Q+16|0,_=m,hc(h+4|0,_),XA(_,c[h>>2]|0,f,0,d),Q=m}function I_(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0,vt=0,Ht=0,Vt=0,gn=0,xn=0,On=0,fn=0,Wt=0,_t=0,Dn=0,mi=0,Mn=0;if(Dn=Q,Q=Q+272|0,x=Dn+256|0,ze=Dn+240|0,fn=Dn,Wt=Dn+224|0,_t=Dn+208|0,Ue=Dn+176|0,Se=Dn+160|0,vt=Dn+192|0,Ht=Dn+144|0,Vt=Dn+128|0,gn=Dn+112|0,xn=Dn+96|0,On=Dn+80|0,c[x>>2]=f,c[ze>>2]=c[h>>2],c[ze+4>>2]=c[h+4>>2],c[ze+8>>2]=c[h+8>>2],c[ze+12>>2]=c[h+12>>2],n8(ze,x,fn),c[_>>2]=0,ze=m+d+((m|0)==5&1)|0,(ze|0)<=(d|0)){Q=Dn;return}N=c[x>>2]|0,I=Wt+4|0,k=Ue+4|0,te=d+5|0,he=16880+(N<<2)|0,ue=16960+(N<<2)|0,ce=Vt+8|0,be=gn+8|0,Pe=xn+8|0,He=_t+4|0,M=d;e:for(;;){T=fn+(((M|0)%5|0)<<4)|0,c[_t>>2]=c[T>>2],c[_t+4>>2]=c[T+4>>2],c[_t+8>>2]=c[T+8>>2],c[_t+12>>2]=c[T+12>>2];do;while((Lh(_t,N,0,1)|0)==2);if((M|0)>(d|0)&(zo(f)|0)!=0){if(c[Ue>>2]=c[_t>>2],c[Ue+4>>2]=c[_t+4>>2],c[Ue+8>>2]=c[_t+8>>2],c[Ue+12>>2]=c[_t+12>>2],hc(I,Se),m=c[Ue>>2]|0,x=c[17040+(m*80|0)+(c[Wt>>2]<<2)>>2]|0,c[Ue>>2]=c[18640+(m*80|0)+(x*20|0)>>2],T=c[18640+(m*80|0)+(x*20|0)+16>>2]|0,(T|0)>0){h=0;do K5(k),h=h+1|0;while((h|0)<(T|0))}switch(T=18640+(m*80|0)+(x*20|0)+4|0,c[vt>>2]=c[T>>2],c[vt+4>>2]=c[T+4>>2],c[vt+8>>2]=c[T+8>>2],Q5(vt,(c[he>>2]|0)*3|0),ws(k,vt,k),ls(k),hc(k,Ht),mi=+(c[ue>>2]|0),X[Vt>>3]=mi*3,X[ce>>3]=0,Mn=mi*-1.5,X[gn>>3]=Mn,X[be>>3]=mi*2.598076211353316,X[xn>>3]=Mn,X[Pe>>3]=mi*-2.598076211353316,c[17040+((c[Ue>>2]|0)*80|0)+(c[_t>>2]<<2)>>2]|0){case 1:{h=gn,m=Vt;break}case 3:{h=xn,m=gn;break}case 2:{h=Vt,m=xn;break}default:{h=12;break e}}_8(Se,Ht,m,h,On),XA(On,c[Ue>>2]|0,N,1,_+8+(c[_>>2]<<4)|0),c[_>>2]=(c[_>>2]|0)+1}if((M|0)<(te|0)&&(hc(He,Ue),XA(Ue,c[_t>>2]|0,N,1,_+8+(c[_>>2]<<4)|0),c[_>>2]=(c[_>>2]|0)+1),c[Wt>>2]=c[_t>>2],c[Wt+4>>2]=c[_t+4>>2],c[Wt+8>>2]=c[_t+8>>2],c[Wt+12>>2]=c[_t+12>>2],M=M+1|0,(M|0)>=(ze|0)){h=3;break}}if((h|0)==3){Q=Dn;return}else(h|0)==12&&mt(26970,27017,572,27027)}function n8(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0;N=Q,Q=Q+128|0,m=N+64|0,_=N,x=m,T=20240,M=x+60|0;do c[x>>2]=c[T>>2],x=x+4|0,T=T+4|0;while((x|0)<(M|0));x=_,T=20304,M=x+60|0;do c[x>>2]=c[T>>2],x=x+4|0,T=T+4|0;while((x|0)<(M|0));M=(zo(c[f>>2]|0)|0)==0,m=M?m:_,_=h+4|0,J5(_),e8(_),zo(c[f>>2]|0)|0&&(fc(_),c[f>>2]=(c[f>>2]|0)+1),c[d>>2]=c[h>>2],f=d+4|0,ws(_,m,f),ls(f),c[d+16>>2]=c[h>>2],f=d+20|0,ws(_,m+12|0,f),ls(f),c[d+32>>2]=c[h>>2],f=d+36|0,ws(_,m+24|0,f),ls(f),c[d+48>>2]=c[h>>2],f=d+52|0,ws(_,m+36|0,f),ls(f),c[d+64>>2]=c[h>>2],d=d+68|0,ws(_,m+48|0,d),ls(d),Q=N}function Lh(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0;if(ce=Q,Q=Q+32|0,he=ce+12|0,M=ce,ue=h+4|0,te=c[16960+(f<<2)>>2]|0,k=(m|0)!=0,te=k?te*3|0:te,_=c[ue>>2]|0,I=h+8|0,T=c[I>>2]|0,k){if(x=h+12|0,m=c[x>>2]|0,_=T+_+m|0,(_|0)==(te|0))return ue=1,Q=ce,ue|0;N=x}else N=h+12|0,m=c[N>>2]|0,_=T+_+m|0;if((_|0)<=(te|0))return ue=0,Q=ce,ue|0;do if((m|0)>0){if(m=c[h>>2]|0,(T|0)>0){x=18640+(m*80|0)+60|0,m=h;break}m=18640+(m*80|0)+40|0,d?(ZI(he,te,0,0),L_(ue,he,M),jp(M),ws(M,he,ue),x=m,m=h):(x=m,m=h)}else x=18640+((c[h>>2]|0)*80|0)+20|0,m=h;while(!1);if(c[m>>2]=c[x>>2],_=x+16|0,(c[_>>2]|0)>0){m=0;do K5(ue),m=m+1|0;while((m|0)<(c[_>>2]|0))}return h=x+4|0,c[he>>2]=c[h>>2],c[he+4>>2]=c[h+4>>2],c[he+8>>2]=c[h+8>>2],f=c[16880+(f<<2)>>2]|0,Q5(he,k?f*3|0:f),ws(ue,he,ue),ls(ue),k?m=((c[I>>2]|0)+(c[ue>>2]|0)+(c[N>>2]|0)|0)==(te|0)?1:2:m=2,ue=m,Q=ce,ue|0}function mB(h,f){h=h|0,f=f|0;var d=0;do d=Lh(h,f,0,1)|0;while((d|0)==2);return d|0}function B_(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0,vt=0,Ht=0,Vt=0,gn=0,xn=0,On=0,fn=0;if(xn=Q,Q=Q+240|0,x=xn+224|0,vt=xn+208|0,Ht=xn,Vt=xn+192|0,gn=xn+176|0,Pe=xn+160|0,He=xn+144|0,ze=xn+128|0,Ue=xn+112|0,Se=xn+96|0,c[x>>2]=f,c[vt>>2]=c[h>>2],c[vt+4>>2]=c[h+4>>2],c[vt+8>>2]=c[h+8>>2],c[vt+12>>2]=c[h+12>>2],i8(vt,x,Ht),c[_>>2]=0,be=m+d+((m|0)==6&1)|0,(be|0)<=(d|0)){Q=xn;return}N=c[x>>2]|0,I=d+6|0,k=16960+(N<<2)|0,te=He+8|0,he=ze+8|0,ue=Ue+8|0,ce=Vt+4|0,T=0,M=d,m=-1;e:for(;;){if(x=(M|0)%6|0,h=Ht+(x<<4)|0,c[Vt>>2]=c[h>>2],c[Vt+4>>2]=c[h+4>>2],c[Vt+8>>2]=c[h+8>>2],c[Vt+12>>2]=c[h+12>>2],h=T,T=Lh(Vt,N,0,1)|0,(M|0)>(d|0)&(zo(f)|0)!=0&&(h|0)!=1&&(c[Vt>>2]|0)!=(m|0)){switch(hc(Ht+(((x+5|0)%6|0)<<4)+4|0,gn),hc(Ht+(x<<4)+4|0,Pe),On=+(c[k>>2]|0),X[He>>3]=On*3,X[te>>3]=0,fn=On*-1.5,X[ze>>3]=fn,X[he>>3]=On*2.598076211353316,X[Ue>>3]=fn,X[ue>>3]=On*-2.598076211353316,x=c[vt>>2]|0,c[17040+(x*80|0)+(((m|0)==(x|0)?c[Vt>>2]|0:m)<<2)>>2]|0){case 1:{h=ze,m=He;break}case 3:{h=Ue,m=ze;break}case 2:{h=He,m=Ue;break}default:{h=8;break e}}_8(gn,Pe,m,h,Se),!(v8(gn,Se)|0)&&!(v8(Pe,Se)|0)&&(XA(Se,c[vt>>2]|0,N,1,_+8+(c[_>>2]<<4)|0),c[_>>2]=(c[_>>2]|0)+1)}if((M|0)<(I|0)&&(hc(ce,gn),XA(gn,c[Vt>>2]|0,N,1,_+8+(c[_>>2]<<4)|0),c[_>>2]=(c[_>>2]|0)+1),M=M+1|0,(M|0)>=(be|0)){h=3;break}else m=c[Vt>>2]|0}if((h|0)==3){Q=xn;return}else(h|0)==8&&mt(27054,27017,737,27099)}function i8(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0;N=Q,Q=Q+160|0,m=N+80|0,_=N,x=m,T=20368,M=x+72|0;do c[x>>2]=c[T>>2],x=x+4|0,T=T+4|0;while((x|0)<(M|0));x=_,T=20448,M=x+72|0;do c[x>>2]=c[T>>2],x=x+4|0,T=T+4|0;while((x|0)<(M|0));M=(zo(c[f>>2]|0)|0)==0,m=M?m:_,_=h+4|0,J5(_),e8(_),zo(c[f>>2]|0)|0&&(fc(_),c[f>>2]=(c[f>>2]|0)+1),c[d>>2]=c[h>>2],f=d+4|0,ws(_,m,f),ls(f),c[d+16>>2]=c[h>>2],f=d+20|0,ws(_,m+12|0,f),ls(f),c[d+32>>2]=c[h>>2],f=d+36|0,ws(_,m+24|0,f),ls(f),c[d+48>>2]=c[h>>2],f=d+52|0,ws(_,m+36|0,f),ls(f),c[d+64>>2]=c[h>>2],f=d+68|0,ws(_,m+48|0,f),ls(f),c[d+80>>2]=c[h>>2],d=d+84|0,ws(_,m+60|0,d),ls(d),Q=N}function gB(h,f){return h=h|0,f=f|0,f=ct(h|0,f|0,52)|0,Y()|0,f&15|0}function r8(h,f){return h=h|0,f=f|0,f=ct(h|0,f|0,45)|0,Y()|0,f&127|0}function F_(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0;return!(!0&(f&-16777216|0)==134217728)||(m=ct(h|0,f|0,52)|0,Y()|0,m=m&15,d=ct(h|0,f|0,45)|0,Y()|0,d=d&127,d>>>0>121)?(h=0,h|0):(T=(m^15)*3|0,_=ct(h|0,f|0,T|0)|0,T=St(_|0,Y()|0,T|0)|0,_=Y()|0,x=Yr(-1227133514,-1171,T|0,_|0)|0,!((T&613566756&x|0)==0&(_&4681&(Y()|0)|0)==0)||(T=(m*3|0)+19|0,x=St(~h|0,~f|0,T|0)|0,T=ct(x|0,Y()|0,T|0)|0,!((m|0)==15|(T|0)==0&(Y()|0)==0))?(T=0,T|0):!(et[20528+d>>0]|0)||(f=f&8191,(h|0)==0&(f|0)==0)?(T=1,T|0):(T=M8(h|0,f|0)|0,Y()|0,((63-T|0)%3|0|0)!=0|0))}function U_(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0;if(_=St(f|0,0,52)|0,x=Y()|0,d=St(d|0,0,45)|0,d=x|(Y()|0)|134225919,(f|0)<1){x=-1,m=d,f=h,c[f>>2]=x,h=h+4|0,c[h>>2]=m;return}for(x=1,_=-1;T=(15-x|0)*3|0,M=St(7,0,T|0)|0,d=d&~(Y()|0),T=St(m|0,0,T|0)|0,_=_&~M|T,d=d|(Y()|0),(x|0)!=(f|0);)x=x+1|0;M=h,T=M,c[T>>2]=_,M=M+4|0,c[M>>2]=d}function O_(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0;if(x=ct(h|0,f|0,52)|0,Y()|0,x=x&15,d>>>0>15)return m=4,m|0;if((x|0)<(d|0))return m=12,m|0;if((x|0)==(d|0))return c[m>>2]=h,c[m+4>>2]=f,m=0,m|0;if(_=St(d|0,0,52)|0,_=_|h,h=Y()|0|f&-15728641,(x|0)>(d|0))do f=St(7,0,(14-d|0)*3|0)|0,d=d+1|0,_=f|_,h=Y()|0|h;while((d|0)<(x|0));return c[m>>2]=_,c[m+4>>2]=h,m=0,m|0}function QA(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0;if(x=ct(h|0,f|0,52)|0,Y()|0,x=x&15,!((d|0)<16&(x|0)<=(d|0)))return m=4,m|0;_=d-x|0,d=ct(h|0,f|0,45)|0,Y()|0;e:do if(!(Mi(d&127)|0))d=pu(7,0,_,((_|0)<0)<<31>>31)|0,_=Y()|0;else{t:do if(x|0){for(d=1;T=St(7,0,(15-d|0)*3|0)|0,!!((T&h|0)==0&((Y()|0)&f|0)==0);)if(d>>>0<x>>>0)d=d+1|0;else break t;d=pu(7,0,_,((_|0)<0)<<31>>31)|0,_=Y()|0;break e}while(!1);d=pu(7,0,_,((_|0)<0)<<31>>31)|0,d=us(d|0,Y()|0,5,0)|0,d=rn(d|0,Y()|0,-5,-1)|0,d=gu(d|0,Y()|0,6,0)|0,d=rn(d|0,Y()|0,1,0)|0,_=Y()|0}while(!1);return T=m,c[T>>2]=d,c[T+4>>2]=_,T=0,T|0}function yi(h,f){h=h|0,f=f|0;var d=0,m=0,_=0;if(_=ct(h|0,f|0,45)|0,Y()|0,!(Mi(_&127)|0))return _=0,_|0;_=ct(h|0,f|0,52)|0,Y()|0,_=_&15;e:do if(!_)d=0;else for(m=1;;){if(d=ct(h|0,f|0,(15-m|0)*3|0)|0,Y()|0,d=d&7,d|0)break e;if(m>>>0<_>>>0)m=m+1|0;else{d=0;break}}while(!1);return _=(d|0)==0&1,_|0}function _B(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0;if(T=Q,Q=Q+16|0,x=T,H_(x,h,f,d),f=x,h=c[f>>2]|0,f=c[f+4>>2]|0,(h|0)==0&(f|0)==0)return Q=T,0;_=0,d=0;do M=m+(_<<3)|0,c[M>>2]=h,c[M+4>>2]=f,_=rn(_|0,d|0,1,0)|0,d=Y()|0,W_(x),M=x,h=c[M>>2]|0,f=c[M+4>>2]|0;while(!((h|0)==0&(f|0)==0));return Q=T,0}function s8(h,f,d,m){return h=h|0,f=f|0,d=d|0,m=m|0,(m|0)<(d|0)?(d=f,m=h,lt(d|0),m|0):(d=St(-1,-1,((m-d|0)*3|0)+3|0)|0,m=St(~d|0,~(Y()|0)|0,(15-m|0)*3|0)|0,d=~(Y()|0)&f,m=~m&h,lt(d|0),m|0)}function o8(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0;return _=ct(h|0,f|0,52)|0,Y()|0,_=_&15,(d|0)<16&(_|0)<=(d|0)?((_|0)<(d|0)&&(_=St(-1,-1,((d+-1-_|0)*3|0)+3|0)|0,_=St(~_|0,~(Y()|0)|0,(15-d|0)*3|0)|0,f=~(Y()|0)&f,h=~_&h),_=St(d|0,0,52)|0,d=f&-15728641|(Y()|0),c[m>>2]=h|_,c[m+4>>2]=d,m=0,m|0):(m=4,m|0)}function vB(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0,vt=0,Ht=0,Vt=0,gn=0,xn=0,On=0,fn=0,Wt=0,_t=0;if((d|0)==0&(m|0)==0)return _t=0,_t|0;if(_=h,x=c[_>>2]|0,_=c[_+4>>2]|0,!0&(_&15728640|0)==0){if(!((m|0)>0|(m|0)==0&d>>>0>0)||(_t=f,c[_t>>2]=x,c[_t+4>>2]=_,(d|0)==1&(m|0)==0))return _t=0,_t|0;_=1,x=0;do fn=h+(_<<3)|0,Wt=c[fn+4>>2]|0,_t=f+(_<<3)|0,c[_t>>2]=c[fn>>2],c[_t+4>>2]=Wt,_=rn(_|0,x|0,1,0)|0,x=Y()|0;while((x|0)<(m|0)|(x|0)==(m|0)&_>>>0<d>>>0);return _=0,_|0}if(On=d<<3,Wt=ka(On)|0,!Wt)return _t=13,_t|0;if(Oh(Wt|0,h|0,On|0)|0,fn=Go(d,8)|0,!fn)return hn(Wt),_t=13,_t|0;e:for(;;){_=Wt,I=c[_>>2]|0,_=c[_+4>>2]|0,gn=ct(I|0,_|0,52)|0,Y()|0,gn=gn&15,xn=gn+-1|0,Vt=(gn|0)!=0,Ht=(m|0)>0|(m|0)==0&d>>>0>0;t:do if(Vt&Ht){if(ze=St(xn|0,0,52)|0,Ue=Y()|0,xn>>>0>15){if(!((I|0)==0&(_|0)==0)){_t=16;break e}for(x=0,h=0;;){if(x=rn(x|0,h|0,1,0)|0,h=Y()|0,!((h|0)<(m|0)|(h|0)==(m|0)&x>>>0<d>>>0))break t;if(T=Wt+(x<<3)|0,vt=c[T>>2]|0,T=c[T+4>>2]|0,!((vt|0)==0&(T|0)==0)){_=T,_t=16;break e}}}for(M=I,h=_,x=0,T=0;;){if(!((M|0)==0&(h|0)==0)){if(!(!0&(h&117440512|0)==0)){_t=21;break e}if(k=ct(M|0,h|0,52)|0,Y()|0,k=k&15,(k|0)<(xn|0)){_=12,_t=27;break e}if((k|0)!=(xn|0)&&(M=M|ze,h=h&-15728641|Ue,k>>>0>=gn>>>0)){N=xn;do vt=St(7,0,(14-N|0)*3|0)|0,N=N+1|0,M=vt|M,h=Y()|0|h;while(N>>>0<k>>>0)}if(he=Uh(M|0,h|0,d|0,m|0)|0,ue=Y()|0,N=fn+(he<<3)|0,k=N,te=c[k>>2]|0,k=c[k+4>>2]|0,!((te|0)==0&(k|0)==0)){Pe=0,He=0;do{if((Pe|0)>(m|0)|(Pe|0)==(m|0)&He>>>0>d>>>0){_t=31;break e}if((te|0)==(M|0)&(k&-117440513|0)==(h|0)){ce=ct(te|0,k|0,56)|0,Y()|0,ce=ce&7,be=ce+1|0,vt=ct(te|0,k|0,45)|0,Y()|0;n:do if(!(Mi(vt&127)|0))k=7;else{if(te=ct(te|0,k|0,52)|0,Y()|0,te=te&15,!te){k=6;break}for(k=1;;){if(vt=St(7,0,(15-k|0)*3|0)|0,!((vt&M|0)==0&((Y()|0)&h|0)==0)){k=7;break n}if(k>>>0<te>>>0)k=k+1|0;else{k=6;break}}}while(!1);if((ce+2|0)>>>0>k>>>0){_t=41;break e}vt=St(be|0,0,56)|0,h=Y()|0|h&-117440513,Se=N,c[Se>>2]=0,c[Se+4>>2]=0,M=vt|M}else he=rn(he|0,ue|0,1,0)|0,he=Fh(he|0,Y()|0,d|0,m|0)|0,ue=Y()|0;He=rn(He|0,Pe|0,1,0)|0,Pe=Y()|0,N=fn+(he<<3)|0,k=N,te=c[k>>2]|0,k=c[k+4>>2]|0}while(!((te|0)==0&(k|0)==0))}vt=N,c[vt>>2]=M,c[vt+4>>2]=h}if(x=rn(x|0,T|0,1,0)|0,T=Y()|0,!((T|0)<(m|0)|(T|0)==(m|0)&x>>>0<d>>>0))break t;h=Wt+(x<<3)|0,M=c[h>>2]|0,h=c[h+4>>2]|0}}while(!1);if(vt=rn(d|0,m|0,5,0)|0,Se=Y()|0,Se>>>0<0|(Se|0)==0&vt>>>0<11){_t=85;break}if(vt=gu(d|0,m|0,6,0)|0,Y()|0,vt=Go(vt,8)|0,!vt){_t=48;break}do if(Ht){for(be=0,h=0,ce=0,Pe=0;;){if(k=fn+(be<<3)|0,T=k,x=c[T>>2]|0,T=c[T+4>>2]|0,(x|0)==0&(T|0)==0)Se=ce;else{te=ct(x|0,T|0,56)|0,Y()|0,te=te&7,M=te+1|0,he=T&-117440513,Se=ct(x|0,T|0,45)|0,Y()|0;t:do if(Mi(Se&127)|0){if(ue=ct(x|0,T|0,52)|0,Y()|0,ue=ue&15,ue|0)for(N=1;;){if(Se=St(7,0,(15-N|0)*3|0)|0,!((x&Se|0)==0&(he&(Y()|0)|0)==0))break t;if(N>>>0<ue>>>0)N=N+1|0;else break}T=St(M|0,0,56)|0,x=T|x,T=Y()|0|he,M=k,c[M>>2]=x,c[M+4>>2]=T,M=te+2|0}while(!1);(M|0)==7?(Se=vt+(h<<3)|0,c[Se>>2]=x,c[Se+4>>2]=T&-117440513,h=rn(h|0,ce|0,1,0)|0,Se=Y()|0):Se=ce}if(be=rn(be|0,Pe|0,1,0)|0,Pe=Y()|0,(Pe|0)<(m|0)|(Pe|0)==(m|0)&be>>>0<d>>>0)ce=Se;else break}if(Ht){if(He=xn>>>0>15,ze=St(xn|0,0,52)|0,Ue=Y()|0,!Vt){for(x=0,N=0,M=0,T=0;(I|0)==0&(_|0)==0||(xn=f+(x<<3)|0,c[xn>>2]=I,c[xn+4>>2]=_,x=rn(x|0,N|0,1,0)|0,N=Y()|0),M=rn(M|0,T|0,1,0)|0,T=Y()|0,!!((T|0)<(m|0)|(T|0)==(m|0)&M>>>0<d>>>0);)_=Wt+(M<<3)|0,I=c[_>>2]|0,_=c[_+4>>2]|0;_=Se;break}for(x=0,N=0,T=0,M=0;;){do if(!((I|0)==0&(_|0)==0)){if(ue=ct(I|0,_|0,52)|0,Y()|0,ue=ue&15,He|(ue|0)<(xn|0)){_t=80;break e}if((ue|0)!=(xn|0)){if(k=I|ze,te=_&-15728641|Ue,ue>>>0>=gn>>>0){he=xn;do Vt=St(7,0,(14-he|0)*3|0)|0,he=he+1|0,k=Vt|k,te=Y()|0|te;while(he>>>0<ue>>>0)}}else k=I,te=_;ce=Uh(k|0,te|0,d|0,m|0)|0,he=0,ue=0,Pe=Y()|0;do{if((he|0)>(m|0)|(he|0)==(m|0)&ue>>>0>d>>>0){_t=81;break e}if(Vt=fn+(ce<<3)|0,be=c[Vt+4>>2]|0,(be&-117440513|0)==(te|0)&&(c[Vt>>2]|0)==(k|0)){_t=65;break}Vt=rn(ce|0,Pe|0,1,0)|0,ce=Fh(Vt|0,Y()|0,d|0,m|0)|0,Pe=Y()|0,ue=rn(ue|0,he|0,1,0)|0,he=Y()|0,Vt=fn+(ce<<3)|0}while(!((c[Vt>>2]|0)==(k|0)&&(c[Vt+4>>2]|0)==(te|0)));if((_t|0)==65&&(_t=0,!0&(be&117440512|0)==100663296))break;Vt=f+(x<<3)|0,c[Vt>>2]=I,c[Vt+4>>2]=_,x=rn(x|0,N|0,1,0)|0,N=Y()|0}while(!1);if(T=rn(T|0,M|0,1,0)|0,M=Y()|0,!((M|0)<(m|0)|(M|0)==(m|0)&T>>>0<d>>>0))break;_=Wt+(T<<3)|0,I=c[_>>2]|0,_=c[_+4>>2]|0}_=Se}else x=0,_=Se}else x=0,h=0,_=0;while(!1);if(mc(fn|0,0,On|0)|0,Oh(Wt|0,vt|0,h<<3|0)|0,hn(vt),(h|0)==0&(_|0)==0){_t=89;break}else f=f+(x<<3)|0,m=_,d=h}if((_t|0)==16)!0&(_&117440512|0)==0?(_=4,_t=27):_t=21;else if((_t|0)==31)mt(27795,27122,529,27132);else{if((_t|0)==41)return hn(Wt),hn(fn),_t=10,_t|0;if((_t|0)==48)return hn(Wt),hn(fn),_t=13,_t|0;(_t|0)==80?mt(27795,27122,620,27132):(_t|0)==81?mt(27795,27122,632,27132):(_t|0)==85&&(Oh(f|0,Wt|0,d<<3|0)|0,_t=89)}return(_t|0)==21?(hn(Wt),hn(fn),_t=5,_t|0):(_t|0)==27?(hn(Wt),hn(fn),_t=_,_t|0):(_t|0)==89?(hn(Wt),hn(fn),_t=0,_t|0):0}function yB(h,f,d,m,_,x,T){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0,x=x|0,T=T|0;var M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0;if(be=Q,Q=Q+16|0,ce=be,!((d|0)>0|(d|0)==0&f>>>0>0))return ce=0,Q=be,ce|0;if((T|0)>=16)return ce=12,Q=be,ce|0;he=0,ue=0,te=0,M=0;e:for(;;){if(I=h+(he<<3)|0,N=c[I>>2]|0,I=c[I+4>>2]|0,k=ct(N|0,I|0,52)|0,Y()|0,(k&15|0)>(T|0)){M=12,N=11;break}if(H_(ce,N,I,T),k=ce,I=c[k>>2]|0,k=c[k+4>>2]|0,(I|0)==0&(k|0)==0)N=te;else{N=te;do{if(!((M|0)<(x|0)|(M|0)==(x|0)&N>>>0<_>>>0)){N=10;break e}te=m+(N<<3)|0,c[te>>2]=I,c[te+4>>2]=k,N=rn(N|0,M|0,1,0)|0,M=Y()|0,W_(ce),te=ce,I=c[te>>2]|0,k=c[te+4>>2]|0}while(!((I|0)==0&(k|0)==0))}if(he=rn(he|0,ue|0,1,0)|0,ue=Y()|0,(ue|0)<(d|0)|(ue|0)==(d|0)&he>>>0<f>>>0)te=N;else{M=0,N=11;break}}return(N|0)==10?(ce=14,Q=be,ce|0):(N|0)==11?(Q=be,M|0):0}function xB(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0;he=Q,Q=Q+16|0,te=he;e:do if((d|0)>0|(d|0)==0&f>>>0>0){for(I=0,T=0,x=0,k=0;;){if(N=h+(I<<3)|0,M=c[N>>2]|0,N=c[N+4>>2]|0,!((M|0)==0&(N|0)==0)&&(N=(QA(M,N,m,te)|0)==0,M=te,T=rn(c[M>>2]|0,c[M+4>>2]|0,T|0,x|0)|0,x=Y()|0,!N)){x=12;break}if(I=rn(I|0,k|0,1,0)|0,k=Y()|0,!((k|0)<(d|0)|(k|0)==(d|0)&I>>>0<f>>>0))break e}return Q=he,x|0}else T=0,x=0;while(!1);return c[_>>2]=T,c[_+4>>2]=x,_=0,Q=he,_|0}function bB(h,f){return h=h|0,f=f|0,f=ct(h|0,f|0,52)|0,Y()|0,f&1|0}function js(h,f){h=h|0,f=f|0;var d=0,m=0,_=0;if(_=ct(h|0,f|0,52)|0,Y()|0,_=_&15,!_)return _=0,_|0;for(m=1;;){if(d=ct(h|0,f|0,(15-m|0)*3|0)|0,Y()|0,d=d&7,d|0){m=5;break}if(m>>>0<_>>>0)m=m+1|0;else{d=0,m=5;break}}return(m|0)==5?d|0:0}function k_(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0,N=0;if(N=ct(h|0,f|0,52)|0,Y()|0,N=N&15,!N)return M=f,N=h,lt(M|0),N|0;for(M=1,d=0;;){x=(15-M|0)*3|0,m=St(7,0,x|0)|0,_=Y()|0,T=ct(h|0,f|0,x|0)|0,Y()|0,x=St(Ac(T&7)|0,0,x|0)|0,T=Y()|0,h=x|h&~m,f=T|f&~_;e:do if(!d)if((x&m|0)==0&(T&_|0)==0)d=0;else if(m=ct(h|0,f|0,52)|0,Y()|0,m=m&15,!m)d=1;else{d=1;t:for(;;){switch(T=ct(h|0,f|0,(15-d|0)*3|0)|0,Y()|0,T&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<m>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(T=(15-d|0)*3|0,_=ct(h|0,f|0,T|0)|0,Y()|0,x=St(7,0,T|0)|0,f=f&~(Y()|0),T=St(Ac(_&7)|0,0,T|0)|0,h=h&~x|T,f=f|(Y()|0),d>>>0<m>>>0)d=d+1|0;else{d=1;break}}while(!1);if(M>>>0<N>>>0)M=M+1|0;else break}return lt(f|0),h|0}function dc(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0;if(m=ct(h|0,f|0,52)|0,Y()|0,m=m&15,!m)return d=f,m=h,lt(d|0),m|0;for(d=1;x=(15-d|0)*3|0,T=ct(h|0,f|0,x|0)|0,Y()|0,_=St(7,0,x|0)|0,f=f&~(Y()|0),x=St(Ac(T&7)|0,0,x|0)|0,h=x|h&~_,f=Y()|0|f,d>>>0<m>>>0;)d=d+1|0;return lt(f|0),h|0}function TB(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0,N=0;if(N=ct(h|0,f|0,52)|0,Y()|0,N=N&15,!N)return M=f,N=h,lt(M|0),N|0;for(M=1,d=0;;){x=(15-M|0)*3|0,m=St(7,0,x|0)|0,_=Y()|0,T=ct(h|0,f|0,x|0)|0,Y()|0,x=St(du(T&7)|0,0,x|0)|0,T=Y()|0,h=x|h&~m,f=T|f&~_;e:do if(!d)if((x&m|0)==0&(T&_|0)==0)d=0;else if(m=ct(h|0,f|0,52)|0,Y()|0,m=m&15,!m)d=1;else{d=1;t:for(;;){switch(T=ct(h|0,f|0,(15-d|0)*3|0)|0,Y()|0,T&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<m>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(_=(15-d|0)*3|0,x=St(7,0,_|0)|0,T=f&~(Y()|0),f=ct(h|0,f|0,_|0)|0,Y()|0,f=St(du(f&7)|0,0,_|0)|0,h=h&~x|f,f=T|(Y()|0),d>>>0<m>>>0)d=d+1|0;else{d=1;break}}while(!1);if(M>>>0<N>>>0)M=M+1|0;else break}return lt(f|0),h|0}function V_(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0;if(m=ct(h|0,f|0,52)|0,Y()|0,m=m&15,!m)return d=f,m=h,lt(d|0),m|0;for(d=1;T=(15-d|0)*3|0,x=St(7,0,T|0)|0,_=f&~(Y()|0),f=ct(h|0,f|0,T|0)|0,Y()|0,f=St(du(f&7)|0,0,T|0)|0,h=f|h&~x,f=Y()|0|_,d>>>0<m>>>0;)d=d+1|0;return lt(f|0),h|0}function SB(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0;if(N=Q,Q=Q+64|0,M=N+40|0,m=N+24|0,_=N+12|0,x=N,St(f|0,0,52)|0,d=Y()|0|134225919,!f)return(c[h+4>>2]|0)>2||(c[h+8>>2]|0)>2||(c[h+12>>2]|0)>2?(T=0,M=0,lt(T|0),Q=N,M|0):(St(G5(h)|0,0,45)|0,T=Y()|0|d,M=-1,lt(T|0),Q=N,M|0);if(c[M>>2]=c[h>>2],c[M+4>>2]=c[h+4>>2],c[M+8>>2]=c[h+8>>2],c[M+12>>2]=c[h+12>>2],T=M+4|0,(f|0)>0)for(h=-1;c[m>>2]=c[T>>2],c[m+4>>2]=c[T+4>>2],c[m+8>>2]=c[T+8>>2],f&1?(tB(T),c[_>>2]=c[T>>2],c[_+4>>2]=c[T+4>>2],c[_+8>>2]=c[T+8>>2],$p(_)):(Y5(T),c[_>>2]=c[T>>2],c[_+4>>2]=c[T+4>>2],c[_+8>>2]=c[T+8>>2],fc(_)),L_(m,_,x),ls(x),k=(15-f|0)*3|0,I=St(7,0,k|0)|0,d=d&~(Y()|0),k=St(Wp(x)|0,0,k|0)|0,h=k|h&~I,d=Y()|0|d,(f|0)>1;)f=f+-1|0;else h=-1;e:do if((c[T>>2]|0)<=2&&(c[M+8>>2]|0)<=2&&(c[M+12>>2]|0)<=2){if(m=G5(M)|0,f=St(m|0,0,45)|0,f=f|h,h=Y()|0|d&-1040385,x=zI(M)|0,!(Mi(m)|0)){if((x|0)<=0)break;for(_=0;;){if(m=ct(f|0,h|0,52)|0,Y()|0,m=m&15,m)for(d=1;k=(15-d|0)*3|0,M=ct(f|0,h|0,k|0)|0,Y()|0,I=St(7,0,k|0)|0,h=h&~(Y()|0),k=St(Ac(M&7)|0,0,k|0)|0,f=f&~I|k,h=h|(Y()|0),d>>>0<m>>>0;)d=d+1|0;if(_=_+1|0,(_|0)==(x|0))break e}}_=ct(f|0,h|0,52)|0,Y()|0,_=_&15;t:do if(_){d=1;n:for(;;){switch(k=ct(f|0,h|0,(15-d|0)*3|0)|0,Y()|0,k&7){case 1:break n;case 0:break;default:break t}if(d>>>0<_>>>0)d=d+1|0;else break t}if(H5(m,c[M>>2]|0)|0)for(d=1;M=(15-d|0)*3|0,I=St(7,0,M|0)|0,k=h&~(Y()|0),h=ct(f|0,h|0,M|0)|0,Y()|0,h=St(du(h&7)|0,0,M|0)|0,f=f&~I|h,h=k|(Y()|0),d>>>0<_>>>0;)d=d+1|0;else for(d=1;k=(15-d|0)*3|0,M=ct(f|0,h|0,k|0)|0,Y()|0,I=St(7,0,k|0)|0,h=h&~(Y()|0),k=St(Ac(M&7)|0,0,k|0)|0,f=f&~I|k,h=h|(Y()|0),d>>>0<_>>>0;)d=d+1|0}while(!1);if((x|0)>0){d=0;do f=k_(f,h)|0,h=Y()|0,d=d+1|0;while((d|0)!=(x|0))}}else f=0,h=0;while(!1);return I=h,k=f,lt(I|0),Q=N,k|0}function zo(h){return h=h|0,(h|0)%2|0|0}function z_(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0;return _=Q,Q=Q+16|0,m=_,f>>>0>15?(m=4,Q=_,m|0):(c[h+4>>2]&2146435072|0)==2146435072||(c[h+8+4>>2]&2146435072|0)==2146435072?(m=3,Q=_,m|0):(fB(h,f,m),f=SB(m,f)|0,m=Y()|0,c[d>>2]=f,c[d+4>>2]=m,(f|0)==0&(m|0)==0&&mt(27795,27122,959,27145),m=0,Q=_,m|0)}function q_(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0;if(_=d+4|0,x=ct(h|0,f|0,52)|0,Y()|0,x=x&15,T=ct(h|0,f|0,45)|0,Y()|0,m=(x|0)==0,Mi(T&127)|0){if(m)return T=1,T|0;m=1}else{if(m)return T=0,T|0;(c[_>>2]|0)==0&&(c[d+8>>2]|0)==0?m=(c[d+12>>2]|0)!=0&1:m=1}for(d=1;d&1?$p(_):fc(_),T=ct(h|0,f|0,(15-d|0)*3|0)|0,Y()|0,Z5(_,T&7),d>>>0<x>>>0;)d=d+1|0;return m|0}function Dh(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0;if(k=Q,Q=Q+16|0,N=k,I=ct(h|0,f|0,45)|0,Y()|0,I=I&127,I>>>0>121)return c[d>>2]=0,c[d+4>>2]=0,c[d+8>>2]=0,c[d+12>>2]=0,I=5,Q=k,I|0;e:do if((Mi(I)|0)!=0&&(x=ct(h|0,f|0,52)|0,Y()|0,x=x&15,(x|0)!=0)){m=1;t:for(;;){switch(M=ct(h|0,f|0,(15-m|0)*3|0)|0,Y()|0,M&7){case 5:break t;case 0:break;default:{m=f;break e}}if(m>>>0<x>>>0)m=m+1|0;else{m=f;break e}}for(_=1,m=f;f=(15-_|0)*3|0,T=St(7,0,f|0)|0,M=m&~(Y()|0),m=ct(h|0,m|0,f|0)|0,Y()|0,m=St(du(m&7)|0,0,f|0)|0,h=h&~T|m,m=M|(Y()|0),_>>>0<x>>>0;)_=_+1|0}else m=f;while(!1);if(M=7696+(I*28|0)|0,c[d>>2]=c[M>>2],c[d+4>>2]=c[M+4>>2],c[d+8>>2]=c[M+8>>2],c[d+12>>2]=c[M+12>>2],!(q_(h,m,d)|0))return I=0,Q=k,I|0;if(T=d+4|0,c[N>>2]=c[T>>2],c[N+4>>2]=c[T+4>>2],c[N+8>>2]=c[T+8>>2],x=ct(h|0,m|0,52)|0,Y()|0,M=x&15,x&1?(fc(T),x=M+1|0):x=M,!(Mi(I)|0))m=0;else{e:do if(!M)m=0;else for(f=1;;){if(_=ct(h|0,m|0,(15-f|0)*3|0)|0,Y()|0,_=_&7,_|0){m=_;break e}if(f>>>0<M>>>0)f=f+1|0;else{m=0;break}}while(!1);m=(m|0)==4&1}if(!(Lh(d,x,m,0)|0))(x|0)!=(M|0)&&(c[T>>2]=c[N>>2],c[T+4>>2]=c[N+4>>2],c[T+8>>2]=c[N+8>>2]);else{if(Mi(I)|0)do;while((Lh(d,x,0,0)|0)!=0);(x|0)!=(M|0)&&Y5(T)}return I=0,Q=k,I|0}function pc(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0;return x=Q,Q=Q+16|0,m=x,_=Dh(h,f,m)|0,_|0?(Q=x,_|0):(_=ct(h|0,f|0,52)|0,Y()|0,pB(m,_&15,d),_=0,Q=x,_|0)}function Ih(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0;if(T=Q,Q=Q+16|0,x=T,m=Dh(h,f,x)|0,m|0)return x=m,Q=T,x|0;m=ct(h|0,f|0,45)|0,Y()|0,m=(Mi(m&127)|0)==0,_=ct(h|0,f|0,52)|0,Y()|0,_=_&15;e:do if(!m){if(_|0)for(m=1;;){if(M=St(7,0,(15-m|0)*3|0)|0,!((M&h|0)==0&((Y()|0)&f|0)==0))break e;if(m>>>0<_>>>0)m=m+1|0;else break}return I_(x,_,0,5,d),M=0,Q=T,M|0}while(!1);return B_(x,_,0,6,d),M=0,Q=T,M|0}function wB(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0;if(_=ct(h|0,f|0,45)|0,Y()|0,!(Mi(_&127)|0))return _=2,c[d>>2]=_,0;if(_=ct(h|0,f|0,52)|0,Y()|0,_=_&15,!_)return _=5,c[d>>2]=_,0;for(m=1;;){if(x=St(7,0,(15-m|0)*3|0)|0,!((x&h|0)==0&((Y()|0)&f|0)==0)){m=2,h=6;break}if(m>>>0<_>>>0)m=m+1|0;else{m=5,h=6;break}}return(h|0)==6&&(c[d>>2]=m),0}function a8(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0;te=Q,Q=Q+128|0,I=te+112|0,x=te+96|0,k=te,_=ct(h|0,f|0,52)|0,Y()|0,M=_&15,c[I>>2]=M,T=ct(h|0,f|0,45)|0,Y()|0,T=T&127;e:do if(Mi(T)|0){if(M|0)for(m=1;;){if(N=St(7,0,(15-m|0)*3|0)|0,!((N&h|0)==0&((Y()|0)&f|0)==0)){_=0;break e}if(m>>>0<M>>>0)m=m+1|0;else break}if(_&1)_=1;else return N=St(M+1|0,0,52)|0,k=Y()|0|f&-15728641,I=St(7,0,(14-M|0)*3|0)|0,k=a8((N|h)&~I,k&~(Y()|0),d)|0,Q=te,k|0}else _=0;while(!1);if(m=Dh(h,f,x)|0,!m){_?(n8(x,I,k),N=5):(i8(x,I,k),N=6);e:do if(Mi(T)|0)if(!M)h=5;else for(m=1;;){if(T=St(7,0,(15-m|0)*3|0)|0,!((T&h|0)==0&((Y()|0)&f|0)==0)){h=2;break e}if(m>>>0<M>>>0)m=m+1|0;else{h=5;break}}else h=2;while(!1);mc(d|0,-1,h<<2|0)|0;e:do if(_)for(x=0;;){if(T=k+(x<<4)|0,mB(T,c[I>>2]|0)|0,T=c[T>>2]|0,M=c[d>>2]|0,(M|0)==-1|(M|0)==(T|0))m=d;else{_=0;do{if(_=_+1|0,_>>>0>=h>>>0){m=1;break e}m=d+(_<<2)|0,M=c[m>>2]|0}while(!((M|0)==-1|(M|0)==(T|0)))}if(c[m>>2]=T,x=x+1|0,x>>>0>=N>>>0){m=0;break}}else for(x=0;;){if(T=k+(x<<4)|0,Lh(T,c[I>>2]|0,0,1)|0,T=c[T>>2]|0,M=c[d>>2]|0,(M|0)==-1|(M|0)==(T|0))m=d;else{_=0;do{if(_=_+1|0,_>>>0>=h>>>0){m=1;break e}m=d+(_<<2)|0,M=c[m>>2]|0}while(!((M|0)==-1|(M|0)==(T|0)))}if(c[m>>2]=T,x=x+1|0,x>>>0>=N>>>0){m=0;break}}while(!1)}return k=m,Q=te,k|0}function MB(){return 12}function G_(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0,N=0;if(h>>>0>15)return M=4,M|0;if(St(h|0,0,52)|0,M=Y()|0|134225919,!h){d=0,m=0;do Mi(m)|0&&(St(m|0,0,45)|0,T=M|(Y()|0),h=f+(d<<3)|0,c[h>>2]=-1,c[h+4>>2]=T,d=d+1|0),m=m+1|0;while((m|0)!=122);return d=0,d|0}d=0,T=0;do{if(Mi(T)|0){for(St(T|0,0,45)|0,m=1,_=-1,x=M|(Y()|0);N=St(7,0,(15-m|0)*3|0)|0,_=_&~N,x=x&~(Y()|0),(m|0)!=(h|0);)m=m+1|0;N=f+(d<<3)|0,c[N>>2]=_,c[N+4>>2]=x,d=d+1|0}T=T+1|0}while((T|0)!=122);return d=0,d|0}function EB(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0;if(ze=Q,Q=Q+16|0,Pe=ze,He=ct(h|0,f|0,52)|0,Y()|0,He=He&15,d>>>0>15)return He=4,Q=ze,He|0;if((He|0)<(d|0))return He=12,Q=ze,He|0;if((He|0)!=(d|0))if(x=St(d|0,0,52)|0,x=x|h,M=Y()|0|f&-15728641,(He|0)>(d|0)){N=d;do be=St(7,0,(14-N|0)*3|0)|0,N=N+1|0,x=be|x,M=Y()|0|M;while((N|0)<(He|0));be=x}else be=x;else be=h,M=f;ce=ct(be|0,M|0,45)|0,Y()|0;e:do if(Mi(ce&127)|0){if(N=ct(be|0,M|0,52)|0,Y()|0,N=N&15,N|0)for(x=1;;){if(ce=St(7,0,(15-x|0)*3|0)|0,!((ce&be|0)==0&((Y()|0)&M|0)==0)){I=33;break e}if(x>>>0<N>>>0)x=x+1|0;else break}if(ce=m,c[ce>>2]=0,c[ce+4>>2]=0,(He|0)>(d|0)){for(ce=f&-15728641,ue=He;;){if(he=ue,ue=ue+-1|0,ue>>>0>15|(He|0)<(ue|0)){I=19;break}if((He|0)!=(ue|0))if(x=St(ue|0,0,52)|0,x=x|h,N=Y()|0|ce,(He|0)<(he|0))te=x;else{I=ue;do te=St(7,0,(14-I|0)*3|0)|0,I=I+1|0,x=te|x,N=Y()|0|N;while((I|0)<(He|0));te=x}else te=h,N=f;if(k=ct(te|0,N|0,45)|0,Y()|0,!(Mi(k&127)|0))x=0;else{k=ct(te|0,N|0,52)|0,Y()|0,k=k&15;t:do if(!k)x=0;else for(I=1;;){if(x=ct(te|0,N|0,(15-I|0)*3|0)|0,Y()|0,x=x&7,x|0)break t;if(I>>>0<k>>>0)I=I+1|0;else{x=0;break}}while(!1);x=(x|0)==0&1}if(N=ct(h|0,f|0,(15-he|0)*3|0)|0,Y()|0,N=N&7,(N|0)==7){_=5,I=42;break}if(x=(x|0)!=0,(N|0)==1&x){_=5,I=42;break}if(te=N+(((N|0)!=0&x)<<31>>31)|0,te|0&&(I=He-he|0,I=pu(7,0,I,((I|0)<0)<<31>>31)|0,k=Y()|0,x?(x=us(I|0,k|0,5,0)|0,x=rn(x|0,Y()|0,-5,-1)|0,x=gu(x|0,Y()|0,6,0)|0,x=rn(x|0,Y()|0,1,0)|0,N=Y()|0):(x=I,N=k),he=te+-1|0,he=us(I|0,k|0,he|0,((he|0)<0)<<31>>31|0)|0,he=rn(x|0,N|0,he|0,Y()|0)|0,te=Y()|0,k=m,k=rn(he|0,te|0,c[k>>2]|0,c[k+4>>2]|0)|0,te=Y()|0,he=m,c[he>>2]=k,c[he+4>>2]=te),(ue|0)<=(d|0)){I=37;break}}if((I|0)==19)mt(27795,27122,1276,27158);else if((I|0)==37){T=m,_=c[T+4>>2]|0,T=c[T>>2]|0;break}else if((I|0)==42)return Q=ze,_|0}else _=0,T=0}else I=33;while(!1);e:do if((I|0)==33)if(ce=m,c[ce>>2]=0,c[ce+4>>2]=0,(He|0)>(d|0)){for(x=He;;){if(_=ct(h|0,f|0,(15-x|0)*3|0)|0,Y()|0,_=_&7,(_|0)==7){_=5;break}if(T=He-x|0,T=pu(7,0,T,((T|0)<0)<<31>>31)|0,_=us(T|0,Y()|0,_|0,0)|0,T=Y()|0,ce=m,T=rn(c[ce>>2]|0,c[ce+4>>2]|0,_|0,T|0)|0,_=Y()|0,ce=m,c[ce>>2]=T,c[ce+4>>2]=_,x=x+-1|0,(x|0)<=(d|0))break e}return Q=ze,_|0}else _=0,T=0;while(!1);return QA(be,M,He,Pe)|0&&mt(27795,27122,1236,27173),He=Pe,Pe=c[He+4>>2]|0,((_|0)>-1|(_|0)==-1&T>>>0>4294967295)&((Pe|0)>(_|0)|((Pe|0)==(_|0)?(c[He>>2]|0)>>>0>T>>>0:0))?(He=0,Q=ze,He|0):(mt(27795,27122,1316,27158),0)}function CB(h,f,d,m,_,x){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0,x=x|0;var T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0;if(te=Q,Q=Q+16|0,T=te,_>>>0>15)return x=4,Q=te,x|0;if(M=ct(d|0,m|0,52)|0,Y()|0,M=M&15,(M|0)>(_|0))return x=12,Q=te,x|0;if(QA(d,m,_,T)|0&&mt(27795,27122,1236,27173),k=T,I=c[k+4>>2]|0,!(((f|0)>-1|(f|0)==-1&h>>>0>4294967295)&((I|0)>(f|0)|((I|0)==(f|0)?(c[k>>2]|0)>>>0>h>>>0:0))))return x=2,Q=te,x|0;k=_-M|0,_=St(_|0,0,52)|0,N=Y()|0|m&-15728641,I=x,c[I>>2]=_|d,c[I+4>>2]=N,I=ct(d|0,m|0,45)|0,Y()|0;e:do if(Mi(I&127)|0){if(M|0)for(T=1;;){if(I=St(7,0,(15-T|0)*3|0)|0,!((I&d|0)==0&((Y()|0)&m|0)==0))break e;if(T>>>0<M>>>0)T=T+1|0;else break}if((k|0)<1)return x=0,Q=te,x|0;for(I=M^15,m=-1,N=1,T=1;;){M=k-N|0,M=pu(7,0,M,((M|0)<0)<<31>>31)|0,d=Y()|0;do if(T)if(T=us(M|0,d|0,5,0)|0,T=rn(T|0,Y()|0,-5,-1)|0,T=gu(T|0,Y()|0,6,0)|0,_=Y()|0,(f|0)>(_|0)|(f|0)==(_|0)&h>>>0>T>>>0){f=rn(h|0,f|0,-1,-1)|0,f=Yr(f|0,Y()|0,T|0,_|0)|0,T=Y()|0,he=x,ce=c[he>>2]|0,he=c[he+4>>2]|0,be=(I+m|0)*3|0,ue=St(7,0,be|0)|0,he=he&~(Y()|0),m=gu(f|0,T|0,M|0,d|0)|0,h=Y()|0,_=rn(m|0,h|0,2,0)|0,be=St(_|0,Y()|0,be|0)|0,he=Y()|0|he,_=x,c[_>>2]=be|ce&~ue,c[_+4>>2]=he,h=us(m|0,h|0,M|0,d|0)|0,h=Yr(f|0,T|0,h|0,Y()|0)|0,T=0,f=Y()|0;break}else{be=x,ue=c[be>>2]|0,be=c[be+4>>2]|0,ce=St(7,0,(I+m|0)*3|0)|0,be=be&~(Y()|0),T=x,c[T>>2]=ue&~ce,c[T+4>>2]=be,T=1;break}else ue=x,_=c[ue>>2]|0,ue=c[ue+4>>2]|0,m=(I+m|0)*3|0,he=St(7,0,m|0)|0,ue=ue&~(Y()|0),be=gu(h|0,f|0,M|0,d|0)|0,T=Y()|0,m=St(be|0,T|0,m|0)|0,ue=Y()|0|ue,ce=x,c[ce>>2]=m|_&~he,c[ce+4>>2]=ue,T=us(be|0,T|0,M|0,d|0)|0,h=Yr(h|0,f|0,T|0,Y()|0)|0,T=0,f=Y()|0;while(!1);if((k|0)>(N|0))m=~N,N=N+1|0;else{f=0;break}}return Q=te,f|0}while(!1);if((k|0)<1)return be=0,Q=te,be|0;for(_=M^15,T=1;;)if(ce=k-T|0,ce=pu(7,0,ce,((ce|0)<0)<<31>>31)|0,be=Y()|0,N=x,d=c[N>>2]|0,N=c[N+4>>2]|0,M=(_-T|0)*3|0,m=St(7,0,M|0)|0,N=N&~(Y()|0),he=gu(h|0,f|0,ce|0,be|0)|0,ue=Y()|0,M=St(he|0,ue|0,M|0)|0,N=Y()|0|N,I=x,c[I>>2]=M|d&~m,c[I+4>>2]=N,be=us(he|0,ue|0,ce|0,be|0)|0,h=Yr(h|0,f|0,be|0,Y()|0)|0,f=Y()|0,(k|0)<=(T|0)){f=0;break}else T=T+1|0;return Q=te,f|0}function H_(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0;_=ct(f|0,d|0,52)|0,Y()|0,_=_&15,(f|0)==0&(d|0)==0|((m|0)>15|(_|0)>(m|0))?(x=-1,f=-1,d=0,_=0):(f=s8(f,d,_+1|0,m)|0,T=(Y()|0)&-15728641,d=St(m|0,0,52)|0,d=f|d,T=T|(Y()|0),f=(yi(d,T)|0)==0,x=_,f=f?-1:m,_=T),T=h,c[T>>2]=d,c[T+4>>2]=_,c[h+8>>2]=x,c[h+12>>2]=f}function l8(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0;if(_=ct(h|0,f|0,52)|0,Y()|0,_=_&15,x=m+8|0,c[x>>2]=_,(h|0)==0&(f|0)==0|((d|0)>15|(_|0)>(d|0))){d=m,c[d>>2]=0,c[d+4>>2]=0,c[x>>2]=-1,c[m+12>>2]=-1;return}if(h=s8(h,f,_+1|0,d)|0,x=(Y()|0)&-15728641,_=St(d|0,0,52)|0,_=h|_,x=x|(Y()|0),h=m,c[h>>2]=_,c[h+4>>2]=x,h=m+12|0,yi(_,x)|0){c[h>>2]=d;return}else{c[h>>2]=-1;return}}function W_(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0;if(d=h,f=c[d>>2]|0,d=c[d+4>>2]|0,!((f|0)==0&(d|0)==0)&&(m=ct(f|0,d|0,52)|0,Y()|0,m=m&15,M=St(1,0,(m^15)*3|0)|0,f=rn(M|0,Y()|0,f|0,d|0)|0,d=Y()|0,M=h,c[M>>2]=f,c[M+4>>2]=d,M=h+8|0,T=c[M>>2]|0,!((m|0)<(T|0)))){for(N=h+12|0,x=m;;){if((x|0)==(T|0)){m=5;break}if(I=(x|0)==(c[N>>2]|0),_=(15-x|0)*3|0,m=ct(f|0,d|0,_|0)|0,Y()|0,m=m&7,I&((m|0)==1&!0)){m=7;break}if(!((m|0)==7&!0)){m=10;break}if(I=St(1,0,_|0)|0,f=rn(f|0,d|0,I|0,Y()|0)|0,d=Y()|0,I=h,c[I>>2]=f,c[I+4>>2]=d,(x|0)>(T|0))x=x+-1|0;else{m=10;break}}if((m|0)==5){I=h,c[I>>2]=0,c[I+4>>2]=0,c[M>>2]=-1,c[N>>2]=-1;return}else if((m|0)==7){T=St(1,0,_|0)|0,T=rn(f|0,d|0,T|0,Y()|0)|0,M=Y()|0,I=h,c[I>>2]=T,c[I+4>>2]=M,c[N>>2]=x+-1;return}else if((m|0)==10)return}}function YA(h){h=+h;var f=0;return f=h<0?h+6.283185307179586:h,+(h>=6.283185307179586?f+-6.283185307179586:f)}function Bh(h,f){return h=h|0,f=f|0,+an(+(+X[h>>3]-+X[f>>3]))<17453292519943298e-27?(f=+an(+(+X[h+8>>3]-+X[f+8>>3]))<17453292519943298e-27,f|0):(f=0,f|0)}function go(h,f){switch(h=+h,f=f|0,f|0){case 1:{h=h<0?h+6.283185307179586:h;break}case 2:{h=h>0?h+-6.283185307179586:h;break}}return+h}function RB(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0;return _=+X[f>>3],m=+X[h>>3],x=+qt(+((_-m)*.5)),d=+qt(+((+X[f+8>>3]-+X[h+8>>3])*.5)),d=x*x+d*(+un(+_)*+un(+m)*d),+(+Re(+ +ht(+d),+ +ht(+(1-d)))*2)}function ZA(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0;return _=+X[f>>3],m=+X[h>>3],x=+qt(+((_-m)*.5)),d=+qt(+((+X[f+8>>3]-+X[h+8>>3])*.5)),d=x*x+d*(+un(+_)*+un(+m)*d),+(+Re(+ +ht(+d),+ +ht(+(1-d)))*2*6371.007180918475)}function NB(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0;return _=+X[f>>3],m=+X[h>>3],x=+qt(+((_-m)*.5)),d=+qt(+((+X[f+8>>3]-+X[h+8>>3])*.5)),d=x*x+d*(+un(+_)*+un(+m)*d),+(+Re(+ +ht(+d),+ +ht(+(1-d)))*2*6371.007180918475*1e3)}function PB(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0;return x=+X[f>>3],m=+un(+x),_=+X[f+8>>3]-+X[h+8>>3],T=m*+qt(+_),d=+X[h>>3],+ +Re(+T,+(+qt(+x)*+un(+d)-+un(+_)*(m*+qt(+d))))}function LB(h,f,d,m){h=h|0,f=+f,d=+d,m=m|0;var _=0,x=0,T=0,M=0;if(d<1e-16){c[m>>2]=c[h>>2],c[m+4>>2]=c[h+4>>2],c[m+8>>2]=c[h+8>>2],c[m+12>>2]=c[h+12>>2];return}x=f<0?f+6.283185307179586:f,x=f>=6.283185307179586?x+-6.283185307179586:x;do if(x<1e-16)f=+X[h>>3]+d,X[m>>3]=f,_=m;else{if(_=+an(+(x+-3.141592653589793))<1e-16,f=+X[h>>3],_){f=f-d,X[m>>3]=f,_=m;break}if(T=+un(+d),d=+qt(+d),f=T*+qt(+f)+ +un(+x)*(d*+un(+f)),f=f>1?1:f,f=+Oa(+(f<-1?-1:f)),X[m>>3]=f,+an(+(f+-1.5707963267948966))<1e-16){X[m>>3]=1.5707963267948966,X[m+8>>3]=0;return}if(+an(+(f+1.5707963267948966))<1e-16){X[m>>3]=-1.5707963267948966,X[m+8>>3]=0;return}if(M=1/+un(+f),x=d*+qt(+x)*M,d=+X[h>>3],f=M*((T-+qt(+f)*+qt(+d))/+un(+d)),T=x>1?1:x,f=f>1?1:f,f=+X[h+8>>3]+ +Re(+(T<-1?-1:T),+(f<-1?-1:f)),f>3.141592653589793)do f=f+-6.283185307179586;while(f>3.141592653589793);if(f<-3.141592653589793)do f=f+6.283185307179586;while(f<-3.141592653589793);X[m+8>>3]=f;return}while(!1);if(+an(+(f+-1.5707963267948966))<1e-16){X[_>>3]=1.5707963267948966,X[m+8>>3]=0;return}if(+an(+(f+1.5707963267948966))<1e-16){X[_>>3]=-1.5707963267948966,X[m+8>>3]=0;return}if(f=+X[h+8>>3],f>3.141592653589793)do f=f+-6.283185307179586;while(f>3.141592653589793);if(f<-3.141592653589793)do f=f+6.283185307179586;while(f<-3.141592653589793);X[m+8>>3]=f}function u8(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(X[f>>3]=+X[20656+(h<<3)>>3],f=0,f|0)}function DB(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(X[f>>3]=+X[20784+(h<<3)>>3],f=0,f|0)}function IB(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(X[f>>3]=+X[20912+(h<<3)>>3],f=0,f|0)}function BB(h,f){return h=h|0,f=f|0,h>>>0>15?(f=4,f|0):(X[f>>3]=+X[21040+(h<<3)>>3],f=0,f|0)}function $_(h,f){h=h|0,f=f|0;var d=0;return h>>>0>15?(f=4,f|0):(d=pu(7,0,h,((h|0)<0)<<31>>31)|0,d=us(d|0,Y()|0,120,0)|0,h=Y()|0,c[f>>2]=d|2,c[f+4>>2]=h,f=0,f|0)}function c8(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0;return he=+X[f>>3],k=+X[h>>3],N=+qt(+((he-k)*.5)),x=+X[f+8>>3],I=+X[h+8>>3],T=+qt(+((x-I)*.5)),M=+un(+k),te=+un(+he),T=N*N+T*(te*M*T),T=+Re(+ +ht(+T),+ +ht(+(1-T)))*2,N=+X[d>>3],he=+qt(+((N-he)*.5)),m=+X[d+8>>3],x=+qt(+((m-x)*.5)),_=+un(+N),x=he*he+x*(te*_*x),x=+Re(+ +ht(+x),+ +ht(+(1-x)))*2,N=+qt(+((k-N)*.5)),m=+qt(+((I-m)*.5)),m=N*N+m*(M*_*m),m=+Re(+ +ht(+m),+ +ht(+(1-m)))*2,_=(T+x+m)*.5,+(+ne(+ +ht(+(+cn(+(_*.5))*+cn(+((_-T)*.5))*+cn(+((_-x)*.5))*+cn(+((_-m)*.5)))))*4)}function j_(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0;if(M=Q,Q=Q+192|0,x=M+168|0,T=M,_=pc(h,f,x)|0,_|0)return d=_,Q=M,d|0;if(Ih(h,f,T)|0&&mt(27795,27190,415,27199),f=c[T>>2]|0,(f|0)>0){if(m=+c8(T+8|0,T+8+(((f|0)!=1&1)<<4)|0,x)+0,(f|0)!=1){h=1;do _=h,h=h+1|0,m=m+ +c8(T+8+(_<<4)|0,T+8+(((h|0)%(f|0)|0)<<4)|0,x);while((h|0)<(f|0))}}else m=0;return X[d>>3]=m,d=0,Q=M,d|0}function FB(h,f,d){return h=h|0,f=f|0,d=d|0,h=j_(h,f,d)|0,h|0||(X[d>>3]=+X[d>>3]*6371.007180918475*6371.007180918475),h|0}function UB(h,f,d){return h=h|0,f=f|0,d=d|0,h=j_(h,f,d)|0,h|0||(X[d>>3]=+X[d>>3]*6371.007180918475*6371.007180918475*1e3*1e3),h|0}function OB(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0;if(M=Q,Q=Q+176|0,T=M,h=Xp(h,f,T)|0,h|0)return T=h,Q=M,T|0;if(X[d>>3]=0,h=c[T>>2]|0,(h|0)<=1)return T=0,Q=M,T|0;f=h+-1|0,h=0,m=+X[T+8>>3],_=+X[T+16>>3],x=0;do h=h+1|0,I=m,m=+X[T+8+(h<<4)>>3],k=+qt(+((m-I)*.5)),N=_,_=+X[T+8+(h<<4)+8>>3],N=+qt(+((_-N)*.5)),N=k*k+N*(+un(+m)*+un(+I)*N),x=x+ +Re(+ +ht(+N),+ +ht(+(1-N)))*2;while((h|0)<(f|0));return X[d>>3]=x,T=0,Q=M,T|0}function kB(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0;if(M=Q,Q=Q+176|0,T=M,h=Xp(h,f,T)|0,h|0)return T=h,x=+X[d>>3],x=x*6371.007180918475,X[d>>3]=x,Q=M,T|0;if(X[d>>3]=0,h=c[T>>2]|0,(h|0)<=1)return T=0,x=0,x=x*6371.007180918475,X[d>>3]=x,Q=M,T|0;f=h+-1|0,h=0,m=+X[T+8>>3],_=+X[T+16>>3],x=0;do h=h+1|0,I=m,m=+X[T+8+(h<<4)>>3],k=+qt(+((m-I)*.5)),N=_,_=+X[T+8+(h<<4)+8>>3],N=+qt(+((_-N)*.5)),N=k*k+N*(+un(+I)*+un(+m)*N),x=x+ +Re(+ +ht(+N),+ +ht(+(1-N)))*2;while((h|0)!=(f|0));return X[d>>3]=x,T=0,k=x,k=k*6371.007180918475,X[d>>3]=k,Q=M,T|0}function VB(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0;if(M=Q,Q=Q+176|0,T=M,h=Xp(h,f,T)|0,h|0)return T=h,x=+X[d>>3],x=x*6371.007180918475,x=x*1e3,X[d>>3]=x,Q=M,T|0;if(X[d>>3]=0,h=c[T>>2]|0,(h|0)<=1)return T=0,x=0,x=x*6371.007180918475,x=x*1e3,X[d>>3]=x,Q=M,T|0;f=h+-1|0,h=0,m=+X[T+8>>3],_=+X[T+16>>3],x=0;do h=h+1|0,I=m,m=+X[T+8+(h<<4)>>3],k=+qt(+((m-I)*.5)),N=_,_=+X[T+8+(h<<4)+8>>3],N=+qt(+((_-N)*.5)),N=k*k+N*(+un(+I)*+un(+m)*N),x=x+ +Re(+ +ht(+N),+ +ht(+(1-N)))*2;while((h|0)!=(f|0));return X[d>>3]=x,T=0,k=x,k=k*6371.007180918475,k=k*1e3,X[d>>3]=k,Q=M,T|0}function zB(h){h=h|0;var f=0,d=0,m=0;return f=Go(1,12)|0,f||mt(27280,27235,49,27293),d=h+4|0,m=c[d>>2]|0,m|0?(m=m+8|0,c[m>>2]=f,c[d>>2]=f,f|0):(c[h>>2]|0&&mt(27310,27235,61,27333),m=h,c[m>>2]=f,c[d>>2]=f,f|0)}function qB(h,f){h=h|0,f=f|0;var d=0,m=0;return m=ka(24)|0,m||mt(27347,27235,78,27361),c[m>>2]=c[f>>2],c[m+4>>2]=c[f+4>>2],c[m+8>>2]=c[f+8>>2],c[m+12>>2]=c[f+12>>2],c[m+16>>2]=0,f=h+4|0,d=c[f>>2]|0,d|0?(c[d+16>>2]=m,c[f>>2]=m,m|0):(c[h>>2]|0&&mt(27376,27235,82,27361),c[h>>2]=m,c[f>>2]=m,m|0)}function h8(h){h=h|0;var f=0,d=0,m=0,_=0;if(h)for(m=1;;){if(f=c[h>>2]|0,f|0)do{if(d=c[f>>2]|0,d|0)do _=d,d=c[d+16>>2]|0,hn(_);while((d|0)!=0);_=f,f=c[f+8>>2]|0,hn(_)}while((f|0)!=0);if(f=h,h=c[h+8>>2]|0,m||hn(f),h)m=0;else break}}function GB(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0,vt=0,Ht=0,Vt=0,gn=0,xn=0,On=0,fn=0,Wt=0,_t=0,Dn=0,mi=0,Mn=0;if(_=h+8|0,c[_>>2]|0)return Mn=1,Mn|0;if(m=c[h>>2]|0,!m)return Mn=0,Mn|0;f=m,d=0;do d=d+1|0,f=c[f+8>>2]|0;while((f|0)!=0);if(d>>>0<2)return Mn=0,Mn|0;Dn=ka(d<<2)|0,Dn||mt(27396,27235,317,27415),_t=ka(d<<5)|0,_t||mt(27437,27235,321,27415),c[h>>2]=0,Ht=h+4|0,c[Ht>>2]=0,c[_>>2]=0,d=0,Wt=0,vt=0,te=0;e:for(;;){if(k=c[m>>2]|0,k){x=0,T=k;do{if(N=+X[T+8>>3],f=T,T=c[T+16>>2]|0,I=(T|0)==0,_=I?k:T,M=+X[_+8>>3],+an(+(N-M))>3.141592653589793){Mn=14;break}x=x+(M-N)*(+X[f>>3]+ +X[_>>3])}while(!I);if((Mn|0)==14){Mn=0,x=0,f=k;do Se=+X[f+8>>3],fn=f+16|0,On=c[fn>>2]|0,On=(On|0)==0?k:On,Ue=+X[On+8>>3],x=x+(+X[f>>3]+ +X[On>>3])*((Ue<0?Ue+6.283185307179586:Ue)-(Se<0?Se+6.283185307179586:Se)),f=c[((f|0)==0?m:fn)>>2]|0;while((f|0)!=0)}x>0?(c[Dn+(Wt<<2)>>2]=m,Wt=Wt+1|0,_=vt,f=te):Mn=19}else Mn=19;if((Mn|0)==19){Mn=0;do if(d){if(f=d+8|0,c[f>>2]|0){Mn=21;break e}if(d=Go(1,12)|0,!d){Mn=23;break e}c[f>>2]=d,_=d+4|0,T=d,f=te}else if(te){_=Ht,T=te+8|0,f=m,d=h;break}else if(c[h>>2]|0){Mn=27;break e}else{_=Ht,T=h,f=m,d=h;break}while(!1);if(c[T>>2]=m,c[_>>2]=m,T=_t+(vt<<5)|0,I=c[m>>2]|0,I){for(k=_t+(vt<<5)+8|0,X[k>>3]=17976931348623157e292,te=_t+(vt<<5)+24|0,X[te>>3]=17976931348623157e292,X[T>>3]=-17976931348623157e292,he=_t+(vt<<5)+16|0,X[he>>3]=-17976931348623157e292,He=17976931348623157e292,ze=-17976931348623157e292,_=0,ue=I,N=17976931348623157e292,be=17976931348623157e292,Pe=-17976931348623157e292,M=-17976931348623157e292;x=+X[ue>>3],Se=+X[ue+8>>3],ue=c[ue+16>>2]|0,ce=(ue|0)==0,Ue=+X[(ce?I:ue)+8>>3],x<N&&(X[k>>3]=x,N=x),Se<be&&(X[te>>3]=Se,be=Se),x>Pe?X[T>>3]=x:x=Pe,Se>M&&(X[he>>3]=Se,M=Se),He=Se>0&Se<He?Se:He,ze=Se<0&Se>ze?Se:ze,_=_|+an(+(Se-Ue))>3.141592653589793,!ce;)Pe=x;_&&(X[he>>3]=ze,X[te>>3]=He)}else c[T>>2]=0,c[T+4>>2]=0,c[T+8>>2]=0,c[T+12>>2]=0,c[T+16>>2]=0,c[T+20>>2]=0,c[T+24>>2]=0,c[T+28>>2]=0;_=vt+1|0}if(fn=m+8|0,m=c[fn>>2]|0,c[fn>>2]=0,m)vt=_,te=f;else{Mn=45;break}}if((Mn|0)==21)mt(27213,27235,35,27247);else if((Mn|0)==23)mt(27267,27235,37,27247);else if((Mn|0)==27)mt(27310,27235,61,27333);else if((Mn|0)==45){e:do if((Wt|0)>0){for(fn=(_|0)==0,xn=_<<2,On=(h|0)==0,gn=0,f=0;;){if(Vt=c[Dn+(gn<<2)>>2]|0,fn)Mn=73;else{if(vt=ka(xn)|0,!vt){Mn=50;break}if(Ht=ka(xn)|0,!Ht){Mn=52;break}t:do if(On)d=0;else{for(_=0,d=0,T=h;m=_t+(_<<5)|0,f8(c[T>>2]|0,m,c[Vt>>2]|0)|0?(c[vt+(d<<2)>>2]=T,c[Ht+(d<<2)>>2]=m,ce=d+1|0):ce=d,T=c[T+8>>2]|0,T;)_=_+1|0,d=ce;if((ce|0)>0)if(m=c[vt>>2]|0,(ce|0)==1)d=m;else for(he=0,ue=-1,d=m,te=m;;){for(I=c[te>>2]|0,m=0,T=0;_=c[c[vt+(T<<2)>>2]>>2]|0,(_|0)==(I|0)?k=m:k=m+((f8(_,c[Ht+(T<<2)>>2]|0,c[I>>2]|0)|0)&1)|0,T=T+1|0,(T|0)!=(ce|0);)m=k;if(_=(k|0)>(ue|0),d=_?te:d,m=he+1|0,(m|0)==(ce|0))break t;he=m,ue=_?k:ue,te=c[vt+(m<<2)>>2]|0}else d=0}while(!1);if(hn(vt),hn(Ht),d){if(_=d+4|0,m=c[_>>2]|0,m)d=m+8|0;else if(c[d>>2]|0){Mn=70;break}c[d>>2]=Vt,c[_>>2]=Vt}else Mn=73}if((Mn|0)==73){if(Mn=0,f=c[Vt>>2]|0,f|0)do Ht=f,f=c[f+16>>2]|0,hn(Ht);while((f|0)!=0);hn(Vt),f=1}if(gn=gn+1|0,(gn|0)>=(Wt|0)){mi=f;break e}}(Mn|0)==50?mt(27452,27235,249,27471):(Mn|0)==52?mt(27490,27235,252,27471):(Mn|0)==70&&mt(27310,27235,61,27333)}else mi=0;while(!1);return hn(Dn),hn(_t),Mn=mi,Mn|0}return 0}function f8(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0;if(!(N_(f,d)|0)||(f=W5(f)|0,m=+X[d>>3],_=+X[d+8>>3],_=f&_<0?_+6.283185307179586:_,h=c[h>>2]|0,!h))return h=0,h|0;if(f){f=0,I=_,d=h;e:for(;;){for(;T=+X[d>>3],_=+X[d+8>>3],d=d+16|0,k=c[d>>2]|0,k=(k|0)==0?h:k,x=+X[k>>3],M=+X[k+8>>3],T>x?(N=T,T=M):(N=x,x=T,T=_,_=M),m=m==x|m==N?m+2220446049250313e-31:m,!!(m<x|m>N);)if(d=c[d>>2]|0,!d){d=22;break e}if(M=T<0?T+6.283185307179586:T,T=_<0?_+6.283185307179586:_,I=M==I|T==I?I+-2220446049250313e-31:I,N=M+(T-M)*((m-x)/(N-x)),(N<0?N+6.283185307179586:N)>I&&(f=f^1),d=c[d>>2]|0,!d){d=22;break}}if((d|0)==22)return f|0}else{f=0,I=_,d=h;e:for(;;){for(;T=+X[d>>3],_=+X[d+8>>3],d=d+16|0,k=c[d>>2]|0,k=(k|0)==0?h:k,x=+X[k>>3],M=+X[k+8>>3],T>x?(N=T,T=M):(N=x,x=T,T=_,_=M),m=m==x|m==N?m+2220446049250313e-31:m,!!(m<x|m>N);)if(d=c[d>>2]|0,!d){d=22;break e}if(I=T==I|_==I?I+-2220446049250313e-31:I,T+(_-T)*((m-x)/(N-x))>I&&(f=f^1),d=c[d>>2]|0,!d){d=22;break}}if((d|0)==22)return f|0}return 0}function Ml(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0;if(ze=Q,Q=Q+32|0,He=ze+16|0,Pe=ze,x=ct(h|0,f|0,52)|0,Y()|0,x=x&15,ue=ct(d|0,m|0,52)|0,Y()|0,(x|0)!=(ue&15|0))return He=12,Q=ze,He|0;if(I=ct(h|0,f|0,45)|0,Y()|0,I=I&127,k=ct(d|0,m|0,45)|0,Y()|0,k=k&127,I>>>0>121|k>>>0>121)return He=5,Q=ze,He|0;if(ue=(I|0)!=(k|0),ue){if(M=R_(I,k)|0,(M|0)==7)return He=1,Q=ze,He|0;N=R_(k,I)|0,(N|0)==7?mt(27514,27538,161,27548):(ce=M,T=N)}else ce=0,T=0;te=Mi(I)|0,he=Mi(k)|0,c[He>>2]=0,c[He+4>>2]=0,c[He+8>>2]=0,c[He+12>>2]=0;do if(ce){if(k=c[4272+(I*28|0)+(ce<<2)>>2]|0,M=(k|0)>0,he)if(M){I=0,N=d,M=m;do N=TB(N,M)|0,M=Y()|0,T=du(T)|0,(T|0)==1&&(T=du(1)|0),I=I+1|0;while((I|0)!=(k|0));k=T,I=N,N=M}else k=T,I=d,N=m;else if(M){I=0,N=d,M=m;do N=V_(N,M)|0,M=Y()|0,T=du(T)|0,I=I+1|0;while((I|0)!=(k|0));k=T,I=N,N=M}else k=T,I=d,N=m;if(q_(I,N,He)|0,ue||mt(27563,27538,191,27548),M=(te|0)!=0,T=(he|0)!=0,M&T&&mt(27590,27538,192,27548),M){if(T=js(h,f)|0,(T|0)==7){x=5;break}if(et[22e3+(T*7|0)+ce>>0]|0){x=1;break}N=c[21168+(T*28|0)+(ce<<2)>>2]|0,I=N}else if(T){if(T=js(I,N)|0,(T|0)==7){x=5;break}if(et[22e3+(T*7|0)+k>>0]|0){x=1;break}I=0,N=c[21168+(k*28|0)+(T<<2)>>2]|0}else I=0,N=0;if((I|N|0)<0)x=5;else{if((N|0)>0){M=He+4|0,T=0;do jp(M),T=T+1|0;while((T|0)!=(N|0))}if(c[Pe>>2]=0,c[Pe+4>>2]=0,c[Pe+8>>2]=0,Z5(Pe,ce),x|0)for(;zo(x)|0?$p(Pe):fc(Pe),(x|0)>1;)x=x+-1|0;if((I|0)>0){x=0;do jp(Pe),x=x+1|0;while((x|0)!=(I|0))}be=He+4|0,ws(be,Pe,be),ls(be),be=51}}else if(q_(d,m,He)|0,(te|0)!=0&(he|0)!=0)if((k|0)!=(I|0)&&mt(27621,27538,261,27548),T=js(h,f)|0,x=js(d,m)|0,(T|0)==7|(x|0)==7)x=5;else if(et[22e3+(T*7|0)+x>>0]|0)x=1;else if(T=c[21168+(T*28|0)+(x<<2)>>2]|0,(T|0)>0){M=He+4|0,x=0;do jp(M),x=x+1|0;while((x|0)!=(T|0));be=51}else be=51;else be=51;while(!1);return(be|0)==51&&(x=He+4|0,c[_>>2]=c[x>>2],c[_+4>>2]=c[x+4>>2],c[_+8>>2]=c[x+8>>2],x=0),He=x,Q=ze,He|0}function A8(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0;if(be=Q,Q=Q+48|0,I=be+36|0,T=be+24|0,M=be+12|0,N=be,_=ct(h|0,f|0,52)|0,Y()|0,_=_&15,he=ct(h|0,f|0,45)|0,Y()|0,he=he&127,he>>>0>121)return m=5,Q=be,m|0;if(k=Mi(he)|0,St(_|0,0,52)|0,Pe=Y()|0|134225919,x=m,c[x>>2]=-1,c[x+4>>2]=Pe,!_)return _=Wp(d)|0,(_|0)==7||(_=C_(he,_)|0,(_|0)==127)?(Pe=1,Q=be,Pe|0):(ue=St(_|0,0,45)|0,ce=Y()|0,he=m,ce=c[he+4>>2]&-1040385|ce,Pe=m,c[Pe>>2]=c[he>>2]|ue,c[Pe+4>>2]=ce,Pe=0,Q=be,Pe|0);for(c[I>>2]=c[d>>2],c[I+4>>2]=c[d+4>>2],c[I+8>>2]=c[d+8>>2],d=_;;){if(x=d,d=d+-1|0,c[T>>2]=c[I>>2],c[T+4>>2]=c[I+4>>2],c[T+8>>2]=c[I+8>>2],zo(x)|0){if(_=JI(I)|0,_|0){d=13;break}c[M>>2]=c[I>>2],c[M+4>>2]=c[I+4>>2],c[M+8>>2]=c[I+8>>2],$p(M)}else{if(_=eB(I)|0,_|0){d=13;break}c[M>>2]=c[I>>2],c[M+4>>2]=c[I+4>>2],c[M+8>>2]=c[I+8>>2],fc(M)}if(L_(T,M,N),ls(N),_=m,ze=c[_>>2]|0,_=c[_+4>>2]|0,Ue=(15-x|0)*3|0,He=St(7,0,Ue|0)|0,_=_&~(Y()|0),Ue=St(Wp(N)|0,0,Ue|0)|0,_=Y()|0|_,Pe=m,c[Pe>>2]=Ue|ze&~He,c[Pe+4>>2]=_,(x|0)<=1){d=14;break}}e:do if((d|0)!=13&&(d|0)==14)if((c[I>>2]|0)<=1&&(c[I+4>>2]|0)<=1&&(c[I+8>>2]|0)<=1){d=Wp(I)|0,_=C_(he,d)|0,(_|0)==127?N=0:N=Mi(_)|0;t:do if(d){if(k){if(_=js(h,f)|0,(_|0)==7){_=5;break e}if(x=c[21376+(_*28|0)+(d<<2)>>2]|0,(x|0)>0){_=d,d=0;do _=Ac(_)|0,d=d+1|0;while((d|0)!=(x|0))}else _=d;if((_|0)==1){_=9;break e}d=C_(he,_)|0,(d|0)==127&&mt(27648,27538,411,27678),Mi(d)|0?mt(27693,27538,412,27678):(ce=d,ue=x,te=_)}else ce=_,ue=0,te=d;if(M=c[4272+(he*28|0)+(te<<2)>>2]|0,(M|0)<=-1&&mt(27724,27538,419,27678),!N){if((ue|0)<0){_=5;break e}if(ue|0){x=m,_=0,d=c[x>>2]|0,x=c[x+4>>2]|0;do d=dc(d,x)|0,x=Y()|0,Ue=m,c[Ue>>2]=d,c[Ue+4>>2]=x,_=_+1|0;while((_|0)<(ue|0))}if((M|0)<=0){_=ce,d=58;break}for(x=m,_=0,d=c[x>>2]|0,x=c[x+4>>2]|0;;)if(d=dc(d,x)|0,x=Y()|0,Ue=m,c[Ue>>2]=d,c[Ue+4>>2]=x,_=_+1|0,(_|0)==(M|0)){_=ce,d=58;break t}}if(T=R_(ce,he)|0,(T|0)==7&&mt(27514,27538,428,27678),_=m,d=c[_>>2]|0,_=c[_+4>>2]|0,(M|0)>0){x=0;do d=dc(d,_)|0,_=Y()|0,Ue=m,c[Ue>>2]=d,c[Ue+4>>2]=_,x=x+1|0;while((x|0)!=(M|0))}if(_=js(d,_)|0,(_|0)==7&&mt(27795,27538,440,27678),d=E_(ce)|0,d=c[(d?21792:21584)+(T*28|0)+(_<<2)>>2]|0,(d|0)<0&&mt(27795,27538,454,27678),!d)_=ce,d=58;else{T=m,_=0,x=c[T>>2]|0,T=c[T+4>>2]|0;do x=k_(x,T)|0,T=Y()|0,Ue=m,c[Ue>>2]=x,c[Ue+4>>2]=T,_=_+1|0;while((_|0)<(d|0));_=ce,d=58}}else if((k|0)!=0&(N|0)!=0){if(d=js(h,f)|0,x=m,x=js(c[x>>2]|0,c[x+4>>2]|0)|0,(d|0)==7|(x|0)==7){_=5;break e}if(x=c[21376+(d*28|0)+(x<<2)>>2]|0,(x|0)<0){_=5;break e}if(!x)d=59;else{M=m,d=0,T=c[M>>2]|0,M=c[M+4>>2]|0;do T=dc(T,M)|0,M=Y()|0,Ue=m,c[Ue>>2]=T,c[Ue+4>>2]=M,d=d+1|0;while((d|0)<(x|0));d=58}}else d=58;while(!1);if((d|0)==58&&N&&(d=59),(d|0)==59&&(Ue=m,(js(c[Ue>>2]|0,c[Ue+4>>2]|0)|0)==1)){_=9;break}Ue=m,He=c[Ue>>2]|0,Ue=c[Ue+4>>2]&-1040385,ze=St(_|0,0,45)|0,Ue=Ue|(Y()|0),_=m,c[_>>2]=He|ze,c[_+4>>2]=Ue,_=0}else _=1;while(!1);return Ue=_,Q=be,Ue|0}function HB(h,f,d,m,_,x){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0,x=x|0;var T=0,M=0;return M=Q,Q=Q+16|0,T=M,_?h=15:(h=Ml(h,f,d,m,T)|0,h||(nB(T,x),h=0)),Q=M,h|0}function WB(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0;return T=Q,Q=Q+16|0,x=T,m?d=15:(d=iB(d,x)|0,d||(d=A8(h,f,x,_)|0)),Q=T,d|0}function $B(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0;return N=Q,Q=Q+32|0,T=N+12|0,M=N,x=Ml(h,f,h,f,T)|0,x|0?(M=x,Q=N,M|0):(h=Ml(h,f,d,m,M)|0,h|0?(M=h,Q=N,M|0):(T=D_(T,M)|0,M=_,c[M>>2]=T,c[M+4>>2]=((T|0)<0)<<31>>31,M=0,Q=N,M|0))}function jB(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0;return N=Q,Q=Q+32|0,T=N+12|0,M=N,x=Ml(h,f,h,f,T)|0,!x&&(x=Ml(h,f,d,m,M)|0,!x)?(m=D_(T,M)|0,m=rn(m|0,((m|0)<0)<<31>>31|0,1,0)|0,T=Y()|0,M=_,c[M>>2]=m,c[M+4>>2]=T,M=0,Q=N,M|0):(M=x,Q=N,M|0)}function XB(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0,vt=0,Ht=0,Vt=0,gn=0;if(Vt=Q,Q=Q+48|0,vt=Vt+24|0,T=Vt+12|0,Ht=Vt,x=Ml(h,f,h,f,vt)|0,!x&&(x=Ml(h,f,d,m,T)|0,!x)){Ue=D_(vt,T)|0,Se=((Ue|0)<0)<<31>>31,c[vt>>2]=0,c[vt+4>>2]=0,c[vt+8>>2]=0,c[T>>2]=0,c[T+4>>2]=0,c[T+8>>2]=0,Ml(h,f,h,f,vt)|0&&mt(27795,27538,692,27747),Ml(h,f,d,m,T)|0&&mt(27795,27538,697,27747),t8(vt),t8(T),k=(Ue|0)==0?0:1/+(Ue|0),d=c[vt>>2]|0,be=k*+((c[T>>2]|0)-d|0),Pe=vt+4|0,m=c[Pe>>2]|0,He=k*+((c[T+4>>2]|0)-m|0),ze=vt+8|0,x=c[ze>>2]|0,k=k*+((c[T+8>>2]|0)-x|0),c[Ht>>2]=d,te=Ht+4|0,c[te>>2]=m,he=Ht+8|0,c[he>>2]=x;e:do if((Ue|0)<0)x=0;else for(ue=0,ce=0;;){N=+(ce>>>0)+4294967296*+(ue|0),gn=be*N+ +(d|0),M=He*N+ +(m|0),N=k*N+ +(x|0),d=~~+Kp(+gn),T=~~+Kp(+M),x=~~+Kp(+N),gn=+an(+(+(d|0)-gn)),M=+an(+(+(T|0)-M)),N=+an(+(+(x|0)-N));do if(gn>M&gn>N)d=0-(T+x)|0,m=T;else if(I=0-d|0,M>N){m=I-x|0;break}else{m=T,x=I-T|0;break}while(!1);if(c[Ht>>2]=d,c[te>>2]=m,c[he>>2]=x,rB(Ht),x=A8(h,f,Ht,_+(ce<<3)|0)|0,x|0)break e;if(!((ue|0)<(Se|0)|(ue|0)==(Se|0)&ce>>>0<Ue>>>0)){x=0;break e}d=rn(ce|0,ue|0,1,0)|0,m=Y()|0,ue=m,ce=d,d=c[vt>>2]|0,m=c[Pe>>2]|0,x=c[ze>>2]|0}while(!1);return Ht=x,Q=Vt,Ht|0}return Ht=x,Q=Vt,Ht|0}function pu(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0;if((d|0)==0&(m|0)==0)return _=0,x=1,lt(_|0),x|0;x=h,_=f,h=1,f=0;do T=(d&1|0)==0&!0,h=us((T?1:x)|0,(T?0:_)|0,h|0,f|0)|0,f=Y()|0,d=w8(d|0,m|0,1)|0,m=Y()|0,x=us(x|0,_|0,x|0,_|0)|0,_=Y()|0;while(!((d|0)==0&(m|0)==0));return lt(f|0),h|0}function X_(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0;M=Q,Q=Q+16|0,x=M,T=ct(h|0,f|0,52)|0,Y()|0,T=T&15;do if(T){if(_=pc(h,f,x)|0,!_){I=+X[x>>3],N=1/+un(+I),k=+X[25968+(T<<3)>>3],X[d>>3]=I+k,X[d+8>>3]=I-k,I=+X[x+8>>3],N=k*N,X[d+16>>3]=N+I,X[d+24>>3]=I-N;break}return T=_,Q=M,T|0}else{if(_=ct(h|0,f|0,45)|0,Y()|0,_=_&127,_>>>0>121)return T=5,Q=M,T|0;x=22064+(_<<5)|0,c[d>>2]=c[x>>2],c[d+4>>2]=c[x+4>>2],c[d+8>>2]=c[x+8>>2],c[d+12>>2]=c[x+12>>2],c[d+16>>2]=c[x+16>>2],c[d+20>>2]=c[x+20>>2],c[d+24>>2]=c[x+24>>2],c[d+28>>2]=c[x+28>>2];break}while(!1);return YI(d,m?1.4:1.1),m=26096+(T<<3)|0,(c[m>>2]|0)==(h|0)&&(c[m+4>>2]|0)==(f|0)&&(X[d>>3]=1.5707963267948966),T=26224+(T<<3)|0,(c[T>>2]|0)==(h|0)&&(c[T+4>>2]|0)==(f|0)&&(X[d+8>>3]=-1.5707963267948966),+X[d>>3]!=1.5707963267948966&&+X[d+8>>3]!=-1.5707963267948966?(T=0,Q=M,T|0):(X[d+16>>3]=3.141592653589793,X[d+24>>3]=-3.141592653589793,T=0,Q=M,T|0)}function QB(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0;I=Q,Q=Q+48|0,T=I+32|0,x=I+40|0,M=I,U_(T,0,0,0),N=c[T>>2]|0,T=c[T+4>>2]|0;do if(d>>>0<=15){if(_=JA(m)|0,_|0){m=M,c[m>>2]=0,c[m+4>>2]=0,c[M+8>>2]=_,c[M+12>>2]=-1,m=M+16|0,N=M+29|0,c[m>>2]=0,c[m+4>>2]=0,c[m+8>>2]=0,et[m+12>>0]=0,et[N>>0]=et[x>>0]|0,et[N+1>>0]=et[x+1>>0]|0,et[N+2>>0]=et[x+2>>0]|0;break}if(_=Go((c[f+8>>2]|0)+1|0,32)|0,_){Q_(f,_),k=M,c[k>>2]=N,c[k+4>>2]=T,c[M+8>>2]=0,c[M+12>>2]=d,c[M+16>>2]=m,c[M+20>>2]=f,c[M+24>>2]=_,et[M+28>>0]=0,N=M+29|0,et[N>>0]=et[x>>0]|0,et[N+1>>0]=et[x+1>>0]|0,et[N+2>>0]=et[x+2>>0]|0;break}else{m=M,c[m>>2]=0,c[m+4>>2]=0,c[M+8>>2]=13,c[M+12>>2]=-1,m=M+16|0,N=M+29|0,c[m>>2]=0,c[m+4>>2]=0,c[m+8>>2]=0,et[m+12>>0]=0,et[N>>0]=et[x>>0]|0,et[N+1>>0]=et[x+1>>0]|0,et[N+2>>0]=et[x+2>>0]|0;break}}else N=M,c[N>>2]=0,c[N+4>>2]=0,c[M+8>>2]=4,c[M+12>>2]=-1,N=M+16|0,k=M+29|0,c[N>>2]=0,c[N+4>>2]=0,c[N+8>>2]=0,et[N+12>>0]=0,et[k>>0]=et[x>>0]|0,et[k+1>>0]=et[x+1>>0]|0,et[k+2>>0]=et[x+2>>0]|0;while(!1);Qp(M),c[h>>2]=c[M>>2],c[h+4>>2]=c[M+4>>2],c[h+8>>2]=c[M+8>>2],c[h+12>>2]=c[M+12>>2],c[h+16>>2]=c[M+16>>2],c[h+20>>2]=c[M+20>>2],c[h+24>>2]=c[M+24>>2],c[h+28>>2]=c[M+28>>2],Q=I}function Qp(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0;if(Se=Q,Q=Q+336|0,ue=Se+168|0,ce=Se,m=h,d=c[m>>2]|0,m=c[m+4>>2]|0,(d|0)==0&(m|0)==0){Q=Se;return}if(f=h+28|0,et[f>>0]|0?(d=d8(d,m)|0,m=Y()|0):et[f>>0]=1,Ue=h+20|0,!(c[c[Ue>>2]>>2]|0)){f=h+24|0,d=c[f>>2]|0,d|0&&hn(d),ze=h,c[ze>>2]=0,c[ze+4>>2]=0,c[h+8>>2]=0,c[Ue>>2]=0,c[h+12>>2]=-1,c[h+16>>2]=0,c[f>>2]=0,Q=Se;return}ze=h+16|0,f=c[ze>>2]|0,_=f&15;e:do if((d|0)==0&(m|0)==0)He=h+24|0;else{be=h+12|0,te=(_|0)==3,k=f&255,N=(_|1|0)==3,he=h+24|0,I=(_+-1|0)>>>0<3,T=(_|2|0)==3,M=ce+8|0;t:for(;;){if(x=ct(d|0,m|0,52)|0,Y()|0,x=x&15,(x|0)==(c[be>>2]|0)){switch(k&15){case 0:case 2:case 3:{if(_=pc(d,m,ue)|0,_|0){Pe=15;break t}if(Y_(c[Ue>>2]|0,c[he>>2]|0,ue)|0){Pe=19;break t}break}}if(N&&(_=c[(c[Ue>>2]|0)+4>>2]|0,c[ue>>2]=c[_>>2],c[ue+4>>2]=c[_+4>>2],c[ue+8>>2]=c[_+8>>2],c[ue+12>>2]=c[_+12>>2],N_(26832,ue)|0)){if(z_(c[(c[Ue>>2]|0)+4>>2]|0,x,ce)|0){Pe=25;break}if(_=ce,(c[_>>2]|0)==(d|0)&&(c[_+4>>2]|0)==(m|0)){Pe=29;break}}if(I){if(_=Ih(d,m,ue)|0,_|0){Pe=32;break}if(X_(d,m,ce,0)|0){Pe=36;break}if(T&&m8(c[Ue>>2]|0,c[he>>2]|0,ue,ce)|0){Pe=42;break}if(N&&g8(c[Ue>>2]|0,c[he>>2]|0,ue,ce)|0){Pe=42;break}}if(te){if(f=X_(d,m,ue,1)|0,_=c[he>>2]|0,f|0){Pe=45;break}if(P_(_,ue)|0){if(j5(ce,ue),$5(ue,c[he>>2]|0)|0){Pe=53;break}if(Y_(c[Ue>>2]|0,c[he>>2]|0,M)|0){Pe=53;break}if(g8(c[Ue>>2]|0,c[he>>2]|0,ce,ue)|0){Pe=53;break}}}}do if((x|0)<(c[be>>2]|0)){if(f=X_(d,m,ue,1)|0,_=c[he>>2]|0,f|0){Pe=58;break t}if(!(P_(_,ue)|0)){Pe=73;break}if($5(c[he>>2]|0,ue)|0&&(j5(ce,ue),m8(c[Ue>>2]|0,c[he>>2]|0,ce,ue)|0)){Pe=65;break t}if(d=o8(d,m,x+1|0,ce)|0,d|0){Pe=67;break t}m=ce,d=c[m>>2]|0,m=c[m+4>>2]|0}else Pe=73;while(!1);if((Pe|0)==73&&(Pe=0,d=d8(d,m)|0,m=Y()|0),(d|0)==0&(m|0)==0){He=he;break e}}switch(Pe|0){case 15:{f=c[he>>2]|0,f|0&&hn(f),Pe=h,c[Pe>>2]=0,c[Pe+4>>2]=0,c[Ue>>2]=0,c[be>>2]=-1,c[ze>>2]=0,c[he>>2]=0,c[h+8>>2]=_,Pe=20;break}case 19:{c[h>>2]=d,c[h+4>>2]=m,Pe=20;break}case 25:{mt(27795,27761,470,27772);break}case 29:{c[h>>2]=d,c[h+4>>2]=m,Q=Se;return}case 32:{f=c[he>>2]|0,f|0&&hn(f),He=h,c[He>>2]=0,c[He+4>>2]=0,c[Ue>>2]=0,c[be>>2]=-1,c[ze>>2]=0,c[he>>2]=0,c[h+8>>2]=_,Q=Se;return}case 36:{mt(27795,27761,493,27772);break}case 42:{c[h>>2]=d,c[h+4>>2]=m,Q=Se;return}case 45:{_|0&&hn(_),Pe=h,c[Pe>>2]=0,c[Pe+4>>2]=0,c[Ue>>2]=0,c[be>>2]=-1,c[ze>>2]=0,c[he>>2]=0,c[h+8>>2]=f,Pe=55;break}case 53:{c[h>>2]=d,c[h+4>>2]=m,Pe=55;break}case 58:{_|0&&hn(_),Pe=h,c[Pe>>2]=0,c[Pe+4>>2]=0,c[Ue>>2]=0,c[be>>2]=-1,c[ze>>2]=0,c[he>>2]=0,c[h+8>>2]=f,Pe=71;break}case 65:{c[h>>2]=d,c[h+4>>2]=m,Pe=71;break}case 67:{f=c[he>>2]|0,f|0&&hn(f),He=h,c[He>>2]=0,c[He+4>>2]=0,c[Ue>>2]=0,c[be>>2]=-1,c[ze>>2]=0,c[he>>2]=0,c[h+8>>2]=d,Q=Se;return}}if((Pe|0)==20){Q=Se;return}else if((Pe|0)==55){Q=Se;return}else if((Pe|0)==71){Q=Se;return}}while(!1);f=c[He>>2]|0,f|0&&hn(f),Pe=h,c[Pe>>2]=0,c[Pe+4>>2]=0,c[h+8>>2]=0,c[Ue>>2]=0,c[h+12>>2]=-1,c[ze>>2]=0,c[He>>2]=0,Q=Se}function d8(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0;te=Q,Q=Q+16|0,k=te,m=ct(h|0,f|0,52)|0,Y()|0,m=m&15,d=ct(h|0,f|0,45)|0,Y()|0;do if(m){for(;d=St(m+4095|0,0,52)|0,_=Y()|0|f&-15728641,x=(15-m|0)*3|0,T=St(7,0,x|0)|0,M=Y()|0,d=d|h|T,_=_|M,N=ct(h|0,f|0,x|0)|0,Y()|0,N=N&7,m=m+-1|0,!(N>>>0<6);)if(m)f=_,h=d;else{I=4;break}if((I|0)==4){d=ct(d|0,_|0,45)|0,Y()|0;break}return k=(N|0)==0&(yi(d,_)|0)!=0,k=St((k?2:1)+N|0,0,x|0)|0,I=Y()|0|f&~M,k=k|h&~T,lt(I|0),Q=te,k|0}while(!1);return d=d&127,d>>>0>120?(I=0,k=0,lt(I|0),Q=te,k|0):(U_(k,0,d+1|0,0),I=c[k+4>>2]|0,k=c[k>>2]|0,lt(I|0),Q=te,k|0)}function YB(h,f,d,m,_,x){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0,x=x|0;var T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0;Pe=Q,Q=Q+160|0,te=Pe+80|0,M=Pe+64|0,he=Pe+112|0,be=Pe,QB(te,h,f,d),I=te,H_(M,c[I>>2]|0,c[I+4>>2]|0,f),I=M,N=c[I>>2]|0,I=c[I+4>>2]|0,T=c[te+8>>2]|0,ue=he+4|0,c[ue>>2]=c[te>>2],c[ue+4>>2]=c[te+4>>2],c[ue+8>>2]=c[te+8>>2],c[ue+12>>2]=c[te+12>>2],c[ue+16>>2]=c[te+16>>2],c[ue+20>>2]=c[te+20>>2],c[ue+24>>2]=c[te+24>>2],c[ue+28>>2]=c[te+28>>2],ue=be,c[ue>>2]=N,c[ue+4>>2]=I,ue=be+8|0,c[ue>>2]=T,h=be+12|0,f=he,d=h+36|0;do c[h>>2]=c[f>>2],h=h+4|0,f=f+4|0;while((h|0)<(d|0));if(he=be+48|0,c[he>>2]=c[M>>2],c[he+4>>2]=c[M+4>>2],c[he+8>>2]=c[M+8>>2],c[he+12>>2]=c[M+12>>2],(N|0)==0&(I|0)==0)return be=T,Q=Pe,be|0;d=be+16|0,k=be+24|0,te=be+28|0,T=0,M=0,f=N,h=I;do{if(!((T|0)<(_|0)|(T|0)==(_|0)&M>>>0<m>>>0)){ce=4;break}if(I=M,M=rn(M|0,T|0,1,0)|0,T=Y()|0,I=x+(I<<3)|0,c[I>>2]=f,c[I+4>>2]=h,W_(he),h=he,f=c[h>>2]|0,h=c[h+4>>2]|0,(f|0)==0&(h|0)==0){if(Qp(d),f=d,h=c[f>>2]|0,f=c[f+4>>2]|0,(h|0)==0&(f|0)==0){ce=10;break}l8(h,f,c[te>>2]|0,he),h=he,f=c[h>>2]|0,h=c[h+4>>2]|0}I=be,c[I>>2]=f,c[I+4>>2]=h}while(!((f|0)==0&(h|0)==0));return(ce|0)==4?(h=be+40|0,f=c[h>>2]|0,f|0&&hn(f),ce=be+16|0,c[ce>>2]=0,c[ce+4>>2]=0,c[k>>2]=0,c[be+36>>2]=0,c[te>>2]=-1,c[be+32>>2]=0,c[h>>2]=0,l8(0,0,0,he),c[be>>2]=0,c[be+4>>2]=0,c[ue>>2]=0,be=14,Q=Pe,be|0):((ce|0)==10&&(c[be>>2]=0,c[be+4>>2]=0,c[ue>>2]=c[k>>2]),be=c[ue>>2]|0,Q=Pe,be|0)}function ZB(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0;if(te=Q,Q=Q+48|0,N=te+32|0,M=te+40|0,I=te,!(c[h>>2]|0))return k=m,c[k>>2]=0,c[k+4>>2]=0,k=0,Q=te,k|0;U_(N,0,0,0),T=N,_=c[T>>2]|0,T=c[T+4>>2]|0;do if(f>>>0>15)k=I,c[k>>2]=0,c[k+4>>2]=0,c[I+8>>2]=4,c[I+12>>2]=-1,k=I+16|0,d=I+29|0,c[k>>2]=0,c[k+4>>2]=0,c[k+8>>2]=0,et[k+12>>0]=0,et[d>>0]=et[M>>0]|0,et[d+1>>0]=et[M+1>>0]|0,et[d+2>>0]=et[M+2>>0]|0,d=4,k=9;else{if(d=JA(d)|0,d|0){N=I,c[N>>2]=0,c[N+4>>2]=0,c[I+8>>2]=d,c[I+12>>2]=-1,N=I+16|0,k=I+29|0,c[N>>2]=0,c[N+4>>2]=0,c[N+8>>2]=0,et[N+12>>0]=0,et[k>>0]=et[M>>0]|0,et[k+1>>0]=et[M+1>>0]|0,et[k+2>>0]=et[M+2>>0]|0,k=9;break}if(d=Go((c[h+8>>2]|0)+1|0,32)|0,!d){k=I,c[k>>2]=0,c[k+4>>2]=0,c[I+8>>2]=13,c[I+12>>2]=-1,k=I+16|0,d=I+29|0,c[k>>2]=0,c[k+4>>2]=0,c[k+8>>2]=0,et[k+12>>0]=0,et[d>>0]=et[M>>0]|0,et[d+1>>0]=et[M+1>>0]|0,et[d+2>>0]=et[M+2>>0]|0,d=13,k=9;break}Q_(h,d),ue=I,c[ue>>2]=_,c[ue+4>>2]=T,T=I+8|0,c[T>>2]=0,c[I+12>>2]=f,c[I+20>>2]=h,c[I+24>>2]=d,et[I+28>>0]=0,_=I+29|0,et[_>>0]=et[M>>0]|0,et[_+1>>0]=et[M+1>>0]|0,et[_+2>>0]=et[M+2>>0]|0,c[I+16>>2]=3,he=+jI(d),he=he*+$I(d),x=+an(+ +X[d>>3]),x=he/+un(+ +Zp(+x,+ +an(+ +X[d+8>>3])))*6371.007180918475*6371.007180918475,_=I+12|0,d=c[_>>2]|0;e:do if((d|0)>0)do{if(u8(d+-1|0,N)|0,!(x/+X[N>>3]>10))break e;ue=c[_>>2]|0,d=ue+-1|0,c[_>>2]=d}while((ue|0)>1);while(!1);if(Qp(I),_=m,c[_>>2]=0,c[_+4>>2]=0,_=I,d=c[_>>2]|0,_=c[_+4>>2]|0,!((d|0)==0&(_|0)==0))do QA(d,_,f,N)|0,M=N,h=m,M=rn(c[h>>2]|0,c[h+4>>2]|0,c[M>>2]|0,c[M+4>>2]|0)|0,h=Y()|0,ue=m,c[ue>>2]=M,c[ue+4>>2]=h,Qp(I),ue=I,d=c[ue>>2]|0,_=c[ue+4>>2]|0;while(!((d|0)==0&(_|0)==0));d=c[T>>2]|0}while(!1);return ue=d,Q=te,ue|0}function KA(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0;if(!(N_(f,d)|0)||(f=W5(f)|0,m=+X[d>>3],_=+X[d+8>>3],_=f&_<0?_+6.283185307179586:_,he=c[h>>2]|0,(he|0)<=0))return he=0,he|0;if(te=c[h+4>>2]|0,f){f=0,k=_,d=-1,h=0;e:for(;;){for(I=h;T=+X[te+(I<<4)>>3],_=+X[te+(I<<4)+8>>3],h=(d+2|0)%(he|0)|0,x=+X[te+(h<<4)>>3],M=+X[te+(h<<4)+8>>3],T>x?(N=T,T=M):(N=x,x=T,T=_,_=M),m=m==x|m==N?m+2220446049250313e-31:m,!!(m<x|m>N);)if(d=I+1|0,(d|0)>=(he|0)){d=22;break e}else h=I,I=d,d=h;if(M=T<0?T+6.283185307179586:T,T=_<0?_+6.283185307179586:_,k=M==k|T==k?k+-2220446049250313e-31:k,N=M+(T-M)*((m-x)/(N-x)),(N<0?N+6.283185307179586:N)>k&&(f=f^1),h=I+1|0,(h|0)>=(he|0)){d=22;break}else d=I}if((d|0)==22)return f|0}else{f=0,k=_,d=-1,h=0;e:for(;;){for(I=h;T=+X[te+(I<<4)>>3],_=+X[te+(I<<4)+8>>3],h=(d+2|0)%(he|0)|0,x=+X[te+(h<<4)>>3],M=+X[te+(h<<4)+8>>3],T>x?(N=T,T=M):(N=x,x=T,T=_,_=M),m=m==x|m==N?m+2220446049250313e-31:m,!!(m<x|m>N);)if(d=I+1|0,(d|0)>=(he|0)){d=22;break e}else h=I,I=d,d=h;if(k=T==k|_==k?k+-2220446049250313e-31:k,T+(_-T)*((m-x)/(N-x))>k&&(f=f^1),h=I+1|0,(h|0)>=(he|0)){d=22;break}else d=I}if((d|0)==22)return f|0}return 0}function p8(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0;if(ce=c[h>>2]|0,!ce){c[f>>2]=0,c[f+4>>2]=0,c[f+8>>2]=0,c[f+12>>2]=0,c[f+16>>2]=0,c[f+20>>2]=0,c[f+24>>2]=0,c[f+28>>2]=0;return}if(be=f+8|0,X[be>>3]=17976931348623157e292,Pe=f+24|0,X[Pe>>3]=17976931348623157e292,X[f>>3]=-17976931348623157e292,He=f+16|0,X[He>>3]=-17976931348623157e292,!((ce|0)<=0)){for(he=c[h+4>>2]|0,I=17976931348623157e292,k=-17976931348623157e292,te=0,h=-1,x=17976931348623157e292,T=17976931348623157e292,N=-17976931348623157e292,m=-17976931348623157e292,ue=0;d=+X[he+(ue<<4)>>3],M=+X[he+(ue<<4)+8>>3],h=h+2|0,_=+X[he+(((h|0)==(ce|0)?0:h)<<4)+8>>3],d<x&&(X[be>>3]=d,x=d),M<T&&(X[Pe>>3]=M,T=M),d>N?X[f>>3]=d:d=N,M>m&&(X[He>>3]=M,m=M),I=M>0&M<I?M:I,k=M<0&M>k?M:k,te=te|+an(+(M-_))>3.141592653589793,h=ue+1|0,(h|0)!=(ce|0);)ze=ue,N=d,ue=h,h=ze;te&&(X[He>>3]=k,X[Pe>>3]=I)}}function JA(h){return h=h|0,(h>>>0<4?0:15)|0}function Q_(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0,vt=0,Ht=0,Vt=0;if(ce=c[h>>2]|0,ce){if(be=f+8|0,X[be>>3]=17976931348623157e292,Pe=f+24|0,X[Pe>>3]=17976931348623157e292,X[f>>3]=-17976931348623157e292,He=f+16|0,X[He>>3]=-17976931348623157e292,(ce|0)>0){for(_=c[h+4>>2]|0,he=17976931348623157e292,ue=-17976931348623157e292,m=0,d=-1,N=17976931348623157e292,I=17976931348623157e292,te=-17976931348623157e292,T=-17976931348623157e292,ze=0;x=+X[_+(ze<<4)>>3],k=+X[_+(ze<<4)+8>>3],Ht=d+2|0,M=+X[_+(((Ht|0)==(ce|0)?0:Ht)<<4)+8>>3],x<N&&(X[be>>3]=x,N=x),k<I&&(X[Pe>>3]=k,I=k),x>te?X[f>>3]=x:x=te,k>T&&(X[He>>3]=k,T=k),he=k>0&k<he?k:he,ue=k<0&k>ue?k:ue,m=m|+an(+(k-M))>3.141592653589793,d=ze+1|0,(d|0)!=(ce|0);)Ht=ze,te=x,ze=d,d=Ht;m&&(X[He>>3]=ue,X[Pe>>3]=he)}}else c[f>>2]=0,c[f+4>>2]=0,c[f+8>>2]=0,c[f+12>>2]=0,c[f+16>>2]=0,c[f+20>>2]=0,c[f+24>>2]=0,c[f+28>>2]=0;if(Ht=h+8|0,d=c[Ht>>2]|0,!((d|0)<=0)){vt=h+12|0,Se=0;do if(_=c[vt>>2]|0,m=Se,Se=Se+1|0,Pe=f+(Se<<5)|0,He=c[_+(m<<3)>>2]|0,He){if(ze=f+(Se<<5)+8|0,X[ze>>3]=17976931348623157e292,h=f+(Se<<5)+24|0,X[h>>3]=17976931348623157e292,X[Pe>>3]=-17976931348623157e292,Ue=f+(Se<<5)+16|0,X[Ue>>3]=-17976931348623157e292,(He|0)>0){for(ce=c[_+(m<<3)+4>>2]|0,he=17976931348623157e292,ue=-17976931348623157e292,_=0,m=-1,be=0,N=17976931348623157e292,I=17976931348623157e292,k=-17976931348623157e292,T=-17976931348623157e292;x=+X[ce+(be<<4)>>3],te=+X[ce+(be<<4)+8>>3],m=m+2|0,M=+X[ce+(((m|0)==(He|0)?0:m)<<4)+8>>3],x<N&&(X[ze>>3]=x,N=x),te<I&&(X[h>>3]=te,I=te),x>k?X[Pe>>3]=x:x=k,te>T&&(X[Ue>>3]=te,T=te),he=te>0&te<he?te:he,ue=te<0&te>ue?te:ue,_=_|+an(+(te-M))>3.141592653589793,m=be+1|0,(m|0)!=(He|0);)Vt=be,be=m,k=x,m=Vt;_&&(X[Ue>>3]=ue,X[h>>3]=he)}}else c[Pe>>2]=0,c[Pe+4>>2]=0,c[Pe+8>>2]=0,c[Pe+12>>2]=0,c[Pe+16>>2]=0,c[Pe+20>>2]=0,c[Pe+24>>2]=0,c[Pe+28>>2]=0,d=c[Ht>>2]|0;while((Se|0)<(d|0))}}function Y_(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0;if(!(KA(h,f,d)|0))return _=0,_|0;if(_=h+8|0,(c[_>>2]|0)<=0)return _=1,_|0;for(m=h+12|0,h=0;;){if(x=h,h=h+1|0,KA((c[m>>2]|0)+(x<<3)|0,f+(h<<5)|0,d)|0){h=0,m=6;break}if((h|0)>=(c[_>>2]|0)){h=1,m=6;break}}return(m|0)==6?h|0:0}function m8(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0;if(I=Q,Q=Q+16|0,M=I,T=d+8|0,!(KA(h,f,T)|0))return N=0,Q=I,N|0;N=h+8|0;e:do if((c[N>>2]|0)>0){for(x=h+12|0,_=0;;){if(k=_,_=_+1|0,KA((c[x>>2]|0)+(k<<3)|0,f+(_<<5)|0,T)|0){_=0;break}if((_|0)>=(c[N>>2]|0))break e}return Q=I,_|0}while(!1);if(Yp(h,f,d,m)|0)return k=0,Q=I,k|0;c[M>>2]=c[d>>2],c[M+4>>2]=T,_=c[N>>2]|0;e:do if((_|0)>0)for(h=h+12|0,T=0,x=_;;){if(_=c[h>>2]|0,(c[_+(T<<3)>>2]|0)>0){if(KA(M,m,c[_+(T<<3)+4>>2]|0)|0){_=0;break e}if(_=T+1|0,Yp((c[h>>2]|0)+(T<<3)|0,f+(_<<5)|0,d,m)|0){_=0;break e}x=c[N>>2]|0}else _=T+1|0;if((_|0)<(x|0))T=_;else{_=1;break}}else _=1;while(!1);return k=_,Q=I,k|0}function Yp(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0,vt=0,Ht=0,Vt=0,gn=0;if(Ht=Q,Q=Q+176|0,ze=Ht+172|0,_=Ht+168|0,Ue=Ht,!(P_(f,m)|0))return h=0,Q=Ht,h|0;if(XI(f,m,ze,_),Oh(Ue|0,d|0,168)|0,(c[d>>2]|0)>0){f=0;do Vt=Ue+8+(f<<4)+8|0,He=+go(+X[Vt>>3],c[_>>2]|0),X[Vt>>3]=He,f=f+1|0;while((f|0)<(c[d>>2]|0))}be=+X[m>>3],Pe=+X[m+8>>3],He=+go(+X[m+16>>3],c[_>>2]|0),ue=+go(+X[m+24>>3],c[_>>2]|0);e:do if((c[h>>2]|0)>0){if(m=h+4|0,_=c[Ue>>2]|0,(_|0)<=0){for(f=0;;)if(f=f+1|0,(f|0)>=(c[h>>2]|0)){f=0;break e}}for(d=0;;){if(f=c[m>>2]|0,he=+X[f+(d<<4)>>3],ce=+go(+X[f+(d<<4)+8>>3],c[ze>>2]|0),f=c[m>>2]|0,d=d+1|0,Vt=(d|0)%(c[h>>2]|0)|0,x=+X[f+(Vt<<4)>>3],T=+go(+X[f+(Vt<<4)+8>>3],c[ze>>2]|0),!(he>=be)|!(x>=be)&&!(he<=Pe)|!(x<=Pe)&&!(ce<=ue)|!(T<=ue)&&!(ce>=He)|!(T>=He)){te=x-he,I=T-ce,f=0;do if(gn=f,f=f+1|0,Vt=(f|0)==(_|0)?0:f,x=+X[Ue+8+(gn<<4)+8>>3],T=+X[Ue+8+(Vt<<4)+8>>3]-x,M=+X[Ue+8+(gn<<4)>>3],N=+X[Ue+8+(Vt<<4)>>3]-M,k=te*T-I*N,k!=0&&(Se=ce-x,vt=he-M,N=(Se*N-T*vt)/k,!(N<0|N>1))&&(k=(te*Se-I*vt)/k,k>=0&k<=1)){f=1;break e}while((f|0)<(_|0))}if((d|0)>=(c[h>>2]|0)){f=0;break}}}else f=0;while(!1);return gn=f,Q=Ht,gn|0}function g8(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0;if(Yp(h,f,d,m)|0)return x=1,x|0;if(x=h+8|0,(c[x>>2]|0)<=0)return x=0,x|0;for(_=h+12|0,h=0;;){if(T=h,h=h+1|0,Yp((c[_>>2]|0)+(T<<3)|0,f+(h<<5)|0,d,m)|0){h=1,_=6;break}if((h|0)>=(c[x>>2]|0)){h=0,_=6;break}}return(_|0)==6?h|0:0}function KB(){return 8}function JB(){return 16}function eF(){return 168}function tF(){return 8}function nF(){return 16}function iF(){return 12}function rF(){return 8}function sF(h){return h=h|0,+(+((c[h>>2]|0)>>>0)+4294967296*+(c[h+4>>2]|0))}function oF(h){h=h|0;var f=0,d=0;return d=+X[h>>3],f=+X[h+8>>3],+ +ht(+(d*d+f*f))}function _8(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0;I=+X[h>>3],N=+X[f>>3]-I,M=+X[h+8>>3],T=+X[f+8>>3]-M,te=+X[d>>3],x=+X[m>>3]-te,he=+X[d+8>>3],k=+X[m+8>>3]-he,x=(x*(M-he)-(I-te)*k)/(N*k-T*x),X[_>>3]=I+N*x,X[_+8>>3]=M+T*x}function v8(h,f){return h=h|0,f=f|0,+an(+(+X[h>>3]-+X[f>>3]))<11920928955078125e-23?(f=+an(+(+X[h+8>>3]-+X[f+8>>3]))<11920928955078125e-23,f|0):(f=0,f|0)}function xr(h,f){h=h|0,f=f|0;var d=0,m=0,_=0;return _=+X[h>>3]-+X[f>>3],m=+X[h+8>>3]-+X[f+8>>3],d=+X[h+16>>3]-+X[f+16>>3],+(_*_+m*m+d*d)}function aF(h,f){h=h|0,f=f|0;var d=0,m=0,_=0;d=+X[h>>3],m=+un(+d),d=+qt(+d),X[f+16>>3]=d,d=+X[h+8>>3],_=m*+un(+d),X[f>>3]=_,d=m*+qt(+d),X[f+8>>3]=d}function lF(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0;if(x=Q,Q=Q+16|0,_=x,m=yi(h,f)|0,(d+-1|0)>>>0>5||(m=(m|0)!=0,(d|0)==1&m))return _=-1,Q=x,_|0;do if(e0(h,f,_)|0)m=-1;else if(m){m=((c[26352+(d<<2)>>2]|0)+5-(c[_>>2]|0)|0)%5|0;break}else{m=((c[26384+(d<<2)>>2]|0)+6-(c[_>>2]|0)|0)%6|0;break}while(!1);return _=m,Q=x,_|0}function e0(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0,I=0;if(I=Q,Q=Q+32|0,T=I+16|0,M=I,m=Dh(h,f,T)|0,m|0)return d=m,Q=I,d|0;x=r8(h,f)|0,N=js(h,f)|0,qI(x,M),m=GI(x,c[T>>2]|0)|0;e:do if(Mi(x)|0){do switch(x|0){case 4:{h=0;break}case 14:{h=1;break}case 24:{h=2;break}case 38:{h=3;break}case 49:{h=4;break}case 58:{h=5;break}case 63:{h=6;break}case 72:{h=7;break}case 83:{h=8;break}case 97:{h=9;break}case 107:{h=10;break}case 117:{h=11;break}default:{m=1;break e}}while(!1);if(_=c[26416+(h*24|0)+8>>2]|0,f=c[26416+(h*24|0)+16>>2]|0,h=c[T>>2]|0,(h|0)!=(c[M>>2]|0)&&(M=E_(x)|0,h=c[T>>2]|0,M|(h|0)==(f|0)&&(m=(m+1|0)%6|0)),(N|0)==3&(h|0)==(f|0)){m=(m+5|0)%6|0,_=22;break}(N|0)==5&(h|0)==(_|0)&&(m=(m+1|0)%6|0),_=22}else _=22;while(!1);return(_|0)==22&&(c[d>>2]=m,m=0),d=m,Q=I,d|0}function qo(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0;if(Ue=Q,Q=Q+32|0,ze=Ue+24|0,Pe=Ue+20|0,ce=Ue+8|0,ue=Ue+16|0,he=Ue,N=(yi(h,f)|0)==0,N=N?6:5,k=ct(h|0,f|0,52)|0,Y()|0,k=k&15,N>>>0<=d>>>0)return m=2,Q=Ue,m|0;te=(k|0)==0,!te&&(be=St(7,0,(k^15)*3|0)|0,(be&h|0)==0&((Y()|0)&f|0)==0)?_=d:x=4;e:do if((x|0)==4){if(_=(yi(h,f)|0)!=0,((_?4:5)|0)<(d|0)||e0(h,f,ze)|0||(x=(c[ze>>2]|0)+d|0,_?_=26704+(((x|0)%5|0)<<2)|0:_=26736+(((x|0)%6|0)<<2)|0,be=c[_>>2]|0,(be|0)==7))return m=1,Q=Ue,m|0;c[Pe>>2]=0,_=ei(h,f,be,Pe,ce)|0;do if(!_){if(M=ce,I=c[M>>2]|0,M=c[M+4>>2]|0,T=M>>>0<f>>>0|(M|0)==(f|0)&I>>>0<h>>>0,x=T?I:h,T=T?M:f,!te&&(te=St(7,0,(k^15)*3|0)|0,(I&te|0)==0&(M&(Y()|0)|0)==0))_=d;else{if(M=(d+-1+N|0)%(N|0)|0,_=yi(h,f)|0,(M|0)<0&&mt(27795,27797,246,27806),N=(_|0)!=0,((N?4:5)|0)<(M|0)&&mt(27795,27797,246,27806),e0(h,f,ze)|0&&mt(27795,27797,246,27806),_=(c[ze>>2]|0)+M|0,N?_=26704+(((_|0)%5|0)<<2)|0:_=26736+(((_|0)%6|0)<<2)|0,M=c[_>>2]|0,(M|0)==7&&mt(27795,27797,246,27806),c[ue>>2]=0,_=ei(h,f,M,ue,he)|0,_|0)break;I=he,N=c[I>>2]|0,I=c[I+4>>2]|0;do if(I>>>0<T>>>0|(I|0)==(T|0)&N>>>0<x>>>0){if(yi(N,I)|0?x=dr(N,I,h,f)|0:x=c[26800+((((c[ue>>2]|0)+(c[26768+(M<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=yi(N,I)|0,(x+-1|0)>>>0>5){_=-1,x=N,T=I;break}if(_=(_|0)!=0,(x|0)==1&_){_=-1,x=N,T=I;break}do if(e0(N,I,ze)|0)_=-1;else if(_){_=((c[26352+(x<<2)>>2]|0)+5-(c[ze>>2]|0)|0)%5|0;break}else{_=((c[26384+(x<<2)>>2]|0)+6-(c[ze>>2]|0)|0)%6|0;break}while(!1);x=N,T=I}else _=d;while(!1);M=ce,I=c[M>>2]|0,M=c[M+4>>2]|0}if((x|0)==(I|0)&(T|0)==(M|0)){if(N=(yi(I,M)|0)!=0,N?h=dr(I,M,h,f)|0:h=c[26800+((((c[Pe>>2]|0)+(c[26768+(be<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,_=yi(I,M)|0,(h+-1|0)>>>0<=5&&(He=(_|0)!=0,!((h|0)==1&He)))do if(e0(I,M,ze)|0)_=-1;else if(He){_=((c[26352+(h<<2)>>2]|0)+5-(c[ze>>2]|0)|0)%5|0;break}else{_=((c[26384+(h<<2)>>2]|0)+6-(c[ze>>2]|0)|0)%6|0;break}while(!1);else _=-1;_=_+1|0,_=(_|0)==6|N&(_|0)==5?0:_}f=T,h=x;break e}while(!1);return m=_,Q=Ue,m|0}while(!1);return He=St(_|0,0,56)|0,ze=Y()|0|f&-2130706433|536870912,c[m>>2]=He|h,c[m+4>>2]=ze,m=0,Q=Ue,m|0}function uF(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0;return x=(yi(h,f)|0)==0,m=qo(h,f,0,d)|0,_=(m|0)==0,x?!_||(m=qo(h,f,1,d+8|0)|0,m|0)||(m=qo(h,f,2,d+16|0)|0,m|0)||(m=qo(h,f,3,d+24|0)|0,m|0)||(m=qo(h,f,4,d+32|0)|0,m)?(x=m,x|0):qo(h,f,5,d+40|0)|0:!_||(m=qo(h,f,1,d+8|0)|0,m|0)||(m=qo(h,f,2,d+16|0)|0,m|0)||(m=qo(h,f,3,d+24|0)|0,m|0)||(m=qo(h,f,4,d+32|0)|0,m|0)?(x=m,x|0):(x=d+40|0,c[x>>2]=0,c[x+4>>2]=0,x=0,x|0)}function cF(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0,M=0,N=0;return N=Q,Q=Q+192|0,_=N,x=N+168|0,T=ct(h|0,f|0,56)|0,Y()|0,T=T&7,M=f&-2130706433|134217728,m=Dh(h,M,x)|0,m|0?(M=m,Q=N,M|0):(f=ct(h|0,f|0,52)|0,Y()|0,f=f&15,yi(h,M)|0?I_(x,f,T,1,_):B_(x,f,T,1,_),M=_+8|0,c[d>>2]=c[M>>2],c[d+4>>2]=c[M+4>>2],c[d+8>>2]=c[M+8>>2],c[d+12>>2]=c[M+12>>2],M=0,Q=N,M|0)}function hF(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0;return _=Q,Q=Q+16|0,d=_,!(!0&(f&2013265920|0)==536870912)||(m=f&-2130706433|134217728,!(F_(h,m)|0))?(m=0,Q=_,m|0):(x=ct(h|0,f|0,56)|0,Y()|0,x=(qo(h,m,x&7,d)|0)==0,m=d,m=x&((c[m>>2]|0)==(h|0)?(c[m+4>>2]|0)==(f|0):0)&1,Q=_,m|0)}function y8(h,f,d){h=h|0,f=f|0,d=d|0;var m=0;(f|0)>0?(m=Go(f,4)|0,c[h>>2]=m,m||mt(27819,27842,40,27856)):c[h>>2]=0,c[h+4>>2]=f,c[h+8>>2]=0,c[h+12>>2]=d}function x8(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0;_=h+4|0,x=h+12|0,T=h+8|0;e:for(;;){for(d=c[_>>2]|0,f=0;;){if((f|0)>=(d|0))break e;if(m=c[h>>2]|0,M=c[m+(f<<2)>>2]|0,!M)f=f+1|0;else break}f=m+(~~(+an(+(+tr(10,+ +(15-(c[x>>2]|0)|0))*(+X[M>>3]+ +X[M+8>>3])))%+(d|0))>>>0<<2)|0,d=c[f>>2]|0;t:do if(d|0){if(m=M+32|0,(d|0)==(M|0))c[f>>2]=c[m>>2];else{if(d=d+32|0,f=c[d>>2]|0,!f)break;for(;(f|0)!=(M|0);)if(d=f+32|0,f=c[d>>2]|0,!f)break t;c[d>>2]=c[m>>2]}hn(M),c[T>>2]=(c[T>>2]|0)+-1}while(!1)}hn(c[h>>2]|0)}function b8(h){h=h|0;var f=0,d=0,m=0;for(m=c[h+4>>2]|0,d=0;;){if((d|0)>=(m|0)){f=0,d=4;break}if(f=c[(c[h>>2]|0)+(d<<2)>>2]|0,!f)d=d+1|0;else{d=4;break}}return(d|0)==4?f|0:0}function T8(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0;if(d=~~(+an(+(+tr(10,+ +(15-(c[h+12>>2]|0)|0))*(+X[f>>3]+ +X[f+8>>3])))%+(c[h+4>>2]|0))>>>0,d=(c[h>>2]|0)+(d<<2)|0,m=c[d>>2]|0,!m)return x=1,x|0;x=f+32|0;do if((m|0)!=(f|0)){if(d=c[m+32>>2]|0,!d)return x=1,x|0;for(_=d;;){if((_|0)==(f|0)){_=8;break}if(d=c[_+32>>2]|0,d)m=_,_=d;else{d=1,_=10;break}}if((_|0)==8){c[m+32>>2]=c[x>>2];break}else if((_|0)==10)return d|0}else c[d>>2]=c[x>>2];while(!1);return hn(f),x=h+8|0,c[x>>2]=(c[x>>2]|0)+-1,x=0,x|0}function fF(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0;x=ka(40)|0,x||mt(27872,27842,98,27885),c[x>>2]=c[f>>2],c[x+4>>2]=c[f+4>>2],c[x+8>>2]=c[f+8>>2],c[x+12>>2]=c[f+12>>2],_=x+16|0,c[_>>2]=c[d>>2],c[_+4>>2]=c[d+4>>2],c[_+8>>2]=c[d+8>>2],c[_+12>>2]=c[d+12>>2],c[x+32>>2]=0,_=~~(+an(+(+tr(10,+ +(15-(c[h+12>>2]|0)|0))*(+X[f>>3]+ +X[f+8>>3])))%+(c[h+4>>2]|0))>>>0,_=(c[h>>2]|0)+(_<<2)|0,m=c[_>>2]|0;do if(!m)c[_>>2]=x;else{for(;!(Bh(m,f)|0&&Bh(m+16|0,d)|0);)if(_=c[m+32>>2]|0,m=(_|0)==0?m:_,!(c[m+32>>2]|0)){T=10;break}if((T|0)==10){c[m+32>>2]=x;break}return hn(x),T=m,T|0}while(!1);return T=h+8|0,c[T>>2]=(c[T>>2]|0)+1,T=x,T|0}function AF(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0;if(_=~~(+an(+(+tr(10,+ +(15-(c[h+12>>2]|0)|0))*(+X[f>>3]+ +X[f+8>>3])))%+(c[h+4>>2]|0))>>>0,_=c[(c[h>>2]|0)+(_<<2)>>2]|0,!_)return d=0,d|0;if(!d){for(h=_;;){if(Bh(h,f)|0){m=10;break}if(h=c[h+32>>2]|0,!h){h=0,m=10;break}}if((m|0)==10)return h|0}for(h=_;;){if(Bh(h,f)|0&&Bh(h+16|0,d)|0){m=10;break}if(h=c[h+32>>2]|0,!h){h=0,m=10;break}}return(m|0)==10?h|0:0}function dF(h,f){h=h|0,f=f|0;var d=0;if(d=~~(+an(+(+tr(10,+ +(15-(c[h+12>>2]|0)|0))*(+X[f>>3]+ +X[f+8>>3])))%+(c[h+4>>2]|0))>>>0,h=c[(c[h>>2]|0)+(d<<2)>>2]|0,!h)return d=0,d|0;for(;;){if(Bh(h,f)|0){f=5;break}if(h=c[h+32>>2]|0,!h){h=0,f=5;break}}return(f|0)==5?h|0:0}function pF(){return 27904}function mu(h){return h=+h,~~+C8(+h)|0}function ka(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0,be=0,Pe=0,He=0,ze=0,Ue=0,Se=0,vt=0;vt=Q,Q=Q+16|0,he=vt;do if(h>>>0<245){if(I=h>>>0<11?16:h+11&-8,h=I>>>3,te=c[6977]|0,d=te>>>h,d&3|0)return f=(d&1^1)+h|0,h=27948+(f<<1<<2)|0,d=h+8|0,m=c[d>>2]|0,_=m+8|0,x=c[_>>2]|0,(x|0)==(h|0)?c[6977]=te&~(1<<f):(c[x+12>>2]=h,c[d>>2]=x),Se=f<<3,c[m+4>>2]=Se|3,Se=m+Se+4|0,c[Se>>2]=c[Se>>2]|1,Se=_,Q=vt,Se|0;if(k=c[6979]|0,I>>>0>k>>>0){if(d|0)return f=2<<h,f=d<<h&(f|0-f),f=(f&0-f)+-1|0,M=f>>>12&16,f=f>>>M,d=f>>>5&8,f=f>>>d,x=f>>>2&4,f=f>>>x,h=f>>>1&2,f=f>>>h,m=f>>>1&1,m=(d|M|x|h|m)+(f>>>m)|0,f=27948+(m<<1<<2)|0,h=f+8|0,x=c[h>>2]|0,M=x+8|0,d=c[M>>2]|0,(d|0)==(f|0)?(h=te&~(1<<m),c[6977]=h):(c[d+12>>2]=f,c[h>>2]=d,h=te),Se=m<<3,T=Se-I|0,c[x+4>>2]=I|3,_=x+I|0,c[_+4>>2]=T|1,c[x+Se>>2]=T,k|0&&(m=c[6982]|0,f=k>>>3,d=27948+(f<<1<<2)|0,f=1<<f,h&f?(h=d+8|0,f=c[h>>2]|0):(c[6977]=h|f,f=d,h=d+8|0),c[h>>2]=m,c[f+12>>2]=m,c[m+8>>2]=f,c[m+12>>2]=d),c[6979]=T,c[6982]=_,Se=M,Q=vt,Se|0;if(x=c[6978]|0,x){for(d=(x&0-x)+-1|0,_=d>>>12&16,d=d>>>_,m=d>>>5&8,d=d>>>m,T=d>>>2&4,d=d>>>T,M=d>>>1&2,d=d>>>M,N=d>>>1&1,N=c[28212+((m|_|T|M|N)+(d>>>N)<<2)>>2]|0,d=N,M=N,N=(c[N+4>>2]&-8)-I|0;h=c[d+16>>2]|0,!(!h&&(h=c[d+20>>2]|0,!h));)T=(c[h+4>>2]&-8)-I|0,_=T>>>0<N>>>0,d=h,M=_?h:M,N=_?T:N;if(T=M+I|0,T>>>0>M>>>0){_=c[M+24>>2]|0,f=c[M+12>>2]|0;do if((f|0)==(M|0)){if(h=M+20|0,f=c[h>>2]|0,!f&&(h=M+16|0,f=c[h>>2]|0,!f)){d=0;break}for(;;)if(m=f+20|0,d=c[m>>2]|0,d)f=d,h=m;else if(m=f+16|0,d=c[m>>2]|0,d)f=d,h=m;else break;c[h>>2]=0,d=f}else d=c[M+8>>2]|0,c[d+12>>2]=f,c[f+8>>2]=d,d=f;while(!1);do if(_|0){if(f=c[M+28>>2]|0,h=28212+(f<<2)|0,(M|0)==(c[h>>2]|0)){if(c[h>>2]=d,!d){c[6978]=x&~(1<<f);break}}else if(Se=_+16|0,c[((c[Se>>2]|0)==(M|0)?Se:_+20|0)>>2]=d,!d)break;c[d+24>>2]=_,f=c[M+16>>2]|0,f|0&&(c[d+16>>2]=f,c[f+24>>2]=d),f=c[M+20>>2]|0,f|0&&(c[d+20>>2]=f,c[f+24>>2]=d)}while(!1);return N>>>0<16?(Se=N+I|0,c[M+4>>2]=Se|3,Se=M+Se+4|0,c[Se>>2]=c[Se>>2]|1):(c[M+4>>2]=I|3,c[T+4>>2]=N|1,c[T+N>>2]=N,k|0&&(m=c[6982]|0,f=k>>>3,d=27948+(f<<1<<2)|0,f=1<<f,f&te?(h=d+8|0,f=c[h>>2]|0):(c[6977]=f|te,f=d,h=d+8|0),c[h>>2]=m,c[f+12>>2]=m,c[m+8>>2]=f,c[m+12>>2]=d),c[6979]=N,c[6982]=T),Se=M+8|0,Q=vt,Se|0}else te=I}else te=I}else te=I}else if(h>>>0<=4294967231)if(h=h+11|0,I=h&-8,m=c[6978]|0,m){_=0-I|0,h=h>>>8,h?I>>>0>16777215?N=31:(te=(h+1048320|0)>>>16&8,be=h<<te,M=(be+520192|0)>>>16&4,be=be<<M,N=(be+245760|0)>>>16&2,N=14-(M|te|N)+(be<<N>>>15)|0,N=I>>>(N+7|0)&1|N<<1):N=0,d=c[28212+(N<<2)>>2]|0;e:do if(!d)d=0,h=0,be=61;else for(h=0,M=I<<((N|0)==31?0:25-(N>>>1)|0),x=0;;){if(T=(c[d+4>>2]&-8)-I|0,T>>>0<_>>>0)if(T)h=d,_=T;else{h=d,_=0,be=65;break e}if(be=c[d+20>>2]|0,d=c[d+16+(M>>>31<<2)>>2]|0,x=(be|0)==0|(be|0)==(d|0)?x:be,d)M=M<<1;else{d=x,be=61;break}}while(!1);if((be|0)==61){if((d|0)==0&(h|0)==0){if(h=2<<N,h=(h|0-h)&m,!h){te=I;break}te=(h&0-h)+-1|0,T=te>>>12&16,te=te>>>T,x=te>>>5&8,te=te>>>x,M=te>>>2&4,te=te>>>M,N=te>>>1&2,te=te>>>N,d=te>>>1&1,h=0,d=c[28212+((x|T|M|N|d)+(te>>>d)<<2)>>2]|0}d?be=65:(M=h,T=_)}if((be|0)==65)for(x=d;;)if(te=(c[x+4>>2]&-8)-I|0,d=te>>>0<_>>>0,_=d?te:_,h=d?x:h,d=c[x+16>>2]|0,d||(d=c[x+20>>2]|0),d)x=d;else{M=h,T=_;break}if((M|0)!=0&&T>>>0<((c[6979]|0)-I|0)>>>0&&(k=M+I|0,k>>>0>M>>>0)){x=c[M+24>>2]|0,f=c[M+12>>2]|0;do if((f|0)==(M|0)){if(h=M+20|0,f=c[h>>2]|0,!f&&(h=M+16|0,f=c[h>>2]|0,!f)){f=0;break}for(;;)if(_=f+20|0,d=c[_>>2]|0,d)f=d,h=_;else if(_=f+16|0,d=c[_>>2]|0,d)f=d,h=_;else break;c[h>>2]=0}else Se=c[M+8>>2]|0,c[Se+12>>2]=f,c[f+8>>2]=Se;while(!1);do if(x){if(h=c[M+28>>2]|0,d=28212+(h<<2)|0,(M|0)==(c[d>>2]|0)){if(c[d>>2]=f,!f){m=m&~(1<<h),c[6978]=m;break}}else if(Se=x+16|0,c[((c[Se>>2]|0)==(M|0)?Se:x+20|0)>>2]=f,!f)break;c[f+24>>2]=x,h=c[M+16>>2]|0,h|0&&(c[f+16>>2]=h,c[h+24>>2]=f),h=c[M+20>>2]|0,h&&(c[f+20>>2]=h,c[h+24>>2]=f)}while(!1);e:do if(T>>>0<16)Se=T+I|0,c[M+4>>2]=Se|3,Se=M+Se+4|0,c[Se>>2]=c[Se>>2]|1;else{if(c[M+4>>2]=I|3,c[k+4>>2]=T|1,c[k+T>>2]=T,f=T>>>3,T>>>0<256){d=27948+(f<<1<<2)|0,h=c[6977]|0,f=1<<f,h&f?(h=d+8|0,f=c[h>>2]|0):(c[6977]=h|f,f=d,h=d+8|0),c[h>>2]=k,c[f+12>>2]=k,c[k+8>>2]=f,c[k+12>>2]=d;break}if(f=T>>>8,f?T>>>0>16777215?d=31:(Ue=(f+1048320|0)>>>16&8,Se=f<<Ue,ze=(Se+520192|0)>>>16&4,Se=Se<<ze,d=(Se+245760|0)>>>16&2,d=14-(ze|Ue|d)+(Se<<d>>>15)|0,d=T>>>(d+7|0)&1|d<<1):d=0,f=28212+(d<<2)|0,c[k+28>>2]=d,h=k+16|0,c[h+4>>2]=0,c[h>>2]=0,h=1<<d,!(m&h)){c[6978]=m|h,c[f>>2]=k,c[k+24>>2]=f,c[k+12>>2]=k,c[k+8>>2]=k;break}f=c[f>>2]|0;t:do if((c[f+4>>2]&-8|0)!=(T|0)){for(m=T<<((d|0)==31?0:25-(d>>>1)|0);d=f+16+(m>>>31<<2)|0,h=c[d>>2]|0,!!h;)if((c[h+4>>2]&-8|0)==(T|0)){f=h;break t}else m=m<<1,f=h;c[d>>2]=k,c[k+24>>2]=f,c[k+12>>2]=k,c[k+8>>2]=k;break e}while(!1);Ue=f+8|0,Se=c[Ue>>2]|0,c[Se+12>>2]=k,c[Ue>>2]=k,c[k+8>>2]=Se,c[k+12>>2]=f,c[k+24>>2]=0}while(!1);return Se=M+8|0,Q=vt,Se|0}else te=I}else te=I;else te=-1;while(!1);if(d=c[6979]|0,d>>>0>=te>>>0)return f=d-te|0,h=c[6982]|0,f>>>0>15?(Se=h+te|0,c[6982]=Se,c[6979]=f,c[Se+4>>2]=f|1,c[h+d>>2]=f,c[h+4>>2]=te|3):(c[6979]=0,c[6982]=0,c[h+4>>2]=d|3,Se=h+d+4|0,c[Se>>2]=c[Se>>2]|1),Se=h+8|0,Q=vt,Se|0;if(T=c[6980]|0,T>>>0>te>>>0)return ze=T-te|0,c[6980]=ze,Se=c[6983]|0,Ue=Se+te|0,c[6983]=Ue,c[Ue+4>>2]=ze|1,c[Se+4>>2]=te|3,Se=Se+8|0,Q=vt,Se|0;if(c[7095]|0?h=c[7097]|0:(c[7097]=4096,c[7096]=4096,c[7098]=-1,c[7099]=-1,c[7100]=0,c[7088]=0,c[7095]=he&-16^1431655768,h=4096),M=te+48|0,N=te+47|0,x=h+N|0,_=0-h|0,I=x&_,I>>>0<=te>>>0||(h=c[7087]|0,h|0&&(k=c[7085]|0,he=k+I|0,he>>>0<=k>>>0|he>>>0>h>>>0)))return Se=0,Q=vt,Se|0;e:do if(c[7088]&4)f=0,be=143;else{d=c[6983]|0;t:do if(d){for(m=28356;he=c[m>>2]|0,!(he>>>0<=d>>>0&&(he+(c[m+4>>2]|0)|0)>>>0>d>>>0);)if(h=c[m+8>>2]|0,h)m=h;else{be=128;break t}if(f=x-T&_,f>>>0<2147483647)if(h=_u(f|0)|0,(h|0)==((c[m>>2]|0)+(c[m+4>>2]|0)|0)){if((h|0)!=-1){T=f,x=h,be=145;break e}}else m=h,be=136;else f=0}else be=128;while(!1);do if((be|0)==128)if(d=_u(0)|0,(d|0)!=-1&&(f=d,ue=c[7096]|0,ce=ue+-1|0,f=((ce&f|0)==0?0:(ce+f&0-ue)-f|0)+I|0,ue=c[7085]|0,ce=f+ue|0,f>>>0>te>>>0&f>>>0<2147483647)){if(he=c[7087]|0,he|0&&ce>>>0<=ue>>>0|ce>>>0>he>>>0){f=0;break}if(h=_u(f|0)|0,(h|0)==(d|0)){T=f,x=d,be=145;break e}else m=h,be=136}else f=0;while(!1);do if((be|0)==136){if(d=0-f|0,!(M>>>0>f>>>0&(f>>>0<2147483647&(m|0)!=-1)))if((m|0)==-1){f=0;break}else{T=f,x=m,be=145;break e}if(h=c[7097]|0,h=N-f+h&0-h,h>>>0>=2147483647){T=f,x=m,be=145;break e}if((_u(h|0)|0)==-1){_u(d|0)|0,f=0;break}else{T=h+f|0,x=m,be=145;break e}}while(!1);c[7088]=c[7088]|4,be=143}while(!1);if((be|0)==143&&I>>>0<2147483647&&(ze=_u(I|0)|0,ce=_u(0)|0,Pe=ce-ze|0,He=Pe>>>0>(te+40|0)>>>0,!((ze|0)==-1|He^1|ze>>>0<ce>>>0&((ze|0)!=-1&(ce|0)!=-1)^1))&&(T=He?Pe:f,x=ze,be=145),(be|0)==145){f=(c[7085]|0)+T|0,c[7085]=f,f>>>0>(c[7086]|0)>>>0&&(c[7086]=f),N=c[6983]|0;e:do if(N){for(f=28356;;){if(h=c[f>>2]|0,d=c[f+4>>2]|0,(x|0)==(h+d|0)){be=154;break}if(m=c[f+8>>2]|0,m)f=m;else break}if((be|0)==154&&(Ue=f+4|0,(c[f+12>>2]&8|0)==0)&&x>>>0>N>>>0&h>>>0<=N>>>0){c[Ue>>2]=d+T,Se=(c[6980]|0)+T|0,ze=N+8|0,ze=(ze&7|0)==0?0:0-ze&7,Ue=N+ze|0,ze=Se-ze|0,c[6983]=Ue,c[6980]=ze,c[Ue+4>>2]=ze|1,c[N+Se+4>>2]=40,c[6984]=c[7099];break}for(x>>>0<(c[6981]|0)>>>0&&(c[6981]=x),d=x+T|0,f=28356;;){if((c[f>>2]|0)==(d|0)){be=162;break}if(h=c[f+8>>2]|0,h)f=h;else break}if((be|0)==162&&(c[f+12>>2]&8|0)==0){c[f>>2]=x,k=f+4|0,c[k>>2]=(c[k>>2]|0)+T,k=x+8|0,k=x+((k&7|0)==0?0:0-k&7)|0,f=d+8|0,f=d+((f&7|0)==0?0:0-f&7)|0,I=k+te|0,M=f-k-te|0,c[k+4>>2]=te|3;t:do if((N|0)==(f|0))Se=(c[6980]|0)+M|0,c[6980]=Se,c[6983]=I,c[I+4>>2]=Se|1;else{if((c[6982]|0)==(f|0)){Se=(c[6979]|0)+M|0,c[6979]=Se,c[6982]=I,c[I+4>>2]=Se|1,c[I+Se>>2]=Se;break}if(h=c[f+4>>2]|0,(h&3|0)==1){T=h&-8,m=h>>>3;n:do if(h>>>0<256)if(h=c[f+8>>2]|0,d=c[f+12>>2]|0,(d|0)==(h|0)){c[6977]=c[6977]&~(1<<m);break}else{c[h+12>>2]=d,c[d+8>>2]=h;break}else{x=c[f+24>>2]|0,h=c[f+12>>2]|0;do if((h|0)==(f|0)){if(d=f+16|0,m=d+4|0,h=c[m>>2]|0,h)d=m;else if(h=c[d>>2]|0,!h){h=0;break}for(;;)if(_=h+20|0,m=c[_>>2]|0,m)h=m,d=_;else if(_=h+16|0,m=c[_>>2]|0,m)h=m,d=_;else break;c[d>>2]=0}else Se=c[f+8>>2]|0,c[Se+12>>2]=h,c[h+8>>2]=Se;while(!1);if(!x)break;d=c[f+28>>2]|0,m=28212+(d<<2)|0;do if((c[m>>2]|0)!=(f|0)){if(Se=x+16|0,c[((c[Se>>2]|0)==(f|0)?Se:x+20|0)>>2]=h,!h)break n}else{if(c[m>>2]=h,h|0)break;c[6978]=c[6978]&~(1<<d);break n}while(!1);if(c[h+24>>2]=x,d=f+16|0,m=c[d>>2]|0,m|0&&(c[h+16>>2]=m,c[m+24>>2]=h),d=c[d+4>>2]|0,!d)break;c[h+20>>2]=d,c[d+24>>2]=h}while(!1);f=f+T|0,_=T+M|0}else _=M;if(f=f+4|0,c[f>>2]=c[f>>2]&-2,c[I+4>>2]=_|1,c[I+_>>2]=_,f=_>>>3,_>>>0<256){d=27948+(f<<1<<2)|0,h=c[6977]|0,f=1<<f,h&f?(h=d+8|0,f=c[h>>2]|0):(c[6977]=h|f,f=d,h=d+8|0),c[h>>2]=I,c[f+12>>2]=I,c[I+8>>2]=f,c[I+12>>2]=d;break}f=_>>>8;do if(!f)m=0;else{if(_>>>0>16777215){m=31;break}Ue=(f+1048320|0)>>>16&8,Se=f<<Ue,ze=(Se+520192|0)>>>16&4,Se=Se<<ze,m=(Se+245760|0)>>>16&2,m=14-(ze|Ue|m)+(Se<<m>>>15)|0,m=_>>>(m+7|0)&1|m<<1}while(!1);if(f=28212+(m<<2)|0,c[I+28>>2]=m,h=I+16|0,c[h+4>>2]=0,c[h>>2]=0,h=c[6978]|0,d=1<<m,!(h&d)){c[6978]=h|d,c[f>>2]=I,c[I+24>>2]=f,c[I+12>>2]=I,c[I+8>>2]=I;break}f=c[f>>2]|0;n:do if((c[f+4>>2]&-8|0)!=(_|0)){for(m=_<<((m|0)==31?0:25-(m>>>1)|0);d=f+16+(m>>>31<<2)|0,h=c[d>>2]|0,!!h;)if((c[h+4>>2]&-8|0)==(_|0)){f=h;break n}else m=m<<1,f=h;c[d>>2]=I,c[I+24>>2]=f,c[I+12>>2]=I,c[I+8>>2]=I;break t}while(!1);Ue=f+8|0,Se=c[Ue>>2]|0,c[Se+12>>2]=I,c[Ue>>2]=I,c[I+8>>2]=Se,c[I+12>>2]=f,c[I+24>>2]=0}while(!1);return Se=k+8|0,Q=vt,Se|0}for(f=28356;h=c[f>>2]|0,!(h>>>0<=N>>>0&&(Se=h+(c[f+4>>2]|0)|0,Se>>>0>N>>>0));)f=c[f+8>>2]|0;_=Se+-47|0,h=_+8|0,h=_+((h&7|0)==0?0:0-h&7)|0,_=N+16|0,h=h>>>0<_>>>0?N:h,f=h+8|0,d=T+-40|0,ze=x+8|0,ze=(ze&7|0)==0?0:0-ze&7,Ue=x+ze|0,ze=d-ze|0,c[6983]=Ue,c[6980]=ze,c[Ue+4>>2]=ze|1,c[x+d+4>>2]=40,c[6984]=c[7099],d=h+4|0,c[d>>2]=27,c[f>>2]=c[7089],c[f+4>>2]=c[7090],c[f+8>>2]=c[7091],c[f+12>>2]=c[7092],c[7089]=x,c[7090]=T,c[7092]=0,c[7091]=f,f=h+24|0;do Ue=f,f=f+4|0,c[f>>2]=7;while((Ue+8|0)>>>0<Se>>>0);if((h|0)!=(N|0)){if(x=h-N|0,c[d>>2]=c[d>>2]&-2,c[N+4>>2]=x|1,c[h>>2]=x,f=x>>>3,x>>>0<256){d=27948+(f<<1<<2)|0,h=c[6977]|0,f=1<<f,h&f?(h=d+8|0,f=c[h>>2]|0):(c[6977]=h|f,f=d,h=d+8|0),c[h>>2]=N,c[f+12>>2]=N,c[N+8>>2]=f,c[N+12>>2]=d;break}if(f=x>>>8,f?x>>>0>16777215?m=31:(Ue=(f+1048320|0)>>>16&8,Se=f<<Ue,ze=(Se+520192|0)>>>16&4,Se=Se<<ze,m=(Se+245760|0)>>>16&2,m=14-(ze|Ue|m)+(Se<<m>>>15)|0,m=x>>>(m+7|0)&1|m<<1):m=0,d=28212+(m<<2)|0,c[N+28>>2]=m,c[N+20>>2]=0,c[_>>2]=0,f=c[6978]|0,h=1<<m,!(f&h)){c[6978]=f|h,c[d>>2]=N,c[N+24>>2]=d,c[N+12>>2]=N,c[N+8>>2]=N;break}f=c[d>>2]|0;t:do if((c[f+4>>2]&-8|0)!=(x|0)){for(m=x<<((m|0)==31?0:25-(m>>>1)|0);d=f+16+(m>>>31<<2)|0,h=c[d>>2]|0,!!h;)if((c[h+4>>2]&-8|0)==(x|0)){f=h;break t}else m=m<<1,f=h;c[d>>2]=N,c[N+24>>2]=f,c[N+12>>2]=N,c[N+8>>2]=N;break e}while(!1);Ue=f+8|0,Se=c[Ue>>2]|0,c[Se+12>>2]=N,c[Ue>>2]=N,c[N+8>>2]=Se,c[N+12>>2]=f,c[N+24>>2]=0}}else Se=c[6981]|0,(Se|0)==0|x>>>0<Se>>>0&&(c[6981]=x),c[7089]=x,c[7090]=T,c[7092]=0,c[6986]=c[7095],c[6985]=-1,c[6990]=27948,c[6989]=27948,c[6992]=27956,c[6991]=27956,c[6994]=27964,c[6993]=27964,c[6996]=27972,c[6995]=27972,c[6998]=27980,c[6997]=27980,c[7e3]=27988,c[6999]=27988,c[7002]=27996,c[7001]=27996,c[7004]=28004,c[7003]=28004,c[7006]=28012,c[7005]=28012,c[7008]=28020,c[7007]=28020,c[7010]=28028,c[7009]=28028,c[7012]=28036,c[7011]=28036,c[7014]=28044,c[7013]=28044,c[7016]=28052,c[7015]=28052,c[7018]=28060,c[7017]=28060,c[7020]=28068,c[7019]=28068,c[7022]=28076,c[7021]=28076,c[7024]=28084,c[7023]=28084,c[7026]=28092,c[7025]=28092,c[7028]=28100,c[7027]=28100,c[7030]=28108,c[7029]=28108,c[7032]=28116,c[7031]=28116,c[7034]=28124,c[7033]=28124,c[7036]=28132,c[7035]=28132,c[7038]=28140,c[7037]=28140,c[7040]=28148,c[7039]=28148,c[7042]=28156,c[7041]=28156,c[7044]=28164,c[7043]=28164,c[7046]=28172,c[7045]=28172,c[7048]=28180,c[7047]=28180,c[7050]=28188,c[7049]=28188,c[7052]=28196,c[7051]=28196,Se=T+-40|0,ze=x+8|0,ze=(ze&7|0)==0?0:0-ze&7,Ue=x+ze|0,ze=Se-ze|0,c[6983]=Ue,c[6980]=ze,c[Ue+4>>2]=ze|1,c[x+Se+4>>2]=40,c[6984]=c[7099];while(!1);if(f=c[6980]|0,f>>>0>te>>>0)return ze=f-te|0,c[6980]=ze,Se=c[6983]|0,Ue=Se+te|0,c[6983]=Ue,c[Ue+4>>2]=ze|1,c[Se+4>>2]=te|3,Se=Se+8|0,Q=vt,Se|0}return Se=pF()|0,c[Se>>2]=12,Se=0,Q=vt,Se|0}function hn(h){h=h|0;var f=0,d=0,m=0,_=0,x=0,T=0,M=0,N=0;if(h){d=h+-8|0,_=c[6981]|0,h=c[h+-4>>2]|0,f=h&-8,N=d+f|0;do if(h&1)M=d,T=d;else{if(m=c[d>>2]|0,!(h&3)||(T=d+(0-m)|0,x=m+f|0,T>>>0<_>>>0))return;if((c[6982]|0)==(T|0)){if(h=N+4|0,f=c[h>>2]|0,(f&3|0)!=3){M=T,f=x;break}c[6979]=x,c[h>>2]=f&-2,c[T+4>>2]=x|1,c[T+x>>2]=x;return}if(d=m>>>3,m>>>0<256)if(h=c[T+8>>2]|0,f=c[T+12>>2]|0,(f|0)==(h|0)){c[6977]=c[6977]&~(1<<d),M=T,f=x;break}else{c[h+12>>2]=f,c[f+8>>2]=h,M=T,f=x;break}_=c[T+24>>2]|0,h=c[T+12>>2]|0;do if((h|0)==(T|0)){if(f=T+16|0,d=f+4|0,h=c[d>>2]|0,h)f=d;else if(h=c[f>>2]|0,!h){h=0;break}for(;;)if(m=h+20|0,d=c[m>>2]|0,d)h=d,f=m;else if(m=h+16|0,d=c[m>>2]|0,d)h=d,f=m;else break;c[f>>2]=0}else M=c[T+8>>2]|0,c[M+12>>2]=h,c[h+8>>2]=M;while(!1);if(_){if(f=c[T+28>>2]|0,d=28212+(f<<2)|0,(c[d>>2]|0)==(T|0)){if(c[d>>2]=h,!h){c[6978]=c[6978]&~(1<<f),M=T,f=x;break}}else if(M=_+16|0,c[((c[M>>2]|0)==(T|0)?M:_+20|0)>>2]=h,!h){M=T,f=x;break}c[h+24>>2]=_,f=T+16|0,d=c[f>>2]|0,d|0&&(c[h+16>>2]=d,c[d+24>>2]=h),f=c[f+4>>2]|0,f?(c[h+20>>2]=f,c[f+24>>2]=h,M=T,f=x):(M=T,f=x)}else M=T,f=x}while(!1);if(!(T>>>0>=N>>>0)&&(h=N+4|0,m=c[h>>2]|0,!!(m&1))){if(m&2)c[h>>2]=m&-2,c[M+4>>2]=f|1,c[T+f>>2]=f,_=f;else{if((c[6983]|0)==(N|0)){if(N=(c[6980]|0)+f|0,c[6980]=N,c[6983]=M,c[M+4>>2]=N|1,(M|0)!=(c[6982]|0))return;c[6982]=0,c[6979]=0;return}if((c[6982]|0)==(N|0)){N=(c[6979]|0)+f|0,c[6979]=N,c[6982]=T,c[M+4>>2]=N|1,c[T+N>>2]=N;return}_=(m&-8)+f|0,d=m>>>3;do if(m>>>0<256)if(f=c[N+8>>2]|0,h=c[N+12>>2]|0,(h|0)==(f|0)){c[6977]=c[6977]&~(1<<d);break}else{c[f+12>>2]=h,c[h+8>>2]=f;break}else{x=c[N+24>>2]|0,h=c[N+12>>2]|0;do if((h|0)==(N|0)){if(f=N+16|0,d=f+4|0,h=c[d>>2]|0,h)f=d;else if(h=c[f>>2]|0,!h){d=0;break}for(;;)if(m=h+20|0,d=c[m>>2]|0,d)h=d,f=m;else if(m=h+16|0,d=c[m>>2]|0,d)h=d,f=m;else break;c[f>>2]=0,d=h}else d=c[N+8>>2]|0,c[d+12>>2]=h,c[h+8>>2]=d,d=h;while(!1);if(x|0){if(h=c[N+28>>2]|0,f=28212+(h<<2)|0,(c[f>>2]|0)==(N|0)){if(c[f>>2]=d,!d){c[6978]=c[6978]&~(1<<h);break}}else if(m=x+16|0,c[((c[m>>2]|0)==(N|0)?m:x+20|0)>>2]=d,!d)break;c[d+24>>2]=x,h=N+16|0,f=c[h>>2]|0,f|0&&(c[d+16>>2]=f,c[f+24>>2]=d),h=c[h+4>>2]|0,h|0&&(c[d+20>>2]=h,c[h+24>>2]=d)}}while(!1);if(c[M+4>>2]=_|1,c[T+_>>2]=_,(M|0)==(c[6982]|0)){c[6979]=_;return}}if(h=_>>>3,_>>>0<256){d=27948+(h<<1<<2)|0,f=c[6977]|0,h=1<<h,f&h?(f=d+8|0,h=c[f>>2]|0):(c[6977]=f|h,h=d,f=d+8|0),c[f>>2]=M,c[h+12>>2]=M,c[M+8>>2]=h,c[M+12>>2]=d;return}h=_>>>8,h?_>>>0>16777215?m=31:(T=(h+1048320|0)>>>16&8,N=h<<T,x=(N+520192|0)>>>16&4,N=N<<x,m=(N+245760|0)>>>16&2,m=14-(x|T|m)+(N<<m>>>15)|0,m=_>>>(m+7|0)&1|m<<1):m=0,h=28212+(m<<2)|0,c[M+28>>2]=m,c[M+20>>2]=0,c[M+16>>2]=0,f=c[6978]|0,d=1<<m;e:do if(!(f&d))c[6978]=f|d,c[h>>2]=M,c[M+24>>2]=h,c[M+12>>2]=M,c[M+8>>2]=M;else{h=c[h>>2]|0;t:do if((c[h+4>>2]&-8|0)!=(_|0)){for(m=_<<((m|0)==31?0:25-(m>>>1)|0);d=h+16+(m>>>31<<2)|0,f=c[d>>2]|0,!!f;)if((c[f+4>>2]&-8|0)==(_|0)){h=f;break t}else m=m<<1,h=f;c[d>>2]=M,c[M+24>>2]=h,c[M+12>>2]=M,c[M+8>>2]=M;break e}while(!1);T=h+8|0,N=c[T>>2]|0,c[N+12>>2]=M,c[T>>2]=M,c[M+8>>2]=N,c[M+12>>2]=h,c[M+24>>2]=0}while(!1);if(N=(c[6985]|0)+-1|0,c[6985]=N,!(N|0)){for(h=28364;h=c[h>>2]|0,h;)h=h+8|0;c[6985]=-1}}}}function Go(h,f){h=h|0,f=f|0;var d=0;return h?(d=Ge(f,h)|0,(f|h)>>>0>65535&&(d=((d>>>0)/(h>>>0)|0|0)==(f|0)?d:-1)):d=0,h=ka(d)|0,!h||!(c[h+-4>>2]&3)||mc(h|0,0,d|0)|0,h|0}function rn(h,f,d,m){return h=h|0,f=f|0,d=d|0,m=m|0,d=h+d>>>0,lt(f+m+(d>>>0<h>>>0|0)>>>0|0),d|0|0}function Yr(h,f,d,m){return h=h|0,f=f|0,d=d|0,m=m|0,m=f-m-(d>>>0>h>>>0|0)>>>0,lt(m|0),h-d>>>0|0|0}function S8(h){return h=h|0,(h?31-(Nt(h^h-1)|0)|0:32)|0}function Z_(h,f,d,m,_){h=h|0,f=f|0,d=d|0,m=m|0,_=_|0;var x=0,T=0,M=0,N=0,I=0,k=0,te=0,he=0,ue=0,ce=0;if(k=h,N=f,I=N,T=d,he=m,M=he,!I)return x=(_|0)!=0,M?x?(c[_>>2]=h|0,c[_+4>>2]=f&0,he=0,_=0,lt(he|0),_|0):(he=0,_=0,lt(he|0),_|0):(x&&(c[_>>2]=(k>>>0)%(T>>>0),c[_+4>>2]=0),he=0,_=(k>>>0)/(T>>>0)>>>0,lt(he|0),_|0);x=(M|0)==0;do if(T){if(!x){if(x=(Nt(M|0)|0)-(Nt(I|0)|0)|0,x>>>0<=31){te=x+1|0,M=31-x|0,f=x-31>>31,T=te,h=k>>>(te>>>0)&f|I<<M,f=I>>>(te>>>0)&f,x=0,M=k<<M;break}return _?(c[_>>2]=h|0,c[_+4>>2]=N|f&0,he=0,_=0,lt(he|0),_|0):(he=0,_=0,lt(he|0),_|0)}if(x=T-1|0,x&T|0){M=(Nt(T|0)|0)+33-(Nt(I|0)|0)|0,ce=64-M|0,te=32-M|0,N=te>>31,ue=M-32|0,f=ue>>31,T=M,h=te-1>>31&I>>>(ue>>>0)|(I<<te|k>>>(M>>>0))&f,f=f&I>>>(M>>>0),x=k<<ce&N,M=(I<<ce|k>>>(ue>>>0))&N|k<<te&M-33>>31;break}return _|0&&(c[_>>2]=x&k,c[_+4>>2]=0),(T|0)==1?(ue=N|f&0,ce=h|0|0,lt(ue|0),ce|0):(ce=S8(T|0)|0,ue=I>>>(ce>>>0)|0,ce=I<<32-ce|k>>>(ce>>>0)|0,lt(ue|0),ce|0)}else{if(x)return _|0&&(c[_>>2]=(I>>>0)%(T>>>0),c[_+4>>2]=0),ue=0,ce=(I>>>0)/(T>>>0)>>>0,lt(ue|0),ce|0;if(!k)return _|0&&(c[_>>2]=0,c[_+4>>2]=(I>>>0)%(M>>>0)),ue=0,ce=(I>>>0)/(M>>>0)>>>0,lt(ue|0),ce|0;if(x=M-1|0,!(x&M))return _|0&&(c[_>>2]=h|0,c[_+4>>2]=x&I|f&0),ue=0,ce=I>>>((S8(M|0)|0)>>>0),lt(ue|0),ce|0;if(x=(Nt(M|0)|0)-(Nt(I|0)|0)|0,x>>>0<=30){f=x+1|0,M=31-x|0,T=f,h=I<<M|k>>>(f>>>0),f=I>>>(f>>>0),x=0,M=k<<M;break}return _?(c[_>>2]=h|0,c[_+4>>2]=N|f&0,ue=0,ce=0,lt(ue|0),ce|0):(ue=0,ce=0,lt(ue|0),ce|0)}while(!1);if(!T)I=M,N=0,M=0;else{te=d|0|0,k=he|m&0,I=rn(te|0,k|0,-1,-1)|0,d=Y()|0,N=M,M=0;do m=N,N=x>>>31|N<<1,x=M|x<<1,m=h<<1|m>>>31|0,he=h>>>31|f<<1|0,Yr(I|0,d|0,m|0,he|0)|0,ce=Y()|0,ue=ce>>31|((ce|0)<0?-1:0)<<1,M=ue&1,h=Yr(m|0,he|0,ue&te|0,(((ce|0)<0?-1:0)>>31|((ce|0)<0?-1:0)<<1)&k|0)|0,f=Y()|0,T=T-1|0;while((T|0)!=0);I=N,N=0}return T=0,_|0&&(c[_>>2]=h,c[_+4>>2]=f),ue=(x|0)>>>31|(I|T)<<1|(T<<1|x>>>31)&0|N,ce=(x<<1|0)&-2|M,lt(ue|0),ce|0}function gu(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0;return I=f>>31|((f|0)<0?-1:0)<<1,N=((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1,x=m>>31|((m|0)<0?-1:0)<<1,_=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,M=Yr(I^h|0,N^f|0,I|0,N|0)|0,T=Y()|0,h=x^I,f=_^N,Yr((Z_(M,T,Yr(x^d|0,_^m|0,x|0,_|0)|0,Y()|0,0)|0)^h|0,(Y()|0)^f|0,h|0,f|0)|0}function mF(h,f){h=h|0,f=f|0;var d=0,m=0,_=0,x=0;return x=h&65535,_=f&65535,d=Ge(_,x)|0,m=h>>>16,h=(d>>>16)+(Ge(_,m)|0)|0,_=f>>>16,f=Ge(_,x)|0,lt((h>>>16)+(Ge(_,m)|0)+(((h&65535)+f|0)>>>16)|0),h+f<<16|d&65535|0|0}function us(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0;return _=h,x=d,d=mF(_,x)|0,h=Y()|0,lt((Ge(f,x)|0)+(Ge(m,_)|0)+h|h&0|0),d|0|0|0}function Fh(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0,T=0,M=0,N=0,I=0;return _=Q,Q=Q+16|0,M=_|0,T=f>>31|((f|0)<0?-1:0)<<1,x=((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1,I=m>>31|((m|0)<0?-1:0)<<1,N=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,h=Yr(T^h|0,x^f|0,T|0,x|0)|0,f=Y()|0,Z_(h,f,Yr(I^d|0,N^m|0,I|0,N|0)|0,Y()|0,M)|0,m=Yr(c[M>>2]^T|0,c[M+4>>2]^x|0,T|0,x|0)|0,d=Y()|0,Q=_,lt(d|0),m|0}function Uh(h,f,d,m){h=h|0,f=f|0,d=d|0,m=m|0;var _=0,x=0;return x=Q,Q=Q+16|0,_=x|0,Z_(h,f,d,m,_)|0,Q=x,lt(c[_+4>>2]|0),c[_>>2]|0|0}function w8(h,f,d){return h=h|0,f=f|0,d=d|0,(d|0)<32?(lt(f>>d|0),h>>>d|(f&(1<<d)-1)<<32-d):(lt(((f|0)<0?-1:0)|0),f>>d-32|0)}function ct(h,f,d){return h=h|0,f=f|0,d=d|0,(d|0)<32?(lt(f>>>d|0),h>>>d|(f&(1<<d)-1)<<32-d):(lt(0),f>>>d-32|0)}function St(h,f,d){return h=h|0,f=f|0,d=d|0,(d|0)<32?(lt(f<<d|(h&(1<<d)-1<<32-d)>>>32-d|0),h<<d):(lt(h<<d-32|0),0)}function M8(h,f,d){return h=h|0,f=f|0,f=Nt(f)|0,(f|0)==32&&(f=f+(Nt(h)|0)|0),lt(0),f|0}function E8(h,f){return h=+h,f=+f,h!=h?+f:f!=f?+h:+Tt(+h,+f)}function Zp(h,f){return h=+h,f=+f,h!=h?+f:f!=f?+h:+Fe(+h,+f)}function Kp(h){return h=+h,h>=0?+Kn(h+.5):+Ve(h-.5)}function Oh(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0;if((d|0)>=8192)return Bn(h|0,f|0,d|0)|0,h|0;if(x=h|0,_=h+d|0,(h&3)==(f&3)){for(;h&3;){if(!d)return x|0;et[h>>0]=et[f>>0]|0,h=h+1|0,f=f+1|0,d=d-1|0}for(d=_&-4|0,m=d-64|0;(h|0)<=(m|0);)c[h>>2]=c[f>>2],c[h+4>>2]=c[f+4>>2],c[h+8>>2]=c[f+8>>2],c[h+12>>2]=c[f+12>>2],c[h+16>>2]=c[f+16>>2],c[h+20>>2]=c[f+20>>2],c[h+24>>2]=c[f+24>>2],c[h+28>>2]=c[f+28>>2],c[h+32>>2]=c[f+32>>2],c[h+36>>2]=c[f+36>>2],c[h+40>>2]=c[f+40>>2],c[h+44>>2]=c[f+44>>2],c[h+48>>2]=c[f+48>>2],c[h+52>>2]=c[f+52>>2],c[h+56>>2]=c[f+56>>2],c[h+60>>2]=c[f+60>>2],h=h+64|0,f=f+64|0;for(;(h|0)<(d|0);)c[h>>2]=c[f>>2],h=h+4|0,f=f+4|0}else for(d=_-4|0;(h|0)<(d|0);)et[h>>0]=et[f>>0]|0,et[h+1>>0]=et[f+1>>0]|0,et[h+2>>0]=et[f+2>>0]|0,et[h+3>>0]=et[f+3>>0]|0,h=h+4|0,f=f+4|0;for(;(h|0)<(_|0);)et[h>>0]=et[f>>0]|0,h=h+1|0,f=f+1|0;return x|0}function mc(h,f,d){h=h|0,f=f|0,d=d|0;var m=0,_=0,x=0,T=0;if(x=h+d|0,f=f&255,(d|0)>=67){for(;h&3;)et[h>>0]=f,h=h+1|0;for(m=x&-4|0,T=f|f<<8|f<<16|f<<24,_=m-64|0;(h|0)<=(_|0);)c[h>>2]=T,c[h+4>>2]=T,c[h+8>>2]=T,c[h+12>>2]=T,c[h+16>>2]=T,c[h+20>>2]=T,c[h+24>>2]=T,c[h+28>>2]=T,c[h+32>>2]=T,c[h+36>>2]=T,c[h+40>>2]=T,c[h+44>>2]=T,c[h+48>>2]=T,c[h+52>>2]=T,c[h+56>>2]=T,c[h+60>>2]=T,h=h+64|0;for(;(h|0)<(m|0);)c[h>>2]=T,h=h+4|0}for(;(h|0)<(x|0);)et[h>>0]=f,h=h+1|0;return x-d|0}function C8(h){return h=+h,h>=0?+Kn(h+.5):+Ve(h-.5)}function _u(h){h=h|0;var f=0,d=0,m=0;return m=Qt()|0,d=c[Nn>>2]|0,f=d+h|0,(h|0)>0&(f|0)<(d|0)|(f|0)<0?(Li(f|0)|0,ln(12),-1):(f|0)>(m|0)&&!(zn(f|0)|0)?(ln(12),-1):(c[Nn>>2]=f,d|0)}return{___divdi3:gu,___muldi3:us,___remdi3:Fh,___uremdi3:Uh,_areNeighborCells:sB,_bitshift64Ashr:w8,_bitshift64Lshr:ct,_bitshift64Shl:St,_calloc:Go,_cellAreaKm2:FB,_cellAreaM2:UB,_cellAreaRads2:j_,_cellToBoundary:Ih,_cellToCenterChild:o8,_cellToChildPos:EB,_cellToChildren:_B,_cellToChildrenSize:QA,_cellToLatLng:pc,_cellToLocalIj:HB,_cellToParent:O_,_cellToVertex:qo,_cellToVertexes:uF,_cellsToDirectedEdge:oB,_cellsToLinkedMultiPolygon:M_,_childPosToCell:CB,_compactCells:vB,_destroyLinkedMultiPolygon:h8,_directedEdgeToBoundary:Xp,_directedEdgeToCells:cB,_edgeLengthKm:kB,_edgeLengthM:VB,_edgeLengthRads:OB,_emscripten_replace_memory:qn,_free:hn,_getBaseCellNumber:r8,_getDirectedEdgeDestination:lB,_getDirectedEdgeOrigin:aB,_getHexagonAreaAvgKm2:u8,_getHexagonAreaAvgM2:DB,_getHexagonEdgeLengthAvgKm:IB,_getHexagonEdgeLengthAvgM:BB,_getIcosahedronFaces:a8,_getNumCells:$_,_getPentagons:G_,_getRes0Cells:WI,_getResolution:gB,_greatCircleDistanceKm:ZA,_greatCircleDistanceM:NB,_greatCircleDistanceRads:RB,_gridDisk:Ar,_gridDiskDistances:$s,_gridDistance:$B,_gridPathCells:XB,_gridPathCellsSize:jB,_gridRingUnsafe:Ur,_i64Add:rn,_i64Subtract:Yr,_isPentagon:yi,_isResClassIII:bB,_isValidCell:F_,_isValidDirectedEdge:uB,_isValidVertex:hF,_latLngToCell:z_,_llvm_ctlz_i64:M8,_llvm_maxnum_f64:E8,_llvm_minnum_f64:Zp,_llvm_round_f64:Kp,_localIjToCell:WB,_malloc:ka,_maxFaceCount:wB,_maxGridDiskSize:Ws,_maxPolygonToCellsSize:cc,_maxPolygonToCellsSizeExperimental:ZB,_memcpy:Oh,_memset:mc,_originToDirectedEdges:hB,_pentagonCount:MB,_polygonToCells:S_,_polygonToCellsExperimental:YB,_readInt64AsDoubleFromPointer:sF,_res0CellCount:HI,_round:C8,_sbrk:_u,_sizeOfCellBoundary:eF,_sizeOfCoordIJ:rF,_sizeOfGeoLoop:tF,_sizeOfGeoPolygon:nF,_sizeOfH3Index:KB,_sizeOfLatLng:JB,_sizeOfLinkedGeoPolygon:iF,_uncompactCells:yB,_uncompactCellsSize:xB,_vertexToLatLng:cF,establishStackSpace:Qr,stackAlloc:Yt,stackRestore:jn,stackSave:Di}}(Lt,$t,V);e.___divdi3=ie.___divdi3,e.___muldi3=ie.___muldi3,e.___remdi3=ie.___remdi3,e.___uremdi3=ie.___uremdi3,e._areNeighborCells=ie._areNeighborCells,e._bitshift64Ashr=ie._bitshift64Ashr,e._bitshift64Lshr=ie._bitshift64Lshr,e._bitshift64Shl=ie._bitshift64Shl,e._calloc=ie._calloc,e._cellAreaKm2=ie._cellAreaKm2,e._cellAreaM2=ie._cellAreaM2,e._cellAreaRads2=ie._cellAreaRads2,e._cellToBoundary=ie._cellToBoundary,e._cellToCenterChild=ie._cellToCenterChild,e._cellToChildPos=ie._cellToChildPos,e._cellToChildren=ie._cellToChildren,e._cellToChildrenSize=ie._cellToChildrenSize,e._cellToLatLng=ie._cellToLatLng,e._cellToLocalIj=ie._cellToLocalIj,e._cellToParent=ie._cellToParent,e._cellToVertex=ie._cellToVertex,e._cellToVertexes=ie._cellToVertexes,e._cellsToDirectedEdge=ie._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=ie._cellsToLinkedMultiPolygon,e._childPosToCell=ie._childPosToCell,e._compactCells=ie._compactCells,e._destroyLinkedMultiPolygon=ie._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=ie._directedEdgeToBoundary,e._directedEdgeToCells=ie._directedEdgeToCells,e._edgeLengthKm=ie._edgeLengthKm,e._edgeLengthM=ie._edgeLengthM,e._edgeLengthRads=ie._edgeLengthRads;var Mt=e._emscripten_replace_memory=ie._emscripten_replace_memory;e._free=ie._free,e._getBaseCellNumber=ie._getBaseCellNumber,e._getDirectedEdgeDestination=ie._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=ie._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=ie._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=ie._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=ie._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=ie._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=ie._getIcosahedronFaces,e._getNumCells=ie._getNumCells,e._getPentagons=ie._getPentagons,e._getRes0Cells=ie._getRes0Cells,e._getResolution=ie._getResolution,e._greatCircleDistanceKm=ie._greatCircleDistanceKm,e._greatCircleDistanceM=ie._greatCircleDistanceM,e._greatCircleDistanceRads=ie._greatCircleDistanceRads,e._gridDisk=ie._gridDisk,e._gridDiskDistances=ie._gridDiskDistances,e._gridDistance=ie._gridDistance,e._gridPathCells=ie._gridPathCells,e._gridPathCellsSize=ie._gridPathCellsSize,e._gridRingUnsafe=ie._gridRingUnsafe,e._i64Add=ie._i64Add,e._i64Subtract=ie._i64Subtract,e._isPentagon=ie._isPentagon,e._isResClassIII=ie._isResClassIII,e._isValidCell=ie._isValidCell,e._isValidDirectedEdge=ie._isValidDirectedEdge,e._isValidVertex=ie._isValidVertex,e._latLngToCell=ie._latLngToCell,e._llvm_ctlz_i64=ie._llvm_ctlz_i64,e._llvm_maxnum_f64=ie._llvm_maxnum_f64,e._llvm_minnum_f64=ie._llvm_minnum_f64,e._llvm_round_f64=ie._llvm_round_f64,e._localIjToCell=ie._localIjToCell,e._malloc=ie._malloc,e._maxFaceCount=ie._maxFaceCount,e._maxGridDiskSize=ie._maxGridDiskSize,e._maxPolygonToCellsSize=ie._maxPolygonToCellsSize,e._maxPolygonToCellsSizeExperimental=ie._maxPolygonToCellsSizeExperimental,e._memcpy=ie._memcpy,e._memset=ie._memset,e._originToDirectedEdges=ie._originToDirectedEdges,e._pentagonCount=ie._pentagonCount,e._polygonToCells=ie._polygonToCells,e._polygonToCellsExperimental=ie._polygonToCellsExperimental,e._readInt64AsDoubleFromPointer=ie._readInt64AsDoubleFromPointer,e._res0CellCount=ie._res0CellCount,e._round=ie._round,e._sbrk=ie._sbrk,e._sizeOfCellBoundary=ie._sizeOfCellBoundary,e._sizeOfCoordIJ=ie._sizeOfCoordIJ,e._sizeOfGeoLoop=ie._sizeOfGeoLoop,e._sizeOfGeoPolygon=ie._sizeOfGeoPolygon,e._sizeOfH3Index=ie._sizeOfH3Index,e._sizeOfLatLng=ie._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=ie._sizeOfLinkedGeoPolygon,e._uncompactCells=ie._uncompactCells,e._uncompactCellsSize=ie._uncompactCellsSize,e._vertexToLatLng=ie._vertexToLatLng,e.establishStackSpace=ie.establishStackSpace;var je=e.stackAlloc=ie.stackAlloc,q=e.stackRestore=ie.stackRestore,Pt=e.stackSave=ie.stackSave;if(e.asm=ie,e.cwrap=E,e.setValue=v,e.getValue=y,$){fe($)||($=s($));{qe();var wt=function(ke){ke.byteLength&&(ke=new Uint8Array(ke)),j.set(ke,g),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Me()},sn=function(){o($,wt,function(){throw"could not load memory initializer "+$})},$n=kt($);if($n)wt($n.buffer);else if(e.memoryInitializerRequest){var Rn=function(){var ke=e.memoryInitializerRequest,it=ke.response;if(ke.status!==200&&ke.status!==0){var pt=kt(e.memoryInitializerRequestURL);if(pt)it=pt.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+ke.status+", retrying "+$),sn();return}}wt(it)};e.memoryInitializerRequest.response?setTimeout(Rn,0):e.memoryInitializerRequest.addEventListener("load",Rn)}else sn()}}var tn;ve=function ke(){tn||vi(),tn||(ve=ke)};function vi(ke){if(me>0||($e(),me>0))return;function it(){tn||(tn=!0,!b&&(Ke(),Xe(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),st()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),it()},1)):it()}e.run=vi;function Wn(ke){throw e.onAbort&&e.onAbort(ke),ke+="",a(ke),l(ke),b=!0,"abort("+ke+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Wn,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return vi(),n}(typeof Xn=="object"?Xn:{}),yn="number",An=yn,_0=yn,_n=yn,vn=yn,kr=yn,zt=yn,Xte=[["sizeOfH3Index",yn],["sizeOfLatLng",yn],["sizeOfCellBoundary",yn],["sizeOfGeoLoop",yn],["sizeOfGeoPolygon",yn],["sizeOfLinkedGeoPolygon",yn],["sizeOfCoordIJ",yn],["readInt64AsDoubleFromPointer",yn],["isValidCell",_0,[_n,vn]],["latLngToCell",An,[yn,yn,kr,zt]],["cellToLatLng",An,[_n,vn,zt]],["cellToBoundary",An,[_n,vn,zt]],["maxGridDiskSize",An,[yn,zt]],["gridDisk",An,[_n,vn,yn,zt]],["gridDiskDistances",An,[_n,vn,yn,zt,zt]],["gridRingUnsafe",An,[_n,vn,yn,zt]],["maxPolygonToCellsSize",An,[zt,kr,yn,zt]],["polygonToCells",An,[zt,kr,yn,zt]],["maxPolygonToCellsSizeExperimental",An,[zt,kr,yn,zt]],["polygonToCellsExperimental",An,[zt,kr,yn,yn,yn,zt]],["cellsToLinkedMultiPolygon",An,[zt,yn,zt]],["destroyLinkedMultiPolygon",null,[zt]],["compactCells",An,[zt,zt,yn,yn]],["uncompactCells",An,[zt,yn,yn,zt,yn,kr]],["uncompactCellsSize",An,[zt,yn,yn,kr,zt]],["isPentagon",_0,[_n,vn]],["isResClassIII",_0,[_n,vn]],["getBaseCellNumber",yn,[_n,vn]],["getResolution",yn,[_n,vn]],["maxFaceCount",An,[_n,vn,zt]],["getIcosahedronFaces",An,[_n,vn,zt]],["cellToParent",An,[_n,vn,kr,zt]],["cellToChildren",An,[_n,vn,kr,zt]],["cellToCenterChild",An,[_n,vn,kr,zt]],["cellToChildrenSize",An,[_n,vn,kr,zt]],["cellToChildPos",An,[_n,vn,kr,zt]],["childPosToCell",An,[yn,yn,_n,vn,kr,zt]],["areNeighborCells",An,[_n,vn,_n,vn,zt]],["cellsToDirectedEdge",An,[_n,vn,_n,vn,zt]],["getDirectedEdgeOrigin",An,[_n,vn,zt]],["getDirectedEdgeDestination",An,[_n,vn,zt]],["isValidDirectedEdge",_0,[_n,vn]],["directedEdgeToCells",An,[_n,vn,zt]],["originToDirectedEdges",An,[_n,vn,zt]],["directedEdgeToBoundary",An,[_n,vn,zt]],["gridDistance",An,[_n,vn,_n,vn,zt]],["gridPathCells",An,[_n,vn,_n,vn,zt]],["gridPathCellsSize",An,[_n,vn,_n,vn,zt]],["cellToLocalIj",An,[_n,vn,_n,vn,yn,zt]],["localIjToCell",An,[_n,vn,zt,yn,zt]],["getHexagonAreaAvgM2",An,[kr,zt]],["getHexagonAreaAvgKm2",An,[kr,zt]],["getHexagonEdgeLengthAvgM",An,[kr,zt]],["getHexagonEdgeLengthAvgKm",An,[kr,zt]],["greatCircleDistanceM",yn,[zt,zt]],["greatCircleDistanceKm",yn,[zt,zt]],["greatCircleDistanceRads",yn,[zt,zt]],["cellAreaM2",An,[_n,vn,zt]],["cellAreaKm2",An,[_n,vn,zt]],["cellAreaRads2",An,[_n,vn,zt]],["edgeLengthM",An,[_n,vn,zt]],["edgeLengthKm",An,[_n,vn,zt]],["edgeLengthRads",An,[_n,vn,zt]],["getNumCells",An,[kr,zt]],["getRes0Cells",An,[zt]],["res0CellCount",yn],["getPentagons",An,[yn,zt]],["pentagonCount",yn],["cellToVertex",An,[_n,vn,yn,zt]],["cellToVertexes",An,[_n,vn,zt]],["vertexToLatLng",An,[_n,vn,zt]],["isValidVertex",_0,[_n,vn]]],Qte=0,Yte=1,Zte=2,Kte=3,lR=4,Jte=5,ene=6,tne=7,nne=8,ine=9,rne=10,sne=11,one=12,ane=13,lne=14,une=15,os={};os[Qte]="Success";os[Yte]="The operation failed but a more specific error is not available";os[Zte]="Argument was outside of acceptable range";os[Kte]="Latitude or longitude arguments were outside of acceptable range";os[lR]="Resolution argument was outside of acceptable range";os[Jte]="Cell argument was not valid";os[ene]="Directed edge argument was not valid";os[tne]="Undirected edge argument was not valid";os[nne]="Vertex argument was not valid";os[ine]="Pentagon distortion was encountered";os[rne]="Duplicate input";os[sne]="Cell arguments were not neighbors";os[one]="Cell arguments had incompatible resolutions";os[ane]="Memory allocation failed";os[lne]="Bounds of provided memory were insufficient";os[une]="Mode or flags argument was not valid";var cne=1e3,uR=1001,cR=1002,H2={};H2[cne]="Unknown unit";H2[uR]="Array length out of bounds";H2[cR]="Got unexpected null value for H3 index";var hne="Unknown error";function hR(n,e,t){var i=t&&"value"in t,r=new Error((n[e]||hne)+" (code: "+e+(i?", value: "+t.value:"")+")");return r.code=e,r}function fR(n,e){var t=arguments.length===2?{value:e}:{};return hR(os,n,t)}function AR(n,e){var t=arguments.length===2?{value:e}:{};return hR(H2,n,t)}function Jd(n){if(n!==0)throw fR(n)}var uo={};Xte.forEach(function(e){uo[e[0]]=Xn.cwrap.apply(Xn,e)});var Df=16,ep=4,NA=8,fne=8,Jg=uo.sizeOfH3Index(),vb=uo.sizeOfLatLng(),Ane=uo.sizeOfCellBoundary(),dne=uo.sizeOfGeoPolygon(),ad=uo.sizeOfGeoLoop();uo.sizeOfLinkedGeoPolygon();uo.sizeOfCoordIJ();function pne(n){if(typeof n!="number"||n<0||n>15||Math.floor(n)!==n)throw fR(lR,n);return n}function mne(n){if(!n)throw AR(cR);return n}var gne=Math.pow(2,32)-1;function _ne(n){if(n>gne)throw AR(uR,n);return n}var vne=/[^0-9a-fA-F]/;function dR(n){if(Array.isArray(n)&&n.length===2&&Number.isInteger(n[0])&&Number.isInteger(n[1]))return n;if(typeof n!="string"||vne.test(n))return[0,0];var e=parseInt(n.substring(0,n.length-8),Df),t=parseInt(n.substring(n.length-8),Df);return[t,e]}function ew(n){if(n>=0)return n.toString(Df);n=n&2147483647;var e=pR(8,n.toString(Df)),t=(parseInt(e[0],Df)+8).toString(Df);return e=t+e.substring(1),e}function yne(n,e){return ew(e)+pR(8,ew(n))}function pR(n,e){for(var t=n-e.length,i="",r=0;r<t;r++)i+="0";return i=i+e,i}function tw(n,e,t){for(var i=n.length,r=Xn._calloc(i,vb),s=t?1:0,o=t?0:1,a=0;a<i*2;a+=2)Xn.HEAPF64.set([n[a/2][s],n[a/2][o]].map(vR),r/NA+a);return Xn.HEAPU32.set([i,r],e/ep),e}function xne(n,e){var t=n.length-1,i=Xn._calloc(dne),r=0,s=r+ad,o=s+ep;tw(n[0],i+r,e);var a;if(t>0){a=Xn._calloc(t,ad);for(var l=0;l<t;l++)tw(n[l+1],a+ad*l,e)}return Xn.setValue(i+s,t,"i32"),Xn.setValue(i+o,a,"i32"),i}function bne(n){var e=0,t=e+ad,i=t+ep,r=ep;Xn._free(Xn.getValue(n+e+r,"i8*"));var s=Xn.getValue(n+t,"i32");if(s>0){for(var o=Xn.getValue(n+i,"i32"),a=0;a<s;a++)Xn._free(Xn.getValue(o+ad*a+r,"i8*"));Xn._free(o)}Xn._free(n)}function mR(n,e){e===void 0&&(e=0);var t=Xn.getValue(n+Jg*e,"i32"),i=Xn.getValue(n+Jg*e+ep,"i32");return i?yne(t,i):null}function Tne(n){return uo.readInt64AsDoubleFromPointer(n)}function Sne(n,e){for(var t=[],i=0;i<e;i++){var r=mR(n,i);r!==null&&t.push(r)}return t}function e2(n){return Rne(Xn.getValue(n,"double"))}function wne(n){return[e2(n),e2(n+NA)]}function Mne(n){return[e2(n+NA),e2(n)]}function Ene(n,e,t){for(var i=Xn.getValue(n,"i32"),r=n+NA,s=[],o=Mne,a=0;a<i*2;a+=2)s.push(o(r+NA*a));return s.push(s[0]),s}function Cne(n,e,t){var i=Xn._malloc(vb);Xn.HEAPF64.set([n,e].map(vR),i/NA);var r=Xn._malloc(Jg);try{return Jd(uo.latLngToCell(i,t,r)),mne(mR(r))}finally{Xn._free(r),Xn._free(i)}}function gR(n){var e=Xn._malloc(vb),t=dR(n),i=t[0],r=t[1];try{return Jd(uo.cellToLatLng(i,r,e)),wne(e)}finally{Xn._free(e)}}function _R(n,e){var t=Xn._malloc(Ane),i=dR(n),r=i[0],s=i[1];try{return Jd(uo.cellToBoundary(r,s,t)),Ene(t,e,e)}finally{Xn._free(t)}}function nw(n,e,t){if(pne(e),t=!!t,n.length===0||n[0].length===0)return[];var i=typeof n[0][0]=="number"?[n]:n,r=xne(i,t),s=Xn._malloc(fne);try{Jd(uo.maxPolygonToCellsSize(r,e,0,s));var o=_ne(Tne(s)),a=Xn._calloc(o,Jg);try{return Jd(uo.polygonToCells(r,e,0,a)),Sne(a,o)}finally{Xn._free(a)}}finally{Xn._free(s),bne(r)}}function vR(n){return n*Math.PI/180}function Rne(n){return n*180/Math.PI}function Nne(n){return n=Math.max(0,Math.min(1,n)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+n*(1172.33-n*(10793.56-n*(33300.12-n*(38394.49-n*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+n*(557.33+n*(1225.33-n*(3574.96-n*(1073.77+n*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+n*(3211.1-n*(15327.97-n*(27814-n*(22569.18-n*6838.66)))))))+")"}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Pne=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveMap","envMap","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class Lne{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=Pne,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const t=e.getMRT();return t!==null&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:i,material:r,object:s}=e;if(t={material:this.getMaterialData(r),geometry:{id:i.id,attributes:this.getAttributesData(i.attributes),indexVersion:i.index?i.index.version:null,drawRange:{start:i.drawRange.start,count:i.drawRange.count}},worldMatrix:s.matrixWorld.clone()},s.center&&(t.center=s.center.clone()),s.morphTargetInfluences&&(t.morphTargetInfluences=s.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:o,height:a}=e.context;t.bufferWidth=o,t.bufferHeight=a}this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const i in e){const r=e[i];t[i]={version:r.version}}return t}containsNode(e){const t=e.material;for(const i in t)if(t[i]&&t[i].isNode)return!0;return e.renderer.overrideNodes.modelViewMatrix!==null||e.renderer.overrideNodes.modelNormalViewMatrix!==null}getMaterialData(e){const t={};for(const i of this.refreshUniforms){const r=e[i];r!=null&&(typeof r=="object"&&r.clone!==void 0?r.isTexture===!0?t[i]={id:r.id,version:r.version}:t[i]=r.clone():t[i]=r)}return t}equals(e){const{object:t,material:i,geometry:r}=e,s=this.getRenderObjectData(e);if(s.worldMatrix.equals(t.matrixWorld)!==!0)return s.worldMatrix.copy(t.matrixWorld),!1;const o=s.material;for(const b in o){const w=o[b],S=i[b];if(w.equals!==void 0){if(w.equals(S)===!1)return w.copy(S),!1}else if(S.isTexture===!0){if(w.id!==S.id||w.version!==S.version)return w.id=S.id,w.version=S.version,!1}else if(w!==S)return o[b]=S,!1}if(o.transmission>0){const{width:b,height:w}=e.context;if(s.bufferWidth!==b||s.bufferHeight!==w)return s.bufferWidth=b,s.bufferHeight=w,!1}const a=s.geometry,l=r.attributes,u=a.attributes,A=Object.keys(u),p=Object.keys(l);if(a.id!==r.id)return a.id=r.id,!1;if(A.length!==p.length)return s.geometry.attributes=this.getAttributesData(l),!1;for(const b of A){const w=u[b],S=l[b];if(S===void 0)return delete u[b],!1;if(w.version!==S.version)return w.version=S.version,!1}const g=r.index,v=a.indexVersion,y=g?g.version:null;if(v!==y)return a.indexVersion=y,!1;if(a.drawRange.start!==r.drawRange.start||a.drawRange.count!==r.drawRange.count)return a.drawRange.start=r.drawRange.start,a.drawRange.count=r.drawRange.count,!1;if(s.morphTargetInfluences){let b=!1;for(let w=0;w<s.morphTargetInfluences.length;w++)s.morphTargetInfluences[w]!==t.morphTargetInfluences[w]&&(b=!0);if(b)return!0}return s.center&&s.center.equals(t.center)===!1?(s.center.copy(t.center),!0):(e.bundle!==null&&(s.version=e.bundle.version),!0)}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:i}=t;if(this.renderId!==i)return this.renderId=i,!0;const r=e.object.static===!0,s=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;return r||s?!1:this.equals(e)!==!0}}function tp(n,e=0){let t=3735928559^e,i=1103547991^e;if(n instanceof Array)for(let r=0,s;r<n.length;r++)s=n[r],t=Math.imul(t^s,2654435761),i=Math.imul(i^s,1597334677);else for(let r=0,s;r<n.length;r++)s=n.charCodeAt(r),t=Math.imul(t^s,2654435761),i=Math.imul(i^s,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507),i^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&i)+(t>>>0)}const yR=n=>tp(n),W2=n=>tp(n),np=(...n)=>tp(n);function xR(n,e=!1){const t=[];n.isNode===!0&&(t.push(n.id),n=n.getSelf());for(const{property:i,childNode:r}of t2(n))t.push(tp(i.slice(0,-4)),r.getCacheKey(e));return tp(t)}function*t2(n,e=!1){for(const t in n){if(t.startsWith("_")===!0)continue;const i=n[t];if(Array.isArray(i)===!0)for(let r=0;r<i.length;r++){const s=i[r];s&&(s.isNode===!0||e&&typeof s.toJSON=="function")&&(yield{property:t,index:r,childNode:s})}else if(i&&i.isNode===!0)yield{property:t,childNode:i};else if(typeof i=="object")for(const r in i){const s=i[r];s&&(s.isNode===!0||e&&typeof s.toJSON=="function")&&(yield{property:t,index:r,childNode:s})}}}const Dne=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),iw=new WeakMap;function bR(n){return Dne.get(n)}function n2(n){if(/[iu]?vec\d/.test(n))return n.startsWith("ivec")?Int32Array:n.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(n)||/float/.test(n))return Float32Array;if(/uint/.test(n))return Uint32Array;if(/int/.test(n))return Int32Array;throw new Error(`THREE.NodeUtils: Unsupported type: ${n}`)}function yb(n){if(/float|int|uint/.test(n))return 1;if(/vec2/.test(n))return 2;if(/vec3/.test(n))return 3;if(/vec4/.test(n)||/mat2/.test(n))return 4;if(/mat3/.test(n))return 9;if(/mat4/.test(n))return 16;console.error("THREE.TSL: Unsupported type:",n)}function Gu(n){if(n==null)return null;const e=typeof n;return n.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":n.isVector2===!0?"vec2":n.isVector3===!0?"vec3":n.isVector4===!0?"vec4":n.isMatrix2===!0?"mat2":n.isMatrix3===!0?"mat3":n.isMatrix4===!0?"mat4":n.isColor===!0?"color":n instanceof ArrayBuffer?"ArrayBuffer":null}function TR(n,...e){const t=n?n.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),n==="color"?new Gt(...e):t==="vec2"?new rt(...e):t==="vec3"?new re(...e):t==="vec4"?new Kt(...e):t==="mat2"?new V2(...e):t==="mat3"?new bn(...e):t==="mat4"?new on(...e):n==="bool"?e[0]||!1:n==="float"||n==="int"||n==="uint"?e[0]||0:n==="string"?e[0]||"":n==="ArrayBuffer"?MR(e[0]):null}function SR(n){let e=iw.get(n);return e===void 0&&(e={},iw.set(n,e)),e}function wR(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function MR(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0)).buffer}const bx={VERTEX:"vertex",FRAGMENT:"fragment"},Sn={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},Ine={BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},ys={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},ER=["fragment","vertex"],Tx=["setup","analyze","generate"],Sx=[...ER,"compute"],Mh=["x","y","z","w"];let Bne=0;class en extends xl{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=Sn.NONE,this.updateBeforeType=Sn.NONE,this.updateAfterType=Sn.NONE,this.uuid=xA.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:Bne++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,Sn.FRAME)}onRenderUpdate(e){return this.onUpdate(e,Sn.RENDER)}onObjectUpdate(e){return this.onUpdate(e,Sn.OBJECT)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of t2(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return e=e||this.version!==this._cacheKeyVersion,(e===!0||this._cacheKey===null)&&(this._cacheKey=np(xR(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);let i=0;for(const r of this.getChildren())t["node"+i++]=r;return t.outputNode||null}analyze(e){if(e.increaseUsage(this)===1){const i=e.getNodeProperties(this);for(const r of Object.values(i))r&&r.isNode===!0&&r.build(e)}}generate(e,t){const{outputNode:i}=e.getNodeProperties(this);if(i&&i.isNode===!0)return i.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const i=this.getShared(e);if(this!==i)return i.build(e,t);e.addNode(this),e.addChain(this);let r=null;const s=e.getBuildStage();if(s==="setup"){this.updateReference(e);const o=e.getNodeProperties(this);if(o.initialized!==!0){o.initialized=!0;const a=this.setup(e),l=a&&a.isNode===!0;for(const u of Object.values(o))if(u&&u.isNode===!0){if(u.parents===!0){const A=e.getNodeProperties(u);A.parents=A.parents||[],A.parents.push(this)}u.build(e)}l&&a.build(e),o.outputNode=a}r=o.outputNode||null}else if(s==="analyze")this.analyze(e);else if(s==="generate")if(this.generate.length===1){const a=this.getNodeType(e),l=e.getDataFromNode(this);r=l.snippet,r===void 0?l.generated===void 0?(l.generated=!0,r=this.generate(e)||"",l.snippet=r):(console.warn("THREE.Node: Recursion detected.",this),r=""):l.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),r=e.format(r,a,t)}else r=this.generate(e,t)||"";return e.removeChain(this),e.addSequentialNode(this),r}getSerializeChildren(){return t2(this)}serialize(e){const t=this.getSerializeChildren(),i={};for(const{property:r,index:s,childNode:o}of t)s!==void 0?(i[r]===void 0&&(i[r]=Number.isInteger(s)?[]:{}),i[r][s]=o.toJSON(e.meta).uuid):i[r]=o.toJSON(e.meta).uuid;Object.keys(i).length>0&&(e.inputNodes=i)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const i in e.inputNodes)if(Array.isArray(e.inputNodes[i])){const r=[];for(const s of e.inputNodes[i])r.push(t[s]);this[i]=r}else if(typeof e.inputNodes[i]=="object"){const r={};for(const s in e.inputNodes[i]){const o=e.inputNodes[i][s];r[s]=t[o]}this[i]=r}else{const r=e.inputNodes[i];this[i]=t[r]}}}toJSON(e){const{uuid:t,type:i}=this,r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{},nodes:{}});let s=e.nodes[t];s===void 0&&(s={uuid:t,type:i,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},r!==!0&&(e.nodes[s.uuid]=s),this.serialize(s),delete s.meta);function o(a){const l=[];for(const u in a){const A=a[u];delete A.metadata,l.push(A)}return l}if(r){const a=o(e.textures),l=o(e.images),u=o(e.nodes);a.length>0&&(s.textures=a),l.length>0&&(s.images=l),u.length>0&&(s.nodes=u)}return s}}class Eh extends en{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.indexNode.getNodeType(e),i=this.node.build(e),r=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return`${i}[ ${r} ]`}}class CR extends en{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let i=null;for(const r of this.convertTo.split("|"))(i===null||e.getTypeLength(t)===e.getTypeLength(r))&&(i=r);return i}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const i=this.node,r=this.getNodeType(e),s=i.build(e,r);return e.format(s,r,t)}}class fr extends en{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const r=e.getVectorType(this.getNodeType(e,t)),s=e.getDataFromNode(this);if(s.propertyName!==void 0)return e.format(s.propertyName,r,t);if(r!=="void"&&t!=="void"&&this.hasDependencies(e)){const o=super.build(e,r),a=e.getVarFromNode(this,null,r),l=e.getPropertyName(a);return e.addLineFlowCode(`${l} = ${o}`,this),s.snippet=o,s.propertyName=l,e.format(s.propertyName,r,t)}}return super.build(e,t)}}class Fne extends fr{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,i)=>t+e.getTypeLength(i.getNodeType(e)),0))}generate(e,t){const i=this.getNodeType(e),r=e.getTypeLength(i),s=this.nodes,o=e.getComponentType(i),a=[];let l=0;for(const A of s){if(l>=r){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${i}()' type.`);break}let p=A.getNodeType(e),g=e.getTypeLength(p),v;l+g>r&&(console.error(`THREE.TSL: Length of '${i}()' data exceeds maximum length of output type.`),g=r-l,p=e.getTypeFromLength(g)),l+=g,v=A.build(e,p);const y=e.getComponentType(p);y!==o&&(v=e.format(v,y,o)),a.push(v)}const u=`${e.getType(i)}( ${a.join(", ")} )`;return e.format(u,i,t)}}const Une=Mh.join("");class wx extends en{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(Mh.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const i=this.node,r=e.getTypeLength(i.getNodeType(e));let s=null;if(r>1){let o=null;this.getVectorLength()>=r&&(o=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const l=i.build(e,o);this.components.length===r&&this.components===Une.slice(0,this.components.length)?s=e.format(l,o,t):s=e.format(`${l}.${this.components}`,this.getNodeType(e),t)}else s=i.build(e,t);return s}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class One extends fr{static get type(){return"SetNode"}constructor(e,t,i){super(),this.sourceNode=e,this.components=t,this.targetNode=i}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:i,targetNode:r}=this,s=this.getNodeType(e),o=e.getComponentType(r.getNodeType(e)),a=e.getTypeFromLength(i.length,o),l=r.build(e,a),u=t.build(e,s),A=e.getTypeLength(s),p=[];for(let g=0;g<A;g++){const v=Mh[g];v===i[0]?(p.push(l),g+=i.length-1):p.push(u+"."+v)}return`${e.getType(s)}( ${p.join(", ")} )`}}class kne extends fr{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:i}=this,r=this.getNodeType(e),s=i.build(e),o=e.getVarFromNode(this),a=e.getPropertyName(o);e.addLineFlowCode(a+" = "+s,this);const l=e.getTypeLength(r),u=[];let A=0;for(let p=0;p<l;p++){const g=Mh[p];g===t[A]?(u.push("1.0 - "+(a+"."+g)),A++):u.push(a+"."+g)}return`${e.getType(r)}( ${u.join(", ")} )`}}class xb extends en{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?Gu(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Gu(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=wR(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?TR(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const rw=/float|u?int/;class Ua extends xb{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const i=this.getNodeType(e);return rw.test(i)&&rw.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),i,t)}}class Vne extends en{static get type(){return"MemberNode"}constructor(e,t){super(),this.node=e,this.property=t,this.isMemberNode=!0}getNodeType(e){return this.node.getMemberType(e,this.property)}generate(e){return this.node.build(e)+"."+this.property}}let xh=null;const If=new Map;function Ye(n,e){if(If.has(n)){console.warn(`THREE.TSL: Redefinition of method chaining '${n}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${n} is not a function`);If.set(n,e)}const RR=n=>n.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),sw=n=>RR(n).split("").sort().join(""),NR={setup(n,e){const t=e.shift();return n(Cp(t),...e)},get(n,e,t){if(typeof e=="string"&&n[e]===void 0){if(n.isStackNode!==!0&&e==="assign")return(...i)=>(xh.assign(t,...i),t);if(If.has(e)){const i=If.get(e);return n.isStackNode?(...r)=>t.add(i(...r)):(...r)=>i(t,...r)}else{if(e==="self")return n;if(e.endsWith("Assign")&&If.has(e.slice(0,e.length-6))){const i=If.get(e.slice(0,e.length-6));return n.isStackNode?(...r)=>t.assign(r[0],i(...r)):(...r)=>t.assign(i(t,...r))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=RR(e),tt(new wx(t,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=sw(e.slice(3).toLowerCase()),i=>tt(new One(n,e,i));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=sw(e.slice(4).toLowerCase()),()=>tt(new kne(tt(n),e));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),tt(new wx(n,e));if(/^\d+$/.test(e)===!0)return tt(new Eh(t,new Ua(Number(e),"uint")));if(/^get$/.test(e)===!0)return i=>tt(new Vne(t,i))}}}return Reflect.get(n,e,t)},set(n,e,t,i){return typeof e=="string"&&n[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(i[e].assign(t),!0):Reflect.set(n,e,t,i)}},iv=new WeakMap,ow=new WeakMap,zne=function(n,e=null){const t=Gu(n);if(t==="node"){let i=iv.get(n);return i===void 0&&(i=new Proxy(n,NR),iv.set(n,i),iv.set(i,i)),i}else{if(e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string")return tt(Mx(n,e));if(t==="shader")return Ie(n)}return n},qne=function(n,e=null){for(const t in n)n[t]=tt(n[t],e);return n},Gne=function(n,e=null){const t=n.length;for(let i=0;i<t;i++)n[i]=tt(n[i],e);return n},Hne=function(n,e=null,t=null,i=null){const r=A=>tt(i!==null?Object.assign(A,i):A);let s,o=e,a,l;function u(A){let p;return o?p=/[a-z]/i.test(o)?o+"()":o:p=n.type,a!==void 0&&A.length<a?(console.error(`THREE.TSL: "${p}" parameter length is less than minimum required.`),A.concat(new Array(a-A.length).fill(0))):l!==void 0&&A.length>l?(console.error(`THREE.TSL: "${p}" parameter length exceeds limit.`),A.slice(0,l)):A}return e===null?s=(...A)=>r(new n(...ih(u(A)))):t!==null?(t=tt(t),s=(...A)=>r(new n(e,...ih(u(A)),t))):s=(...A)=>r(new n(e,...ih(u(A)))),s.setParameterLength=(...A)=>(A.length===1?a=l=A[0]:A.length===2&&([a,l]=A),s),s.setName=A=>(o=A,s),s},Wne=function(n,...e){return tt(new n(...ih(e)))};class $ne extends en{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,inputNodes:i}=this,r=e.getNodeProperties(t);if(r.onceOutput)return r.onceOutput;let s=null;if(t.layout){let o=ow.get(e.constructor);o===void 0&&(o=new WeakMap,ow.set(e.constructor,o));let a=o.get(t);a===void 0&&(a=tt(e.buildFunctionNode(t)),o.set(t,a)),e.addInclude(a),s=tt(a.call(i))}else{const o=t.jsFunc,a=i!==null||o.length>1?o(i||[],e):o(e);s=tt(a)}return t.once&&(r.onceOutput=s),s}getOutputNode(e){const t=e.getNodeProperties(this);return t.outputNode===null&&(t.outputNode=this.setupOutput(e)),t.outputNode}setup(e){return this.getOutputNode(e)}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,t){return this.getOutputNode(e).build(e,t)}}class jne extends en{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return Cp(e),tt(new $ne(this,e))}setup(){return this.call()}}const Xne=[!1,!0],Qne=[0,1,2,3],Yne=[-1,-2],PR=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],bb=new Map;for(const n of Xne)bb.set(n,new Ua(n));const Tb=new Map;for(const n of Qne)Tb.set(n,new Ua(n,"uint"));const Sb=new Map([...Tb].map(n=>new Ua(n.value,"int")));for(const n of Yne)Sb.set(n,new Ua(n,"int"));const $2=new Map([...Sb].map(n=>new Ua(n.value)));for(const n of PR)$2.set(n,new Ua(n));for(const n of PR)$2.set(-n,new Ua(-n));const j2={bool:bb,uint:Tb,ints:Sb,float:$2},aw=new Map([...bb,...$2]),Mx=(n,e)=>aw.has(n)?aw.get(n):n.isNode===!0?n:new Ua(n,e),Zne=n=>{try{return n.getNodeType()}catch{return}},Rr=function(n,e=null){return(...t)=>{if((t.length===0||!["bool","float","int","uint"].includes(n)&&t.every(r=>typeof r!="object"))&&(t=[TR(n,...t)]),t.length===1&&e!==null&&e.has(t[0]))return tt(e.get(t[0]));if(t.length===1){const r=Mx(t[0],n);return Zne(r)===n?tt(r):tt(new CR(r,n))}const i=t.map(r=>Mx(r));return tt(new Fne(i,n))}},ip=n=>typeof n=="object"&&n!==null?n.value:n,LR=n=>n!=null?n.nodeType||n.convertTo||(typeof n=="string"?n:null):null;function Bf(n,e){return new Proxy(new jne(n,e),NR)}const tt=(n,e=null)=>zne(n,e),Cp=(n,e=null)=>new qne(n,e),ih=(n,e=null)=>new Gne(n,e),at=(...n)=>new Hne(...n),Et=(...n)=>new Wne(...n);let Kne=0;const Ie=(n,e=null)=>{let t=null;e!==null&&(typeof e=="object"?t=e.return:(typeof e=="string"?t=e:console.error("THREE.TSL: Invalid layout type."),e=null));const i=new Bf(n,t),r=(...s)=>{let o;Cp(s),s[0]&&s[0].isNode?o=[...s]:o=s[0];const a=i.call(o);return t==="void"&&a.toStack(),a};if(r.shaderNode=i,r.setLayout=s=>(i.setLayout(s),r),r.once=()=>(i.once=!0,r),e!==null){if(typeof e.inputs!="object"){const s={name:"fn"+Kne++,type:t,inputs:[]};for(const o in e)o!=="return"&&s.inputs.push({name:o,type:e[o]});e=s}r.setLayout(e)}return r};Ye("toGlobal",n=>(n.global=!0,n));const rp=n=>{xh=n},wb=()=>xh,Cn=(...n)=>xh.If(...n),Jne=(...n)=>xh.Switch(...n);function X2(n){return xh&&xh.add(n),n}Ye("toStack",X2);const DR=new Rr("color"),oe=new Rr("float",j2.float),_e=new Rr("int",j2.ints),Bt=new Rr("uint",j2.uint),ou=new Rr("bool",j2.bool),ut=new Rr("vec2"),Pr=new Rr("ivec2"),IR=new Rr("uvec2"),BR=new Rr("bvec2"),Ce=new Rr("vec3"),FR=new Rr("ivec3"),HA=new Rr("uvec3"),Mb=new Rr("bvec3"),Xt=new Rr("vec4"),UR=new Rr("ivec4"),OR=new Rr("uvec4"),kR=new Rr("bvec4"),Q2=new Rr("mat2"),Ts=new Rr("mat3"),rh=new Rr("mat4"),eie=(n="")=>tt(new Ua(n,"string")),tie=n=>tt(new Ua(n,"ArrayBuffer"));Ye("toColor",DR);Ye("toFloat",oe);Ye("toInt",_e);Ye("toUint",Bt);Ye("toBool",ou);Ye("toVec2",ut);Ye("toIVec2",Pr);Ye("toUVec2",IR);Ye("toBVec2",BR);Ye("toVec3",Ce);Ye("toIVec3",FR);Ye("toUVec3",HA);Ye("toBVec3",Mb);Ye("toVec4",Xt);Ye("toIVec4",UR);Ye("toUVec4",OR);Ye("toBVec4",kR);Ye("toMat2",Q2);Ye("toMat3",Ts);Ye("toMat4",rh);const VR=at(Eh).setParameterLength(2),zR=(n,e)=>tt(new CR(tt(n),e)),nie=(n,e)=>tt(new wx(tt(n),e));Ye("element",VR);Ye("convert",zR);const iie=n=>(console.warn("THREE.TSL: append() has been renamed to Stack()."),X2(n));Ye("append",n=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),X2(n)));const rie=(...n)=>(console.warn("THREE.TSL: tslFn() has been renamed to Fn()."),Ie(...n));class ci extends en{static get type(){return"PropertyNode"}constructor(e,t=null,i=!1){super(e),this.name=t,this.varying=i,this.isPropertyNode=!0}getHash(e){return this.name||super.getHash(e)}isGlobal(){return!0}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const WA=(n,e)=>tt(new ci(n,e)),sp=(n,e)=>tt(new ci(n,e,!0)),ii=Et(ci,"vec4","DiffuseColor"),Ex=Et(ci,"vec3","EmissiveColor"),tl=Et(ci,"float","Roughness"),op=Et(ci,"float","Metalness"),i2=Et(ci,"float","Clearcoat"),ap=Et(ci,"float","ClearcoatRoughness"),Qc=Et(ci,"vec3","Sheen"),Y2=Et(ci,"float","SheenRoughness"),Z2=Et(ci,"float","Iridescence"),Eb=Et(ci,"float","IridescenceIOR"),Cb=Et(ci,"float","IridescenceThickness"),r2=Et(ci,"float","AlphaT"),Ou=Et(ci,"float","Anisotropy"),ld=Et(ci,"vec3","AnisotropyT"),sh=Et(ci,"vec3","AnisotropyB"),Ys=Et(ci,"color","SpecularColor"),lp=Et(ci,"float","SpecularF90"),s2=Et(ci,"float","Shininess"),Jf=Et(ci,"vec4","Output"),X1=Et(ci,"float","dashSize"),Cx=Et(ci,"float","gapSize"),sie=Et(ci,"float","pointWidth"),ud=Et(ci,"float","IOR"),o2=Et(ci,"float","Transmission"),Rb=Et(ci,"float","Thickness"),Nb=Et(ci,"float","AttenuationDistance"),Pb=Et(ci,"color","AttenuationColor"),Lb=Et(ci,"float","Dispersion");class qR extends en{static get type(){return"UniformGroupNode"}constructor(e,t=!1,i=1){super("string"),this.name=e,this.shared=t,this.order=i,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const GR=n=>new qR(n),K2=(n,e=0)=>new qR(n,!0,e),HR=K2("frame"),nn=K2("render"),Db=GR("object");class Rp extends xb{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=Db}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){const i=this.getSelf();return e=e.bind(i),super.onUpdate(r=>{const s=e(r,i);s!==void 0&&(this.value=s)},t)}generate(e,t){const i=this.getNodeType(e),r=this.getUniformHash(e);let s=e.getNodeFromHash(r);s===void 0&&(e.setHashNode(this,r),s=this);const o=s.getInputType(e),a=e.getUniformFromNode(s,o,e.shaderStage,this.name||e.context.label),l=e.getPropertyName(a);return e.context.label!==void 0&&delete e.context.label,e.format(l,i,t)}}const jt=(n,e)=>{const t=LR(e||n),i=n&&n.isNode===!0?n.node&&n.node.value||n.value:n;return tt(new Rp(i,t))};class lw extends fr{static get type(){return"ArrayNode"}constructor(e,t,i=null){super(e),this.count=t,this.values=i,this.isArrayNode=!0}getNodeType(e){return this.nodeType===null&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const WR=(...n)=>{let e;if(n.length===1){const t=n[0];e=new lw(null,t.length,t)}else{const t=n[0],i=n[1];e=new lw(t,i)}return tt(e)};Ye("toArray",(n,e)=>WR(Array(e).fill(n)));class oie extends fr{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const i=e.getTypeLength(t.node.getNodeType(e));return Mh.join("").slice(0,i)!==t.components}return!1}generate(e,t){const{targetNode:i,sourceNode:r}=this,s=this.needsSplitAssign(e),o=i.getNodeType(e),a=i.context({assign:!0}).build(e),l=r.build(e,o),u=r.getNodeType(e),A=e.getDataFromNode(this);let p;if(A.initialized===!0)t!=="void"&&(p=a);else if(s){const g=e.getVarFromNode(this,null,o),v=e.getPropertyName(g);e.addLineFlowCode(`${v} = ${l}`,this);const y=i.node.context({assign:!0}).build(e);for(let b=0;b<i.components.length;b++){const w=i.components[b];e.addLineFlowCode(`${y}.${w} = ${v}[ ${b} ]`,this)}t!=="void"&&(p=a)}else p=`${a} = ${l}`,(t==="void"||u==="void")&&(e.addLineFlowCode(p,this),t!=="void"&&(p=a));return A.initialized=!0,e.format(p,o,t)}}const $R=at(oie).setParameterLength(2);Ye("assign",$R);class aie extends fr{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const t=[],i=this.functionNode,r=i.getInputs(e),s=this.parameters,o=(l,u)=>{const A=u.type,p=A==="pointer";let g;return p?g="&"+l.build(e):g=l.build(e,A),g};if(Array.isArray(s)){if(s.length>r.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),s.length=r.length;else if(s.length<r.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");s.length<r.length;)s.push(oe(0));for(let l=0;l<s.length;l++)t.push(o(s[l],r[l]))}else for(const l of r){const u=s[l.name];u!==void 0?t.push(o(u,l)):(console.error(`THREE.TSL: Input '${l.name}' not found in 'Fn()'.`),t.push(o(oe(0),l)))}return`${i.build(e,"property")}( ${t.join(", ")} )`}}const jR=(n,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?ih(e):Cp(e[0]),tt(new aie(tt(n),e)));Ye("call",jR);const lie={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class Qi extends fr{static get type(){return"OperatorNode"}constructor(e,t,i,...r){if(super(),r.length>0){let s=new Qi(e,t,i);for(let o=0;o<r.length-1;o++)s=new Qi(e,s,r[o]);t=s,i=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=i,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(lie[this.op],t)}getNodeType(e){const t=this.op,i=this.aNode,r=this.bNode,s=i.getNodeType(e),o=typeof r<"u"?r.getNodeType(e):null;if(s==="void"||o==="void")return"void";if(t==="%")return s;if(t==="~"||t==="&"||t==="|"||t==="^"||t===">>"||t==="<<")return e.getIntegerType(s);if(t==="!"||t==="&&"||t==="||"||t==="^^")return"bool";if(t==="=="||t==="!="||t==="<"||t===">"||t==="<="||t===">="){const a=Math.max(e.getTypeLength(s),e.getTypeLength(o));return a>1?`bvec${a}`:"bool"}else{if(e.isMatrix(s)){if(o==="float")return s;if(e.isVector(o))return e.getVectorFromMatrix(s);if(e.isMatrix(o))return s}else if(e.isMatrix(o)){if(s==="float")return o;if(e.isVector(s))return e.getVectorFromMatrix(o)}return e.getTypeLength(o)>e.getTypeLength(s)?o:s}}generate(e,t){const i=this.op,r=this.aNode,s=this.bNode,o=this.getNodeType(e);let a=null,l=null;o!=="void"?(a=r.getNodeType(e),l=typeof s<"u"?s.getNodeType(e):null,i==="<"||i===">"||i==="<="||i===">="||i==="=="||i==="!="?e.isVector(a)?l=a:e.isVector(l)?a=l:a!==l&&(a=l="float"):i===">>"||i==="<<"?(a=o,l=e.changeComponentType(l,"uint")):i==="%"?(a=o,l=e.isInteger(a)&&e.isInteger(l)?l:a):e.isMatrix(a)?l==="float"?l="float":e.isVector(l)?l=e.getVectorFromMatrix(a):e.isMatrix(l)||(a=l=o):e.isMatrix(l)?a==="float"?a="float":e.isVector(a)?a=e.getVectorFromMatrix(l):a=l=o:a=l=o):a=l=o;const u=r.build(e,a),A=typeof s<"u"?s.build(e,l):null,p=e.getFunctionOperator(i);if(t!=="void"){const g=e.renderer.coordinateSystem===zs;if(i==="=="||i==="!="||i==="<"||i===">"||i==="<="||i===">=")return g?e.isVector(a)?e.format(`${this.getOperatorMethod(e,t)}( ${u}, ${A} )`,o,t):e.format(`( ${u} ${i} ${A} )`,o,t):e.format(`( ${u} ${i} ${A} )`,o,t);if(i==="%")return e.isInteger(l)?e.format(`( ${u} % ${A} )`,o,t):e.format(`${this.getOperatorMethod(e,o)}( ${u}, ${A} )`,o,t);if(i==="!"||i==="~")return e.format(`(${i}${u})`,a,t);if(p)return e.format(`${p}( ${u}, ${A} )`,o,t);if(e.isMatrix(a)&&l==="float")return e.format(`( ${A} ${i} ${u} )`,o,t);if(a==="float"&&e.isMatrix(l))return e.format(`${u} ${i} ${A}`,o,t);{let v=`( ${u} ${i} ${A} )`;return!g&&o==="bool"&&e.isVector(a)&&e.isVector(l)&&(v=`all${v}`),e.format(v,o,t)}}else if(a!=="void")return p?e.format(`${p}( ${u}, ${A} )`,o,t):e.isMatrix(a)&&l==="float"?e.format(`${A} ${i} ${u}`,o,t):e.format(`${u} ${i} ${A}`,o,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const vr=at(Qi,"+").setParameterLength(2,1/0).setName("add"),Yn=at(Qi,"-").setParameterLength(2,1/0).setName("sub"),wn=at(Qi,"*").setParameterLength(2,1/0).setName("mul"),Da=at(Qi,"/").setParameterLength(2,1/0).setName("div"),Np=at(Qi,"%").setParameterLength(2).setName("mod"),Ib=at(Qi,"==").setParameterLength(2).setName("equal"),XR=at(Qi,"!=").setParameterLength(2).setName("notEqual"),QR=at(Qi,"<").setParameterLength(2).setName("lessThan"),Bb=at(Qi,">").setParameterLength(2).setName("greaterThan"),YR=at(Qi,"<=").setParameterLength(2).setName("lessThanEqual"),ZR=at(Qi,">=").setParameterLength(2).setName("greaterThanEqual"),KR=at(Qi,"&&").setParameterLength(2,1/0).setName("and"),JR=at(Qi,"||").setParameterLength(2,1/0).setName("or"),eN=at(Qi,"!").setParameterLength(1).setName("not"),tN=at(Qi,"^^").setParameterLength(2).setName("xor"),nN=at(Qi,"&").setParameterLength(2).setName("bitAnd"),iN=at(Qi,"~").setParameterLength(2).setName("bitNot"),rN=at(Qi,"|").setParameterLength(2).setName("bitOr"),sN=at(Qi,"^").setParameterLength(2).setName("bitXor"),oN=at(Qi,"<<").setParameterLength(2).setName("shiftLeft"),aN=at(Qi,">>").setParameterLength(2).setName("shiftRight"),lN=Ie(([n])=>(n.addAssign(1),n)),uN=Ie(([n])=>(n.subAssign(1),n)),cN=Ie(([n])=>{const e=_e(n).toConst();return n.addAssign(1),e}),hN=Ie(([n])=>{const e=_e(n).toConst();return n.subAssign(1),e});Ye("add",vr);Ye("sub",Yn);Ye("mul",wn);Ye("div",Da);Ye("mod",Np);Ye("equal",Ib);Ye("notEqual",XR);Ye("lessThan",QR);Ye("greaterThan",Bb);Ye("lessThanEqual",YR);Ye("greaterThanEqual",ZR);Ye("and",KR);Ye("or",JR);Ye("not",eN);Ye("xor",tN);Ye("bitAnd",nN);Ye("bitNot",iN);Ye("bitOr",rN);Ye("bitXor",sN);Ye("shiftLeft",oN);Ye("shiftRight",aN);Ye("incrementBefore",lN);Ye("decrementBefore",uN);Ye("increment",cN);Ye("decrement",hN);const fN=(n,e)=>(console.warn('THREE.TSL: "remainder()" is deprecated. Use "mod( int( ... ) )" instead.'),Np(n,e)),AN=(n,e)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),Np(_e(n),_e(e)));Ye("remainder",fN);Ye("modInt",AN);class Oe extends fr{static get type(){return"MathNode"}constructor(e,t,i=null,r=null){if(super(),(e===Oe.MAX||e===Oe.MIN)&&arguments.length>3){let s=new Oe(e,t,i);for(let o=2;o<arguments.length-1;o++)s=new Oe(e,s,arguments[o]);t=s,i=arguments[arguments.length-1],r=null}this.method=e,this.aNode=t,this.bNode=i,this.cNode=r,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),i=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,s=e.isMatrix(t)?0:e.getTypeLength(t),o=e.isMatrix(i)?0:e.getTypeLength(i),a=e.isMatrix(r)?0:e.getTypeLength(r);return s>o&&s>a?t:o>a?i:a>s?r:t}getNodeType(e){const t=this.method;return t===Oe.LENGTH||t===Oe.DISTANCE||t===Oe.DOT?"float":t===Oe.CROSS?"vec3":t===Oe.ALL||t===Oe.ANY?"bool":t===Oe.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}generate(e,t){let i=this.method;const r=this.getNodeType(e),s=this.getInputType(e),o=this.aNode,a=this.bNode,l=this.cNode,u=e.renderer.coordinateSystem;if(i===Oe.TRANSFORM_DIRECTION){let A=o,p=a;e.isMatrix(A.getNodeType(e))?p=Xt(Ce(p),0):A=Xt(Ce(A),0);const g=wn(A,p).xyz;return au(g).build(e,t)}else{if(i===Oe.NEGATE)return e.format("( - "+o.build(e,s)+" )",r,t);if(i===Oe.ONE_MINUS)return Yn(1,o).build(e,t);if(i===Oe.RECIPROCAL)return Da(1,o).build(e,t);if(i===Oe.DIFFERENCE)return Pi(Yn(o,a)).build(e,t);{const A=[];return i===Oe.CROSS?A.push(o.build(e,r),a.build(e,r)):u===zs&&i===Oe.STEP?A.push(o.build(e,e.getTypeLength(o.getNodeType(e))===1?"float":s),a.build(e,s)):u===zs&&(i===Oe.MIN||i===Oe.MAX)?A.push(o.build(e,s),a.build(e,e.getTypeLength(a.getNodeType(e))===1?"float":s)):i===Oe.REFRACT?A.push(o.build(e,s),a.build(e,s),l.build(e,"float")):i===Oe.MIX?A.push(o.build(e,s),a.build(e,s),l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":s)):(u===Al&&i===Oe.ATAN&&a!==null&&(i="atan2"),e.shaderStage!=="fragment"&&(i===Oe.DFDX||i===Oe.DFDY)&&(console.warn(`THREE.TSL: '${i}' is not supported in the ${e.shaderStage} stage.`),i="/*"+i+"*/"),A.push(o.build(e,s)),a!==null&&A.push(a.build(e,s)),l!==null&&A.push(l.build(e,s))),e.format(`${e.getMethod(i,r)}( ${A.join(", ")} )`,r,t)}}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}Oe.ALL="all";Oe.ANY="any";Oe.RADIANS="radians";Oe.DEGREES="degrees";Oe.EXP="exp";Oe.EXP2="exp2";Oe.LOG="log";Oe.LOG2="log2";Oe.SQRT="sqrt";Oe.INVERSE_SQRT="inversesqrt";Oe.FLOOR="floor";Oe.CEIL="ceil";Oe.NORMALIZE="normalize";Oe.FRACT="fract";Oe.SIN="sin";Oe.COS="cos";Oe.TAN="tan";Oe.ASIN="asin";Oe.ACOS="acos";Oe.ATAN="atan";Oe.ABS="abs";Oe.SIGN="sign";Oe.LENGTH="length";Oe.NEGATE="negate";Oe.ONE_MINUS="oneMinus";Oe.DFDX="dFdx";Oe.DFDY="dFdy";Oe.ROUND="round";Oe.RECIPROCAL="reciprocal";Oe.TRUNC="trunc";Oe.FWIDTH="fwidth";Oe.TRANSPOSE="transpose";Oe.BITCAST="bitcast";Oe.EQUALS="equals";Oe.MIN="min";Oe.MAX="max";Oe.STEP="step";Oe.REFLECT="reflect";Oe.DISTANCE="distance";Oe.DIFFERENCE="difference";Oe.DOT="dot";Oe.CROSS="cross";Oe.POW="pow";Oe.TRANSFORM_DIRECTION="transformDirection";Oe.MIX="mix";Oe.CLAMP="clamp";Oe.REFRACT="refract";Oe.SMOOTHSTEP="smoothstep";Oe.FACEFORWARD="faceforward";const dN=oe(1e-6),uie=oe(1e6),a2=oe(Math.PI),cie=oe(Math.PI*2),pN=at(Oe,Oe.ALL).setParameterLength(1),mN=at(Oe,Oe.ANY).setParameterLength(1),gN=at(Oe,Oe.RADIANS).setParameterLength(1),_N=at(Oe,Oe.DEGREES).setParameterLength(1),Fb=at(Oe,Oe.EXP).setParameterLength(1),PA=at(Oe,Oe.EXP2).setParameterLength(1),J2=at(Oe,Oe.LOG).setParameterLength(1),ll=at(Oe,Oe.LOG2).setParameterLength(1),Sl=at(Oe,Oe.SQRT).setParameterLength(1),Ub=at(Oe,Oe.INVERSE_SQRT).setParameterLength(1),ul=at(Oe,Oe.FLOOR).setParameterLength(1),e_=at(Oe,Oe.CEIL).setParameterLength(1),au=at(Oe,Oe.NORMALIZE).setParameterLength(1),Au=at(Oe,Oe.FRACT).setParameterLength(1),No=at(Oe,Oe.SIN).setParameterLength(1),kl=at(Oe,Oe.COS).setParameterLength(1),vN=at(Oe,Oe.TAN).setParameterLength(1),yN=at(Oe,Oe.ASIN).setParameterLength(1),xN=at(Oe,Oe.ACOS).setParameterLength(1),Ob=at(Oe,Oe.ATAN).setParameterLength(1,2),Pi=at(Oe,Oe.ABS).setParameterLength(1),up=at(Oe,Oe.SIGN).setParameterLength(1),Zl=at(Oe,Oe.LENGTH).setParameterLength(1),bN=at(Oe,Oe.NEGATE).setParameterLength(1),TN=at(Oe,Oe.ONE_MINUS).setParameterLength(1),kb=at(Oe,Oe.DFDX).setParameterLength(1),Vb=at(Oe,Oe.DFDY).setParameterLength(1),SN=at(Oe,Oe.ROUND).setParameterLength(1),wN=at(Oe,Oe.RECIPROCAL).setParameterLength(1),zb=at(Oe,Oe.TRUNC).setParameterLength(1),MN=at(Oe,Oe.FWIDTH).setParameterLength(1),EN=at(Oe,Oe.TRANSPOSE).setParameterLength(1),hie=at(Oe,Oe.BITCAST).setParameterLength(2),CN=(n,e)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),Ib(n,e)),co=at(Oe,Oe.MIN).setParameterLength(2,1/0),hr=at(Oe,Oe.MAX).setParameterLength(2,1/0),t_=at(Oe,Oe.STEP).setParameterLength(2),RN=at(Oe,Oe.REFLECT).setParameterLength(2),NN=at(Oe,Oe.DISTANCE).setParameterLength(2),PN=at(Oe,Oe.DIFFERENCE).setParameterLength(2),ac=at(Oe,Oe.DOT).setParameterLength(2),n_=at(Oe,Oe.CROSS).setParameterLength(2),Sa=at(Oe,Oe.POW).setParameterLength(2),qb=at(Oe,Oe.POW,2).setParameterLength(1),LN=at(Oe,Oe.POW,3).setParameterLength(1),DN=at(Oe,Oe.POW,4).setParameterLength(1),IN=at(Oe,Oe.TRANSFORM_DIRECTION).setParameterLength(2),BN=n=>wn(up(n),Sa(Pi(n),1/3)),Gb=n=>ac(n,n),li=at(Oe,Oe.MIX).setParameterLength(3),pl=(n,e=0,t=1)=>tt(new Oe(Oe.CLAMP,tt(n),tt(e),tt(t))),FN=n=>pl(n),Hb=at(Oe,Oe.REFRACT).setParameterLength(3),ml=at(Oe,Oe.SMOOTHSTEP).setParameterLength(3),Wb=at(Oe,Oe.FACEFORWARD).setParameterLength(3),UN=Ie(([n])=>{const i=43758.5453,r=ac(n.xy,ut(12.9898,78.233)),s=Np(r,a2);return Au(No(s).mul(i))}),ON=(n,e,t)=>li(e,t,n),kN=(n,e,t)=>ml(e,t,n),VN=(n,e)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),Ob(n,e)),fie=Wb,Aie=Ub;Ye("all",pN);Ye("any",mN);Ye("equals",CN);Ye("radians",gN);Ye("degrees",_N);Ye("exp",Fb);Ye("exp2",PA);Ye("log",J2);Ye("log2",ll);Ye("sqrt",Sl);Ye("inverseSqrt",Ub);Ye("floor",ul);Ye("ceil",e_);Ye("normalize",au);Ye("fract",Au);Ye("sin",No);Ye("cos",kl);Ye("tan",vN);Ye("asin",yN);Ye("acos",xN);Ye("atan",Ob);Ye("abs",Pi);Ye("sign",up);Ye("length",Zl);Ye("lengthSq",Gb);Ye("negate",bN);Ye("oneMinus",TN);Ye("dFdx",kb);Ye("dFdy",Vb);Ye("round",SN);Ye("reciprocal",wN);Ye("trunc",zb);Ye("fwidth",MN);Ye("atan2",VN);Ye("min",co);Ye("max",hr);Ye("step",t_);Ye("reflect",RN);Ye("distance",NN);Ye("dot",ac);Ye("cross",n_);Ye("pow",Sa);Ye("pow2",qb);Ye("pow3",LN);Ye("pow4",DN);Ye("transformDirection",IN);Ye("mix",ON);Ye("clamp",pl);Ye("refract",Hb);Ye("smoothstep",kN);Ye("faceForward",Wb);Ye("difference",PN);Ye("saturate",FN);Ye("cbrt",BN);Ye("transpose",EN);Ye("rand",UN);class die extends en{static get type(){return"ConditionalNode"}constructor(e,t,i=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=i}getNodeType(e){const{ifNode:t,elseNode:i}=e.getNodeProperties(this);if(t===void 0)return this.setup(e),this.getNodeType(e);const r=t.getNodeType(e);if(i!==null){const s=i.getNodeType(e);if(e.getTypeLength(s)>e.getTypeLength(r))return s}return r}setup(e){const t=this.condNode.cache(),i=this.ifNode.cache(),r=this.elseNode?this.elseNode.cache():null,s=e.context.nodeBlock;e.getDataFromNode(i).parentNodeBlock=s,r!==null&&(e.getDataFromNode(r).parentNodeBlock=s);const o=e.getNodeProperties(this);o.condNode=t,o.ifNode=i.context({nodeBlock:i}),o.elseNode=r?r.context({nodeBlock:r}):null}generate(e,t){const i=this.getNodeType(e),r=e.getDataFromNode(this);if(r.nodeProperty!==void 0)return r.nodeProperty;const{condNode:s,ifNode:o,elseNode:a}=e.getNodeProperties(this),l=e.currentFunctionNode,u=t!=="void",A=u?WA(i).build(e):"";r.nodeProperty=A;const p=s.build(e,"bool");e.addFlowCode(`
${e.tab}if ( ${p} ) {

`).addFlowTab();let g=o.build(e,i);if(g&&(u?g=A+" = "+g+";":(g="return "+g+";",l===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),g="// "+g))),e.removeFlowTab().addFlowCode(e.tab+"	"+g+`

`+e.tab+"}"),a!==null){e.addFlowCode(` else {

`).addFlowTab();let v=a.build(e,i);v&&(u?v=A+" = "+v+";":(v="return "+v+";",l===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),v="// "+v))),e.removeFlowTab().addFlowCode(e.tab+"	"+v+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(A,i,t)}}const Hr=at(die).setParameterLength(2,3);Ye("select",Hr);const zN=(...n)=>(console.warn("THREE.TSL: cond() has been renamed to select()."),Hr(...n));Ye("cond",zN);class qN extends en{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){this.node.build(e)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value});const i=this.node.build(e);return e.setContext(t),i}generate(e,t){const i=e.getContext();e.setContext({...e.context,...this.value});const r=this.node.build(e,t);return e.setContext(i),r}}const i_=at(qN).setParameterLength(1,2),GN=(n,e)=>i_(n,{label:e});Ye("context",i_);Ye("label",GN);class Q1 extends en{static get type(){return"VarNode"}constructor(e,t=null,i=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=i}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:t,name:i,readOnly:r}=this,{renderer:s}=e,o=s.backend.isWebGPUBackend===!0;let a=!1,l=!1;r&&(a=e.isDeterministic(t),l=o?r:a);const u=e.getVectorType(this.getNodeType(e)),A=t.build(e,u),p=e.getVarFromNode(this,i,u,void 0,l),g=e.getPropertyName(p);let v=g;if(l)if(o)v=a?`const ${g}`:`let ${g}`;else{const y=e.getArrayCount(t);v=`const ${e.getVar(p.type,g,y)}`}return e.addLineFlowCode(`${v} = ${A}`,this),g}}const $b=at(Q1),HN=(n,e=null)=>$b(n,e).toStack(),WN=(n,e=null)=>$b(n,e,!0).toStack();Ye("toVar",HN);Ye("toConst",WN);const $N=n=>(console.warn('TSL: "temp( node )" is deprecated. Use "Var( node )" or "node.toVar()" instead.'),$b(n));Ye("temp",$N);class pie extends en{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null}isGlobal(){return!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let i=t.varying;if(i===void 0){const r=this.name,s=this.getNodeType(e),o=this.interpolationType,a=this.interpolationSampling;t.varying=i=e.getVaryingFromNode(this,r,s,o,a),t.node=this.node}return i.needsInterpolation||(i.needsInterpolation=e.shaderStage==="fragment"),i}setup(e){this.setupVarying(e)}analyze(e){return this.setupVarying(e),this.node.analyze(e)}generate(e){const t=e.getNodeProperties(this),i=this.setupVarying(e),r=e.shaderStage==="fragment"&&t.reassignPosition===!0&&e.context.needsPositionReassign;if(t.propertyName===void 0||r){const s=this.getNodeType(e),o=e.getPropertyName(i,bx.VERTEX);e.flowNodeFromShaderStage(bx.VERTEX,this.node,s,o),t.propertyName=o,r?t.reassignPosition=!1:t.reassignPosition===void 0&&e.context.isPositionNodeInput&&(t.reassignPosition=!0)}return e.getPropertyName(i)}}const ko=at(pie).setParameterLength(1,2),jN=n=>ko(n);Ye("toVarying",ko);Ye("toVertexStage",jN);Ye("varying",(...n)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),ko(...n)));Ye("vertexStage",(...n)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),ko(...n)));const XN=Ie(([n])=>{const e=n.mul(.9478672986).add(.0521327014).pow(2.4),t=n.mul(.0773993808),i=n.lessThanEqual(.04045);return li(e,t,i)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),QN=Ie(([n])=>{const e=n.pow(.41666).mul(1.055).sub(.055),t=n.mul(12.92),i=n.lessThanEqual(.0031308);return li(e,t,i)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),Pp="WorkingColorSpace",jb="OutputColorSpace";class Lp extends fr{static get type(){return"ColorSpaceNode"}constructor(e,t,i){super("vec4"),this.colorNode=e,this.source=t,this.target=i}resolveColorSpace(e,t){return t===Pp?Un.workingColorSpace:t===jb?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,i=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let s=t;return Un.enabled===!1||i===r||!i||!r||(Un.getTransfer(i)===hi&&(s=Xt(XN(s.rgb),s.a)),Un.getPrimaries(i)!==Un.getPrimaries(r)&&(s=Xt(Ts(Un._getMatrix(new bn,i,r)).mul(s.rgb),s.a)),Un.getTransfer(r)===hi&&(s=Xt(QN(s.rgb),s.a))),s}}const YN=n=>tt(new Lp(tt(n),Pp,jb)),ZN=n=>tt(new Lp(tt(n),jb,Pp)),KN=(n,e)=>tt(new Lp(tt(n),Pp,e)),r_=(n,e)=>tt(new Lp(tt(n),e,Pp)),mie=(n,e,t)=>tt(new Lp(tt(n),e,t));Ye("toOutputColorSpace",YN);Ye("toWorkingColorSpace",ZN);Ye("workingToColorSpace",KN);Ye("colorSpaceToWorking",r_);let gie=class extends Eh{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),i=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,i,r)}};class JN extends en{static get type(){return"ReferenceBaseNode"}constructor(e,t,i=null,r=null){super(),this.property=e,this.uniformType=t,this.object=i,this.count=r,this.properties=e.split("."),this.reference=i,this.node=null,this.group=null,this.updateType=Sn.OBJECT}setGroup(e){return this.group=e,this}element(e){return tt(new gie(this,tt(e)))}setNodeType(e){const t=jt(null,e).getSelf();this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let i=e[t[0]];for(let r=1;r<t.length;r++)i=i[t[r]];return i}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const _ie=(n,e,t)=>tt(new JN(n,e,t));class vie extends JN{static get type(){return"RendererReferenceNode"}constructor(e,t,i=null){super(e,t,i),this.renderer=i,this.setGroup(nn)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const eP=(n,e,t=null)=>tt(new vie(n,e,t));class yie extends fr{static get type(){return"ToneMappingNode"}constructor(e,t=nP,i=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=i}customCacheKey(){return np(this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,i=this.toneMapping;if(i===ao)return t;let r=null;const s=e.renderer.library.getToneMappingFunction(i);return s!==null?r=Xt(s(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",i),r=t),r}}const tP=(n,e,t)=>tt(new yie(n,tt(e),tt(t))),nP=eP("toneMappingExposure","float");Ye("toneMapping",(n,e,t)=>tP(e,t,n));class xie extends xb{static get type(){return"BufferAttributeNode"}constructor(e,t=null,i=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=i,this.bufferOffset=r,this.usage=pg,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),i=this.value,r=e.getTypeLength(t),s=this.bufferStride||r,o=this.bufferOffset,a=i.isInterleavedBuffer===!0?i:new B2(i,s),l=new Ko(a,r,o);a.setUsage(this.usage),this.attribute=l,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),i=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(i);let s=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=r,s=r):s=ko(this).build(e,t),s}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const Dp=(n,e=null,t=0,i=0)=>tt(new xie(n,e,t,i)),iP=(n,e=null,t=0,i=0)=>Dp(n,e,t,i).setUsage(Cf),l2=(n,e=null,t=0,i=0)=>Dp(n,e,t,i).setInstanced(!0),Rx=(n,e=null,t=0,i=0)=>iP(n,e,t,i).setInstanced(!0);Ye("toAttribute",n=>Dp(n.value));class bie extends en{static get type(){return"ComputeNode"}constructor(e,t,i=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=t,this.workgroupSize=i,this.dispatchCount=0,this.version=1,this.name="",this.updateBeforeType=Sn.OBJECT,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}label(e){return this.name=e,this}updateDispatchCount(){const{count:e,workgroupSize:t}=this;let i=t[0];for(let r=1;r<t.length;r++)i*=t[r];this.dispatchCount=Math.ceil(e/i)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){const i=e.getNodeProperties(this);i.outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:i}=e;if(i==="compute"){const r=this.computeNode.build(e,"void");r!==""&&e.addLineFlowCode(r,this)}else{const s=e.getNodeProperties(this).outputComputeNode;if(s)return s.build(e,t)}}}const rP=(n,e,t)=>tt(new bie(tt(n),e,t));Ye("compute",rP);class Tie extends en{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){const t=e.getCache(),i=e.getCacheFromNode(this,this.parent);e.setCache(i);const r=this.node.getNodeType(e);return e.setCache(t),r}build(e,...t){const i=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const s=this.node.build(e,...t);return e.setCache(i),s}}const cd=(n,e)=>tt(new Tie(tt(n),e));Ye("cache",cd);class Sie extends en{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const sP=at(Sie).setParameterLength(2);Ye("bypass",sP);class oP extends en{static get type(){return"RemapNode"}constructor(e,t,i,r=oe(0),s=oe(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=i,this.outLowNode=r,this.outHighNode=s,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:i,outLowNode:r,outHighNode:s,doClamp:o}=this;let a=e.sub(t).div(i.sub(t));return o===!0&&(a=a.clamp()),a.mul(s.sub(r)).add(r)}}const aP=at(oP,null,null,{doClamp:!1}).setParameterLength(3,5),lP=at(oP).setParameterLength(3,5);Ye("remap",aP);Ye("remapClamp",lP);class Y1 extends en{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const i=this.getNodeType(e),r=this.snippet;if(i==="void")e.addLineFlowCode(r,this);else return e.format(r,i,t)}}const lu=at(Y1).setParameterLength(1,2),uP=n=>(n?Hr(n,lu("discard")):lu("discard")).toStack(),wie=()=>lu("return").toStack();Ye("discard",uP);class Mie extends fr{static get type(){return"RenderOutputNode"}constructor(e,t,i){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=i,this.isRenderOutputNode=!0}setup({context:e}){let t=this.colorNode||e.color;const i=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||ao,r=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Po;return i!==ao&&(t=t.toneMapping(i)),r!==Po&&r!==Un.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}const cP=(n,e=null,t=null)=>tt(new Mie(tt(n),e,t));Ye("renderOutput",cP);class Eie extends fr{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,i=this.node.build(e),r="--- TSL debug - "+e.shaderStage+" shader ---",s="-".repeat(r.length);let o="";return o+="// #"+r+`#
`,o+=e.flow.code.replace(/^\t/mg,"")+`
`,o+="/* ... */ "+i+` /* ... */
`,o+="// #"+s+`#
`,t!==null?t(e,o):console.log(o),i}}const hP=(n,e=null)=>tt(new Eie(tt(n),e));Ye("debug",hP);function Cie(n){console.warn("THREE.TSL: AddNodeElement has been removed in favor of tree-shaking. Trying add",n)}class fP extends en{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const i=this.getAttributeName(e);if(e.hasGeometryAttribute(i)){const r=e.geometry.getAttribute(i);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),i=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const s=e.geometry.getAttribute(t),o=e.getTypeFromAttribute(s),a=e.getAttribute(t,o);return e.shaderStage==="vertex"?e.format(a.name,o,i):ko(this).build(e,i)}else return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(i)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const uu=(n,e=null)=>tt(new fP(n,e)),Wi=(n=0)=>uu("uv"+(n>0?n:""),"vec2");class Rie extends en{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const i=this.textureNode.build(e,"property"),r=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${i}, ${r} )`,this.getNodeType(e),t)}}const Qu=at(Rie).setParameterLength(1,2);class Nie extends Rp{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=Sn.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,i=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(i&&i.width!==void 0){const{width:r,height:s}=i;this.value=Math.log2(Math.max(r,s))}}}const AP=at(Nie).setParameterLength(1);class gl extends Rp{static get type(){return"TextureNode"}constructor(e,t=null,i=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=i,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=Sn.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===Ni?"uvec4":this.value.type===qr?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return Wi(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=jt(this.value.matrix)),this._matrixUniform.mul(Ce(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?Sn.OBJECT:Sn.NONE,this}setupUV(e,t){const i=this.value;return e.isFlipY()&&(i.image instanceof ImageBitmap&&i.flipY===!0||i.isRenderTargetTexture===!0||i.isFramebufferTexture===!0||i.isDepthTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(_e(Qu(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const i=this.value;if(!i||i.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let r=this.uvNode;(r===null||e.context.forceUVContext===!0)&&e.context.getUV&&(r=e.context.getUV(this,e)),r||(r=this.getDefaultUV()),this.updateMatrix===!0&&(r=this.getTransformedUV(r)),r=this.setupUV(e,r);let s=this.levelNode;s===null&&e.context.getTextureLevel&&(s=e.context.getTextureLevel(this)),t.uvNode=r,t.levelNode=s,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(e,t,i,r,s,o,a,l){const u=this.value;let A;return r?A=e.generateTextureLevel(u,t,i,r,o):s?A=e.generateTextureBias(u,t,i,s,o):l?A=e.generateTextureGrad(u,t,i,l,o):a?A=e.generateTextureCompare(u,t,i,a,o):this.sampler===!1?A=e.generateTextureLoad(u,t,i,o):A=e.generateTexture(u,t,i,o),A}generate(e,t){const i=this.value,r=e.getNodeProperties(this),s=super.generate(e,"property");if(/^sampler/.test(t))return s+"_sampler";if(e.isReference(t))return s;{const o=e.getDataFromNode(this);let a=o.propertyName;if(a===void 0){const{uvNode:A,levelNode:p,biasNode:g,compareNode:v,depthNode:y,gradNode:b}=r,w=this.generateUV(e,A),S=p?p.build(e,"float"):null,C=g?g.build(e,"float"):null,E=y?y.build(e,"int"):null,R=v?v.build(e,"float"):null,D=b?[b[0].build(e,"vec2"),b[1].build(e,"vec2")]:null,B=e.getVarFromNode(this);a=e.getPropertyName(B);const L=this.generateSnippet(e,s,w,S,C,E,R,D);e.addLineFlowCode(`${a} = ${L}`,this),o.snippet=L,o.propertyName=a}let l=a;const u=this.getNodeType(e);return e.needsToWorkingColorSpace(i)&&(l=r_(lu(l,u),i.colorSpace).setup(e).build(e,u)),e.format(l,u,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=tt(e),t.referenceNode=this.getSelf(),tt(t)}blur(e){const t=this.clone();t.biasNode=tt(e).mul(AP(t)),t.referenceNode=this.getSelf();const i=t.value;return t.generateMipmaps===!1&&(i&&i.generateMipmaps===!1||i.minFilter===Ui||i.magFilter===Ui)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),tt(t)}level(e){const t=this.clone();return t.levelNode=tt(e),t.referenceNode=this.getSelf(),tt(t)}size(e){return Qu(this,e)}bias(e){const t=this.clone();return t.biasNode=tt(e),t.referenceNode=this.getSelf(),tt(t)}compare(e){const t=this.clone();return t.compareNode=tt(e),t.referenceNode=this.getSelf(),tt(t)}grad(e,t){const i=this.clone();return i.gradNode=[tt(e),tt(t)],i.referenceNode=this.getSelf(),tt(i)}depth(e){const t=this.clone();return t.depthNode=tt(e),t.referenceNode=this.getSelf(),tt(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}const Vn=at(gl).setParameterLength(1,4),ir=(...n)=>Vn(...n).setSampler(!1),Pie=n=>(n.isNode===!0?n:Vn(n)).convert("sampler"),Lie=n=>(n.isNode===!0?n:Vn(n)).convert("samplerComparison");class Xb extends Rp{static get type(){return"BufferNode"}constructor(e,t,i=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=i}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const Ip=(n,e,t)=>tt(new Xb(n,e,t));class Die extends Eh{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),i=this.getNodeType(),r=this.node.getPaddedType();return e.format(t,r,i)}}class dP extends Xb{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=t===null?Gu(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=Sn.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return e==="mat2"?t="mat2":/mat/.test(e)===!0?t="mat4":e.charAt(0)==="i"?t="ivec4":e.charAt(0)==="u"&&(t="uvec4"),t}update(){const{array:e,value:t}=this,i=this.elementType;if(i==="float"||i==="int"||i==="uint")for(let r=0;r<e.length;r++){const s=r*4;t[s]=e[r]}else if(i==="color")for(let r=0;r<e.length;r++){const s=r*4,o=e[r];t[s]=o.r,t[s+1]=o.g,t[s+2]=o.b||0}else if(i==="mat2")for(let r=0;r<e.length;r++){const s=r*4,o=e[r];t[s]=o.elements[0],t[s+1]=o.elements[1],t[s+2]=o.elements[2],t[s+3]=o.elements[3]}else if(i==="mat3")for(let r=0;r<e.length;r++){const s=r*16,o=e[r];t[s]=o.elements[0],t[s+1]=o.elements[1],t[s+2]=o.elements[2],t[s+4]=o.elements[3],t[s+5]=o.elements[4],t[s+6]=o.elements[5],t[s+8]=o.elements[6],t[s+9]=o.elements[7],t[s+10]=o.elements[8],t[s+15]=1}else if(i==="mat4")for(let r=0;r<e.length;r++){const s=r*16,o=e[r];for(let a=0;a<o.elements.length;a++)t[s+a]=o.elements[a]}else for(let r=0;r<e.length;r++){const s=r*4,o=e[r];t[s]=o.x,t[s+1]=o.y,t[s+2]=o.z||0,t[s+3]=o.w||0}}setup(e){const t=this.array.length,i=this.elementType;let r=Float32Array;const s=this.paddedType,o=e.getTypeLength(s);return i.charAt(0)==="i"&&(r=Int32Array),i.charAt(0)==="u"&&(r=Uint32Array),this.value=new r(t*o),this.bufferCount=t,this.bufferType=s,super.setup(e)}element(e){return tt(new Die(this,tt(e)))}}const Zo=(n,e)=>tt(new dP(n,e)),Iie=(n,e)=>(console.warn("THREE.TSL: uniforms() has been renamed to uniformArray()."),tt(new dP(n,e)));class Bie extends en{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const Bp=at(Bie).setParameterLength(1),s_=jt(0,"uint").label("u_cameraIndex").setGroup(K2("cameraIndex")).toVarying("v_cameraIndex"),Vu=jt("float").label("cameraNear").setGroup(nn).onRenderUpdate(({camera:n})=>n.near),zu=jt("float").label("cameraFar").setGroup(nn).onRenderUpdate(({camera:n})=>n.far),Ch=Ie(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const r of n.cameras)t.push(r.projectionMatrix);e=Zo(t).setGroup(nn).label("cameraProjectionMatrices").element(n.isMultiViewCamera?Bp("gl_ViewID_OVR"):s_).toVar("cameraProjectionMatrix")}else e=jt("mat4").label("cameraProjectionMatrix").setGroup(nn).onRenderUpdate(({camera:t})=>t.projectionMatrix);return e}).once()(),Fie=Ie(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const r of n.cameras)t.push(r.projectionMatrixInverse);e=Zo(t).setGroup(nn).label("cameraProjectionMatricesInverse").element(n.isMultiViewCamera?Bp("gl_ViewID_OVR"):s_).toVar("cameraProjectionMatrixInverse")}else e=jt("mat4").label("cameraProjectionMatrixInverse").setGroup(nn).onRenderUpdate(({camera:t})=>t.projectionMatrixInverse);return e}).once()(),fo=Ie(({camera:n})=>{let e;if(n.isArrayCamera&&n.cameras.length>0){const t=[];for(const r of n.cameras)t.push(r.matrixWorldInverse);e=Zo(t).setGroup(nn).label("cameraViewMatrices").element(n.isMultiViewCamera?Bp("gl_ViewID_OVR"):s_).toVar("cameraViewMatrix")}else e=jt("mat4").label("cameraViewMatrix").setGroup(nn).onRenderUpdate(({camera:t})=>t.matrixWorldInverse);return e}).once()(),Uie=jt("mat4").label("cameraWorldMatrix").setGroup(nn).onRenderUpdate(({camera:n})=>n.matrixWorld),Oie=jt("mat3").label("cameraNormalMatrix").setGroup(nn).onRenderUpdate(({camera:n})=>n.normalMatrix),pP=jt(new re).label("cameraPosition").setGroup(nn).onRenderUpdate(({camera:n},e)=>e.value.setFromMatrixPosition(n.matrixWorld)),uw=new sc;class Hn extends en{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=Sn.OBJECT,this._uniformNode=new Rp(null)}getNodeType(){const e=this.scope;if(e===Hn.WORLD_MATRIX)return"mat4";if(e===Hn.POSITION||e===Hn.VIEW_POSITION||e===Hn.DIRECTION||e===Hn.SCALE)return"vec3";if(e===Hn.RADIUS)return"float"}update(e){const t=this.object3d,i=this._uniformNode,r=this.scope;if(r===Hn.WORLD_MATRIX)i.value=t.matrixWorld;else if(r===Hn.POSITION)i.value=i.value||new re,i.value.setFromMatrixPosition(t.matrixWorld);else if(r===Hn.SCALE)i.value=i.value||new re,i.value.setFromMatrixScale(t.matrixWorld);else if(r===Hn.DIRECTION)i.value=i.value||new re,t.getWorldDirection(i.value);else if(r===Hn.VIEW_POSITION){const s=e.camera;i.value=i.value||new re,i.value.setFromMatrixPosition(t.matrixWorld),i.value.applyMatrix4(s.matrixWorldInverse)}else if(r===Hn.RADIUS){const s=e.object.geometry;s.boundingSphere===null&&s.computeBoundingSphere(),uw.copy(s.boundingSphere).applyMatrix4(t.matrixWorld),i.value=uw.radius}}generate(e){const t=this.scope;return t===Hn.WORLD_MATRIX?this._uniformNode.nodeType="mat4":t===Hn.POSITION||t===Hn.VIEW_POSITION||t===Hn.DIRECTION||t===Hn.SCALE?this._uniformNode.nodeType="vec3":t===Hn.RADIUS&&(this._uniformNode.nodeType="float"),this._uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Hn.WORLD_MATRIX="worldMatrix";Hn.POSITION="position";Hn.SCALE="scale";Hn.VIEW_POSITION="viewPosition";Hn.DIRECTION="direction";Hn.RADIUS="radius";const kie=at(Hn,Hn.DIRECTION).setParameterLength(1),Vie=at(Hn,Hn.WORLD_MATRIX).setParameterLength(1),mP=at(Hn,Hn.POSITION).setParameterLength(1),zie=at(Hn,Hn.SCALE).setParameterLength(1),qie=at(Hn,Hn.VIEW_POSITION).setParameterLength(1),Gie=at(Hn,Hn.RADIUS).setParameterLength(1);class aa extends Hn{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const Hie=Et(aa,aa.DIRECTION),Jo=Et(aa,aa.WORLD_MATRIX),Wie=Et(aa,aa.POSITION),$ie=Et(aa,aa.SCALE),jie=Et(aa,aa.VIEW_POSITION),Xie=Et(aa,aa.RADIUS),gP=jt(new bn).onObjectUpdate(({object:n},e)=>e.value.getNormalMatrix(n.matrixWorld)),Qie=jt(new on).onObjectUpdate(({object:n},e)=>e.value.copy(n.matrixWorld).invert()),Rh=Ie(n=>n.renderer.overrideNodes.modelViewMatrix||_P).once()().toVar("modelViewMatrix"),_P=fo.mul(Jo),Nx=Ie(n=>(n.context.isHighPrecisionModelViewMatrix=!0,jt("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),Px=Ie(n=>{const e=n.context.isHighPrecisionModelViewMatrix;return jt("mat3").onObjectUpdate(({object:t,camera:i})=>(e!==!0&&t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),Fp=uu("position","vec3"),lr=Fp.toVarying("positionLocal"),u2=Fp.toVarying("positionPrevious"),Kl=Jo.mul(lr).xyz.toVarying("v_positionWorld").context({needsPositionReassign:!0}),Qb=lr.transformDirection(Jo).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection").context({needsPositionReassign:!0}),gr=Ie(n=>n.context.setupPositionView(),"vec3").once()().toVarying("v_positionView").context({needsPositionReassign:!0}),Vi=gr.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class Yie extends en{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:t,material:i}=e;return t.coordinateSystem===zs&&i.side===wi?"false":e.getFrontFacing()}}const vP=Et(Yie),Up=oe(vP).mul(2).sub(1),o_=uu("normal","vec3"),ho=Ie(n=>n.geometry.hasAttribute("normal")===!1?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),Ce(0,1,0)):o_,"vec3").once()().toVar("normalLocal"),yP=gr.dFdx().cross(gr.dFdy()).normalize().toVar("normalFlat"),la=Ie(n=>{let e;return n.material.flatShading===!0?e=yP:e=ko(Yb(ho),"v_normalView").normalize(),e},"vec3").once()().toVar("normalView"),a_=Ie(n=>{let e=la.transformDirection(fo);return n.material.flatShading!==!0&&(e=ko(e,"v_normalWorld")),e},"vec3").once()().normalize().toVar("normalWorld"),or=Ie(n=>{let e=n.context.setupNormal().context({getUV:null});return n.material.flatShading!==!0&&(e=e.mul(Up)),e},"vec3").once()().toVar("transformedNormalView"),l_=or.transformDirection(fo).toVar("transformedNormalWorld"),Ff=Ie(n=>{let e=n.context.setupClearcoatNormal().context({getUV:null});return n.material.flatShading!==!0&&(e=e.mul(Up)),e},"vec3").once()().toVar("transformedClearcoatNormalView"),xP=Ie(([n,e=Jo])=>{const t=Ts(e),i=n.div(Ce(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(i).xyz}),Yb=Ie(([n],e)=>{const t=e.renderer.overrideNodes.modelNormalViewMatrix;if(t!==null)return t.transformDirection(n);const i=gP.mul(n);return fo.transformDirection(i)}),cw=new jr,rv=new on,bP=jt(0).onReference(({material:n})=>n).onObjectUpdate(({material:n})=>n.refractionRatio),Z1=jt(1).onReference(({material:n})=>n).onObjectUpdate(function({material:n,scene:e}){return n.envMap?n.envMapIntensity:e.environmentIntensity}),Zb=jt(new on).onReference(function(n){return n.material}).onObjectUpdate(function({material:n,scene:e}){const t=e.environment!==null&&n.envMap===null?e.environmentRotation:n.envMapRotation;return t?(cw.copy(t),rv.makeRotationFromEuler(cw)):rv.identity(),rv}),TP=Vi.negate().reflect(or),SP=Vi.negate().refract(or,bP),wP=TP.transformDirection(fo).toVar("reflectVector"),MP=SP.transformDirection(fo).toVar("reflectVector");class Zie extends gl{static get type(){return"CubeTextureNode"}constructor(e,t=null,i=null,r=null){super(e,t,i,r),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===Pa?wP:e.mapping===La?MP:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Ce(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const i=this.value;return(e.renderer.coordinateSystem===Al||!i.isRenderTargetTexture)&&(t=Ce(t.x.negate(),t.yz)),Zb.mul(t)}generateUV(e,t){return t.build(e,"vec3")}}const LA=at(Zie).setParameterLength(1,4).setName("cubeTexture");class Kie extends Eh{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),i=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,i,r)}}class u_ extends en{static get type(){return"ReferenceNode"}constructor(e,t,i=null,r=null){super(),this.property=e,this.uniformType=t,this.object=i,this.count=r,this.properties=e.split("."),this.reference=i,this.node=null,this.group=null,this.name=null,this.updateType=Sn.OBJECT}element(e){return tt(new Kie(this,tt(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let t=null;this.count!==null?t=Ip(null,e,this.count):Array.isArray(this.getValueFromReference())?t=Zo(null,e):e==="texture"?t=Vn(null):e==="cubeTexture"?t=LA(null):t=jt(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.label(this.name),this.node=t.getSelf()}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let i=e[t[0]];for(let r=1;r<t.length;r++)i=i[t[r]];return i}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const xi=(n,e,t)=>tt(new u_(n,e,t)),Lx=(n,e,t,i)=>tt(new u_(n,e,i,t));class Jie extends u_{static get type(){return"MaterialReferenceNode"}constructor(e,t,i=null){super(e,t,i),this.material=i,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const Hl=(n,e,t=null)=>tt(new Jie(n,e,t)),c_=Ie(n=>(n.geometry.hasAttribute("tangent")===!1&&n.geometry.computeTangents(),uu("tangent","vec4")))(),Op=c_.xyz.toVar("tangentLocal"),kp=Rh.mul(Xt(Op,0)).xyz.toVarying("v_tangentView").normalize().toVar("tangentView"),EP=kp.transformDirection(fo).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),Kb=kp.toVar("transformedTangentView"),ere=Kb.transformDirection(fo).normalize().toVar("transformedTangentWorld"),Vp=Ie(([n,e],t)=>{let i=n.mul(c_.w).xyz;return t.material.flatShading!==!0&&(i=ko(n,e)),i}).once(),tre=Vp(o_.cross(c_),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),nre=Vp(ho.cross(Op),"v_bitangentLocal").normalize().toVar("bitangentLocal"),CP=Vp(la.cross(kp),"v_bitangentView").normalize().toVar("bitangentView"),ire=Vp(a_.cross(EP),"v_bitangentWorld").normalize().toVar("bitangentWorld"),RP=Vp(or.cross(Kb),"v_transformedBitangentView").normalize().toVar("transformedBitangentView"),rre=RP.transformDirection(fo).normalize().toVar("transformedBitangentWorld"),Yc=Ts(kp,CP,la),NP=Vi.mul(Yc),sre=(n,e)=>n.sub(NP.mul(e)),PP=(()=>{let n=sh.cross(Vi);return n=n.cross(sh).normalize(),n=li(n,or,Ou.mul(tl.oneMinus()).oneMinus().pow2().pow2()).normalize(),n})(),ore=Ie(n=>{const{eye_pos:e,surf_norm:t,mapN:i,uv:r}=n,s=e.dFdx(),o=e.dFdy(),a=r.dFdx(),l=r.dFdy(),u=t,A=o.cross(u),p=u.cross(s),g=A.mul(a.x).add(p.mul(l.x)),v=A.mul(a.y).add(p.mul(l.y)),y=g.dot(g).max(v.dot(v)),b=Up.mul(y.inverseSqrt());return vr(g.mul(i.x,b),v.mul(i.y,b),u.mul(i.z)).normalize()});class are extends fr{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=Jl}setup(e){const{normalMapType:t,scaleNode:i}=this;let r=this.node.mul(2).sub(1);i!==null&&(r=Ce(r.xy.mul(i),r.z));let s=null;return t===x9?s=Yb(r):t===Jl&&(e.hasGeometryAttribute("tangent")===!0?s=Yc.mul(r).normalize():s=ore({eye_pos:gr,surf_norm:la,mapN:r,uv:Wi()})),s}}const Dx=at(are).setParameterLength(1,2),lre=Ie(({textureNode:n,bumpScale:e})=>{const t=r=>n.cache().context({getUV:s=>r(s.uvNode||Wi()),forceUVContext:!0}),i=oe(t(r=>r));return ut(oe(t(r=>r.add(r.dFdx()))).sub(i),oe(t(r=>r.add(r.dFdy()))).sub(i)).mul(e)}),ure=Ie(n=>{const{surf_pos:e,surf_norm:t,dHdxy:i}=n,r=e.dFdx().normalize(),s=e.dFdy().normalize(),o=t,a=s.cross(o),l=o.cross(r),u=r.dot(a).mul(Up),A=u.sign().mul(i.x.mul(a).add(i.y.mul(l)));return u.abs().mul(t).sub(A).normalize()});class cre extends fr{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=lre({textureNode:this.textureNode,bumpScale:e});return ure({surf_pos:gr,surf_norm:la,dHdxy:t})}}const LP=at(cre).setParameterLength(1,2),hw=new Map;class Je extends en{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let i=hw.get(e);return i===void 0&&(i=Hl(e,t),hw.set(e,i)),i}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,i=this.scope;let r=null;if(i===Je.COLOR){const s=t.color!==void 0?this.getColor(i):Ce();t.map&&t.map.isTexture===!0?r=s.mul(this.getTexture("map")):r=s}else if(i===Je.OPACITY){const s=this.getFloat(i);t.alphaMap&&t.alphaMap.isTexture===!0?r=s.mul(this.getTexture("alpha")):r=s}else if(i===Je.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?r=this.getTexture("specular").r:r=oe(1);else if(i===Je.SPECULAR_INTENSITY){const s=this.getFloat(i);t.specularIntensityMap&&t.specularIntensityMap.isTexture===!0?r=s.mul(this.getTexture(i).a):r=s}else if(i===Je.SPECULAR_COLOR){const s=this.getColor(i);t.specularColorMap&&t.specularColorMap.isTexture===!0?r=s.mul(this.getTexture(i).rgb):r=s}else if(i===Je.ROUGHNESS){const s=this.getFloat(i);t.roughnessMap&&t.roughnessMap.isTexture===!0?r=s.mul(this.getTexture(i).g):r=s}else if(i===Je.METALNESS){const s=this.getFloat(i);t.metalnessMap&&t.metalnessMap.isTexture===!0?r=s.mul(this.getTexture(i).b):r=s}else if(i===Je.EMISSIVE){const s=this.getFloat("emissiveIntensity"),o=this.getColor(i).mul(s);t.emissiveMap&&t.emissiveMap.isTexture===!0?r=o.mul(this.getTexture(i)):r=o}else if(i===Je.NORMAL)t.normalMap?(r=Dx(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType):t.bumpMap?r=LP(this.getTexture("bump").r,this.getFloat("bumpScale")):r=la;else if(i===Je.CLEARCOAT){const s=this.getFloat(i);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?r=s.mul(this.getTexture(i).r):r=s}else if(i===Je.CLEARCOAT_ROUGHNESS){const s=this.getFloat(i);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(i).r):r=s}else if(i===Je.CLEARCOAT_NORMAL)t.clearcoatNormalMap?r=Dx(this.getTexture(i),this.getCache(i+"Scale","vec2")):r=la;else if(i===Je.SHEEN){const s=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?r=s.mul(this.getTexture("sheenColor").rgb):r=s}else if(i===Je.SHEEN_ROUGHNESS){const s=this.getFloat(i);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(i).a):r=s,r=r.clamp(.07,1)}else if(i===Je.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const s=this.getTexture(i);r=Q2(wf.x,wf.y,wf.y.negate(),wf.x).mul(s.rg.mul(2).sub(ut(1)).normalize().mul(s.b))}else r=wf;else if(i===Je.IRIDESCENCE_THICKNESS){const s=xi("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const o=xi("0","float",t.iridescenceThicknessRange);r=s.sub(o).mul(this.getTexture(i).g).add(o)}else r=s}else if(i===Je.TRANSMISSION){const s=this.getFloat(i);t.transmissionMap?r=s.mul(this.getTexture(i).r):r=s}else if(i===Je.THICKNESS){const s=this.getFloat(i);t.thicknessMap?r=s.mul(this.getTexture(i).g):r=s}else if(i===Je.IOR)r=this.getFloat(i);else if(i===Je.LIGHT_MAP)r=this.getTexture(i).rgb.mul(this.getFloat("lightMapIntensity"));else if(i===Je.AO)r=this.getTexture(i).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else{const s=this.getNodeType(e);r=this.getCache(i,s)}return r}}Je.ALPHA_TEST="alphaTest";Je.COLOR="color";Je.OPACITY="opacity";Je.SHININESS="shininess";Je.SPECULAR="specular";Je.SPECULAR_STRENGTH="specularStrength";Je.SPECULAR_INTENSITY="specularIntensity";Je.SPECULAR_COLOR="specularColor";Je.REFLECTIVITY="reflectivity";Je.ROUGHNESS="roughness";Je.METALNESS="metalness";Je.NORMAL="normal";Je.CLEARCOAT="clearcoat";Je.CLEARCOAT_ROUGHNESS="clearcoatRoughness";Je.CLEARCOAT_NORMAL="clearcoatNormal";Je.EMISSIVE="emissive";Je.ROTATION="rotation";Je.SHEEN="sheen";Je.SHEEN_ROUGHNESS="sheenRoughness";Je.ANISOTROPY="anisotropy";Je.IRIDESCENCE="iridescence";Je.IRIDESCENCE_IOR="iridescenceIOR";Je.IRIDESCENCE_THICKNESS="iridescenceThickness";Je.IOR="ior";Je.TRANSMISSION="transmission";Je.THICKNESS="thickness";Je.ATTENUATION_DISTANCE="attenuationDistance";Je.ATTENUATION_COLOR="attenuationColor";Je.LINE_SCALE="scale";Je.LINE_DASH_SIZE="dashSize";Je.LINE_GAP_SIZE="gapSize";Je.LINE_WIDTH="linewidth";Je.LINE_DASH_OFFSET="dashOffset";Je.POINT_SIZE="size";Je.DISPERSION="dispersion";Je.LIGHT_MAP="light";Je.AO="ao";const DP=Et(Je,Je.ALPHA_TEST),IP=Et(Je,Je.COLOR),BP=Et(Je,Je.SHININESS),FP=Et(Je,Je.EMISSIVE),Jb=Et(Je,Je.OPACITY),UP=Et(Je,Je.SPECULAR),Ix=Et(Je,Je.SPECULAR_INTENSITY),OP=Et(Je,Je.SPECULAR_COLOR),hd=Et(Je,Je.SPECULAR_STRENGTH),K1=Et(Je,Je.REFLECTIVITY),kP=Et(Je,Je.ROUGHNESS),VP=Et(Je,Je.METALNESS),zP=Et(Je,Je.NORMAL),qP=Et(Je,Je.CLEARCOAT),GP=Et(Je,Je.CLEARCOAT_ROUGHNESS),HP=Et(Je,Je.CLEARCOAT_NORMAL),WP=Et(Je,Je.ROTATION),$P=Et(Je,Je.SHEEN),jP=Et(Je,Je.SHEEN_ROUGHNESS),XP=Et(Je,Je.ANISOTROPY),QP=Et(Je,Je.IRIDESCENCE),YP=Et(Je,Je.IRIDESCENCE_IOR),ZP=Et(Je,Je.IRIDESCENCE_THICKNESS),KP=Et(Je,Je.TRANSMISSION),JP=Et(Je,Je.THICKNESS),eL=Et(Je,Je.IOR),tL=Et(Je,Je.ATTENUATION_DISTANCE),nL=Et(Je,Je.ATTENUATION_COLOR),iL=Et(Je,Je.LINE_SCALE),rL=Et(Je,Je.LINE_DASH_SIZE),sL=Et(Je,Je.LINE_GAP_SIZE),hre=Et(Je,Je.LINE_WIDTH),oL=Et(Je,Je.LINE_DASH_OFFSET),aL=Et(Je,Je.POINT_SIZE),lL=Et(Je,Je.DISPERSION),e5=Et(Je,Je.LIGHT_MAP),uL=Et(Je,Je.AO),wf=jt(new rt).onReference(function(n){return n.material}).onRenderUpdate(function({material:n}){this.value.set(n.anisotropy*Math.cos(n.anisotropyRotation),n.anisotropy*Math.sin(n.anisotropyRotation))}),t5=Ie(n=>n.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class zi extends en{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),i=this.scope;let r;if(i===zi.VERTEX)r=e.getVertexIndex();else if(i===zi.INSTANCE)r=e.getInstanceIndex();else if(i===zi.DRAW)r=e.getDrawIndex();else if(i===zi.INVOCATION_LOCAL)r=e.getInvocationLocalIndex();else if(i===zi.INVOCATION_SUBGROUP)r=e.getInvocationSubgroupIndex();else if(i===zi.SUBGROUP)r=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+i);let s;return e.shaderStage==="vertex"||e.shaderStage==="compute"?s=r:s=ko(this).build(e,t),s}}zi.VERTEX="vertex";zi.INSTANCE="instance";zi.SUBGROUP="subgroup";zi.INVOCATION_LOCAL="invocationLocal";zi.INVOCATION_SUBGROUP="invocationSubgroup";zi.DRAW="draw";const cL=Et(zi,zi.VERTEX),Yu=Et(zi,zi.INSTANCE),fre=Et(zi,zi.SUBGROUP),Are=Et(zi,zi.INVOCATION_SUBGROUP),dre=Et(zi,zi.INVOCATION_LOCAL),hL=Et(zi,zi.DRAW);class fL extends en{static get type(){return"InstanceNode"}constructor(e,t,i=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=i,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=Sn.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{count:t,instanceMatrix:i,instanceColor:r}=this;let{instanceMatrixNode:s,instanceColorNode:o}=this;if(s===null){if(t<=1e3)s=Ip(i.array,"mat4",Math.max(t,1)).element(Yu);else{const l=new xg(i.array,16,1);this.buffer=l;const u=i.usage===Cf?Rx:l2,A=[u(l,"vec4",16,0),u(l,"vec4",16,4),u(l,"vec4",16,8),u(l,"vec4",16,12)];s=rh(...A)}this.instanceMatrixNode=s}if(r&&o===null){const l=new Xu(r.array,3),u=r.usage===Cf?Rx:l2;this.bufferColor=l,o=Ce(u(l,"vec3",3,0)),this.instanceColorNode=o}const a=s.mul(lr).xyz;if(lr.assign(a),e.hasGeometryAttribute("normal")){const l=xP(ho,s);ho.assign(l)}this.instanceColorNode!==null&&sp("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==Cf&&this.buffer!==null&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==Cf&&this.bufferColor!==null&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}const pre=at(fL).setParameterLength(2,3);class mre extends fL{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:i,instanceColor:r}=e;super(t,i,r),this.instancedMesh=e}}const AL=at(mre).setParameterLength(1);class gre extends en{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=Yu:this.batchingIdNode=hL);const i=Ie(([y])=>{const b=_e(Qu(ir(this.batchMesh._indirectTexture),0).x),w=_e(y).mod(b),S=_e(y).div(b);return ir(this.batchMesh._indirectTexture,Pr(w,S)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(_e(this.batchingIdNode)),r=this.batchMesh._matricesTexture,s=_e(Qu(ir(r),0).x),o=oe(i).mul(4).toInt().toVar(),a=o.mod(s),l=o.div(s),u=rh(ir(r,Pr(a,l)),ir(r,Pr(a.add(1),l)),ir(r,Pr(a.add(2),l)),ir(r,Pr(a.add(3),l))),A=this.batchMesh._colorsTexture;if(A!==null){const b=Ie(([w])=>{const S=_e(Qu(ir(A),0).x),C=w,E=C.mod(S),R=C.div(S);return ir(A,Pr(E,R)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(i);sp("vec3","vBatchColor").assign(b)}const p=Ts(u);lr.assign(u.mul(lr));const g=ho.div(Ce(p[0].dot(p[0]),p[1].dot(p[1]),p[2].dot(p[2]))),v=p.mul(g).xyz;ho.assign(v),e.hasGeometryAttribute("tangent")&&Op.mulAssign(p)}}const dL=at(gre).setParameterLength(1);class _re extends Eh{static get type(){return"StorageArrayElementNode"}constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,t){const i=this.storageBufferNode.structTypeNode;return i?i.getMemberType(e,t):"void"}setup(e){return e.isAvailable("storageBuffer")===!1&&this.node.isPBO===!0&&e.setupPBO(this.node),super.setup(e)}generate(e,t){let i;const r=e.context.assign;if(e.isAvailable("storageBuffer")===!1?this.node.isPBO===!0&&r!==!0&&(this.node.value.isInstancedBufferAttribute||e.shaderStage!=="compute")?i=e.generatePBO(this):i=this.node.build(e):i=super.generate(e),r!==!0){const s=this.getNodeType(e);i=e.format(i,s,t)}return i}}const vre=at(_re).setParameterLength(2);class yre extends Xb{static get type(){return"StorageBufferNode"}constructor(e,t=null,i=0){let r,s=null;t&&t.isStruct?(r="struct",s=t.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(i=e.count)):t===null&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(r=bR(e.itemSize),i=e.count):r=t,super(e,r,i),this.isStorageBufferNode=!0,this.structTypeNode=s,this.access=ys.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,e.isStorageBufferAttribute!==!0&&e.isStorageInstancedBufferAttribute!==!0&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(this.bufferCount===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return vre(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess(ys.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return this._attribute===null&&(this._attribute=Dp(this.value),this._varying=ko(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(this.structTypeNode!==null)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);const{attribute:t}=this.getAttributeData();return t.getNodeType(e)}generate(e){if(this.structTypeNode!==null&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);const{attribute:t,varying:i}=this.getAttributeData(),r=i.build(e);return e.registerTransform(r,t),r}}const oh=(n,e=null,t=0)=>tt(new yre(n,e,t)),xre=(n,e,t)=>(console.warn('THREE.TSL: "storageObject()" is deprecated. Use "storage().setPBO( true )" instead.'),oh(n,e,t).setPBO(!0)),fw=new WeakMap;class pL extends en{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=Sn.OBJECT,this.skinIndexNode=uu("skinIndex","uvec4"),this.skinWeightNode=uu("skinWeight","vec4"),this.bindMatrixNode=xi("bindMatrix","mat4"),this.bindMatrixInverseNode=xi("bindMatrixInverse","mat4"),this.boneMatricesNode=Lx("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=lr,this.toPositionNode=lr,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:i,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:o}=this,a=e.element(i.x),l=e.element(i.y),u=e.element(i.z),A=e.element(i.w),p=s.mul(t),g=vr(a.mul(r.x).mul(p),l.mul(r.y).mul(p),u.mul(r.z).mul(p),A.mul(r.w).mul(p));return o.mul(g).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=ho){const{skinIndexNode:i,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:o}=this,a=e.element(i.x),l=e.element(i.y),u=e.element(i.z),A=e.element(i.w);let p=vr(r.x.mul(a),r.y.mul(l),r.z.mul(u),r.w.mul(A));return p=o.mul(p).mul(s),p.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=Lx("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,u2)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||SR(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&u2.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const i=this.getSkinnedNormal();ho.assign(i),e.hasGeometryAttribute("tangent")&&Op.assign(i)}return t}generate(e,t){if(t!=="void")return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;fw.get(t)!==e.frameId&&(fw.set(t,e.frameId),this.previousBoneMatricesNode!==null&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}const mL=n=>tt(new pL(n)),bre=(n,e=null)=>{const t=new pL(n);return t.positionNode=oh(new Xu(n.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(Yu).toVar(),t.skinIndexNode=oh(new Xu(new Uint32Array(n.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(Yu).toVar(),t.skinWeightNode=oh(new Xu(n.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(Yu).toVar(),t.bindMatrixNode=jt(n.bindMatrix,"mat4"),t.bindMatrixInverseNode=jt(n.bindMatrixInverse,"mat4"),t.boneMatricesNode=Ip(n.skeleton.boneMatrices,"mat4",n.skeleton.bones.length),t.toPositionNode=e,tt(t)};class Tre extends en{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const i={};for(let o=0,a=this.params.length-1;o<a;o++){const l=this.params[o],u=l.isNode!==!0&&l.name||this.getVarName(o),A=l.isNode!==!0&&l.type||"int";i[u]=lu(u,A)}const r=e.addStack();t.returnsNode=this.params[this.params.length-1](i,e),t.stackNode=r;const s=this.params[0];return s.isNode!==!0&&typeof s.update=="function"&&(t.updateNode=Ie(this.params[0].update)(i)),e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),i=this.params,r=t.stackNode;for(let a=0,l=i.length-1;a<l;a++){const u=i[a];let A=!1,p=null,g=null,v=null,y=null,b=null,w=null;u.isNode?u.getNodeType(e)==="bool"?(A=!0,y="bool",g=u.build(e,y)):(y="int",v=this.getVarName(a),p="0",g=u.build(e,y),b="<"):(y=u.type||"int",v=u.name||this.getVarName(a),p=u.start,g=u.end,b=u.condition,w=u.update,typeof p=="number"?p=e.generateConst(y,p):p&&p.isNode&&(p=p.build(e,y)),typeof g=="number"?g=e.generateConst(y,g):g&&g.isNode&&(g=g.build(e,y)),p!==void 0&&g===void 0?(p=p+" - 1",g="0",b=">="):g!==void 0&&p===void 0&&(p="0",b="<"),b===void 0&&(Number(p)>Number(g)?b=">=":b="<"));let S;if(A)S=`while ( ${g} )`;else{const C={start:p,end:g},E=C.start,R=C.end;let D;const B=()=>b.includes("<")?"+=":"-=";if(w!=null)switch(typeof w){case"function":D=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":D=v+" "+B()+" "+e.generateConst(y,w);break;case"string":D=v+" "+w;break;default:w.isNode?D=v+" "+B()+" "+w.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),D="break /* invalid update */")}else y==="int"||y==="uint"?w=b.includes("<")?"++":"--":w=B()+" 1.",D=v+" "+w;const L=e.getVar(y,v)+" = "+E,U=v+" "+b+" "+R;S=`for ( ${L}; ${U}; ${D} )`}e.addFlowCode((a===0?`
`:"")+e.tab+S+` {

`).addFlowTab()}const s=r.build(e,"void"),o=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+s);for(let a=0,l=this.params.length-1;a<l;a++)e.addFlowCode((a===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),o}}const ui=(...n)=>tt(new Tre(ih(n,"int"))).toStack(),Sre=()=>lu("continue").toStack(),gL=()=>lu("break").toStack(),wre=(...n)=>(console.warn("THREE.TSL: loop() has been renamed to Loop()."),ui(...n)),sv=new WeakMap,bo=new Kt,Aw=Ie(({bufferMap:n,influence:e,stride:t,width:i,depth:r,offset:s})=>{const o=_e(cL).mul(t).add(s),a=o.div(i),l=o.sub(a.mul(i));return ir(n,Pr(l,a)).depth(r).xyz.mul(e)});function Mre(n){const e=n.morphAttributes.position!==void 0,t=n.morphAttributes.normal!==void 0,i=n.morphAttributes.color!==void 0,r=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,s=r!==void 0?r.length:0;let o=sv.get(n);if(o===void 0||o.count!==s){let C=function(){w.dispose(),sv.delete(n),n.removeEventListener("dispose",C)};var a=C;o!==void 0&&o.texture.dispose();const l=n.morphAttributes.position||[],u=n.morphAttributes.normal||[],A=n.morphAttributes.color||[];let p=0;e===!0&&(p=1),t===!0&&(p=2),i===!0&&(p=3);let g=n.attributes.position.count*p,v=1;const y=4096;g>y&&(v=Math.ceil(g/y),g=y);const b=new Float32Array(g*v*4*s),w=new D2(b,g,v,s);w.type=mr,w.needsUpdate=!0;const S=p*4;for(let E=0;E<s;E++){const R=l[E],D=u[E],B=A[E],L=g*v*4*E;for(let U=0;U<R.count;U++){const P=U*S;e===!0&&(bo.fromBufferAttribute(R,U),b[L+P+0]=bo.x,b[L+P+1]=bo.y,b[L+P+2]=bo.z,b[L+P+3]=0),t===!0&&(bo.fromBufferAttribute(D,U),b[L+P+4]=bo.x,b[L+P+5]=bo.y,b[L+P+6]=bo.z,b[L+P+7]=0),i===!0&&(bo.fromBufferAttribute(B,U),b[L+P+8]=bo.x,b[L+P+9]=bo.y,b[L+P+10]=bo.z,b[L+P+11]=B.itemSize===4?bo.w:1)}}o={count:s,texture:w,stride:p,size:new rt(g,v)},sv.set(n,o),n.addEventListener("dispose",C)}return o}class Ere extends en{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=jt(1),this.updateType=Sn.OBJECT}setup(e){const{geometry:t}=e,i=t.morphAttributes.position!==void 0,r=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,s=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,o=s!==void 0?s.length:0,{texture:a,stride:l,size:u}=Mre(t);i===!0&&lr.mulAssign(this.morphBaseInfluence),r===!0&&ho.mulAssign(this.morphBaseInfluence);const A=_e(u.width);ui(o,({i:p})=>{const g=oe(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?g.assign(ir(this.mesh.morphTexture,Pr(_e(p).add(1),_e(Yu))).r):g.assign(xi("morphTargetInfluences","float").element(p).toVar()),Cn(g.notEqual(0),()=>{i===!0&&lr.addAssign(Aw({bufferMap:a,influence:g,stride:l,width:A,depth:p,offset:_e(0)})),r===!0&&ho.addAssign(Aw({bufferMap:a,influence:g,stride:l,width:A,depth:p,offset:_e(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,i)=>t+i,0)}}const _L=at(Ere).setParameterLength(1);class $A extends en{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class Cre extends $A{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class Rre extends qN{static get type(){return"LightingContextNode"}constructor(e,t=null,i=null,r=null){super(e),this.lightingModel=t,this.backdropNode=i,this.backdropAlphaNode=r,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,i=Ce().toVar("directDiffuse"),r=Ce().toVar("directSpecular"),s=Ce().toVar("indirectDiffuse"),o=Ce().toVar("indirectSpecular"),a={directDiffuse:i,directSpecular:r,indirectDiffuse:s,indirectSpecular:o};return{radiance:Ce().toVar("radiance"),irradiance:Ce().toVar("irradiance"),iblIrradiance:Ce().toVar("iblIrradiance"),ambientOcclusion:oe(1).toVar("ambientOcclusion"),reflectedLight:a,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const vL=at(Rre);class Nre extends $A{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}let v0,y0;class Mr extends en{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===Mr.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=Sn.NONE;return(this.scope===Mr.SIZE||this.scope===Mr.VIEWPORT)&&(e=Sn.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===Mr.VIEWPORT?t!==null?y0.copy(t.viewport):(e.getViewport(y0),y0.multiplyScalar(e.getPixelRatio())):t!==null?(v0.width=t.width,v0.height=t.height):e.getDrawingBufferSize(v0)}setup(){const e=this.scope;let t=null;return e===Mr.SIZE?t=jt(v0||(v0=new rt)):e===Mr.VIEWPORT?t=jt(y0||(y0=new Kt)):t=ut(zp.div(cp)),t}generate(e){if(this.scope===Mr.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const i=e.getNodeProperties(cp).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${i}.y - ${t}.y )`}return t}return super.generate(e)}}Mr.COORDINATE="coordinate";Mr.VIEWPORT="viewport";Mr.SIZE="size";Mr.UV="uv";const Ca=Et(Mr,Mr.UV),cp=Et(Mr,Mr.SIZE),zp=Et(Mr,Mr.COORDINATE),eA=Et(Mr,Mr.VIEWPORT),yL=eA.zw,xL=zp.sub(eA.xy),Pre=xL.div(yL),Lre=Ie(()=>(console.warn('THREE.TSL: "viewportResolution" is deprecated. Use "screenSize" instead.'),cp),"vec2").once()(),Dre=Ie(()=>(console.warn('THREE.TSL: "viewportTopLeft" is deprecated. Use "screenUV" instead.'),Ca),"vec2").once()(),Ire=Ie(()=>(console.warn('THREE.TSL: "viewportBottomLeft" is deprecated. Use "screenUV.flipY()" instead.'),Ca.flipY()),"vec2").once()(),x0=new rt;class h_ extends gl{static get type(){return"ViewportTextureNode"}constructor(e=Ca,t=null,i=null){i===null&&(i=new P9,i.minFilter=to),super(i,e,t),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=Sn.FRAME}updateBefore(e){const t=e.renderer;t.getDrawingBufferSize(x0);const i=this.value;(i.image.width!==x0.width||i.image.height!==x0.height)&&(i.image.width=x0.width,i.image.height=x0.height,i.needsUpdate=!0);const r=i.generateMipmaps;i.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(i),i.generateMipmaps=r}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const Bre=at(h_).setParameterLength(0,3),n5=at(h_,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let ov=null;class Fre extends h_{static get type(){return"ViewportDepthTextureNode"}constructor(e=Ca,t=null){ov===null&&(ov=new lo),super(e,t,ov)}}const i5=at(Fre).setParameterLength(0,2);class ro extends en{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===ro.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,i=this.valueNode;let r=null;if(t===ro.DEPTH_BASE)i!==null&&(r=TL().assign(i));else if(t===ro.DEPTH)e.isPerspectiveCamera?r=bL(gr.z,Vu,zu):r=tA(gr.z,Vu,zu);else if(t===ro.LINEAR_DEPTH)if(i!==null)if(e.isPerspectiveCamera){const s=r5(i,Vu,zu);r=tA(s,Vu,zu)}else r=i;else r=tA(gr.z,Vu,zu);return r}}ro.DEPTH_BASE="depthBase";ro.DEPTH="depth";ro.LINEAR_DEPTH="linearDepth";const tA=(n,e,t)=>n.add(e).div(e.sub(t)),Ure=(n,e,t)=>e.sub(t).mul(n).sub(e),bL=(n,e,t)=>e.add(n).mul(t).div(t.sub(e).mul(n)),r5=(n,e,t)=>e.mul(t).div(t.sub(e).mul(n).sub(t)),s5=(n,e,t)=>{e=e.max(1e-6).toVar();const i=ll(n.negate().div(e)),r=ll(t.div(e));return i.div(r)},Ore=(n,e,t)=>{const i=n.mul(J2(t.div(e)));return oe(Math.E).pow(i).mul(e).negate()},TL=at(ro,ro.DEPTH_BASE),o5=Et(ro,ro.DEPTH),c2=at(ro,ro.LINEAR_DEPTH).setParameterLength(0,1),kre=c2(i5());o5.assign=n=>TL(n);class ia extends en{static get type(){return"ClippingNode"}constructor(e=ia.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:i,unionPlanes:r}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===ia.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(i,r):this.scope===ia.HARDWARE?this.setupHardwareClipping(r,e):this.setupDefault(i,r)}setupAlphaToCoverage(e,t){return Ie(()=>{const i=oe().toVar("distanceToPlane"),r=oe().toVar("distanceToGradient"),s=oe(1).toVar("clipOpacity"),o=t.length;if(this.hardwareClipping===!1&&o>0){const l=Zo(t);ui(o,({i:u})=>{const A=l.element(u);i.assign(gr.dot(A.xyz).negate().add(A.w)),r.assign(i.fwidth().div(2)),s.mulAssign(ml(r.negate(),r,i))})}const a=e.length;if(a>0){const l=Zo(e),u=oe(1).toVar("intersectionClipOpacity");ui(a,({i:A})=>{const p=l.element(A);i.assign(gr.dot(p.xyz).negate().add(p.w)),r.assign(i.fwidth().div(2)),u.mulAssign(ml(r.negate(),r,i).oneMinus())}),s.mulAssign(u.oneMinus())}ii.a.mulAssign(s),ii.a.equal(0).discard()})()}setupDefault(e,t){return Ie(()=>{const i=t.length;if(this.hardwareClipping===!1&&i>0){const s=Zo(t);ui(i,({i:o})=>{const a=s.element(o);gr.dot(a.xyz).greaterThan(a.w).discard()})}const r=e.length;if(r>0){const s=Zo(e),o=ou(!0).toVar("clipped");ui(r,({i:a})=>{const l=s.element(a);o.assign(gr.dot(l.xyz).greaterThan(l.w).and(o))}),o.discard()}})()}setupHardwareClipping(e,t){const i=e.length;return t.enableHardwareClipping(i),Ie(()=>{const r=Zo(e),s=Bp(t.getClipDistance());ui(i,({i:o})=>{const a=r.element(o),l=gr.dot(a.xyz).sub(a.w).negate();s.element(o).assign(l)})})()}}ia.ALPHA_TO_COVERAGE="alphaToCoverage";ia.DEFAULT="default";ia.HARDWARE="hardware";const Vre=()=>tt(new ia),zre=()=>tt(new ia(ia.ALPHA_TO_COVERAGE)),qre=()=>tt(new ia(ia.HARDWARE)),Gre=.05,dw=Ie(([n])=>Au(wn(1e4,No(wn(17,n.x).add(wn(.1,n.y)))).mul(vr(.1,Pi(No(wn(13,n.y).add(n.x))))))),pw=Ie(([n])=>dw(ut(dw(n.xy),n.z))),Hre=Ie(([n])=>{const e=hr(Zl(kb(n.xyz)),Zl(Vb(n.xyz))),t=oe(1).div(oe(Gre).mul(e)).toVar("pixScale"),i=ut(PA(ul(ll(t))),PA(e_(ll(t)))),r=ut(pw(ul(i.x.mul(n.xyz))),pw(ul(i.y.mul(n.xyz)))),s=Au(ll(t)),o=vr(wn(s.oneMinus(),r.x),wn(s,r.y)),a=co(s,s.oneMinus()),l=Ce(o.mul(o).div(wn(2,a).mul(Yn(1,a))),o.sub(wn(.5,a)).div(Yn(1,a)),Yn(1,Yn(1,o).mul(Yn(1,o)).div(wn(2,a).mul(Yn(1,a))))),u=o.lessThan(a.oneMinus()).select(o.lessThan(a).select(l.x,l.y),l.z);return pl(u,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class Wre extends fP{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e),i=e.hasGeometryAttribute(t);let r;return i===!0?r=super.generate(e):r=e.generateConst(this.nodeType,new Kt(1,1,1,1)),r}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const SL=(n=0)=>tt(new Wre(n));class yr extends bs{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+xR(this)}build(e){this.setup(e)}setupObserver(e){return new Lne(e)}setup(e){e.context.setupNormal=()=>this.setupNormal(e),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,i=t.getRenderTarget();e.addStack();const r=this.vertexNode||this.setupVertex(e);e.stack.outputNode=r,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let s;const o=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(i!==null?i.depthBuffer===!0&&this.setupDepth(e):t.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const a=this.setupLighting(e);o!==null&&e.stack.add(o);const l=Xt(a,ii.a).max(0);s=this.setupOutput(e,l),Jf.assign(s);const u=this.outputNode!==null;if(u&&(s=this.outputNode),i!==null){const A=t.getMRT(),p=this.mrtNode;A!==null?(u&&Jf.assign(s),s=A,p!==null&&(s=A.merge(p))):p!==null&&(s=p)}}else{let a=this.fragmentNode;a.isOutputStructNode!==!0&&(a=Xt(a)),s=this.setupOutput(e,a)}e.stack.outputNode=s,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:t,intersectionPlanes:i}=e.clippingContext;let r=null;if(t.length>0||i.length>0){const s=e.renderer.samples;this.alphaToCoverage&&s>1?r=zre():e.stack.add(Vre())}return r}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add(qre()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:i}=e;let r=this.depthNode;if(r===null){const s=t.getMRT();s&&s.has("depth")?r=s.get("depth"):t.logarithmicDepthBuffer===!0&&(i.isPerspectiveCamera?r=s5(gr.z,Vu,zu):r=tA(gr.z,Vu,zu))}r!==null&&o5.assign(r).toStack()}setupPositionView(){return Rh.mul(lr).xyz}setupModelViewProjection(){return Ch.mul(gr)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),t5}setupPosition(e){const{object:t,geometry:i}=e;if((i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color)&&_L(t).toStack(),t.isSkinnedMesh===!0&&mL(t).toStack(),this.displacementMap){const r=Hl("displacementMap","texture"),s=Hl("displacementScale","float"),o=Hl("displacementBias","float");lr.addAssign(ho.normalize().mul(r.x.mul(s).add(o)))}return t.isBatchedMesh&&dL(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&AL(t).toStack(),this.positionNode!==null&&lr.assign(this.positionNode.context({isPositionNodeInput:!0})),lr}setupDiffuseColor({object:e,geometry:t}){let i=this.colorNode?Xt(this.colorNode):IP;this.vertexColors===!0&&t.hasAttribute("color")&&(i=i.mul(SL())),e.instanceColor&&(i=sp("vec3","vInstanceColor").mul(i)),e.isBatchedMesh&&e._colorsTexture&&(i=sp("vec3","vBatchColor").mul(i)),ii.assign(i);const r=this.opacityNode?oe(this.opacityNode):Jb;if(ii.a.assign(ii.a.mul(r)),this.alphaTestNode!==null||this.alphaTest>0){const s=this.alphaTestNode!==null?oe(this.alphaTestNode):DP;ii.a.lessThanEqual(s).discard()}this.alphaHash===!0&&ii.a.lessThan(Hre(lr)).discard(),this.transparent===!1&&this.blending===Gs&&this.alphaToCoverage===!1&&ii.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?Ce(0):ii.rgb}setupNormal(){return this.normalNode?Ce(this.normalNode):zP}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?Hl("envMap","cubeTexture"):Hl("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new Nre(e5)),t}setupLights(e){const t=[],i=this.setupEnvironment(e);i&&i.isLightingNode&&t.push(i);const r=this.setupLightMap(e);if(r&&r.isLightingNode&&t.push(r),this.aoNode!==null||e.material.aoMap){const o=this.aoNode!==null?this.aoNode:uL;t.push(new Cre(o))}let s=this.lightsNode||e.lightsNode;return t.length>0&&(s=e.renderer.lighting.createNode([...s.getLights(),...t])),s}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:i,backdropAlphaNode:r,emissiveNode:s}=this,a=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let l=this.setupOutgoingLight(e);if(a&&a.getScope().hasLights){const u=this.setupLightingModel(e)||null;l=vL(a,u,i,r)}else i!==null&&(l=Ce(r!==null?li(l,i,r):i));return(s&&s.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(Ex.assign(Ce(s||FP)),l=l.add(Ex)),l}setupFog(e,t){const i=e.fogNode;return i&&(Jf.assign(t),t=Xt(i)),t}setupOutput(e,t){return this.fog===!0&&(t=this.setupFog(e,t)),t}setDefaultValues(e){for(const i in e){const r=e[i];this[i]===void 0&&(this[i]=r,r&&r.clone&&(this[i]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const i in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,i)===void 0&&t[i].get!==void 0&&Object.defineProperty(this.constructor.prototype,i,t[i])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const i=bs.prototype.toJSON.call(this,e),r=t2(this);i.inputNodes={};for(const{property:o,childNode:a}of r)i.inputNodes[o]=a.toJSON(e).uuid;function s(o){const a=[];for(const l in o){const u=o[l];delete u.metadata,a.push(u)}return a}if(t){const o=s(e.textures),a=s(e.images),l=s(e.nodes);o.length>0&&(i.textures=o),a.length>0&&(i.images=a),l.length>0&&(i.nodes=l)}return i}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const $re=new Sh;class jre extends yr{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues($re),this.setValues(e)}}const Xre=new IH;class Qre extends yr{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(Xre),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?oe(this.offsetNode):oL,t=this.dashScaleNode?oe(this.dashScaleNode):iL,i=this.dashSizeNode?oe(this.dashSizeNode):rL,r=this.gapSizeNode?oe(this.gapSizeNode):sL;X1.assign(i),Cx.assign(r);const s=ko(uu("lineDistance").mul(t));(e?s.add(e):s).mod(X1.add(Cx)).greaterThan(X1).discard()}}let av=null;class Yre extends h_{static get type(){return"ViewportSharedTextureNode"}constructor(e=Ca,t=null){av===null&&(av=new P9),super(e,t,av)}updateReference(){return this}}const Zre=at(Yre).setParameterLength(0,2),wL=n=>tt(n).mul(.5).add(.5),Kre=n=>tt(n).mul(2).sub(1),Jre=new NH;class ese extends yr{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(Jre),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?oe(this.opacityNode):Jb;ii.assign(r_(Xt(wL(or),e),Zt))}}class tse extends fr{static get type(){return"EquirectUVNode"}constructor(e=Qb){super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,t=e.z.atan(e.x).mul(1/(Math.PI*2)).add(.5),i=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return ut(t,i)}}const a5=at(tse).setParameterLength(0,1);class ML extends E9{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const i=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const s=new oc(5,5,5),o=a5(Qb),a=new yr;a.colorNode=Vn(t,o,0),a.side=wi,a.blending=Do;const l=new Jn(s,a),u=new zA;u.add(l),t.minFilter===to&&(t.minFilter=Lr);const A=new M9(1,10,this),p=e.getMRT();return e.setMRT(null),A.update(e,u),e.setMRT(p),t.minFilter=i,t.currentGenerateMipmaps=r,l.geometry.dispose(),l.material.dispose(),this}}const fd=new WeakMap;class nse extends fr{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=LA(null);const t=new I2;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=Sn.RENDER}updateBefore(e){const{renderer:t,material:i}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const s=r.isTextureNode?r.value:i[r.property];if(s&&s.isTexture){const o=s.mapping;if(o===ch||o===hh){if(fd.has(s)){const a=fd.get(s);mw(a,s.mapping),this._cubeTexture=a}else{const a=s.image;if(ise(a)){const l=new ML(a.height);l.fromEquirectangularTexture(t,s),mw(l.texture,s.mapping),this._cubeTexture=l.texture,fd.set(s,l.texture),s.addEventListener("dispose",EL)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function ise(n){return n==null?!1:n.height>0}function EL(n){const e=n.target;e.removeEventListener("dispose",EL);const t=fd.get(e);t!==void 0&&(fd.delete(e),t.dispose())}function mw(n,e){e===ch?n.mapping=Pa:e===hh&&(n.mapping=La)}const CL=at(nse).setParameterLength(1);class l5 extends $A{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=CL(this.envNode)}}class rse extends $A{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=oe(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class f_{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class RL extends f_{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,i=e.reflectedLight,r=e.irradianceLightMap;i.indirectDiffuse.assign(Xt(0)),r?i.indirectDiffuse.addAssign(r):i.indirectDiffuse.addAssign(Xt(1,1,1,0)),i.indirectDiffuse.mulAssign(t),i.indirectDiffuse.mulAssign(ii.rgb)}finish(e){const{material:t,context:i}=e,r=i.outgoingLight,s=e.context.environment;if(s)switch(t.combine){case _p:r.rgb.assign(li(r.rgb,r.rgb.mul(s.rgb),hd.mul(K1)));break;case A9:r.rgb.assign(li(r.rgb,s.rgb,hd.mul(K1)));break;case d9:r.rgb.addAssign(s.rgb.mul(hd.mul(K1)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",t.combine);break}}}const sse=new va;class ose extends yr{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(sse),this.setValues(e)}setupNormal(){return la}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new l5(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new rse(e5)),t}setupOutgoingLight(){return ii.rgb}setupLightingModel(){return new RL}}const DA=Ie(({f0:n,f90:e,dotVH:t})=>{const i=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return n.mul(i.oneMinus()).add(e.mul(i))}),bh=Ie(n=>n.diffuseColor.mul(1/Math.PI)),ase=()=>oe(.25),lse=Ie(({dotNH:n})=>s2.mul(oe(.5)).add(1).mul(oe(1/Math.PI)).mul(n.pow(s2))),use=Ie(({lightDirection:n})=>{const e=n.add(Vi).normalize(),t=or.dot(e).clamp(),i=Vi.dot(e).clamp(),r=DA({f0:Ys,f90:1,dotVH:i}),s=ase(),o=lse({dotNH:t});return r.mul(s).mul(o)});class NL extends RL{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:i}){const s=or.dot(e).clamp().mul(t);i.directDiffuse.addAssign(s.mul(bh({diffuseColor:ii.rgb}))),this.specular===!0&&i.directSpecular.addAssign(s.mul(use({lightDirection:e})).mul(hd))}indirect(e){const{ambientOcclusion:t,irradiance:i,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(i.mul(bh({diffuseColor:ii}))),r.indirectDiffuse.mulAssign(t)}}const cse=new Tl;class hse extends yr{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(cse),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new l5(t):null}setupLightingModel(){return new NL(!1)}}const fse=new vg;class Ase extends yr{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(fse),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new l5(t):null}setupLightingModel(){return new NL}setupVariants(){const e=(this.shininessNode?oe(this.shininessNode):BP).max(1e-4);s2.assign(e);const t=this.specularNode||UP;Ys.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const PL=Ie(n=>{if(n.geometry.hasAttribute("normal")===!1)return oe(0);const e=la.dFdx().abs().max(la.dFdy().abs());return e.x.max(e.y).max(e.z)}),u5=Ie(n=>{const{roughness:e}=n,t=PL();let i=e.max(.0525);return i=i.add(t),i=i.min(1),i}),LL=Ie(({alpha:n,dotNL:e,dotNV:t})=>{const i=n.pow2(),r=e.mul(i.add(i.oneMinus().mul(t.pow2())).sqrt()),s=t.mul(i.add(i.oneMinus().mul(e.pow2())).sqrt());return Da(.5,r.add(s).max(dN))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),dse=Ie(({alphaT:n,alphaB:e,dotTV:t,dotBV:i,dotTL:r,dotBL:s,dotNV:o,dotNL:a})=>{const l=a.mul(Ce(n.mul(t),e.mul(i),o).length()),u=o.mul(Ce(n.mul(r),e.mul(s),a).length());return Da(.5,l.add(u)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),DL=Ie(({alpha:n,dotNH:e})=>{const t=n.pow2(),i=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(i.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),pse=oe(1/Math.PI),mse=Ie(({alphaT:n,alphaB:e,dotNH:t,dotTH:i,dotBH:r})=>{const s=n.mul(e),o=Ce(e.mul(i),n.mul(r),s.mul(t)),a=o.dot(o),l=s.div(a);return pse.mul(s.mul(l.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),Bx=Ie(n=>{const{lightDirection:e,f0:t,f90:i,roughness:r,f:s,USE_IRIDESCENCE:o,USE_ANISOTROPY:a}=n,l=n.normalView||or,u=r.pow2(),A=e.add(Vi).normalize(),p=l.dot(e).clamp(),g=l.dot(Vi).clamp(),v=l.dot(A).clamp(),y=Vi.dot(A).clamp();let b=DA({f0:t,f90:i,dotVH:y}),w,S;if(ip(o)&&(b=Z2.mix(b,s)),ip(a)){const C=ld.dot(e),E=ld.dot(Vi),R=ld.dot(A),D=sh.dot(e),B=sh.dot(Vi),L=sh.dot(A);w=dse({alphaT:r2,alphaB:u,dotTV:E,dotBV:B,dotTL:C,dotBL:D,dotNV:g,dotNL:p}),S=mse({alphaT:r2,alphaB:u,dotNH:v,dotTH:R,dotBH:L})}else w=LL({alpha:u,dotNL:p,dotNV:g}),S=DL({alpha:u,dotNH:v});return b.mul(w).mul(S)}),c5=Ie(({roughness:n,dotNV:e})=>{const t=Xt(-1,-.0275,-.572,.022),i=Xt(1,.0425,1.04,-.04),r=n.mul(t).add(i),s=r.x.mul(r.x).min(e.mul(-9.28).exp2()).mul(r.x).add(r.y);return ut(-1.04,1.04).mul(s).add(r.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),IL=Ie(n=>{const{dotNV:e,specularColor:t,specularF90:i,roughness:r}=n,s=c5({dotNV:e,roughness:r});return t.mul(s.x).add(i.mul(s.y))}),BL=Ie(({f:n,f90:e,dotVH:t})=>{const i=t.oneMinus().saturate(),r=i.mul(i),s=i.mul(r,r).clamp(0,.9999);return n.sub(Ce(e).mul(s)).div(s.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),gse=Ie(({roughness:n,dotNH:e})=>{const t=n.pow2(),i=oe(1).div(t),s=e.pow2().oneMinus().max(.0078125);return oe(2).add(i).mul(s.pow(i.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),_se=Ie(({dotNV:n,dotNL:e})=>oe(1).div(oe(4).mul(e.add(n).sub(e.mul(n))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),vse=Ie(({lightDirection:n})=>{const e=n.add(Vi).normalize(),t=or.dot(n).clamp(),i=or.dot(Vi).clamp(),r=or.dot(e).clamp(),s=gse({roughness:Y2,dotNH:r}),o=_se({dotNV:i,dotNL:t});return Qc.mul(s).mul(o)}),yse=Ie(({N:n,V:e,roughness:t})=>{const s=.0078125,o=n.dot(e).saturate(),a=ut(t,o.oneMinus().sqrt());return a.assign(a.mul(.984375).add(s)),a}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),xse=Ie(({f:n})=>{const e=n.length();return hr(e.mul(e).add(n.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),Zm=Ie(({v1:n,v2:e})=>{const t=n.dot(e),i=t.abs().toVar(),r=i.mul(.0145206).add(.4965155).mul(i).add(.8543985).toVar(),s=i.add(4.1616724).mul(i).add(3.417594).toVar(),o=r.div(s),a=t.greaterThan(0).select(o,hr(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(o));return n.cross(e).mul(a)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),gw=Ie(({N:n,V:e,P:t,mInv:i,p0:r,p1:s,p2:o,p3:a})=>{const l=s.sub(r).toVar(),u=a.sub(r).toVar(),A=l.cross(u),p=Ce().toVar();return Cn(A.dot(t.sub(r)).greaterThanEqual(0),()=>{const g=e.sub(n.mul(e.dot(n))).normalize(),v=n.cross(g).negate(),y=i.mul(Ts(g,v,n).transpose()).toVar(),b=y.mul(r.sub(t)).normalize().toVar(),w=y.mul(s.sub(t)).normalize().toVar(),S=y.mul(o.sub(t)).normalize().toVar(),C=y.mul(a.sub(t)).normalize().toVar(),E=Ce(0).toVar();E.addAssign(Zm({v1:b,v2:w})),E.addAssign(Zm({v1:w,v2:S})),E.addAssign(Zm({v1:S,v2:C})),E.addAssign(Zm({v1:C,v2:b})),p.assign(Ce(xse({f:E})))}),p}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),A_=1/6,FL=n=>wn(A_,wn(n,wn(n,n.negate().add(3)).sub(3)).add(1)),Fx=n=>wn(A_,wn(n,wn(n,wn(3,n).sub(6))).add(4)),UL=n=>wn(A_,wn(n,wn(n,wn(-3,n).add(3)).add(3)).add(1)),Ux=n=>wn(A_,Sa(n,3)),_w=n=>FL(n).add(Fx(n)),vw=n=>UL(n).add(Ux(n)),yw=n=>vr(-1,Fx(n).div(FL(n).add(Fx(n)))),xw=n=>vr(1,Ux(n).div(UL(n).add(Ux(n)))),bw=(n,e,t)=>{const i=n.uvNode,r=wn(i,e.zw).add(.5),s=ul(r),o=Au(r),a=_w(o.x),l=vw(o.x),u=yw(o.x),A=xw(o.x),p=yw(o.y),g=xw(o.y),v=ut(s.x.add(u),s.y.add(p)).sub(.5).mul(e.xy),y=ut(s.x.add(A),s.y.add(p)).sub(.5).mul(e.xy),b=ut(s.x.add(u),s.y.add(g)).sub(.5).mul(e.xy),w=ut(s.x.add(A),s.y.add(g)).sub(.5).mul(e.xy),S=_w(o.y).mul(vr(a.mul(n.sample(v).level(t)),l.mul(n.sample(y).level(t)))),C=vw(o.y).mul(vr(a.mul(n.sample(b).level(t)),l.mul(n.sample(w).level(t))));return S.add(C)},OL=Ie(([n,e=oe(3)])=>{const t=ut(n.size(_e(e))),i=ut(n.size(_e(e.add(1)))),r=Da(1,t),s=Da(1,i),o=bw(n,Xt(r,t),ul(e)),a=bw(n,Xt(s,i),e_(e));return Au(e).mix(o,a)}),Tw=Ie(([n,e,t,i,r])=>{const s=Ce(Hb(e.negate(),au(n),Da(1,i))),o=Ce(Zl(r[0].xyz),Zl(r[1].xyz),Zl(r[2].xyz));return au(s).mul(t.mul(o))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),bse=Ie(([n,e])=>n.mul(pl(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),Tse=n5(),Sse=n5(),Sw=Ie(([n,e,t],{material:i})=>{const s=(i.side===wi?Tse:Sse).sample(n),o=ll(cp.x).mul(bse(e,t));return OL(s,o)}),ww=Ie(([n,e,t])=>(Cn(t.notEqual(0),()=>{const i=J2(e).negate().div(t);return Fb(i.negate().mul(n))}),Ce(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),wse=Ie(([n,e,t,i,r,s,o,a,l,u,A,p,g,v,y])=>{let b,w;if(y){b=Xt().toVar(),w=Ce().toVar();const D=A.sub(1).mul(y.mul(.025)),B=Ce(A.sub(D),A,A.add(D));ui({start:0,end:3},({i:L})=>{const U=B.element(L),P=Tw(n,e,p,U,a),F=o.add(P),V=u.mul(l.mul(Xt(F,1))),H=ut(V.xy.div(V.w)).toVar();H.addAssign(1),H.divAssign(2),H.assign(ut(H.x,H.y.oneMinus()));const j=Sw(H,t,U);b.element(L).assign(j.element(L)),b.a.addAssign(j.a),w.element(L).assign(i.element(L).mul(ww(Zl(P),g,v).element(L)))}),b.a.divAssign(3)}else{const D=Tw(n,e,p,A,a),B=o.add(D),L=u.mul(l.mul(Xt(B,1))),U=ut(L.xy.div(L.w)).toVar();U.addAssign(1),U.divAssign(2),U.assign(ut(U.x,U.y.oneMinus())),b=Sw(U,t,A),w=i.mul(ww(Zl(D),g,v))}const S=w.rgb.mul(b.rgb),C=n.dot(e).clamp(),E=Ce(IL({dotNV:C,specularColor:r,specularF90:s,roughness:t})),R=w.r.add(w.g,w.b).div(3);return Xt(E.oneMinus().mul(S),b.a.oneMinus().mul(R).oneMinus())}),Mse=Ts(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),Ese=n=>{const e=n.sqrt();return Ce(1).add(e).div(Ce(1).sub(e))},Mw=(n,e)=>n.sub(e).div(n.add(e)).pow2(),Cse=(n,e)=>{const t=n.mul(2*Math.PI*1e-9),i=Ce(54856e-17,44201e-17,52481e-17),r=Ce(1681e3,1795300,2208400),s=Ce(43278e5,93046e5,66121e5),o=oe(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let a=i.mul(s.mul(2*Math.PI).sqrt()).mul(r.mul(t).add(e).cos()).mul(t.pow2().negate().mul(s).exp());return a=Ce(a.x.add(o),a.y,a.z).div(10685e-11),Mse.mul(a)},Rse=Ie(({outsideIOR:n,eta2:e,cosTheta1:t,thinFilmThickness:i,baseF0:r})=>{const s=li(n,e,ml(0,.03,i)),a=n.div(s).pow2().mul(t.pow2().oneMinus()).oneMinus();Cn(a.lessThan(0),()=>Ce(1));const l=a.sqrt(),u=Mw(s,n),A=DA({f0:u,f90:1,dotVH:t}),p=A.oneMinus(),g=s.lessThan(n).select(Math.PI,0),v=oe(Math.PI).sub(g),y=Ese(r.clamp(0,.9999)),b=Mw(y,s.toVec3()),w=DA({f0:b,f90:1,dotVH:l}),S=Ce(y.x.lessThan(s).select(Math.PI,0),y.y.lessThan(s).select(Math.PI,0),y.z.lessThan(s).select(Math.PI,0)),C=s.mul(i,l,2),E=Ce(v).add(S),R=A.mul(w).clamp(1e-5,.9999),D=R.sqrt(),B=p.pow2().mul(w).div(Ce(1).sub(R)),U=A.add(B).toVar(),P=B.sub(p).toVar();return ui({start:1,end:2,condition:"<=",name:"m"},({m:F})=>{P.mulAssign(D);const V=Cse(oe(F).mul(C),oe(F).mul(E)).mul(2);U.addAssign(P.mul(V))}),U.max(Ce(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),Nse=Ie(({normal:n,viewDir:e,roughness:t})=>{const i=n.dot(e).saturate(),r=t.pow2(),s=Hr(t.lessThan(.25),oe(-339.2).mul(r).add(oe(161.4).mul(t)).sub(25.9),oe(-8.48).mul(r).add(oe(14.3).mul(t)).sub(9.95)),o=Hr(t.lessThan(.25),oe(44).mul(r).sub(oe(23.7).mul(t)).add(3.26),oe(1.97).mul(r).sub(oe(3.27).mul(t)).add(.72));return Hr(t.lessThan(.25),0,oe(.1).mul(t).sub(.025)).add(s.mul(i).add(o).exp()).mul(1/Math.PI).saturate()}),lv=Ce(.04),uv=oe(1);class kL extends f_{constructor(e=!1,t=!1,i=!1,r=!1,s=!1,o=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=i,this.anisotropy=r,this.transmission=s,this.dispersion=o,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=Ce().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Ce().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Ce().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=Ce().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Ce().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=or.dot(Vi).clamp();this.iridescenceFresnel=Rse({outsideIOR:oe(1),eta2:Eb,cosTheta1:t,thinFilmThickness:Cb,baseF0:Ys}),this.iridescenceF0=BL({f:this.iridescenceFresnel,f90:1,dotVH:t})}if(this.transmission===!0){const t=Kl,i=pP.sub(Kl).normalize(),r=l_,s=e.context;s.backdrop=wse(r,i,tl,ii,Ys,lp,t,Jo,fo,Ch,ud,Rb,Pb,Nb,this.dispersion?Lb:null),s.backdropAlpha=o2,ii.a.mulAssign(li(1,s.backdrop.a,o2))}super.start(e)}computeMultiscattering(e,t,i){const r=or.dot(Vi).clamp(),s=c5({roughness:tl,dotNV:r}),a=(this.iridescenceF0?Z2.mix(Ys,this.iridescenceF0):Ys).mul(s.x).add(i.mul(s.y)),u=s.x.add(s.y).oneMinus(),A=Ys.add(Ys.oneMinus().mul(.047619)),p=a.mul(A).div(u.mul(A).oneMinus());e.addAssign(a),t.addAssign(p.mul(u))}direct({lightDirection:e,lightColor:t,reflectedLight:i}){const s=or.dot(e).clamp().mul(t);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(s.mul(vse({lightDirection:e}))),this.clearcoat===!0){const a=Ff.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(a.mul(Bx({lightDirection:e,f0:lv,f90:uv,roughness:ap,normalView:Ff})))}i.directDiffuse.addAssign(s.mul(bh({diffuseColor:ii.rgb}))),i.directSpecular.addAssign(s.mul(Bx({lightDirection:e,f0:Ys,f90:1,roughness:tl,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:i,halfHeight:r,reflectedLight:s,ltc_1:o,ltc_2:a}){const l=t.add(i).sub(r),u=t.sub(i).sub(r),A=t.sub(i).add(r),p=t.add(i).add(r),g=or,v=Vi,y=gr.toVar(),b=yse({N:g,V:v,roughness:tl}),w=o.sample(b).toVar(),S=a.sample(b).toVar(),C=Ts(Ce(w.x,0,w.y),Ce(0,1,0),Ce(w.z,0,w.w)).toVar(),E=Ys.mul(S.x).add(Ys.oneMinus().mul(S.y)).toVar();s.directSpecular.addAssign(e.mul(E).mul(gw({N:g,V:v,P:y,mInv:C,p0:l,p1:u,p2:A,p3:p}))),s.directDiffuse.addAssign(e.mul(ii).mul(gw({N:g,V:v,P:y,mInv:Ts(1,0,0,0,1,0,0,0,1),p0:l,p1:u,p2:A,p3:p})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:i}=e.context;i.indirectDiffuse.addAssign(t.mul(bh({diffuseColor:ii})))}indirectSpecular(e){const{radiance:t,iblIrradiance:i,reflectedLight:r}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(i.mul(Qc,Nse({normal:or,viewDir:Vi,roughness:Y2}))),this.clearcoat===!0){const A=Ff.dot(Vi).clamp(),p=IL({dotNV:A,specularColor:lv,specularF90:uv,roughness:ap});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(p))}const s=Ce().toVar("singleScattering"),o=Ce().toVar("multiScattering"),a=i.mul(1/Math.PI);this.computeMultiscattering(s,o,lp);const l=s.add(o),u=ii.mul(l.r.max(l.g).max(l.b).oneMinus());r.indirectSpecular.addAssign(t.mul(s)),r.indirectSpecular.addAssign(o.mul(a)),r.indirectDiffuse.addAssign(u.mul(a))}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:i}=e.context,s=or.dot(Vi).clamp().add(t),o=tl.mul(-16).oneMinus().negate().exp2(),a=t.sub(s.pow(o).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(t),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(t),i.indirectDiffuse.mulAssign(t),i.indirectSpecular.mulAssign(a)}finish({context:e}){const{outgoingLight:t}=e;if(this.clearcoat===!0){const i=Ff.dot(Vi).clamp(),r=DA({dotVH:i,f0:lv,f90:uv}),s=t.mul(i2.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(i2));t.assign(s)}if(this.sheen===!0){const i=Qc.r.max(Qc.g).max(Qc.b).mul(.157).oneMinus(),r=t.mul(i).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(r)}}}const Ew=oe(1),Ox=oe(-2),Km=oe(.8),cv=oe(-1),Jm=oe(.4),hv=oe(2),e1=oe(.305),fv=oe(3),Cw=oe(.21),Pse=oe(4),Rw=oe(4),Lse=oe(16),Dse=Ie(([n])=>{const e=Ce(Pi(n)).toVar(),t=oe(-1).toVar();return Cn(e.x.greaterThan(e.z),()=>{Cn(e.x.greaterThan(e.y),()=>{t.assign(Hr(n.x.greaterThan(0),0,3))}).Else(()=>{t.assign(Hr(n.y.greaterThan(0),1,4))})}).Else(()=>{Cn(e.z.greaterThan(e.y),()=>{t.assign(Hr(n.z.greaterThan(0),2,5))}).Else(()=>{t.assign(Hr(n.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),Ise=Ie(([n,e])=>{const t=ut().toVar();return Cn(e.equal(0),()=>{t.assign(ut(n.z,n.y).div(Pi(n.x)))}).ElseIf(e.equal(1),()=>{t.assign(ut(n.x.negate(),n.z.negate()).div(Pi(n.y)))}).ElseIf(e.equal(2),()=>{t.assign(ut(n.x.negate(),n.y).div(Pi(n.z)))}).ElseIf(e.equal(3),()=>{t.assign(ut(n.z.negate(),n.y).div(Pi(n.x)))}).ElseIf(e.equal(4),()=>{t.assign(ut(n.x.negate(),n.z).div(Pi(n.y)))}).Else(()=>{t.assign(ut(n.x,n.y).div(Pi(n.z)))}),wn(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),Bse=Ie(([n])=>{const e=oe(0).toVar();return Cn(n.greaterThanEqual(Km),()=>{e.assign(Ew.sub(n).mul(cv.sub(Ox)).div(Ew.sub(Km)).add(Ox))}).ElseIf(n.greaterThanEqual(Jm),()=>{e.assign(Km.sub(n).mul(hv.sub(cv)).div(Km.sub(Jm)).add(cv))}).ElseIf(n.greaterThanEqual(e1),()=>{e.assign(Jm.sub(n).mul(fv.sub(hv)).div(Jm.sub(e1)).add(hv))}).ElseIf(n.greaterThanEqual(Cw),()=>{e.assign(e1.sub(n).mul(Pse.sub(fv)).div(e1.sub(Cw)).add(fv))}).Else(()=>{e.assign(oe(-2).mul(ll(wn(1.16,n))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),VL=Ie(([n,e])=>{const t=n.toVar();t.assign(wn(2,t).sub(1));const i=Ce(t,1).toVar();return Cn(e.equal(0),()=>{i.assign(i.zyx)}).ElseIf(e.equal(1),()=>{i.assign(i.xzy),i.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{i.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{i.assign(i.zyx),i.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{i.assign(i.xzy),i.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{i.z.mulAssign(-1)}),i}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),zL=Ie(([n,e,t,i,r,s])=>{const o=oe(t),a=Ce(e),l=pl(Bse(o),Ox,s),u=Au(l),A=ul(l),p=Ce(kx(n,a,A,i,r,s)).toVar();return Cn(u.notEqual(0),()=>{const g=Ce(kx(n,a,A.add(1),i,r,s)).toVar();p.assign(li(p,g,u))}),p}),kx=Ie(([n,e,t,i,r,s])=>{const o=oe(t).toVar(),a=Ce(e),l=oe(Dse(a)).toVar(),u=oe(hr(Rw.sub(o),0)).toVar();o.assign(hr(o,Rw));const A=oe(PA(o)).toVar(),p=ut(Ise(a,l).mul(A.sub(2)).add(1)).toVar();return Cn(l.greaterThan(2),()=>{p.y.addAssign(A),l.subAssign(3)}),p.x.addAssign(l.mul(A)),p.x.addAssign(u.mul(wn(3,Lse))),p.y.addAssign(wn(4,PA(s).sub(A))),p.x.mulAssign(i),p.y.mulAssign(r),n.sample(p).grad(ut(),ut())}),Av=Ie(({envMap:n,mipInt:e,outputDirection:t,theta:i,axis:r,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:a})=>{const l=kl(i),u=t.mul(l).add(r.cross(t).mul(No(i))).add(r.mul(r.dot(t).mul(l.oneMinus())));return kx(n,u,e,s,o,a)}),qL=Ie(({n,latitudinal:e,poleAxis:t,outputDirection:i,weights:r,samples:s,dTheta:o,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:A,CUBEUV_MAX_MIP:p})=>{const g=Ce(Hr(e,t,n_(t,i))).toVar();Cn(g.equal(Ce(0)),()=>{g.assign(Ce(i.z,0,i.x.negate()))}),g.assign(au(g));const v=Ce().toVar();return v.addAssign(r.element(0).mul(Av({theta:0,axis:g,outputDirection:i,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:A,CUBEUV_MAX_MIP:p}))),ui({start:_e(1),end:n},({i:y})=>{Cn(y.greaterThanEqual(s),()=>{gL()});const b=oe(o.mul(oe(y))).toVar();v.addAssign(r.element(y).mul(Av({theta:b.mul(-1),axis:g,outputDirection:i,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:A,CUBEUV_MAX_MIP:p}))),v.addAssign(r.element(y).mul(Av({theta:b,axis:g,outputDirection:i,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:A,CUBEUV_MAX_MIP:p})))}),Xt(v,1)}),Uf=4,Nw=[.125,.215,.35,.446,.526,.582],Gc=20,dv=new O2(-1,1,1,-1,0,1),Fse=new Er(90,1),Pw=new Gt;let pv=null,mv=0,gv=0;const Vc=(1+Math.sqrt(5))/2,cf=1/Vc,Lw=[new re(-Vc,cf,0),new re(Vc,cf,0),new re(-cf,0,Vc),new re(cf,0,Vc),new re(0,Vc,-cf),new re(0,Vc,cf),new re(-1,1,-1),new re(1,1,-1),new re(-1,1,1),new re(1,1,1)],Use=new re,GL=new WeakMap,Ose=[3,1,5,0,4,2],_v=VL(Wi(),uu("faceIndex")).normalize(),h5=Ce(_v.x,_v.y,_v.z);class kse{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,i=.1,r=100,s={}){const{size:o=256,position:a=Use,renderTarget:l=null}=s;if(this._setSize(o),this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");const A=l||this._allocateTargets();return s.renderTarget=A,this.fromSceneAsync(e,t,i,r,s),A}pv=this._renderer.getRenderTarget(),mv=this._renderer.getActiveCubeFace(),gv=this._renderer.getActiveMipmapLevel();const u=l||this._allocateTargets();return u.depthBuffer=!0,this._sceneToCubeUV(e,i,r,u,a),t>0&&this._blur(u,0,0,t),this._applyPMREM(u),this._cleanup(u),u}async fromSceneAsync(e,t=0,i=.1,r=100,s={}){return this._hasInitialized===!1&&await this._renderer.init(),this.fromScene(e,t,i,r,s)}fromEquirectangular(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);const i=t||this._allocateTargets();return this.fromEquirectangularAsync(e,i),i}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const i=t||this._allocateTargets();return this.fromCubemapAsync(e,t),i}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Iw(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Bw(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===Pa||e.mapping===La?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(pv,mv,gv),e.scissorTest=!1,t1(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),pv=this._renderer.getRenderTarget(),mv=this._renderer.getActiveCubeFace(),gv=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Lr,minFilter:Lr,generateMipmaps:!1,type:Dr,format:ur,colorSpace:Ma},r=Dw(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Dw(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=Vse(s)),this._blurMaterial=zse(s,e,t)}return r}async _compileMaterial(e){const t=new Jn(this._lodPlanes[0],e);await this._renderer.compile(t,dv)}_sceneToCubeUV(e,t,i,r,s){const o=Fse;o.near=t,o.far=i;const a=[1,1,1,1,-1,1],l=[1,-1,1,-1,1,-1],u=this._renderer,A=u.autoClear;u.getClearColor(Pw),u.autoClear=!1;let p=this._backgroundBox;if(p===null){const y=new va({name:"PMREM.Background",side:wi,depthWrite:!1,depthTest:!1});p=new Jn(new oc,y)}let g=!1;const v=e.background;v?v.isColor&&(p.material.color.copy(v),e.background=null,g=!0):(p.material.color.copy(Pw),g=!0),u.setRenderTarget(r),u.clear(),g&&u.render(p,o);for(let y=0;y<6;y++){const b=y%3;b===0?(o.up.set(0,a[y],0),o.position.set(s.x,s.y,s.z),o.lookAt(s.x+l[y],s.y,s.z)):b===1?(o.up.set(0,0,a[y]),o.position.set(s.x,s.y,s.z),o.lookAt(s.x,s.y+l[y],s.z)):(o.up.set(0,a[y],0),o.position.set(s.x,s.y,s.z),o.lookAt(s.x,s.y,s.z+l[y]));const w=this._cubeSize;t1(r,b*w,y>2?w:0,w,w),u.render(e,o)}u.autoClear=A,e.background=v}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Pa||e.mapping===La;r?this._cubemapMaterial===null&&(this._cubemapMaterial=Iw(e)):this._equirectMaterial===null&&(this._equirectMaterial=Bw(e));const s=r?this._cubemapMaterial:this._equirectMaterial;s.fragmentNode.value=e;const o=this._lodMeshes[0];o.material=s;const a=this._cubeSize;t1(t,0,0,3*a,2*a),i.setRenderTarget(t),i.render(o,dv)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=Lw[(r-s-1)%Lw.length];this._blur(e,s-1,s,o,a)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const A=3,p=this._lodMeshes[r];p.material=u;const g=GL.get(u),v=this._sizeLods[i]-1,y=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*Gc-1),b=s/y,w=isFinite(s)?1+Math.floor(A*b):Gc;w>Gc&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${Gc}`);const S=[];let C=0;for(let L=0;L<Gc;++L){const U=L/b,P=Math.exp(-U*U/2);S.push(P),L===0?C+=P:L<w&&(C+=2*P)}for(let L=0;L<S.length;L++)S[L]=S[L]/C;e.texture.frame=(e.texture.frame||0)+1,g.envMap.value=e.texture,g.samples.value=w,g.weights.array=S,g.latitudinal.value=o==="latitudinal"?1:0,a&&(g.poleAxis.value=a);const{_lodMax:E}=this;g.dTheta.value=y,g.mipInt.value=E-i;const R=this._sizeLods[r],D=3*R*(r>E-Uf?r-E+Uf:0),B=4*(this._cubeSize-R);t1(t,D,B,3*R,2*R),l.setRenderTarget(t),l.render(p,dv)}}function Vse(n){const e=[],t=[],i=[],r=[];let s=n;const o=n-Uf+1+Nw.length;for(let a=0;a<o;a++){const l=Math.pow(2,s);t.push(l);let u=1/l;a>n-Uf?u=Nw[a-n+Uf-1]:a===0&&(u=0),i.push(u);const A=1/(l-2),p=-A,g=1+A,v=[p,p,g,p,g,g,p,p,g,g,p,g],y=6,b=6,w=3,S=2,C=1,E=new Float32Array(w*b*y),R=new Float32Array(S*b*y),D=new Float32Array(C*b*y);for(let L=0;L<y;L++){const U=L%3*2/3-1,P=L>2?0:-1,F=[U,P,0,U+2/3,P,0,U+2/3,P+1,0,U,P,0,U+2/3,P+1,0,U,P+1,0],V=Ose[L];E.set(F,w*b*V),R.set(v,S*b*V);const H=[V,V,V,V,V,V];D.set(H,C*b*V)}const B=new pi;B.setAttribute("position",new Xi(E,w)),B.setAttribute("uv",new Xi(R,S)),B.setAttribute("faceIndex",new Xi(D,C)),e.push(B),r.push(new Jn(B,null)),s>Uf&&s--}return{lodPlanes:e,sizeLods:t,sigmas:i,lodMeshes:r}}function Dw(n,e,t){const i=new bl(n,e,t);return i.texture.mapping=fh,i.texture.name="PMREM.cubeUv",i.texture.isPMREMTexture=!0,i.scissorTest=!0,i}function t1(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function f5(n){const e=new yr;return e.depthTest=!1,e.depthWrite=!1,e.blending=Do,e.name=`PMREM_${n}`,e}function zse(n,e,t){const i=Zo(new Array(Gc).fill(0)),r=jt(new re(0,1,0)),s=jt(0),o=oe(Gc),a=jt(0),l=jt(1),u=Vn(null),A=jt(0),p=oe(1/e),g=oe(1/t),v=oe(n),y={n:o,latitudinal:a,weights:i,poleAxis:r,outputDirection:h5,dTheta:s,samples:l,envMap:u,mipInt:A,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:g,CUBEUV_MAX_MIP:v},b=f5("blur");return b.fragmentNode=qL({...y,latitudinal:a.equal(1)}),GL.set(b,y),b}function Iw(n){const e=f5("cubemap");return e.fragmentNode=LA(n,h5),e}function Bw(n){const e=f5("equirect");return e.fragmentNode=Vn(n,a5(h5),0),e}const Fw=new WeakMap;function qse(n){const e=Math.log2(n)-2,t=1/n;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:t,maxMip:e}}function Gse(n,e,t){const i=Hse(e);let r=i.get(n);if((r!==void 0?r.pmremVersion:-1)!==n.pmremVersion){const o=n.image;if(n.isCubeTexture)if($se(o))r=t.fromCubemap(n,r);else return null;else if(jse(o))r=t.fromEquirectangular(n,r);else return null;r.pmremVersion=n.pmremVersion,i.set(n,r)}return r.texture}function Hse(n){let e=Fw.get(n);return e===void 0&&(e=new WeakMap,Fw.set(n,e)),e}class Wse extends fr{static get type(){return"PMREMNode"}constructor(e,t=null,i=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=i,this._generator=null;const r=new Cr;r.isRenderTargetTexture=!0,this._texture=Vn(r),this._width=jt(0),this._height=jt(0),this._maxMip=jt(0),this.updateBeforeType=Sn.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=qse(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const i=t?t.pmremVersion:-1,r=this._value;i!==r.pmremVersion&&(r.isPMREMTexture===!0?t=r:t=Gse(r,e.renderer,this._generator),t!==null&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){this._generator===null&&(this._generator=new kse(e.renderer)),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this)),t=Zb.mul(Ce(t.x,t.y.negate(),t.z));let i=this.levelNode;return i===null&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),zL(this._texture,t,i,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function $se(n){if(n==null)return!1;let e=0;const t=6;for(let i=0;i<t;i++)n[i]!==void 0&&e++;return e===t}function jse(n){return n==null?!1:n.height>0}const A5=at(Wse).setParameterLength(1,3),Uw=new WeakMap;class Xse extends $A{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let i=this.envNode;if(i.isTextureNode||i.isMaterialReferenceNode){const p=i.isTextureNode?i.value:t[i.property];let g=Uw.get(p);g===void 0&&(g=A5(p),Uw.set(p,g)),i=g}const s=t.useAnisotropy===!0||t.anisotropy>0?PP:or,o=i.context(Ow(tl,s)).mul(Z1),a=i.context(Qse(l_)).mul(Math.PI).mul(Z1),l=cd(o),u=cd(a);e.context.radiance.addAssign(l),e.context.iblIrradiance.addAssign(u);const A=e.context.lightingModel.clearcoatRadiance;if(A){const p=i.context(Ow(ap,Ff)).mul(Z1),g=cd(p);A.addAssign(g)}}}const Ow=(n,e)=>{let t=null;return{getUV:()=>(t===null&&(t=Vi.negate().reflect(e),t=n.mul(n).mix(t,e).normalize(),t=t.transformDirection(fo)),t),getTextureLevel:()=>n}},Qse=n=>({getUV:()=>n,getTextureLevel:()=>oe(1)}),Yse=new G9;class HL extends yr{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(Yse),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new Xse(t):null}setupLightingModel(){return new kL}setupSpecular(){const e=li(Ce(.04),ii.rgb,op);Ys.assign(e),lp.assign(1)}setupVariants(){const e=this.metalnessNode?oe(this.metalnessNode):VP;op.assign(e);let t=this.roughnessNode?oe(this.roughnessNode):kP;t=u5({roughness:t}),tl.assign(t),this.setupSpecular(),ii.assign(Xt(ii.rgb.mul(e.oneMinus()),ii.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const Zse=new CH;class Kse extends HL{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(Zse),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?oe(this.iorNode):eL;ud.assign(e),Ys.assign(li(co(qb(ud.sub(1).div(ud.add(1))).mul(OP),Ce(1)).mul(Ix),ii.rgb,op)),lp.assign(li(Ix,1,op))}setupLightingModel(){return new kL(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?oe(this.clearcoatNode):qP,i=this.clearcoatRoughnessNode?oe(this.clearcoatRoughnessNode):GP;i2.assign(t),ap.assign(u5({roughness:i}))}if(this.useSheen){const t=this.sheenNode?Ce(this.sheenNode):$P,i=this.sheenRoughnessNode?oe(this.sheenRoughnessNode):jP;Qc.assign(t),Y2.assign(i)}if(this.useIridescence){const t=this.iridescenceNode?oe(this.iridescenceNode):QP,i=this.iridescenceIORNode?oe(this.iridescenceIORNode):YP,r=this.iridescenceThicknessNode?oe(this.iridescenceThicknessNode):ZP;Z2.assign(t),Eb.assign(i),Cb.assign(r)}if(this.useAnisotropy){const t=(this.anisotropyNode?ut(this.anisotropyNode):XP).toVar();Ou.assign(t.length()),Cn(Ou.equal(0),()=>{t.assign(ut(1,0))}).Else(()=>{t.divAssign(ut(Ou)),Ou.assign(Ou.saturate())}),r2.assign(Ou.pow2().mix(tl.pow2(),1)),ld.assign(Yc[0].mul(t.x).add(Yc[1].mul(t.y))),sh.assign(Yc[1].mul(t.x).sub(Yc[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?oe(this.transmissionNode):KP,i=this.thicknessNode?oe(this.thicknessNode):JP,r=this.attenuationDistanceNode?oe(this.attenuationDistanceNode):tL,s=this.attenuationColorNode?Ce(this.attenuationColorNode):nL;if(o2.assign(t),Rb.assign(i),Nb.assign(r),Pb.assign(s),this.useDispersion){const o=this.dispersionNode?oe(this.dispersionNode):lL;Lb.assign(o)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Ce(this.clearcoatNormalNode):HP}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const Jse=Ie(({normal:n,lightDirection:e,builder:t})=>{const i=n.dot(e),r=ut(i.mul(.5).add(.5),0);if(t.material.gradientMap){const s=Hl("gradientMap","texture").context({getUV:()=>r});return Ce(s.r)}else{const s=r.fwidth().mul(.5);return li(Ce(.7),Ce(1),ml(oe(.7).sub(s.x),oe(.7).add(s.x),r.x))}});class eoe extends f_{direct({lightDirection:e,lightColor:t,reflectedLight:i},r){const s=Jse({normal:o_,lightDirection:e,builder:r}).mul(t);i.directDiffuse.addAssign(s.mul(bh({diffuseColor:ii.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:i,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(i.mul(bh({diffuseColor:ii}))),r.indirectDiffuse.mulAssign(t)}}const toe=new RH;class noe extends yr{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(toe),this.setValues(e)}setupLightingModel(){return new eoe}}class ioe extends fr{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const e=Ce(Vi.z,0,Vi.x.negate()).normalize(),t=Vi.cross(e);return ut(e.dot(or),t.dot(or)).mul(.495).add(.5)}}const WL=Et(ioe),roe=new DH;class soe extends yr{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(roe),this.setValues(e)}setupVariants(e){const t=WL;let i;e.material.matcap?i=Hl("matcap","texture").context({getUV:()=>t}):i=Ce(li(.2,.8,t.y)),ii.rgb.mulAssign(i.rgb)}}class ooe extends fr{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:i}=this;if(this.getNodeType(e)==="vec2"){const s=t.cos(),o=t.sin();return Q2(s,o,o.negate(),s).mul(i)}else{const s=t,o=rh(Xt(1,0,0,0),Xt(0,kl(s.x),No(s.x).negate(),0),Xt(0,No(s.x),kl(s.x),0),Xt(0,0,0,1)),a=rh(Xt(kl(s.y),0,No(s.y),0),Xt(0,1,0,0),Xt(No(s.y).negate(),0,kl(s.y),0),Xt(0,0,0,1)),l=rh(Xt(kl(s.z),No(s.z).negate(),0,0),Xt(No(s.z),kl(s.z),0,0),Xt(0,0,1,0),Xt(0,0,0,1));return o.mul(a).mul(l).mul(Xt(i,1)).xyz}}}const d_=at(ooe).setParameterLength(2),aoe=new Qf;class $L extends yr{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(aoe),this.setValues(e)}setupPositionView(e){const{object:t,camera:i}=e,r=this.sizeAttenuation,{positionNode:s,rotationNode:o,scaleNode:a}=this,l=Rh.mul(Ce(s||0));let u=ut(Jo[0].xyz.length(),Jo[1].xyz.length());if(a!==null&&(u=u.mul(ut(a))),r===!1)if(i.isPerspectiveCamera)u=u.mul(l.z.negate());else{const v=oe(2).div(Ch.element(1).element(1));u=u.mul(v.mul(2))}let A=Fp.xy;if(t.center&&t.center.isVector2===!0){const v=_ie("center","vec2",t);A=A.sub(v.sub(.5))}A=A.mul(u);const p=oe(o||WP),g=d_(A,p);return Xt(l.xy.add(g),l.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const loe=new W4;class uoe extends $L{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(loe),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return Rh.mul(Ce(e||lr)).xyz}setupVertex(e){const t=super.setupVertex(e);if(e.material.isNodeMaterial!==!0)return t;const{rotationNode:i,scaleNode:r,sizeNode:s}=this,o=Fp.xy.toVar(),a=eA.z.div(eA.w);if(i&&i.isNode){const u=oe(i);o.assign(d_(o,u))}let l=s!==null?ut(s):aL;return this.sizeAttenuation===!0&&(l=l.mul(l.div(gr.z.negate()))),r&&r.isNode&&(l=l.mul(ut(r))),o.mulAssign(l.mul(2)),o.assign(o.div(eA.z)),o.y.assign(o.y.mul(a)),o.assign(o.mul(t.w)),t.addAssign(Xt(o,0,0)),t}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}class coe extends f_{constructor(){super(),this.shadowNode=oe(1).toVar("shadowMask")}direct({lightNode:e}){this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){ii.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(ii.rgb)}}const hoe=new EH;class foe extends yr{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(hoe),this.setValues(e)}setupLightingModel(){return new coe}}WA("vec3");WA("vec3");WA("vec3");class Aoe{constructor(e,t){this.nodes=e,this.info=t,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,i)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this._animationLoop!==null&&this._animationLoop(t,i)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class Ia{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let i=0;i<e.length-1;i++)if(t=t.get(e[i]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let i=this.weakMap;for(let r=0;r<e.length-1;r++){const s=e[r];i.has(s)===!1&&i.set(s,new WeakMap),i=i.get(s)}return i.set(e[e.length-1],t),this}delete(e){let t=this.weakMap;for(let i=0;i<e.length-1;i++)if(t=t.get(e[i]),t===void 0)return!1;return t.delete(e[e.length-1])}}let doe=0;function poe(n){const e=Object.keys(n);let t=Object.getPrototypeOf(n);for(;t;){const i=Object.getOwnPropertyDescriptors(t);for(const r in i)if(i[r]!==void 0){const s=i[r];s&&typeof s.get=="function"&&e.push(r)}t=Object.getPrototypeOf(t)}return e}class moe{constructor(e,t,i,r,s,o,a,l,u,A){this.id=doe++,this._nodes=e,this._geometries=t,this.renderer=i,this.object=r,this.material=s,this.scene=o,this.camera=a,this.lightsNode=l,this.context=u,this.geometry=r.geometry,this.version=s.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=A,this.clippingContextCacheKey=A!==null?A.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,i=[],r=new Set;for(const s of e){const o=s.node&&s.node.attribute?s.node.attribute:t.getAttribute(s.name);if(o===void 0)continue;i.push(o);const a=o.isInterleavedBufferAttribute?o.data:o;r.add(a)}return this.attributes=i,this.vertexBuffers=Array.from(r.values()),i}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:i,group:r,drawRange:s}=this,o=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),a=this.getIndex(),l=a!==null;let u=1;if(i.isInstancedBufferGeometry===!0?u=i.instanceCount:e.count!==void 0&&(u=Math.max(0,e.count)),u===0)return null;if(o.instanceCount=u,e.isBatchedMesh===!0)return o;let A=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(A=2);let p=s.start*A,g=(s.start+s.count)*A;r!==null&&(p=Math.max(p,r.start*A),g=Math.min(g,(r.start+r.count)*A));const v=i.attributes.position;let y=1/0;l?y=a.count:v!=null&&(y=v.count),p=Math.max(p,0),g=Math.min(g,y);const b=g-p;return b<0||b===1/0?null:(o.vertexCount=b,o.firstVertex=p,o)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const i of Object.keys(e.attributes).sort()){const r=e.attributes[i];t+=i+",",r.data&&(t+=r.data.stride+","),r.offset&&(t+=r.offset+","),r.itemSize&&(t+=r.itemSize+","),r.normalized&&(t+="n,")}for(const i of Object.keys(e.morphAttributes).sort()){const r=e.morphAttributes[i];t+="morph-"+i+",";for(let s=0,o=r.length;s<o;s++){const a=r[s];t+=a.id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t}=this;let i=t.customProgramCacheKey();for(const r of poe(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(r))continue;const s=t[r];let o;if(s!==null){const a=typeof s;a==="number"?o=s!==0?"1":"0":a==="object"?(o="{",s.isTexture&&(o+=s.mapping),o+="}"):o=String(s)}else o=String(s);i+=o+","}return i+=this.clippingContextCacheKey+",",e.geometry&&(i+=this.getGeometryCacheKey()),e.skeleton&&(i+=e.skeleton.bones.length+","),e.isBatchedMesh&&(i+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(i+=e._colorsTexture.uuid+",")),e.count>1&&(i+=e.uuid+","),i+=e.receiveShadow+",",yR(i)}get needsGeometryUpdate(){return this.geometry.id!==this.object.geometry.id}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=np(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=np(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const Rc=[];class goe{constructor(e,t,i,r,s,o){this.renderer=e,this.nodes=t,this.geometries=i,this.pipelines=r,this.bindings=s,this.info=o,this.chainMaps={}}get(e,t,i,r,s,o,a,l){const u=this.getChainMap(l);Rc[0]=e,Rc[1]=t,Rc[2]=o,Rc[3]=s;let A=u.get(Rc);return A===void 0?(A=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,i,r,s,o,a,l),u.set(Rc,A)):(A.updateClipping(a),A.needsGeometryUpdate&&A.setGeometry(e.geometry),(A.version!==t.version||A.needsUpdate)&&(A.initialCacheKey!==A.getCacheKey()?(A.dispose(),A=this.get(e,t,i,r,s,o,a,l)):A.version=t.version)),Rc.length=0,A}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new Ia)}dispose(){this.chainMaps={}}createRenderObject(e,t,i,r,s,o,a,l,u,A,p){const g=this.getChainMap(p),v=new moe(e,t,i,r,s,o,a,l,u,A);return v.onDispose=()=>{this.pipelines.delete(v),this.bindings.delete(v),this.nodes.delete(v),g.delete(v.getChainArray())},v}}class lc{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const ea={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},qu=16,_oe=211,voe=212;class yoe extends lc{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==null&&this.backend.destroyAttribute(e),t}update(e,t){const i=this.get(e);if(i.version===void 0)t===ea.VERTEX?this.backend.createAttribute(e):t===ea.INDEX?this.backend.createIndexAttribute(e):t===ea.STORAGE?this.backend.createStorageAttribute(e):t===ea.INDIRECT&&this.backend.createIndirectStorageAttribute(e),i.version=this._getBufferAttribute(e).version;else{const r=this._getBufferAttribute(e);(i.version<r.version||r.usage===Cf)&&(this.backend.updateAttribute(e),i.version=r.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function jL(n){return n.index!==null?n.index.version:n.attributes.position.version}function kw(n){const e=[],t=n.index,i=n.attributes.position;if(t!==null){const s=t.array;for(let o=0,a=s.length;o<a;o+=3){const l=s[o+0],u=s[o+1],A=s[o+2];e.push(l,u,u,A,A,l)}}else{const s=i.array;for(let o=0,a=s.length/3-1;o<a;o+=3){const l=o+0,u=o+1,A=o+2;e.push(l,u,u,A,A,l)}}const r=new(O4(e)?q4:z4)(e,1);return r.version=jL(n),r}class xoe extends lc{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,i=this.get(t);i.initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const s=t.index,o=e.getAttributes();s!==null&&this.attributes.delete(s);for(const l of o)this.attributes.delete(l);const a=this.wireframes.get(t);a!==void 0&&this.attributes.delete(a),t.removeEventListener("dispose",r)};t.addEventListener("dispose",r)}updateAttributes(e){const t=e.getAttributes();for(const s of t)s.isStorageBufferAttribute||s.isStorageInstancedBufferAttribute?this.updateAttribute(s,ea.STORAGE):this.updateAttribute(s,ea.VERTEX);const i=this.getIndex(e);i!==null&&this.updateAttribute(i,ea.INDEX);const r=e.geometry.indirect;r!==null&&this.updateAttribute(r,ea.INDIRECT)}updateAttribute(e,t){const i=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,i)):this.attributeCall.get(e.data)!==i&&(this.attributes.update(e,t),this.attributeCall.set(e.data,i),this.attributeCall.set(e,i)):this.attributeCall.get(e)!==i&&(this.attributes.update(e,t),this.attributeCall.set(e,i))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:i}=e;let r=t.index;if(i.wireframe===!0){const s=this.wireframes;let o=s.get(t);o===void 0?(o=kw(t),s.set(t,o)):o.version!==jL(t)&&(this.attributes.delete(o),o=kw(t),s.set(t,o)),r=o}return r}}class boe{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,i){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=i*(t/3):e.isPoints?this.render.points+=i*t:e.isLineSegments?this.render.lines+=i*(t/2):e.isLine?this.render.lines+=i*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class XL{constructor(e){this.cacheKey=e,this.usedTimes=0}}class Toe extends XL{constructor(e,t,i){super(e),this.vertexProgram=t,this.fragmentProgram=i}}class Soe extends XL{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let woe=0;class vv{constructor(e,t,i,r=null,s=null){this.id=woe++,this.code=e,this.stage=t,this.name=i,this.transforms=r,this.attributes=s,this.usedTimes=0}}class Moe extends lc{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:i}=this,r=this.get(e);if(this._needsComputeUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.computeProgram.usedTimes--);const o=this.nodes.getForCompute(e);let a=this.programs.compute.get(o.computeShader);a===void 0&&(s&&s.computeProgram.usedTimes===0&&this._releaseProgram(s.computeProgram),a=new vv(o.computeShader,"compute",e.name,o.transforms,o.nodeAttributes),this.programs.compute.set(o.computeShader,a),i.createProgram(a));const l=this._getComputeCacheKey(e,a);let u=this.caches.get(l);u===void 0&&(s&&s.usedTimes===0&&this._releasePipeline(s),u=this._getComputePipeline(e,a,l,t)),u.usedTimes++,a.usedTimes++,r.version=e.version,r.pipeline=u}return r.pipeline}getForRender(e,t=null){const{backend:i}=this,r=this.get(e);if(this._needsRenderUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.vertexProgram.usedTimes--,s.fragmentProgram.usedTimes--);const o=e.getNodeBuilderState(),a=e.material?e.material.name:"";let l=this.programs.vertex.get(o.vertexShader);l===void 0&&(s&&s.vertexProgram.usedTimes===0&&this._releaseProgram(s.vertexProgram),l=new vv(o.vertexShader,"vertex",a),this.programs.vertex.set(o.vertexShader,l),i.createProgram(l));let u=this.programs.fragment.get(o.fragmentShader);u===void 0&&(s&&s.fragmentProgram.usedTimes===0&&this._releaseProgram(s.fragmentProgram),u=new vv(o.fragmentShader,"fragment",a),this.programs.fragment.set(o.fragmentShader,u),i.createProgram(u));const A=this._getRenderCacheKey(e,l,u);let p=this.caches.get(A);p===void 0?(s&&s.usedTimes===0&&this._releasePipeline(s),p=this._getRenderPipeline(e,l,u,A,t)):e.pipeline=p,p.usedTimes++,l.usedTimes++,u.usedTimes++,r.pipeline=p}return r.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,i,r){i=i||this._getComputeCacheKey(e,t);let s=this.caches.get(i);return s===void 0&&(s=new Soe(i,t),this.caches.set(i,s),this.backend.createComputePipeline(s,r)),s}_getRenderPipeline(e,t,i,r,s){r=r||this._getRenderCacheKey(e,t,i);let o=this.caches.get(r);return o===void 0&&(o=new Toe(r,t,i),this.caches.set(r,o),e.pipeline=o,this.backend.createRenderPipeline(e,s)),o}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,i){return t.id+","+i.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,i=e.stage;this.programs[i].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class Eoe extends lc{constructor(e,t,i,r,s,o){super(),this.backend=e,this.textures=i,this.pipelines=s,this.attributes=r,this.nodes=t,this.info=o,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const i of t){const r=this.get(i);r.bindGroup===void 0&&(this._init(i),this.backend.createBindings(i,t,0),r.bindGroup=i)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const i of t){const r=this.get(i);r.bindGroup===void 0&&(this._init(i),this.backend.createBindings(i,t,0),r.bindGroup=i)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const i=t.attribute,r=i.isIndirectStorageBufferAttribute?ea.INDIRECT:ea.STORAGE;this.attributes.update(i,r)}}_update(e,t){const{backend:i}=this;let r=!1,s=!0,o=0,a=0;for(const l of e.bindings)if(!(l.isNodeUniformsGroup&&this.nodes.updateGroup(l)===!1)){if(l.isStorageBuffer){const u=l.attribute,A=u.isIndirectStorageBufferAttribute?ea.INDIRECT:ea.STORAGE;this.attributes.update(u,A)}if(l.isUniformBuffer)l.update()&&i.updateBinding(l);else if(l.isSampler)l.update();else if(l.isSampledTexture){const u=this.textures.get(l.texture);l.needsBindingsUpdate(u.generation)&&(r=!0);const A=l.update(),p=l.texture;A&&this.textures.updateTexture(p);const g=i.get(p);if(g.externalTexture!==void 0||u.isDefaultTexture?s=!1:(o=o*10+p.id,a+=p.version),i.isWebGPUBackend===!0&&g.texture===void 0&&g.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",l,A,p,l.textureNode.value,r),this.textures.updateTexture(p),r=!0),p.isStorageTexture===!0){const v=this.get(p);l.store===!0?v.needsMipmap=!0:this.textures.needsMipmaps(p)&&v.needsMipmap===!0&&(this.backend.generateMipmaps(p),v.needsMipmap=!1)}}}r===!0&&this.backend.updateBindings(e,t,s?o:0,a)}}function Coe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?n.z-e.z:n.id-e.id}function Vw(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function zw(n){return(n.transmission>0||n.transmissionNode)&&n.side===ar&&n.forceSinglePass===!1}class Roe{constructor(e,t,i){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,i),this.lightsArray=[],this.scene=t,this.camera=i,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,i,r,s,o,a){let l=this.renderItems[this.renderItemsIndex];return l===void 0?(l={id:e.id,object:e,geometry:t,material:i,groupOrder:r,renderOrder:e.renderOrder,z:s,group:o,clippingContext:a},this.renderItems[this.renderItemsIndex]=l):(l.id=e.id,l.object=e,l.geometry=t,l.material=i,l.groupOrder=r,l.renderOrder=e.renderOrder,l.z=s,l.group=o,l.clippingContext=a),this.renderItemsIndex++,l}push(e,t,i,r,s,o,a){const l=this.getNextRenderItem(e,t,i,r,s,o,a);e.occlusionTest===!0&&this.occlusionQueryCount++,i.transparent===!0||i.transmission>0?(zw(i)&&this.transparentDoublePass.push(l),this.transparent.push(l)):this.opaque.push(l)}unshift(e,t,i,r,s,o,a){const l=this.getNextRenderItem(e,t,i,r,s,o,a);i.transparent===!0||i.transmission>0?(zw(i)&&this.transparentDoublePass.unshift(l),this.transparent.unshift(l)):this.opaque.unshift(l)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||Coe),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||Vw),this.transparent.length>1&&this.transparent.sort(t||Vw)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const i=this.renderItems[e];if(i.id===null)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.groupOrder=null,i.renderOrder=null,i.z=null,i.group=null,i.clippingContext=null}}}const b0=[];class Noe{constructor(e){this.lighting=e,this.lists=new Ia}get(e,t){const i=this.lists;b0[0]=e,b0[1]=t;let r=i.get(b0);return r===void 0&&(r=new Roe(this.lighting,e,t),i.set(b0,r)),b0.length=0,r}dispose(){this.lists=new Ia}}let Poe=0;class Loe{constructor(){this.id=Poe++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new Kt,this.scissor=!1,this.scissorValue=new Kt,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return QL(this)}}function QL(n){const{textures:e,activeCubeFace:t}=n,i=[t];for(const r of e)i.push(r.id);return W2(i)}const T0=[],Doe=new zA,Ioe=new bp;class Boe{constructor(){this.chainMaps={}}get(e,t,i=null){T0[0]=e,T0[1]=t;let r;if(i===null)r="default";else{const a=i.texture.format;r=`${i.textures.length}:${a}:${i.samples}:${i.depthBuffer}:${i.stencilBuffer}`}const s=this._getChainMap(r);let o=s.get(T0);return o===void 0&&(o=new Loe,s.set(T0,o)),T0.length=0,i!==null&&(o.sampleCount=i.samples===0?1:i.samples),o}getForClear(e=null){return this.get(Doe,Ioe,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new Ia)}dispose(){this.chainMaps={}}}const Foe=new re;class Uoe extends lc{constructor(e,t,i){super(),this.renderer=e,this.backend=t,this.info=i}updateRenderTarget(e,t=0){const i=this.get(e),r=e.samples===0?1:e.samples,s=i.depthTextureMips||(i.depthTextureMips={}),o=e.textures,a=this.getSize(o[0]),l=a.width>>t,u=a.height>>t;let A=e.depthTexture||s[t];const p=e.depthBuffer===!0||e.stencilBuffer===!0;let g=!1;A===void 0&&p&&(e.multiview===!0&&a.depth>1?A=new L9:A=new lo,A.format=e.stencilBuffer?Fo:Bo,A.type=e.stencilBuffer?Io:Ni,A.image.width=l,A.image.height=u,A.image.depth=a.depth,s[t]=A),(i.width!==a.width||a.height!==i.height)&&(g=!0,A&&(A.needsUpdate=!0,A.image.width=l,A.image.height=u,A.image.depth=A.isDepthArrayTexture?A.image.depth:1)),i.width=a.width,i.height=a.height,i.textures=o,i.depthTexture=A||null,i.depth=e.depthBuffer,i.stencil=e.stencilBuffer,i.renderTarget=e,i.sampleCount!==r&&(g=!0,A&&(A.needsUpdate=!0),i.sampleCount=r);const v={sampleCount:r};if(e.isXRRenderTarget!==!0){for(let y=0;y<o.length;y++){const b=o[y];b.isTextureArray=e.multiview===!0&&a.depth>1,g&&(b.needsUpdate=!0),this.updateTexture(b,v)}A&&this.updateTexture(A,v)}if(i.initialized!==!0){i.initialized=!0;const y=()=>{e.removeEventListener("dispose",y);for(let b=0;b<o.length;b++)this._destroyTexture(o[b]);A&&this._destroyTexture(A),this.delete(e)};e.addEventListener("dispose",y)}}updateTexture(e,t={}){const i=this.get(e);if(i.initialized===!0&&i.version===e.version)return;const r=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,s=this.backend;if(r&&i.initialized===!0&&(s.destroySampler(e),s.destroyTexture(e)),e.isFramebufferTexture){const u=this.renderer.getRenderTarget();u?e.type=u.texture.type:e.type=Ji}const{width:o,height:a,depth:l}=this.getSize(e);if(t.width=o,t.height=a,t.depth=l,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,o,a):1,r||e.isStorageTexture===!0)s.createSampler(e),s.createTexture(e,t),i.generation=e.version;else if(i.initialized!==!0&&s.createSampler(e),e.version>0){const A=e.image;if(A===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(A.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const p=[];for(const g of e.images)p.push(g);t.images=p}else t.image=A;(i.isDefaultTexture===void 0||i.isDefaultTexture===!0)&&(s.createTexture(e,t),i.isDefaultTexture=!1,i.generation=e.version),e.source.dataReady===!0&&s.updateTexture(e,t),t.needsMipmaps&&e.mipmaps.length===0&&s.generateMipmaps(e)}}else s.createDefaultTexture(e),i.isDefaultTexture=!0,i.generation=e.version;if(i.initialized!==!0){i.initialized=!0,i.generation=e.version,this.info.memory.textures++;const u=()=>{e.removeEventListener("dispose",u),this._destroyTexture(e)};e.addEventListener("dispose",u)}i.version=e.version}getSize(e,t=Foe){let i=e.images?e.images[0]:e.image;return i?(i.image!==void 0&&(i=i.image),t.width=i.width||1,t.height=i.height||1,t.depth=e.isCubeTexture?6:i.depth||1):t.width=t.height=t.depth=1,t}getMipLevels(e,t,i){let r;return e.isCompressedTexture?e.mipmaps?r=e.mipmaps.length:r=1:r=Math.floor(Math.log2(Math.max(t,i)))+1,r}needsMipmaps(e){return e.isCompressedTexture===!0||e.generateMipmaps}_destroyTexture(e){this.has(e)===!0&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class d5 extends Gt{constructor(e,t,i,r=1){super(e,t,i),this.a=r}set(e,t,i,r=1){return this.a=r,super.set(e,t,i)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class YL extends ci{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}const Ooe=(n,e)=>tt(new YL(n,e));class koe extends en{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.outputNode?this.outputNode.getMemberType(e,t):"void"}add(e){return this.nodes.push(e),this}If(e,t){const i=new Bf(t);return this._currentCond=Hr(e,i),this.add(this._currentCond)}ElseIf(e,t){const i=new Bf(t),r=Hr(e,i);return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new Bf(e),this}Switch(e){return this._expressionNode=tt(e),this}Case(...e){const t=[];if(e.length>=2)for(let a=0;a<e.length-1;a++)t.push(this._expressionNode.equal(tt(e[a])));else throw new Error("TSL: Invalid parameter length. Case() requires at least two parameters.");const i=e[e.length-1],r=new Bf(i);let s=t[0];for(let a=1;a<t.length;a++)s=s.or(t[a]);const o=Hr(s,r);return this._currentCond===null?(this._currentCond=o,this.add(this._currentCond)):(this._currentCond.elseNode=o,this._currentCond=o,this)}Default(e){return this.Else(e),this}build(e,...t){const i=wb();rp(this);for(const r of this.nodes)r.build(e,"void");return rp(i),this.outputNode?this.outputNode.build(e,...t):super.build(e,...t)}else(...e){return console.warn("THREE.TSL: .else() has been renamed to .Else()."),this.Else(...e)}elseif(...e){return console.warn("THREE.TSL: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...e)}}const J1=at(koe).setParameterLength(0,1);function Voe(n){return Object.entries(n).map(([e,t])=>typeof t=="string"?{name:e,type:t,atomic:!1}:{name:e,type:t.type,atomic:t.atomic||!1})}class zoe extends en{static get type(){return"StructTypeNode"}constructor(e,t=null){super("struct"),this.membersLayout=Voe(e),this.name=t,this.isStructLayoutNode=!0}getLength(){let e=0;for(const t of this.membersLayout)e+=yb(t.type);return e}getMemberType(e,t){const i=this.membersLayout.find(r=>r.name===t);return i?i.type:"void"}getNodeType(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}setup(e){e.addInclude(this)}generate(e){return this.getNodeType(e)}}class qoe extends en{static get type(){return"StructNode"}constructor(e,t){super("vec3"),this.structLayoutNode=e,this.values=t,this.isStructNode=!0}getNodeType(e){return this.structLayoutNode.getNodeType(e)}getMemberType(e,t){return this.structLayoutNode.getMemberType(e,t)}generate(e){const t=e.getVarFromNode(this),i=t.type,r=e.getPropertyName(t);return e.addLineFlowCode(`${r} = ${e.generateStruct(i,this.structLayoutNode.membersLayout,this.values)}`,this),t.name}}const Goe=(n,e=null)=>{const t=new zoe(n,e),i=(...r)=>{let s=null;if(r.length>0)if(r[0].isNode){s={};const o=Object.keys(n);for(let a=0;a<r.length;a++)s[o[a]]=r[a]}else s=r[0];return tt(new qoe(t,s))};return i.layout=t,i.isStruct=!0,i};class ZL extends en{static get type(){return"OutputStructNode"}constructor(...e){super(),this.members=e,this.isOutputStructNode=!0}getNodeType(e){const t=e.getNodeProperties(this);if(t.membersLayout===void 0){const i=this.members,r=[];for(let s=0;s<i.length;s++){const o="m"+s,a=i[s].getNodeType(e);r.push({name:o,type:a,index:s})}t.membersLayout=r,t.structType=e.getOutputStructTypeFromNode(this,t.membersLayout)}return t.structType.name}generate(e){const t=e.getOutputStructName(),i=this.members,r=t!==""?t+".":"";for(let s=0;s<i.length;s++){const o=i[s].build(e);e.addLineFlowCode(`${r}m${s} = ${o}`,this)}return t}}const Hoe=at(ZL);function KL(n,e){for(let t=0;t<n.length;t++)if(n[t].name===e)return t;return-1}class Woe extends ZL{static get type(){return"MRTNode"}constructor(e){super(),this.outputNodes=e,this.isMRTNode=!0}has(e){return this.outputNodes[e]!==void 0}get(e){return this.outputNodes[e]}merge(e){const t={...this.outputNodes,...e.outputNodes};return JL(t)}setup(e){const t=this.outputNodes,i=e.renderer.getRenderTarget(),r=[],s=i.textures;for(const o in t){const a=KL(s,o);r[a]=Xt(t[o])}return this.members=r,super.setup(e)}}const JL=at(Woe),$oe=Ie(([n])=>{const e=n.toUint().mul(747796405).add(2891336453),t=e.shiftRight(e.shiftRight(28).add(4)).bitXor(e).mul(277803737);return t.shiftRight(22).bitXor(t).toFloat().mul(1/2**32)}),Vx=(n,e)=>Sa(wn(4,n.mul(Yn(1,n))),e),joe=(n,e)=>n.lessThan(.5)?Vx(n.mul(2),e).div(2):Yn(1,Vx(wn(Yn(1,n),2),e).div(2)),Xoe=(n,e,t)=>Sa(Da(Sa(n,e),vr(Sa(n,e),Sa(Yn(1,n),t))),1/e),Qoe=(n,e)=>No(a2.mul(e.mul(n).sub(1))).div(a2.mul(e.mul(n).sub(1))),Vl=Ie(([n])=>n.fract().sub(.5).abs()).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),Yoe=Ie(([n])=>Ce(Vl(n.z.add(Vl(n.y.mul(1)))),Vl(n.z.add(Vl(n.x.mul(1)))),Vl(n.y.add(Vl(n.x.mul(1)))))).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Zoe=Ie(([n,e,t])=>{const i=Ce(n).toVar(),r=oe(1.4).toVar(),s=oe(0).toVar(),o=Ce(i).toVar();return ui({start:oe(0),end:oe(3),type:"float",condition:"<="},()=>{const a=Ce(Yoe(o.mul(2))).toVar();i.addAssign(a.add(t.mul(oe(.1).mul(e)))),o.mulAssign(1.8),r.mulAssign(1.5),i.mulAssign(1.2);const l=oe(Vl(i.z.add(Vl(i.x.add(Vl(i.y)))))).toVar();s.addAssign(l.div(r)),o.addAssign(.14)}),s}).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]});class Koe extends en{static get type(){return"FunctionOverloadingNode"}constructor(e=[],...t){super(),this.functionNodes=e,this.parametersNodes=t,this._candidateFnCall=null,this.global=!0}getNodeType(){return this.functionNodes[0].shaderNode.layout.type}setup(e){const t=this.parametersNodes;let i=this._candidateFnCall;if(i===null){let r=null,s=-1;for(const o of this.functionNodes){const l=o.shaderNode.layout;if(l===null)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const u=l.inputs;if(t.length===u.length){let A=0;for(let p=0;p<t.length;p++){const g=t[p],v=u[p];g.getNodeType(e)===v.type?A++:A=0}A>s&&(r=o,s=A)}}this._candidateFnCall=i=r(...t)}return i}}const Joe=at(Koe),as=n=>(...e)=>Joe(n,...e),Nh=jt(0).setGroup(nn).onRenderUpdate(n=>n.time),eD=jt(0).setGroup(nn).onRenderUpdate(n=>n.deltaTime),eae=jt(0,"uint").setGroup(nn).onRenderUpdate(n=>n.frameId),tae=(n=1)=>(console.warn('TSL: timerLocal() is deprecated. Use "time" instead.'),Nh.mul(n)),nae=(n=1)=>(console.warn('TSL: timerGlobal() is deprecated. Use "time" instead.'),Nh.mul(n)),iae=(n=1)=>(console.warn('TSL: timerDelta() is deprecated. Use "deltaTime" instead.'),eD.mul(n)),rae=(n=Nh)=>n.add(.75).mul(Math.PI*2).sin().mul(.5).add(.5),sae=(n=Nh)=>n.fract().round(),oae=(n=Nh)=>n.add(.5).fract().mul(2).sub(1).abs(),aae=(n=Nh)=>n.fract(),lae=Ie(([n,e,t=ut(.5)])=>d_(n.sub(t),e).add(t)),uae=Ie(([n,e,t=ut(.5)])=>{const i=n.sub(t),r=i.dot(i),o=r.mul(r).mul(e);return n.add(i.mul(o))}),cae=Ie(({position:n=null,horizontal:e=!0,vertical:t=!1})=>{let i;n!==null?(i=Jo.toVar(),i[3][0]=n.x,i[3][1]=n.y,i[3][2]=n.z):i=Jo;const r=fo.mul(i);return ip(e)&&(r[0][0]=Jo[0].length(),r[0][1]=0,r[0][2]=0),ip(t)&&(r[1][0]=0,r[1][1]=Jo[1].length(),r[1][2]=0),r[2][0]=0,r[2][1]=0,r[2][2]=1,Ch.mul(r).mul(lr)}),hae=Ie(([n=null])=>{const e=c2();return c2(i5(n)).sub(e).lessThan(0).select(Ca,n)});class fae extends en{static get type(){return"SpriteSheetUVNode"}constructor(e,t=Wi(),i=oe(0)){super("vec2"),this.countNode=e,this.uvNode=t,this.frameNode=i}setup(){const{frameNode:e,uvNode:t,countNode:i}=this,{width:r,height:s}=i,o=e.mod(r.mul(s)).floor(),a=o.mod(r),l=s.sub(o.add(1).div(r).ceil()),u=i.reciprocal(),A=ut(a,l);return t.add(A).mul(u)}}const Aae=at(fae).setParameterLength(3);class dae extends en{static get type(){return"TriplanarTexturesNode"}constructor(e,t=null,i=null,r=oe(1),s=lr,o=ho){super("vec4"),this.textureXNode=e,this.textureYNode=t,this.textureZNode=i,this.scaleNode=r,this.positionNode=s,this.normalNode=o}setup(){const{textureXNode:e,textureYNode:t,textureZNode:i,scaleNode:r,positionNode:s,normalNode:o}=this;let a=o.abs().normalize();a=a.div(a.dot(Ce(1)));const l=s.yz.mul(r),u=s.zx.mul(r),A=s.xy.mul(r),p=e.value,g=t!==null?t.value:p,v=i!==null?i.value:p,y=Vn(p,l).mul(a.x),b=Vn(g,u).mul(a.y),w=Vn(v,A).mul(a.z);return vr(y,b,w)}}const tD=at(dae).setParameterLength(1,6),pae=(...n)=>tD(...n),hf=new Ka,Nc=new re,ff=new re,yv=new re,S0=new on,n1=new re(0,0,-1),Ha=new Kt,w0=new re,i1=new re,M0=new Kt,r1=new rt,h2=new bl,mae=Ca.flipX();h2.depthTexture=new lo(1,1);let xv=!1;class p5 extends gl{static get type(){return"ReflectorNode"}constructor(e={}){super(e.defaultTexture||h2.texture,mae),this._reflectorBaseNode=e.reflector||new gae(this,e),this._depthNode=null,this.setUpdateMatrix(!1)}get reflector(){return this._reflectorBaseNode}get target(){return this._reflectorBaseNode.target}getDepthNode(){if(this._depthNode===null){if(this._reflectorBaseNode.depth!==!0)throw new Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=tt(new p5({defaultTexture:h2.depthTexture,reflector:this._reflectorBaseNode}))}return this._depthNode}setup(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),super.setup(e)}clone(){const e=new this.constructor(this.reflectorNode);return e._reflectorBaseNode=this._reflectorBaseNode,e}dispose(){super.dispose(),this._reflectorBaseNode.dispose()}}class gae extends en{static get type(){return"ReflectorBaseNode"}constructor(e,t={}){super();const{target:i=new ki,resolution:r=1,generateMipmaps:s=!1,bounces:o=!0,depth:a=!1}=t;this.textureNode=e,this.target=i,this.resolution=r,this.generateMipmaps=s,this.bounces=o,this.depth=a,this.updateBeforeType=o?Sn.RENDER:Sn.FRAME,this.virtualCameras=new WeakMap,this.renderTargets=new Map,this.forceUpdate=!1}_updateResolution(e,t){const i=this.resolution;t.getDrawingBufferSize(r1),e.setSize(Math.round(r1.width*i),Math.round(r1.height*i))}setup(e){return this._updateResolution(h2,e.renderer),super.setup(e)}dispose(){super.dispose();for(const e of this.renderTargets.values())e.dispose()}getVirtualCamera(e){let t=this.virtualCameras.get(e);return t===void 0&&(t=e.clone(),this.virtualCameras.set(e,t)),t}getRenderTarget(e){let t=this.renderTargets.get(e);return t===void 0&&(t=new bl(0,0,{type:Dr}),this.generateMipmaps===!0&&(t.texture.minFilter=Oq,t.texture.generateMipmaps=!0),this.depth===!0&&(t.depthTexture=new lo),this.renderTargets.set(e,t)),t}updateBefore(e){if(this.bounces===!1&&xv)return!1;xv=!0;const{scene:t,camera:i,renderer:r,material:s}=e,{target:o}=this,a=this.getVirtualCamera(i),l=this.getRenderTarget(a);if(r.getDrawingBufferSize(r1),this._updateResolution(l,r),ff.setFromMatrixPosition(o.matrixWorld),yv.setFromMatrixPosition(i.matrixWorld),S0.extractRotation(o.matrixWorld),Nc.set(0,0,1),Nc.applyMatrix4(S0),w0.subVectors(ff,yv),w0.dot(Nc)>0===!0&&this.forceUpdate===!1)return;w0.reflect(Nc).negate(),w0.add(ff),S0.extractRotation(i.matrixWorld),n1.set(0,0,-1),n1.applyMatrix4(S0),n1.add(yv),i1.subVectors(ff,n1),i1.reflect(Nc).negate(),i1.add(ff),a.coordinateSystem=i.coordinateSystem,a.position.copy(w0),a.up.set(0,1,0),a.up.applyMatrix4(S0),a.up.reflect(Nc),a.lookAt(i1),a.near=i.near,a.far=i.far,a.updateMatrixWorld(),a.projectionMatrix.copy(i.projectionMatrix),hf.setFromNormalAndCoplanarPoint(Nc,ff),hf.applyMatrix4(a.matrixWorldInverse),Ha.set(hf.normal.x,hf.normal.y,hf.normal.z,hf.constant);const A=a.projectionMatrix;M0.x=(Math.sign(Ha.x)+A.elements[8])/A.elements[0],M0.y=(Math.sign(Ha.y)+A.elements[9])/A.elements[5],M0.z=-1,M0.w=(1+A.elements[10])/A.elements[14],Ha.multiplyScalar(1/Ha.dot(M0));const p=0;A.elements[2]=Ha.x,A.elements[6]=Ha.y,A.elements[10]=r.coordinateSystem===Al?Ha.z-p:Ha.z+1-p,A.elements[14]=Ha.w,this.textureNode.value=l.texture,this.depth===!0&&(this.textureNode.getDepthNode().value=l.depthTexture),s.visible=!1;const g=r.getRenderTarget(),v=r.getMRT(),y=r.autoClear;r.setMRT(null),r.setRenderTarget(l),r.autoClear=!0,r.render(t,a),r.setMRT(v),r.setRenderTarget(g),r.autoClear=y,s.visible=!0,xv=!1,this.forceUpdate=!1}}const _ae=n=>tt(new p5(n)),bv=new O2(-1,1,1,-1,0,1);class vae extends pi{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new ri([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new ri(t,2))}}const yae=new vae;class m5 extends Jn{constructor(e=null){super(yae,e),this.camera=bv,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,bv)}render(e){e.render(this,bv)}}const xae=new rt;class bae extends gl{static get type(){return"RTTNode"}constructor(e,t=null,i=null,r={type:Dr}){const s=new bl(t,i,r);super(s.texture,Wi()),this.node=e,this.width=t,this.height=i,this.pixelRatio=1,this.renderTarget=s,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this._rttNode=null,this._quadMesh=new m5(new yr),this.updateBeforeType=Sn.RENDER}get autoSize(){return this.width===null}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,t){this.width=e,this.height=t;const i=e*this.pixelRatio,r=t*this.pixelRatio;this.renderTarget.setSize(i,r),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore({renderer:e}){if(this.textureNeedsUpdate===!1&&this.autoUpdate===!1)return;if(this.textureNeedsUpdate=!1,this.autoSize===!0){this.pixelRatio=e.getPixelRatio();const i=e.getSize(xae);this.setSize(i.width,i.height)}this._quadMesh.material.fragmentNode=this._rttNode;const t=e.getRenderTarget();e.setRenderTarget(this.renderTarget),this._quadMesh.render(e),e.setRenderTarget(t)}clone(){const e=new gl(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}const nD=(n,...e)=>tt(new bae(tt(n),...e)),Tae=(n,...e)=>n.isTextureNode?n:n.isPassNode?n.getTextureNode():nD(n,...e),Mf=Ie(([n,e,t],i)=>{let r;i.renderer.coordinateSystem===Al?(n=ut(n.x,n.y.oneMinus()).mul(2).sub(1),r=Xt(Ce(n,e),1)):r=Xt(Ce(n.x,n.y.oneMinus(),e).mul(2).sub(1),1);const s=Xt(t.mul(r));return s.xyz.div(s.w)}),Sae=Ie(([n,e])=>{const t=e.mul(Xt(n,1)),i=t.xy.div(t.w).mul(.5).add(.5).toVar();return ut(i.x,i.y.oneMinus())}),wae=Ie(([n,e,t])=>{const i=Qu(ir(e)),r=Pr(n.mul(i)).toVar(),s=ir(e,r).toVar(),o=ir(e,r.sub(Pr(2,0))).toVar(),a=ir(e,r.sub(Pr(1,0))).toVar(),l=ir(e,r.add(Pr(1,0))).toVar(),u=ir(e,r.add(Pr(2,0))).toVar(),A=ir(e,r.add(Pr(0,2))).toVar(),p=ir(e,r.add(Pr(0,1))).toVar(),g=ir(e,r.sub(Pr(0,1))).toVar(),v=ir(e,r.sub(Pr(0,2))).toVar(),y=Pi(Yn(oe(2).mul(a).sub(o),s)).toVar(),b=Pi(Yn(oe(2).mul(l).sub(u),s)).toVar(),w=Pi(Yn(oe(2).mul(p).sub(A),s)).toVar(),S=Pi(Yn(oe(2).mul(g).sub(v),s)).toVar(),C=Mf(n,s,t).toVar(),E=y.lessThan(b).select(C.sub(Mf(n.sub(ut(oe(1).div(i.x),0)),a,t)),C.negate().add(Mf(n.add(ut(oe(1).div(i.x),0)),l,t))),R=w.lessThan(S).select(C.sub(Mf(n.add(ut(0,oe(1).div(i.y))),p,t)),C.negate().add(Mf(n.sub(ut(0,oe(1).div(i.y))),g,t)));return au(n_(E,R))});class eg extends Xu{constructor(e,t,i=Float32Array){const r=ArrayBuffer.isView(e)?e:new i(e*t);super(r,t),this.isStorageInstancedBufferAttribute=!0}}class Mae extends Xi{constructor(e,t,i=Float32Array){const r=ArrayBuffer.isView(e)?e:new i(e*t);super(r,t),this.isStorageBufferAttribute=!0}}const Eae=(n,e="float")=>{let t,i;e.isStruct===!0?(t=e.layout.getLength(),i=n2("float")):(t=yb(e),i=n2(e));const r=new Mae(n,t,i);return oh(r,e,n)},Cae=(n,e="float")=>{let t,i;e.isStruct===!0?(t=e.layout.getLength(),i=n2("float")):(t=yb(e),i=n2(e));const r=new eg(n,t,i);return oh(r,e,n)};class Rae extends en{static get type(){return"PointUVNode"}constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}const Nae=Et(Rae),E0=new jr,Tv=new on;class so extends en{static get type(){return"SceneNode"}constructor(e=so.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,i=this.scene!==null?this.scene:e.scene;let r;return t===so.BACKGROUND_BLURRINESS?r=xi("backgroundBlurriness","float",i):t===so.BACKGROUND_INTENSITY?r=xi("backgroundIntensity","float",i):t===so.BACKGROUND_ROTATION?r=jt("mat4").label("backgroundRotation").setGroup(nn).onRenderUpdate(()=>{const s=i.background;return s!==null&&s.isTexture&&s.mapping!==E4?(E0.copy(i.backgroundRotation),E0.x*=-1,E0.y*=-1,E0.z*=-1,Tv.makeRotationFromEuler(E0)):Tv.identity(),Tv}):console.error("THREE.SceneNode: Unknown scope:",t),r}}so.BACKGROUND_BLURRINESS="backgroundBlurriness";so.BACKGROUND_INTENSITY="backgroundIntensity";so.BACKGROUND_ROTATION="backgroundRotation";const iD=Et(so,so.BACKGROUND_BLURRINESS),zx=Et(so,so.BACKGROUND_INTENSITY),rD=Et(so,so.BACKGROUND_ROTATION);class Pae extends gl{static get type(){return"StorageTextureNode"}constructor(e,t,i=null){super(e,t),this.storeNode=i,this.isStorageTextureNode=!0,this.access=ys.WRITE_ONLY}getInputType(){return"storageTexture"}setup(e){super.setup(e);const t=e.getNodeProperties(this);t.storeNode=this.storeNode}setAccess(e){return this.access=e,this}generate(e,t){let i;return this.storeNode!==null?i=this.generateStore(e):i=super.generate(e,t),i}toReadWrite(){return this.setAccess(ys.READ_WRITE)}toReadOnly(){return this.setAccess(ys.READ_ONLY)}toWriteOnly(){return this.setAccess(ys.WRITE_ONLY)}generateStore(e){const t=e.getNodeProperties(this),{uvNode:i,storeNode:r}=t,s=super.generate(e,"property"),o=i.build(e,"uvec2"),a=r.build(e,"vec4"),l=e.generateTextureStore(e,s,o,a);e.addLineFlowCode(l,this)}}const sD=at(Pae).setParameterLength(1,3),Lae=(n,e,t)=>{const i=sD(n,e,t);return t!==null&&i.toStack(),i},Dae=Ie(({texture:n,uv:e})=>{const i=Ce().toVar();return Cn(e.x.lessThan(1e-4),()=>{i.assign(Ce(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{i.assign(Ce(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{i.assign(Ce(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{i.assign(Ce(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{i.assign(Ce(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{i.assign(Ce(0,0,-1))}).Else(()=>{const s=n.sample(e.add(Ce(-.01,0,0))).r.sub(n.sample(e.add(Ce(.01,0,0))).r),o=n.sample(e.add(Ce(0,-.01,0))).r.sub(n.sample(e.add(Ce(0,.01,0))).r),a=n.sample(e.add(Ce(0,0,-.01))).r.sub(n.sample(e.add(Ce(0,0,.01))).r);i.assign(Ce(s,o,a))}),i.normalize()});class Iae extends gl{static get type(){return"Texture3DNode"}constructor(e,t=null,i=null){super(e,t,i),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return Ce(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const i=this.value;return e.isFlipY()&&(i.isRenderTargetTexture===!0||i.isFramebufferTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(_e(Qu(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,"vec3")}normal(e){return Dae({texture:this,uv:e})}}const oD=at(Iae).setParameterLength(1,3);class Bae extends u_{static get type(){return"UserDataNode"}constructor(e,t,i=null){super(e,t,i),this.userData=i}updateReference(e){return this.reference=this.userData!==null?this.userData:e.object.userData,this.reference}}const Fae=(n,e,t)=>tt(new Bae(n,e,t)),qw=new WeakMap;class Uae extends fr{static get type(){return"VelocityNode"}constructor(){super("vec2"),this.projectionMatrix=null,this.updateType=Sn.OBJECT,this.updateAfterType=Sn.OBJECT,this.previousModelWorldMatrix=jt(new on),this.previousProjectionMatrix=jt(new on).setGroup(nn),this.previousCameraViewMatrix=jt(new on)}setProjectionMatrix(e){this.projectionMatrix=e}update({frameId:e,camera:t,object:i}){const r=Gw(i);this.previousModelWorldMatrix.value.copy(r);const s=aD(t);s.frameId!==e&&(s.frameId=e,s.previousProjectionMatrix===void 0?(s.previousProjectionMatrix=new on,s.previousCameraViewMatrix=new on,s.currentProjectionMatrix=new on,s.currentCameraViewMatrix=new on,s.previousProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.previousCameraViewMatrix.copy(t.matrixWorldInverse)):(s.previousProjectionMatrix.copy(s.currentProjectionMatrix),s.previousCameraViewMatrix.copy(s.currentCameraViewMatrix)),s.currentProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.currentCameraViewMatrix.copy(t.matrixWorldInverse),this.previousProjectionMatrix.value.copy(s.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(s.previousCameraViewMatrix))}updateAfter({object:e}){Gw(e).copy(e.matrixWorld)}setup(){const e=this.projectionMatrix===null?Ch:jt(this.projectionMatrix),t=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),i=e.mul(Rh).mul(lr),r=this.previousProjectionMatrix.mul(t).mul(u2),s=i.xy.div(i.w),o=r.xy.div(r.w);return Yn(s,o)}}function aD(n){let e=qw.get(n);return e===void 0&&(e={},qw.set(n,e)),e}function Gw(n,e=0){const t=aD(n);let i=t[e];return i===void 0&&(t[e]=i=new on,t[e].copy(n.matrixWorld)),i}const Oae=Et(Uae),lD=Ie(([n,e])=>co(1,n.oneMinus().div(e)).oneMinus()).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),uD=Ie(([n,e])=>co(n.div(e.oneMinus()),1)).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),cD=Ie(([n,e])=>n.oneMinus().mul(e.oneMinus()).oneMinus()).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),hD=Ie(([n,e])=>li(n.mul(2).mul(e),n.oneMinus().mul(2).mul(e.oneMinus()).oneMinus(),t_(.5,n))).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),kae=Ie(([n,e])=>{const t=e.a.add(n.a.mul(e.a.oneMinus()));return Xt(e.rgb.mul(e.a).add(n.rgb.mul(n.a).mul(e.a.oneMinus())).div(t),t)}).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),Vae=(...n)=>(console.warn('THREE.TSL: "burn" has been renamed. Use "blendBurn" instead.'),lD(n)),zae=(...n)=>(console.warn('THREE.TSL: "dodge" has been renamed. Use "blendDodge" instead.'),uD(n)),qae=(...n)=>(console.warn('THREE.TSL: "screen" has been renamed. Use "blendScreen" instead.'),cD(n)),Gae=(...n)=>(console.warn('THREE.TSL: "overlay" has been renamed. Use "blendOverlay" instead.'),hD(n)),Hae=Ie(([n])=>g5(n.rgb)),Wae=Ie(([n,e=oe(1)])=>e.mix(g5(n.rgb),n.rgb)),$ae=Ie(([n,e=oe(1)])=>{const t=vr(n.r,n.g,n.b).div(3),i=n.r.max(n.g.max(n.b)),r=i.sub(t).mul(e).mul(-3);return li(n.rgb,i,r)}),jae=Ie(([n,e=oe(1)])=>{const t=Ce(.57735,.57735,.57735),i=e.cos();return Ce(n.rgb.mul(i).add(t.cross(n.rgb).mul(e.sin()).add(t.mul(ac(t,n.rgb).mul(i.oneMinus())))))}),g5=(n,e=Ce(Un.getLuminanceCoefficients(new re)))=>ac(n,e),Xae=Ie(([n,e=Ce(1),t=Ce(0),i=Ce(1),r=oe(1),s=Ce(Un.getLuminanceCoefficients(new re,Ma))])=>{const o=n.rgb.dot(Ce(s)),a=hr(n.rgb.mul(e).add(t),0).toVar(),l=a.pow(i).toVar();return Cn(a.r.greaterThan(0),()=>{a.r.assign(l.r)}),Cn(a.g.greaterThan(0),()=>{a.g.assign(l.g)}),Cn(a.b.greaterThan(0),()=>{a.b.assign(l.b)}),a.assign(o.add(a.sub(o).mul(r))),Xt(a.rgb,n.a)});class Qae extends fr{static get type(){return"PosterizeNode"}constructor(e,t){super(),this.sourceNode=e,this.stepsNode=t}setup(){const{sourceNode:e,stepsNode:t}=this;return e.mul(t).floor().div(t)}}const Yae=at(Qae).setParameterLength(2),s1=new rt;class fD extends gl{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class Hw extends fD{static get type(){return"PassMultipleTextureNode"}constructor(e,t,i=!1){super(e,null),this.textureName=t,this.previousTexture=i}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class _l extends fr{static get type(){return"PassNode"}constructor(e,t,i,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=i,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const s=new lo;s.isRenderTargetTexture=!0,s.name="depth";const o=new bl(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Dr,...r});o.texture.name="output",o.depthTexture=s,this.renderTarget=o,this._textures={output:o.texture,depth:s},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=jt(0),this._cameraFar=jt(0),this._mrt=null,this._layers=null,this._resolution=1,this.isPassNode=!0,this.updateBeforeType=Sn.FRAME}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}isGlobal(){return!0}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const i=this._textures[e],r=this.renderTarget.textures.indexOf(i);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=i,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=tt(new Hw(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=tt(new Hw(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const i=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=r5(this.getTextureNode(e),i,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const i=this._cameraNear,r=this._cameraFar,s=this.getViewZNode(e);this._linearDepthNodes[e]=t=tA(s,i,r)}return t}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,e.backend.isWebGLBackend===!0&&(this.renderTarget.samples=0),this.renderTarget.texture.type=e.getColorBufferType(),this.scope===_l.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:i}=this;let r,s;const o=t.getOutputRenderTarget();o&&o.isXRRenderTarget===!0?(s=1,r=t.xr.getCamera(),t.xr.updateCamera(r),s1.set(o.width,o.height)):(r=this.camera,s=t.getPixelRatio(),t.getSize(s1)),this._pixelRatio=s,this.setSize(s1.width,s1.height);const a=t.getRenderTarget(),l=t.getMRT(),u=r.layers.mask;this._cameraNear.value=r.near,this._cameraFar.value=r.far,this._layers!==null&&(r.layers.mask=this._layers.mask);for(const A in this._previousTextures)this.toggleTexture(A);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(i,r),t.setRenderTarget(a),t.setMRT(l),r.layers.mask=u}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio*this._resolution,r=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}_l.COLOR="color";_l.DEPTH="depth";const Zae=(n,e,t)=>tt(new _l(_l.COLOR,n,e,t)),Kae=(n,e)=>tt(new fD(n,e)),Jae=(n,e,t)=>tt(new _l(_l.DEPTH,n,e,t));class ele extends _l{static get type(){return"ToonOutlinePassNode"}constructor(e,t,i,r,s){super(_l.COLOR,e,t),this.colorNode=i,this.thicknessNode=r,this.alphaNode=s,this._materialCache=new WeakMap}updateBefore(e){const{renderer:t}=e,i=t.getRenderObjectFunction();t.setRenderObjectFunction((r,s,o,a,l,u,A,p)=>{if((l.isMeshToonMaterial||l.isMeshToonNodeMaterial)&&l.wireframe===!1){const g=this._getOutlineMaterial(l);t.renderObject(r,s,o,a,g,u,A,p)}t.renderObject(r,s,o,a,l,u,A,p)}),super.updateBefore(e),t.setRenderObjectFunction(i)}_createMaterial(){const e=new yr;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=wi;const t=ho.negate(),i=Ch.mul(Rh),r=oe(1),s=i.mul(Xt(lr,1)),o=i.mul(Xt(lr.add(t),1)),a=au(s.sub(o));return e.vertexNode=s.add(a.mul(this.thicknessNode).mul(s.w).mul(r)),e.colorNode=Xt(this.colorNode,this.alphaNode),e}_getOutlineMaterial(e){let t=this._materialCache.get(e);return t===void 0&&(t=this._createMaterial(),this._materialCache.set(e,t)),t}}const tle=(n,e,t=new Gt(0,0,0),i=.003,r=1)=>tt(new ele(n,e,tt(t),tt(i),tt(r))),AD=Ie(([n,e])=>n.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),dD=Ie(([n,e])=>(n=n.mul(e),n.div(n.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),pD=Ie(([n,e])=>{n=n.mul(e),n=n.sub(.004).max(0);const t=n.mul(n.mul(6.2).add(.5)),i=n.mul(n.mul(6.2).add(1.7)).add(.06);return t.div(i).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),nle=Ie(([n])=>{const e=n.mul(n.add(.0245786)).sub(90537e-9),t=n.mul(n.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),mD=Ie(([n,e])=>{const t=Ts(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),i=Ts(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return n=n.mul(e).div(.6),n=t.mul(n),n=nle(n),n=i.mul(n),n.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),ile=Ts(Ce(1.6605,-.1246,-.0182),Ce(-.5876,1.1329,-.1006),Ce(-.0728,-.0083,1.1187)),rle=Ts(Ce(.6274,.0691,.0164),Ce(.3293,.9195,.088),Ce(.0433,.0113,.8956)),sle=Ie(([n])=>{const e=Ce(n).toVar(),t=Ce(e.mul(e)).toVar(),i=Ce(t.mul(t)).toVar();return oe(15.5).mul(i.mul(t)).sub(wn(40.14,i.mul(e))).add(wn(31.96,i).sub(wn(6.868,t.mul(e))).add(wn(.4298,t).add(wn(.1191,e).sub(.00232))))}),gD=Ie(([n,e])=>{const t=Ce(n).toVar(),i=Ts(Ce(.856627153315983,.137318972929847,.11189821299995),Ce(.0951212405381588,.761241990602591,.0767994186031903),Ce(.0482516061458583,.101439036467562,.811302368396859)),r=Ts(Ce(1.1271005818144368,-.1413297634984383,-.14132976349843826),Ce(-.11060664309660323,1.157823702216272,-.11060664309660294),Ce(-.016493938717834573,-.016493938717834257,1.2519364065950405)),s=oe(-12.47393),o=oe(4.026069);return t.mulAssign(e),t.assign(rle.mul(t)),t.assign(i.mul(t)),t.assign(hr(t,1e-10)),t.assign(ll(t)),t.assign(t.sub(s).div(o.sub(s))),t.assign(pl(t,0,1)),t.assign(sle(t)),t.assign(r.mul(t)),t.assign(Sa(hr(Ce(0),t),Ce(2.2))),t.assign(ile.mul(t)),t.assign(pl(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),_D=Ie(([n,e])=>{const t=oe(.76),i=oe(.15);n=n.mul(e);const r=co(n.r,co(n.g,n.b)),s=Hr(r.lessThan(.08),r.sub(wn(6.25,r.mul(r))),.04);n.subAssign(s);const o=hr(n.r,hr(n.g,n.b));Cn(o.lessThan(t),()=>n);const a=Yn(1,t),l=Yn(1,a.mul(a).div(o.add(a.sub(t))));n.mulAssign(l.div(o));const u=Yn(1,Da(1,i.mul(o.sub(l)).add(1)));return li(n,Ce(l),u)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class Tr extends en{static get type(){return"CodeNode"}constructor(e="",t=[],i=""){super("code"),this.isCodeNode=!0,this.code=e,this.includes=t,this.language=i}isGlobal(){return!0}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const i=e.getCodeFromNode(this,this.getNodeType(e));return i.code=this.code,i.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}const p_=at(Tr).setParameterLength(1,3),ole=(n,e)=>p_(n,e,"js"),ale=(n,e)=>p_(n,e,"wgsl"),lle=(n,e)=>p_(n,e,"glsl");class vD extends Tr{static get type(){return"FunctionNode"}constructor(e="",t=[],i=""){super(e,t,i)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let i=t.nodeFunction;return i===void 0&&(i=e.parser.parseFunction(this.code),t.nodeFunction=i),i}generate(e,t){super.generate(e);const i=this.getNodeFunction(e),r=i.name,s=i.type,o=e.getCodeFromNode(this,s);r!==""&&(o.name=r);const a=e.getPropertyName(o),l=this.getNodeFunction(e).getCode(a);return o.code=l+`
`,t==="property"?a:e.format(`${a}()`,s,t)}}const yD=(n,e=[],t="")=>{for(let s=0;s<e.length;s++){const o=e[s];typeof o=="function"&&(e[s]=o.functionNode)}const i=tt(new vD(n,e,t)),r=(...s)=>i.call(...s);return r.functionNode=i,r},ule=(n,e)=>yD(n,e,"glsl"),cle=(n,e)=>yD(n,e,"wgsl");class hle extends en{static get type(){return"ScriptableValueNode"}constructor(e=null){super(),this._value=e,this._cache=null,this.inputType=null,this.outputType=null,this.events=new xl,this.isScriptableValueNode=!0}get isScriptableOutputNode(){return this.outputType!==null}set value(e){this._value!==e&&(this._cache&&this.inputType==="URL"&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){const e=this.value;if(e&&this._cache===null&&this.inputType==="URL"&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&e.value!==null&&e.value!==void 0&&((this.inputType==="URL"||this.inputType==="String")&&typeof e.value=="string"||this.inputType==="Number"&&typeof e.value=="number"||this.inputType==="Vector2"&&e.value.isVector2||this.inputType==="Vector3"&&e.value.isVector3||this.inputType==="Vector4"&&e.value.isVector4||this.inputType==="Color"&&e.value.isColor||this.inputType==="Matrix3"&&e.value.isMatrix3||this.inputType==="Matrix4"&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:oe()}serialize(e){super.serialize(e),this.value!==null?this.inputType==="ArrayBuffer"?e.value=wR(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let t=null;e.value!==null&&(e.inputType==="ArrayBuffer"?t=MR(e.value):e.inputType==="Texture"?t=e.meta.textures[e.value]:t=e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}}const tg=at(hle).setParameterLength(1);class xD extends Map{get(e,t=null,...i){if(this.has(e))return super.get(e);if(t!==null){const r=t(...i);return this.set(e,r),r}}}class fle{constructor(e){this.scriptableNode=e}get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){const t=this.parameters[e];return t?t.getValue():null}}const ng=new xD;class Ale extends en{static get type(){return"ScriptableNode"}constructor(e=null,t={}){super(),this.codeNode=e,this.parameters=t,this._local=new xD,this._output=tg(null),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,t){return this._local.set(e,t)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(const t of this.getLayout())if(t.inputType&&(t.id===e||t.name===e))return t}getOutputLayout(e){for(const t of this.getLayout())if(t.outputType&&(t.id===e||t.name===e))return t}setOutput(e,t){const i=this._outputs;return i[e]===void 0?i[e]=tg(t):i[e].value=t,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,t){const i=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),i[e]=t,i[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),i[e]=t,i[e].events.addEventListener("refresh",this.onRefresh)):i[e]===void 0?(i[e]=tg(t),i[e].events.addEventListener("refresh",this.onRefresh)):i[e].value=t,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(const e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e,...t){const r=this.getObject()[e];if(typeof r=="function")return r(...t)}async callAsync(e,...t){const r=this.getObject()[e];if(typeof r=="function")return r.constructor.name==="AsyncFunction"?await r(...t):r(...t)}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(e=null){e!==null?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),this._object!==null)return this._object;const e=()=>this.refresh(),t=(u,A)=>this.setOutput(u,A),i=new fle(this),r=ng.get("THREE"),s=ng.get("TSL"),o=this.getMethod(),a=[i,this._local,ng,e,t,r,s];this._object=o(...a);const l=this._object.layout;if(l&&(l.cache===!1&&this._local.clear(),this._output.outputType=l.outputType||null,Array.isArray(l.elements)))for(const u of l.elements){const A=u.id||u.name;u.inputType&&(this.getParameter(A)===void 0&&this.setParameter(A,null),this.getParameter(A).inputType=u.inputType),u.outputType&&(this.getOutput(A)===void 0&&this.setOutput(A,null),this.getOutput(A).outputType=u.outputType)}return this._object}deserialize(e){super.deserialize(e);for(const t in this.parameters){let i=this.parameters[t];i.isScriptableNode&&(i=i.getDefaultOutput()),i.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){const e=this.getDefaultOutput().value;return e&&e.isNode?e:oe()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),this._method!==null)return this._method;const e=["parameters","local","global","refresh","setOutput","THREE","TSL"],i=["layout","init","main","dispose"].join(", "),r="var "+i+`; var output = {};
`,s=`
return { ...output, `+i+" };",o=r+this.codeNode.code+s;return this._method=new Function(...e,o),this._method}dispose(){this._method!==null&&(this._object&&typeof this._object.dispose=="function"&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}getCacheKey(e){const t=[yR(this.source),this.getDefaultOutputNode().getCacheKey(e)];for(const i in this.parameters)t.push(this.parameters[i].getCacheKey(e));return W2(t)}set needsUpdate(e){e===!0&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return this.codeNode===null?this:(this._needsOutputUpdate===!0&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value,this)}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}const dle=at(Ale).setParameterLength(1,2);function bD(n){let e;const t=n.context.getViewZ;return t!==void 0&&(e=t(this)),(e||gr.z).negate()}const _5=Ie(([n,e],t)=>{const i=bD(t);return ml(n,e,i)}),v5=Ie(([n],e)=>{const t=bD(e);return n.mul(n,t,t).negate().exp().oneMinus()}),hp=Ie(([n,e])=>Xt(e.toFloat().mix(Jf.rgb,n.toVec3()),Jf.a));function ple(n,e,t){return console.warn('THREE.TSL: "rangeFog( color, near, far )" is deprecated. Use "fog( color, rangeFogFactor( near, far ) )" instead.'),hp(n,_5(e,t))}function mle(n,e){return console.warn('THREE.TSL: "densityFog( color, density )" is deprecated. Use "fog( color, densityFogFactor( density ) )" instead.'),hp(n,v5(e))}let Pc=null,Lc=null;class gle extends en{static get type(){return"RangeNode"}constructor(e=oe(),t=oe()){super(),this.minNode=e,this.maxNode=t}getVectorLength(e){const t=e.getTypeLength(Gu(this.minNode.value)),i=e.getTypeLength(Gu(this.maxNode.value));return t>i?t:i}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}setup(e){const t=e.object;let i=null;if(t.count>1){const r=this.minNode.value,s=this.maxNode.value,o=e.getTypeLength(Gu(r)),a=e.getTypeLength(Gu(s));Pc=Pc||new Kt,Lc=Lc||new Kt,Pc.setScalar(0),Lc.setScalar(0),o===1?Pc.setScalar(r):r.isColor?Pc.set(r.r,r.g,r.b,1):Pc.set(r.x,r.y,r.z||0,r.w||0),a===1?Lc.setScalar(s):s.isColor?Lc.set(s.r,s.g,s.b,1):Lc.set(s.x,s.y,s.z||0,s.w||0);const l=4,u=l*t.count,A=new Float32Array(u);for(let g=0;g<u;g++){const v=g%l,y=Pc.getComponent(v),b=Lc.getComponent(v);A[g]=xA.lerp(y,b,Math.random())}const p=this.getNodeType(e);if(t.count<=4096)i=Ip(A,"vec4",t.count).element(Yu).convert(p);else{const g=new Xu(A,4);e.geometry.setAttribute("__range"+this.id,g),i=l2(g).convert(p)}}else i=oe(0);return i}}const _le=at(gle).setParameterLength(2);class vle extends en{static get type(){return"ComputeBuiltinNode"}constructor(e,t){super(t),this._builtinName=e}getHash(e){return this.getBuiltinName(e)}getNodeType(){return this.nodeType}setBuiltinName(e){return this._builtinName=e,this}getBuiltinName(){return this._builtinName}hasBuiltin(e){return e.hasBuiltin(this._builtinName)}generate(e,t){const i=this.getBuiltinName(e),r=this.getNodeType(e);return e.shaderStage==="compute"?e.format(i,r,t):(console.warn(`ComputeBuiltinNode: Compute built-in value ${i} can not be accessed in the ${e.shaderStage} stage`),e.generateConst(r))}serialize(e){super.serialize(e),e.global=this.global,e._builtinName=this._builtinName}deserialize(e){super.deserialize(e),this.global=e.global,this._builtinName=e._builtinName}}const qp=(n,e)=>tt(new vle(n,e)),yle=qp("numWorkgroups","uvec3"),xle=qp("workgroupId","uvec3"),ble=qp("globalId","uvec3"),Tle=qp("localId","uvec3"),Sle=qp("subgroupSize","uint");class wle extends en{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:i}=e;i.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}const y5=at(wle),Mle=()=>y5("workgroup").toStack(),Ele=()=>y5("storage").toStack(),Cle=()=>y5("texture").toStack();class Rle extends Eh{constructor(e,t){super(e,t),this.isWorkgroupInfoElementNode=!0}generate(e,t){let i;const r=e.context.assign;if(i=super.generate(e),r!==!0){const s=this.getNodeType(e);i=e.format(i,s,t)}return i}}class Nle extends en{constructor(e,t,i=0){super(t),this.bufferType=t,this.bufferCount=i,this.isWorkgroupInfoNode=!0,this.elementType=t,this.scope=e}label(e){return this.name=e,this}setScope(e){return this.scope=e,this}getElementType(){return this.elementType}getInputType(){return`${this.scope}Array`}element(e){return tt(new Rle(this,e))}generate(e){return e.getScopedArray(this.name||`${this.scope}Array_${this.id}`,this.scope.toLowerCase(),this.bufferType,this.bufferCount)}}const Ple=(n,e)=>tt(new Nle("Workgroup",n,e));class Fr extends en{static get type(){return"AtomicFunctionNode"}constructor(e,t,i){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=i,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),i=t.parents,r=this.method,s=this.getNodeType(e),o=this.getInputType(e),a=this.pointerNode,l=this.valueNode,u=[];u.push(`&${a.build(e,o)}`),l!==null&&u.push(l.build(e,o));const A=`${e.getMethod(r,s)}( ${u.join(", ")} )`;if(i.length===1&&i[0].isStackNode===!0)e.addLineFlowCode(A,this);else return t.constNode===void 0&&(t.constNode=lu(A,s).toConst()),t.constNode.build(e)}}Fr.ATOMIC_LOAD="atomicLoad";Fr.ATOMIC_STORE="atomicStore";Fr.ATOMIC_ADD="atomicAdd";Fr.ATOMIC_SUB="atomicSub";Fr.ATOMIC_MAX="atomicMax";Fr.ATOMIC_MIN="atomicMin";Fr.ATOMIC_AND="atomicAnd";Fr.ATOMIC_OR="atomicOr";Fr.ATOMIC_XOR="atomicXor";const Lle=at(Fr),wl=(n,e,t)=>Lle(n,e,t).toStack(),Dle=n=>wl(Fr.ATOMIC_LOAD,n,null),Ile=(n,e)=>wl(Fr.ATOMIC_STORE,n,e),Ble=(n,e)=>wl(Fr.ATOMIC_ADD,n,e),Fle=(n,e)=>wl(Fr.ATOMIC_SUB,n,e),Ule=(n,e)=>wl(Fr.ATOMIC_MAX,n,e),Ole=(n,e)=>wl(Fr.ATOMIC_MIN,n,e),kle=(n,e)=>wl(Fr.ATOMIC_AND,n,e),Vle=(n,e)=>wl(Fr.ATOMIC_OR,n,e),zle=(n,e)=>wl(Fr.ATOMIC_XOR,n,e);let o1;function m_(n){o1=o1||new WeakMap;let e=o1.get(n);return e===void 0&&o1.set(n,e={}),e}function x5(n){const e=m_(n);return e.shadowMatrix||(e.shadowMatrix=jt("mat4").setGroup(nn).onRenderUpdate(()=>(n.castShadow!==!0&&n.shadow.updateMatrices(n),n.shadow.matrix)))}function TD(n,e=Kl){const t=x5(n).mul(e);return t.xyz.div(t.w)}function b5(n){const e=m_(n);return e.position||(e.position=jt(new re).setGroup(nn).onRenderUpdate((t,i)=>i.value.setFromMatrixPosition(n.matrixWorld)))}function SD(n){const e=m_(n);return e.targetPosition||(e.targetPosition=jt(new re).setGroup(nn).onRenderUpdate((t,i)=>i.value.setFromMatrixPosition(n.target.matrixWorld)))}function T5(n){const e=m_(n);return e.viewPosition||(e.viewPosition=jt(new re).setGroup(nn).onRenderUpdate(({camera:t},i)=>{i.value=i.value||new re,i.value.setFromMatrixPosition(n.matrixWorld),i.value.applyMatrix4(t.matrixWorldInverse)}))}const S5=n=>fo.transformDirection(b5(n).sub(SD(n))),qle=n=>n.sort((e,t)=>e.id-t.id),Gle=(n,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===n)return t;return null},Sv=new WeakMap;class w5 extends en{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Ce().toVar(),this.totalSpecularNode=Ce().toVar(),this.outgoingLightNode=Ce().toVar(),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=[],t=this._lights;for(let i=0;i<t.length;i++){const r=t[i];if(e.push(r.id),r.isSpotLight===!0){const s=r.map!==null?r.map.id:-1;e.push(s)}}return W2(e)}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const i of this._lightNodes)t.push(i.getSelf().getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getDataFromNode(this);for(const i of t.nodes)i.build(e)}setupLightsNode(e){const t=[],i=this._lightNodes,r=qle(this._lights),s=e.renderer.library;for(const o of r)if(o.isNode)t.push(tt(o));else{let a=null;if(i!==null&&(a=Gle(o.id,i)),a===null){const l=s.getLightNodeClass(o.constructor);if(l===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${o.constructor.name}`);continue}let u=null;Sv.has(o)?u=Sv.get(o):(u=tt(new l(o)),Sv.set(o,u)),t.push(u)}}this._lightNodes=t}setupDirectLight(e,t,i){const{lightingModel:r,reflectedLight:s}=e.context;r.direct({...i,lightNode:t,reflectedLight:s},e)}setupDirectRectAreaLight(e,t,i){const{lightingModel:r,reflectedLight:s}=e.context;r.directRectArea({...i,lightNode:t,reflectedLight:s},e)}setupLights(e,t){for(const i of t)i.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let i=this.outgoingLightNode;const r=e.context,s=r.lightingModel,o=e.getDataFromNode(this);if(s){const{totalDiffuseNode:a,totalSpecularNode:l}=this;r.outgoingLight=i;const u=e.addStack();o.nodes=u.nodes,s.start(e);const{backdrop:A,backdropAlpha:p}=r,{directDiffuse:g,directSpecular:v,indirectDiffuse:y,indirectSpecular:b}=r.reflectedLight;let w=g.add(y);A!==null&&(p!==null?w=Ce(p.mix(w,A)):w=Ce(A),r.material.transparent=!0),a.assign(w),l.assign(v.add(b)),i.assign(a.add(l)),s.finish(e),i=i.bypass(e.removeStack())}else o.nodes=[];return e.lightsNode=t,i}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}const Hle=(n=[])=>tt(new w5).setLights(n);class Wle extends en{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=Sn.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){M5.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||Kl)}dispose(){this.updateBeforeType=Sn.NONE}}const M5=WA("vec3","shadowPositionWorld");function $le(n,e={}){return e.toneMapping=n.toneMapping,e.toneMappingExposure=n.toneMappingExposure,e.outputColorSpace=n.outputColorSpace,e.renderTarget=n.getRenderTarget(),e.activeCubeFace=n.getActiveCubeFace(),e.activeMipmapLevel=n.getActiveMipmapLevel(),e.renderObjectFunction=n.getRenderObjectFunction(),e.pixelRatio=n.getPixelRatio(),e.mrt=n.getMRT(),e.clearColor=n.getClearColor(e.clearColor||new Gt),e.clearAlpha=n.getClearAlpha(),e.autoClear=n.autoClear,e.scissorTest=n.getScissorTest(),e}function jle(n,e){return e=$le(n,e),n.setMRT(null),n.setRenderObjectFunction(null),n.setClearColor(0,1),n.autoClear=!0,e}function Xle(n,e){n.toneMapping=e.toneMapping,n.toneMappingExposure=e.toneMappingExposure,n.outputColorSpace=e.outputColorSpace,n.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),n.setRenderObjectFunction(e.renderObjectFunction),n.setPixelRatio(e.pixelRatio),n.setMRT(e.mrt),n.setClearColor(e.clearColor,e.clearAlpha),n.autoClear=e.autoClear,n.setScissorTest(e.scissorTest)}function Qle(n,e={}){return e.background=n.background,e.backgroundNode=n.backgroundNode,e.overrideMaterial=n.overrideMaterial,e}function Yle(n,e){return e=Qle(n,e),n.background=null,n.backgroundNode=null,n.overrideMaterial=null,e}function Zle(n,e){n.background=e.background,n.backgroundNode=e.backgroundNode,n.overrideMaterial=e.overrideMaterial}function Kle(n,e,t){return t=jle(n,t),t=Yle(e,t),t}function Jle(n,e,t){Xle(n,t),Zle(e,t)}const Ww=new WeakMap,wD=Ie(({depthTexture:n,shadowCoord:e,depthLayer:t})=>{let i=Vn(n,e.xy).label("t_basic");return n.isDepthArrayTexture&&(i=i.depth(t)),i.compare(e.z)}),MD=Ie(({depthTexture:n,shadowCoord:e,shadow:t,depthLayer:i})=>{const r=(w,S)=>{let C=Vn(n,w);return n.isDepthArrayTexture&&(C=C.depth(i)),C.compare(S)},s=xi("mapSize","vec2",t).setGroup(nn),o=xi("radius","float",t).setGroup(nn),a=ut(1).div(s),l=a.x.negate().mul(o),u=a.y.negate().mul(o),A=a.x.mul(o),p=a.y.mul(o),g=l.div(2),v=u.div(2),y=A.div(2),b=p.div(2);return vr(r(e.xy.add(ut(l,u)),e.z),r(e.xy.add(ut(0,u)),e.z),r(e.xy.add(ut(A,u)),e.z),r(e.xy.add(ut(g,v)),e.z),r(e.xy.add(ut(0,v)),e.z),r(e.xy.add(ut(y,v)),e.z),r(e.xy.add(ut(l,0)),e.z),r(e.xy.add(ut(g,0)),e.z),r(e.xy,e.z),r(e.xy.add(ut(y,0)),e.z),r(e.xy.add(ut(A,0)),e.z),r(e.xy.add(ut(g,b)),e.z),r(e.xy.add(ut(0,b)),e.z),r(e.xy.add(ut(y,b)),e.z),r(e.xy.add(ut(l,p)),e.z),r(e.xy.add(ut(0,p)),e.z),r(e.xy.add(ut(A,p)),e.z)).mul(1/17)}),ED=Ie(({depthTexture:n,shadowCoord:e,shadow:t,depthLayer:i})=>{const r=(p,g)=>{let v=Vn(n,p);return n.isDepthArrayTexture&&(v=v.depth(i)),v.compare(g)},s=xi("mapSize","vec2",t).setGroup(nn),o=ut(1).div(s),a=o.x,l=o.y,u=e.xy,A=Au(u.mul(s).add(.5));return u.subAssign(A.mul(o)),vr(r(u,e.z),r(u.add(ut(a,0)),e.z),r(u.add(ut(0,l)),e.z),r(u.add(o),e.z),li(r(u.add(ut(a.negate(),0)),e.z),r(u.add(ut(a.mul(2),0)),e.z),A.x),li(r(u.add(ut(a.negate(),l)),e.z),r(u.add(ut(a.mul(2),l)),e.z),A.x),li(r(u.add(ut(0,l.negate())),e.z),r(u.add(ut(0,l.mul(2))),e.z),A.y),li(r(u.add(ut(a,l.negate())),e.z),r(u.add(ut(a,l.mul(2))),e.z),A.y),li(li(r(u.add(ut(a.negate(),l.negate())),e.z),r(u.add(ut(a.mul(2),l.negate())),e.z),A.x),li(r(u.add(ut(a.negate(),l.mul(2))),e.z),r(u.add(ut(a.mul(2),l.mul(2))),e.z),A.x),A.y)).mul(1/9)}),CD=Ie(({depthTexture:n,shadowCoord:e,depthLayer:t})=>{const i=oe(1).toVar();let r=Vn(n).sample(e.xy);(n.isDepthArrayTexture||n.isDataArrayTexture)&&(r=r.depth(t)),r=r.rg;const s=t_(e.z,r.x);return Cn(s.notEqual(oe(1)),()=>{const o=e.z.sub(r.x),a=hr(0,r.y.mul(r.y));let l=a.div(a.add(o.mul(o)));l=pl(Yn(l,.3).div(.95-.3)),i.assign(pl(hr(s,l)))}),i}),eue=Ie(([n,e,t])=>{let i=Kl.sub(n).length();return i=i.sub(e).div(t.sub(e)),i=i.saturate(),i}),tue=n=>{const e=n.shadow.camera,t=xi("near","float",e).setGroup(nn),i=xi("far","float",e).setGroup(nn),r=mP(n);return eue(r,t,i)},RD=n=>{let e=Ww.get(n);if(e===void 0){const t=n.isPointLight?tue(n):null;e=new yr,e.colorNode=Xt(0,0,0,1),e.depthNode=t,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,Ww.set(n,e)}return e},$w=new Ia,Af=[],ND=(n,e,t,i)=>{Af[0]=n,Af[1]=e;let r=$w.get(Af);return(r===void 0||r.shadowType!==t||r.useVelocity!==i)&&(r=(s,o,a,l,u,A,...p)=>{(s.castShadow===!0||s.receiveShadow&&t===wo)&&(i&&(SR(s).useVelocity=!0),s.onBeforeShadow(n,s,a,e.camera,l,o.overrideMaterial,A),n.renderObject(s,o,a,l,u,A,...p),s.onAfterShadow(n,s,a,e.camera,l,o.overrideMaterial,A))},r.shadowType=t,r.useVelocity=i,$w.set(Af,r)),Af[0]=null,Af[1]=null,r},nue=Ie(({samples:n,radius:e,size:t,shadowPass:i,depthLayer:r})=>{const s=oe(0).toVar("meanVertical"),o=oe(0).toVar("squareMeanVertical"),a=n.lessThanEqual(oe(1)).select(oe(0),oe(2).div(n.sub(1))),l=n.lessThanEqual(oe(1)).select(oe(0),oe(-1));ui({start:_e(0),end:_e(n),type:"int",condition:"<"},({i:A})=>{const p=l.add(oe(A).mul(a));let g=i.sample(vr(zp.xy,ut(0,p).mul(e)).div(t));(i.value.isDepthArrayTexture||i.value.isDataArrayTexture)&&(g=g.depth(r)),g=g.x,s.addAssign(g),o.addAssign(g.mul(g))}),s.divAssign(n),o.divAssign(n);const u=Sl(o.sub(s.mul(s)));return ut(s,u)}),iue=Ie(({samples:n,radius:e,size:t,shadowPass:i,depthLayer:r})=>{const s=oe(0).toVar("meanHorizontal"),o=oe(0).toVar("squareMeanHorizontal"),a=n.lessThanEqual(oe(1)).select(oe(0),oe(2).div(n.sub(1))),l=n.lessThanEqual(oe(1)).select(oe(0),oe(-1));ui({start:_e(0),end:_e(n),type:"int",condition:"<"},({i:A})=>{const p=l.add(oe(A).mul(a));let g=i.sample(vr(zp.xy,ut(p,0).mul(e)).div(t));(i.value.isDepthArrayTexture||i.value.isDataArrayTexture)&&(g=g.depth(r)),s.addAssign(g.x),o.addAssign(vr(g.y.mul(g.y),g.x.mul(g.x)))}),s.divAssign(n),o.divAssign(n);const u=Sl(o.sub(s.mul(s)));return ut(s,u)}),rue=[wD,MD,ED,CD];let wv;const a1=new m5;class PD extends Wle{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:i,shadowCoord:r,shadow:s,depthLayer:o}){const a=r.x.greaterThanEqual(0).and(r.x.lessThanEqual(1)).and(r.y.greaterThanEqual(0)).and(r.y.lessThanEqual(1)).and(r.z.lessThanEqual(1)),l=t({depthTexture:i,shadowCoord:r,shadow:s,depthLayer:o});return a.select(l,oe(1))}setupShadowCoord(e,t){const{shadow:i}=this,{renderer:r}=e,s=xi("bias","float",i).setGroup(nn);let o=t,a;if(i.camera.isOrthographicCamera||r.logarithmicDepthBuffer!==!0)o=o.xyz.div(o.w),a=o.z,r.coordinateSystem===Al&&(a=a.mul(2).sub(1));else{const l=o.w;o=o.xy.div(l);const u=xi("near","float",i.camera).setGroup(nn),A=xi("far","float",i.camera).setGroup(nn);a=s5(l.negate(),u,A)}return o=Ce(o.x,o.y.oneMinus(),a.add(s)),o}getShadowFilterFn(e){return rue[e]}setupRenderTarget(e,t){const i=new lo(e.mapSize.width,e.mapSize.height);i.name="ShadowDepthTexture",i.compareFunction=P2;const r=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return r.texture.name="ShadowMap",r.texture.type=e.mapType,r.depthTexture=i,{shadowMap:r,depthTexture:i}}setupShadow(e){const{renderer:t}=e,{light:i,shadow:r}=this,s=t.shadowMap.type,{depthTexture:o,shadowMap:a}=this.setupRenderTarget(r,e);if(r.camera.updateProjectionMatrix(),s===wo){o.compareFunction=null,a.isRenderTargetArray?(a._vsmShadowMapVertical||(a._vsmShadowMapVertical=e.createRenderTargetArray(r.mapSize.width,r.mapSize.height,a.depth,{format:jl,type:Dr,depthBuffer:!1}),a._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=a._vsmShadowMapVertical,a._vsmShadowMapHorizontal||(a._vsmShadowMapHorizontal=e.createRenderTargetArray(r.mapSize.width,r.mapSize.height,a.depth,{format:jl,type:Dr,depthBuffer:!1}),a._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=a._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:jl,type:Dr,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:jl,type:Dr,depthBuffer:!1}));let S=Vn(o);o.isDepthArrayTexture&&(S=S.depth(this.depthLayer));let C=Vn(this.vsmShadowMapVertical.texture);o.isDepthArrayTexture&&(C=C.depth(this.depthLayer));const E=xi("blurSamples","float",r).setGroup(nn),R=xi("radius","float",r).setGroup(nn),D=xi("mapSize","vec2",r).setGroup(nn);let B=this.vsmMaterialVertical||(this.vsmMaterialVertical=new yr);B.fragmentNode=nue({samples:E,radius:R,size:D,shadowPass:S,depthLayer:this.depthLayer}).context(e.getSharedContext()),B.name="VSMVertical",B=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new yr),B.fragmentNode=iue({samples:E,radius:R,size:D,shadowPass:C,depthLayer:this.depthLayer}).context(e.getSharedContext()),B.name="VSMHorizontal"}const l=xi("intensity","float",r).setGroup(nn),u=xi("normalBias","float",r).setGroup(nn),A=x5(i).mul(M5.add(l_.mul(u))),p=this.setupShadowCoord(e,A),g=r.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(g===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const v=s===wo?this.vsmShadowMapHorizontal.texture:o,y=this.setupShadowFilter(e,{filterFn:g,shadowTexture:a.texture,depthTexture:v,shadowCoord:p,shadow:r,depthLayer:this.depthLayer});let b=Vn(a.texture,p);o.isDepthArrayTexture&&(b=b.depth(this.depthLayer));const w=li(1,y.rgb.mix(b,1),l.mul(b.a)).toVar();return this.shadowMap=a,this.shadow.map=a,w}setup(e){if(e.renderer.shadowMap.enabled!==!1)return Ie(()=>{let t=this._node;return this.setupShadowPosition(e),t===null&&(this._node=t=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(t=e.material.receivedShadowNode(t)),t})()}renderShadow(e){const{shadow:t,shadowMap:i,light:r}=this,{renderer:s,scene:o}=e;t.updateMatrices(r),i.setSize(t.mapSize.width,t.mapSize.height,i.depth),s.render(o,t.camera)}updateShadow(e){const{shadowMap:t,light:i,shadow:r}=this,{renderer:s,scene:o,camera:a}=e,l=s.shadowMap.type,u=t.depthTexture.version;this._depthVersionCached=u;const A=r.camera.layers.mask;(r.camera.layers.mask&4294967294)===0&&(r.camera.layers.mask=a.layers.mask);const p=s.getRenderObjectFunction(),g=s.getMRT(),v=g?g.has("velocity"):!1;wv=Kle(s,o,wv),o.overrideMaterial=RD(i),s.setRenderObjectFunction(ND(s,r,l,v)),s.setClearColor(0,0),s.setRenderTarget(t),this.renderShadow(e),s.setRenderObjectFunction(p),i.isPointLight!==!0&&l===wo&&this.vsmPass(s),r.camera.layers.mask=A,Jle(s,o,wv)}vsmPass(e){const{shadow:t}=this,i=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,i),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,i),e.setRenderTarget(this.vsmShadowMapVertical),a1.material=this.vsmMaterialVertical,a1.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),a1.material=this.vsmMaterialHorizontal,a1.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:t}=this;let i=t.needsUpdate||t.autoUpdate;i&&(this._cameraFrameId[e.camera]===e.frameId&&(i=!1),this._cameraFrameId[e.camera]=e.frameId),i&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const LD=(n,e)=>tt(new PD(n,e)),sue=new Gt,_a=Ie(([n,e])=>{const t=n.toVar(),i=Pi(t),r=Da(1,hr(i.x,hr(i.y,i.z)));i.mulAssign(r),t.mulAssign(r.mul(e.mul(2).oneMinus()));const s=ut(t.xy).toVar(),a=e.mul(1.5).oneMinus();return Cn(i.z.greaterThanEqual(a),()=>{Cn(t.z.greaterThan(0),()=>{s.x.assign(Yn(4,t.x))})}).ElseIf(i.x.greaterThanEqual(a),()=>{const l=up(t.x);s.x.assign(t.z.mul(l).add(l.mul(2)))}).ElseIf(i.y.greaterThanEqual(a),()=>{const l=up(t.y);s.x.assign(t.x.add(l.mul(2)).add(2)),s.y.assign(t.z.mul(l).sub(2))}),ut(.125,.25).mul(s).add(ut(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),DD=Ie(({depthTexture:n,bd3D:e,dp:t,texelSize:i})=>Vn(n,_a(e,i.y)).compare(t)),ID=Ie(({depthTexture:n,bd3D:e,dp:t,texelSize:i,shadow:r})=>{const s=xi("radius","float",r).setGroup(nn),o=ut(-1,1).mul(s).mul(i.y);return Vn(n,_a(e.add(o.xyy),i.y)).compare(t).add(Vn(n,_a(e.add(o.yyy),i.y)).compare(t)).add(Vn(n,_a(e.add(o.xyx),i.y)).compare(t)).add(Vn(n,_a(e.add(o.yyx),i.y)).compare(t)).add(Vn(n,_a(e,i.y)).compare(t)).add(Vn(n,_a(e.add(o.xxy),i.y)).compare(t)).add(Vn(n,_a(e.add(o.yxy),i.y)).compare(t)).add(Vn(n,_a(e.add(o.xxx),i.y)).compare(t)).add(Vn(n,_a(e.add(o.yxx),i.y)).compare(t)).mul(1/9)}),oue=Ie(({filterFn:n,depthTexture:e,shadowCoord:t,shadow:i})=>{const r=t.xyz.toVar(),s=r.length(),o=jt("float").setGroup(nn).onRenderUpdate(()=>i.camera.near),a=jt("float").setGroup(nn).onRenderUpdate(()=>i.camera.far),l=xi("bias","float",i).setGroup(nn),u=jt(i.mapSize).setGroup(nn),A=oe(1).toVar();return Cn(s.sub(a).lessThanEqual(0).and(s.sub(o).greaterThanEqual(0)),()=>{const p=s.sub(o).div(a.sub(o)).toVar();p.addAssign(l);const g=r.normalize(),v=ut(1).div(u.mul(ut(4,2)));A.assign(n({depthTexture:e,bd3D:g,dp:p,texelSize:v,shadow:i}))}),A}),jw=new Kt,df=new rt,C0=new rt;class aue extends PD{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===Pq?DD:ID}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,shadowTexture:i,depthTexture:r,shadowCoord:s,shadow:o}){return oue({filterFn:t,shadowTexture:i,depthTexture:r,shadowCoord:s,shadow:o})}renderShadow(e){const{shadow:t,shadowMap:i,light:r}=this,{renderer:s,scene:o}=e,a=t.getFrameExtents();C0.copy(t.mapSize),C0.multiply(a),i.setSize(C0.width,C0.height),df.copy(t.mapSize);const l=s.autoClear,u=s.getClearColor(sue),A=s.getClearAlpha();s.autoClear=!1,s.setClearColor(t.clearColor,t.clearAlpha),s.clear();const p=t.getViewportCount();for(let g=0;g<p;g++){const v=t.getViewport(g),y=df.x*v.x,b=C0.y-df.y-df.y*v.y;jw.set(y,b,df.x*v.z,df.y*v.w),i.viewport.copy(jw),t.updateMatrices(r,g),s.render(o,t.camera)}s.autoClear=l,s.setClearColor(u,A)}}const BD=(n,e)=>tt(new aue(n,e));class Ph extends $A{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new Gt,this.colorNode=e&&e.colorNode||jt(this.color).setGroup(nn),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=Sn.FRAME}customCacheKey(){return np(this.light.id,this.light.castShadow?1:0)}getHash(){return this.light.uuid}getLightVector(e){return T5(this.light).sub(e.context.positionView||gr)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return LD(this.light)}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let i=this.shadowColorNode;if(i===null){const r=this.light.shadow.shadowNode;let s;r!==void 0?s=tt(r):s=this.setupShadowNode(),this.shadowNode=s,this.shadowColorNode=i=this.colorNode.mul(s),this.baseColorNode=this.colorNode}this.colorNode=i}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),i=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),i&&e.lightsNode.setupDirectRectAreaLight(e,this,i)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const E5=Ie(({lightDistance:n,cutoffDistance:e,decayExponent:t})=>{const i=n.pow(t).max(.01).reciprocal();return e.greaterThan(0).select(i.mul(n.div(e).pow4().oneMinus().clamp().pow2()),i)}),FD=({color:n,lightVector:e,cutoffDistance:t,decayExponent:i})=>{const r=e.normalize(),s=e.length(),o=E5({lightDistance:s,cutoffDistance:t,decayExponent:i}),a=n.mul(o);return{lightDirection:r,lightColor:a}};class lue extends Ph{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=jt(0).setGroup(nn),this.decayExponentNode=jt(2).setGroup(nn)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return BD(this.light)}setupDirect(e){return FD({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const uue=Ie(([n=Wi()])=>{const e=n.mul(2),t=e.x.floor(),i=e.y.floor();return t.add(i).mod(2).sign()}),cue=Ie(([n=Wi()],{renderer:e,material:t})=>{const i=oe(1).toVar(),r=Gb(n.mul(2).sub(1));if(t.alphaToCoverage&&e.samples>1){const s=oe(r.fwidth()).toVar();i.assign(ml(s.oneMinus(),s.add(1),r).oneMinus())}else r.greaterThan(1).discard();return i}),Ad=Ie(([n,e,t])=>{const i=oe(t).toVar(),r=oe(e).toVar(),s=ou(n).toVar();return Hr(s,r,i)}).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),f2=Ie(([n,e])=>{const t=ou(e).toVar(),i=oe(n).toVar();return Hr(t,i.negate(),i)}).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),_r=Ie(([n])=>{const e=oe(n).toVar();return _e(ul(e))}).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),Gi=Ie(([n,e])=>{const t=oe(n).toVar();return e.assign(_r(t)),t.sub(oe(e))}),hue=Ie(([n,e,t,i,r,s])=>{const o=oe(s).toVar(),a=oe(r).toVar(),l=oe(i).toVar(),u=oe(t).toVar(),A=oe(e).toVar(),p=oe(n).toVar(),g=oe(Yn(1,a)).toVar();return Yn(1,o).mul(p.mul(g).add(A.mul(a))).add(o.mul(u.mul(g).add(l.mul(a))))}).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),fue=Ie(([n,e,t,i,r,s])=>{const o=oe(s).toVar(),a=oe(r).toVar(),l=Ce(i).toVar(),u=Ce(t).toVar(),A=Ce(e).toVar(),p=Ce(n).toVar(),g=oe(Yn(1,a)).toVar();return Yn(1,o).mul(p.mul(g).add(A.mul(a))).add(o.mul(u.mul(g).add(l.mul(a))))}).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]}),UD=as([hue,fue]),Aue=Ie(([n,e,t,i,r,s,o,a,l,u,A])=>{const p=oe(A).toVar(),g=oe(u).toVar(),v=oe(l).toVar(),y=oe(a).toVar(),b=oe(o).toVar(),w=oe(s).toVar(),S=oe(r).toVar(),C=oe(i).toVar(),E=oe(t).toVar(),R=oe(e).toVar(),D=oe(n).toVar(),B=oe(Yn(1,v)).toVar(),L=oe(Yn(1,g)).toVar();return oe(Yn(1,p)).toVar().mul(L.mul(D.mul(B).add(R.mul(v))).add(g.mul(E.mul(B).add(C.mul(v))))).add(p.mul(L.mul(S.mul(B).add(w.mul(v))).add(g.mul(b.mul(B).add(y.mul(v))))))}).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),due=Ie(([n,e,t,i,r,s,o,a,l,u,A])=>{const p=oe(A).toVar(),g=oe(u).toVar(),v=oe(l).toVar(),y=Ce(a).toVar(),b=Ce(o).toVar(),w=Ce(s).toVar(),S=Ce(r).toVar(),C=Ce(i).toVar(),E=Ce(t).toVar(),R=Ce(e).toVar(),D=Ce(n).toVar(),B=oe(Yn(1,v)).toVar(),L=oe(Yn(1,g)).toVar();return oe(Yn(1,p)).toVar().mul(L.mul(D.mul(B).add(R.mul(v))).add(g.mul(E.mul(B).add(C.mul(v))))).add(p.mul(L.mul(S.mul(B).add(w.mul(v))).add(g.mul(b.mul(B).add(y.mul(v))))))}).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),OD=as([Aue,due]),pue=Ie(([n,e,t])=>{const i=oe(t).toVar(),r=oe(e).toVar(),s=Bt(n).toVar(),o=Bt(s.bitAnd(Bt(7))).toVar(),a=oe(Ad(o.lessThan(Bt(4)),r,i)).toVar(),l=oe(wn(2,Ad(o.lessThan(Bt(4)),i,r))).toVar();return f2(a,ou(o.bitAnd(Bt(1)))).add(f2(l,ou(o.bitAnd(Bt(2)))))}).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),mue=Ie(([n,e,t,i])=>{const r=oe(i).toVar(),s=oe(t).toVar(),o=oe(e).toVar(),a=Bt(n).toVar(),l=Bt(a.bitAnd(Bt(15))).toVar(),u=oe(Ad(l.lessThan(Bt(8)),o,s)).toVar(),A=oe(Ad(l.lessThan(Bt(4)),s,Ad(l.equal(Bt(12)).or(l.equal(Bt(14))),o,r))).toVar();return f2(u,ou(l.bitAnd(Bt(1)))).add(f2(A,ou(l.bitAnd(Bt(2)))))}).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),Vr=as([pue,mue]),gue=Ie(([n,e,t])=>{const i=oe(t).toVar(),r=oe(e).toVar(),s=HA(n).toVar();return Ce(Vr(s.x,r,i),Vr(s.y,r,i),Vr(s.z,r,i))}).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),_ue=Ie(([n,e,t,i])=>{const r=oe(i).toVar(),s=oe(t).toVar(),o=oe(e).toVar(),a=HA(n).toVar();return Ce(Vr(a.x,o,s,r),Vr(a.y,o,s,r),Vr(a.z,o,s,r))}).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),jo=as([gue,_ue]),vue=Ie(([n])=>{const e=oe(n).toVar();return wn(.6616,e)}).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),yue=Ie(([n])=>{const e=oe(n).toVar();return wn(.982,e)}).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),xue=Ie(([n])=>{const e=Ce(n).toVar();return wn(.6616,e)}).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),kD=as([vue,xue]),bue=Ie(([n])=>{const e=Ce(n).toVar();return wn(.982,e)}).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),VD=as([yue,bue]),Co=Ie(([n,e])=>{const t=_e(e).toVar(),i=Bt(n).toVar();return i.shiftLeft(t).bitOr(i.shiftRight(_e(32).sub(t)))}).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),zD=Ie(([n,e,t])=>{n.subAssign(t),n.bitXorAssign(Co(t,_e(4))),t.addAssign(e),e.subAssign(n),e.bitXorAssign(Co(n,_e(6))),n.addAssign(t),t.subAssign(e),t.bitXorAssign(Co(e,_e(8))),e.addAssign(n),n.subAssign(t),n.bitXorAssign(Co(t,_e(16))),t.addAssign(e),e.subAssign(n),e.bitXorAssign(Co(n,_e(19))),n.addAssign(t),t.subAssign(e),t.bitXorAssign(Co(e,_e(4))),e.addAssign(n)}),Gp=Ie(([n,e,t])=>{const i=Bt(t).toVar(),r=Bt(e).toVar(),s=Bt(n).toVar();return i.bitXorAssign(r),i.subAssign(Co(r,_e(14))),s.bitXorAssign(i),s.subAssign(Co(i,_e(11))),r.bitXorAssign(s),r.subAssign(Co(s,_e(25))),i.bitXorAssign(r),i.subAssign(Co(r,_e(16))),s.bitXorAssign(i),s.subAssign(Co(i,_e(4))),r.bitXorAssign(s),r.subAssign(Co(s,_e(14))),i.bitXorAssign(r),i.subAssign(Co(r,_e(24))),i}).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),xs=Ie(([n])=>{const e=Bt(n).toVar();return oe(e).div(oe(Bt(_e(4294967295))))}).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),cl=Ie(([n])=>{const e=oe(n).toVar();return e.mul(e).mul(e).mul(e.mul(e.mul(6).sub(15)).add(10))}).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),Tue=Ie(([n])=>{const e=_e(n).toVar(),t=Bt(Bt(1)).toVar(),i=Bt(Bt(_e(3735928559)).add(t.shiftLeft(Bt(2))).add(Bt(13))).toVar();return Gp(i.add(Bt(e)),i,i)}).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),Sue=Ie(([n,e])=>{const t=_e(e).toVar(),i=_e(n).toVar(),r=Bt(Bt(2)).toVar(),s=Bt().toVar(),o=Bt().toVar(),a=Bt().toVar();return s.assign(o.assign(a.assign(Bt(_e(3735928559)).add(r.shiftLeft(Bt(2))).add(Bt(13))))),s.addAssign(Bt(i)),o.addAssign(Bt(t)),Gp(s,o,a)}).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),wue=Ie(([n,e,t])=>{const i=_e(t).toVar(),r=_e(e).toVar(),s=_e(n).toVar(),o=Bt(Bt(3)).toVar(),a=Bt().toVar(),l=Bt().toVar(),u=Bt().toVar();return a.assign(l.assign(u.assign(Bt(_e(3735928559)).add(o.shiftLeft(Bt(2))).add(Bt(13))))),a.addAssign(Bt(s)),l.addAssign(Bt(r)),u.addAssign(Bt(i)),Gp(a,l,u)}).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),Mue=Ie(([n,e,t,i])=>{const r=_e(i).toVar(),s=_e(t).toVar(),o=_e(e).toVar(),a=_e(n).toVar(),l=Bt(Bt(4)).toVar(),u=Bt().toVar(),A=Bt().toVar(),p=Bt().toVar();return u.assign(A.assign(p.assign(Bt(_e(3735928559)).add(l.shiftLeft(Bt(2))).add(Bt(13))))),u.addAssign(Bt(a)),A.addAssign(Bt(o)),p.addAssign(Bt(s)),zD(u,A,p),u.addAssign(Bt(r)),Gp(u,A,p)}).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),Eue=Ie(([n,e,t,i,r])=>{const s=_e(r).toVar(),o=_e(i).toVar(),a=_e(t).toVar(),l=_e(e).toVar(),u=_e(n).toVar(),A=Bt(Bt(5)).toVar(),p=Bt().toVar(),g=Bt().toVar(),v=Bt().toVar();return p.assign(g.assign(v.assign(Bt(_e(3735928559)).add(A.shiftLeft(Bt(2))).add(Bt(13))))),p.addAssign(Bt(u)),g.addAssign(Bt(l)),v.addAssign(Bt(a)),zD(p,g,v),p.addAssign(Bt(o)),g.addAssign(Bt(s)),Gp(p,g,v)}).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]}),di=as([Tue,Sue,wue,Mue,Eue]),Cue=Ie(([n,e])=>{const t=_e(e).toVar(),i=_e(n).toVar(),r=Bt(di(i,t)).toVar(),s=HA().toVar();return s.x.assign(r.bitAnd(_e(255))),s.y.assign(r.shiftRight(_e(8)).bitAnd(_e(255))),s.z.assign(r.shiftRight(_e(16)).bitAnd(_e(255))),s}).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),Rue=Ie(([n,e,t])=>{const i=_e(t).toVar(),r=_e(e).toVar(),s=_e(n).toVar(),o=Bt(di(s,r,i)).toVar(),a=HA().toVar();return a.x.assign(o.bitAnd(_e(255))),a.y.assign(o.shiftRight(_e(8)).bitAnd(_e(255))),a.z.assign(o.shiftRight(_e(16)).bitAnd(_e(255))),a}).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),Xo=as([Cue,Rue]),Nue=Ie(([n])=>{const e=ut(n).toVar(),t=_e().toVar(),i=_e().toVar(),r=oe(Gi(e.x,t)).toVar(),s=oe(Gi(e.y,i)).toVar(),o=oe(cl(r)).toVar(),a=oe(cl(s)).toVar(),l=oe(UD(Vr(di(t,i),r,s),Vr(di(t.add(_e(1)),i),r.sub(1),s),Vr(di(t,i.add(_e(1))),r,s.sub(1)),Vr(di(t.add(_e(1)),i.add(_e(1))),r.sub(1),s.sub(1)),o,a)).toVar();return kD(l)}).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),Pue=Ie(([n])=>{const e=Ce(n).toVar(),t=_e().toVar(),i=_e().toVar(),r=_e().toVar(),s=oe(Gi(e.x,t)).toVar(),o=oe(Gi(e.y,i)).toVar(),a=oe(Gi(e.z,r)).toVar(),l=oe(cl(s)).toVar(),u=oe(cl(o)).toVar(),A=oe(cl(a)).toVar(),p=oe(OD(Vr(di(t,i,r),s,o,a),Vr(di(t.add(_e(1)),i,r),s.sub(1),o,a),Vr(di(t,i.add(_e(1)),r),s,o.sub(1),a),Vr(di(t.add(_e(1)),i.add(_e(1)),r),s.sub(1),o.sub(1),a),Vr(di(t,i,r.add(_e(1))),s,o,a.sub(1)),Vr(di(t.add(_e(1)),i,r.add(_e(1))),s.sub(1),o,a.sub(1)),Vr(di(t,i.add(_e(1)),r.add(_e(1))),s,o.sub(1),a.sub(1)),Vr(di(t.add(_e(1)),i.add(_e(1)),r.add(_e(1))),s.sub(1),o.sub(1),a.sub(1)),l,u,A)).toVar();return VD(p)}).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]}),C5=as([Nue,Pue]),Lue=Ie(([n])=>{const e=ut(n).toVar(),t=_e().toVar(),i=_e().toVar(),r=oe(Gi(e.x,t)).toVar(),s=oe(Gi(e.y,i)).toVar(),o=oe(cl(r)).toVar(),a=oe(cl(s)).toVar(),l=Ce(UD(jo(Xo(t,i),r,s),jo(Xo(t.add(_e(1)),i),r.sub(1),s),jo(Xo(t,i.add(_e(1))),r,s.sub(1)),jo(Xo(t.add(_e(1)),i.add(_e(1))),r.sub(1),s.sub(1)),o,a)).toVar();return kD(l)}).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),Due=Ie(([n])=>{const e=Ce(n).toVar(),t=_e().toVar(),i=_e().toVar(),r=_e().toVar(),s=oe(Gi(e.x,t)).toVar(),o=oe(Gi(e.y,i)).toVar(),a=oe(Gi(e.z,r)).toVar(),l=oe(cl(s)).toVar(),u=oe(cl(o)).toVar(),A=oe(cl(a)).toVar(),p=Ce(OD(jo(Xo(t,i,r),s,o,a),jo(Xo(t.add(_e(1)),i,r),s.sub(1),o,a),jo(Xo(t,i.add(_e(1)),r),s,o.sub(1),a),jo(Xo(t.add(_e(1)),i.add(_e(1)),r),s.sub(1),o.sub(1),a),jo(Xo(t,i,r.add(_e(1))),s,o,a.sub(1)),jo(Xo(t.add(_e(1)),i,r.add(_e(1))),s.sub(1),o,a.sub(1)),jo(Xo(t,i.add(_e(1)),r.add(_e(1))),s,o.sub(1),a.sub(1)),jo(Xo(t.add(_e(1)),i.add(_e(1)),r.add(_e(1))),s.sub(1),o.sub(1),a.sub(1)),l,u,A)).toVar();return VD(p)}).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),R5=as([Lue,Due]),Iue=Ie(([n])=>{const e=oe(n).toVar(),t=_e(_r(e)).toVar();return xs(di(t))}).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),Bue=Ie(([n])=>{const e=ut(n).toVar(),t=_e(_r(e.x)).toVar(),i=_e(_r(e.y)).toVar();return xs(di(t,i))}).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),Fue=Ie(([n])=>{const e=Ce(n).toVar(),t=_e(_r(e.x)).toVar(),i=_e(_r(e.y)).toVar(),r=_e(_r(e.z)).toVar();return xs(di(t,i,r))}).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),Uue=Ie(([n])=>{const e=Xt(n).toVar(),t=_e(_r(e.x)).toVar(),i=_e(_r(e.y)).toVar(),r=_e(_r(e.z)).toVar(),s=_e(_r(e.w)).toVar();return xs(di(t,i,r,s))}).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]}),Oue=as([Iue,Bue,Fue,Uue]),kue=Ie(([n])=>{const e=oe(n).toVar(),t=_e(_r(e)).toVar();return Ce(xs(di(t,_e(0))),xs(di(t,_e(1))),xs(di(t,_e(2))))}).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),Vue=Ie(([n])=>{const e=ut(n).toVar(),t=_e(_r(e.x)).toVar(),i=_e(_r(e.y)).toVar();return Ce(xs(di(t,i,_e(0))),xs(di(t,i,_e(1))),xs(di(t,i,_e(2))))}).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),zue=Ie(([n])=>{const e=Ce(n).toVar(),t=_e(_r(e.x)).toVar(),i=_e(_r(e.y)).toVar(),r=_e(_r(e.z)).toVar();return Ce(xs(di(t,i,r,_e(0))),xs(di(t,i,r,_e(1))),xs(di(t,i,r,_e(2))))}).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),que=Ie(([n])=>{const e=Xt(n).toVar(),t=_e(_r(e.x)).toVar(),i=_e(_r(e.y)).toVar(),r=_e(_r(e.z)).toVar(),s=_e(_r(e.w)).toVar();return Ce(xs(di(t,i,r,s,_e(0))),xs(di(t,i,r,s,_e(1))),xs(di(t,i,r,s,_e(2))))}).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]}),qD=as([kue,Vue,zue,que]),A2=Ie(([n,e,t,i])=>{const r=oe(i).toVar(),s=oe(t).toVar(),o=_e(e).toVar(),a=Ce(n).toVar(),l=oe(0).toVar(),u=oe(1).toVar();return ui(o,()=>{l.addAssign(u.mul(C5(a))),u.mulAssign(r),a.mulAssign(s)}),l}).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),GD=Ie(([n,e,t,i])=>{const r=oe(i).toVar(),s=oe(t).toVar(),o=_e(e).toVar(),a=Ce(n).toVar(),l=Ce(0).toVar(),u=oe(1).toVar();return ui(o,()=>{l.addAssign(u.mul(R5(a))),u.mulAssign(r),a.mulAssign(s)}),l}).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Gue=Ie(([n,e,t,i])=>{const r=oe(i).toVar(),s=oe(t).toVar(),o=_e(e).toVar(),a=Ce(n).toVar();return ut(A2(a,o,s,r),A2(a.add(Ce(_e(19),_e(193),_e(17))),o,s,r))}).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Hue=Ie(([n,e,t,i])=>{const r=oe(i).toVar(),s=oe(t).toVar(),o=_e(e).toVar(),a=Ce(n).toVar(),l=Ce(GD(a,o,s,r)).toVar(),u=oe(A2(a.add(Ce(_e(19),_e(193),_e(17))),o,s,r)).toVar();return Xt(l,u)}).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Wue=Ie(([n,e,t,i,r,s,o])=>{const a=_e(o).toVar(),l=oe(s).toVar(),u=_e(r).toVar(),A=_e(i).toVar(),p=_e(t).toVar(),g=_e(e).toVar(),v=ut(n).toVar(),y=Ce(qD(ut(g.add(A),p.add(u)))).toVar(),b=ut(y.x,y.y).toVar();b.subAssign(.5),b.mulAssign(l),b.addAssign(.5);const w=ut(ut(oe(g),oe(p)).add(b)).toVar(),S=ut(w.sub(v)).toVar();return Cn(a.equal(_e(2)),()=>Pi(S.x).add(Pi(S.y))),Cn(a.equal(_e(3)),()=>hr(Pi(S.x),Pi(S.y))),ac(S,S)}).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),$ue=Ie(([n,e,t,i,r,s,o,a,l])=>{const u=_e(l).toVar(),A=oe(a).toVar(),p=_e(o).toVar(),g=_e(s).toVar(),v=_e(r).toVar(),y=_e(i).toVar(),b=_e(t).toVar(),w=_e(e).toVar(),S=Ce(n).toVar(),C=Ce(qD(Ce(w.add(v),b.add(g),y.add(p)))).toVar();C.subAssign(.5),C.mulAssign(A),C.addAssign(.5);const E=Ce(Ce(oe(w),oe(b),oe(y)).add(C)).toVar(),R=Ce(E.sub(S)).toVar();return Cn(u.equal(_e(2)),()=>Pi(R.x).add(Pi(R.y)).add(Pi(R.z))),Cn(u.equal(_e(3)),()=>hr(hr(Pi(R.x),Pi(R.y)),Pi(R.z))),ac(R,R)}).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),jA=as([Wue,$ue]),jue=Ie(([n,e,t])=>{const i=_e(t).toVar(),r=oe(e).toVar(),s=ut(n).toVar(),o=_e().toVar(),a=_e().toVar(),l=ut(Gi(s.x,o),Gi(s.y,a)).toVar(),u=oe(1e6).toVar();return ui({start:-1,end:_e(1),name:"x",condition:"<="},({x:A})=>{ui({start:-1,end:_e(1),name:"y",condition:"<="},({y:p})=>{const g=oe(jA(l,A,p,o,a,r,i)).toVar();u.assign(co(u,g))})}),Cn(i.equal(_e(0)),()=>{u.assign(Sl(u))}),u}).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Xue=Ie(([n,e,t])=>{const i=_e(t).toVar(),r=oe(e).toVar(),s=ut(n).toVar(),o=_e().toVar(),a=_e().toVar(),l=ut(Gi(s.x,o),Gi(s.y,a)).toVar(),u=ut(1e6,1e6).toVar();return ui({start:-1,end:_e(1),name:"x",condition:"<="},({x:A})=>{ui({start:-1,end:_e(1),name:"y",condition:"<="},({y:p})=>{const g=oe(jA(l,A,p,o,a,r,i)).toVar();Cn(g.lessThan(u.x),()=>{u.y.assign(u.x),u.x.assign(g)}).ElseIf(g.lessThan(u.y),()=>{u.y.assign(g)})})}),Cn(i.equal(_e(0)),()=>{u.assign(Sl(u))}),u}).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Que=Ie(([n,e,t])=>{const i=_e(t).toVar(),r=oe(e).toVar(),s=ut(n).toVar(),o=_e().toVar(),a=_e().toVar(),l=ut(Gi(s.x,o),Gi(s.y,a)).toVar(),u=Ce(1e6,1e6,1e6).toVar();return ui({start:-1,end:_e(1),name:"x",condition:"<="},({x:A})=>{ui({start:-1,end:_e(1),name:"y",condition:"<="},({y:p})=>{const g=oe(jA(l,A,p,o,a,r,i)).toVar();Cn(g.lessThan(u.x),()=>{u.z.assign(u.y),u.y.assign(u.x),u.x.assign(g)}).ElseIf(g.lessThan(u.y),()=>{u.z.assign(u.y),u.y.assign(g)}).ElseIf(g.lessThan(u.z),()=>{u.z.assign(g)})})}),Cn(i.equal(_e(0)),()=>{u.assign(Sl(u))}),u}).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Yue=Ie(([n,e,t])=>{const i=_e(t).toVar(),r=oe(e).toVar(),s=Ce(n).toVar(),o=_e().toVar(),a=_e().toVar(),l=_e().toVar(),u=Ce(Gi(s.x,o),Gi(s.y,a),Gi(s.z,l)).toVar(),A=oe(1e6).toVar();return ui({start:-1,end:_e(1),name:"x",condition:"<="},({x:p})=>{ui({start:-1,end:_e(1),name:"y",condition:"<="},({y:g})=>{ui({start:-1,end:_e(1),name:"z",condition:"<="},({z:v})=>{const y=oe(jA(u,p,g,v,o,a,l,r,i)).toVar();A.assign(co(A,y))})})}),Cn(i.equal(_e(0)),()=>{A.assign(Sl(A))}),A}).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Zue=as([jue,Yue]),Kue=Ie(([n,e,t])=>{const i=_e(t).toVar(),r=oe(e).toVar(),s=Ce(n).toVar(),o=_e().toVar(),a=_e().toVar(),l=_e().toVar(),u=Ce(Gi(s.x,o),Gi(s.y,a),Gi(s.z,l)).toVar(),A=ut(1e6,1e6).toVar();return ui({start:-1,end:_e(1),name:"x",condition:"<="},({x:p})=>{ui({start:-1,end:_e(1),name:"y",condition:"<="},({y:g})=>{ui({start:-1,end:_e(1),name:"z",condition:"<="},({z:v})=>{const y=oe(jA(u,p,g,v,o,a,l,r,i)).toVar();Cn(y.lessThan(A.x),()=>{A.y.assign(A.x),A.x.assign(y)}).ElseIf(y.lessThan(A.y),()=>{A.y.assign(y)})})})}),Cn(i.equal(_e(0)),()=>{A.assign(Sl(A))}),A}).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Jue=as([Xue,Kue]),ece=Ie(([n,e,t])=>{const i=_e(t).toVar(),r=oe(e).toVar(),s=Ce(n).toVar(),o=_e().toVar(),a=_e().toVar(),l=_e().toVar(),u=Ce(Gi(s.x,o),Gi(s.y,a),Gi(s.z,l)).toVar(),A=Ce(1e6,1e6,1e6).toVar();return ui({start:-1,end:_e(1),name:"x",condition:"<="},({x:p})=>{ui({start:-1,end:_e(1),name:"y",condition:"<="},({y:g})=>{ui({start:-1,end:_e(1),name:"z",condition:"<="},({z:v})=>{const y=oe(jA(u,p,g,v,o,a,l,r,i)).toVar();Cn(y.lessThan(A.x),()=>{A.z.assign(A.y),A.y.assign(A.x),A.x.assign(y)}).ElseIf(y.lessThan(A.y),()=>{A.z.assign(A.y),A.y.assign(y)}).ElseIf(y.lessThan(A.z),()=>{A.z.assign(y)})})})}),Cn(i.equal(_e(0)),()=>{A.assign(Sl(A))}),A}).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),tce=as([Que,ece]),nce=Ie(([n])=>{const e=n.y,t=n.z,i=Ce().toVar();return Cn(e.lessThan(1e-4),()=>{i.assign(Ce(t,t,t))}).Else(()=>{let r=n.x;r=r.sub(ul(r)).mul(6).toVar();const s=_e(zb(r)),o=r.sub(oe(s)),a=t.mul(e.oneMinus()),l=t.mul(e.mul(o).oneMinus()),u=t.mul(e.mul(o.oneMinus()).oneMinus());Cn(s.equal(_e(0)),()=>{i.assign(Ce(t,u,a))}).ElseIf(s.equal(_e(1)),()=>{i.assign(Ce(l,t,a))}).ElseIf(s.equal(_e(2)),()=>{i.assign(Ce(a,t,u))}).ElseIf(s.equal(_e(3)),()=>{i.assign(Ce(a,l,t))}).ElseIf(s.equal(_e(4)),()=>{i.assign(Ce(u,a,t))}).Else(()=>{i.assign(Ce(t,a,l))})}),i}).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),ice=Ie(([n])=>{const e=Ce(n).toVar(),t=oe(e.x).toVar(),i=oe(e.y).toVar(),r=oe(e.z).toVar(),s=oe(co(t,co(i,r))).toVar(),o=oe(hr(t,hr(i,r))).toVar(),a=oe(o.sub(s)).toVar(),l=oe().toVar(),u=oe().toVar(),A=oe().toVar();return A.assign(o),Cn(o.greaterThan(0),()=>{u.assign(a.div(o))}).Else(()=>{u.assign(0)}),Cn(u.lessThanEqual(0),()=>{l.assign(0)}).Else(()=>{Cn(t.greaterThanEqual(o),()=>{l.assign(i.sub(r).div(a))}).ElseIf(i.greaterThanEqual(o),()=>{l.assign(vr(2,r.sub(t).div(a)))}).Else(()=>{l.assign(vr(4,t.sub(i).div(a)))}),l.mulAssign(1/6),Cn(l.lessThan(0),()=>{l.addAssign(1)})}),Ce(l,u,A)}).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),rce=Ie(([n])=>{const e=Ce(n).toVar(),t=Mb(Bb(e,Ce(.04045))).toVar(),i=Ce(e.div(12.92)).toVar(),r=Ce(Sa(hr(e.add(Ce(.055)),Ce(0)).div(1.055),Ce(2.4))).toVar();return li(i,r,t)}).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),HD=(n,e)=>{n=oe(n),e=oe(e);const t=ut(e.dFdx(),e.dFdy()).length().mul(.7071067811865476);return ml(n.sub(t),n.add(t),e)},WD=(n,e,t,i)=>li(n,e,t[i].clamp()),sce=(n,e,t=Wi())=>WD(n,e,t,"x"),oce=(n,e,t=Wi())=>WD(n,e,t,"y"),$D=(n,e,t,i,r)=>li(n,e,HD(t,i[r])),ace=(n,e,t,i=Wi())=>$D(n,e,t,i,"x"),lce=(n,e,t,i=Wi())=>$D(n,e,t,i,"y"),uce=(n=1,e=0,t=Wi())=>t.mul(n).add(e),cce=(n,e=1)=>(n=oe(n),n.abs().pow(e).mul(n.sign())),hce=(n,e=1,t=.5)=>oe(n).sub(t).mul(e).add(t),fce=(n=Wi(),e=1,t=0)=>C5(n.convert("vec2|vec3")).mul(e).add(t),Ace=(n=Wi(),e=1,t=0)=>R5(n.convert("vec2|vec3")).mul(e).add(t),dce=(n=Wi(),e=1,t=0)=>(n=n.convert("vec2|vec3"),Xt(R5(n),C5(n.add(ut(19,73)))).mul(e).add(t)),pce=(n=Wi(),e=1)=>Zue(n.convert("vec2|vec3"),e,_e(1)),mce=(n=Wi(),e=1)=>Jue(n.convert("vec2|vec3"),e,_e(1)),gce=(n=Wi(),e=1)=>tce(n.convert("vec2|vec3"),e,_e(1)),_ce=(n=Wi())=>Oue(n.convert("vec2|vec3")),vce=(n=Wi(),e=3,t=2,i=.5,r=1)=>A2(n,_e(e),t,i).mul(r),yce=(n=Wi(),e=3,t=2,i=.5,r=1)=>Gue(n,_e(e),t,i).mul(r),xce=(n=Wi(),e=3,t=2,i=.5,r=1)=>GD(n,_e(e),t,i).mul(r),bce=(n=Wi(),e=3,t=2,i=.5,r=1)=>Hue(n,_e(e),t,i).mul(r),Tce=Ie(([n,e,t])=>{const i=au(n).toVar(),r=Yn(oe(.5).mul(e.sub(t)),Kl).div(i).toVar(),s=Yn(oe(-.5).mul(e.sub(t)),Kl).div(i).toVar(),o=Ce().toVar();o.x=i.x.greaterThan(oe(0)).select(r.x,s.x),o.y=i.y.greaterThan(oe(0)).select(r.y,s.y),o.z=i.z.greaterThan(oe(0)).select(r.z,s.z);const a=co(co(o.x,o.y),o.z).toVar();return Kl.add(i.mul(a)).toVar().sub(t)}),jD=Ie(([n,e])=>{const t=n.x,i=n.y,r=n.z;let s=e.element(0).mul(.886227);return s=s.add(e.element(1).mul(2*.511664).mul(i)),s=s.add(e.element(2).mul(2*.511664).mul(r)),s=s.add(e.element(3).mul(2*.511664).mul(t)),s=s.add(e.element(4).mul(2*.429043).mul(t).mul(i)),s=s.add(e.element(5).mul(2*.429043).mul(i).mul(r)),s=s.add(e.element(6).mul(r.mul(r).mul(.743125).sub(.247708))),s=s.add(e.element(7).mul(2*.429043).mul(t).mul(r)),s=s.add(e.element(8).mul(.429043).mul(wn(t,t).sub(wn(i,i)))),s});var O=Object.freeze({__proto__:null,BRDF_GGX:Bx,BRDF_Lambert:bh,BasicPointShadowFilter:DD,BasicShadowFilter:wD,Break:gL,Const:WN,Continue:Sre,DFGApprox:c5,D_GGX:DL,Discard:uP,EPSILON:dN,F_Schlick:DA,Fn:Ie,INFINITY:uie,If:Cn,Loop:ui,NodeAccess:ys,NodeShaderStage:bx,NodeType:Ine,NodeUpdateType:Sn,PCFShadowFilter:MD,PCFSoftShadowFilter:ED,PI:a2,PI2:cie,PointShadowFilter:ID,Return:wie,Schlick_to_F0:BL,ScriptableNodeResources:ng,ShaderNode:Bf,Stack:X2,Switch:Jne,TBNViewMatrix:Yc,VSMShadowFilter:CD,V_GGX_SmithCorrelated:LL,Var:HN,abs:Pi,acesFilmicToneMapping:mD,acos:xN,add:vr,addMethodChaining:Ye,addNodeElement:Cie,agxToneMapping:gD,all:pN,alphaT:r2,and:KR,anisotropy:Ou,anisotropyB:sh,anisotropyT:ld,any:mN,append:iie,array:WR,arrayBuffer:tie,asin:yN,assign:$R,atan:Ob,atan2:VN,atomicAdd:Ble,atomicAnd:kle,atomicFunc:wl,atomicLoad:Dle,atomicMax:Ule,atomicMin:Ole,atomicOr:Vle,atomicStore:Ile,atomicSub:Fle,atomicXor:zle,attenuationColor:Pb,attenuationDistance:Nb,attribute:uu,attributeArray:Eae,backgroundBlurriness:iD,backgroundIntensity:zx,backgroundRotation:rD,batch:dL,billboarding:cae,bitAnd:nN,bitNot:iN,bitOr:rN,bitXor:sN,bitangentGeometry:tre,bitangentLocal:nre,bitangentView:CP,bitangentWorld:ire,bitcast:hie,blendBurn:lD,blendColor:kae,blendDodge:uD,blendOverlay:hD,blendScreen:cD,blur:qL,bool:ou,buffer:Ip,bufferAttribute:Dp,bumpMap:LP,burn:Vae,bvec2:BR,bvec3:Mb,bvec4:kR,bypass:sP,cache:cd,call:jR,cameraFar:zu,cameraIndex:s_,cameraNear:Vu,cameraNormalMatrix:Oie,cameraPosition:pP,cameraProjectionMatrix:Ch,cameraProjectionMatrixInverse:Fie,cameraViewMatrix:fo,cameraWorldMatrix:Uie,cbrt:BN,cdl:Xae,ceil:e_,checker:uue,cineonToneMapping:pD,clamp:pl,clearcoat:i2,clearcoatRoughness:ap,code:p_,color:DR,colorSpaceToWorking:r_,colorToDirection:Kre,compute:rP,computeSkinning:bre,cond:zN,context:i_,convert:zR,convertColorSpace:mie,convertToTexture:Tae,cos:kl,cross:n_,cubeTexture:LA,cubeToUV:_a,dFdx:kb,dFdy:Vb,dashSize:X1,debug:hP,decrement:hN,decrementBefore:uN,defaultBuildStages:Tx,defaultShaderStages:ER,defined:ip,degrees:_N,deltaTime:eD,densityFog:mle,densityFogFactor:v5,depth:o5,depthPass:Jae,difference:PN,diffuseColor:ii,directPointLight:FD,directionToColor:wL,dispersion:Lb,distance:NN,div:Da,dodge:zae,dot:ac,drawIndex:hL,dynamicBufferAttribute:iP,element:VR,emissive:Ex,equal:Ib,equals:CN,equirectUV:a5,exp:Fb,exp2:PA,expression:lu,faceDirection:Up,faceForward:Wb,faceforward:fie,float:oe,floor:ul,fog:hp,fract:Au,frameGroup:HR,frameId:eae,frontFacing:vP,fwidth:MN,gain:joe,gapSize:Cx,getConstNodeType:LR,getCurrentStack:wb,getDirection:VL,getDistanceAttenuation:E5,getGeometryRoughness:PL,getNormalFromDepth:wae,getParallaxCorrectNormal:Tce,getRoughness:u5,getScreenPosition:Sae,getShIrradianceAt:jD,getShadowMaterial:RD,getShadowRenderObjectFunction:ND,getTextureIndex:KL,getViewPosition:Mf,globalId:ble,glsl:lle,glslFn:ule,grayscale:Hae,greaterThan:Bb,greaterThanEqual:ZR,hash:$oe,highpModelNormalViewMatrix:Px,highpModelViewMatrix:Nx,hue:jae,increment:cN,incrementBefore:lN,instance:pre,instanceIndex:Yu,instancedArray:Cae,instancedBufferAttribute:l2,instancedDynamicBufferAttribute:Rx,instancedMesh:AL,int:_e,inverseSqrt:Ub,inversesqrt:Aie,invocationLocalIndex:dre,invocationSubgroupIndex:Are,ior:ud,iridescence:Z2,iridescenceIOR:Eb,iridescenceThickness:Cb,ivec2:Pr,ivec3:FR,ivec4:UR,js:ole,label:GN,length:Zl,lengthSq:Gb,lessThan:QR,lessThanEqual:YR,lightPosition:b5,lightProjectionUV:TD,lightShadowMatrix:x5,lightTargetDirection:S5,lightTargetPosition:SD,lightViewPosition:T5,lightingContext:vL,lights:Hle,linearDepth:c2,linearToneMapping:AD,localId:Tle,log:J2,log2:ll,logarithmicDepthToViewZ:Ore,loop:wre,luminance:g5,mat2:Q2,mat3:Ts,mat4:rh,matcapUV:WL,materialAO:uL,materialAlphaTest:DP,materialAnisotropy:XP,materialAnisotropyVector:wf,materialAttenuationColor:nL,materialAttenuationDistance:tL,materialClearcoat:qP,materialClearcoatNormal:HP,materialClearcoatRoughness:GP,materialColor:IP,materialDispersion:lL,materialEmissive:FP,materialEnvIntensity:Z1,materialEnvRotation:Zb,materialIOR:eL,materialIridescence:QP,materialIridescenceIOR:YP,materialIridescenceThickness:ZP,materialLightMap:e5,materialLineDashOffset:oL,materialLineDashSize:rL,materialLineGapSize:sL,materialLineScale:iL,materialLineWidth:hre,materialMetalness:VP,materialNormal:zP,materialOpacity:Jb,materialPointSize:aL,materialReference:Hl,materialReflectivity:K1,materialRefractionRatio:bP,materialRotation:WP,materialRoughness:kP,materialSheen:$P,materialSheenRoughness:jP,materialShininess:BP,materialSpecular:UP,materialSpecularColor:OP,materialSpecularIntensity:Ix,materialSpecularStrength:hd,materialThickness:JP,materialTransmission:KP,max:hr,maxMipLevel:AP,mediumpModelViewMatrix:_P,metalness:op,min:co,mix:li,mixElement:ON,mod:Np,modInt:AN,modelDirection:Hie,modelNormalMatrix:gP,modelPosition:Wie,modelRadius:Xie,modelScale:$ie,modelViewMatrix:Rh,modelViewPosition:jie,modelViewProjection:t5,modelWorldMatrix:Jo,modelWorldMatrixInverse:Qie,morphReference:_L,mrt:JL,mul:wn,mx_aastep:HD,mx_cell_noise_float:_ce,mx_contrast:hce,mx_fractal_noise_float:vce,mx_fractal_noise_vec2:yce,mx_fractal_noise_vec3:xce,mx_fractal_noise_vec4:bce,mx_hsvtorgb:nce,mx_noise_float:fce,mx_noise_vec3:Ace,mx_noise_vec4:dce,mx_ramplr:sce,mx_ramptb:oce,mx_rgbtohsv:ice,mx_safepower:cce,mx_splitlr:ace,mx_splittb:lce,mx_srgb_texture_to_lin_rec709:rce,mx_transform_uv:uce,mx_worley_noise_float:pce,mx_worley_noise_vec2:mce,mx_worley_noise_vec3:gce,negate:bN,neutralToneMapping:_D,nodeArray:ih,nodeImmutable:Et,nodeObject:tt,nodeObjects:Cp,nodeProxy:at,normalFlat:yP,normalGeometry:o_,normalLocal:ho,normalMap:Dx,normalView:la,normalWorld:a_,normalize:au,not:eN,notEqual:XR,numWorkgroups:yle,objectDirection:kie,objectGroup:Db,objectPosition:mP,objectRadius:Gie,objectScale:zie,objectViewPosition:qie,objectWorldMatrix:Vie,oneMinus:TN,or:JR,orthographicDepthToViewZ:Ure,oscSawtooth:aae,oscSine:rae,oscSquare:sae,oscTriangle:oae,output:Jf,outputStruct:Hoe,overlay:Gae,overloadingFn:as,parabola:Vx,parallaxDirection:NP,parallaxUV:sre,parameter:Ooe,pass:Zae,passTexture:Kae,pcurve:Xoe,perspectiveDepthToViewZ:r5,pmremTexture:A5,pointShadow:BD,pointUV:Nae,pointWidth:sie,positionGeometry:Fp,positionLocal:lr,positionPrevious:u2,positionView:gr,positionViewDirection:Vi,positionWorld:Kl,positionWorldDirection:Qb,posterize:Yae,pow:Sa,pow2:qb,pow3:LN,pow4:DN,property:WA,radians:gN,rand:UN,range:_le,rangeFog:ple,rangeFogFactor:_5,reciprocal:wN,reference:xi,referenceBuffer:Lx,reflect:RN,reflectVector:wP,reflectView:TP,reflector:_ae,refract:Hb,refractVector:MP,refractView:SP,reinhardToneMapping:dD,remainder:fN,remap:aP,remapClamp:lP,renderGroup:nn,renderOutput:cP,rendererReference:eP,rotate:d_,rotateUV:lae,roughness:tl,round:SN,rtt:nD,sRGBTransferEOTF:XN,sRGBTransferOETF:QN,sampler:Pie,samplerComparison:Lie,saturate:FN,saturation:Wae,screen:qae,screenCoordinate:zp,screenSize:cp,screenUV:Ca,scriptable:dle,scriptableValue:tg,select:Hr,setCurrentStack:rp,shaderStages:Sx,shadow:LD,shadowPositionWorld:M5,shapeCircle:cue,sharedUniformGroup:K2,sheen:Qc,sheenRoughness:Y2,shiftLeft:oN,shiftRight:aN,shininess:s2,sign:up,sin:No,sinc:Qoe,skinning:mL,smoothstep:ml,smoothstepElement:kN,specularColor:Ys,specularF90:lp,spherizeUV:uae,split:nie,spritesheetUV:Aae,sqrt:Sl,stack:J1,step:t_,storage:oh,storageBarrier:Ele,storageObject:xre,storageTexture:sD,string:eie,struct:Goe,sub:Yn,subgroupIndex:fre,subgroupSize:Sle,tan:vN,tangentGeometry:c_,tangentLocal:Op,tangentView:kp,tangentWorld:EP,temp:$N,texture:Vn,texture3D:oD,textureBarrier:Cle,textureBicubic:OL,textureCubeUV:zL,textureLoad:ir,textureSize:Qu,textureStore:Lae,thickness:Rb,time:Nh,timerDelta:iae,timerGlobal:nae,timerLocal:tae,toOutputColorSpace:YN,toWorkingColorSpace:ZN,toneMapping:tP,toneMappingExposure:nP,toonOutlinePass:tle,transformDirection:IN,transformNormal:xP,transformNormalToView:Yb,transformedBentNormalView:PP,transformedBitangentView:RP,transformedBitangentWorld:rre,transformedClearcoatNormalView:Ff,transformedNormalView:or,transformedNormalWorld:l_,transformedTangentView:Kb,transformedTangentWorld:ere,transmission:o2,transpose:EN,triNoise3D:Zoe,triplanarTexture:pae,triplanarTextures:tD,trunc:zb,tslFn:rie,uint:Bt,uniform:jt,uniformArray:Zo,uniformGroup:GR,uniforms:Iie,userData:Fae,uv:Wi,uvec2:IR,uvec3:HA,uvec4:OR,varying:ko,varyingProperty:sp,vec2:ut,vec3:Ce,vec4:Xt,vectorComponents:Mh,velocity:Oae,vertexColor:SL,vertexIndex:cL,vertexStage:jN,vibrance:$ae,viewZToLogarithmicDepth:s5,viewZToOrthographicDepth:tA,viewZToPerspectiveDepth:bL,viewport:eA,viewportBottomLeft:Ire,viewportCoordinate:xL,viewportDepthTexture:i5,viewportLinearDepth:kre,viewportMipTexture:n5,viewportResolution:Lre,viewportSafeUV:hae,viewportSharedTexture:Zre,viewportSize:yL,viewportTexture:Bre,viewportTopLeft:Dre,viewportUV:Pre,wgsl:ale,wgslFn:cle,workgroupArray:Ple,workgroupBarrier:Mle,workgroupId:xle,workingToColorSpace:KN,xor:tN});const Aa=new d5;class Sce extends lc{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,i){const r=this.renderer,s=this.nodes.getBackgroundNode(e)||e.background;let o=!1;if(s===null)r._clearColor.getRGB(Aa),Aa.a=r._clearColor.a;else if(s.isColor===!0)s.getRGB(Aa),Aa.a=1,o=!0;else if(s.isNode===!0){const u=this.get(e),A=s;Aa.copy(r._clearColor);let p=u.backgroundMesh;if(p===void 0){let w=function(){s.removeEventListener("dispose",w),p.material.dispose(),p.geometry.dispose()};var l=w;const v=i_(Xt(A).mul(zx),{getUV:()=>rD.mul(a_),getTextureLevel:()=>iD});let y=t5;y=y.setZ(y.w);const b=new yr;b.name="Background.material",b.side=wi,b.depthTest=!1,b.depthWrite=!1,b.allowOverride=!1,b.fog=!1,b.lights=!1,b.vertexNode=y,b.colorNode=v,u.backgroundMeshNode=v,u.backgroundMesh=p=new Jn(new Fa(1,32,32),b),p.frustumCulled=!1,p.name="Background.mesh",p.onBeforeRender=function(S,C,E){this.matrixWorld.copyPosition(E.matrixWorld)},s.addEventListener("dispose",w)}const g=A.getCacheKey();u.backgroundCacheKey!==g&&(u.backgroundMeshNode.node=Xt(A).mul(zx),u.backgroundMeshNode.needsUpdate=!0,p.material.needsUpdate=!0,u.backgroundCacheKey=g),t.unshift(p,p.geometry,p.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",s);const a=r.xr.getEnvironmentBlendMode();if(a==="additive"?Aa.set(0,0,0,1):a==="alpha-blend"&&Aa.set(0,0,0,0),r.autoClear===!0||o===!0){const u=i.clearColorValue;u.r=Aa.r,u.g=Aa.g,u.b=Aa.b,u.a=Aa.a,(r.backend.isWebGLBackend===!0||r.alpha===!0)&&(u.r*=u.a,u.g*=u.a,u.b*=u.a),i.depthClearValue=r._clearDepth,i.stencilClearValue=r._clearStencil,i.clearColor=r.autoClearColor===!0,i.clearDepth=r.autoClearDepth===!0,i.clearStencil=r.autoClearStencil===!0}else i.clearColor=!1,i.clearDepth=!1,i.clearStencil=!1}}let wce=0;class qx{constructor(e="",t=[],i=0,r=[]){this.name=e,this.bindings=t,this.index=i,this.bindingsReference=r,this.id=wce++}}class Mce{constructor(e,t,i,r,s,o,a,l,u,A=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=i,this.transforms=A,this.nodeAttributes=r,this.bindings=s,this.updateNodes=o,this.updateBeforeNodes=a,this.updateAfterNodes=l,this.observer=u,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const r=new qx(t.name,[],t.index,t);e.push(r);for(const s of t.bindings)r.bindings.push(s.clone())}else e.push(t);return e}}class Xw{constructor(e,t,i=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=i}}class Ece{constructor(e,t,i){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=i.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class XD{constructor(e,t,i=!1,r=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=i,this.count=r}}class Cce extends XD{constructor(e,t,i=null,r=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=i,this.interpolationSampling=r}}class Rce{constructor(e,t,i=""){this.name=e,this.type=t,this.code=i,Object.defineProperty(this,"isNodeCode",{value:!0})}}let Nce=0;class Mv{constructor(e=null){this.id=Nce++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class Pce{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class uc{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class Lce extends uc{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class Dce extends uc{constructor(e,t=new rt){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class Ice extends uc{constructor(e,t=new re){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class Bce extends uc{constructor(e,t=new Kt){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class Fce extends uc{constructor(e,t=new Gt){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class Uce extends uc{constructor(e,t=new V2){super(e,t),this.isMatrix2Uniform=!0,this.boundary=16,this.itemSize=4}}class Oce extends uc{constructor(e,t=new bn){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class kce extends uc{constructor(e,t=new on){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class Vce extends Lce{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class zce extends Dce{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class qce extends Ice{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Gce extends Bce{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Hce extends Fce{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Wce extends Uce{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class $ce extends Oce{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class jce extends kce{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const Qw=new WeakMap,Xce=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),l1=n=>/e/g.test(n)?String(n).replace(/\+/g,""):(n=Number(n),n+(n%1?"":".0"));class QD{constructor(e,t,i){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=i,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=J1(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new Mv,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null}getBindGroupsCache(){let e=Qw.get(this.renderer);return e===void 0&&(e=new Ia,Qw.set(this.renderer,e)),e}createRenderTarget(e,t,i){return new bl(e,t,i)}createRenderTargetArray(e,t,i,r){return new $H(e,t,i,r)}createCubeRenderTarget(e,t){return new ML(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const i=this.getBindGroupsCache(),r=[];let s=!0;for(const a of t)r.push(a),s=s&&a.groupNode.shared!==!0;let o;return s?(o=i.get(r),o===void 0&&(o=new qx(e,r,this.bindingsIndexes[e].group,r),i.set(r,o))):o=new qx(e,r,this.bindingsIndexes[e].group,r),o}getBindGroupArray(e,t){const i=this.bindings[t];let r=i[e];return r===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),i[e]=r=[]),r}getBindings(){let e=this.bindGroups;if(e===null){const t={},i=this.bindings;for(const r of Sx)for(const s in i[r]){const o=i[r][s];(t[s]||(t[s]=[])).push(...o)}e=[];for(const r in t){const s=t[r],o=this._getBindGroup(r,s);e.push(o)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,i)=>t.bindings[0].groupNode.order-i.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const i=e[t];this.bindingsIndexes[i.name].group=t,i.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==Sn.NONE&&this.updateNodes.push(e.getSelf());for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),i=e.getUpdateAfterType();t!==Sn.NONE&&this.updateBeforeNodes.push(e.getSelf()),i!==Sn.NONE&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===Lr||e.magFilter===jf||e.magFilter===$l||e.magFilter===to||e.minFilter===Lr||e.minFilter===jf||e.minFilter===$l||e.minFilter===to}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const i=this.getDataFromNode(e);return i.cache===void 0&&(i.cache=new Mv(t?this.getCache():null)),i.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,i=null){let r=this.generateArrayDeclaration(e,t)+"( ";for(let s=0;s<t;s++){const o=i?i[s]:null;o!==null?r+=o.build(this,e):r+=this.generateConst(e),s<t-1&&(r+=", ")}return r+=" )",r}generateStruct(e,t,i=null){const r=[];for(const s of t){const{name:o,type:a}=s;i&&i[o]&&i[o].isNode?r.push(i[o].build(this,a)):r.push(this.generateConst(a))}return e+"( "+r.join(", ")+" )"}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new Gt:e==="vec2"?t=new rt:e==="vec3"?t=new re:e==="vec4"&&(t=new Kt)),e==="float")return l1(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${l1(t.r)}, ${l1(t.g)}, ${l1(t.b)} )`;const i=this.getTypeLength(e),r=this.getComponentType(e),s=o=>this.generateConst(r,o);if(i===2)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)} )`;if(i===3)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)} )`;if(i===4&&e!=="mat2")return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)}, ${s(t.w)} )`;if(i>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(s).join(", ")} )`;if(i>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const i=this.attributes;for(const s of i)if(s.name===e)return s;const r=new Xw(e,t);return this.registerDeclaration(r),i.push(r),r}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===qr)return"int";if(t===Ni)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;let i=bR(e);const r=t==="float"?"":t[0];return/mat2/.test(t)===!0&&(i=i.replace("vec","mat")),r+i}getTypeFromArray(e){return Xce.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const i=t.array,r=e.itemSize,s=e.normalized;let o;return!(e instanceof S9)&&s!==!0&&(o=this.getTypeFromArray(i)),this.getTypeFromLength(r,o)}getTypeLength(e){const t=this.getVectorType(e),i=/vec([2-4])/.exec(t);return i!==null?Number(i[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}addStack(){return this.stack=J1(this.stack),this.stacks.push(wb()||this.stack),rp(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,rp(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,i=null){i=i===null?e.isGlobal(this)?this.globalCache:this.cache:i;let r=i.getData(e);return r===void 0&&(r={},i.setData(e,r)),r[t]===void 0&&(r[t]={}),r[t]}getNodeProperties(e,t="any"){const i=this.getDataFromNode(e,t);return i.properties||(i.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const i=this.getDataFromNode(e);let r=i.bufferAttribute;if(r===void 0){const s=this.uniforms.index++;r=new Xw("nodeAttribute"+s,t,e),this.bufferAttributes.push(r),i.bufferAttribute=r}return r}getStructTypeFromNode(e,t,i=null,r=this.shaderStage){const s=this.getDataFromNode(e,r,this.globalCache);let o=s.structType;if(o===void 0){const a=this.structs.index++;i===null&&(i="StructType"+a),o=new Pce(i,t),this.structs[r].push(o),s.structType=o}return o}getOutputStructTypeFromNode(e,t){const i=this.getStructTypeFromNode(e,t,"OutputType","fragment");return i.output=!0,i}getUniformFromNode(e,t,i=this.shaderStage,r=null){const s=this.getDataFromNode(e,i,this.globalCache);let o=s.uniform;if(o===void 0){const a=this.uniforms.index++;o=new Ece(r||"nodeUniform"+a,t,e),this.uniforms[i].push(o),this.registerDeclaration(o),s.uniform=o}return o}getArrayCount(e){let t=null;return e.isArrayNode?t=e.count:e.isVarNode&&e.node.isArrayNode&&(t=e.node.count),t}getVarFromNode(e,t=null,i=e.getNodeType(this),r=this.shaderStage,s=!1){const o=this.getDataFromNode(e,r);let a=o.variable;if(a===void 0){const l=s?"_const":"_var",u=this.vars[r]||(this.vars[r]=[]),A=this.vars[l]||(this.vars[l]=0);t===null&&(t=(s?"nodeConst":"nodeVar")+A,this.vars[l]++);const p=this.getArrayCount(e);a=new XD(t,i,s,p),s||u.push(a),this.registerDeclaration(a),o.variable=a}return a}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const t of e.values)if(!this.isDeterministic(t))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,t=null,i=e.getNodeType(this),r=null,s=null){const o=this.getDataFromNode(e,"any");let a=o.varying;if(a===void 0){const l=this.varyings,u=l.length;t===null&&(t="nodeVarying"+u),a=new Cce(t,i,r,s),l.push(a),this.registerDeclaration(a),o.varying=a}return a}registerDeclaration(e){const t=this.shaderStage,i=this.declarations[t]||(this.declarations[t]={}),r=this.getPropertyName(e);let s=1,o=r;for(;i[o]!==void 0;)o=r+"_"+s++;s>1&&(e.name=o,console.warn(`THREE.TSL: Declaration name '${r}' of '${e.type}' already in use. Renamed to '${o}'.`)),i[o]=e}getCodeFromNode(e,t,i=this.shaderStage){const r=this.getDataFromNode(e);let s=r.code;if(s===void 0){const o=this.codes[i]||(this.codes[i]=[]),a=o.length;s=new Rce("nodeCode"+a,t),o.push(s),r.code=s}return s}addFlowCodeHierarchy(e,t){const{flowCodes:i,flowCodeBlock:r}=this.getDataFromNode(e);let s=!0,o=t;for(;o;){if(r.get(o)===!0){s=!1;break}o=this.getDataFromNode(o).parentNodeBlock}if(s)for(const a of i)this.addLineFlowCode(a)}addLineFlowCodeBlock(e,t,i){const r=this.getDataFromNode(e),s=r.flowCodes||(r.flowCodes=[]),o=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);s.push(t),o.set(i,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),i=this.flowChildNode(e,t);return this.flowsData.set(e,i),i}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new vD,i=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=i,t}flowShaderNode(e){const t=e.layout,i={[Symbol.iterator](){let o=0;const a=Object.values(this);return{next:()=>({value:a[o],done:o++>=a.length})}}};for(const o of t.inputs)i[o.name]=new YL(o.type,o.name);e.layout=null;const r=e.call(i),s=this.flowStagesNode(r,t.type);return e.layout=t,s}flowStagesNode(e,t=null){const i=this.flow,r=this.vars,s=this.declarations,o=this.cache,a=this.buildStage,l=this.stack,u={code:""};this.flow=u,this.vars={},this.declarations={},this.cache=new Mv,this.stack=J1();for(const A of Tx)this.setBuildStage(A),u.result=e.build(this,t);return u.vars=this.getVars(this.shaderStage),this.flow=i,this.vars=r,this.declarations=s,this.cache=o,this.stack=l,this.setBuildStage(a),u}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e,t=null){const i=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=i,r}flowNodeFromShaderStage(e,t,i=null,r=null){const s=this.shaderStage;this.setShaderStage(e);const o=this.flowChildNode(t,i);return r!==null&&(o.code+=`${this.tab+r} = ${o.result};
`),this.flowCode[e]=this.flowCode[e]+o.code,this.setShaderStage(s),o}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t,i=null){return`${i!==null?this.generateArrayDeclaration(e,i):this.getType(e)} ${t}`}getVars(e){let t="";const i=this.vars[e];if(i!==void 0)for(const r of i)t+=`${this.getVar(r.type,r.name)}; `;return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let i="";if(t!==void 0)for(const r of t)i+=r.code+`
`;return i}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:t,renderer:i}=this;if(t!==null){let r=i.library.fromMaterial(t);r===null&&(console.error(`NodeMaterial: Material "${t.type}" is not compatible.`),r=new yr),r.build(this)}else this.addFlow("compute",e);for(const r of Tx){this.setBuildStage(r),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const s of Sx){this.setShaderStage(s);const o=this.flowNodes[s];for(const a of o)r==="generate"?this.flowNode(a):a.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if(t==="float"||t==="int"||t==="uint")return new Vce(e);if(t==="vec2"||t==="ivec2"||t==="uvec2")return new zce(e);if(t==="vec3"||t==="ivec3"||t==="uvec3")return new qce(e);if(t==="vec4"||t==="ivec4"||t==="uvec4")return new Gce(e);if(t==="color")return new Hce(e);if(t==="mat2")return new Wce(e);if(t==="mat3")return new $ce(e);if(t==="mat4")return new jce(e);throw new Error(`Uniform "${t}" not declared.`)}format(e,t,i){if(t=this.getVectorType(t),i=this.getVectorType(i),t===i||i===null||this.isReference(i))return e;const r=this.getTypeLength(t),s=this.getTypeLength(i);return r===16&&s===9?`${this.getType(i)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:r===9&&s===4?`${this.getType(i)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:r>4||s>4||s===0?e:r===s?`${this.getType(i)}( ${e} )`:r>s?(e=i==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,s)}`,this.format(e,this.getTypeFromLength(s,this.getComponentType(t)),i)):s===4&&r>1?`${this.getType(i)}( ${this.format(e,t,"vec3")}, 1.0 )`:r===2?`${this.getType(i)}( ${this.format(e,t,"vec2")}, 0.0 )`:(r===1&&s>1&&t!==this.getComponentType(i)&&(e=`${this.getType(this.getComponentType(i))}( ${e} )`),`${this.getType(i)}( ${e} )`)}getSignature(){return`// Three.js r${gp} - Node System
`}*[Symbol.iterator](){}createNodeMaterial(e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${e}() instead.`)}}class Yw{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let i=e.get(t);return i===void 0&&(i={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,i)),i}updateBeforeNode(e){const t=e.getUpdateBeforeType(),i=e.updateReference(this);if(t===Sn.FRAME){const{frameMap:r}=this._getMaps(this.updateBeforeMap,i);r.get(i)!==this.frameId&&e.updateBefore(this)!==!1&&r.set(i,this.frameId)}else if(t===Sn.RENDER){const{renderMap:r}=this._getMaps(this.updateBeforeMap,i);r.get(i)!==this.renderId&&e.updateBefore(this)!==!1&&r.set(i,this.renderId)}else t===Sn.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),i=e.updateReference(this);if(t===Sn.FRAME){const{frameMap:r}=this._getMaps(this.updateAfterMap,i);r.get(i)!==this.frameId&&e.updateAfter(this)!==!1&&r.set(i,this.frameId)}else if(t===Sn.RENDER){const{renderMap:r}=this._getMaps(this.updateAfterMap,i);r.get(i)!==this.renderId&&e.updateAfter(this)!==!1&&r.set(i,this.renderId)}else t===Sn.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),i=e.updateReference(this);if(t===Sn.FRAME){const{frameMap:r}=this._getMaps(this.updateMap,i);r.get(i)!==this.frameId&&e.update(this)!==!1&&r.set(i,this.frameId)}else if(t===Sn.RENDER){const{renderMap:r}=this._getMaps(this.updateMap,i);r.get(i)!==this.renderId&&e.update(this)!==!1&&r.set(i,this.renderId)}else t===Sn.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class N5{constructor(e,t,i=null,r="",s=!1){this.type=e,this.name=t,this.count=i,this.qualifier=r,this.isConst=s}}N5.isNodeFunctionInput=!0;class Qce extends Ph{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:S5(this.light),lightColor:e}}}const Ev=new on,u1=new on;let R0=null;class Yce extends Ph{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=jt(new re).setGroup(nn),this.halfWidth=jt(new re).setGroup(nn),this.updateType=Sn.RENDER}update(e){super.update(e);const{light:t}=this,i=e.camera.matrixWorldInverse;u1.identity(),Ev.copy(t.matrixWorld),Ev.premultiply(i),u1.extractRotation(Ev),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(u1),this.halfHeight.value.applyMatrix4(u1)}setupDirectRectArea(e){let t,i;e.isAvailable("float32Filterable")?(t=Vn(R0.LTC_FLOAT_1),i=Vn(R0.LTC_FLOAT_2)):(t=Vn(R0.LTC_HALF_1),i=Vn(R0.LTC_HALF_2));const{colorNode:r,light:s}=this,o=T5(s);return{lightColor:r,lightPosition:o,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:i}}static setLTC(e){R0=e}}class YD extends Ph{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=jt(0).setGroup(nn),this.penumbraCosNode=jt(0).setGroup(nn),this.cutoffDistanceNode=jt(0).setGroup(nn),this.decayExponentNode=jt(0).setGroup(nn)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e){const{coneCosNode:t,penumbraCosNode:i}=this;return ml(t,i,e)}setupDirect(e){const{colorNode:t,cutoffDistanceNode:i,decayExponentNode:r,light:s}=this,o=this.getLightVector(e),a=o.normalize(),l=a.dot(S5(s)),u=this.getSpotAttenuation(l),A=o.length(),p=E5({lightDistance:A,cutoffDistance:i,decayExponent:r});let g=t.mul(u).mul(p);if(s.map){const v=TD(s,e.context.positionWorld),y=Vn(s.map,v.xy).onRenderUpdate(()=>s.map);g=v.mul(2).sub(1).abs().lessThan(1).all().select(g.mul(y),g)}return{lightColor:g,lightDirection:a}}}class Zce extends YD{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e){const t=this.light.iesMap;let i=null;if(t&&t.isTexture===!0){const r=e.acos().mul(1/Math.PI);i=Vn(t,ut(r,0),0).r}else i=super.getSpotAttenuation(e);return i}}class Kce extends Ph{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class Jce extends Ph{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=b5(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=jt(new Gt).setGroup(nn)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:i,lightDirectionNode:r}=this,o=la.dot(r).mul(.5).add(.5),a=li(i,t,o);e.context.irradiance.addAssign(a)}}class ehe extends Ph{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let i=0;i<9;i++)t.push(new re);this.lightProbe=Zo(t)}update(e){const{light:t}=this;super.update(e);for(let i=0;i<9;i++)this.lightProbe.array[i].copy(t.sh.coefficients[i]).multiplyScalar(t.intensity)}setup(e){const t=jD(a_,this.lightProbe);e.context.irradiance.addAssign(t)}}class ZD{parseFunction(){console.warn("Abstract function.")}}class P5{constructor(e,t,i="",r=""){this.type=e,this.inputs=t,this.name=i,this.precision=r}getCode(){console.warn("Abstract function.")}}P5.isNodeFunction=!0;const the=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,nhe=/[a-z_0-9]+/ig,Zw="#pragma main",ihe=n=>{n=n.trim();const e=n.indexOf(Zw),t=e!==-1?n.slice(e+Zw.length):n,i=t.match(the);if(i!==null&&i.length===5){const r=i[4],s=[];let o=null;for(;(o=nhe.exec(r))!==null;)s.push(o);const a=[];let l=0;for(;l<s.length;){const y=s[l][0]==="const";y===!0&&l++;let b=s[l][0];b==="in"||b==="out"||b==="inout"?l++:b="";const w=s[l++][0];let S=Number.parseInt(s[l][0]);Number.isNaN(S)===!1?l++:S=null;const C=s[l++][0];a.push(new N5(w,C,S,b,y))}const u=t.substring(i[0].length),A=i[3]!==void 0?i[3]:"",p=i[2],g=i[1]!==void 0?i[1]:"",v=e!==-1?n.slice(0,e):"";return{type:p,inputs:a,name:A,precision:g,inputsCode:r,blockCode:u,headerCode:v}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class rhe extends P5{constructor(e){const{type:t,inputs:i,name:r,precision:s,inputsCode:o,blockCode:a,headerCode:l}=ihe(e);super(t,i,r,s),this.inputsCode=o,this.blockCode=a,this.headerCode=l}getCode(e=this.name){let t;const i=this.blockCode;if(i!==""){const{type:r,inputsCode:s,headerCode:o,precision:a}=this;let l=`${r} ${e} ( ${s.trim()} )`;a!==""&&(l=`${a} ${l}`),t=o+l+i}else t="";return t}}class she extends ZD{parseFunction(e){return new rhe(e)}}const Kw=new WeakMap,Wa=[],pf=[];class ohe extends lc{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new Yw,this.nodeBuilderCache=new Map,this.callHashCache=new Ia,this.groupsData=new Ia,this.cacheLib={}}updateGroup(e){const t=e.groupNode,i=t.name;if(i===Db.name)return!0;if(i===nn.name){const s=this.get(e),o=this.nodeFrame.renderId;return s.renderId!==o?(s.renderId=o,!0):!1}if(i===HR.name){const s=this.get(e),o=this.nodeFrame.frameId;return s.frameId!==o?(s.frameId=o,!0):!1}Wa[0]=t,Wa[1]=e;let r=this.groupsData.get(Wa);return r===void 0&&this.groupsData.set(Wa,r={}),Wa.length=0,r.version!==t.version?(r.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let i=t.nodeBuilderState;if(i===void 0){const{nodeBuilderCache:r}=this,s=this.getForRenderCacheKey(e);if(i=r.get(s),i===void 0){const o=this.backend.createNodeBuilder(e.object,this.renderer);o.scene=e.scene,o.material=e.material,o.camera=e.camera,o.context.material=e.material,o.lightsNode=e.lightsNode,o.environmentNode=this.getEnvironmentNode(e.scene),o.fogNode=this.getFogNode(e.scene),o.clippingContext=e.clippingContext,this.renderer.getRenderTarget()&&this.renderer.getRenderTarget().multiview&&o.enableMultiview(),o.build(),i=this._createNodeBuilderState(o),r.set(s,i)}i.usedTimes++,t.nodeBuilderState=i}return i}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let i=t.nodeBuilderState;if(i===void 0){const r=this.backend.createNodeBuilder(e,this.renderer);r.build(),i=this._createNodeBuilderState(r),t.nodeBuilderState=i}return i}_createNodeBuilderState(e){return new Mce(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const i=this.get(e);i.environmentNode&&(t=i.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const i=this.get(e);i.backgroundNode&&(t=i.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){Wa[0]=e,Wa[1]=t;const i=this.renderer.info.calls,r=this.callHashCache.get(Wa)||{};if(r.callId!==i){const s=this.getEnvironmentNode(e),o=this.getFogNode(e);t&&pf.push(t.getCacheKey(!0)),s&&pf.push(s.getCacheKey()),o&&pf.push(o.getCacheKey()),pf.push(this.renderer.shadowMap.enabled?1:0),r.callId=i,r.cacheKey=W2(pf),this.callHashCache.set(Wa,r),pf.length=0}return Wa.length=0,r.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),i=e.background;if(i){const r=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==i||r){const s=this.getCacheNode("background",i,()=>{if(i.isCubeTexture===!0||i.mapping===ch||i.mapping===hh||i.mapping===fh){if(e.backgroundBlurriness>0||i.mapping===fh)return A5(i);{let o;return i.isCubeTexture===!0?o=LA(i):o=Vn(i),CL(o)}}else{if(i.isTexture===!0)return Vn(i,Ca.flipY()).setUpdateMatrix(!0);i.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",i)}},r);t.backgroundNode=s,t.background=i,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,i,r=!1){const s=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let o=s.get(t);return(o===void 0||r)&&(o=i(),s.set(t,o)),o}updateFog(e){const t=this.get(e),i=e.fog;if(i){if(t.fog!==i){const r=this.getCacheNode("fog",i,()=>{if(i.isFogExp2){const s=xi("color","color",i).setGroup(nn),o=xi("density","float",i).setGroup(nn);return hp(s,v5(o))}else if(i.isFog){const s=xi("color","color",i).setGroup(nn),o=xi("near","float",i).setGroup(nn),a=xi("far","float",i).setGroup(nn);return hp(s,_5(o,a))}else console.error("THREE.Renderer: Unsupported fog configuration.",i)});t.fogNode=r,t.fog=i}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),i=e.environment;if(i){if(t.environment!==i){const r=this.getCacheNode("environment",i,()=>{if(i.isCubeTexture===!0)return LA(i);if(i.isTexture===!0)return Vn(i);console.error("Nodes: Unsupported environment configuration.",i)});t.environmentNode=r,t.environment=i}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,i=null,r=null,s=null){const o=this.nodeFrame;return o.renderer=e,o.scene=t,o.object=i,o.camera=r,o.material=s,o}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return Kw.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,i=this.getOutputCacheKey(),r=e.isTextureArray?oD(e,Ce(Ca,Bp("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):Vn(e,Ca).renderOutput(t.toneMapping,t.currentColorSpace);return Kw.set(e,i),r}updateBefore(e){const t=e.getNodeBuilderState();for(const i of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(i)}updateAfter(e){const t=e.getNodeBuilderState();for(const i of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(i)}updateForCompute(e){const t=this.getNodeFrame(),i=this.getForCompute(e);for(const r of i.updateNodes)t.updateNode(r)}updateForRender(e){const t=this.getNodeFrameForRender(e),i=e.getNodeBuilderState();for(const r of i.updateNodes)t.updateNode(r)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new Yw,this.nodeBuilderCache=new Map,this.cacheLib={}}}const Cv=new Ka;class d2{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new bn,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,i){const r=e.length;for(let s=0;s<r;s++){Cv.copy(e[s]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const o=t[i+s],a=Cv.normal;o.x=-a.x,o.y=-a.y,o.z=-a.z,o.w=Cv.constant}}updateGlobal(e,t){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let i=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const r=t.clippingPlanes,s=r.length;let o,a;if(this.clipIntersection?(o=this.intersectionPlanes,a=e.intersectionPlanes.length):(o=this.unionPlanes,a=e.unionPlanes.length),o.length!==a+s){o.length=a+s;for(let l=0;l<s;l++)o[a+l]=new Kt;i=!0}this.projectPlanes(r,o,a),i&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return t===void 0&&(t=new d2(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class ahe{constructor(e,t){this.bundleGroup=e,this.camera=t}}const N0=[];class lhe{constructor(){this.bundles=new Ia}get(e,t){const i=this.bundles;N0[0]=e,N0[1]=t;let r=i.get(N0);return r===void 0&&(r=new ahe(e,t),i.set(N0,r)),N0.length=0,r}dispose(){this.bundles=new Ia}}class KD{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const i=this.getMaterialNodeClass(e.type);if(i!==null){t=new i;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,i){if(i.has(t)){console.warn(`Redefinition of node ${t}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);i.set(t,e)}addClass(e,t,i){if(i.has(t)){console.warn(`Redefinition of node ${t.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);i.set(t,e)}}const uhe=new w5,P0=[];class che extends Ia{constructor(){super()}createNode(e=[]){return new w5().setLights(e)}getNode(e,t){if(e.isQuadMesh)return uhe;P0[0]=e,P0[1]=t;let i=this.get(P0);return i===void 0&&(i=this.createNode(),this.set(P0,i)),P0.length=0,i}}class $0 extends bl{constructor(e=1,t=1,i={}){super(e,t,i),this.isXRRenderTarget=!0,this.hasExternalTextures=!1,this.autoAllocateDepthBuffer=!0}copy(e){return super.copy(e),this.hasExternalTextures=e.hasExternalTextures,this.autoAllocateDepthBuffer=e.autoAllocateDepthBuffer,this}}const Jw=new re,eM=new re;class hhe extends xl{constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new Er,this._cameraL.viewport=new Kt,this._cameraR=new Er,this._cameraR.viewport=new Kt,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new $9,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._supportsLayers=!1,this._createXRLayer=ghe.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new rt,this._onSessionEvent=dhe.bind(this),this._onSessionEnd=phe.bind(this),this._onInputSourcesChange=mhe.bind(this),this._onAnimationFrame=_he.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._useLayers=typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,i,r,s,o,a,l=[]){const u=new Sp(e,t),A=new $0(s,o,{format:ur,type:Ji,depthTexture:new lo(s,o,l.stencil?Io:Ni,void 0,void 0,void 0,void 0,void 0,void 0,l.stencil?Fo:Bo),stencilBuffer:l.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),p=new va({color:16777215,side:oo});p.map=A.texture,p.map.offset.y=1,p.map.repeat.y=-1;const g=new Jn(u,p);g.position.copy(i),g.quaternion.copy(r);const v={type:"quad",width:e,height:t,translation:i,quaternion:r,pixelwidth:s,pixelheight:o,plane:g,material:p,rendercall:a,renderTarget:A};if(this._layers.push(v),this._session!==null){v.plane.material=new va({color:16777215,side:oo}),v.plane.material.blending=$f,v.plane.material.blendEquation=gs,v.plane.material.blendSrc=Ul,v.plane.material.blendDst=Ul,v.xrlayer=this._createXRLayer(v);const y=this._session.renderState.layers;y.unshift(v.xrlayer),this._session.updateRenderState({layers:y})}else A.isXRRenderTarget=!1;return g}createCylinderLayer(e,t,i,r,s,o,a,l,u=[]){const A=new U2(e,e,e*t/i,64,64,!0,Math.PI-t/2,t),p=new $0(o,a,{format:ur,type:Ji,depthTexture:new lo(o,a,u.stencil?Io:Ni,void 0,void 0,void 0,void 0,void 0,void 0,u.stencil?Fo:Bo),stencilBuffer:u.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),g=new va({color:16777215,side:wi});g.map=p.texture,g.map.offset.y=1,g.map.repeat.y=-1;const v=new Jn(A,g);v.position.copy(r),v.quaternion.copy(s);const y={type:"cylinder",radius:e,centralAngle:t,aspectratio:i,translation:r,quaternion:s,pixelwidth:o,pixelheight:a,plane:v,material:g,rendercall:l,renderTarget:p};if(this._layers.push(y),this._session!==null){y.plane.material=new va({color:16777215,side:wi}),y.plane.material.blending=$f,y.plane.material.blendEquation=gs,y.plane.material.blendSrc=Ul,y.plane.material.blendDst=Ul,y.xrlayer=this._createXRLayer(y);const b=this._session.renderState.layers;b.unshift(y.xrlayer),this._session.updateRenderState({layers:b})}else p.isXRRenderTarget=!1;return v}renderLayers(){const e=new re,t=new eu,i=this.isPresenting;this.isPresenting=!1;for(const r of this._layers){if(r.renderTarget.isXRRenderTarget=this._session!==null,r.renderTarget.hasExternalTextures=r.renderTarget.isXRRenderTarget,r.renderTarget.autoAllocateDepthBuffer=!r.renderTarget.isXRRenderTarget,r.renderTarget.isXRRenderTarget&&this._supportsLayers){r.xrlayer.transform=new XRRigidTransform(r.plane.getWorldPosition(e),r.plane.getWorldQuaternion(t));const s=this._glBinding.getSubImage(r.xrlayer,this._xrFrame);this._renderer.backend.setXRRenderTargetTextures(r.renderTarget,s.colorTexture,s.depthStencilTexture)}this._renderer.setRenderTarget(r.renderTarget),r.rendercall()}this.isPresenting=i,this._renderer.setRenderTarget(null)}getSession(){return this._session}async setSession(e){const t=this._renderer,i=t.backend;this._gl=t.getContext();const r=this._gl,s=r.getContextAttributes();if(this._session=e,e!==null){if(i.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await i.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),this._useLayers===!0){let o=null,a=null,l=null;t.depth&&(l=t.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,o=t.stencil?Fo:Bo,a=t.stencil?Io:Ni);const u={colorFormat:r.RGBA8,depthFormat:l,scaleFactor:this._framebufferScaleFactor};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(u.textureType="texture-array",this._useMultiview=!0);const A=new XRWebGLBinding(e,r),p=A.createProjectionLayer(u),g=[p];this._glBinding=A,this._glProjLayer=p,t.setPixelRatio(1),t.setSize(p.textureWidth,p.textureHeight,!1);let v;if(this._useMultiview?(v=new L9(p.textureWidth,p.textureHeight,2),v.type=a,v.format=o):v=new lo(p.textureWidth,p.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,o),this._xrRenderTarget=new $0(p.textureWidth,p.textureHeight,{format:ur,type:Ji,colorSpace:t.outputColorSpace,depthTexture:v,stencilBuffer:t.stencil,samples:s.antialias?4:0,resolveDepthBuffer:p.ignoreDepthValues===!1,resolveStencilBuffer:p.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget.hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._supportsLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._supportsLayers)for(const y of this._layers)y.plane.material=new va({color:16777215,side:y.type==="cylinder"?wi:oo}),y.plane.material.blending=$f,y.plane.material.blendEquation=gs,y.plane.material.blendSrc=Ul,y.plane.material.blendDst=Ul,y.xrlayer=this._createXRLayer(y),g.unshift(y.xrlayer);e.updateRenderState({layers:g})}else{const o={antialias:t.samples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},a=new XRWebGLLayer(e,r,o);this._glBaseLayer=a,e.updateRenderState({baseLayer:a}),t.setPixelRatio(1),t.setSize(a.framebufferWidth,a.framebufferHeight,!1),this._xrRenderTarget=new $0(a.framebufferWidth,a.framebufferHeight,{format:ur,type:Ji,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:a.ignoreDepthValues===!1,resolveStencilBuffer:a.ignoreDepthValues===!1}),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(t===null)return;const i=e.near,r=e.far,s=this._cameraXR,o=this._cameraL,a=this._cameraR;s.near=a.near=o.near=i,s.far=a.far=o.far=r,s.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==s.near||this._currentDepthFar!==s.far)&&(t.updateRenderState({depthNear:s.near,depthFar:s.far}),this._currentDepthNear=s.near,this._currentDepthFar=s.far),o.layers.mask=e.layers.mask|2,a.layers.mask=e.layers.mask|4,s.layers.mask=o.layers.mask|a.layers.mask;const l=e.parent,u=s.cameras;tM(s,l);for(let A=0;A<u.length;A++)tM(u[A],l);u.length===2?fhe(s,o,a):s.projectionMatrix.copy(o.projectionMatrix),Ahe(e,s,l)}_getController(e){let t=this._controllers[e];return t===void 0&&(t=new O1,this._controllers[e]=t),t}}function fhe(n,e,t){Jw.setFromMatrixPosition(e.matrixWorld),eM.setFromMatrixPosition(t.matrixWorld);const i=Jw.distanceTo(eM),r=e.projectionMatrix.elements,s=t.projectionMatrix.elements,o=r[14]/(r[10]-1),a=r[14]/(r[10]+1),l=(r[9]+1)/r[5],u=(r[9]-1)/r[5],A=(r[8]-1)/r[0],p=(s[8]+1)/s[0],g=o*A,v=o*p,y=i/(-A+p),b=y*-A;if(e.matrixWorld.decompose(n.position,n.quaternion,n.scale),n.translateX(b),n.translateZ(y),n.matrixWorld.compose(n.position,n.quaternion,n.scale),n.matrixWorldInverse.copy(n.matrixWorld).invert(),r[10]===-1)n.projectionMatrix.copy(e.projectionMatrix),n.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const w=o+y,S=a+y,C=g-b,E=v+(i-b),R=l*a/S*w,D=u*a/S*w;n.projectionMatrix.makePerspective(C,E,R,D,w,S),n.projectionMatrixInverse.copy(n.projectionMatrix).invert()}}function tM(n,e){e===null?n.matrixWorld.copy(n.matrix):n.matrixWorld.multiplyMatrices(e.matrixWorld,n.matrix),n.matrixWorldInverse.copy(n.matrixWorld).invert()}function Ahe(n,e,t){t===null?n.matrix.copy(e.matrixWorld):(n.matrix.copy(t.matrixWorld),n.matrix.invert(),n.matrix.multiply(e.matrixWorld)),n.matrix.decompose(n.position,n.quaternion,n.scale),n.updateMatrixWorld(!0),n.projectionMatrix.copy(e.projectionMatrix),n.projectionMatrixInverse.copy(e.projectionMatrixInverse),n.isPerspectiveCamera&&(n.fov=ph*2*Math.atan(1/n.projectionMatrix.elements[5]),n.zoom=1)}function dhe(n){const e=this._controllerInputSources.indexOf(n.inputSource);if(e===-1)return;const t=this._controllers[e];if(t!==void 0){const i=this.getReferenceSpace();t.update(n.inputSource,n.frame,i),t.dispatchEvent({type:n.type,data:n.inputSource})}}function phe(){const n=this._session,e=this._renderer;n.removeEventListener("select",this._onSessionEvent),n.removeEventListener("selectstart",this._onSessionEvent),n.removeEventListener("selectend",this._onSessionEvent),n.removeEventListener("squeeze",this._onSessionEvent),n.removeEventListener("squeezestart",this._onSessionEvent),n.removeEventListener("squeezeend",this._onSessionEvent),n.removeEventListener("end",this._onSessionEnd),n.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let t=0;t<this._controllers.length;t++){const i=this._controllerInputSources[t];i!==null&&(this._controllerInputSources[t]=null,this._controllers[t].disconnect(i))}if(this._currentDepthNear=null,this._currentDepthFar=null,e.backend.setXRTarget(null),e.setOutputRenderTarget(null),e.setRenderTarget(null),this._session=null,this._xrRenderTarget=null,this._supportsLayers===!0)for(const t of this._layers)t.renderTarget=new $0(t.pixelwidth,t.pixelheight,{format:ur,type:Ji,depthTexture:new lo(t.pixelwidth,t.pixelheight,t.stencilBuffer?Io:Ni,void 0,void 0,void 0,void 0,void 0,void 0,t.stencilBuffer?Fo:Bo),stencilBuffer:t.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),t.renderTarget.isXRRenderTarget=!1,t.plane.material=t.material,t.material.map=t.renderTarget.texture,delete t.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function mhe(n){const e=this._controllers,t=this._controllerInputSources;for(let i=0;i<n.removed.length;i++){const r=n.removed[i],s=t.indexOf(r);s>=0&&(t[s]=null,e[s].disconnect(r))}for(let i=0;i<n.added.length;i++){const r=n.added[i];let s=t.indexOf(r);if(s===-1){for(let a=0;a<e.length;a++)if(a>=t.length){t.push(r),s=a;break}else if(t[a]===null){t[a]=r,s=a;break}if(s===-1)break}const o=e[s];o&&o.connect(r)}}function ghe(n){return n.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(n.translation,n.quaternion),depthFormat:this._gl.DEPTH_COMPONENT,width:n.width/2,height:n.height/2,space:this._referenceSpace,viewPixelWidth:n.pixelwidth,viewPixelHeight:n.pixelheight}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(n.translation,n.quaternion),depthFormat:this._gl.DEPTH_COMPONENT,radius:n.radius,centralAngle:n.centralAngle,aspectRatio:n.aspectRatio,space:this._referenceSpace,viewPixelWidth:n.pixelwidth,viewPixelHeight:n.pixelheight})}function _he(n,e){if(e===void 0)return;const t=this._cameraXR,i=this._renderer,r=i.backend,s=this._glBaseLayer,o=this.getReferenceSpace(),a=e.getViewerPose(o);if(this._xrFrame=e,a!==null){const l=a.views;this._glBaseLayer!==null&&r.setXRTarget(s.framebuffer);let u=!1;l.length!==t.cameras.length&&(t.cameras.length=0,u=!0);for(let A=0;A<l.length;A++){const p=l[A];let g;if(this._useLayers===!0){const y=this._glBinding.getViewSubImage(this._glProjLayer,p);g=y.viewport,A===0&&r.setXRRenderTargetTextures(this._xrRenderTarget,y.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:y.depthStencilTexture)}else g=s.getViewport(p);let v=this._cameras[A];v===void 0&&(v=new Er,v.layers.enable(A),v.viewport=new Kt,this._cameras[A]=v),v.matrix.fromArray(p.transform.matrix),v.matrix.decompose(v.position,v.quaternion,v.scale),v.projectionMatrix.fromArray(p.projectionMatrix),v.projectionMatrixInverse.copy(v.projectionMatrix).invert(),v.viewport.set(g.x,g.y,g.width,g.height),A===0&&(t.matrix.copy(v.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale)),u===!0&&t.cameras.push(v)}i.setOutputRenderTarget(this._xrRenderTarget)}for(let l=0;l<this._controllers.length;l++){const u=this._controllerInputSources[l],A=this._controllers[l];u!==null&&A!==void 0&&A.update(u,e,o)}this._currentAnimationLoop&&this._currentAnimationLoop(n,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}const nM=new zA,c1=new rt,Rv=new Kt,Nv=new qA,Pv=new H4,h1=new on,Ru=new Kt;class vhe{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:i=!1,alpha:r=!0,depth:s=!0,stencil:o=!1,antialias:a=!1,samples:l=0,getFallback:u=null,colorBufferType:A=Dr,multiview:p=!1}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=l||a===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=r,this.logarithmicDepthBuffer=i,this.outputColorSpace=Zt,this.toneMapping=ao,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=s,this.stencil=o,this.info=new boe,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new KD,this.lighting=new che,this._getFallback=u,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new Kt(0,0,this._width,this._height),this._scissor=new Kt(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new m5(new yr),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const g=this.alpha===!0?0:1;this._clearColor=new d5(0,0,0,g),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=A,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:m4},this.xr=new hhe(this,p),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(v,y,b)=>{await this.compileAsync(v,y);const w=this._renderLists.get(v,y),S=this._renderContexts.get(v,y,this._renderTarget),C=v.overrideMaterial||b.material,E=this._objects.get(b,C,v,y,w.lightsNode,S,S.clippingContext),{fragmentShader:R,vertexShader:D}=E.getNodeBuilderState();return{fragmentShader:R,vertexShader:D}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let i=this.backend;try{await i.init(this)}catch(r){if(this._getFallback!==null)try{this.backend=i=this._getFallback(r),await i.init(this)}catch(s){t(s);return}else{t(r);return}}this._nodes=new ohe(this,i),this._animation=new Aoe(this._nodes,this.info),this._attributes=new yoe(i),this._background=new Sce(this,this._nodes),this._geometries=new xoe(this._attributes,this.info),this._textures=new Uoe(this,i,this.info),this._pipelines=new Moe(i,this._nodes),this._bindings=new Eoe(i,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new goe(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new Noe(this.lighting),this._bundles=new lhe,this._renderContexts=new Boe,this._animation.start(),this._initialized=!0,e(this)}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,i=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const r=this._nodes.nodeFrame,s=r.renderId,o=this._currentRenderContext,a=this._currentRenderObjectFunction,l=this._compilationPromises,u=e.isScene===!0?e:nM;i===null&&(i=e);const A=this._renderTarget,p=this._renderContexts.get(i,t,A),g=this._activeMipmapLevel,v=[];this._currentRenderContext=p,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=v,r.renderId++,r.update(),p.depth=this.depth,p.stencil=this.stencil,p.clippingContext||(p.clippingContext=new d2),p.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,A);const y=this._renderLists.get(e,t);if(y.begin(),this._projectObject(e,t,0,y,p.clippingContext),i!==e&&i.traverseVisible(function(E){E.isLight&&E.layers.test(t.layers)&&y.pushLight(E)}),y.finish(),A!==null){this._textures.updateRenderTarget(A,g);const E=this._textures.get(A);p.textures=E.textures,p.depthTexture=E.depthTexture}else p.textures=null,p.depthTexture=null;this._background.update(u,y,p);const b=y.opaque,w=y.transparent,S=y.transparentDoublePass,C=y.lightsNode;this.opaque===!0&&b.length>0&&this._renderObjects(b,t,u,C),this.transparent===!0&&w.length>0&&this._renderTransparents(w,S,t,u,C),r.renderId=s,this._currentRenderContext=o,this._currentRenderObjectFunction=a,this._compilationPromises=l,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(v)}async renderAsync(e,t){this._initialized===!1&&await this.init(),this._renderScene(e,t)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){e===!0?(this.overrideNodes.modelViewMatrix=Nx,this.overrideNodes.modelNormalViewMatrix=Px):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===Nx&&this.overrideNodes.modelNormalViewMatrix===Px}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,i){const{bundleGroup:r,camera:s,renderList:o}=e,a=this._currentRenderContext,l=this._bundles.get(r,s),u=this.backend.get(l);u.renderContexts===void 0&&(u.renderContexts=new Set);const A=r.version!==u.version,p=u.renderContexts.has(a)===!1||A;if(u.renderContexts.add(a),p){this.backend.beginBundle(a),(u.renderObjects===void 0||A)&&(u.renderObjects=[]),this._currentRenderBundle=l;const{transparentDoublePass:g,transparent:v,opaque:y}=o;this.opaque===!0&&y.length>0&&this._renderObjects(y,s,t,i),this.transparent===!0&&v.length>0&&this._renderTransparents(v,g,s,t,i),this._currentRenderBundle=null,this.backend.finishBundle(a,l),u.version=r.version}else{const{renderObjects:g}=u;for(let v=0,y=g.length;v<y;v++){const b=g[v];this._nodes.needsRefresh(b)&&(this._nodes.updateBefore(b),this._nodes.updateForRender(b),this._bindings.updateForRender(b),this._nodes.updateAfter(b))}}this.backend.addBundle(a,l)}render(e,t){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this;if(e!==ao===!1&&t!==Ma===!1)return null;const{width:s,height:o}=this.getDrawingBufferSize(c1),{depth:a,stencil:l}=this;let u=this._frameBufferTarget;u===null&&(u=new bl(s,o,{depthBuffer:a,stencilBuffer:l,type:this._colorBufferType,format:ur,colorSpace:Ma,generateMipmaps:!1,minFilter:Lr,magFilter:Lr,samples:this.samples}),u.isPostProcessingRenderTarget=!0,this._frameBufferTarget=u);const A=this.getOutputRenderTarget();return u.depthBuffer=a,u.stencilBuffer=l,u.setSize(s,o,A!==null?A.depth:1),u.viewport.copy(this._viewport),u.scissor.copy(this._scissor),u.viewport.multiplyScalar(this._pixelRatio),u.scissor.multiplyScalar(this._pixelRatio),u.scissorTest=this._scissorTest,u.multiview=A!==null?A.multiview:!1,u}_renderScene(e,t,i=!0){if(this._isDeviceLost===!0)return;const r=i?this._getFrameBufferTarget():null,s=this._nodes.nodeFrame,o=s.renderId,a=this._currentRenderContext,l=this._currentRenderObjectFunction,u=e.isScene===!0?e:nM,A=this._renderTarget||this._outputRenderTarget,p=this._activeCubeFace,g=this._activeMipmapLevel;let v;r!==null?(v=r,this.setRenderTarget(v)):v=A;const y=this._renderContexts.get(e,t,v);this._currentRenderContext=y,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,s.renderId=this.info.calls;const b=this.coordinateSystem,w=this.xr;if(t.coordinateSystem!==b&&w.isPresenting===!1&&(t.coordinateSystem=b,t.updateProjectionMatrix(),t.isArrayCamera))for(const j of t.cameras)j.coordinateSystem=b,j.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),w.enabled===!0&&w.isPresenting===!0&&(w.cameraAutoUpdate===!0&&w.updateCamera(t),t=w.getCamera());let S=this._viewport,C=this._scissor,E=this._pixelRatio;v!==null&&(S=v.viewport,C=v.scissor,E=1),this.getDrawingBufferSize(c1),Rv.set(0,0,c1.width,c1.height);const R=S.minDepth===void 0?0:S.minDepth,D=S.maxDepth===void 0?1:S.maxDepth;y.viewportValue.copy(S).multiplyScalar(E).floor(),y.viewportValue.width>>=g,y.viewportValue.height>>=g,y.viewportValue.minDepth=R,y.viewportValue.maxDepth=D,y.viewport=y.viewportValue.equals(Rv)===!1,y.scissorValue.copy(C).multiplyScalar(E).floor(),y.scissor=this._scissorTest&&y.scissorValue.equals(Rv)===!1,y.scissorValue.width>>=g,y.scissorValue.height>>=g,y.clippingContext||(y.clippingContext=new d2),y.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,v);const B=t.isArrayCamera?Pv:Nv;t.isArrayCamera||(h1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),B.setFromProjectionMatrix(h1,b));const L=this._renderLists.get(e,t);if(L.begin(),this._projectObject(e,t,0,L,y.clippingContext),L.finish(),this.sortObjects===!0&&L.sort(this._opaqueSort,this._transparentSort),v!==null){this._textures.updateRenderTarget(v,g);const j=this._textures.get(v);y.textures=j.textures,y.depthTexture=j.depthTexture,y.width=j.width,y.height=j.height,y.renderTarget=v,y.depth=v.depthBuffer,y.stencil=v.stencilBuffer}else y.textures=null,y.depthTexture=null,y.width=this.domElement.width,y.height=this.domElement.height,y.depth=this.depth,y.stencil=this.stencil;y.width>>=g,y.height>>=g,y.activeCubeFace=p,y.activeMipmapLevel=g,y.occlusionQueryCount=L.occlusionQueryCount,this._background.update(u,L,y),y.camera=t,this.backend.beginRender(y);const{bundles:U,lightsNode:P,transparentDoublePass:F,transparent:V,opaque:H}=L;return U.length>0&&this._renderBundles(U,u,P),this.opaque===!0&&H.length>0&&this._renderObjects(H,t,u,P),this.transparent===!0&&V.length>0&&this._renderTransparents(V,F,t,u,P),this.backend.finishRender(y),s.renderId=o,this._currentRenderContext=a,this._currentRenderObjectFunction=l,r!==null&&(this.setRenderTarget(A,p,g),this._renderOutput(v)),u.onAfterRender(this,e,t,v),y}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const i=this.autoClear,r=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=i,this.xr.enabled=r}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,i){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=i,this.domElement.width=Math.floor(e*i),this.domElement.height=Math.floor(t*i),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setSize(e,t,i=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),i===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,i,r){const s=this._scissor;e.isVector4?s.copy(e):s.set(e,t,i,r)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,i,r,s=0,o=1){const a=this._viewport;e.isVector4?a.copy(e):a.set(e,t,i,r),a.minDepth=s,a.maxDepth=o}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,i=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,i);const r=this._renderTarget||this._getFrameBufferTarget();let s=null;if(r!==null){this._textures.updateRenderTarget(r);const o=this._textures.get(r);s=this._renderContexts.getForClear(r),s.textures=o.textures,s.depthTexture=o.depthTexture,s.width=o.width,s.height=o.height,s.renderTarget=r,s.depth=r.depthBuffer,s.stencil=r.stencilBuffer,s.clearColorValue=this.backend.getClearColor(),s.activeCubeFace=this.getActiveCubeFace(),s.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,i,s),r!==null&&this._renderTarget===null&&this._renderOutput(r)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,i=!0){this._initialized===!1&&await this.init(),this.clear(e,t,i)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:ao}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:Ma}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()}),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,i=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=i}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const t=this._nodes.nodeFrame,i=t.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,t.renderId=this.info.calls;const r=this.backend,s=this._pipelines,o=this._bindings,a=this._nodes,l=Array.isArray(e)?e:[e];if(l[0]===void 0||l[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");r.beginCompute(e);for(const u of l){if(s.has(u)===!1){const g=()=>{u.removeEventListener("dispose",g),s.delete(u),o.delete(u),a.delete(u)};u.addEventListener("dispose",g);const v=u.onInitFunction;v!==null&&v.call(u,{renderer:this})}a.updateForCompute(u),o.updateForCompute(u);const A=o.getForCompute(u),p=s.getForCompute(u,A);r.compute(e,u,A,p)}r.finishCompute(e),t.renderId=i}async computeAsync(e){this._initialized===!1&&await this.init(),this.compute(e)}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){this._initialized===!1&&await this.init(),this._textures.updateTexture(e)}initTexture(e){this._initialized===!1&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=Ru.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=Ru.copy(t).floor();else{console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else t=Ru.set(0,0,e.image.width,e.image.height);let i=this._currentRenderContext,r;i!==null?r=i.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),r!==null&&(this._textures.updateRenderTarget(r),i=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,i,t)}copyTextureToTexture(e,t,i=null,r=null,s=0,o=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,i,r,s,o)}async readRenderTargetPixelsAsync(e,t,i,r,s,o=0,a=0){return this.backend.copyTextureToBuffer(e.textures[o],t,i,r,s,a)}_projectObject(e,t,i,r,s){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)i=e.renderOrder,e.isClippingGroup&&e.enabled&&(s=s.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){const l=t.isArrayCamera?Pv:Nv;if(!e.frustumCulled||l.intersectsSprite(e,t)){this.sortObjects===!0&&Ru.setFromMatrixPosition(e.matrixWorld).applyMatrix4(h1);const{geometry:u,material:A}=e;A.visible&&r.push(e,u,A,i,Ru.z,null,s)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const l=t.isArrayCamera?Pv:Nv;if(!e.frustumCulled||l.intersectsObject(e,t)){const{geometry:u,material:A}=e;if(this.sortObjects===!0&&(u.boundingSphere===null&&u.computeBoundingSphere(),Ru.copy(u.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(h1)),Array.isArray(A)){const p=u.groups;for(let g=0,v=p.length;g<v;g++){const y=p[g],b=A[y.materialIndex];b&&b.visible&&r.push(e,u,b,i,Ru.z,y,s)}}else A.visible&&r.push(e,u,A,i,Ru.z,null,s)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const l=r;r=this._renderLists.get(e,t),r.begin(),l.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}const a=e.children;for(let l=0,u=a.length;l<u;l++)this._projectObject(a[l],t,i,r,s)}_renderBundles(e,t,i){for(const r of e)this._renderBundle(r,t,i)}_renderTransparents(e,t,i,r,s){if(t.length>0){for(const{material:o}of t)o.side=wi;this._renderObjects(t,i,r,s,"backSide");for(const{material:o}of t)o.side=oo;this._renderObjects(e,i,r,s);for(const{material:o}of t)o.side=ar}else this._renderObjects(e,i,r,s)}_renderObjects(e,t,i,r,s=null){for(let o=0,a=e.length;o<a;o++){const{object:l,geometry:u,material:A,group:p,clippingContext:g}=e[o];this._currentRenderObjectFunction(l,i,t,u,A,p,r,g,s)}}renderObject(e,t,i,r,s,o,a,l=null,u=null){let A,p,g;if(e.onBeforeRender(this,t,i,r,s,o),s.allowOverride===!0&&t.overrideMaterial!==null){const v=t.overrideMaterial;s.positionNode&&s.positionNode.isNode&&(A=v.positionNode,v.positionNode=s.positionNode),v.alphaTest=s.alphaTest,v.alphaMap=s.alphaMap,v.transparent=s.transparent||s.transmission>0,v.isShadowPassMaterial&&(v.side=s.shadowSide===null?s.side:s.shadowSide,s.depthNode&&s.depthNode.isNode&&(g=v.depthNode,v.depthNode=s.depthNode),s.castShadowNode&&s.castShadowNode.isNode&&(p=v.colorNode,v.colorNode=s.castShadowNode),s.castShadowPositionNode&&s.castShadowPositionNode.isNode&&(A=v.positionNode,v.positionNode=s.castShadowPositionNode)),s=v}s.transparent===!0&&s.side===ar&&s.forceSinglePass===!1?(s.side=wi,this._handleObjectFunction(e,s,t,i,a,o,l,"backSide"),s.side=oo,this._handleObjectFunction(e,s,t,i,a,o,l,u),s.side=ar):this._handleObjectFunction(e,s,t,i,a,o,l,u),A!==void 0&&(t.overrideMaterial.positionNode=A),g!==void 0&&(t.overrideMaterial.depthNode=g),p!==void 0&&(t.overrideMaterial.colorNode=p),e.onAfterRender(this,t,i,r,s,o)}_renderObjectDirect(e,t,i,r,s,o,a,l){const u=this._objects.get(e,t,i,r,s,this._currentRenderContext,a,l);u.drawRange=e.geometry.drawRange,u.group=o;const A=this._nodes.needsRefresh(u);A&&(this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u)),this._pipelines.updateForRender(u),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(u),u.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(u,this.info),A&&this._nodes.updateAfter(u)}_createObjectPipeline(e,t,i,r,s,o,a,l){const u=this._objects.get(e,t,i,r,s,this._currentRenderContext,a,l);u.drawRange=e.geometry.drawRange,u.group=o,this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u),this._pipelines.getForRender(u,this._compilationPromises),this._nodes.updateAfter(u)}get compile(){return this.compileAsync}}class L5{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function yhe(n){return n+(qu-n%qu)%qu}class JD extends L5{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return yhe(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class eI extends JD{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let xhe=0;class tI extends eI{constructor(e,t){super("UniformBuffer_"+xhe++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class bhe extends eI{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){let e=0;for(let t=0,i=this.uniforms.length;t<i;t++){const r=this.uniforms[t],{boundary:s,itemSize:o}=r,a=e%qu,l=qu-a;a!==0&&l-s<0?e+=qu-a:a%s!==0&&(e+=a%s),r.offset=e/this.bytesPerElement,e+=o*this.bytesPerElement}return Math.ceil(e/qu)*qu}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(i[s]!==r){const a=this._getBufferForType(o);a[s]=i[s]=r,t=!0}return t}updateVector2(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(i[s+0]!==r.x||i[s+1]!==r.y){const a=this._getBufferForType(o);a[s+0]=i[s+0]=r.x,a[s+1]=i[s+1]=r.y,t=!0}return t}updateVector3(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(i[s+0]!==r.x||i[s+1]!==r.y||i[s+2]!==r.z){const a=this._getBufferForType(o);a[s+0]=i[s+0]=r.x,a[s+1]=i[s+1]=r.y,a[s+2]=i[s+2]=r.z,t=!0}return t}updateVector4(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset,o=e.getType();if(i[s+0]!==r.x||i[s+1]!==r.y||i[s+2]!==r.z||i[s+4]!==r.w){const a=this._getBufferForType(o);a[s+0]=i[s+0]=r.x,a[s+1]=i[s+1]=r.y,a[s+2]=i[s+2]=r.z,a[s+3]=i[s+3]=r.w,t=!0}return t}updateColor(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset;if(i[s+0]!==r.r||i[s+1]!==r.g||i[s+2]!==r.b){const o=this.buffer;o[s+0]=i[s+0]=r.r,o[s+1]=i[s+1]=r.g,o[s+2]=i[s+2]=r.b,t=!0}return t}updateMatrix3(e){let t=!1;const i=this.values,r=e.getValue().elements,s=e.offset;if(i[s+0]!==r[0]||i[s+1]!==r[1]||i[s+2]!==r[2]||i[s+4]!==r[3]||i[s+5]!==r[4]||i[s+6]!==r[5]||i[s+8]!==r[6]||i[s+9]!==r[7]||i[s+10]!==r[8]){const o=this.buffer;o[s+0]=i[s+0]=r[0],o[s+1]=i[s+1]=r[1],o[s+2]=i[s+2]=r[2],o[s+4]=i[s+4]=r[3],o[s+5]=i[s+5]=r[4],o[s+6]=i[s+6]=r[5],o[s+8]=i[s+8]=r[6],o[s+9]=i[s+9]=r[7],o[s+10]=i[s+10]=r[8],t=!0}return t}updateMatrix4(e){let t=!1;const i=this.values,r=e.getValue().elements,s=e.offset;return She(i,r,s)===!1&&(this.buffer.set(r,s),The(i,r,s),t=!0),t}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function The(n,e,t){for(let i=0,r=e.length;i<r;i++)n[t+i]=e[i]}function She(n,e,t){for(let i=0,r=e.length;i<r;i++)if(n[t+i]!==e[i])return!1;return!0}let whe=0;class nI extends bhe{constructor(e,t){super(e),this.id=whe++,this.groupNode=t,this.isNodeUniformsGroup=!0}}let Mhe=0;class Ehe extends L5{constructor(e,t){super(e),this.id=Mhe++,this.texture=t,this.version=t?t.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:t}=this;return e!==this.generation?(this.generation=e,!0):t.isVideoTexture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}}class g_ extends Ehe{constructor(e,t,i,r=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=i,this.access=r}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class iI extends g_{constructor(e,t,i,r=null){super(e,t,i,r),this.isSampledCubeTexture=!0}}class rI extends g_{constructor(e,t,i,r=null){super(e,t,i,r),this.isSampledTexture3D=!0}}const Che={textureDimensions:"textureSize",equals:"equal"},Rhe={low:"lowp",medium:"mediump",high:"highp"},iM={swizzleAssign:!0,storageBuffer:!1},rM={perspective:"smooth",linear:"noperspective"},sM={centroid:"centroid","flat first":"flat","flat either":"flat"},oM=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class Nhe extends QD{constructor(e,t){super(e,t,new she),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Po}getMethod(e){return Che[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,i=this.flowShaderNode(e),r=[];for(const o of t.inputs)r.push(this.getType(o.type)+" "+o.name);return`${this.getType(t.type)} ${t.name}( ${r.join(", ")} ) {

	${i.vars}

${i.code}
	return ${i.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const i=t.array,r=t.count*t.itemSize,{itemSize:s}=t,o=t.array.constructor.name.toLowerCase().includes("int");let a=o?OA:yp;s===2?a=o?kA:jl:s===3?a=o?kq:vp:s===4&&(a=o?VA:ur);const l={Float32Array:mr,Uint8Array:Ji,Uint16Array:xa,Uint32Array:Ni,Int8Array:Kc,Int16Array:Jc,Int32Array:qr,Uint8ClampedArray:Ji},u=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/s))));let A=Math.ceil(r/s/u);u*A*s<r&&A++;const p=u*A*s,g=new i.constructor(p);g.set(i,0),t.array=g;const v=new HG(t.array,u,A,a,l[t.array.constructor.name]||mr);v.needsUpdate=!0,v.isPBOTexture=!0;const y=new gl(v,null,null);y.setPrecision("high"),t.pboNode=y,t.pbo=y.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:i}=e,r=t.value;if(this.renderer.backend.has(r)){const A=this.renderer.backend.get(r);A.pbo=r.pbo}const s=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.label),o=this.getPropertyName(s);this.increaseUsage(i);const a=i.build(this,"uint"),l=this.getDataFromNode(e);let u=l.propertyName;if(u===void 0){const A=this.getVarFromNode(e);u=this.getPropertyName(A);const p=this.getDataFromNode(t);let g=p.propertySizeName;g===void 0&&(g=u+"Size",this.getVarFromNode(t,g,"uint"),this.addLineFlowCode(`${g} = uint( textureSize( ${o}, 0 ).x )`,e),p.propertySizeName=g);const{itemSize:v}=r,y="."+Mh.join("").slice(0,v),b=`ivec2(${a} % ${g}, ${a} / ${g})`,w=this.generateTextureLoad(null,o,b,null,"0");let S="vec4";r.pbo.type===Ni?S="uvec4":r.pbo.type===qr&&(S="ivec4"),this.addLineFlowCode(`${u} = ${S}(${w})${y}`,e),l.propertyName=u}return u}generateTextureLoad(e,t,i,r,s="0"){return r?`texelFetch( ${t}, ivec3( ${i}, ${r} ), ${s} )`:`texelFetch( ${t}, ${i}, ${s} )`}generateTexture(e,t,i,r){return e.isDepthTexture?(r&&(i=`vec4( ${i}, ${r} )`),`texture( ${t}, ${i} ).x`):(r&&(i=`vec3( ${i}, ${r} )`),`texture( ${t}, ${i} )`)}generateTextureLevel(e,t,i,r){return`textureLod( ${t}, ${i}, ${r} )`}generateTextureBias(e,t,i,r){return`texture( ${t}, ${i}, ${r} )`}generateTextureGrad(e,t,i,r){return`textureGrad( ${t}, ${i}, ${r[0]}, ${r[1]} )`}generateTextureCompare(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return s?`texture( ${t}, vec4( ${i}, ${s}, ${r} ) )`:`texture( ${t}, vec3( ${i}, ${r} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}getVars(e){const t=[],i=this.vars[e];if(i!==void 0)for(const r of i)t.push(`${this.getVar(r.type,r.name,r.count)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],i=[],r={};for(const o of t){let a=null,l=!1;if(o.type==="texture"||o.type==="texture3D"){const A=o.node.value;let p="";(A.isDataTexture===!0||A.isData3DTexture===!0)&&(A.type===Ni?p="u":A.type===qr&&(p="i")),o.type==="texture3D"&&A.isTextureArray===!1?a=`${p}sampler3D ${o.name};`:A.compareFunction?A.isDepthArrayTexture===!0?a=`sampler2DArrayShadow ${o.name};`:a=`sampler2DShadow ${o.name};`:A.isDataArrayTexture===!0||A.isCompressedArrayTexture===!0||A.isTextureArray===!0?a=`${p}sampler2DArray ${o.name};`:a=`${p}sampler2D ${o.name};`}else if(o.type==="cubeTexture")a=`samplerCube ${o.name};`;else if(o.type==="buffer"){const A=o.node,p=this.getType(A.bufferType),g=A.bufferCount,v=g>0?g:"";a=`${A.name} {
	${p} ${o.name}[${v}];
};
`}else a=`${this.getVectorType(o.type)} ${this.getPropertyName(o,e)};`,l=!0;const u=o.node.precision;if(u!==null&&(a=Rhe[u]+" "+a),l){a="	"+a;const A=o.groupNode.name;(r[A]||(r[A]=[])).push(a)}else a="uniform "+a,i.push(a)}let s="";for(const o in r){const a=r[o];s+=this._getGLSLUniformStruct(e+"_"+o,a.join(`
`))+`
`}return s+=i.join(`
`),s}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==qr){let i=e;e.isInterleavedBufferAttribute&&(i=e.data);const r=i.array;r instanceof Uint32Array||r instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const i=this.getAttributesArray();let r=0;for(const s of i)t+=`layout( location = ${r++} ) in ${s.type} ${s.name};
`}return t}getStructMembers(e){const t=[];for(const i of e.members)t.push(`	${i.type} ${i.name};`);return t.join(`
`)}getStructs(e){const t=[],i=this.structs[e],r=[];for(const s of i)if(s.output)for(const o of s.members)r.push(`layout( location = ${o.index} ) out ${o.type} ${o.name};`);else{let o="struct "+s.name+` {
`;o+=this.getStructMembers(s),o+=`
};
`,t.push(o)}return r.length===0&&r.push("layout( location = 0 ) out vec4 fragColor;"),`
`+r.join(`
`)+`

`+t.join(`
`)}getVaryings(e){let t="";const i=this.varyings;if(e==="vertex"||e==="compute")for(const r of i){e==="compute"&&(r.needsInterpolation=!0);const s=this.getType(r.type);if(r.needsInterpolation)if(r.interpolationType){const o=rM[r.interpolationType]||r.interpolationType,a=sM[r.interpolationSampling]||"";t+=`${o} ${a} out ${s} ${r.name};
`}else{const o=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${o}out ${s} ${r.name};
`}else t+=`${s} ${r.name};
`}else if(e==="fragment"){for(const r of i)if(r.needsInterpolation){const s=this.getType(r.type);if(r.interpolationType){const o=rM[r.interpolationType]||r.interpolationType,a=sM[r.interpolationSampling]||"";t+=`${o} ${a} in ${s} ${r.name};
`}else{const o=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${o}in ${s} ${r.name};
`}}}for(const r of this.builtins[e])t+=`${r};
`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((i,r)=>i*r,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,i=this.shaderStage){const r=this.extensions[i]||(this.extensions[i]=new Map);r.has(e)===!1&&r.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const r=this.renderer.backend.extensions;this.object.isBatchedMesh&&r.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const i=this.extensions[e];if(i!==void 0)for(const{name:r,behavior:s}of i.values())t.push(`#extension ${r} : ${s}`);return t.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=iM[e];if(t===void 0){let i;switch(t=!1,e){case"float32Filterable":i="OES_texture_float_linear";break;case"clipDistance":i="WEBGL_clip_cull_distance";break}if(i!==void 0){const r=this.renderer.backend.extensions;r.has(i)&&(r.get(i),t=!0)}iM[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let i=0;i<e.length;i++){const r=e[i],s=this.getPropertyName(r.attributeNode);s&&(t+=`${r.varyingName} = ${s};
	`)}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${oM}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${oM}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

// structs
${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let i=`// code

`;i+=this.flowCode[t];const r=this.flowNodes[t],s=r[r.length-1];for(const a of r){const l=this.getFlowData(a),u=a.name;u&&(i.length>0&&(i+=`
`),i+=`	// flow -> ${u}
	`),i+=`${l.code}
	`,a===s&&t!=="compute"&&(i+=`// result
	`,t==="vertex"?(i+="gl_Position = ",i+=`${l.result};`):t==="fragment"&&(a.outputNode.isOutputStructNode||(i+="fragColor = ",i+=`${l.result};`)))}const o=e[t];o.extensions=this.getExtensions(t),o.uniforms=this.getUniforms(t),o.attributes=this.getAttributes(t),o.varyings=this.getVaryings(t),o.vars=this.getVars(t),o.structs=this.getStructs(t),o.codes=this.getCodes(t),o.transforms=this.getTransforms(t),o.flow=i}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,i,r=null){const s=super.getUniformFromNode(e,t,i,r),o=this.getDataFromNode(e,i,this.globalCache);let a=o.uniformGPU;if(a===void 0){const l=e.groupNode,u=l.name,A=this.getBindGroupArray(u,i);if(t==="texture")a=new g_(s.name,s.node,l),A.push(a);else if(t==="cubeTexture")a=new iI(s.name,s.node,l),A.push(a);else if(t==="texture3D")a=new rI(s.name,s.node,l),A.push(a);else if(t==="buffer"){e.name=`NodeBuffer_${e.id}`,s.name=`buffer${e.id}`;const p=new tI(e,l);p.name=e.name,A.push(p),a=p}else{const p=this.uniformGroups[i]||(this.uniformGroups[i]={});let g=p[u];g===void 0&&(g=new nI(i+"_"+u,l),p[u]=g,A.push(g)),a=this.getNodeUniform(s,t),g.addUniform(a)}o.uniformGPU=a}return s}}let Lv=null,mf=null;class sI{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){Ea("WebGPURenderer: Timestamp tracking is disabled.");return}const t=this.timestampQueryPool[e];if(!t){Ea(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);return}const i=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=i,i}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return Lv=Lv||new rt,this.renderer.getDrawingBufferSize(Lv)}setScissorTest(){}getClearColor(){const e=this.renderer;return mf=mf||new d5,e.getClearColor(mf),mf.getRGB(mf),mf}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:b9(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${gp} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let Phe=0;class Lhe{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class Dhe{constructor(e){this.backend=e}createAttribute(e,t){const i=this.backend,{gl:r}=i,s=e.array,o=e.usage||r.STATIC_DRAW,a=e.isInterleavedBufferAttribute?e.data:e,l=i.get(a);let u=l.bufferGPU;u===void 0&&(u=this._createBuffer(r,t,s,o),l.bufferGPU=u,l.bufferType=t,l.version=a.version);let A;if(s instanceof Float32Array)A=r.FLOAT;else if(s instanceof Uint16Array)e.isFloat16BufferAttribute?A=r.HALF_FLOAT:A=r.UNSIGNED_SHORT;else if(s instanceof Int16Array)A=r.SHORT;else if(s instanceof Uint32Array)A=r.UNSIGNED_INT;else if(s instanceof Int32Array)A=r.INT;else if(s instanceof Int8Array)A=r.BYTE;else if(s instanceof Uint8Array)A=r.UNSIGNED_BYTE;else if(s instanceof Uint8ClampedArray)A=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+s);let p={bufferGPU:u,bufferType:t,type:A,byteLength:s.byteLength,bytesPerElement:s.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:A===r.INT||A===r.UNSIGNED_INT||e.gpuType===qr,id:Phe++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const g=this._createBuffer(r,t,s,o);p=new Lhe(p,g)}i.set(e,p)}updateAttribute(e){const t=this.backend,{gl:i}=t,r=e.array,s=e.isInterleavedBufferAttribute?e.data:e,o=t.get(s),a=o.bufferType,l=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(i.bindBuffer(a,o.bufferGPU),l.length===0)i.bufferSubData(a,0,r);else{for(let u=0,A=l.length;u<A;u++){const p=l[u];i.bufferSubData(a,p.start*r.BYTES_PER_ELEMENT,r,p.start,p.count)}s.clearUpdateRanges()}i.bindBuffer(a,null),o.version=s.version}destroyAttribute(e){const t=this.backend,{gl:i}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const r=t.get(e);i.deleteBuffer(r.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:i}=t,r=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:s}=t.get(r),o=e.array,a=o.byteLength;i.bindBuffer(i.COPY_READ_BUFFER,s);const l=i.createBuffer();i.bindBuffer(i.COPY_WRITE_BUFFER,l),i.bufferData(i.COPY_WRITE_BUFFER,a,i.STREAM_READ),i.copyBufferSubData(i.COPY_READ_BUFFER,i.COPY_WRITE_BUFFER,0,0,a),await t.utils._clientWaitAsync();const u=new e.array.constructor(o.length);return i.bindBuffer(i.COPY_WRITE_BUFFER,l),i.getBufferSubData(i.COPY_WRITE_BUFFER,0,u),i.deleteBuffer(l),i.bindBuffer(i.COPY_READ_BUFFER,null),i.bindBuffer(i.COPY_WRITE_BUFFER,null),u.buffer}_createBuffer(e,t,i,r){const s=e.createBuffer();return e.bindBuffer(t,s),e.bufferData(t,i,r),e.bindBuffer(t,null),s}}let Dv,L0;class Ihe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;Dv={[gs]:e.FUNC_ADD,[g4]:e.FUNC_SUBTRACT,[_4]:e.FUNC_REVERSE_SUBTRACT},L0={[Ul]:e.ZERO,[v4]:e.ONE,[y4]:e.SRC_COLOR,[Td]:e.SRC_ALPHA,[M4]:e.SRC_ALPHA_SATURATE,[S4]:e.DST_COLOR,[b4]:e.DST_ALPHA,[x4]:e.ONE_MINUS_SRC_COLOR,[Sd]:e.ONE_MINUS_SRC_ALPHA,[w4]:e.ONE_MINUS_DST_COLOR,[T4]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),i=e.getParameter(e.VIEWPORT);this.currentScissor=new Kt().fromArray(t),this.currentViewport=new Kt().fromArray(i),this._tempVec4=new Kt}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==u9?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===Ey?t.cullFace(t.BACK):e===c9?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:i}=this;e!==t&&(i.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,i,r,s,o,a,l){const{gl:u}=this;if(e===Do){this.currentBlendingEnabled===!0&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),e!==$f){if(e!==this.currentBlending||l!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==gs||this.currentBlendEquationAlpha!==gs)&&(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=gs,this.currentBlendEquationAlpha=gs),l)switch(e){case Gs:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case uh:u.blendFunc(u.ONE,u.ONE);break;case iA:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case rA:u.blendFuncSeparate(u.ZERO,u.SRC_COLOR,u.ZERO,u.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case Gs:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case uh:u.blendFunc(u.SRC_ALPHA,u.ONE);break;case iA:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case rA:u.blendFunc(u.ZERO,u.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=l}return}s=s||t,o=o||i,a=a||r,(t!==this.currentBlendEquation||s!==this.currentBlendEquationAlpha)&&(u.blendEquationSeparate(Dv[t],Dv[s]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=s),(i!==this.currentBlendSrc||r!==this.currentBlendDst||o!==this.currentBlendSrcAlpha||a!==this.currentBlendDstAlpha)&&(u.blendFuncSeparate(L0[i],L0[r],L0[o],L0[a]),this.currentBlendSrc=i,this.currentBlendDst=r,this.currentBlendSrcAlpha=o,this.currentBlendDstAlpha=a),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case wd:t.depthFunc(t.NEVER);break;case Md:t.depthFunc(t.ALWAYS);break;case Ed:t.depthFunc(t.LESS);break;case Ju:t.depthFunc(t.LEQUAL);break;case Cd:t.depthFunc(t.EQUAL);break;case Rd:t.depthFunc(t.GEQUAL);break;case Nd:t.depthFunc(t.GREATER);break;case Pd:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,i,r){const s=this._tempVec4.set(e,t,i,r);if(this.currentScissor.equals(s)===!1){const{gl:o}=this;o.scissor(s.x,s.y,s.z,s.w),this.currentScissor.copy(s)}}viewport(e,t,i,r){const s=this._tempVec4.set(e,t,i,r);if(this.currentViewport.equals(s)===!1){const{gl:o}=this;o.viewport(s.x,s.y,s.z,s.w),this.currentViewport.copy(s)}}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,i){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==i)&&(this.gl.stencilFunc(e,t,i),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=i)}setStencilOp(e,t,i){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==i)&&(this.gl.stencilOp(e,t,i),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=i)}setMaterial(e,t,i){const{gl:r}=this;e.side===ar?this.disable(r.CULL_FACE):this.enable(r.CULL_FACE);let s=e.side===wi;t&&(s=!s),this.setFlipSided(s),e.blending===Gs&&e.transparent===!1?this.setBlending(Do):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const o=e.stencilWrite;if(this.setStencilTest(o),o&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(r.SAMPLE_ALPHA_TO_COVERAGE):this.disable(r.SAMPLE_ALPHA_TO_COVERAGE),i>0&&this.currentClippingPlanes!==i)for(let l=0;l<8;l++)l<i?this.enable(12288+l):this.disable(12288+l)}setPolygonOffset(e,t,i){const{gl:r}=this;e?(this.enable(r.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==i)&&(r.polygonOffset(t,i),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=i)):this.disable(r.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,t=null){const i=this.gl;return this.currentVAO!==e||this.currentIndex!==t?(i.bindVertexArray(e),t!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:i,currentBoundFramebuffers:r}=this;return r[e]!==t?(i.bindFramebuffer(e,t),r[e]=t,e===i.DRAW_FRAMEBUFFER&&(r[i.FRAMEBUFFER]=t),e===i.FRAMEBUFFER&&(r[i.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:i}=this;let r=[],s=!1;if(e.textures!==null){r=this.currentDrawbuffers.get(t),r===void 0&&(r=[],this.currentDrawbuffers.set(t,r));const o=e.textures;if(r.length!==o.length||r[0]!==i.COLOR_ATTACHMENT0){for(let a=0,l=o.length;a<l;a++)r[a]=i.COLOR_ATTACHMENT0+a;r.length=o.length,s=!0}}else r[0]!==i.BACK&&(r[0]=i.BACK,s=!0);s&&i.drawBuffers(r)}activeTexture(e){const{gl:t,currentTextureSlot:i,maxTextures:r}=this;e===void 0&&(e=t.TEXTURE0+r-1),i!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,i){const{gl:r,currentTextureSlot:s,currentBoundTextures:o,maxTextures:a}=this;i===void 0&&(s===null?i=r.TEXTURE0+a-1:i=s);let l=o[i];l===void 0&&(l={type:void 0,texture:void 0},o[i]=l),(l.type!==e||l.texture!==t)&&(s!==i&&(r.activeTexture(i),this.currentTextureSlot=i),r.bindTexture(e,t),l.type=e,l.texture=t)}bindBufferBase(e,t,i){const{gl:r}=this,s=`${e}-${t}`;return this.currentBoundBufferBases[s]!==i?(r.bindBufferBase(e,t,i),this.currentBoundBufferBases[s]=i,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:i}=this,r=i[t];r!==void 0&&r.type!==void 0&&(e.bindTexture(r.type,null),r.type=void 0,r.texture=void 0)}}class Bhe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=Po){const{gl:i,extensions:r}=this;let s;if(e===Ji)return i.UNSIGNED_BYTE;if(e===C2)return i.UNSIGNED_SHORT_4_4_4_4;if(e===R2)return i.UNSIGNED_SHORT_5_5_5_1;if(e===N2)return i.UNSIGNED_INT_5_9_9_9_REV;if(e===Kc)return i.BYTE;if(e===Jc)return i.SHORT;if(e===xa)return i.UNSIGNED_SHORT;if(e===qr)return i.INT;if(e===Ni)return i.UNSIGNED_INT;if(e===mr)return i.FLOAT;if(e===Dr)return i.HALF_FLOAT;if(e===R4)return i.ALPHA;if(e===vp)return i.RGB;if(e===ur)return i.RGBA;if(e===Bo)return i.DEPTH_COMPONENT;if(e===Fo)return i.DEPTH_STENCIL;if(e===yp)return i.RED;if(e===OA)return i.RED_INTEGER;if(e===jl)return i.RG;if(e===kA)return i.RG_INTEGER;if(e===VA)return i.RGBA_INTEGER;if(e===eh||e===Wu||e===$u||e===ju)if(t===Zt)if(s=r.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(e===eh)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===Wu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===$u)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===ju)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=r.get("WEBGL_compressed_texture_s3tc"),s!==null){if(e===eh)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Wu)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===$u)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===ju)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===Ld||e===Dd||e===Id||e===Bd)if(s=r.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(e===Ld)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Dd)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Id)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Bd)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===Fd||e===sA||e===oA)if(s=r.get("WEBGL_compressed_texture_etc"),s!==null){if(e===Fd||e===sA)return t===Zt?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(e===oA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===aA||e===lA||e===uA||e===cA||e===hA||e===fA||e===AA||e===dA||e===pA||e===mA||e===gA||e===_A||e===vA||e===yA)if(s=r.get("WEBGL_compressed_texture_astc"),s!==null){if(e===aA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===lA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===uA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===cA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===hA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===fA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===AA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===dA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===pA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===mA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===gA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===_A)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===vA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===yA)return t===Zt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===th)if(s=r.get("EXT_texture_compression_bptc"),s!==null){if(e===th)return t===Zt?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===N4||e===Ud||e===Od||e===kd)if(s=r.get("EXT_texture_compression_rgtc"),s!==null){if(e===th)return s.COMPRESSED_RED_RGTC1_EXT;if(e===Ud)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===Od)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===kd)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===Io?i.UNSIGNED_INT_24_8:i[e]!==void 0?i[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((i,r)=>{function s(){const o=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(o===e.WAIT_FAILED){e.deleteSync(t),r();return}if(o===e.TIMEOUT_EXPIRED){requestAnimationFrame(s);return}e.deleteSync(t),i()}s()})}}let aM=!1,f1,Iv,lM;class Fhe{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},aM===!1&&(this._init(),aM=!0)}_init(){const e=this.gl;f1={[Ah]:e.REPEAT,[il]:e.CLAMP_TO_EDGE,[dh]:e.MIRRORED_REPEAT},Iv={[Ui]:e.NEAREST,[C4]:e.NEAREST_MIPMAP_NEAREST,[$l]:e.NEAREST_MIPMAP_LINEAR,[Lr]:e.LINEAR,[jf]:e.LINEAR_MIPMAP_NEAREST,[to]:e.LINEAR_MIPMAP_LINEAR},lM={[P4]:e.NEVER,[F4]:e.ALWAYS,[P2]:e.LESS,[L2]:e.LEQUAL,[L4]:e.EQUAL,[B4]:e.GEQUAL,[D4]:e.GREATER,[I4]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let i;return e.isCubeTexture===!0?i=t.TEXTURE_CUBE_MAP:e.isDepthArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0||e.isTextureArray===!0?i=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?i=t.TEXTURE_3D:i=t.TEXTURE_2D,i}getInternalFormat(e,t,i,r,s=!1){const{gl:o,extensions:a}=this;if(e!==null){if(o[e]!==void 0)return o[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let l=t;return t===o.RED&&(i===o.FLOAT&&(l=o.R32F),i===o.HALF_FLOAT&&(l=o.R16F),i===o.UNSIGNED_BYTE&&(l=o.R8),i===o.UNSIGNED_SHORT&&(l=o.R16),i===o.UNSIGNED_INT&&(l=o.R32UI),i===o.BYTE&&(l=o.R8I),i===o.SHORT&&(l=o.R16I),i===o.INT&&(l=o.R32I)),t===o.RED_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.R8UI),i===o.UNSIGNED_SHORT&&(l=o.R16UI),i===o.UNSIGNED_INT&&(l=o.R32UI),i===o.BYTE&&(l=o.R8I),i===o.SHORT&&(l=o.R16I),i===o.INT&&(l=o.R32I)),t===o.RG&&(i===o.FLOAT&&(l=o.RG32F),i===o.HALF_FLOAT&&(l=o.RG16F),i===o.UNSIGNED_BYTE&&(l=o.RG8),i===o.UNSIGNED_SHORT&&(l=o.RG16),i===o.UNSIGNED_INT&&(l=o.RG32UI),i===o.BYTE&&(l=o.RG8I),i===o.SHORT&&(l=o.RG16I),i===o.INT&&(l=o.RG32I)),t===o.RG_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.RG8UI),i===o.UNSIGNED_SHORT&&(l=o.RG16UI),i===o.UNSIGNED_INT&&(l=o.RG32UI),i===o.BYTE&&(l=o.RG8I),i===o.SHORT&&(l=o.RG16I),i===o.INT&&(l=o.RG32I)),t===o.RGB&&(i===o.FLOAT&&(l=o.RGB32F),i===o.HALF_FLOAT&&(l=o.RGB16F),i===o.UNSIGNED_BYTE&&(l=o.RGB8),i===o.UNSIGNED_SHORT&&(l=o.RGB16),i===o.UNSIGNED_INT&&(l=o.RGB32UI),i===o.BYTE&&(l=o.RGB8I),i===o.SHORT&&(l=o.RGB16I),i===o.INT&&(l=o.RGB32I),i===o.UNSIGNED_BYTE&&(l=r===Zt&&s===!1?o.SRGB8:o.RGB8),i===o.UNSIGNED_SHORT_5_6_5&&(l=o.RGB565),i===o.UNSIGNED_SHORT_5_5_5_1&&(l=o.RGB5_A1),i===o.UNSIGNED_SHORT_4_4_4_4&&(l=o.RGB4),i===o.UNSIGNED_INT_5_9_9_9_REV&&(l=o.RGB9_E5)),t===o.RGB_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.RGB8UI),i===o.UNSIGNED_SHORT&&(l=o.RGB16UI),i===o.UNSIGNED_INT&&(l=o.RGB32UI),i===o.BYTE&&(l=o.RGB8I),i===o.SHORT&&(l=o.RGB16I),i===o.INT&&(l=o.RGB32I)),t===o.RGBA&&(i===o.FLOAT&&(l=o.RGBA32F),i===o.HALF_FLOAT&&(l=o.RGBA16F),i===o.UNSIGNED_BYTE&&(l=o.RGBA8),i===o.UNSIGNED_SHORT&&(l=o.RGBA16),i===o.UNSIGNED_INT&&(l=o.RGBA32UI),i===o.BYTE&&(l=o.RGBA8I),i===o.SHORT&&(l=o.RGBA16I),i===o.INT&&(l=o.RGBA32I),i===o.UNSIGNED_BYTE&&(l=r===Zt&&s===!1?o.SRGB8_ALPHA8:o.RGBA8),i===o.UNSIGNED_SHORT_4_4_4_4&&(l=o.RGBA4),i===o.UNSIGNED_SHORT_5_5_5_1&&(l=o.RGB5_A1)),t===o.RGBA_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.RGBA8UI),i===o.UNSIGNED_SHORT&&(l=o.RGBA16UI),i===o.UNSIGNED_INT&&(l=o.RGBA32UI),i===o.BYTE&&(l=o.RGBA8I),i===o.SHORT&&(l=o.RGBA16I),i===o.INT&&(l=o.RGBA32I)),t===o.DEPTH_COMPONENT&&(i===o.UNSIGNED_SHORT&&(l=o.DEPTH_COMPONENT16),i===o.UNSIGNED_INT&&(l=o.DEPTH_COMPONENT24),i===o.FLOAT&&(l=o.DEPTH_COMPONENT32F)),t===o.DEPTH_STENCIL&&i===o.UNSIGNED_INT_24_8&&(l=o.DEPTH24_STENCIL8),(l===o.R16F||l===o.R32F||l===o.RG16F||l===o.RG32F||l===o.RGBA16F||l===o.RGBA32F)&&a.get("EXT_color_buffer_float"),l}setTextureParameters(e,t){const{gl:i,extensions:r,backend:s}=this;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,t.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,t.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE),i.texParameteri(e,i.TEXTURE_WRAP_S,f1[t.wrapS]),i.texParameteri(e,i.TEXTURE_WRAP_T,f1[t.wrapT]),(e===i.TEXTURE_3D||e===i.TEXTURE_2D_ARRAY)&&t.isDepthArrayTexture!==!0&&t.isTextureArray===!1&&i.texParameteri(e,i.TEXTURE_WRAP_R,f1[t.wrapR]),i.texParameteri(e,i.TEXTURE_MAG_FILTER,Iv[t.magFilter]);const o=t.mipmaps!==void 0&&t.mipmaps.length>0,a=t.minFilter===Lr&&o?to:t.minFilter;if(i.texParameteri(e,i.TEXTURE_MIN_FILTER,Iv[a]),t.compareFunction&&(i.texParameteri(e,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(e,i.TEXTURE_COMPARE_FUNC,lM[t.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===Ui||t.minFilter!==$l&&t.minFilter!==to||t.type===mr&&r.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const l=r.get("EXT_texture_filter_anisotropic");i.texParameterf(e,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,s.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:i,defaultTextures:r}=this,s=this.getGLTextureType(e);let o=r[s];o===void 0&&(o=t.createTexture(),i.state.bindTexture(s,o),t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST),r[s]=o),i.set(e,{textureGPU:o,glTextureType:s,isDefault:!0})}createTexture(e,t){const{gl:i,backend:r}=this,{levels:s,width:o,height:a,depth:l}=t,u=r.utils.convert(e.format,e.colorSpace),A=r.utils.convert(e.type),p=this.getInternalFormat(e.internalFormat,u,A,e.colorSpace,e.isVideoTexture),g=i.createTexture(),v=this.getGLTextureType(e);r.state.bindTexture(v,g),this.setTextureParameters(v,e),e.isDepthArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture||e.isTextureArray?i.texStorage3D(i.TEXTURE_2D_ARRAY,s,p,o,a,l):e.isData3DTexture?i.texStorage3D(i.TEXTURE_3D,s,p,o,a,l):e.isVideoTexture||i.texStorage2D(v,s,p,o,a),r.set(e,{textureGPU:g,glTextureType:v,glFormat:u,glType:A,glInternalFormat:p})}copyBufferToTexture(e,t){const{gl:i,backend:r}=this,{textureGPU:s,glTextureType:o,glFormat:a,glType:l}=r.get(t),{width:u,height:A}=t.source.data;i.bindBuffer(i.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(o,s),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.texSubImage2D(o,0,0,0,u,A,a,l,0),i.bindBuffer(i.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}updateTexture(e,t){const{gl:i}=this,{width:r,height:s}=t,{textureGPU:o,glTextureType:a,glFormat:l,glType:u,glInternalFormat:A}=this.backend.get(e);if(e.isRenderTargetTexture||o===void 0)return;const p=g=>g.isDataTexture?g.image.data:typeof HTMLImageElement<"u"&&g instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&g instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&g instanceof ImageBitmap||g instanceof OffscreenCanvas?g:g.data;if(this.backend.state.bindTexture(a,o),this.setTextureParameters(a,e),e.isCompressedTexture){const g=e.mipmaps,v=t.image;for(let y=0;y<g.length;y++){const b=g[y];e.isCompressedArrayTexture?e.format!==i.RGBA?l!==null?i.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,y,0,0,0,b.width,b.height,v.depth,l,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texSubImage3D(i.TEXTURE_2D_ARRAY,y,0,0,0,b.width,b.height,v.depth,l,u,b.data):l!==null?i.compressedTexSubImage2D(i.TEXTURE_2D,y,0,0,b.width,b.height,l,b.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const g=t.images;for(let v=0;v<6;v++){const y=p(g[v]);i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,0,0,r,s,l,u,y)}}else if(e.isDataArrayTexture||e.isDepthArrayTexture){const g=t.image;i.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,g.width,g.height,g.depth,l,u,g.data)}else if(e.isData3DTexture){const g=t.image;i.texSubImage3D(i.TEXTURE_3D,0,0,0,0,g.width,g.height,g.depth,l,u,g.data)}else if(e.isVideoTexture)e.update(),i.texImage2D(a,0,A,l,u,t.image);else{const g=p(t.image);i.texSubImage2D(a,0,0,0,r,s,l,u,g)}}generateMipmaps(e){const{gl:t,backend:i}=this,{textureGPU:r,glTextureType:s}=i.get(e);i.state.bindTexture(s,r),t.generateMipmap(s)}deallocateRenderBuffers(e){const{gl:t,backend:i}=this;if(e){const r=i.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(const s in r.framebuffers)t.deleteFramebuffer(r.framebuffers[s]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(let s=0;s<r.msaaRenderbuffers.length;s++)t.deleteRenderbuffer(r.msaaRenderbuffers[s]);delete r.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:i}=this,{textureGPU:r,renderTarget:s}=i.get(e);this.deallocateRenderBuffers(s),t.deleteTexture(r),i.delete(e)}copyTextureToTexture(e,t,i=null,r=null,s=0,o=0){const{gl:a,backend:l}=this,{state:u}=this.backend,{textureGPU:A,glTextureType:p,glType:g,glFormat:v}=l.get(t);u.bindTexture(p,A);let y,b,w,S,C,E,R,D,B;const L=e.isCompressedTexture?e.mipmaps[o]:e.image;if(i!==null)y=i.max.x-i.min.x,b=i.max.y-i.min.y,w=i.isBox3?i.max.z-i.min.z:1,S=i.min.x,C=i.min.y,E=i.isBox3?i.min.z:0;else{const J=Math.pow(2,-s);y=Math.floor(L.width*J),b=Math.floor(L.height*J),e.isDataArrayTexture||e.isDepthArrayTexture?w=L.depth:e.isData3DTexture?w=Math.floor(L.depth*J):w=1,S=0,C=0,E=0}r!==null?(R=r.x,D=r.y,B=r.z):(R=0,D=0,B=0),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,t.unpackAlignment);const U=a.getParameter(a.UNPACK_ROW_LENGTH),P=a.getParameter(a.UNPACK_IMAGE_HEIGHT),F=a.getParameter(a.UNPACK_SKIP_PIXELS),V=a.getParameter(a.UNPACK_SKIP_ROWS),H=a.getParameter(a.UNPACK_SKIP_IMAGES);a.pixelStorei(a.UNPACK_ROW_LENGTH,L.width),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,L.height),a.pixelStorei(a.UNPACK_SKIP_PIXELS,S),a.pixelStorei(a.UNPACK_SKIP_ROWS,C),a.pixelStorei(a.UNPACK_SKIP_IMAGES,E);const j=t.isDataArrayTexture||t.isData3DTexture||t.isDepthArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const J=l.get(e),Z=l.get(t),W=l.get(J.renderTarget),K=l.get(Z.renderTarget),ee=W.framebuffers[J.cacheKey],se=K.framebuffers[Z.cacheKey];u.bindFramebuffer(a.READ_FRAMEBUFFER,ee),u.bindFramebuffer(a.DRAW_FRAMEBUFFER,se);let ge=a.COLOR_BUFFER_BIT;e.isDepthTexture&&(ge=a.DEPTH_BUFFER_BIT),a.blitFramebuffer(S,C,y,b,R,D,y,b,ge,a.NEAREST),u.bindFramebuffer(a.READ_FRAMEBUFFER,null),u.bindFramebuffer(a.DRAW_FRAMEBUFFER,null)}else j?e.isDataTexture||e.isData3DTexture?a.texSubImage3D(p,o,R,D,B,y,b,w,v,g,L.data):t.isCompressedArrayTexture?a.compressedTexSubImage3D(p,o,R,D,B,y,b,w,v,L.data):a.texSubImage3D(p,o,R,D,B,y,b,w,v,g,L):e.isDataTexture?a.texSubImage2D(p,o,R,D,y,b,v,g,L.data):e.isCompressedTexture?a.compressedTexSubImage2D(p,o,R,D,L.width,L.height,v,L.data):a.texSubImage2D(p,o,R,D,y,b,v,g,L);a.pixelStorei(a.UNPACK_ROW_LENGTH,U),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,P),a.pixelStorei(a.UNPACK_SKIP_PIXELS,F),a.pixelStorei(a.UNPACK_SKIP_ROWS,V),a.pixelStorei(a.UNPACK_SKIP_IMAGES,H),o===0&&t.generateMipmaps&&a.generateMipmap(p),u.unbindTexture()}copyFramebufferToTexture(e,t,i){const{gl:r}=this,{state:s}=this.backend,{textureGPU:o}=this.backend.get(e),{x:a,y:l,z:u,w:A}=i,p=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,g=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(p){const v=a!==0||l!==0;let y,b;if(e.isDepthTexture===!0?(y=r.DEPTH_BUFFER_BIT,b=r.DEPTH_ATTACHMENT,t.stencil&&(y|=r.STENCIL_BUFFER_BIT)):(y=r.COLOR_BUFFER_BIT,b=r.COLOR_ATTACHMENT0),v){const w=this.backend.get(t.renderTarget),S=w.framebuffers[t.getCacheKey()],C=w.msaaFrameBuffer;s.bindFramebuffer(r.DRAW_FRAMEBUFFER,S),s.bindFramebuffer(r.READ_FRAMEBUFFER,C);const E=g-l-A;r.blitFramebuffer(a,E,a+u,E+A,a,E,a+u,E+A,y,r.NEAREST),s.bindFramebuffer(r.READ_FRAMEBUFFER,S),s.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,a,E,u,A),s.unbindTexture()}else{const w=r.createFramebuffer();s.bindFramebuffer(r.DRAW_FRAMEBUFFER,w),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,b,r.TEXTURE_2D,o,0),r.blitFramebuffer(0,0,u,A,0,0,u,A,y,r.NEAREST),r.deleteFramebuffer(w)}}else s.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,a,g-A-l,u,A),s.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,i,r=!1){const{gl:s}=this,o=t.renderTarget,{depthTexture:a,depthBuffer:l,stencilBuffer:u,width:A,height:p}=o;if(s.bindRenderbuffer(s.RENDERBUFFER,e),l&&!u){let g=s.DEPTH_COMPONENT24;r===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(s.RENDERBUFFER,o.samples,g,A,p):i>0?(a&&a.isDepthTexture&&a.type===s.FLOAT&&(g=s.DEPTH_COMPONENT32F),s.renderbufferStorageMultisample(s.RENDERBUFFER,i,g,A,p)):s.renderbufferStorage(s.RENDERBUFFER,g,A,p),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e)}else l&&u&&(i>0?s.renderbufferStorageMultisample(s.RENDERBUFFER,i,s.DEPTH24_STENCIL8,A,p):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,A,p),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e))}async copyTextureToBuffer(e,t,i,r,s,o){const{backend:a,gl:l}=this,{textureGPU:u,glFormat:A,glType:p}=this.backend.get(e),g=l.createFramebuffer();l.bindFramebuffer(l.READ_FRAMEBUFFER,g);const v=e.isCubeTexture?l.TEXTURE_CUBE_MAP_POSITIVE_X+o:l.TEXTURE_2D;l.framebufferTexture2D(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,v,u,0);const y=this._getTypedArrayType(p),b=this._getBytesPerTexel(p,A),S=r*s*b,C=l.createBuffer();l.bindBuffer(l.PIXEL_PACK_BUFFER,C),l.bufferData(l.PIXEL_PACK_BUFFER,S,l.STREAM_READ),l.readPixels(t,i,r,s,A,p,0),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),await a.utils._clientWaitAsync();const E=new y(S/y.BYTES_PER_ELEMENT);return l.bindBuffer(l.PIXEL_PACK_BUFFER,C),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,E),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),l.deleteFramebuffer(g),E}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:i}=this;let r=0;if(e===i.UNSIGNED_BYTE&&(r=1),(e===i.UNSIGNED_SHORT_4_4_4_4||e===i.UNSIGNED_SHORT_5_5_5_1||e===i.UNSIGNED_SHORT_5_6_5||e===i.UNSIGNED_SHORT||e===i.HALF_FLOAT)&&(r=2),(e===i.UNSIGNED_INT||e===i.FLOAT)&&(r=4),t===i.RGBA)return r*4;if(t===i.RGB)return r*3;if(t===i.ALPHA)return r}}class Uhe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class Ohe{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const i=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const uM={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class khe{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:i,mode:r,object:s,type:o,info:a,index:l}=this;l!==0?i.drawElements(r,t,o,e):i.drawArrays(r,e,t),a.update(s,t,1)}renderInstances(e,t,i){const{gl:r,mode:s,type:o,index:a,object:l,info:u}=this;i!==0&&(a!==0?r.drawElementsInstanced(s,t,o,e,i):r.drawArraysInstanced(s,e,t,i),u.update(l,t,i))}renderMultiDraw(e,t,i){const{extensions:r,mode:s,object:o,info:a}=this;if(i===0)return;const l=r.get("WEBGL_multi_draw");if(l===null)for(let u=0;u<i;u++)this.render(e[u],t[u]);else{this.index!==0?l.multiDrawElementsWEBGL(s,t,0,this.type,e,0,i):l.multiDrawArraysWEBGL(s,e,0,t,0,i);let u=0;for(let A=0;A<i;A++)u+=t[A];a.update(o,u,1)}}renderMultiDrawInstances(e,t,i,r){const{extensions:s,mode:o,object:a,info:l}=this;if(i===0)return;const u=s.get("WEBGL_multi_draw");if(u===null)for(let A=0;A<i;A++)this.renderInstances(e[A],t[A],r[A]);else{this.index!==0?u.multiDrawElementsInstancedWEBGL(o,t,0,this.type,e,0,r,0,i):u.multiDrawArraysInstancedWEBGL(o,e,0,t,0,r,0,i);let A=0;for(let p=0;p<i;p++)A+=t[p]*r[p];l.update(a,A,1)}}}class oI{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class Vhe extends oI{constructor(e,t,i=2048){if(super(i),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let r=0;r<this.maxQueries;r++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return Ea(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e.id,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t==null||this.activeQuery!==null)return;const i=this.queries[t];if(i)try{this.queryStates.get(t)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,i),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(r){console.error("Error in beginQuery:",r),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e.id);if(t!=null&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(i){console.error("Error in endQuery:",i),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[r,s]of this.queryStates)if(s==="ended"){const o=this.queries[r];e.push(this.resolveQuery(o))}if(e.length===0)return this.lastValue;const i=(await Promise.all(e)).reduce((r,s)=>r+s,0);return this.lastValue=i,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,i}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed){t(this.lastValue);return}let i,r=!1;const s=()=>{i&&(clearTimeout(i),i=null)},o=l=>{r||(r=!0,s(),t(l))},a=()=>{if(this.isDisposed){o(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){o(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){i=setTimeout(a,1);return}const A=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(A)/1e6)}catch(l){console.error("Error checking query:",l),t(this.lastValue)}};a()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class cM extends sI{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,i={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},r=t.context!==void 0?t.context:e.domElement.getContext("webgl2",i);function s(o){o.preventDefault();const a={api:"WebGL",message:o.statusMessage||"Unknown reason",reason:null,originalEvent:o};e.onDeviceLost(a)}this._onContextLost=s,e.domElement.addEventListener("webglcontextlost",s,!1),this.gl=r,this.extensions=new Uhe(this),this.capabilities=new Ohe(this),this.attributeUtils=new Dhe(this),this.textureUtils=new Fhe(this),this.bufferRenderer=new khe(this),this.state=new Ihe(this),this.utils=new Bhe(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return zs}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,i=null){const r=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:r.RGBA8}),i!==null){const s=e.stencilBuffer?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:i,glInternalFormat:s}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer===!0&&e.multiview===!1&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e.autoAllocateDepthBuffer=!1}}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t]||(this.timestampQueryPool[t]=new Vhe(this.gl,t,2048));const i=this.timestampQueryPool[t];i.allocateQueriesForContext(e)!==null&&i.beginQuery(e)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t].endQuery(e)}getContext(){return this.gl}beginRender(e){const{state:t,gl:i}=this,r=this.get(e);if(e.viewport?this.updateViewport(e):t.viewport(0,0,i.drawingBufferWidth,i.drawingBufferHeight),e.scissor){const{x:o,y:a,width:l,height:u}=e.scissorValue;t.scissor(o,e.height-u-a,l,u)}this.initTimestampQuery(e),r.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const s=e.occlusionQueryCount;s>0&&(r.currentOcclusionQueries=r.occlusionQueries,r.currentOcclusionQueryObjects=r.occlusionQueryObjects,r.lastOcclusionObject=null,r.occlusionQueries=new Array(s),r.occlusionQueryObjects=new Array(s),r.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:i}=this,r=this.get(e),s=r.previousContext;i.resetVertexState();const o=e.occlusionQueryCount;o>0&&(o>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const a=e.textures;if(a!==null)for(let l=0;l<a.length;l++){const u=a[l];u.generateMipmaps&&this.generateMipmaps(u)}if(this._currentContext=s,e.textures!==null&&e.renderTarget){const l=this.get(e.renderTarget),{samples:u}=e.renderTarget;if(u>0&&this._useMultisampledExtension(e.renderTarget)===!1){const A=l.framebuffers[e.getCacheKey()],p=t.COLOR_BUFFER_BIT,g=l.msaaFrameBuffer,v=e.textures;i.bindFramebuffer(t.READ_FRAMEBUFFER,g),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,A);for(let y=0;y<v.length;y++)if(e.scissor){const{x:b,y:w,width:S,height:C}=e.scissorValue,E=e.height-C-w;t.blitFramebuffer(b,E,b+S,E+C,b,E,b+S,E+C,p,t.NEAREST),this._supportsInvalidateFramebuffer===!0&&t.invalidateSubFramebuffer(t.READ_FRAMEBUFFER,l.invalidationArray,b,E,S,C)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,p,t.NEAREST),this._supportsInvalidateFramebuffer===!0&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,l.invalidationArray)}}s!==null&&(this._setFramebuffer(s),s.viewport?this.updateViewport(s):i.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)),this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:i,currentOcclusionQueryObjects:r}=t;if(i&&r){const s=new WeakSet,{gl:o}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const a=()=>{let l=0;for(let u=0;u<i.length;u++){const A=i[u];A!==null&&o.getQueryParameter(A,o.QUERY_RESULT_AVAILABLE)&&(o.getQueryParameter(A,o.QUERY_RESULT)===0&&s.add(r[u]),i[u]=null,o.deleteQuery(A),l++)}l<i.length?requestAnimationFrame(a):t.occluded=s};a()}}isOccluded(e,t){const i=this.get(e);return i.occluded&&i.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:i,y:r,width:s,height:o}=e.viewportValue;t.viewport(i,e.height-o-r,s,o)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,i,r=null,s=!0){const{gl:o,renderer:a}=this;r===null&&(r={textures:null,clearColorValue:this.getClearColor()});let l=0;if(e&&(l|=o.COLOR_BUFFER_BIT),t&&(l|=o.DEPTH_BUFFER_BIT),i&&(l|=o.STENCIL_BUFFER_BIT),l!==0){let u;r.clearColorValue?u=r.clearColorValue:u=this.getClearColor();const A=a.getClearDepth(),p=a.getClearStencil();if(t&&this.state.setDepthMask(!0),r.textures===null)o.clearColor(u.r,u.g,u.b,u.a),o.clear(l);else{if(s&&this._setFramebuffer(r),e)for(let g=0;g<r.textures.length;g++)g===0?o.clearBufferfv(o.COLOR,g,[u.r,u.g,u.b,u.a]):o.clearBufferfv(o.COLOR,g,[0,0,0,1]);t&&i?o.clearBufferfi(o.DEPTH_STENCIL,0,A,p):t?o.clearBufferfv(o.DEPTH,0,[A]):i&&o.clearBufferiv(o.STENCIL,0,[p])}}}beginCompute(e){const{state:t,gl:i}=this;t.bindFramebuffer(i.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,t,i,r){const{state:s,gl:o}=this;this.discard===!1&&(o.enable(o.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:a,transformBuffers:l,attributes:u}=this.get(r),A=this._getVaoKey(u),p=this.vaoCache[A];p===void 0?this._createVao(u):s.setVertexState(p),s.useProgram(a),this._bindUniforms(i);const g=this._getTransformFeedback(l);o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,g),o.beginTransformFeedback(o.POINTS),u[0].isStorageInstancedBufferAttribute?o.drawArraysInstanced(o.POINTS,0,1,t.count):o.drawArrays(o.POINTS,0,t.count),o.endTransformFeedback(),o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,null);for(let v=0;v<l.length;v++){const y=l[v];y.pbo&&this.textureUtils.copyBufferToTexture(y.transformBuffer,y.pbo),y.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isDepthArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:i,material:r,context:s,hardwareClippingPlanes:o}=e,{programGPU:a}=this.get(i),{gl:l,state:u}=this,A=this.get(s),p=e.getDrawParameters();if(p===null)return;this._bindUniforms(e.getBindings());const g=t.isMesh&&t.matrixWorld.determinant()<0;u.setMaterial(r,g,o),u.useProgram(a);const v=this.get(e);let y=v.staticVao;if(y===void 0||v.geometryId!==e.geometry.id){const L=this._getVaoKey(e.getAttributes());if(y=this.vaoCache[L],y===void 0){let U;({vaoGPU:y,staticVao:U}=this._createVao(e.getAttributes())),U&&(v.staticVao=y,v.geometryId=e.geometry.id)}}const b=e.getIndex(),w=b!==null?this.get(b).bufferGPU:null;u.setVertexState(y,w);const S=A.lastOcclusionObject;if(S!==t&&S!==void 0){if(S!==null&&S.occlusionTest===!0&&(l.endQuery(l.ANY_SAMPLES_PASSED),A.occlusionQueryIndex++),t.occlusionTest===!0){const L=l.createQuery();l.beginQuery(l.ANY_SAMPLES_PASSED,L),A.occlusionQueries[A.occlusionQueryIndex]=L,A.occlusionQueryObjects[A.occlusionQueryIndex]=t}A.lastOcclusionObject=t}const C=this.bufferRenderer;t.isPoints?C.mode=l.POINTS:t.isLineSegments?C.mode=l.LINES:t.isLine?C.mode=l.LINE_STRIP:t.isLineLoop?C.mode=l.LINE_LOOP:r.wireframe===!0?(u.setLineWidth(r.wireframeLinewidth*this.renderer.getPixelRatio()),C.mode=l.LINES):C.mode=l.TRIANGLES;const{vertexCount:E,instanceCount:R}=p;let{firstVertex:D}=p;if(C.object=t,b!==null){D*=b.array.BYTES_PER_ELEMENT;const L=this.get(b);C.index=b.count,C.type=L.type}else C.index=0;const B=()=>{t.isBatchedMesh?t._multiDrawInstances!==null?(Ea("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),C.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?C.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):Ea("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):R>1?C.renderInstances(D,E,R):C.render(D,E)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const L=this.get(e.camera),U=e.camera.cameras,P=e.getBindingGroup("cameraIndex").bindings[0];if(L.indexesGPU===void 0||L.indexesGPU.length!==U.length){const Z=new Uint32Array([0,0,0,0]),W=[];for(let K=0,ee=U.length;K<ee;K++){const se=l.createBuffer();Z[0]=K,l.bindBuffer(l.UNIFORM_BUFFER,se),l.bufferData(l.UNIFORM_BUFFER,Z,l.STATIC_DRAW),W.push(se)}L.indexesGPU=W}const F=this.get(P),V=this.renderer.getPixelRatio(),H=this._currentContext.renderTarget,j=this._isRenderCameraDepthArray(this._currentContext),J=this._currentContext.activeCubeFace;if(j){const Z=this.get(H.depthTexture);if(Z.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){Z.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:W}=H;for(let K=0,ee=U.length;K<ee;K++)this.renderer._activeCubeFace=K,this._currentContext.activeCubeFace=K,this._setFramebuffer(this._currentContext),this.clear(!1,!0,W,this._currentContext,!1);this.renderer._activeCubeFace=J,this._currentContext.activeCubeFace=J}}for(let Z=0,W=U.length;Z<W;Z++){const K=U[Z];if(t.layers.test(K.layers)){j&&(this.renderer._activeCubeFace=Z,this._currentContext.activeCubeFace=Z,this._setFramebuffer(this._currentContext));const ee=K.viewport;if(ee!==void 0){const se=ee.x*V,ge=ee.y*V,de=ee.width*V,Ae=ee.height*V;u.viewport(Math.floor(se),Math.floor(e.context.height-Ae-ge),Math.floor(de),Math.floor(Ae))}u.bindBufferBase(l.UNIFORM_BUFFER,F.index,L.indexesGPU[Z]),B()}this._currentContext.activeCubeFace=J,this.renderer._activeCubeFace=J}}else B()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,i,r,s,o){return this.textureUtils.copyTextureToBuffer(e,t,i,r,s,o)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new Nhe(e,t)}createProgram(e){const t=this.gl,{stage:i,code:r}=e,s=i==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(s,r),t.compileShader(s),this.set(e,{shaderGPU:s})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const i=this.gl,r=e.pipeline,{fragmentProgram:s,vertexProgram:o}=r,a=i.createProgram(),l=this.get(s).shaderGPU,u=this.get(o).shaderGPU;if(i.attachShader(a,l),i.attachShader(a,u),i.linkProgram(a),this.set(r,{programGPU:a,fragmentShader:l,vertexShader:u}),t!==null&&this.parallel){const A=new Promise(p=>{const g=this.parallel,v=()=>{i.getProgramParameter(a,g.COMPLETION_STATUS_KHR)?(this._completeCompile(e,r),p()):requestAnimationFrame(v)};v()});t.push(A);return}this._completeCompile(e,r)}_handleSource(e,t){const i=e.split(`
`),r=[],s=Math.max(t-6,0),o=Math.min(t+6,i.length);for(let a=s;a<o;a++){const l=a+1;r.push(`${l===t?">":" "} ${l}: ${i[a]}`)}return r.join(`
`)}_getShaderErrors(e,t,i){const r=e.getShaderParameter(t,e.COMPILE_STATUS),s=e.getShaderInfoLog(t).trim();if(r&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const a=parseInt(o[1]);return i.toUpperCase()+`

`+s+`

`+this._handleSource(e.getShaderSource(t),a)}else return s}_logProgramError(e,t,i){if(this.renderer.debug.checkShaderErrors){const r=this.gl,s=r.getProgramInfoLog(e).trim();if(r.getProgramParameter(e,r.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(r,e,i,t);else{const o=this._getShaderErrors(r,i,"vertex"),a=this._getShaderErrors(r,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+`

Program Info Log: `+s+`
`+o+`
`+a)}else s!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",s)}}_completeCompile(e,t){const{state:i,gl:r}=this,s=this.get(t),{programGPU:o,fragmentShader:a,vertexShader:l}=s;r.getProgramParameter(o,r.LINK_STATUS)===!1&&this._logProgramError(o,a,l),i.useProgram(o);const u=e.getBindings();this._setupBindings(u,o),this.set(t,{programGPU:o})}createComputePipeline(e,t){const{state:i,gl:r}=this,s={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(s);const{computeProgram:o}=e,a=r.createProgram(),l=this.get(s).shaderGPU,u=this.get(o).shaderGPU,A=o.transforms,p=[],g=[];for(let w=0;w<A.length;w++){const S=A[w];p.push(S.varyingName),g.push(S.attributeNode)}r.attachShader(a,l),r.attachShader(a,u),r.transformFeedbackVaryings(a,p,r.SEPARATE_ATTRIBS),r.linkProgram(a),r.getProgramParameter(a,r.LINK_STATUS)===!1&&this._logProgramError(a,l,u),i.useProgram(a),this._setupBindings(t,a);const v=o.attributes,y=[],b=[];for(let w=0;w<v.length;w++){const S=v[w].node.attribute;y.push(S),this.has(S)||this.attributeUtils.createAttribute(S,r.ARRAY_BUFFER)}for(let w=0;w<g.length;w++){const S=g[w].attribute;this.has(S)||this.attributeUtils.createAttribute(S,r.ARRAY_BUFFER);const C=this.get(S);b.push(C)}this.set(e,{programGPU:a,transformBuffers:b,attributes:y})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let i=0,r=0;for(const s of t){this.set(s,{textures:r,uniformBuffers:i});for(const o of s.bindings)o.isUniformBuffer&&i++,o.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,i=this.get(e);let r=i.uniformBuffers,s=i.textures;for(const o of e.bindings)if(o.isUniformsGroup||o.isUniformBuffer){const a=o.buffer,l=t.createBuffer();t.bindBuffer(t.UNIFORM_BUFFER,l),t.bufferData(t.UNIFORM_BUFFER,a,t.DYNAMIC_DRAW),this.set(o,{index:r++,bufferGPU:l})}else if(o.isSampledTexture){const{textureGPU:a,glTextureType:l}=this.get(o.texture);this.set(o,{index:s++,textureGPU:a,glTextureType:l})}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,s=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,s,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(uM).filter(r=>uM[r]===e),i=this.extensions;for(let r=0;r<t.length;r++)if(i.has(t[r]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,i=null,r=null,s=0,o=0){this.textureUtils.copyTextureToTexture(e,t,i,r,s,o)}copyFramebufferToTexture(e,t,i){this.textureUtils.copyFramebufferToTexture(e,t,i)}_setFramebuffer(e){const{gl:t,state:i}=this;let r=null;if(e.textures!==null){const s=e.renderTarget,o=this.get(s),{samples:a,depthBuffer:l,stencilBuffer:u}=s,A=s.isWebGLCubeRenderTarget===!0,p=s.isRenderTarget3D===!0,g=s.isRenderTargetArray===!0,v=s.isXRRenderTarget===!0,y=v===!0&&s.hasExternalTextures===!0;let b=o.msaaFrameBuffer,w=o.depthRenderbuffer;const S=this.extensions.get("WEBGL_multisampled_render_to_texture"),C=this.extensions.get("OVR_multiview2"),E=this._useMultisampledExtension(s),R=QL(e);let D;if(A?(o.cubeFramebuffers||(o.cubeFramebuffers={}),D=o.cubeFramebuffers[R]):v&&y===!1?D=this._xrFramebuffer:(o.framebuffers||(o.framebuffers={}),D=o.framebuffers[R]),D===void 0){D=t.createFramebuffer(),i.bindFramebuffer(t.FRAMEBUFFER,D);const B=e.textures;if(A){o.cubeFramebuffers[R]=D;const{textureGPU:L}=this.get(B[0]),U=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+U,L,0)}else{o.framebuffers[R]=D;for(let L=0;L<B.length;L++){const U=B[L],P=this.get(U);P.renderTarget=e.renderTarget,P.cacheKey=R;const F=t.COLOR_ATTACHMENT0+L;if(p||g){const V=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,F,P.textureGPU,0,V)}else s.multiview?C.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,F,P.textureGPU,0,a,0,2):y&&E?S.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,F,t.TEXTURE_2D,P.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,F,t.TEXTURE_2D,P.textureGPU,0)}i.drawBuffers(e,D)}if(s.isXRRenderTarget&&s.autoAllocateDepthBuffer===!0){const L=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(L,e,0,E),o.xrDepthRenderbuffer=L}else if(e.depthTexture!==null){const L=this.get(e.depthTexture),U=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(L.renderTarget=e.renderTarget,L.cacheKey=R,s.multiview)C.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,U,L.textureGPU,0,a,0,2);else if(y&&E)S.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,U,t.TEXTURE_2D,L.textureGPU,0,a);else if(e.depthTexture.isDepthArrayTexture){const P=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,U,L.textureGPU,0,P)}else t.framebufferTexture2D(t.FRAMEBUFFER,U,t.TEXTURE_2D,L.textureGPU,0)}}else{if(this._isRenderCameraDepthArray(e)){i.bindFramebuffer(t.FRAMEBUFFER,D);const L=this.renderer._activeCubeFace,U=this.get(e.depthTexture),P=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,P,U.textureGPU,0,L)}if(v&&y||s.multiview){i.bindFramebuffer(t.FRAMEBUFFER,D);const L=this.get(e.textures[0]);s.multiview?C.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,L.textureGPU,0,a,0,2):E?S.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,L.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,L.textureGPU,0);const U=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s.autoAllocateDepthBuffer===!0){const P=o.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,P),t.framebufferRenderbuffer(t.FRAMEBUFFER,U,t.RENDERBUFFER,P)}else{const P=this.get(e.depthTexture);s.multiview?C.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,U,P.textureGPU,0,a,0,2):E?S.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,U,t.TEXTURE_2D,P.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,U,t.TEXTURE_2D,P.textureGPU,0)}}}if(a>0&&E===!1&&!s.multiview){if(b===void 0){const B=[];b=t.createFramebuffer(),i.bindFramebuffer(t.FRAMEBUFFER,b);const L=[],U=e.textures;for(let P=0;P<U.length;P++){if(L[P]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,L[P]),B.push(t.COLOR_ATTACHMENT0+P),l){const H=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;B.push(H)}const F=e.textures[P],V=this.get(F);t.renderbufferStorageMultisample(t.RENDERBUFFER,a,V.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+P,t.RENDERBUFFER,L[P])}if(o.msaaFrameBuffer=b,o.msaaRenderbuffers=L,w===void 0){w=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(w,e,a),o.depthRenderbuffer=w;const P=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;B.push(P)}o.invalidationArray=B}r=o.msaaFrameBuffer}else r=D}i.bindFramebuffer(t.FRAMEBUFFER,r)}_getVaoKey(e){let t="";for(let i=0;i<e.length;i++){const r=this.get(e[i]);t+=":"+r.id}return t}_createVao(e){const{gl:t}=this,i=t.createVertexArray();let r="",s=!0;t.bindVertexArray(i);for(let o=0;o<e.length;o++){const a=e[o],l=this.get(a);r+=":"+l.id,t.bindBuffer(t.ARRAY_BUFFER,l.bufferGPU),t.enableVertexAttribArray(o),(a.isStorageBufferAttribute||a.isStorageInstancedBufferAttribute)&&(s=!1);let u,A;a.isInterleavedBufferAttribute===!0?(u=a.data.stride*l.bytesPerElement,A=a.offset*l.bytesPerElement):(u=0,A=0),l.isInteger?t.vertexAttribIPointer(o,a.itemSize,l.type,u,A):t.vertexAttribPointer(o,a.itemSize,l.type,a.normalized,u,A),a.isInstancedBufferAttribute&&!a.isInterleavedBufferAttribute?t.vertexAttribDivisor(o,a.meshPerAttribute):a.isInterleavedBufferAttribute&&a.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(o,a.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),this.vaoCache[r]=i,{vaoGPU:i,staticVao:s}}_getTransformFeedback(e){let t="";for(let s=0;s<e.length;s++)t+=":"+e[s].id;let i=this.transformFeedbackCache[t];if(i!==void 0)return i;const{gl:r}=this;i=r.createTransformFeedback(),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i);for(let s=0;s<e.length;s++){const o=e[s];r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,s,o.transformBuffer)}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=i,i}_setupBindings(e,t){const i=this.gl;for(const r of e)for(const s of r.bindings){const a=this.get(s).index;if(s.isUniformsGroup||s.isUniformBuffer){const l=i.getUniformBlockIndex(t,s.name);i.uniformBlockBinding(t,l,a)}else if(s.isSampledTexture){const l=i.getUniformLocation(t,s.name);i.uniform1i(l,a)}}}_bindUniforms(e){const{gl:t,state:i}=this;for(const r of e)for(const s of r.bindings){const o=this.get(s),a=o.index;s.isUniformsGroup||s.isUniformBuffer?i.bindBufferBase(t.UNIFORM_BUFFER,a,o.bufferGPU):s.isSampledTexture&&i.bindTexture(o.glTextureType,o.textureGPU,t.TEXTURE0+a)}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer!==!1}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const Of={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},Zr={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},Ps={Store:"store"},oi={Load:"load",Clear:"clear"},Bv={CCW:"ccw"},Fv={None:"none",Front:"front",Back:"back"},IA={Uint16:"uint16",Uint32:"uint32"},we={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},Uv={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},Hc={Linear:"linear",Nearest:"nearest"},En={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDstColor:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},Dc={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},hM={None:0,All:15},Nu={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},Ov={Storage:"storage",ReadOnlyStorage:"read-only-storage"},kv={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},fM={NonFiltering:"non-filtering",Comparison:"comparison"},Ic={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},AM={TwoD:"2d",ThreeD:"3d"},zr={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},zhe={All:"all"},A1={Vertex:"vertex",Instance:"instance"},Gx={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"};class qhe extends L5{constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.isSampler=!0}}class Ghe extends qhe{constructor(e,t,i){super(e,t?t.value:null),this.textureNode=t,this.groupNode=i}update(){this.texture=this.textureNode.value}}class Hhe extends JD{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let Whe=0;class $he extends Hhe{constructor(e,t){super("StorageBuffer_"+Whe++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:ys.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class jhe extends lc{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,i=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,r=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:Hc.Linear}),this.flipYSampler=e.createSampler({minFilter:Hc.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:t}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:i}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:r})}getTransferPipeline(e){let t=this.transferPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Of.TriangleStrip,stripIndexFormat:IA.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Of.TriangleStrip,stripIndexFormat:IA.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,i=0){const r=t.format,{width:s,height:o}=t.size,a=this.getTransferPipeline(r),l=this.getFlipYPipeline(r),u=this.device.createTexture({size:{width:s,height:o,depthOrArrayLayers:1},format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),A=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:zr.TwoD,baseArrayLayer:i}),p=u.createView({baseMipLevel:0,mipLevelCount:1,dimension:zr.TwoD,baseArrayLayer:0}),g=this.device.createCommandEncoder({}),v=(y,b,w)=>{const S=y.getBindGroupLayout(0),C=this.device.createBindGroup({layout:S,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:b}]}),E=g.beginRenderPass({colorAttachments:[{view:w,loadOp:oi.Clear,storeOp:Ps.Store,clearValue:[0,0,0,0]}]});E.setPipeline(y),E.setBindGroup(0,C),E.draw(4,1,0,0),E.end()};v(a,A,p),v(l,p,A),this.device.queue.submit([g.finish()]),u.destroy()}generateMipmaps(e,t,i=0){const r=this.get(e);r.useCount===void 0&&(r.useCount=0,r.layers=[]);const s=r.layers[i]||this._mipmapCreateBundles(e,t,i),o=this.device.createCommandEncoder({});this._mipmapRunBundles(o,s),this.device.queue.submit([o.finish()]),r.useCount!==0&&(r.layers[i]=s),r.useCount++}_mipmapCreateBundles(e,t,i){const r=this.getTransferPipeline(t.format),s=r.getBindGroupLayout(0);let o=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:zr.TwoD,baseArrayLayer:i});const a=[];for(let l=1;l<t.mipLevelCount;l++){const u=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:o}]}),A=e.createView({baseMipLevel:l,mipLevelCount:1,dimension:zr.TwoD,baseArrayLayer:i}),p={colorAttachments:[{view:A,loadOp:oi.Clear,storeOp:Ps.Store,clearValue:[0,0,0,0]}]},g=this.device.createRenderBundleEncoder({colorFormats:[t.format]});g.setPipeline(r),g.setBindGroup(0,u),g.draw(4,1,0,0),a.push({renderBundles:[g.finish()],passDescriptor:p}),o=A}return a}_mipmapRunBundles(e,t){const i=t.length;for(let r=0;r<i;r++){const s=t[r],o=e.beginRenderPass(s.passDescriptor);o.executeBundles(s.renderBundles),o.end()}}}const Xhe={[P4]:"never",[P2]:"less",[L4]:"equal",[L2]:"less-equal",[D4]:"greater",[B4]:"greater-equal",[F4]:"always",[I4]:"not-equal"},Qhe=[0,1,3,2,4,5];class Yhe{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new lo,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,i=t.device,r=t.get(e),s={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};s.magFilter===Hc.Linear&&s.minFilter===Hc.Linear&&s.mipmapFilter===Hc.Linear&&(s.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(s.compare=Xhe[e.compareFunction]),r.sampler=i.createSampler(s)}createDefaultTexture(e){let t;const i=Hx(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(i):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():t=this._getDefaultTextureGPU(i),this.backend.get(e).texture=t}createTexture(e,t={}){const i=this.backend,r=i.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:s,height:o,depth:a,levels:l}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const u=this._getDimension(e),A=e.internalFormat||t.format||Hx(e,i.device);r.format=A;const{samples:p,primarySamples:g,isMSAA:v}=i.utils.getTextureSampleData(e);let y=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(y|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&(y|=GPUTextureUsage.RENDER_ATTACHMENT);const b={label:e.name,size:{width:s,height:o,depthOrArrayLayers:a},mipLevelCount:l,sampleCount:g,dimension:u,format:A,usage:y};if(e.isVideoTexture){const w=e.source.data,S=new VideoFrame(w);b.size.width=S.displayWidth,b.size.height=S.displayHeight,S.close(),r.externalTexture=w}else{if(A===void 0){console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}e.isCubeTexture&&(b.textureBindingViewDimension=zr.Cube),r.texture=i.device.createTexture(b)}if(v){const w=Object.assign({},b);w.label=w.label+"-msaa",w.sampleCount=p,r.msaaTexture=i.device.createTexture(w)}r.initialized=!0,r.textureDescriptorGPU=b}destroyTexture(e){const t=this.backend,i=t.get(e);i.texture!==void 0&&i.texture.destroy(),i.msaaTexture!==void 0&&i.msaaTexture.destroy(),t.delete(e)}destroySampler(e){const i=this.backend.get(e);delete i.sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let i=0;i<6;i++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,i);else{const i=e.image.depth||1;for(let r=0;r<i;r++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,r)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:i}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:i,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const i=this.backend,{width:r,height:s}=i.getDrawingBufferSize(),o=this.depthTexture,a=i.get(o).texture;let l,u;if(t?(l=Fo,u=Io):e&&(l=Bo,u=Ni),a!==void 0){if(o.image.width===r&&o.image.height===s&&o.format===l&&o.type===u)return a;this.destroyTexture(o)}return o.name="depthBuffer",o.format=l,o.type=u,o.image.width=r,o.image.height=s,this.createTexture(o,{width:r,height:s}),i.get(o).texture}updateTexture(e,t){const i=this.backend.get(e),{textureDescriptorGPU:r}=i;if(!(e.isRenderTargetTexture||r===void 0)){if(e.isDataTexture)this._copyBufferToTexture(t.image,i.texture,r,0,e.flipY);else if(e.isDataArrayTexture||e.isDepthArrayTexture||e.isData3DTexture)for(let s=0;s<t.image.depth;s++)this._copyBufferToTexture(t.image,i.texture,r,s,e.flipY,s);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,i.texture,r);else if(e.isCubeTexture)this._copyCubeMapToTexture(t.images,i.texture,r,e.flipY);else if(e.isVideoTexture){const s=e.source.data;i.externalTexture=s}else this._copyImageToTexture(t.image,i.texture,r,0,e.flipY);i.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,t,i,r,s,o){const a=this.backend.device,l=this.backend.get(e),u=l.texture,A=l.textureDescriptorGPU.format,p=this._getBytesPerTexel(A);let g=r*p;g=Math.ceil(g/256)*256;const v=a.createBuffer({size:r*s*p,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),y=a.createCommandEncoder();y.copyTextureToBuffer({texture:u,origin:{x:t,y:i,z:o}},{buffer:v,bytesPerRow:g},{width:r,height:s});const b=this._getTypedArrayType(A);a.queue.submit([y.finish()]),await v.mapAsync(GPUMapMode.READ);const w=v.getMappedRange();return new b(w)}_isEnvironmentTexture(e){const t=e.mapping;return t===ch||t===hh||t===Pa||t===La}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const i=new Cr;i.minFilter=Ui,i.magFilter=Ui,this.createTexture(i,{width:1,height:1,format:e}),this.defaultTexture[e]=t=i}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const i=new I2;i.minFilter=Ui,i.magFilter=Ui,this.createTexture(i,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=i}return this.backend.get(t).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(e===null){const t={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),t)}return e}_copyCubeMapToTexture(e,t,i,r){for(let s=0;s<6;s++){const o=e[s],a=r===!0?Qhe[s]:s;o.isDataTexture?this._copyBufferToTexture(o.image,t,i,a,r):this._copyImageToTexture(o,t,i,a,r)}}_copyImageToTexture(e,t,i,r,s){this.backend.device.queue.copyExternalImageToTexture({source:e,flipY:s},{texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},{width:e.width,height:e.height,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new jhe(this.backend.device)),e}_generateMipmaps(e,t,i=0){this._getPassUtils().generateMipmaps(e,t,i)}_flipY(e,t,i=0){this._getPassUtils().flipY(e,t,i)}_copyBufferToTexture(e,t,i,r,s,o=0){const a=this.backend.device,l=e.data,u=this._getBytesPerTexel(i.format),A=e.width*u;a.queue.writeTexture({texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},l,{offset:e.width*e.height*u*o,bytesPerRow:A},{width:e.width,height:e.height,depthOrArrayLayers:1}),s===!0&&this._flipY(t,i,r)}_copyCompressedBufferToTexture(e,t,i){const r=this.backend.device,s=this._getBlockData(i.format),o=i.size.depthOrArrayLayers>1;for(let a=0;a<e.length;a++){const l=e[a],u=l.width,A=l.height,p=o?i.size.depthOrArrayLayers:1,g=Math.ceil(u/s.width)*s.byteLength,v=g*Math.ceil(A/s.height);for(let y=0;y<p;y++)r.queue.writeTexture({texture:t,mipLevel:a,origin:{x:0,y:0,z:y}},l.data,{offset:y*v,bytesPerRow:g,rowsPerImage:Math.ceil(A/s.height)},{width:Math.ceil(u/s.width)*s.width,height:Math.ceil(A/s.height)*s.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===we.BC1RGBAUnorm||e===we.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===we.BC2RGBAUnorm||e===we.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===we.BC3RGBAUnorm||e===we.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===we.BC4RUnorm||e===we.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===we.BC5RGUnorm||e===we.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===we.BC6HRGBUFloat||e===we.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===we.BC7RGBAUnorm||e===we.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===we.ETC2RGB8Unorm||e===we.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===we.ETC2RGB8A1Unorm||e===we.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===we.ETC2RGBA8Unorm||e===we.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===we.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===we.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===we.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===we.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===we.ASTC4x4Unorm||e===we.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===we.ASTC5x4Unorm||e===we.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===we.ASTC5x5Unorm||e===we.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===we.ASTC6x5Unorm||e===we.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===we.ASTC6x6Unorm||e===we.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===we.ASTC8x5Unorm||e===we.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===we.ASTC8x6Unorm||e===we.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===we.ASTC8x8Unorm||e===we.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===we.ASTC10x5Unorm||e===we.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===we.ASTC10x6Unorm||e===we.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===we.ASTC10x8Unorm||e===we.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===we.ASTC10x10Unorm||e===we.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===we.ASTC12x10Unorm||e===we.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===we.ASTC12x12Unorm||e===we.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=Uv.ClampToEdge;return e===Ah?t=Uv.Repeat:e===dh&&(t=Uv.MirrorRepeat),t}_convertFilterMode(e){let t=Hc.Linear;return(e===Ui||e===C4||e===$l)&&(t=Hc.Nearest),t}_getBytesPerTexel(e){if(e===we.R8Unorm||e===we.R8Snorm||e===we.R8Uint||e===we.R8Sint)return 1;if(e===we.R16Uint||e===we.R16Sint||e===we.R16Float||e===we.RG8Unorm||e===we.RG8Snorm||e===we.RG8Uint||e===we.RG8Sint)return 2;if(e===we.R32Uint||e===we.R32Sint||e===we.R32Float||e===we.RG16Uint||e===we.RG16Sint||e===we.RG16Float||e===we.RGBA8Unorm||e===we.RGBA8UnormSRGB||e===we.RGBA8Snorm||e===we.RGBA8Uint||e===we.RGBA8Sint||e===we.BGRA8Unorm||e===we.BGRA8UnormSRGB||e===we.RGB9E5UFloat||e===we.RGB10A2Unorm||e===we.RG11B10UFloat||e===we.Depth32Float||e===we.Depth24Plus||e===we.Depth24PlusStencil8||e===we.Depth32FloatStencil8)return 4;if(e===we.RG32Uint||e===we.RG32Sint||e===we.RG32Float||e===we.RGBA16Uint||e===we.RGBA16Sint||e===we.RGBA16Float)return 8;if(e===we.RGBA32Uint||e===we.RGBA32Sint||e===we.RGBA32Float)return 16}_getTypedArrayType(e){if(e===we.R8Uint)return Uint8Array;if(e===we.R8Sint)return Int8Array;if(e===we.R8Unorm)return Uint8Array;if(e===we.R8Snorm)return Int8Array;if(e===we.RG8Uint)return Uint8Array;if(e===we.RG8Sint)return Int8Array;if(e===we.RG8Unorm)return Uint8Array;if(e===we.RG8Snorm)return Int8Array;if(e===we.RGBA8Uint)return Uint8Array;if(e===we.RGBA8Sint)return Int8Array;if(e===we.RGBA8Unorm)return Uint8Array;if(e===we.RGBA8Snorm)return Int8Array;if(e===we.R16Uint)return Uint16Array;if(e===we.R16Sint)return Int16Array;if(e===we.RG16Uint)return Uint16Array;if(e===we.RG16Sint)return Int16Array;if(e===we.RGBA16Uint)return Uint16Array;if(e===we.RGBA16Sint)return Int16Array;if(e===we.R16Float||e===we.RG16Float||e===we.RGBA16Float)return Uint16Array;if(e===we.R32Uint)return Uint32Array;if(e===we.R32Sint)return Int32Array;if(e===we.R32Float)return Float32Array;if(e===we.RG32Uint)return Uint32Array;if(e===we.RG32Sint)return Int32Array;if(e===we.RG32Float)return Float32Array;if(e===we.RGBA32Uint)return Uint32Array;if(e===we.RGBA32Sint)return Int32Array;if(e===we.RGBA32Float)return Float32Array;if(e===we.BGRA8Unorm||e===we.BGRA8UnormSRGB)return Uint8Array;if(e===we.RGB10A2Unorm||e===we.RGB9E5UFloat||e===we.RG11B10UFloat)return Uint32Array;if(e===we.Depth32Float)return Float32Array;if(e===we.Depth24Plus||e===we.Depth24PlusStencil8)return Uint32Array;if(e===we.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.isData3DTexture?t=AM.ThreeD:t=AM.TwoD,t}}function Hx(n,e=null){const t=n.format,i=n.type,r=n.colorSpace;let s;if(n.isCompressedTexture===!0||n.isCompressedArrayTexture===!0)switch(t){case Wu:s=r===Zt?we.BC1RGBAUnormSRGB:we.BC1RGBAUnorm;break;case $u:s=r===Zt?we.BC2RGBAUnormSRGB:we.BC2RGBAUnorm;break;case ju:s=r===Zt?we.BC3RGBAUnormSRGB:we.BC3RGBAUnorm;break;case sA:s=r===Zt?we.ETC2RGB8UnormSRGB:we.ETC2RGB8Unorm;break;case oA:s=r===Zt?we.ETC2RGBA8UnormSRGB:we.ETC2RGBA8Unorm;break;case aA:s=r===Zt?we.ASTC4x4UnormSRGB:we.ASTC4x4Unorm;break;case lA:s=r===Zt?we.ASTC5x4UnormSRGB:we.ASTC5x4Unorm;break;case uA:s=r===Zt?we.ASTC5x5UnormSRGB:we.ASTC5x5Unorm;break;case cA:s=r===Zt?we.ASTC6x5UnormSRGB:we.ASTC6x5Unorm;break;case hA:s=r===Zt?we.ASTC6x6UnormSRGB:we.ASTC6x6Unorm;break;case fA:s=r===Zt?we.ASTC8x5UnormSRGB:we.ASTC8x5Unorm;break;case AA:s=r===Zt?we.ASTC8x6UnormSRGB:we.ASTC8x6Unorm;break;case dA:s=r===Zt?we.ASTC8x8UnormSRGB:we.ASTC8x8Unorm;break;case pA:s=r===Zt?we.ASTC10x5UnormSRGB:we.ASTC10x5Unorm;break;case mA:s=r===Zt?we.ASTC10x6UnormSRGB:we.ASTC10x6Unorm;break;case gA:s=r===Zt?we.ASTC10x8UnormSRGB:we.ASTC10x8Unorm;break;case _A:s=r===Zt?we.ASTC10x10UnormSRGB:we.ASTC10x10Unorm;break;case vA:s=r===Zt?we.ASTC12x10UnormSRGB:we.ASTC12x10Unorm;break;case yA:s=r===Zt?we.ASTC12x12UnormSRGB:we.ASTC12x12Unorm;break;case ur:s=r===Zt?we.RGBA8UnormSRGB:we.RGBA8Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}else switch(t){case ur:switch(i){case Kc:s=we.RGBA8Snorm;break;case Jc:s=we.RGBA16Sint;break;case xa:s=we.RGBA16Uint;break;case Ni:s=we.RGBA32Uint;break;case qr:s=we.RGBA32Sint;break;case Ji:s=r===Zt?we.RGBA8UnormSRGB:we.RGBA8Unorm;break;case Dr:s=we.RGBA16Float;break;case mr:s=we.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",i)}break;case vp:switch(i){case N2:s=we.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",i)}break;case yp:switch(i){case Kc:s=we.R8Snorm;break;case Jc:s=we.R16Sint;break;case xa:s=we.R16Uint;break;case Ni:s=we.R32Uint;break;case qr:s=we.R32Sint;break;case Ji:s=we.R8Unorm;break;case Dr:s=we.R16Float;break;case mr:s=we.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",i)}break;case jl:switch(i){case Kc:s=we.RG8Snorm;break;case Jc:s=we.RG16Sint;break;case xa:s=we.RG16Uint;break;case Ni:s=we.RG32Uint;break;case qr:s=we.RG32Sint;break;case Ji:s=we.RG8Unorm;break;case Dr:s=we.RG16Float;break;case mr:s=we.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",i)}break;case Bo:switch(i){case xa:s=we.Depth16Unorm;break;case Ni:s=we.Depth24Plus;break;case mr:s=we.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",i)}break;case Fo:switch(i){case Io:s=we.Depth24PlusStencil8;break;case mr:e&&e.features.has(Gx.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),s=we.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",i)}break;case OA:switch(i){case qr:s=we.R32Sint;break;case Ni:s=we.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",i)}break;case kA:switch(i){case qr:s=we.RG32Sint;break;case Ni:s=we.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",i)}break;case VA:switch(i){case qr:s=we.RGBA32Sint;break;case Ni:s=we.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",i)}break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}return s}const Zhe=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,Khe=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,dM={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},Jhe=n=>{n=n.trim();const e=n.match(Zhe);if(e!==null&&e.length===4){const t=e[2],i=[];let r=null;for(;(r=Khe.exec(t))!==null;)i.push({name:r[1],type:r[2]});const s=[];for(let A=0;A<i.length;A++){const{name:p,type:g}=i[A];let v=g;v.startsWith("ptr")?v="pointer":(v.startsWith("texture")&&(v=g.split("<")[0]),v=dM[v]),s.push(new N5(v,p))}const o=n.substring(e[0].length),a=e[3]||"void",l=e[1]!==void 0?e[1]:"";return{type:dM[a]||a,inputs:s,name:l,inputsCode:t,blockCode:o,outputType:a}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class efe extends P5{constructor(e){const{type:t,inputs:i,name:r,inputsCode:s,blockCode:o,outputType:a}=Jhe(e);super(t,i,r),this.inputsCode=s,this.blockCode=o,this.outputType=a}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class tfe extends ZD{parseFunction(e){return new efe(e)}}const gf=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},nfe={[ys.READ_ONLY]:"read",[ys.WRITE_ONLY]:"write",[ys.READ_WRITE]:"read_write"},pM={[Ah]:"repeat",[il]:"clamp",[dh]:"mirror"},d1={vertex:gf?gf.VERTEX:1,fragment:gf?gf.FRAGMENT:2,compute:gf?gf.COMPUTE:4},mM={instance:!0,swizzleAssign:!1,storageBuffer:!0},ife={"^^":"tsl_xor"},rfe={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},gM={},Qo={tsl_xor:new Tr("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new Tr("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new Tr("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new Tr("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new Tr("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new Tr("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new Tr("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new Tr("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new Tr("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new Tr("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new Tr("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new Tr("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new Tr(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},j0={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};typeof navigator<"u"&&/Windows/g.test(navigator.userAgent)&&(Qo.pow_float=new Tr("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),Qo.pow_vec2=new Tr("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[Qo.pow_float]),Qo.pow_vec3=new Tr("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[Qo.pow_float]),Qo.pow_vec4=new Tr("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[Qo.pow_float]),j0.pow_float="tsl_pow_float",j0.pow_vec2="tsl_pow_vec2",j0.pow_vec3="tsl_pow_vec3",j0.pow_vec4="tsl_pow_vec4");let aI="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(aI+=`diagnostic( off, derivative_uniformity );
`);class sfe extends QD{constructor(e,t){super(e,t,new tfe),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Po}_generateTextureSample(e,t,i,r,s=this.shaderStage){return s==="fragment"?r?`textureSample( ${t}, ${t}_sampler, ${i}, ${r} )`:`textureSample( ${t}, ${t}_sampler, ${i} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,i):this.generateTextureLod(e,t,i,r,"0")}_generateVideoSample(e,t,i=this.shaderStage){if(i==="fragment")return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${t}.x, 1.0 - ${t}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${i} shader.`)}_generateTextureSampleLevel(e,t,i,r,s,o=this.shaderStage){return(o==="fragment"||o==="compute")&&this.isUnfilterable(e)===!1?`textureSampleLevel( ${t}, ${t}_sampler, ${i}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,i,r):this.generateTextureLod(e,t,i,s,r)}generateWrapFunction(e){const t=`tsl_coord_${pM[e.wrapS]}S_${pM[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let i=gM[t];if(i===void 0){const r=[],s=e.isData3DTexture?"vec3f":"vec2f";let o=`fn ${t}( coord : ${s} ) -> ${s} {

	return ${s}(
`;const a=(l,u)=>{l===Ah?(r.push(Qo.repeatWrapping_float),o+=`		tsl_repeatWrapping_float( coord.${u} )`):l===il?(r.push(Qo.clampWrapping_float),o+=`		tsl_clampWrapping_float( coord.${u} )`):l===dh?(r.push(Qo.mirrorWrapping_float),o+=`		tsl_mirrorWrapping_float( coord.${u} )`):(o+=`		coord.${u}`,console.warn(`WebGPURenderer: Unsupported texture wrap type "${l}" for vertex shader.`))};a(e.wrapS,"x"),o+=`,
`,a(e.wrapT,"y"),e.isData3DTexture&&(o+=`,
`,a(e.wrapR,"z")),o+=`
	);

}
`,gM[t]=i=new Tr(o,r)}return i.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,i){const r=this.getDataFromNode(e,this.shaderStage,this.globalCache);r.dimensionsSnippet===void 0&&(r.dimensionsSnippet={});let s=r.dimensionsSnippet[i];if(r.dimensionsSnippet[i]===void 0){let o,a;const{primarySamples:l}=this.renderer.backend.utils.getTextureSampleData(e),u=l>1;e.isData3DTexture?a="vec3<u32>":a="vec2<u32>",u||e.isVideoTexture||e.isStorageTexture?o=t:o=`${t}${i?`, u32( ${i} )`:""}`,s=new Q1(new Y1(`textureDimensions( ${o} )`,a)),r.dimensionsSnippet[i]=s,(e.isDataArrayTexture||e.isDepthArrayTexture||e.isData3DTexture)&&(r.arrayLayerCount=new Q1(new Y1(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(r.cubeFaceCount=new Q1(new Y1("6u","u32")))}return s.build(this)}generateFilteredTexture(e,t,i,r="0u"){this._include("biquadraticTexture");const s=this.generateWrapFunction(e),o=this.generateTextureDimension(e,t,r);return`tsl_biquadraticTexture( ${t}, ${s}( ${i} ), ${o}, u32( ${r} ) )`}generateTextureLod(e,t,i,r,s="0u"){const o=this.generateWrapFunction(e),a=this.generateTextureDimension(e,t,s),l=e.isData3DTexture?"vec3":"vec2",u=`${l}<u32>( ${o}( ${i} ) * ${l}<f32>( ${a} ) )`;return this.generateTextureLoad(e,t,u,r,s)}generateTextureLoad(e,t,i,r,s="0u"){let o;return e.isVideoTexture===!0||e.isStorageTexture===!0?o=`textureLoad( ${t}, ${i} )`:r?o=`textureLoad( ${t}, ${i}, ${r}, u32( ${s} ) )`:(o=`textureLoad( ${t}, ${i}, u32( ${s} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(o+=".x")),o}generateTextureStore(e,t,i,r){return`textureStore( ${t}, ${i}, ${r} )`}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===mr||this.isSampleCompare(e)===!1&&e.minFilter===Ui&&e.magFilter===Ui||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,i,r,s=this.shaderStage){let o=null;return e.isVideoTexture===!0?o=this._generateVideoSample(t,i,s):this.isUnfilterable(e)?o=this.generateTextureLod(e,t,i,r,"0",s):o=this._generateTextureSample(e,t,i,r,s),o}generateTextureGrad(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return`textureSampleGrad( ${t}, ${t}_sampler, ${i},  ${r[0]}, ${r[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${o} shader.`)}generateTextureCompare(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return e.isDepthArrayTexture?`textureSampleCompare( ${t}, ${t}_sampler, ${i}, ${s}, ${r} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${i}, ${r} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}generateTextureLevel(e,t,i,r,s,o=this.shaderStage){let a=null;return e.isVideoTexture===!0?a=this._generateVideoSample(t,i,o):a=this._generateTextureSampleLevel(e,t,i,r,s,o),a}generateTextureBias(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return`textureSampleBias( ${t}, ${t}_sampler, ${i}, ${r} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${o} shader.`)}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const i=e.name,r=e.type;return r==="texture"||r==="cubeTexture"||r==="storageTexture"||r==="texture3D"?i:r==="buffer"||r==="storageBuffer"||r==="indirectStorageBuffer"?this.isCustomStruct(e)?i:i+".value":e.groupNode.name+"."+i}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=ife[e];return t!==void 0?(this._include(t),t):null}getNodeAccess(e,t){return t!=="compute"?ys.READ_ONLY:e.access}getStorageAccess(e,t){return nfe[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,i,r=null){const s=super.getUniformFromNode(e,t,i,r),o=this.getDataFromNode(e,i,this.globalCache);if(o.uniformGPU===void 0){let a;const l=e.groupNode,u=l.name,A=this.getBindGroupArray(u,i);if(t==="texture"||t==="cubeTexture"||t==="storageTexture"||t==="texture3D"){let p=null;const g=this.getNodeAccess(e,i);if(t==="texture"||t==="storageTexture"?p=new g_(s.name,s.node,l,g):t==="cubeTexture"?p=new iI(s.name,s.node,l,g):t==="texture3D"&&(p=new rI(s.name,s.node,l,g)),p.store=e.isStorageTextureNode===!0,p.setVisibility(d1[i]),(i==="fragment"||i==="compute")&&this.isUnfilterable(e.value)===!1&&p.store===!1){const v=new Ghe(`${s.name}_sampler`,s.node,l);v.setVisibility(d1[i]),A.push(v,p),a=[v,p]}else A.push(p),a=[p]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const p=t==="buffer"?tI:$he,g=new p(e,l);g.setVisibility(d1[i]),A.push(g),a=g,s.name=r||"NodeBuffer_"+s.id}else{const p=this.uniformGroups[i]||(this.uniformGroups[i]={});let g=p[u];g===void 0&&(g=new nI(u,l),g.setVisibility(d1[i]),p[u]=g,A.push(g)),a=this.getNodeUniform(s,t),g.addUniform(a)}o.uniformGPU=a}return s}getBuiltin(e,t,i,r=this.shaderStage){const s=this.builtins[r]||(this.builtins[r]=new Map);return s.has(e)===!1&&s.set(e,{name:e,property:t,type:i}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,i=this.flowShaderNode(e),r=[];for(const o of t.inputs)r.push(o.name+" : "+this.getType(o.type));let s=`fn ${t.name}( ${r.join(", ")} ) -> ${this.getType(t.type)} {
${i.vars}
${i.code}
`;return i.result&&(s+=`	return ${i.result};
`),s+=`
}
`,s}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],i=this.directives[e];if(i!==void 0)for(const r of i)t.push(`enable ${r};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],i=this.builtins[e];if(i!==void 0)for(const{name:r,property:s,type:o}of i.values())t.push(`@builtin( ${r} ) ${s} : ${o}`);return t.join(`,
	`)}getScopedArray(e,t,i,r){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:i,bufferCount:r}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:i,scope:r,bufferType:s,bufferCount:o}of this.scopedArrays.values()){const a=this.getType(s);t.push(`var<${r}> ${i}: array< ${a}, ${o} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const i=this.getBuiltins("attribute");i&&t.push(i);const r=this.getAttributesArray();for(let s=0,o=r.length;s<o;s++){const a=r[s],l=a.name,u=this.getType(a.type);t.push(`@location( ${s} ) ${l} : ${u}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[];for(const i of e.members){const r=e.output?"@location( "+i.index+" ) ":"";let s=this.getType(i.type);i.atomic&&(s="atomic< "+s+" >"),t.push(`	${r+i.name} : ${s}`)}return e.output&&t.push(`	${this.getBuiltins("output")}`),t.join(`,
`)}getStructs(e){let t="";const i=this.structs[e];if(i.length>0){const r=[];for(const s of i){let o=`struct ${s.name} {
`;o+=this.getStructMembers(s),o+=`
};`,r.push(o)}t=`
`+r.join(`

`)+`
`}return t}getVar(e,t,i=null){let r=`var ${t} : `;return i!==null?r+=this.generateArrayDeclaration(e,i):r+=this.getType(e),r}getVars(e){const t=[],i=this.vars[e];if(i!==void 0)for(const r of i)t.push(`	${this.getVar(r.type,r.name,r.count)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const s=this.varyings,o=this.vars[e];for(let a=0;a<s.length;a++){const l=s[a];if(l.needsInterpolation){let u=`@location( ${a} )`;if(l.interpolationType){const A=l.interpolationSampling!==null?`, ${l.interpolationSampling} )`:" )";u+=` @interpolate( ${l.interpolationType}${A}`}else/^(int|uint|ivec|uvec)/.test(l.type)&&(u+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${u} ${l.name} : ${this.getType(l.type)}`)}else e==="vertex"&&o.includes(l)===!1&&o.push(l)}}const i=this.getBuiltins(e);i&&t.push(i);const r=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+r):r}isCustomStruct(e){const t=e.value,i=e.node,r=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&i.structTypeNode!==null,s=i.value&&i.value.array&&typeof i.value.itemSize=="number"&&i.value.array.length>i.value.itemSize;return r&&!s}getUniforms(e){const t=this.uniforms[e],i=[],r=[],s=[],o={};for(const l of t){const u=l.groupNode.name,A=this.bindingsIndexes[u];if(l.type==="texture"||l.type==="cubeTexture"||l.type==="storageTexture"||l.type==="texture3D"){const p=l.node.value;(e==="fragment"||e==="compute")&&this.isUnfilterable(p)===!1&&l.node.isStorageTextureNode!==!0&&(this.isSampleCompare(p)?i.push(`@binding( ${A.binding++} ) @group( ${A.group} ) var ${l.name}_sampler : sampler_comparison;`):i.push(`@binding( ${A.binding++} ) @group( ${A.group} ) var ${l.name}_sampler : sampler;`));let g,v="";const{primarySamples:y}=this.renderer.backend.utils.getTextureSampleData(p);if(y>1&&(v="_multisampled"),p.isCubeTexture===!0)g="texture_cube<f32>";else if(p.isDataArrayTexture===!0||p.isCompressedArrayTexture===!0||p.isTextureArray===!0)g="texture_2d_array<f32>";else if(p.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&p.compareFunction===null?g=`texture${v}_2d<f32>`:g=`texture_depth${v}_2d${p.isDepthArrayTexture===!0?"_array":""}`;else if(p.isVideoTexture===!0)g="texture_external";else if(p.isData3DTexture===!0)g="texture_3d<f32>";else if(l.node.isStorageTextureNode===!0){const b=Hx(p),w=this.getStorageAccess(l.node,e);g=`texture_storage_2d<${b}, ${w}>`}else{const b=this.getComponentTypeFromTexture(p).charAt(0);g=`texture${v}_2d<${b}32>`}i.push(`@binding( ${A.binding++} ) @group( ${A.group} ) var ${l.name} : ${g};`)}else if(l.type==="buffer"||l.type==="storageBuffer"||l.type==="indirectStorageBuffer"){const p=l.node,g=this.getType(p.getNodeType(this)),v=p.bufferCount,y=v>0&&l.type==="buffer"?", "+v:"",b=p.isStorageBufferNode?`storage, ${this.getStorageAccess(p,e)}`:"uniform";if(this.isCustomStruct(l))r.push(`@binding( ${A.binding++} ) @group( ${A.group} ) var<${b}> ${l.name} : ${g};`);else{const S=`	value : array< ${p.isAtomic?`atomic<${g}>`:`${g}`}${y} >`;r.push(this._getWGSLStructBinding(l.name,S,b,A.binding++,A.group))}}else{const p=this.getType(this.getVectorType(l.type)),g=l.groupNode.name;(o[g]||(o[g]={index:A.binding++,id:A.group,snippets:[]})).snippets.push(`	${l.name} : ${p}`)}}for(const l in o){const u=o[l];s.push(this._getWGSLStructBinding(l,u.snippets.join(`,
`),"uniform",u.index,u.id))}let a=i.join(`
`);return a+=r.join(`
`),a+=s.join(`
`),a}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const i=e[t];i.uniforms=this.getUniforms(t),i.attributes=this.getAttributes(t),i.varyings=this.getVaryings(t),i.structs=this.getStructs(t),i.vars=this.getVars(t),i.codes=this.getCodes(t),i.directives=this.getDirectives(t),i.scopedArrays=this.getScopedArrays(t);let r=`// code

`;r+=this.flowCode[t];const s=this.flowNodes[t],o=s[s.length-1],a=o.outputNode,l=a!==void 0&&a.isOutputStructNode===!0;for(const u of s){const A=this.getFlowData(u),p=u.name;if(p&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${p}
`),r+=`${A.code}
	`,u===o&&t!=="compute"){if(r+=`// result

	`,t==="vertex")r+=`varyings.Vertex = ${A.result};`;else if(t==="fragment")if(l)i.returnType=a.getNodeType(this),i.structs+="var<private> output : "+i.returnType+";",r+=`return ${A.result};`;else{let g="	@location(0) color: vec4<f32>";const v=this.getBuiltins("output");v&&(g+=`,
	`+v),i.returnType="OutputStruct",i.structs+=this._getWGSLStruct("OutputStruct",g),i.structs+=`
var<private> output : OutputStruct;`,r+=`output.color = ${A.result};

	return output;`}}}i.flow=r}this.shaderStage=null,this.material!==null?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,t=null){let i;return t!==null&&(i=this._getWGSLMethod(e+"_"+t)),i===void 0&&(i=this._getWGSLMethod(e)),i||e}getType(e){return rfe[e]||e}isAvailable(e){let t=mM[e];return t===void 0&&(e==="float32Filterable"?t=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(t=this.renderer.hasFeature("clip-distances")),mM[e]=t),t}_getWGSLMethod(e){return Qo[e]!==void 0&&this._include(e),j0[e]}_include(e){const t=Qo[e];return t.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${aI}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${t} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x + globalId.y * numWorkgroups.x * u32(${t}) + globalId.z * numWorkgroups.x * numWorkgroups.y * u32(${t});

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,i,r=0,s=0){const o=e+"Struct";return`${this._getWGSLStruct(o,t)}
@binding( ${r} ) @group( ${s} )
var<${i}> ${e} : ${o};`}}class ofe{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=we.Depth24PlusStencil8:e.depth&&(t=we.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const s=this.backend.renderer,o=s.getRenderTarget();t=o?o.samples:s.samples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const i=t>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:t,primarySamples:i?1:t,isMSAA:i}}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return Of.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return Of.LineList;if(e.isLine)return Of.LineStrip;if(e.isMesh)return Of.TriangleList}getSampleCount(e){let t=1;return e>1&&(t=Math.pow(2,Math.floor(Math.log2(e))),t===2&&(t=4)),t}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(e===void 0)return navigator.gpu.getPreferredCanvasFormat();if(e===Ji)return we.BGRA8Unorm;if(e===Dr)return we.RGBA16Float;throw new Error("Unsupported outputType")}}const afe=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),lfe=new Map([[S9,["float16"]]]),ufe=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class cfe{constructor(e){this.backend=e}createAttribute(e,t){const i=this._getBufferAttribute(e),r=this.backend,s=r.get(i);let o=s.buffer;if(o===void 0){const a=r.device;let l=i.array;if(e.normalized===!1){if(l.constructor===Int16Array||l.constructor===Int8Array)l=new Int32Array(l);else if((l.constructor===Uint16Array||l.constructor===Uint8Array)&&(l=new Uint32Array(l),t&GPUBufferUsage.INDEX))for(let A=0;A<l.length;A++)l[A]===65535&&(l[A]=4294967295)}if(i.array=l,(i.isStorageBufferAttribute||i.isStorageInstancedBufferAttribute)&&i.itemSize===3){l=new l.constructor(i.count*4);for(let A=0;A<i.count;A++)l.set(i.array.subarray(A*3,A*3+3),A*4);i.itemSize=4,i.array=l,s._force3to4BytesAlignment=!0}const u=l.byteLength+(4-l.byteLength%4)%4;o=a.createBuffer({label:i.name,size:u,usage:t,mappedAtCreation:!0}),new l.constructor(o.getMappedRange()).set(l),o.unmap(),s.buffer=o}}updateAttribute(e){const t=this._getBufferAttribute(e),i=this.backend,r=i.device,s=i.get(t),o=i.get(t).buffer;let a=t.array;if(s._force3to4BytesAlignment===!0){a=new a.constructor(t.count*4);for(let A=0;A<t.count;A++)a.set(t.array.subarray(A*3,A*3+3),A*4);t.array=a}const l=this._isTypedArray(a),u=t.updateRanges;if(u.length===0)r.queue.writeBuffer(o,0,a,0);else{const A=l?1:a.BYTES_PER_ELEMENT;for(let p=0,g=u.length;p<g;p++){const v=u[p];let y,b;if(s._force3to4BytesAlignment===!0){const S=Math.floor(v.start/3),C=Math.ceil(v.count/3);y=S*4*A,b=C*4*A}else y=v.start*A,b=v.count*A;const w=y*(l?a.BYTES_PER_ELEMENT:1);r.queue.writeBuffer(o,w,a,y,b)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),i=new Map;for(let r=0;r<t.length;r++){const s=t[r],o=s.array.BYTES_PER_ELEMENT,a=this._getBufferAttribute(s);let l=i.get(a);if(l===void 0){let p,g;s.isInterleavedBufferAttribute===!0?(p=s.data.stride*o,g=s.data.isInstancedInterleavedBuffer?A1.Instance:A1.Vertex):(p=s.itemSize*o,g=s.isInstancedBufferAttribute?A1.Instance:A1.Vertex),s.normalized===!1&&(s.array.constructor===Int16Array||s.array.constructor===Uint16Array)&&(p=4),l={arrayStride:p,attributes:[],stepMode:g},i.set(a,l)}const u=this._getVertexFormat(s),A=s.isInterleavedBufferAttribute===!0?s.offset*o:0;l.attributes.push({shaderLocation:r,offset:A,format:u})}return Array.from(i.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,i=t.device,s=t.get(this._getBufferAttribute(e)).buffer,o=s.size,a=i.createBuffer({label:`${e.name}_readback`,size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),l=i.createCommandEncoder({label:`readback_encoder_${e.name}`});l.copyBufferToBuffer(s,0,a,0,o);const u=l.finish();i.queue.submit([u]),await a.mapAsync(GPUMapMode.READ);const A=a.getMappedRange(),p=new e.array.constructor(A.slice(0));return a.unmap(),p.buffer}_getVertexFormat(e){const{itemSize:t,normalized:i}=e,r=e.array.constructor,s=e.constructor;let o;if(t===1)o=ufe.get(r);else{const l=(lfe.get(s)||afe.get(r))[i?1:0];if(l){const u=r.BYTES_PER_ELEMENT*t,p=Math.floor((u+3)/4)*4/r.BYTES_PER_ELEMENT;if(p%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");o=`${l}x${p}`}}return o||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),o}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class hfe{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend,i=t.device,r=[];let s=0;for(const o of e.bindings){const a={binding:s++,visibility:o.visibility};if(o.isUniformBuffer||o.isStorageBuffer){const l={};o.isStorageBuffer&&(o.visibility&4&&(o.access===ys.READ_WRITE||o.access===ys.WRITE_ONLY)?l.type=Ov.Storage:l.type=Ov.ReadOnlyStorage),a.buffer=l}else if(o.isSampler){const l={};o.texture.isDepthTexture&&(o.texture.compareFunction!==null?l.type=fM.Comparison:t.compatibilityMode&&(l.type=fM.NonFiltering)),a.sampler=l}else if(o.isSampledTexture&&o.texture.isVideoTexture)a.externalTexture={};else if(o.isSampledTexture&&o.store){const l={};l.format=this.backend.get(o.texture).texture.format;const u=o.access;u===ys.READ_WRITE?l.access=kv.ReadWrite:u===ys.WRITE_ONLY?l.access=kv.WriteOnly:l.access=kv.ReadOnly,a.storageTexture=l}else if(o.isSampledTexture){const l={},{primarySamples:u}=t.utils.getTextureSampleData(o.texture);if(u>1&&(l.multisampled=!0,o.texture.isDepthTexture||(l.sampleType=Ic.UnfilterableFloat)),o.texture.isDepthTexture)t.compatibilityMode&&o.texture.compareFunction===null?l.sampleType=Ic.UnfilterableFloat:l.sampleType=Ic.Depth;else if(o.texture.isDataTexture||o.texture.isDataArrayTexture||o.texture.isData3DTexture){const A=o.texture.type;A===qr?l.sampleType=Ic.SInt:A===Ni?l.sampleType=Ic.UInt:A===mr&&(this.backend.hasFeature("float32-filterable")?l.sampleType=Ic.Float:l.sampleType=Ic.UnfilterableFloat)}o.isSampledCubeTexture?l.viewDimension=zr.Cube:o.texture.isDataArrayTexture||o.texture.isDepthArrayTexture||o.texture.isCompressedArrayTexture?l.viewDimension=zr.TwoDArray:o.isSampledTexture3D&&(l.viewDimension=zr.ThreeD),a.texture=l}else console.error(`WebGPUBindingUtils: Unsupported binding "${o}".`);r.push(a)}return i.createBindGroupLayout({entries:r})}createBindings(e,t,i,r=0){const{backend:s,bindGroupLayoutCache:o}=this,a=s.get(e);let l=o.get(e.bindingsReference);l===void 0&&(l=this.createBindingsLayout(e),o.set(e.bindingsReference,l));let u;i>0&&(a.groups===void 0&&(a.groups=[],a.versions=[]),a.versions[i]===r&&(u=a.groups[i])),u===void 0&&(u=this.createBindGroup(e,l),i>0&&(a.groups[i]=u,a.versions[i]=r)),a.group=u,a.layout=l}updateBinding(e){const t=this.backend,i=t.device,r=e.buffer,s=t.get(e).buffer;i.queue.writeBuffer(s,0,r,0)}createBindGroupIndex(e,t){const r=this.backend.device,s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,o=e[0],a=r.createBuffer({label:"bindingCameraIndex_"+o,size:16,usage:s});r.queue.writeBuffer(a,0,e,0);const l=[{binding:0,resource:{buffer:a}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+o,layout:t,entries:l})}createBindGroup(e,t){const i=this.backend,r=i.device;let s=0;const o=[];for(const a of e.bindings){if(a.isUniformBuffer){const l=i.get(a);if(l.buffer===void 0){const u=a.byteLength,A=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,p=r.createBuffer({label:"bindingBuffer_"+a.name,size:u,usage:A});l.buffer=p}o.push({binding:s,resource:{buffer:l.buffer}})}else if(a.isStorageBuffer){const l=i.get(a);if(l.buffer===void 0){const u=a.attribute;l.buffer=i.get(u).buffer}o.push({binding:s,resource:{buffer:l.buffer}})}else if(a.isSampler){const l=i.get(a.texture);o.push({binding:s,resource:l.sampler})}else if(a.isSampledTexture){const l=i.get(a.texture);let u;if(l.externalTexture!==void 0)u=r.importExternalTexture({source:l.externalTexture});else{const A=a.store?1:l.texture.mipLevelCount,p=`view-${l.texture.width}-${l.texture.height}-${A}`;if(u=l[p],u===void 0){const g=zhe.All;let v;a.isSampledCubeTexture?v=zr.Cube:a.isSampledTexture3D?v=zr.ThreeD:a.texture.isDataArrayTexture||a.texture.isDepthArrayTexture||a.texture.isCompressedArrayTexture?v=zr.TwoDArray:v=zr.TwoD,u=l[p]=l.texture.createView({aspect:g,dimension:v,mipLevelCount:A})}}o.push({binding:s,resource:u})}s++}return r.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:o})}}class ffe{constructor(e){this.backend=e}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:i,material:r,geometry:s,pipeline:o}=e,{vertexProgram:a,fragmentProgram:l}=o,u=this.backend,A=u.device,p=u.utils,g=u.get(o),v=[];for(const j of e.getBindings()){const J=u.get(j);v.push(J.layout)}const y=u.attributeUtils.createShaderVertexBuffers(e);let b;r.blending!==Do&&(r.blending!==Gs||r.transparent!==!1)&&(b=this._getBlending(r));let w={};r.stencilWrite===!0&&(w={compare:this._getStencilCompare(r),failOp:this._getStencilOperation(r.stencilFail),depthFailOp:this._getStencilOperation(r.stencilZFail),passOp:this._getStencilOperation(r.stencilZPass)});const S=this._getColorWriteMask(r),C=[];if(e.context.textures!==null){const j=e.context.textures;for(let J=0;J<j.length;J++){const Z=p.getTextureFormatGPU(j[J]);C.push({format:Z,blend:b,writeMask:S})}}else{const j=p.getCurrentColorFormat(e.context);C.push({format:j,blend:b,writeMask:S})}const E=u.get(a).module,R=u.get(l).module,D=this._getPrimitiveState(i,s,r),B=this._getDepthCompare(r),L=p.getCurrentDepthStencilFormat(e.context),U=this._getSampleCount(e.context),P={label:`renderPipeline_${r.name||r.type}_${r.id}`,vertex:Object.assign({},E,{buffers:y}),fragment:Object.assign({},R,{targets:C}),primitive:D,multisample:{count:U,alphaToCoverageEnabled:r.alphaToCoverage&&U>1},layout:A.createPipelineLayout({bindGroupLayouts:v})},F={},V=e.context.depth,H=e.context.stencil;if((V===!0||H===!0)&&(V===!0&&(F.format=L,F.depthWriteEnabled=r.depthWrite,F.depthCompare=B),H===!0&&(F.stencilFront=w,F.stencilBack={},F.stencilReadMask=r.stencilFuncMask,F.stencilWriteMask=r.stencilWriteMask),r.polygonOffset===!0&&(F.depthBias=r.polygonOffsetUnits,F.depthBiasSlopeScale=r.polygonOffsetFactor,F.depthBiasClamp=0),P.depthStencil=F),t===null)g.pipeline=A.createRenderPipeline(P);else{const j=new Promise(J=>{A.createRenderPipelineAsync(P).then(Z=>{g.pipeline=Z,J()})});t.push(j)}}createBundleEncoder(e,t="renderBundleEncoder"){const i=this.backend,{utils:r,device:s}=i,o=r.getCurrentDepthStencilFormat(e),a=r.getCurrentColorFormat(e),l=this._getSampleCount(e),u={label:t,colorFormats:[a],depthStencilFormat:o,sampleCount:l};return s.createRenderBundleEncoder(u)}createComputePipeline(e,t){const i=this.backend,r=i.device,s=i.get(e.computeProgram).module,o=i.get(e),a=[];for(const l of t){const u=i.get(l);a.push(u.layout)}o.pipeline=r.createComputePipeline({compute:s,layout:r.createPipelineLayout({bindGroupLayouts:a})})}_getBlending(e){let t,i;const r=e.blending,s=e.blendSrc,o=e.blendDst,a=e.blendEquation;if(r===$f){const l=e.blendSrcAlpha!==null?e.blendSrcAlpha:s,u=e.blendDstAlpha!==null?e.blendDstAlpha:o,A=e.blendEquationAlpha!==null?e.blendEquationAlpha:a;t={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(a)},i={srcFactor:this._getBlendFactor(l),dstFactor:this._getBlendFactor(u),operation:this._getBlendOperation(A)}}else{const l=e.premultipliedAlpha,u=(A,p,g,v)=>{t={srcFactor:A,dstFactor:p,operation:Dc.Add},i={srcFactor:g,dstFactor:v,operation:Dc.Add}};if(l)switch(r){case Gs:u(En.One,En.OneMinusSrcAlpha,En.One,En.OneMinusSrcAlpha);break;case uh:u(En.One,En.One,En.One,En.One);break;case iA:u(En.Zero,En.OneMinusSrc,En.Zero,En.One);break;case rA:u(En.Zero,En.Src,En.Zero,En.SrcAlpha);break}else switch(r){case Gs:u(En.SrcAlpha,En.OneMinusSrcAlpha,En.One,En.OneMinusSrcAlpha);break;case uh:u(En.SrcAlpha,En.One,En.SrcAlpha,En.One);break;case iA:u(En.Zero,En.OneMinusSrc,En.Zero,En.One);break;case rA:u(En.Zero,En.Src,En.Zero,En.Src);break}}if(t!==void 0&&i!==void 0)return{color:t,alpha:i};console.error("THREE.WebGPURenderer: Invalid blending: ",r)}_getBlendFactor(e){let t;switch(e){case Ul:t=En.Zero;break;case v4:t=En.One;break;case y4:t=En.Src;break;case x4:t=En.OneMinusSrc;break;case Td:t=En.SrcAlpha;break;case Sd:t=En.OneMinusSrcAlpha;break;case S4:t=En.Dst;break;case w4:t=En.OneMinusDstColor;break;case b4:t=En.DstAlpha;break;case T4:t=En.OneMinusDstAlpha;break;case M4:t=En.SrcAlphaSaturated;break;case _oe:t=En.Constant;break;case voe:t=En.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const i=e.stencilFunc;switch(i){case Zq:t=Zr.Never;break;case Ny:t=Zr.Always;break;case Kq:t=Zr.Less;break;case eG:t=Zr.LessEqual;break;case Jq:t=Zr.Equal;break;case iG:t=Zr.GreaterEqual;break;case tG:t=Zr.Greater;break;case nG:t=Zr.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",i)}return t}_getStencilOperation(e){let t;switch(e){case Uc:t=Nu.Keep;break;case Hq:t=Nu.Zero;break;case Wq:t=Nu.Replace;break;case Yq:t=Nu.Invert;break;case $q:t=Nu.IncrementClamp;break;case jq:t=Nu.DecrementClamp;break;case Xq:t=Nu.IncrementWrap;break;case Qq:t=Nu.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case gs:t=Dc.Add;break;case g4:t=Dc.Subtract;break;case _4:t=Dc.ReverseSubtract;break;case h9:t=Dc.Min;break;case f9:t=Dc.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,i){const r={},s=this.backend.utils;switch(r.topology=s.getPrimitiveTopology(e,i),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?IA.Uint16:IA.Uint32),i.side){case oo:r.frontFace=Bv.CCW,r.cullMode=Fv.Back;break;case wi:r.frontFace=Bv.CCW,r.cullMode=Fv.Front;break;case ar:r.frontFace=Bv.CCW,r.cullMode=Fv.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",i.side);break}return r}_getColorWriteMask(e){return e.colorWrite===!0?hM.All:hM.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=Zr.Always;else{const i=e.depthFunc;switch(i){case wd:t=Zr.Never;break;case Md:t=Zr.Always;break;case Ed:t=Zr.Less;break;case Ju:t=Zr.LessEqual;break;case Cd:t=Zr.Equal;break;case Rd:t=Zr.GreaterEqual;break;case Nd:t=Zr.Greater;break;case Pd:t=Zr.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",i)}}return t}}class Afe extends oI{constructor(e,t,i=2048){super(i),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const r=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return Ea(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e.id,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,i=t*8;this.currentQueryIndex=0,this.queryOffsets.clear();const r=this.device.createCommandEncoder();r.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),r.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,i);const s=r.finish();if(this.device.queue.submit([s]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,i),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const o=new BigUint64Array(this.resultBuffer.getMappedRange(0,i));let a=0;for(const[,l]of e){const u=o[l],A=o[l+1],p=Number(A-u)/1e6;a+=p}return this.resultBuffer.unmap(),this.lastValue=a,a}catch(e){return console.error("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class dfe extends sI{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new ofe(this),this.attributeUtils=new cfe(this),this.bindingUtils=new hfe(this),this.pipelineUtils=new ffe(this),this.textureUtils=new Yhe(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let i;if(t.device===void 0){const o={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},a=typeof navigator<"u"?await navigator.gpu.requestAdapter(o):null;if(a===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const l=Object.values(Gx),u=[];for(const p of l)a.features.has(p)&&u.push(p);const A={requiredFeatures:u,requiredLimits:t.requiredLimits};i=await a.requestDevice(A)}else i=t.device;i.lost.then(o=>{const a={api:"WebGPU",message:o.message||"Unknown reason",reason:o.reason||null,originalEvent:o};e.onDeviceLost(a)});const r=t.context!==void 0?t.context:e.domElement.getContext("webgpu");this.device=i,this.context=r;const s=t.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(Gx.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:s}),this.updateSize()}get coordinateSystem(){return Al}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const i=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(i.depth,i.stencil).createView()});const r=e.colorAttachments[0];this.renderer.samples>0?r.view=this.colorBuffer.createView():r.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isDepthArrayTexture&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const i=e.renderTarget,r=this.get(i);let s=r.descriptors;if(s===void 0||r.width!==i.width||r.height!==i.height||r.dimensions!==i.dimensions||r.activeMipmapLevel!==e.activeMipmapLevel||r.activeCubeFace!==e.activeCubeFace||r.samples!==i.samples){s={},r.descriptors=s;const u=()=>{i.removeEventListener("dispose",u),this.delete(i)};i.hasEventListener("dispose",u)===!1&&i.addEventListener("dispose",u)}const o=e.getCacheKey();let a=s[o];if(a===void 0){const u=e.textures,A=[];let p;const g=this._isRenderCameraDepthArray(e);for(let v=0;v<u.length;v++){const y=this.get(u[v]),b={label:`colorAttachment_${v}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:zr.TwoD};if(i.isRenderTarget3D)p=e.activeCubeFace,b.baseArrayLayer=0,b.dimension=zr.ThreeD,b.depthOrArrayLayers=u[v].image.depth;else if(i.isRenderTargetArray)if(g===!0){const w=e.camera.cameras;for(let S=0;S<w.length;S++){const C={...b,baseArrayLayer:S,arrayLayerCount:1,dimension:zr.TwoD},E=y.texture.createView(C);A.push({view:E,resolveTarget:void 0,depthSlice:void 0})}}else b.dimension=zr.TwoDArray,b.depthOrArrayLayers=u[v].image.depth;if(g!==!0){const w=y.texture.createView(b);let S,C;y.msaaTexture!==void 0?(S=y.msaaTexture.createView(),C=w):(S=w,C=void 0),A.push({view:S,resolveTarget:C,depthSlice:p})}}if(a={textureViews:A},e.depth){const v=this.get(e.depthTexture),y={};e.depthTexture.isDepthArrayTexture&&(y.dimension=zr.TwoD,y.arrayLayerCount=1,y.baseArrayLayer=e.activeCubeFace),a.depthStencilView=v.texture.createView(y)}s[o]=a,r.width=i.width,r.height=i.height,r.samples=i.samples,r.activeMipmapLevel=e.activeMipmapLevel,r.activeCubeFace=e.activeCubeFace,r.dimensions=i.dimensions}const l={colorAttachments:[]};for(let u=0;u<a.textureViews.length;u++){const A=a.textureViews[u];let p={r:0,g:0,b:0,a:1};u===0&&t.clearValue&&(p=t.clearValue),l.colorAttachments.push({view:A.view,depthSlice:A.depthSlice,resolveTarget:A.resolveTarget,loadOp:t.loadOp||oi.Load,storeOp:t.storeOp||Ps.Store,clearValue:p})}return a.depthStencilView&&(l.depthStencilAttachment={view:a.depthStencilView}),l}beginRender(e){const t=this.get(e),i=this.device,r=e.occlusionQueryCount;let s;r>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,s=i.createQuerySet({type:"occlusion",count:r,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=s,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(r),t.lastOcclusionObject=null);let o;e.textures===null?o=this._getDefaultRenderPassDescriptor():o=this._getRenderPassDescriptor(e,{loadOp:oi.Load}),this.initTimestampQuery(e,o),o.occlusionQuerySet=s;const a=o.depthStencilAttachment;if(e.textures!==null){const u=o.colorAttachments;for(let A=0;A<u.length;A++){const p=u[A];e.clearColor?(p.clearValue=A===0?e.clearColorValue:{r:0,g:0,b:0,a:1},p.loadOp=oi.Clear):p.loadOp=oi.Load,p.storeOp=Ps.Store}}else{const u=o.colorAttachments[0];e.clearColor?(u.clearValue=e.clearColorValue,u.loadOp=oi.Clear):u.loadOp=oi.Load,u.storeOp=Ps.Store}e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=oi.Clear):a.depthLoadOp=oi.Load,a.depthStoreOp=Ps.Store),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=oi.Clear):a.stencilLoadOp=oi.Load,a.stencilStoreOp=Ps.Store);const l=i.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const u=e.camera.cameras;!t.layerDescriptors||t.layerDescriptors.length!==u.length?this._createDepthLayerDescriptors(e,t,o,u):this._updateDepthLayerDescriptors(e,t,u),t.bundleEncoders=[],t.bundleSets=[];for(let A=0;A<u.length;A++){const p=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+A),g={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(p),t.bundleSets.push(g)}t.currentPass=null}else{const u=l.beginRenderPass(o);if(t.currentPass=u,e.viewport&&this.updateViewport(e),e.scissor){const{x:A,y:p,width:g,height:v}=e.scissorValue;u.setScissorRect(A,p,g,v)}}t.descriptor=o,t.encoder=l,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,i,r){const s=i.depthStencilAttachment;t.layerDescriptors=[];const o=this.get(e.depthTexture);o.viewCache||(o.viewCache=[]);for(let a=0;a<r.length;a++){const l={...i,colorAttachments:[{...i.colorAttachments[0],view:i.colorAttachments[a].view}]};if(i.depthStencilAttachment){const u=a;o.viewCache[u]||(o.viewCache[u]=o.texture.createView({dimension:zr.TwoD,baseArrayLayer:a,arrayLayerCount:1})),l.depthStencilAttachment={view:o.viewCache[u],depthLoadOp:s.depthLoadOp||oi.Clear,depthStoreOp:s.depthStoreOp||Ps.Store,depthClearValue:s.depthClearValue||1},e.stencil&&(l.depthStencilAttachment.stencilLoadOp=s.stencilLoadOp,l.depthStencilAttachment.stencilStoreOp=s.stencilStoreOp,l.depthStencilAttachment.stencilClearValue=s.stencilClearValue)}else l.depthStencilAttachment={...s};t.layerDescriptors.push(l)}}_updateDepthLayerDescriptors(e,t,i){for(let r=0;r<i.length;r++){const s=t.layerDescriptors[r];if(s.depthStencilAttachment){const o=s.depthStencilAttachment;e.depth&&(e.clearDepth?(o.depthClearValue=e.clearDepthValue,o.depthLoadOp=oi.Clear):o.depthLoadOp=oi.Load),e.stencil&&(e.clearStencil?(o.stencilClearValue=e.clearStencilValue,o.stencilLoadOp=oi.Clear):o.stencilLoadOp=oi.Load)}}}finishRender(e){const t=this.get(e),i=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),i>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const r=t.encoder;if(this._isRenderCameraDepthArray(e)===!0){const s=[];for(let o=0;o<t.bundleEncoders.length;o++){const a=t.bundleEncoders[o];s.push(a.finish())}for(let o=0;o<t.layerDescriptors.length;o++)if(o<s.length){const a=t.layerDescriptors[o],l=r.beginRenderPass(a);if(e.viewport){const{x:u,y:A,width:p,height:g,minDepth:v,maxDepth:y}=e.viewportValue;l.setViewport(u,A,p,g,v,y)}if(e.scissor){const{x:u,y:A,width:p,height:g}=e.scissorValue;l.setScissorRect(u,A,p,g)}l.executeBundles([s[o]]),l.end()}}else t.currentPass&&t.currentPass.end();if(i>0){const s=i*8;let o=this.occludedResolveCache.get(s);o===void 0&&(o=this.device.createBuffer({size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(s,o));const a=this.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,i,o,0),t.encoder.copyBufferToBuffer(o,0,a,0,s),t.occlusionQueryBuffer=a,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const s=e.textures;for(let o=0;o<s.length;o++){const a=s[o];a.generateMipmaps===!0&&this.textureUtils.generateMipmaps(a)}}}isOccluded(e,t){const i=this.get(e);return i.occluded&&i.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:i,currentOcclusionQueryObjects:r}=t;if(i&&r){const s=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await i.mapAsync(GPUMapMode.READ);const o=i.getMappedRange(),a=new BigUint64Array(o);for(let l=0;l<r.length;l++)a[l]===BigInt(0)&&s.add(r[l]);i.destroy(),t.occluded=s}}updateViewport(e){const{currentPass:t}=this.get(e),{x:i,y:r,width:s,height:o,minDepth:a,maxDepth:l}=e.viewportValue;t.setViewport(i,r,s,o,a,l)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,i,r=null){const s=this.device,o=this.renderer;let a=[],l,u,A,p;if(e){const y=this.getClearColor();u={r:y.r,g:y.g,b:y.b,a:y.a}}if(r===null){A=o.depth,p=o.stencil;const y=this._getDefaultRenderPassDescriptor();if(e){a=y.colorAttachments;const b=a[0];b.clearValue=u,b.loadOp=oi.Clear,b.storeOp=Ps.Store}(A||p)&&(l=y.depthStencilAttachment)}else{A=r.depth,p=r.stencil;const y={loadOp:e?oi.Clear:oi.Load,clearValue:e?u:void 0};A&&(y.depthLoadOp=t?oi.Clear:oi.Load,y.depthClearValue=t?o.getClearDepth():void 0,y.depthStoreOp=Ps.Store),p&&(y.stencilLoadOp=i?oi.Clear:oi.Load,y.stencilClearValue=i?o.getClearStencil():void 0,y.stencilStoreOp=Ps.Store);const b=this._getRenderPassDescriptor(r,y);a=b.colorAttachments,l=b.depthStencilAttachment}A&&l&&l.depthLoadOp===void 0&&(t?(l.depthLoadOp=oi.Clear,l.depthClearValue=o.getClearDepth(),l.depthStoreOp=Ps.Store):(l.depthLoadOp=oi.Load,l.depthStoreOp=Ps.Store)),p&&l&&l.stencilLoadOp===void 0&&(i?(l.stencilLoadOp=oi.Clear,l.stencilClearValue=o.getClearStencil(),l.stencilStoreOp=Ps.Store):(l.stencilLoadOp=oi.Load,l.stencilStoreOp=Ps.Store));const g=s.createCommandEncoder({label:"clear"});g.beginRenderPass({colorAttachments:a,depthStencilAttachment:l}).end(),s.queue.submit([g.finish()])}beginCompute(e){const t=this.get(e),i={label:"computeGroup_"+e.id};this.initTimestampQuery(e,i),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(i)}compute(e,t,i,r){const{passEncoderGPU:s}=this.get(e),o=this.get(r).pipeline;s.setPipeline(o);for(let A=0,p=i.length;A<p;A++){const g=i[A],v=this.get(g);s.setBindGroup(A,v.group)}const a=this.device.limits.maxComputeWorkgroupsPerDimension,l=this.get(t);l.dispatchSize===void 0&&(l.dispatchSize={x:0,y:1,z:1});const{dispatchSize:u}=l;t.dispatchCount>a?(u.x=Math.min(t.dispatchCount,a),u.y=Math.ceil(t.dispatchCount/a)):u.x=t.dispatchCount,s.dispatchWorkgroups(u.x,u.y,u.z)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:i,material:r,context:s,pipeline:o}=e,a=e.getBindings(),l=this.get(s),u=this.get(o).pipeline,A=e.getIndex(),p=A!==null,g=e.getDrawParameters();if(g===null)return;const v=(b,w)=>{b.setPipeline(u),w.pipeline=u;const S=w.bindingGroups;for(let E=0,R=a.length;E<R;E++){const D=a[E],B=this.get(D);S[D.index]!==D.id&&(b.setBindGroup(D.index,B.group),S[D.index]=D.id)}if(p===!0&&w.index!==A){const E=this.get(A).buffer,R=A.array instanceof Uint16Array?IA.Uint16:IA.Uint32;b.setIndexBuffer(E,R),w.index=A}const C=e.getVertexBuffers();for(let E=0,R=C.length;E<R;E++){const D=C[E];if(w.attributes[E]!==D){const B=this.get(D).buffer;b.setVertexBuffer(E,B),w.attributes[E]=D}}s.stencil===!0&&r.stencilWrite===!0&&l.currentStencilRef!==r.stencilRef&&(b.setStencilReference(r.stencilRef),l.currentStencilRef=r.stencilRef)},y=(b,w)=>{if(v(b,w),i.isBatchedMesh===!0){const S=i._multiDrawStarts,C=i._multiDrawCounts,E=i._multiDrawCount,R=i._multiDrawInstances;R!==null&&Ea("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let D=0;D<E;D++){const B=R?R[D]:1,L=B>1?0:D;p===!0?b.drawIndexed(C[D],B,S[D]/A.array.BYTES_PER_ELEMENT,0,L):b.draw(C[D],B,S[D],L),t.update(i,C[D],B)}}else if(p===!0){const{vertexCount:S,instanceCount:C,firstVertex:E}=g,R=e.getIndirect();if(R!==null){const D=this.get(R).buffer;b.drawIndexedIndirect(D,0)}else b.drawIndexed(S,C,E,0,0);t.update(i,S,C)}else{const{vertexCount:S,instanceCount:C,firstVertex:E}=g,R=e.getIndirect();if(R!==null){const D=this.get(R).buffer;b.drawIndirect(D,0)}else b.draw(S,C,E,0);t.update(i,S,C)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const b=this.get(e.camera),w=e.camera.cameras,S=e.getBindingGroup("cameraIndex");if(b.indexesGPU===void 0||b.indexesGPU.length!==w.length){const E=this.get(S),R=[],D=new Uint32Array([0,0,0,0]);for(let B=0,L=w.length;B<L;B++){D[0]=B;const U=this.bindingUtils.createBindGroupIndex(D,E.layout);R.push(U)}b.indexesGPU=R}const C=this.renderer.getPixelRatio();for(let E=0,R=w.length;E<R;E++){const D=w[E];if(i.layers.test(D.layers)){const B=D.viewport;let L=l.currentPass,U=l.currentSets;if(l.bundleEncoders){const P=l.bundleEncoders[E],F=l.bundleSets[E];L=P,U=F}B&&L.setViewport(Math.floor(B.x*C),Math.floor(B.y*C),Math.floor(B.width*C),Math.floor(B.height*C),s.viewportValue.minDepth,s.viewportValue.maxDepth),S&&b.indexesGPU&&(L.setBindGroup(S.index,b.indexesGPU[E]),U.bindingGroups[S.index]=S.id),y(L,U)}}}else if(l.currentPass){if(l.occlusionQuerySet!==void 0){const b=l.lastOcclusionObject;b!==i&&(b!==null&&b.occlusionTest===!0&&(l.currentPass.endOcclusionQuery(),l.occlusionQueryIndex++),i.occlusionTest===!0&&(l.currentPass.beginOcclusionQuery(l.occlusionQueryIndex),l.occlusionQueryObjects[l.occlusionQueryIndex]=i),l.lastOcclusionObject=i)}y(l.currentPass,l.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:i,material:r}=e,s=this.utils,o=s.getSampleCountRenderContext(e.context),a=s.getCurrentColorSpace(e.context),l=s.getCurrentColorFormat(e.context),u=s.getCurrentDepthStencilFormat(e.context),A=s.getPrimitiveTopology(i,r);let p=!1;return(t.material!==r||t.materialVersion!==r.version||t.transparent!==r.transparent||t.blending!==r.blending||t.premultipliedAlpha!==r.premultipliedAlpha||t.blendSrc!==r.blendSrc||t.blendDst!==r.blendDst||t.blendEquation!==r.blendEquation||t.blendSrcAlpha!==r.blendSrcAlpha||t.blendDstAlpha!==r.blendDstAlpha||t.blendEquationAlpha!==r.blendEquationAlpha||t.colorWrite!==r.colorWrite||t.depthWrite!==r.depthWrite||t.depthTest!==r.depthTest||t.depthFunc!==r.depthFunc||t.stencilWrite!==r.stencilWrite||t.stencilFunc!==r.stencilFunc||t.stencilFail!==r.stencilFail||t.stencilZFail!==r.stencilZFail||t.stencilZPass!==r.stencilZPass||t.stencilFuncMask!==r.stencilFuncMask||t.stencilWriteMask!==r.stencilWriteMask||t.side!==r.side||t.alphaToCoverage!==r.alphaToCoverage||t.sampleCount!==o||t.colorSpace!==a||t.colorFormat!==l||t.depthStencilFormat!==u||t.primitiveTopology!==A||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=o,t.colorSpace=a,t.colorFormat=l,t.depthStencilFormat=u,t.primitiveTopology=A,t.clippingContextCacheKey=e.clippingContextCacheKey,p=!0),p}getRenderCacheKey(e){const{object:t,material:i}=e,r=this.utils,s=e.context;return[i.transparent,i.blending,i.premultipliedAlpha,i.blendSrc,i.blendDst,i.blendEquation,i.blendSrcAlpha,i.blendDstAlpha,i.blendEquationAlpha,i.colorWrite,i.depthWrite,i.depthTest,i.depthFunc,i.stencilWrite,i.stencilFunc,i.stencilFail,i.stencilZFail,i.stencilZPass,i.stencilFuncMask,i.stencilWriteMask,i.side,r.getSampleCountRenderContext(s),r.getCurrentColorSpace(s),r.getCurrentColorFormat(s),r.getCurrentDepthStencilFormat(s),r.getPrimitiveTopology(t,i),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,i,r,s,o){return this.textureUtils.copyTextureToBuffer(e,t,i,r,s,o)}initTimestampQuery(e,t){if(!this.trackTimestamp)return;const i=e.isComputeNode?"compute":"render";this.timestampQueryPool[i]||(this.timestampQueryPool[i]=new Afe(this.device,i,2048));const r=this.timestampQueryPool[i],s=r.allocateQueriesForContext(e);t.timestampWrites={querySet:r.querySet,beginningOfPassWriteIndex:s,endOfPassWriteIndex:s+1}}createNodeBuilder(e,t){return new sfe(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const i=this.get(e),s=i.currentPass.finish();this.get(t).bundleGPU=s,i.currentSets=i._currentSets,i.currentPass=i._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,i,r){this.bindingUtils.createBindings(e,t,i,r)}updateBindings(e,t,i,r){this.bindingUtils.createBindings(e,t,i,r)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,i=null,r=null,s=0,o=0){let a=0,l=0,u=0,A=0,p=0,g=0,v=e.image.width,y=e.image.height,b=1;i!==null&&(i.isBox3===!0?(A=i.min.x,p=i.min.y,g=i.min.z,v=i.max.x-i.min.x,y=i.max.y-i.min.y,b=i.max.z-i.min.z):(A=i.min.x,p=i.min.y,v=i.max.x-i.min.x,y=i.max.y-i.min.y,b=1)),r!==null&&(a=r.x,l=r.y,u=r.z||0);const w=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),S=this.get(e).texture,C=this.get(t).texture;w.copyTextureToTexture({texture:S,mipLevel:s,origin:{x:A,y:p,z:g}},{texture:C,mipLevel:o,origin:{x:a,y:l,z:u}},[v,y,b]),this.device.queue.submit([w.finish()]),o===0&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,i){const r=this.get(t);let s=null;t.renderTarget?e.isDepthTexture?s=this.get(t.depthTexture).texture:s=this.get(t.textures[0]).texture:e.isDepthTexture?s=this.textureUtils.getDepthBuffer(t.depth,t.stencil):s=this.context.getCurrentTexture();const o=this.get(e).texture;if(s.format!==o.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",s.format,o.format);return}let a;if(r.currentPass?(r.currentPass.end(),a=r.encoder):a=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),a.copyTextureToTexture({texture:s,origin:[i.x,i.y,0]},{texture:o},[i.z,i.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e),r.currentPass){const{descriptor:l}=r;for(let u=0;u<l.colorAttachments.length;u++)l.colorAttachments[u].loadOp=oi.Load;if(t.depth&&(l.depthStencilAttachment.depthLoadOp=oi.Load),t.stencil&&(l.depthStencilAttachment.stencilLoadOp=oi.Load),r.currentPass=a.beginRenderPass(l),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){const{x:u,y:A,width:p,height:g}=t.scissorValue;r.currentPass.setScissorRect(u,A,p,g)}}else this.device.queue.submit([a.finish()])}}class pfe extends H9{constructor(e,t,i,r,s,o){super(e,t,i,r,s,o),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class mfe extends KD{constructor(){super(),this.addMaterial(Ase,"MeshPhongMaterial"),this.addMaterial(HL,"MeshStandardMaterial"),this.addMaterial(Kse,"MeshPhysicalMaterial"),this.addMaterial(noe,"MeshToonMaterial"),this.addMaterial(ose,"MeshBasicMaterial"),this.addMaterial(hse,"MeshLambertMaterial"),this.addMaterial(ese,"MeshNormalMaterial"),this.addMaterial(soe,"MeshMatcapMaterial"),this.addMaterial(jre,"LineBasicMaterial"),this.addMaterial(Qre,"LineDashedMaterial"),this.addMaterial(uoe,"PointsMaterial"),this.addMaterial($L,"SpriteMaterial"),this.addMaterial(foe,"ShadowMaterial"),this.addLight(lue,W9),this.addLight(Qce,K4),this.addLight(Yce,qH),this.addLight(YD,H9),this.addLight(Kce,k2),this.addLight(Jce,OH),this.addLight(ehe,HH),this.addLight(Zce,pfe),this.addToneMapping(AD,p9),this.addToneMapping(dD,m9),this.addToneMapping(pD,g9),this.addToneMapping(mD,_9),this.addToneMapping(gD,v9),this.addToneMapping(_D,y9)}}class gfe extends vhe{constructor(e={}){let t;e.forceWebGL?t=cM:(t=dfe,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new cM(e)));const i=new t(e);super(i,e),this.library=new mfe,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */O.BRDF_GGX;O.BRDF_Lambert;O.BasicShadowFilter;O.Break;O.Continue;O.DFGApprox;O.D_GGX;O.Discard;O.EPSILON;O.F_Schlick;const _fe=O.Fn;O.INFINITY;const vfe=O.If;O.Switch;const yfe=O.Loop;O.NodeShaderStage;O.NodeType;O.NodeUpdateType;O.NodeAccess;O.PCFShadowFilter;O.PCFSoftShadowFilter;O.PI;O.PI2;O.Return;O.Schlick_to_F0;O.ScriptableNodeResources;O.ShaderNode;O.TBNViewMatrix;O.VSMShadowFilter;O.V_GGX_SmithCorrelated;O.abs;O.acesFilmicToneMapping;O.acos;O.add;O.addNodeElement;O.agxToneMapping;O.all;O.alphaT;O.and;O.anisotropy;O.anisotropyB;O.anisotropyT;O.any;O.append;O.array;O.arrayBuffer;const xfe=O.asin;O.assign;O.atan;O.atan2;O.atomicAdd;O.atomicAnd;O.atomicFunc;O.atomicMax;O.atomicMin;O.atomicOr;O.atomicStore;O.atomicSub;O.atomicXor;O.atomicLoad;O.attenuationColor;O.attenuationDistance;O.attribute;O.attributeArray;O.backgroundBlurriness;O.backgroundIntensity;O.backgroundRotation;O.batch;O.billboarding;O.bitAnd;O.bitNot;O.bitOr;O.bitXor;O.bitangentGeometry;O.bitangentLocal;O.bitangentView;O.bitangentWorld;O.bitcast;O.blendBurn;O.blendColor;O.blendDodge;O.blendOverlay;O.blendScreen;O.blur;O.bool;O.buffer;O.bufferAttribute;O.bumpMap;O.burn;O.bvec2;O.bvec3;O.bvec4;O.bypass;O.cache;O.call;O.cameraFar;O.cameraIndex;O.cameraNear;O.cameraNormalMatrix;O.cameraPosition;O.cameraProjectionMatrix;O.cameraProjectionMatrixInverse;O.cameraViewMatrix;O.cameraWorldMatrix;O.cbrt;O.cdl;O.ceil;O.checker;O.cineonToneMapping;O.clamp;O.clearcoat;O.clearcoatRoughness;O.code;O.color;O.colorSpaceToWorking;O.colorToDirection;O.compute;O.computeSkinning;O.cond;O.Const;O.context;O.convert;O.convertColorSpace;O.convertToTexture;const bfe=O.cos;O.cross;O.cubeTexture;O.dFdx;O.dFdy;O.dashSize;O.debug;O.decrement;O.decrementBefore;O.defaultBuildStages;O.defaultShaderStages;O.defined;O.degrees;O.deltaTime;O.densityFog;O.densityFogFactor;O.depth;O.depthPass;O.difference;O.diffuseColor;O.directPointLight;O.directionToColor;O.dispersion;O.distance;O.div;O.dodge;O.dot;O.drawIndex;O.dynamicBufferAttribute;O.element;O.emissive;O.equal;O.equals;O.equirectUV;const Tfe=O.exp;O.exp2;O.expression;O.faceDirection;O.faceForward;O.faceforward;const Sfe=O.float;O.floor;O.fog;O.fract;O.frameGroup;O.frameId;O.frontFacing;O.fwidth;O.gain;O.gapSize;O.getConstNodeType;O.getCurrentStack;O.getDirection;O.getDistanceAttenuation;O.getGeometryRoughness;O.getNormalFromDepth;O.getParallaxCorrectNormal;O.getRoughness;O.getScreenPosition;O.getShIrradianceAt;O.getTextureIndex;O.getViewPosition;O.getShadowMaterial;O.getShadowRenderObjectFunction;O.glsl;O.glslFn;O.grayscale;O.greaterThan;O.greaterThanEqual;O.hash;O.highpModelNormalViewMatrix;O.highpModelViewMatrix;O.hue;O.increment;O.incrementBefore;O.instance;const wfe=O.instanceIndex;O.instancedArray;O.instancedBufferAttribute;O.instancedDynamicBufferAttribute;O.instancedMesh;O.int;O.inverseSqrt;O.inversesqrt;O.invocationLocalIndex;O.invocationSubgroupIndex;O.ior;O.iridescence;O.iridescenceIOR;O.iridescenceThickness;O.ivec2;O.ivec3;O.ivec4;O.js;O.label;O.length;O.lengthSq;O.lessThan;O.lessThanEqual;O.lightPosition;O.lightShadowMatrix;O.lightTargetDirection;O.lightTargetPosition;O.lightViewPosition;O.lightingContext;O.lights;O.linearDepth;O.linearToneMapping;O.localId;O.globalId;O.log;O.log2;O.logarithmicDepthToViewZ;O.loop;O.luminance;O.mediumpModelViewMatrix;O.mat2;O.mat3;O.mat4;O.matcapUV;O.materialAO;O.materialAlphaTest;O.materialAnisotropy;O.materialAnisotropyVector;O.materialAttenuationColor;O.materialAttenuationDistance;O.materialClearcoat;O.materialClearcoatNormal;O.materialClearcoatRoughness;O.materialColor;O.materialDispersion;O.materialEmissive;O.materialIOR;O.materialIridescence;O.materialIridescenceIOR;O.materialIridescenceThickness;O.materialLightMap;O.materialLineDashOffset;O.materialLineDashSize;O.materialLineGapSize;O.materialLineScale;O.materialLineWidth;O.materialMetalness;O.materialNormal;O.materialOpacity;O.materialPointSize;O.materialReference;O.materialReflectivity;O.materialRefractionRatio;O.materialRotation;O.materialRoughness;O.materialSheen;O.materialSheenRoughness;O.materialShininess;O.materialSpecular;O.materialSpecularColor;O.materialSpecularIntensity;O.materialSpecularStrength;O.materialThickness;O.materialTransmission;O.max;O.maxMipLevel;O.metalness;O.min;O.mix;O.mixElement;O.mod;O.modInt;O.modelDirection;O.modelNormalMatrix;O.modelPosition;O.modelRadius;O.modelScale;O.modelViewMatrix;O.modelViewPosition;O.modelViewProjection;O.modelWorldMatrix;O.modelWorldMatrixInverse;O.morphReference;O.mrt;O.mul;O.mx_aastep;O.mx_cell_noise_float;O.mx_contrast;O.mx_fractal_noise_float;O.mx_fractal_noise_vec2;O.mx_fractal_noise_vec3;O.mx_fractal_noise_vec4;O.mx_hsvtorgb;O.mx_noise_float;O.mx_noise_vec3;O.mx_noise_vec4;O.mx_ramplr;O.mx_ramptb;O.mx_rgbtohsv;O.mx_safepower;O.mx_splitlr;O.mx_splittb;O.mx_srgb_texture_to_lin_rec709;O.mx_transform_uv;O.mx_worley_noise_float;O.mx_worley_noise_vec2;O.mx_worley_noise_vec3;const Mfe=O.negate;O.neutralToneMapping;O.nodeArray;O.nodeImmutable;O.nodeObject;O.nodeObjects;O.nodeProxy;O.normalFlat;O.normalGeometry;O.normalLocal;O.normalMap;O.normalView;O.normalWorld;O.normalize;O.not;O.notEqual;O.numWorkgroups;O.objectDirection;O.objectGroup;O.objectPosition;O.objectRadius;O.objectScale;O.objectViewPosition;O.objectWorldMatrix;O.oneMinus;O.or;O.orthographicDepthToViewZ;O.oscSawtooth;O.oscSine;O.oscSquare;O.oscTriangle;O.output;O.outputStruct;O.overlay;O.overloadingFn;O.parabola;O.parallaxDirection;O.parallaxUV;O.parameter;O.pass;O.passTexture;O.pcurve;O.perspectiveDepthToViewZ;O.pmremTexture;O.pointUV;O.pointWidth;O.positionGeometry;O.positionLocal;O.positionPrevious;O.positionView;O.positionViewDirection;O.positionWorld;O.positionWorldDirection;O.posterize;O.pow;O.pow2;O.pow3;O.pow4;O.property;O.radians;O.rand;O.range;O.rangeFog;O.rangeFogFactor;O.reciprocal;O.lightProjectionUV;O.reference;O.referenceBuffer;O.reflect;O.reflectVector;O.reflectView;O.reflector;O.refract;O.refractVector;O.refractView;O.reinhardToneMapping;O.remainder;O.remap;O.remapClamp;O.renderGroup;O.renderOutput;O.rendererReference;O.rotate;O.rotateUV;O.roughness;O.round;O.rtt;O.sRGBTransferEOTF;O.sRGBTransferOETF;O.sampler;O.samplerComparison;O.saturate;O.saturation;O.screen;O.screenCoordinate;O.screenSize;O.screenUV;O.scriptable;O.scriptableValue;O.select;O.setCurrentStack;O.shaderStages;O.shadow;O.pointShadow;O.shadowPositionWorld;O.sharedUniformGroup;O.shapeCircle;O.sheen;O.sheenRoughness;O.shiftLeft;O.shiftRight;O.shininess;O.sign;const Efe=O.sin;O.sinc;O.skinning;O.smoothstep;O.smoothstepElement;O.specularColor;O.specularF90;O.spherizeUV;O.split;O.spritesheetUV;const Cfe=O.sqrt;O.stack;O.step;const Rfe=O.storage;O.storageBarrier;O.storageObject;O.storageTexture;O.string;O.struct;O.sub;O.subgroupIndex;O.subgroupSize;O.tan;O.tangentGeometry;O.tangentLocal;O.tangentView;O.tangentWorld;O.temp;O.texture;O.texture3D;O.textureBarrier;O.textureBicubic;O.textureCubeUV;O.textureLoad;O.textureSize;O.textureStore;O.thickness;O.threshold;O.time;O.timerDelta;O.timerGlobal;O.timerLocal;O.toOutputColorSpace;O.toWorkingColorSpace;O.toneMapping;O.toneMappingExposure;O.toonOutlinePass;O.transformDirection;O.transformNormal;O.transformNormalToView;O.transformedBentNormalView;O.transformedBitangentView;O.transformedBitangentWorld;O.transformedClearcoatNormalView;O.transformedNormalView;O.transformedNormalWorld;O.transformedTangentView;O.transformedTangentWorld;O.transmission;O.transpose;O.tri;O.tri3;O.triNoise3D;O.triplanarTexture;O.triplanarTextures;O.trunc;O.tslFn;O.uint;const Nfe=O.uniform;O.uniformArray;O.uniformGroup;O.uniforms;O.userData;O.uv;O.uvec2;O.uvec3;O.uvec4;O.Var;O.varying;O.varyingProperty;O.vec2;O.vec3;O.vec4;O.vectorComponents;O.velocity;O.vertexColor;O.vertexIndex;O.vibrance;O.viewZToLogarithmicDepth;O.viewZToOrthographicDepth;O.viewZToPerspectiveDepth;O.viewport;O.viewportBottomLeft;O.viewportCoordinate;O.viewportDepthTexture;O.viewportLinearDepth;O.viewportMipTexture;O.viewportResolution;O.viewportSafeUV;O.viewportSharedTexture;O.viewportSize;O.viewportTexture;O.viewportTopLeft;O.viewportUV;O.wgsl;O.wgslFn;O.workgroupArray;O.workgroupBarrier;O.workgroupId;O.workingToColorSpace;O.xor;const _M=new rc,p1=new re;class lI extends WH{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],i=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(i),this.setAttribute("position",new ri(e,3)),this.setAttribute("uv",new ri(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,i=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),i.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new xg(t,6,1);return this.setAttribute("instanceStart",new Ko(i,3,0)),this.setAttribute("instanceEnd",new Ko(i,3,3)),this.instanceCount=this.attributes.instanceStart.count,this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new xg(t,6,1);return this.setAttribute("instanceColorStart",new Ko(i,3,0)),this.setAttribute("instanceColorEnd",new Ko(i,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new MH(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new rc);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),_M.setFromBufferAttribute(t),this.boundingBox.union(_M))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new sc),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)p1.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(p1)),p1.fromBufferAttribute(t,s),r=Math.max(r,i.distanceToSquared(p1));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}}It.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new rt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Ks.line={uniforms:G4.merge([It.common,It.fog,It.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class D5 extends sa{constructor(e){super({type:"LineMaterial",uniforms:G4.clone(Ks.line.uniforms),vertexShader:Ks.line.vertexShader,fragmentShader:Ks.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){e===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){e===!0!==this.dashed&&(this.needsUpdate=!0),e===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(e===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),e===!0?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const Vv=new Kt,vM=new re,yM=new re,Kr=new Kt,Jr=new Kt,$a=new Kt,zv=new re,qv=new on,ts=new XH,xM=new re,m1=new rc,g1=new sc,ja=new Kt;let nl,ah;function bM(n,e,t){return ja.set(0,0,-e,1).applyMatrix4(n.projectionMatrix),ja.multiplyScalar(1/ja.w),ja.x=ah/t.width,ja.y=ah/t.height,ja.applyMatrix4(n.projectionMatrixInverse),ja.multiplyScalar(1/ja.w),Math.abs(Math.max(ja.x,ja.y))}function Pfe(n,e){const t=n.matrixWorld,i=n.geometry,r=i.attributes.instanceStart,s=i.attributes.instanceEnd,o=Math.min(i.instanceCount,r.count);for(let a=0,l=o;a<l;a++){ts.start.fromBufferAttribute(r,a),ts.end.fromBufferAttribute(s,a),ts.applyMatrix4(t);const u=new re,A=new re;nl.distanceSqToSegment(ts.start,ts.end,A,u),A.distanceTo(u)<ah*.5&&e.push({point:A,pointOnLine:u,distance:nl.origin.distanceTo(A),object:n,face:null,faceIndex:a,uv:null,uv1:null})}}function Lfe(n,e,t){const i=e.projectionMatrix,s=n.material.resolution,o=n.matrixWorld,a=n.geometry,l=a.attributes.instanceStart,u=a.attributes.instanceEnd,A=Math.min(a.instanceCount,l.count),p=-e.near;nl.at(1,$a),$a.w=1,$a.applyMatrix4(e.matrixWorldInverse),$a.applyMatrix4(i),$a.multiplyScalar(1/$a.w),$a.x*=s.x/2,$a.y*=s.y/2,$a.z=0,zv.copy($a),qv.multiplyMatrices(e.matrixWorldInverse,o);for(let g=0,v=A;g<v;g++){if(Kr.fromBufferAttribute(l,g),Jr.fromBufferAttribute(u,g),Kr.w=1,Jr.w=1,Kr.applyMatrix4(qv),Jr.applyMatrix4(qv),Kr.z>p&&Jr.z>p)continue;if(Kr.z>p){const E=Kr.z-Jr.z,R=(Kr.z-p)/E;Kr.lerp(Jr,R)}else if(Jr.z>p){const E=Jr.z-Kr.z,R=(Jr.z-p)/E;Jr.lerp(Kr,R)}Kr.applyMatrix4(i),Jr.applyMatrix4(i),Kr.multiplyScalar(1/Kr.w),Jr.multiplyScalar(1/Jr.w),Kr.x*=s.x/2,Kr.y*=s.y/2,Jr.x*=s.x/2,Jr.y*=s.y/2,ts.start.copy(Kr),ts.start.z=0,ts.end.copy(Jr),ts.end.z=0;const b=ts.closestPointToPointParameter(zv,!0);ts.at(b,xM);const w=xA.lerp(Kr.z,Jr.z,b),S=w>=-1&&w<=1,C=zv.distanceTo(xM)<ah*.5;if(S&&C){ts.start.fromBufferAttribute(l,g),ts.end.fromBufferAttribute(u,g),ts.start.applyMatrix4(o),ts.end.applyMatrix4(o);const E=new re,R=new re;nl.distanceSqToSegment(ts.start,ts.end,R,E),t.push({point:R,pointOnLine:E,distance:nl.origin.distanceTo(R),object:n,face:null,faceIndex:g,uv:null,uv1:null})}}}class Dfe extends Jn{constructor(e=new lI,t=new D5({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,i=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let o=0,a=0,l=t.count;o<l;o++,a+=2)vM.fromBufferAttribute(t,o),yM.fromBufferAttribute(i,o),r[a]=a===0?0:r[a-1],r[a+1]=r[a]+vM.distanceTo(yM);const s=new xg(r,2,1);return e.setAttribute("instanceDistanceStart",new Ko(s,1,0)),e.setAttribute("instanceDistanceEnd",new Ko(s,1,1)),this}raycast(e,t){const i=this.material.worldUnits,r=e.camera;r===null&&!i&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;nl=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;ah=l.linewidth+s,a.boundingSphere===null&&a.computeBoundingSphere(),g1.copy(a.boundingSphere).applyMatrix4(o);let u;if(i)u=ah*.5;else{const p=Math.max(r.near,g1.distanceToPoint(nl.origin));u=bM(r,p,l.resolution)}if(g1.radius+=u,nl.intersectsSphere(g1)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),m1.copy(a.boundingBox).applyMatrix4(o);let A;if(i)A=ah*.5;else{const p=Math.max(r.near,m1.distanceToPoint(nl.origin));A=bM(r,p,l.resolution)}m1.expandByScalar(A),nl.intersectsBox(m1)!==!1&&(i?Pfe(this,t):Lfe(this,r,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(Vv),this.material.uniforms.resolution.value.set(Vv.z,Vv.w))}}class uI extends lI{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,i=new Float32Array(2*t);for(let r=0;r<t;r+=3)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5];return super.setPositions(i),this}setColors(e){const t=e.length-3,i=new Float32Array(2*t);for(let r=0;r<t;r+=3)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5];return super.setColors(i),this}setFromPoints(e){const t=e.length-1,i=new Float32Array(6*t);for(let r=0;r<t;r++)i[6*r]=e[r].x,i[6*r+1]=e[r].y,i[6*r+2]=e[r].z||0,i[6*r+3]=e[r+1].x,i[6*r+4]=e[r+1].y,i[6*r+5]=e[r+1].z||0;return super.setPositions(i),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class Ife extends Dfe{constructor(e=new uI,t=new D5({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}class TM extends X4{constructor(e,t={}){const i=t.font;if(i===void 0)super();else{const r=i.generateShapes(e,t.size);t.depth===void 0&&(t.depth=50),t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class Bfe{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const i=[],r=Ffe(e,t,this.data);for(let s=0,o=r.length;s<o;s++)i.push(...r[s].toShapes());return i}}function Ffe(n,e,t){const i=Array.from(n),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,o=[];let a=0,l=0;for(let u=0;u<i.length;u++){const A=i[u];if(A===`
`)a=0,l-=s;else{const p=Ufe(A,r,a,l,t);a+=p.offsetX,o.push(p.path)}}return o}function Ufe(n,e,t,i,r){const s=r.glyphs[n]||r.glyphs["?"];if(!s){console.error('THREE.Font: character "'+n+'" does not exists in font family '+r.familyName+".");return}const o=new QH;let a,l,u,A,p,g,v,y;if(s.o){const b=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let w=0,S=b.length;w<S;)switch(b[w++]){case"m":a=b[w++]*e+t,l=b[w++]*e+i,o.moveTo(a,l);break;case"l":a=b[w++]*e+t,l=b[w++]*e+i,o.lineTo(a,l);break;case"q":u=b[w++]*e+t,A=b[w++]*e+i,p=b[w++]*e+t,g=b[w++]*e+i,o.quadraticCurveTo(p,g,u,A);break;case"b":u=b[w++]*e+t,A=b[w++]*e+i,p=b[w++]*e+t,g=b[w++]*e+i,v=b[w++]*e+t,y=b[w++]*e+i,o.bezierCurveTo(p,g,v,y,u,A);break}}return{offsetX:s.ha*e,path:o}}class Ofe extends ki{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new rt(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}new re;new on;new on;new re;new re;function Wx(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function kfe(n){if(Array.isArray(n))return n}function Vfe(n){if(Array.isArray(n))return Wx(n)}function cI(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function zfe(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function SM(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(u){return void t(u)}a.done?e(l):Promise.resolve(l).then(i,r)}function qfe(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){SM(s,i,r,o,a,"next",l)}function a(l){SM(s,i,r,o,a,"throw",l)}o(void 0)})}}function __(n,e,t){return e=BA(e),Zfe(n,B5()?Reflect.construct(e,t||[],BA(n).constructor):e.apply(n,t))}function Gfe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v_(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function D0(n,e){return n.get(cI(n,e))}function Gv(n,e,t){Gfe(n,e),e.set(n,t)}function Hv(n,e,t){return n.set(cI(n,e),t),t}function I5(n,e,t){if(B5())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(n.bind.apply(n,i));return r}function Hfe(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,hI(i.key),i)}}function y_(n,e,t){return e&&Hfe(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function Xr(n,e,t){return(e=hI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $x(){return $x=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,e,t){var i=Kfe(n,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?n:t):r.value}},$x.apply(null,arguments)}function BA(n){return BA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},BA(n)}function x_(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Xx(n,e)}function B5(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(B5=function(){return!!n})()}function Wfe(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function $fe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(A){u=!0,r=A}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function jfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wM(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function fi(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wM(Object(t),!0).forEach(function(i){Xr(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):wM(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Qfe(n,e){if(n==null)return{};var t,i,r=Yfe(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function Yfe(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.indexOf(i)!==-1)continue;t[i]=n[i]}return t}function Zfe(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zfe(n)}function jx(){jx=function(){return e};var n,e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(W,K,ee){W[K]=ee.value},s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function u(W,K,ee){return Object.defineProperty(W,K,{value:ee,enumerable:!0,configurable:!0,writable:!0}),W[K]}try{u({},"")}catch{u=function(K,ee,se){return K[ee]=se}}function A(W,K,ee,se){var ge=K&&K.prototype instanceof S?K:S,de=Object.create(ge.prototype),Ae=new J(se||[]);return r(de,"_invoke",{value:F(W,ee,Ae)}),de}function p(W,K,ee){try{return{type:"normal",arg:W.call(K,ee)}}catch(se){return{type:"throw",arg:se}}}e.wrap=A;var g="suspendedStart",v="suspendedYield",y="executing",b="completed",w={};function S(){}function C(){}function E(){}var R={};u(R,o,function(){return this});var D=Object.getPrototypeOf,B=D&&D(D(Z([])));B&&B!==t&&i.call(B,o)&&(R=B);var L=E.prototype=S.prototype=Object.create(R);function U(W){["next","throw","return"].forEach(function(K){u(W,K,function(ee){return this._invoke(K,ee)})})}function P(W,K){function ee(ge,de,Ae,Be){var ye=p(W[ge],W,de);if(ye.type!=="throw"){var De=ye.arg,We=De.value;return We&&typeof We=="object"&&i.call(We,"__await")?K.resolve(We.__await).then(function($e){ee("next",$e,Ae,Be)},function($e){ee("throw",$e,Ae,Be)}):K.resolve(We).then(function($e){De.value=$e,Ae(De)},function($e){return ee("throw",$e,Ae,Be)})}Be(ye.arg)}var se;r(this,"_invoke",{value:function(ge,de){function Ae(){return new K(function(Be,ye){ee(ge,de,Be,ye)})}return se=se?se.then(Ae,Ae):Ae()}})}function F(W,K,ee){var se=g;return function(ge,de){if(se===y)throw Error("Generator is already running");if(se===b){if(ge==="throw")throw de;return{value:n,done:!0}}for(ee.method=ge,ee.arg=de;;){var Ae=ee.delegate;if(Ae){var Be=V(Ae,ee);if(Be){if(Be===w)continue;return Be}}if(ee.method==="next")ee.sent=ee._sent=ee.arg;else if(ee.method==="throw"){if(se===g)throw se=b,ee.arg;ee.dispatchException(ee.arg)}else ee.method==="return"&&ee.abrupt("return",ee.arg);se=y;var ye=p(W,K,ee);if(ye.type==="normal"){if(se=ee.done?b:v,ye.arg===w)continue;return{value:ye.arg,done:ee.done}}ye.type==="throw"&&(se=b,ee.method="throw",ee.arg=ye.arg)}}}function V(W,K){var ee=K.method,se=W.iterator[ee];if(se===n)return K.delegate=null,ee==="throw"&&W.iterator.return&&(K.method="return",K.arg=n,V(W,K),K.method==="throw")||ee!=="return"&&(K.method="throw",K.arg=new TypeError("The iterator does not provide a '"+ee+"' method")),w;var ge=p(se,W.iterator,K.arg);if(ge.type==="throw")return K.method="throw",K.arg=ge.arg,K.delegate=null,w;var de=ge.arg;return de?de.done?(K[W.resultName]=de.value,K.next=W.nextLoc,K.method!=="return"&&(K.method="next",K.arg=n),K.delegate=null,w):de:(K.method="throw",K.arg=new TypeError("iterator result is not an object"),K.delegate=null,w)}function H(W){var K={tryLoc:W[0]};1 in W&&(K.catchLoc=W[1]),2 in W&&(K.finallyLoc=W[2],K.afterLoc=W[3]),this.tryEntries.push(K)}function j(W){var K=W.completion||{};K.type="normal",delete K.arg,W.completion=K}function J(W){this.tryEntries=[{tryLoc:"root"}],W.forEach(H,this),this.reset(!0)}function Z(W){if(W||W===""){var K=W[o];if(K)return K.call(W);if(typeof W.next=="function")return W;if(!isNaN(W.length)){var ee=-1,se=function ge(){for(;++ee<W.length;)if(i.call(W,ee))return ge.value=W[ee],ge.done=!1,ge;return ge.value=n,ge.done=!0,ge};return se.next=se}}throw new TypeError(typeof W+" is not iterable")}return C.prototype=E,r(L,"constructor",{value:E,configurable:!0}),r(E,"constructor",{value:C,configurable:!0}),C.displayName=u(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(W){var K=typeof W=="function"&&W.constructor;return!!K&&(K===C||(K.displayName||K.name)==="GeneratorFunction")},e.mark=function(W){return Object.setPrototypeOf?Object.setPrototypeOf(W,E):(W.__proto__=E,u(W,l,"GeneratorFunction")),W.prototype=Object.create(L),W},e.awrap=function(W){return{__await:W}},U(P.prototype),u(P.prototype,a,function(){return this}),e.AsyncIterator=P,e.async=function(W,K,ee,se,ge){ge===void 0&&(ge=Promise);var de=new P(A(W,K,ee,se),ge);return e.isGeneratorFunction(K)?de:de.next().then(function(Ae){return Ae.done?Ae.value:de.next()})},U(L),u(L,l,"Generator"),u(L,o,function(){return this}),u(L,"toString",function(){return"[object Generator]"}),e.keys=function(W){var K=Object(W),ee=[];for(var se in K)ee.push(se);return ee.reverse(),function ge(){for(;ee.length;){var de=ee.pop();if(de in K)return ge.value=de,ge.done=!1,ge}return ge.done=!0,ge}},e.values=Z,J.prototype={constructor:J,reset:function(W){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(j),!W)for(var K in this)K.charAt(0)==="t"&&i.call(this,K)&&!isNaN(+K.slice(1))&&(this[K]=n)},stop:function(){this.done=!0;var W=this.tryEntries[0].completion;if(W.type==="throw")throw W.arg;return this.rval},dispatchException:function(W){if(this.done)throw W;var K=this;function ee(ye,De){return de.type="throw",de.arg=W,K.next=ye,De&&(K.method="next",K.arg=n),!!De}for(var se=this.tryEntries.length-1;se>=0;--se){var ge=this.tryEntries[se],de=ge.completion;if(ge.tryLoc==="root")return ee("end");if(ge.tryLoc<=this.prev){var Ae=i.call(ge,"catchLoc"),Be=i.call(ge,"finallyLoc");if(Ae&&Be){if(this.prev<ge.catchLoc)return ee(ge.catchLoc,!0);if(this.prev<ge.finallyLoc)return ee(ge.finallyLoc)}else if(Ae){if(this.prev<ge.catchLoc)return ee(ge.catchLoc,!0)}else{if(!Be)throw Error("try statement without catch or finally");if(this.prev<ge.finallyLoc)return ee(ge.finallyLoc)}}}},abrupt:function(W,K){for(var ee=this.tryEntries.length-1;ee>=0;--ee){var se=this.tryEntries[ee];if(se.tryLoc<=this.prev&&i.call(se,"finallyLoc")&&this.prev<se.finallyLoc){var ge=se;break}}ge&&(W==="break"||W==="continue")&&ge.tryLoc<=K&&K<=ge.finallyLoc&&(ge=null);var de=ge?ge.completion:{};return de.type=W,de.arg=K,ge?(this.method="next",this.next=ge.finallyLoc,w):this.complete(de)},complete:function(W,K){if(W.type==="throw")throw W.arg;return W.type==="break"||W.type==="continue"?this.next=W.arg:W.type==="return"?(this.rval=this.arg=W.arg,this.method="return",this.next="end"):W.type==="normal"&&K&&(this.next=K),w},finish:function(W){for(var K=this.tryEntries.length-1;K>=0;--K){var ee=this.tryEntries[K];if(ee.finallyLoc===W)return this.complete(ee.completion,ee.afterLoc),j(ee),w}},catch:function(W){for(var K=this.tryEntries.length-1;K>=0;--K){var ee=this.tryEntries[K];if(ee.tryLoc===W){var se=ee.completion;if(se.type==="throw"){var ge=se.arg;j(ee)}return ge}}throw Error("illegal catch attempt")},delegateYield:function(W,K,ee){return this.delegate={iterator:Z(W),resultName:K,nextLoc:ee},this.method==="next"&&(this.arg=n),w}},e}function Xx(n,e){return Xx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},Xx(n,e)}function qi(n,e){return kfe(n)||$fe(n,e)||fI(n,e)||jfe()}function Kfe(n,e){for(;!{}.hasOwnProperty.call(n,e)&&(n=BA(n))!==null;);return n}function Wv(n,e,t,i){var r=$x(BA(n.prototype),e,t);return typeof r=="function"?function(s){return r.apply(t,s)}:r}function _i(n){return Vfe(n)||Wfe(n)||fI(n)||Xfe()}function Jfe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function hI(n){var e=Jfe(n,"string");return typeof e=="symbol"?e:e+""}function fI(n,e){if(n){if(typeof n=="string")return Wx(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Wx(n,e):void 0}}var AI=function(e){e instanceof Array?e.forEach(AI):(e.map&&e.map.dispose(),e.dispose())},F5=function(e){e.geometry&&e.geometry.dispose(),e.material&&AI(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(F5)},Ti=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),F5(t)}};function Hs(n,e){var t=new e;return{linkProp:function(r){return{default:t[r](),onChange:function(o,a){a[n][r](o)},triggerUpdate:!1}},linkMethod:function(r){return function(s){for(var o=s[n],a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];var A=o[r].apply(o,l);return A===o?this:A}}}}var Oi=100;function MM(){return Oi}function ua(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180,s=Oi*(1+t),o=Math.sin(i);return{x:s*o*Math.cos(r),y:s*Math.cos(i),z:s*o*Math.sin(r)}}function dI(n){var e=n.x,t=n.y,i=n.z,r=Math.sqrt(e*e+t*t+i*i),s=Math.acos(t/r),o=Math.atan2(i,e);return{lat:90-s*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),altitude:r/Oi-1}}function Wc(n){return n*Math.PI/180}var fp=window.THREE?window.THREE:{BackSide:wi,BufferAttribute:Xi,Color:Gt,Mesh:Jn,ShaderMaterial:sa},eAe=`
uniform float hollowRadius;

varying vec3 vVertexWorldPosition;
varying vec3 vVertexNormal;
varying float vCameraDistanceToObjCenter;
varying float vVertexAngularDistanceToHollowRadius;

void main() {    
  vVertexNormal	= normalize(normalMatrix * normal);
  vVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
  
  vec4 objCenterViewPosition = modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0);
  vCameraDistanceToObjCenter = length(objCenterViewPosition);
  
  float edgeAngle = atan(hollowRadius / vCameraDistanceToObjCenter);
  float vertexAngle = acos(dot(normalize(modelViewMatrix * vec4(position, 1.0)), normalize(objCenterViewPosition)));
  vVertexAngularDistanceToHollowRadius = vertexAngle - edgeAngle;

  gl_Position	= projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}`,tAe=`
uniform vec3 color;
uniform float coefficient;
uniform float power;
uniform float hollowRadius;

varying vec3 vVertexNormal;
varying vec3 vVertexWorldPosition;
varying float vCameraDistanceToObjCenter;
varying float vVertexAngularDistanceToHollowRadius;

void main() {
  if (vCameraDistanceToObjCenter < hollowRadius) discard; // inside the hollowRadius
  if (vVertexAngularDistanceToHollowRadius < 0.0) discard; // frag position is within the hollow radius

  vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;
  vec3 viewCameraToVertex	= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;
  viewCameraToVertex = normalize(viewCameraToVertex);
  float intensity	= pow(
    coefficient + dot(vVertexNormal, viewCameraToVertex),
    power
  );
  gl_FragColor = vec4(color, intensity);
}`;function nAe(n,e,t,i){return new fp.ShaderMaterial({depthWrite:!1,transparent:!0,vertexShader:eAe,fragmentShader:tAe,uniforms:{coefficient:{value:n},color:{value:new fp.Color(e)},power:{value:t},hollowRadius:{value:i}}})}function iAe(n,e){for(var t=n.clone(),i=new Float32Array(n.attributes.position.count*3),r=0,s=i.length;r<s;r++){var o=n.attributes.normal.array[r],a=n.attributes.position.array[r];i[r]=a+o*e}return t.setAttribute("position",new fp.BufferAttribute(i,3)),t}var rAe=function(n){function e(t){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.color,o=s===void 0?"gold":s,a=r.size,l=a===void 0?2:a,u=r.coefficient,A=u===void 0?.5:u,p=r.power,g=p===void 0?1:p,v=r.hollowRadius,y=v===void 0?0:v,b=r.backside,w=b===void 0?!0:b;v_(this,e),i=__(this,e);var S=iAe(t,l),C=nAe(A,o,g,y);return w&&(C.side=fp.BackSide),i.geometry=S,i.material=C,i}return x_(e,n),y_(e)}(fp.Mesh),Xa=window.THREE?window.THREE:{Color:Gt,Group:vs,LineBasicMaterial:Sh,LineSegments:N9,Mesh:Jn,MeshPhongMaterial:vg,SphereGeometry:Fa,SRGBColorSpace:Zt,TextureLoader:yg},pI=Ss({props:{globeImageUrl:{},bumpImageUrl:{},showGlobe:{default:!0,onChange:function(e,t){t.globeGroup.visible=!!e},triggerUpdate:!1},showGraticules:{default:!1,onChange:function(e,t){t.graticulesObj.visible=!!e},triggerUpdate:!1},showAtmosphere:{default:!0,onChange:function(e,t){t.atmosphereObj&&(t.atmosphereObj.visible=!!e)},triggerUpdate:!1},atmosphereColor:{default:"lightskyblue"},atmosphereAltitude:{default:.15},globeTileEngineUrl:{onChange:function(e,t){t.tileEngine.tileUrl=e}},globeTileEngineMaxLevel:{default:17,onChange:function(e,t){t.tileEngine.maxLevel=e},triggerUpdate:!1},updatePov:{onChange:function(e,t){t.tileEngine.updatePov(e)},triggerUpdate:!1},onReady:{default:function(){},triggerUpdate:!1}},methods:{globeMaterial:function(e,t){return t!==void 0?(e.globeObj.material=t||e.defaultGlobeMaterial,this):e.globeObj.material},_destructor:function(e){Ti(e.globeObj),Ti(e.tileEngine),Ti(e.graticulesObj)}},stateInit:function(){var e=new Xa.SphereGeometry(Oi,75,75),t=new Xa.MeshPhongMaterial({color:0}),i=new Xa.Mesh(e,t);i.rotation.y=-Math.PI/2;var r=new YK(Oi),s=new Xa.Group;s.__globeObjType="globe",s.add(i),s.add(r);var o=new Xa.LineSegments(new KC(dK(),Oi,2),new Xa.LineBasicMaterial({color:"lightgrey",transparent:!0,opacity:.1}));return{globeGroup:s,globeObj:i,graticulesObj:o,defaultGlobeMaterial:t,tileEngine:r}},init:function(e,t){Ti(e),t.scene=e,t.scene.add(t.globeGroup),t.scene.add(t.graticulesObj),t.ready=!1},update:function(e,t){var i=e.globeObj.material;if(e.tileEngine.visible=!(e.globeObj.visible=!e.globeTileEngineUrl),t.hasOwnProperty("globeImageUrl")&&(e.globeImageUrl?new Xa.TextureLoader().load(e.globeImageUrl,function(s){s.colorSpace=Xa.SRGBColorSpace,i.map=s,i.color=null,i.needsUpdate=!0,!e.ready&&(e.ready=!0)&&setTimeout(e.onReady)}):!i.color&&(i.color=new Xa.Color(0))),t.hasOwnProperty("bumpImageUrl")&&(e.bumpImageUrl?e.bumpImageUrl&&new Xa.TextureLoader().load(e.bumpImageUrl,function(s){i.bumpMap=s,i.needsUpdate=!0}):(i.bumpMap=null,i.needsUpdate=!0)),(t.hasOwnProperty("atmosphereColor")||t.hasOwnProperty("atmosphereAltitude"))&&(e.atmosphereObj&&(e.scene.remove(e.atmosphereObj),Ti(e.atmosphereObj)),e.atmosphereColor&&e.atmosphereAltitude)){var r=e.atmosphereObj=new rAe(e.globeObj.geometry,{color:e.atmosphereColor,size:Oi*e.atmosphereAltitude,hollowRadius:Oi,coefficient:.1,power:3.5});r.visible=!!e.showAtmosphere,r.__globeObjType="atmosphere",e.scene.add(r)}!e.ready&&(!e.globeImageUrl||e.globeTileEngineUrl)&&(e.ready=!0,e.onReady())}}),vl=function(e){return isNaN(e)?parseInt(Jt(e).toHex(),16):e},Ra=function(e){return e&&isNaN(e)?_h(e).opacity:1},tc=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r,s=1,o=/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.eE+-]+)\s*\)$/.exec(e.trim().toLowerCase());if(o){var a=o.slice(1),l=qi(a,4),u=l[0],A=l[1],p=l[2],g=l[3];r=new Gt("rgb(".concat(+u,",").concat(+A,",").concat(+p,")")),s=Math.min(+g,1)}else r=new Gt(e);i&&r.convertLinearToSRGB();var v=r.toArray();return t?[].concat(_i(v),[s]):v};function sAe(n,e,t){return n.opacity=e,n.transparent=e<1,n.depthWrite=e>=1,n}var EM=window.THREE?window.THREE:{BufferAttribute:Xi};function yl(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float32Array;if(e===1)return new EM.BufferAttribute(new t(n),e);for(var i=new EM.BufferAttribute(new t(n.length*e),e),r=0,s=n.length;r<s;r++)i.set(n[r],r*e);return i}function oAe(n){for(var e=n.itemSize,t=[],i=0;i<n.count;i++)t.push(n.array.slice(i*e,(i+1)*e));return t}var $v=new WeakMap,_1=new WeakMap,v1=new WeakMap,Ao=function(n){function e(t){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.dataBindAttr,o=s===void 0?"__data":s,a=r.objBindAttr,l=a===void 0?"__threeObj":a,u=r.removeDelay,A=u===void 0?0:u;return v_(this,e),i=__(this,e),Xr(i,"scene",void 0),Gv(i,$v,void 0),Gv(i,_1,void 0),Gv(i,v1,void 0),i.scene=t,Hv($v,i,o),Hv(_1,i,l),Hv(v1,i,A),i.onRemoveObj(function(){}),i}return x_(e,n),y_(e,[{key:"onCreateObj",value:function(i){var r=this;return Wv(e,"onCreateObj",this)([function(s){var o=i(s);return s[D0(_1,r)]=o,o[D0($v,r)]=s,r.scene.add(o),o}]),this}},{key:"onRemoveObj",value:function(i){var r=this;return Wv(e,"onRemoveObj",this)([function(s,o){var a=Wv(e,"getData",r)([s]);i(s,o);var l=function(){r.scene.remove(s),Ti(s),delete a[D0(_1,r)]};D0(v1,r)?setTimeout(l,D0(v1,r)):l()}]),this}}])}(wee),da=window.THREE?window.THREE:{BufferGeometry:pi,CylinderGeometry:U2,Matrix4:on,Mesh:Jn,MeshLambertMaterial:Tl,Object3D:ki,Vector3:re},CM=Object.assign({},Ab),RM=CM.BufferGeometryUtils||CM,mI=Ss({props:{pointsData:{default:[]},pointLat:{default:"lat"},pointLng:{default:"lng"},pointColor:{default:function(){return"#ffffaa"}},pointAltitude:{default:.1},pointRadius:{default:.25},pointResolution:{default:12,triggerUpdate:!1},pointsMerge:{default:!1},pointsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;Ti(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjPoint"})},update:function(e,t){var i=ft(e.pointLat),r=ft(e.pointLng),s=ft(e.pointAltitude),o=ft(e.pointRadius),a=ft(e.pointColor),l=new da.CylinderGeometry(1,1,1,e.pointResolution);l.applyMatrix4(new da.Matrix4().makeRotationX(Math.PI/2)),l.applyMatrix4(new da.Matrix4().makeTranslation(0,0,-.5));var u=2*Math.PI*Oi/360,A={};if(!e.pointsMerge&&t.hasOwnProperty("pointsMerge")&&Ti(e.scene),e.dataMapper.scene=e.pointsMerge?new da.Object3D:e.scene,e.dataMapper.onCreateObj(v).onUpdateObj(y).digest(e.pointsData),e.pointsMerge){var p=e.pointsData.length?(RM.mergeGeometries||RM.mergeBufferGeometries)(e.pointsData.map(function(b){var w=e.dataMapper.getObj(b),S=w.geometry.clone();w.updateMatrix(),S.applyMatrix4(w.matrix);var C=tc(a(b));return S.setAttribute("color",yl(Array(S.getAttribute("position").count).fill(C),4)),S})):new da.BufferGeometry,g=new da.Mesh(p,new da.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0}));g.__globeObjType="points",g.__data=e.pointsData,e.dataMapper.clear(),Ti(e.scene),e.scene.add(g)}function v(){var b=new da.Mesh(l);return b.__globeObjType="point",b}function y(b,w){var S=function(U){var P=b.__currentTargetD=U,F=P.r,V=P.alt,H=P.lat,j=P.lng;Object.assign(b.position,ua(H,j));var J=e.pointsMerge?new da.Vector3(0,0,0):e.scene.localToWorld(new da.Vector3(0,0,0));b.lookAt(J),b.scale.x=b.scale.y=Math.min(30,F)*u,b.scale.z=Math.max(V*Oi,.1)},C={alt:+s(w),r:+o(w),lat:+i(w),lng:+r(w)},E=b.__currentTargetD||Object.assign({},C,{alt:-.001});if(Object.keys(C).some(function(L){return E[L]!==C[L]})&&(e.pointsMerge||!e.pointsTransitionDuration||e.pointsTransitionDuration<0?S(C):e.tweenGroup.add(new Uo(E).to(C,e.pointsTransitionDuration).easing(rs.Quadratic.InOut).onUpdate(S).start())),!e.pointsMerge){var R=a(w),D=R?Ra(R):0,B=!!D;b.visible=B,B&&(A.hasOwnProperty(R)||(A[R]=new da.MeshLambertMaterial({color:vl(R),transparent:D<1,opacity:D})),b.material=A[R])}}}}),gI=function(){return{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:`
    uniform float dashTranslate; 

    attribute vec4 color;
    varying vec4 vColor;
    
    attribute float relDistance;
    varying float vRelDistance;

    void main() {
      // pass through colors and distances
      vColor = color;
      vRelDistance = relDistance + dashTranslate;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,fragmentShader:`
    uniform float dashOffset; 
    uniform float dashSize;
    uniform float gapSize; 
    
    varying vec4 vColor;
    varying float vRelDistance;
    
    void main() {
      // ignore pixels in the gap
      if (vRelDistance < dashOffset) discard;
      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;
    
      // set px color: [r, g, b, a], interpolated between vertices 
      gl_FragColor = vColor; 
    }
  `}},Qx=function(e){return e.uniforms.surfaceRadius={type:"float",value:0},e.vertexShader=(`attribute float surfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.vertexShader).replace("void main() {",["void main() {","vSurfaceRadius = surfaceRadius;","vPos = position;"].join(`
`)),e.fragmentShader=(`uniform float surfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.fragmentShader).replace("void main() {",["void main() {","if (length(vPos) < max(surfaceRadius, vSurfaceRadius)) discard;"].join(`
`)),e},aAe=function(e){return e.vertexShader=`
    attribute float r;
    
    const float PI = 3.1415926535897932384626433832795;
    float toRad(in float a) {
      return a * PI / 180.0;
    }
    
    vec3 Polar2Cartesian(in vec3 c) { // [lat, lng, r]
      float phi = toRad(90.0 - c.x);
      float theta = toRad(90.0 - c.y);
      float r = c.z;
      return vec3( // x,y,z
        r * sin(phi) * cos(theta),
        r * cos(phi),
        r * sin(phi) * sin(theta)
      );
    }
    
    vec2 Cartesian2Polar(in vec3 p) {
      float r = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);
      float phi = acos(p.y / r);
      float theta = atan(p.z, p.x);
      return vec2( // lat,lng
        90.0 - phi * 180.0 / PI,
        90.0 - theta * 180.0 / PI - (theta < -PI / 2.0 ? 360.0 : 0.0)
      );
    }
    `.concat(e.vertexShader.replace("}",`                  
        vec3 pos = Polar2Cartesian(vec3(Cartesian2Polar(position), r));
        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
      }
    `),`
  `),e},U5=function(e,t){return e.onBeforeCompile=function(i){e.userData.shader=t(i)},e},lAe=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(r){return r};if(e.userData.shader)t(e.userData.shader.uniforms);else{var i=e.onBeforeCompile;e.onBeforeCompile=function(r){i(r),t(r.uniforms)}}},uAe=["stroke"],pa=window.THREE?window.THREE:{BufferGeometry:pi,CubicBezierCurve3:I9,Curve:Ba,Group:vs,Line:Tp,Mesh:Jn,NormalBlending:Gs,ShaderMaterial:sa,TubeGeometry:Q4,Vector3:re},cAe=RA.default||RA,_I=Ss({props:{arcsData:{default:[]},arcStartLat:{default:"startLat"},arcStartLng:{default:"startLng"},arcEndLat:{default:"endLat"},arcEndLng:{default:"endLng"},arcColor:{default:function(){return"#ffffaa"}},arcAltitude:{},arcAltitudeAutoScale:{default:.5},arcStroke:{},arcCurveResolution:{default:64,triggerUpdate:!1},arcCircularResolution:{default:6,triggerUpdate:!1},arcDashLength:{default:1},arcDashGap:{default:0},arcDashInitialGap:{default:0},arcDashAnimateTime:{default:0},arcsTransitionDuration:{default:1e3,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;e.sharedMaterial.dispose(),(t=e.ticker)===null||t===void 0||t.dispose()}},stateInit:function(e){var t=e.tweenGroup;return{tweenGroup:t,ticker:new cAe,sharedMaterial:new pa.ShaderMaterial(fi(fi({},gI()),{},{transparent:!0,blending:pa.NormalBlending}))}},init:function(e,t){Ti(e),t.scene=e,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjArc"}).onCreateObj(function(){var i=new pa.Group;return i.__globeObjType="arc",i}),t.ticker.onTick.add(function(i,r){t.dataMapper.entries().map(function(s){var o=qi(s,2),a=o[1];return a}).filter(function(s){return s.children.length&&s.children[0].material&&s.children[0].__dashAnimateStep}).forEach(function(s){var o=s.children[0],a=o.__dashAnimateStep*r,l=o.material.uniforms.dashTranslate.value%1e9;o.material.uniforms.dashTranslate.value=l+a})})},update:function(e){var t=ft(e.arcStartLat),i=ft(e.arcStartLng),r=ft(e.arcEndLat),s=ft(e.arcEndLng),o=ft(e.arcAltitude),a=ft(e.arcAltitudeAutoScale),l=ft(e.arcStroke),u=ft(e.arcColor),A=ft(e.arcDashLength),p=ft(e.arcDashGap),g=ft(e.arcDashInitialGap),v=ft(e.arcDashAnimateTime);e.dataMapper.onUpdateObj(function(S,C){var E=l(C),R=E!=null;if(!S.children.length||R!==(S.children[0].type==="Mesh")){Ti(S);var D=R?new pa.Mesh:new pa.Line(new pa.BufferGeometry);D.material=e.sharedMaterial.clone(),S.add(D)}var B=S.children[0];Object.assign(B.material.uniforms,{dashSize:{value:A(C)},gapSize:{value:p(C)},dashOffset:{value:g(C)}});var L=v(C);B.__dashAnimateStep=L>0?1e3/L:0;var U=b(u(C),e.arcCurveResolution,R?e.arcCircularResolution+1:1),P=w(e.arcCurveResolution,R?e.arcCircularResolution+1:1,!0);B.geometry.setAttribute("color",U),B.geometry.setAttribute("relDistance",P);var F=function(J){var Z=S.__currentTargetD=J,W=Z.stroke,K=Qfe(Z,uAe),ee=y(K);R?(B.geometry&&B.geometry.dispose(),B.geometry=new pa.TubeGeometry(ee,e.arcCurveResolution,W/2,e.arcCircularResolution),B.geometry.setAttribute("color",U),B.geometry.setAttribute("relDistance",P)):B.geometry.setFromPoints(ee.getPoints(e.arcCurveResolution))},V={stroke:E,alt:o(C),altAutoScale:+a(C),startLat:+t(C),startLng:+i(C),endLat:+r(C),endLng:+s(C)},H=S.__currentTargetD||Object.assign({},V,{altAutoScale:-.001});Object.keys(V).some(function(j){return H[j]!==V[j]})&&(!e.arcsTransitionDuration||e.arcsTransitionDuration<0?F(V):e.tweenGroup.add(new Uo(H).to(V,e.arcsTransitionDuration).easing(rs.Quadratic.InOut).onUpdate(F).start()))}).digest(e.arcsData);function y(S){var C=S.alt,E=S.altAutoScale,R=S.startLat,D=S.startLng,B=S.endLat,L=S.endLng,U=function(de){var Ae=qi(de,3),Be=Ae[0],ye=Ae[1],De=Ae[2],We=ua(ye,Be,De),$e=We.x,Ke=We.y,Xe=We.z;return new pa.Vector3($e,Ke,Xe)},P=[D,R],F=[L,B],V=C;if(V==null&&(V=ec(P,F)/2*E),V){var H=lb(P,F),j=[.25,.75].map(function(ge){return[].concat(_i(H(ge)),[V*1.5])}),J=qi(j,2),Z=J[0],W=J[1],K=I5(pa.CubicBezierCurve3,_i([P,Z,W,F].map(U)));return K}else{var ee=.001;return se.apply(void 0,_i([[].concat(P,[ee]),[].concat(F,[ee])].map(U)))}function se(ge,de){var Ae=ge.angleTo(de),Be=Ae===0?function(){return ge.clone()}:function(De){return new pa.Vector3().addVectors(ge.clone().multiplyScalar(Math.sin((1-De)*Ae)),de.clone().multiplyScalar(Math.sin(De*Ae))).divideScalar(Math.sin(Ae))},ye=new pa.Curve;return ye.getPoint=Be,ye}}function b(S,C){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,R=C+1,D;if(S instanceof Array||S instanceof Function){var B=S instanceof Array?tu().domain(S.map(function(j,J){return J/(S.length-1)})).range(S):S;D=function(J){return tc(B(J),!0,!0)}}else{var L=tc(S,!0,!0);D=function(){return L}}for(var U=[],P=0,F=R;P<F;P++)for(var V=D(P/(F-1)),H=0;H<E;H++)U.push(V);return yl(U,4)}function w(S){for(var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,R=S+1,D=[],B=0,L=R;B<L;B++)for(var U=B/(L-1),P=0;P<C;P++)D.push(U);return E&&D.reverse(),yl(D,1)}}}),Pu=window.THREE?window.THREE:{BufferGeometry:pi,DoubleSide:ar,Mesh:Jn,MeshLambertMaterial:Tl,Object3D:ki},NM=Object.assign({},Ab),PM=NM.BufferGeometryUtils||NM,vI=Ss({props:{hexBinPointsData:{default:[]},hexBinPointLat:{default:"lat"},hexBinPointLng:{default:"lng"},hexBinPointWeight:{default:1},hexBinResolution:{default:4},hexMargin:{default:.2},hexTopCurvatureResolution:{default:5},hexTopColor:{default:function(){return"#ffffaa"}},hexSideColor:{default:function(){return"#ffffaa"}},hexAltitude:{default:function(e){var t=e.sumWeight;return t*.01}},hexBinMerge:{default:!1},hexTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;Ti(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjHexbin"})},update:function(e,t){var i=ft(e.hexBinPointLat),r=ft(e.hexBinPointLng),s=ft(e.hexBinPointWeight),o=ft(e.hexAltitude),a=ft(e.hexTopColor),l=ft(e.hexSideColor),u=ft(e.hexMargin),A=jte(e.hexBinPointsData.map(function(C){return fi(fi({},C),{},{h3Idx:Cne(i(C),r(C),e.hexBinResolution)})}),"h3Idx"),p=Object.entries(A).map(function(C){var E=qi(C,2),R=E[0],D=E[1];return{h3Idx:R,points:D,sumWeight:D.reduce(function(B,L){return B+ +s(L)},0)}}),g={};if(!e.hexBinMerge&&t.hasOwnProperty("hexBinMerge")&&Ti(e.scene),e.dataMapper.scene=e.hexBinMerge?new Pu.Object3D:e.scene,e.dataMapper.id(function(C){return C.h3Idx}).onCreateObj(w).onUpdateObj(S).digest(p),e.hexBinMerge){var v=p.length?(PM.mergeGeometries||PM.mergeBufferGeometries)(p.map(function(C){var E=e.dataMapper.getObj(C),R=E.geometry.toNonIndexed();E.updateMatrix(),R.applyMatrix4(E.matrix);var D=tc(a(C)),B=tc(l(C)),L=R.getAttribute("position").count,U=R.groups[0].count;return R.setAttribute("color",yl(_i(new Array(L)).map(function(P,F){return F>=U?D:B}),4)),R})):new Pu.BufferGeometry,y=new Pu.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0,side:Pu.DoubleSide});y.onBeforeCompile=function(C){y.userData.shader=Qx(C)};var b=new Pu.Mesh(v,y);b.__globeObjType="hexBinPoints",b.__data=p,e.dataMapper.clear(),Ti(e.scene),e.scene.add(b)}function w(C){var E=new Pu.Mesh;E.__hexCenter=gR(C.h3Idx),E.__hexGeoJson=_R(C.h3Idx,!0).reverse();var R=E.__hexCenter[1];return E.__hexGeoJson.forEach(function(D){var B=D[0];Math.abs(R-B)>170&&(D[0]+=R>B?360:-360)}),E.__globeObjType="hexbin",E}function S(C,E){var R=function(K,ee,se){return K-(K-ee)*se},D=Math.max(0,Math.min(1,+u(E))),B=qi(C.__hexCenter,2),L=B[0],U=B[1],P=D===0?C.__hexGeoJson:C.__hexGeoJson.map(function(W){var K=qi(W,2),ee=K[0],se=K[1];return[[ee,U],[se,L]].map(function(ge){var de=qi(ge,2),Ae=de[0],Be=de[1];return R(Ae,Be,D)})}),F=e.hexTopCurvatureResolution;C.geometry&&C.geometry.dispose(),C.geometry=new _b([P],0,Oi,!1,!0,!0,F);var V={alt:+o(E)},H=function(K){var ee=C.__currentTargetD=K,se=ee.alt;C.scale.x=C.scale.y=C.scale.z=1+se;var ge=Oi/(se+1);C.geometry.setAttribute("surfaceRadius",yl(Array(C.geometry.getAttribute("position").count).fill(ge),1))},j=C.__currentTargetD||Object.assign({},V,{alt:-.001});if(Object.keys(V).some(function(W){return j[W]!==V[W]})&&(e.hexBinMerge||!e.hexTransitionDuration||e.hexTransitionDuration<0?H(V):e.tweenGroup.add(new Uo(j).to(V,e.hexTransitionDuration).easing(rs.Quadratic.InOut).onUpdate(H).start())),!e.hexBinMerge){var J=l(E),Z=a(E);[J,Z].forEach(function(W){if(!g.hasOwnProperty(W)){var K=Ra(W);g[W]=U5(new Pu.MeshLambertMaterial({color:vl(W),transparent:K<1,opacity:K,side:Pu.DoubleSide}),Qx)}}),C.material=[J,Z].map(function(W){return g[W]})}}}}),yI=function(e){return e*e},Wl=function(e){return e*Math.PI/180};function hAe(n,e){var t=Math.sqrt,i=Math.cos,r=function(A){return yI(Math.sin(A/2))},s=Wl(n[1]),o=Wl(e[1]),a=Wl(n[0]),l=Wl(e[0]);return 2*Math.asin(t(r(o-s)+i(s)*i(o)*r(l-a)))}var fAe=Math.sqrt(2*Math.PI);function AAe(n,e){return Math.exp(-yI(n/e)/2)/(e*fAe)}var dAe=function(e){var t=qi(e,2),i=t[0],r=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.lngAccessor,l=a===void 0?function(w){return w[0]}:a,u=o.latAccessor,A=u===void 0?function(w){return w[1]}:u,p=o.weightAccessor,g=p===void 0?function(){return 1}:p,v=o.bandwidth,y=[i,r],b=v*Math.PI/180;return HY(s.map(function(w){var S=g(w);if(!S)return 0;var C=hAe(y,[l(w),A(w)]);return AAe(C,b)*S}))},pAe=function(){var n=qfe(jx().mark(function e(t){var i,r,s,o,a,l,u,A,p,g,v,y,b,w,S,C,E,R,D,B,L,U,P,F,V,H,j,J,Z,W,K,ee,se,ge,de,Ae,Be,ye,De,We,$e=arguments;return jx().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:if(r=$e.length>1&&$e[1]!==void 0?$e[1]:[],s=$e.length>2&&$e[2]!==void 0?$e[2]:{},o=s.lngAccessor,a=o===void 0?function(st){return st[0]}:o,l=s.latAccessor,u=l===void 0?function(st){return st[1]}:l,A=s.weightAccessor,p=A===void 0?function(){return 1}:A,g=s.bandwidth,(i=navigator)!==null&&i!==void 0&&i.gpu){Xe.next=5;break}return console.warn("WebGPU not enabled in browser. Please consider enabling it to improve performance."),Xe.abrupt("return",t.map(function(st){return dAe(st,r,{lngAccessor:a,latAccessor:u,weightAccessor:p,bandwidth:g})}));case 5:return v=4,y=_fe,b=vfe,w=Nfe,S=Rfe,C=Sfe,E=wfe,R=yfe,D=Cfe,B=Efe,L=bfe,U=xfe,P=Tfe,F=Mfe,V=S(new eg(new Float32Array(t.flat().map(Wl)),2),"vec2",t.length),H=S(new eg(new Float32Array(r.map(function(st){return[Wl(a(st)),Wl(u(st)),p(st)]}).flat()),3),"vec3",r.length),j=new eg(t.length,1),J=S(j,"float",t.length),Z=C(Math.PI),W=D(Z.mul(2)),K=function(gt){return gt.mul(gt)},ee=function(gt){return K(B(gt.div(2)))},se=function(gt,ae){var le=C(gt[1]),G=C(ae[1]),Te=C(gt[0]),pe=C(ae[0]);return C(2).mul(U(D(ee(G.sub(le)).add(L(le).mul(L(G)).mul(ee(pe.sub(Te)))))))},ge=function(gt,ae){return P(F(K(gt.div(ae)).div(2))).div(ae.mul(W))},de=w(Wl(g)),Ae=w(Wl(g*v)),Be=w(r.length),ye=y(function(){var st=V.element(E),gt=J.element(E);gt.assign(0),R(Be,function(ae){var le=ae.i,G=H.element(le),Te=G.z;b(Te,function(){var pe=se(G.xy,st.xy);b(pe&&pe.lessThan(Ae),function(){gt.addAssign(ge(pe,de).mul(Te))})})})}),De=ye().compute(t.length),We=new gfe,Xe.next=25,We.computeAsync(De);case 25:return Xe.t0=Array,Xe.t1=Float32Array,Xe.next=29,We.getArrayBufferAsync(j);case 29:return Xe.t2=Xe.sent,Xe.t3=new Xe.t1(Xe.t2),Xe.abrupt("return",Xe.t0.from.call(Xe.t0,Xe.t3));case 32:case"end":return Xe.stop()}},e)}));return function(t){return n.apply(this,arguments)}}(),y1=window.THREE?window.THREE:{Mesh:Jn,MeshLambertMaterial:Tl,SphereGeometry:Fa},mAe=3.5,gAe=.1,LM=100,_Ae=function(e){var t=_h(Nne(e));return t.opacity=Math.cbrt(e),t.formatRgb()},xI=Ss({props:{heatmapsData:{default:[]},heatmapPoints:{default:function(e){return e}},heatmapPointLat:{default:function(e){return e[0]}},heatmapPointLng:{default:function(e){return e[1]}},heatmapPointWeight:{default:1},heatmapBandwidth:{default:2.5},heatmapColorFn:{default:function(){return _Ae}},heatmapColorSaturation:{default:1.5},heatmapBaseAltitude:{default:.01},heatmapTopAltitude:{},heatmapsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;Ti(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjHeatmap"}).onCreateObj(function(){var s=new y1.Mesh(new y1.SphereGeometry(Oi),U5(new y1.MeshLambertMaterial({vertexColors:!0,transparent:!0}),aAe));return s.__globeObjType="heatmap",s})},update:function(e){var t=ft(e.heatmapPoints),i=ft(e.heatmapPointLat),r=ft(e.heatmapPointLng),s=ft(e.heatmapPointWeight),o=ft(e.heatmapBandwidth),a=ft(e.heatmapColorFn),l=ft(e.heatmapColorSaturation),u=ft(e.heatmapBaseAltitude),A=ft(e.heatmapTopAltitude);e.dataMapper.onUpdateObj(function(p,g){var v=o(g),y=a(g),b=l(g),w=u(g),S=A(g),C=t(g).map(function(L){var U=i(L),P=r(L),F=ua(U,P),V=F.x,H=F.y,j=F.z;return{x:V,y:H,z:j,lat:U,lng:P,weight:s(L)}}),E=Math.max(gAe,v/mAe),R=Math.ceil(360/(E||-1));p.geometry.parameters.widthSegments!==R&&(p.geometry.dispose(),p.geometry=new y1.SphereGeometry(Oi,R,R/2));var D=oAe(p.geometry.getAttribute("position")),B=D.map(function(L){var U=qi(L,3),P=U[0],F=U[1],V=U[2],H=dI({x:P,y:F,z:V}),j=H.lng,J=H.lat;return[j,J]});pAe(B,C,{latAccessor:function(U){return U.lat},lngAccessor:function(U){return U.lng},weightAccessor:function(U){return U.weight},bandwidth:v}).then(function(L){var U=_i(new Array(LM)).map(function(H,j){return tc(y(j/(LM-1)))}),P=function(j){var J=p.__currentTargetD=j,Z=J.kdeVals,W=J.topAlt,K=J.saturation,ee=zY(Z.map(Math.abs))||1e-15,se=_C([0,ee/K],U);p.geometry.setAttribute("color",yl(Z.map(function(de){return se(Math.abs(de))}),4));var ge=tu([0,ee],[Oi*(1+w),Oi*(1+(W||w))]);p.geometry.setAttribute("r",yl(Z.map(ge)))},F={kdeVals:L,topAlt:S,saturation:b},V=p.__currentTargetD||Object.assign({},F,{kdeVals:L.map(function(){return 0}),topAlt:S&&w,saturation:.5});V.kdeVals.length!==L.length&&(V.kdeVals=L.slice()),Object.keys(F).some(function(H){return V[H]!==F[H]})&&(!e.heatmapsTransitionDuration||e.heatmapsTransitionDuration<0?P(F):e.tweenGroup.add(new Uo(V).to(F,e.heatmapsTransitionDuration).easing(rs.Quadratic.InOut).onUpdate(P).start()))})}).digest(e.heatmapsData)}}),Lu=window.THREE?window.THREE:{DoubleSide:ar,Group:vs,LineBasicMaterial:Sh,LineSegments:N9,Mesh:Jn,MeshBasicMaterial:va},bI=Ss({props:{polygonsData:{default:[]},polygonGeoJsonGeometry:{default:"geometry"},polygonSideColor:{default:function(){return"#ffffaa"}},polygonSideMaterial:{},polygonCapColor:{default:function(){return"#ffffaa"}},polygonCapMaterial:{},polygonStrokeColor:{},polygonAltitude:{default:.01},polygonCapCurvatureResolution:{default:5},polygonsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;Ti(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjPolygon"}).id(function(s){return s.id}).onCreateObj(function(){var s=new Lu.Group;return s.__defaultSideMaterial=U5(new Lu.MeshBasicMaterial({side:Lu.DoubleSide,depthWrite:!0}),Qx),s.__defaultCapMaterial=new Lu.MeshBasicMaterial({side:Lu.DoubleSide,depthWrite:!0}),s.add(new Lu.Mesh(void 0,[s.__defaultSideMaterial,s.__defaultCapMaterial])),s.add(new Lu.LineSegments(void 0,new Lu.LineBasicMaterial)),s.__globeObjType="polygon",s})},update:function(e){var t=ft(e.polygonGeoJsonGeometry),i=ft(e.polygonAltitude),r=ft(e.polygonCapCurvatureResolution),s=ft(e.polygonCapColor),o=ft(e.polygonCapMaterial),a=ft(e.polygonSideColor),l=ft(e.polygonSideMaterial),u=ft(e.polygonStrokeColor),A=[];e.polygonsData.forEach(function(p){var g={data:p,capColor:s(p),capMaterial:o(p),sideColor:a(p),sideMaterial:l(p),strokeColor:u(p),altitude:+i(p),capCurvatureResolution:+r(p)},v=t(p),y=p.__id||"".concat(Math.round(Math.random()*1e9));p.__id=y,v.type==="Polygon"?A.push(fi({id:"".concat(y,"_0"),coords:v.coordinates},g)):v.type==="MultiPolygon"?A.push.apply(A,_i(v.coordinates.map(function(b,w){return fi({id:"".concat(y,"_").concat(w),coords:b},g)}))):console.warn("Unsupported GeoJson geometry type: ".concat(v.type,". Skipping geometry..."))}),e.dataMapper.onUpdateObj(function(p,g){var v=g.coords,y=g.capColor,b=g.capMaterial,w=g.sideColor,S=g.sideMaterial,C=g.strokeColor,E=g.altitude,R=g.capCurvatureResolution,D=qi(p.children,2),B=D[0],L=D[1],U=!!C;L.visible=U;var P=!!(y||b),F=!!(w||S);vAe(B.geometry.parameters||{},{polygonGeoJson:v,curvatureResolution:R,closedTop:P,includeSides:F})||(B.geometry&&B.geometry.dispose(),B.geometry=new _b(v,0,Oi,!1,P,F,R)),U&&(!L.geometry.parameters||L.geometry.parameters.geoJson.coordinates!==v||L.geometry.parameters.resolution!==R)&&(L.geometry&&L.geometry.dispose(),L.geometry=new KC({type:"Polygon",coordinates:v},Oi,R));var V=F?0:-1,H=P?F?1:0:-1;if(V>=0&&(B.material[V]=S||p.__defaultSideMaterial),H>=0&&(B.material[H]=b||p.__defaultCapMaterial),[[!S&&w,V],[!b&&y,H]].forEach(function(ee){var se=qi(ee,2),ge=se[0],de=se[1];if(!(!ge||de<0)){var Ae=B.material[de],Be=Ra(ge);Ae.color.set(vl(ge)),Ae.transparent=Be<1,Ae.opacity=Be}}),U){var j=L.material,J=Ra(C);j.color.set(vl(C)),j.transparent=J<1,j.opacity=J}var Z={alt:E},W=function(se){var ge=p.__currentTargetD=se,de=ge.alt;B.scale.x=B.scale.y=B.scale.z=1+de,U&&(L.scale.x=L.scale.y=L.scale.z=1+de+1e-4),lAe(p.__defaultSideMaterial,function(Ae){return Ae.surfaceRadius.value=Oi/(de+1)})},K=p.__currentTargetD||Object.assign({},Z,{alt:-.001});Object.keys(Z).some(function(ee){return K[ee]!==Z[ee]})&&(!e.polygonsTransitionDuration||e.polygonsTransitionDuration<0||K.alt===Z.alt?W(Z):e.tweenGroup.add(new Uo(K).to(Z,e.polygonsTransitionDuration).easing(rs.Quadratic.InOut).onUpdate(W).start()))}).digest(A)}});function vAe(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return function(i,r){return i===r}};return Object.entries(e).every(function(i){var r=qi(i,2),s=r[0],o=r[1];return n.hasOwnProperty(s)&&t(s)(n[s],o)})}var _f=window.THREE?window.THREE:{BufferGeometry:pi,DoubleSide:ar,Mesh:Jn,MeshLambertMaterial:Tl,Vector3:re},DM=Object.assign({},Ab),IM=DM.BufferGeometryUtils||DM,TI=Ss({props:{hexPolygonsData:{default:[]},hexPolygonGeoJsonGeometry:{default:"geometry"},hexPolygonColor:{default:function(){return"#ffffaa"}},hexPolygonAltitude:{default:.001},hexPolygonResolution:{default:3},hexPolygonMargin:{default:.2},hexPolygonUseDots:{default:!1},hexPolygonCurvatureResolution:{default:5},hexPolygonDotResolution:{default:12},hexPolygonsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;Ti(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjHexPolygon"}).onCreateObj(function(){var s=new _f.Mesh(void 0,new _f.MeshLambertMaterial({side:_f.DoubleSide}));return s.__globeObjType="hexPolygon",s})},update:function(e){var t=ft(e.hexPolygonGeoJsonGeometry),i=ft(e.hexPolygonColor),r=ft(e.hexPolygonAltitude),s=ft(e.hexPolygonResolution),o=ft(e.hexPolygonMargin),a=ft(e.hexPolygonUseDots),l=ft(e.hexPolygonCurvatureResolution),u=ft(e.hexPolygonDotResolution);e.dataMapper.onUpdateObj(function(A,p){var g=t(p),v=s(p),y=r(p),b=Math.max(0,Math.min(1,+o(p))),w=a(p),S=l(p),C=u(p),E=i(p),R=Ra(E);A.material.color.set(vl(E)),A.material.transparent=R<1,A.material.opacity=R;var D={alt:y,margin:b,curvatureResolution:S},B={geoJson:g,h3Res:v},L=A.__currentTargetD||Object.assign({},D,{alt:-.001}),U=A.__currentMemD||B;if(Object.keys(D).some(function(H){return L[H]!==D[H]})||Object.keys(B).some(function(H){return U[H]!==B[H]})){A.__currentMemD=B;var P=[];g.type==="Polygon"?nw(g.coordinates,v,!0).forEach(function(H){return P.push(H)}):g.type==="MultiPolygon"?g.coordinates.forEach(function(H){return nw(H,v,!0).forEach(function(j){return P.push(j)})}):console.warn("Unsupported GeoJson geometry type: ".concat(g.type,". Skipping geometry..."));var F=P.map(function(H){var j=gR(H),J=_R(H,!0).reverse(),Z=j[1];return J.forEach(function(W){var K=W[0];Math.abs(Z-K)>170&&(W[0]+=Z>K?360:-360)}),{h3Idx:H,hexCenter:j,hexGeoJson:J}}),V=function(j){var J=A.__currentTargetD=j,Z=J.alt,W=J.margin,K=J.curvatureResolution;A.geometry&&A.geometry.dispose(),A.geometry=F.length?(IM.mergeGeometries||IM.mergeBufferGeometries)(F.map(function(ee){var se=qi(ee.hexCenter,2),ge=se[0],de=se[1];if(w){var Ae=ua(ge,de,Z),Be=ua(ee.hexGeoJson[0][1],ee.hexGeoJson[0][0],Z),ye=.85*(1-W)*new _f.Vector3(Ae.x,Ae.y,Ae.z).distanceTo(new _f.Vector3(Be.x,Be.y,Be.z)),De=new F2(ye,C);return De.rotateX(Wc(-ge)),De.rotateY(Wc(de)),De.translate(Ae.x,Ae.y,Ae.z),De}else{var We=function(Xe,st,gt){return Xe-(Xe-st)*gt},$e=W===0?ee.hexGeoJson:ee.hexGeoJson.map(function(Ke){var Xe=qi(Ke,2),st=Xe[0],gt=Xe[1];return[[st,de],[gt,ge]].map(function(ae){var le=qi(ae,2),G=le[0],Te=le[1];return We(G,Te,W)})});return new _b([$e],Oi,Oi*(1+Z),!1,!0,!1,K)}})):new _f.BufferGeometry};!e.hexPolygonsTransitionDuration||e.hexPolygonsTransitionDuration<0?V(D):e.tweenGroup.add(new Uo(L).to(D,e.hexPolygonsTransitionDuration).easing(rs.Quadratic.InOut).onUpdate(V).start())}}).digest(e.hexPolygonsData)}}),yAe=window.THREE?window.THREE:{Vector3:re};function xAe(n,e){var t=function(o,a){var l=o[o.length-1];return[].concat(_i(o),_i(Array(a-o.length).fill(l)))},i=Math.max(n.length,e.length),r=oZ.apply(void 0,_i([n,e].map(function(s){return s.map(function(o){var a=o.x,l=o.y,u=o.z;return[a,l,u]})}).map(function(s){return t(s,i)})));return function(s){return s===0?n:s===1?e:r(s).map(function(o){var a=qi(o,3),l=a[0],u=a[1],A=a[2];return new yAe.Vector3(l,u,A)})}}var Bc=window.THREE?window.THREE:{BufferGeometry:pi,Color:Gt,Group:vs,Line:Tp,NormalBlending:Gs,ShaderMaterial:sa,Vector3:re},bAe=RA.default||RA,SI=Ss({props:{pathsData:{default:[]},pathPoints:{default:function(e){return e}},pathPointLat:{default:function(e){return e[0]}},pathPointLng:{default:function(e){return e[1]}},pathPointAlt:{default:.001},pathResolution:{default:2},pathColor:{default:function(){return"#ffffaa"}},pathStroke:{},pathDashLength:{default:1},pathDashGap:{default:0},pathDashInitialGap:{default:0},pathDashAnimateTime:{default:0},pathTransitionDuration:{default:1e3,triggerUpdate:!1},rendererSize:{}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},stateInit:function(e){var t=e.tweenGroup;return{tweenGroup:t,ticker:new bAe,sharedMaterial:new Bc.ShaderMaterial(fi(fi({},gI()),{},{transparent:!0,blending:Bc.NormalBlending}))}},init:function(e,t){Ti(e),t.scene=e,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjPath"}).onCreateObj(function(){var i=new Bc.Group;return i.__globeObjType="path",i}),t.ticker.onTick.add(function(i,r){t.dataMapper.entries().map(function(s){var o=qi(s,2),a=o[1];return a}).filter(function(s){return s.children.length&&s.children[0].material&&s.children[0].__dashAnimateStep}).forEach(function(s){var o=s.children[0],a=o.__dashAnimateStep*r;if(o.type==="Line"){var l=o.material.uniforms.dashTranslate.value%1e9;o.material.uniforms.dashTranslate.value=l+a}else if(o.type==="Line2"){for(var u=o.material.dashOffset-a,A=o.material.dashSize+o.material.gapSize;u<=-A;)u+=A;o.material.dashOffset=u}})})},update:function(e){var t=ft(e.pathPoints),i=ft(e.pathPointLat),r=ft(e.pathPointLng),s=ft(e.pathPointAlt),o=ft(e.pathStroke),a=ft(e.pathColor),l=ft(e.pathDashLength),u=ft(e.pathDashGap),A=ft(e.pathDashInitialGap),p=ft(e.pathDashAnimateTime);e.dataMapper.onUpdateObj(function(w,S){var C=o(S),E=C!=null;if(!w.children.length||E===(w.children[0].type==="Line")){Ti(w);var R=E?new Ife(new uI,new D5):new Bc.Line(new Bc.BufferGeometry,e.sharedMaterial.clone());w.add(R)}var D=w.children[0],B=v(t(S),i,r,s,e.pathResolution),L=p(S);if(D.__dashAnimateStep=L>0?1e3/L:0,E){D.material.resolution=e.rendererSize;{var F=l(S),V=u(S),H=A(S);D.material.dashed=V>0,D.material.dashed?D.material.defines.USE_DASH="":delete D.material.defines.USE_DASH,D.material.dashed&&(D.material.dashScale=1/g(B),D.material.dashSize=F,D.material.gapSize=V,D.material.dashOffset=-H)}{var j=a(S);if(j instanceof Array){var J=y(a(S),B.length-1,1,!1);D.geometry.setColors(J.array),D.material.vertexColors=!0}else{var Z=j,W=Ra(Z);D.material.color=new Bc.Color(vl(Z)),D.material.transparent=W<1,D.material.opacity=W,D.material.vertexColors=!1}}D.material.needsUpdate=!0}else{Object.assign(D.material.uniforms,{dashSize:{value:l(S)},gapSize:{value:u(S)},dashOffset:{value:A(S)}});var U=y(a(S),B.length),P=b(B.length,1,!0);D.geometry.setAttribute("color",U),D.geometry.setAttribute("relDistance",P)}var K=xAe(w.__currentTargetD&&w.__currentTargetD.points||[B[0]],B),ee=function(Ae){var Be=w.__currentTargetD=Ae,ye=Be.stroke,De=Be.interpolK,We=w.__currentTargetD.points=K(De);if(E){var $e;D.geometry.setPositions(($e=[]).concat.apply($e,_i(We.map(function(Ke){var Xe=Ke.x,st=Ke.y,gt=Ke.z;return[Xe,st,gt]})))),D.material.linewidth=ye,D.material.dashed&&D.computeLineDistances()}else D.geometry.setFromPoints(We),D.geometry.computeBoundingSphere()},se={stroke:C,interpolK:1},ge=Object.assign({},w.__currentTargetD||se,{interpolK:0});Object.keys(se).some(function(de){return ge[de]!==se[de]})&&(!e.pathTransitionDuration||e.pathTransitionDuration<0?ee(se):e.tweenGroup.add(new Uo(ge).to(se,e.pathTransitionDuration).easing(rs.Quadratic.InOut).onUpdate(ee).start()))}).digest(e.pathsData);function g(w){var S=0,C;return w.forEach(function(E){C&&(S+=C.distanceTo(E)),C=E}),S}function v(w,S,C,E,R){var D=function(P,F,V){for(var H=[],j=1;j<=V;j++)H.push(P+(F-P)*j/(V+1));return H},B=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,V=[],H=null;return P.forEach(function(j){if(H){for(;Math.abs(H[1]-j[1])>180;)H[1]+=360*(H[1]<j[1]?1:-1);var J=Math.sqrt(Math.pow(j[0]-H[0],2)+Math.pow(j[1]-H[1],2));if(J>F)for(var Z=Math.floor(J/F),W=D(H[0],j[0],Z),K=D(H[1],j[1],Z),ee=D(H[2],j[2],Z),se=0,ge=W.length;se<ge;se++)V.push([W[se],K[se],ee[se]])}V.push(H=j)}),V},L=function(P){var F=qi(P,3),V=F[0],H=F[1],j=F[2],J=ua(V,H,j),Z=J.x,W=J.y,K=J.z;return new Bc.Vector3(Z,W,K)};return B(w.map(function(U){return[S(U),C(U),E(U)]}),R).map(L)}function y(w,S){var C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,R=S+1,D;if(w instanceof Array||w instanceof Function){var B=w instanceof Array?tu().domain(w.map(function(j,J){return J/(w.length-1)})).range(w):w;D=function(J){return tc(B(J),E,!0)}}else{var L=tc(w,E,!0);D=function(){return L}}for(var U=[],P=0,F=R;P<F;P++)for(var V=D(P/(F-1)),H=0;H<C;H++)U.push(V);return yl(U,E?4:3)}function b(w){for(var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=w+1,R=[],D=0,B=E;D<B;D++)for(var L=D/(B-1),U=0;U<S;U++)R.push(L);return C&&R.reverse(),yl(R,1)}}}),x1=window.THREE?window.THREE:{Euler:jr,Mesh:Jn,MeshLambertMaterial:Tl,SphereGeometry:Fa},wI=Ss({props:{tilesData:{default:[]},tileLat:{default:"lat"},tileLng:{default:"lng"},tileAltitude:{default:.01},tileWidth:{default:1},tileHeight:{default:1},tileUseGlobeProjection:{default:!0},tileMaterial:{default:function(){return new x1.MeshLambertMaterial({color:"#ffbb88",opacity:.4,transparent:!0})}},tileCurvatureResolution:{default:5},tilesTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;Ti(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjTile"}).onCreateObj(function(){var s=new x1.Mesh;return s.__globeObjType="tile",s})},update:function(e){var t=ft(e.tileLat),i=ft(e.tileLng),r=ft(e.tileAltitude),s=ft(e.tileWidth),o=ft(e.tileHeight),a=ft(e.tileUseGlobeProjection),l=ft(e.tileMaterial),u=ft(e.tileCurvatureResolution);e.dataMapper.onUpdateObj(function(A,p){A.material=l(p);var g=a(p),v=u(p),y=function(C){var E=A.__currentTargetD=C,R=E.lat,D=E.lng,B=E.alt,L=E.width,U=E.height,P=vf(D),F=vf(-R);A.geometry&&A.geometry.dispose(),A.geometry=new x1.SphereGeometry(Oi*(1+B),Math.ceil(L/(v||-1)),Math.ceil(U/(v||-1)),vf(90-L/2)+(g?P:0),vf(L),vf(90-U/2)+(g?F:0),vf(U)),g||A.setRotationFromEuler(new x1.Euler(F,P,0,"YXZ"))},b={lat:+t(p),lng:+i(p),alt:+r(p),width:+s(p),height:+o(p)},w=A.__currentTargetD||Object.assign({},b,{width:0,height:0});Object.keys(b).some(function(S){return w[S]!==b[S]})&&(!e.tilesTransitionDuration||e.tilesTransitionDuration<0?y(b):e.tweenGroup.add(new Uo(w).to(b,e.tilesTransitionDuration).easing(rs.Quadratic.InOut).onUpdate(y).start()))}).digest(e.tilesData)}}),vf=function(e){return e*Math.PI/180},I0=window.THREE?window.THREE:{BufferGeometry:pi,Color:Gt,Points:jG,PointsMaterial:W4},MI=Ss({props:{particlesData:{default:[]},particlesList:{default:function(e){return e}},particleLat:{default:"lat"},particleLng:{default:"lng"},particleAltitude:{default:.01},particlesSize:{default:.5},particlesSizeAttenuation:{default:!0},particlesColor:{default:function(){return"white"}},particlesTexture:{}},init:function(e,t){Ti(e),t.scene=e,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjParticles"}).onCreateObj(function(){var i=new I0.Points(new I0.BufferGeometry,new I0.PointsMaterial);return i.__globeObjType="particles",i}).onUpdateObj(function(i,r){var s=ft(t.particlesList),o=ft(t.particleLat),a=ft(t.particleLng),l=ft(t.particleAltitude);i.geometry.setAttribute("position",yl(s(r).map(function(u){return Object.values(ua(o(u),a(u),l(u)))}),3))})},update:function(e,t){["particlesData","particlesList","particleLat","particleLng","particleAltitude"].some(function(a){return t.hasOwnProperty(a)})&&e.dataMapper.digest(e.particlesData);var i=ft(e.particlesColor),r=ft(e.particlesSize),s=ft(e.particlesSizeAttenuation),o=ft(e.particlesTexture);e.dataMapper.entries().forEach(function(a){var l=qi(a,2),u=l[0],A=l[1];if(A.material.size=r(u),A.material.sizeAttenuation=s(u),e.particlesTexture)A.material.color=new I0.Color(16777215),A.material.transparent=!1,A.material.alphaTest=.5,A.material.map=o(u);else{var p=i(u),g=Ra(p);A.material.color=new I0.Color(vl(p)),A.material.transparent=g<1,A.material.opacity=g,A.material.alphaTest=0}})}}),TAe=window.THREE?window.THREE:{BufferGeometry:pi},SAe=function(n){function e(){var t,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32;v_(this,e),t=__(this,e),t.type="CircleLineGeometry",t.parameters={radius:i,segmentCount:r};for(var s=[],o=0;o<=r;o++){var a=(o/r-.25)*Math.PI*2;s.push({x:Math.cos(a)*i,y:Math.sin(a)*i,z:0})}return t.setFromPoints(s),t}return x_(e,n),y_(e)}(TAe.BufferGeometry),yf=window.THREE?window.THREE:{Color:Gt,Group:vs,Line:Tp,LineBasicMaterial:Sh,Vector3:re},wAe=RA.default||RA,EI=Ss({props:{ringsData:{default:[]},ringLat:{default:"lat"},ringLng:{default:"lng"},ringAltitude:{default:.0015},ringColor:{default:function(){return"#ffffaa"},triggerUpdate:!1},ringResolution:{default:64,triggerUpdate:!1},ringMaxRadius:{default:2,triggerUpdate:!1},ringPropagationSpeed:{default:1,triggerUpdate:!1},ringRepeatPeriod:{default:700,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},init:function(e,t,i){var r=i.tweenGroup;Ti(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjRing",removeDelay:3e4}).onCreateObj(function(){var s=new yf.Group;return s.__globeObjType="ring",s}),t.ticker=new wAe,t.ticker.onTick.add(function(s){if(t.ringsData.length){var o=ft(t.ringColor),a=ft(t.ringAltitude),l=ft(t.ringMaxRadius),u=ft(t.ringPropagationSpeed),A=ft(t.ringRepeatPeriod);t.dataMapper.entries().filter(function(p){var g=qi(p,2),v=g[1];return v}).forEach(function(p){var g=qi(p,2),v=g[0],y=g[1];if((y.__nextRingTime||0)<=s){var b=A(v)/1e3;y.__nextRingTime=s+(b<=0?1/0:b);var w=new yf.Line(new SAe(1,t.ringResolution),new yf.LineBasicMaterial),S=o(v),C=S instanceof Array||S instanceof Function,E;C?S instanceof Array?(E=tu().domain(S.map(function(V,H){return H/(S.length-1)})).range(S),w.material.transparent=S.some(function(V){return Ra(V)<1})):(E=S,w.material.transparent=!0):(w.material.color=new yf.Color(vl(S)),sAe(w.material,Ra(S)));var R=Oi*(1+a(v)),D=l(v),B=D*Math.PI/180,L=u(v),U=L<=0,P=function(H){var j=H.t,J=(U?1-j:j)*B;if(w.scale.x=w.scale.y=R*Math.sin(J),w.position.z=R*(1-Math.cos(J)),C){var Z=E(j);w.material.color=new yf.Color(vl(Z)),w.material.transparent&&(w.material.opacity=Ra(Z))}};if(L===0)P({t:0}),y.add(w);else{var F=Math.abs(D/L)*1e3;t.tweenGroup.add(new Uo({t:0}).to({t:1},F).onUpdate(P).onStart(function(){return y.add(w)}).onComplete(function(){y.remove(w),F5(w)}).start())}}})}})},update:function(e){var t=ft(e.ringLat),i=ft(e.ringLng),r=ft(e.ringAltitude),s=e.scene.localToWorld(new yf.Vector3(0,0,0));e.dataMapper.onUpdateObj(function(o,a){var l=t(a),u=i(a),A=r(a);Object.assign(o.position,ua(l,u,A)),o.lookAt(s)}).digest(e.ringsData)}}),MAe={0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"":{x_min:0,x_max:0,ha:853},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},EAe="normal",CAe=1189,RAe=-100,NAe="normal",PAe={yMin:-334,xMin:-111,yMax:1189,xMax:1672},LAe=1e3,DAe={postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) agenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"agenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:`Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r
\r
Permission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r
\r
The above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r
\r
The Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r
\r
This License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r
\r
The Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r
\r
THE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.`,manufacturer_name:"agenta ltd",font_sub_family_name:"Regular"},IAe=-334,BAe="Helvetiker",FAe=1522,UAe=50,OAe={glyphs:MAe,cssFontWeight:EAe,ascender:CAe,underlinePosition:RAe,cssFontStyle:NAe,boundingBox:PAe,resolution:LAe,original_font_information:DAe,descender:IAe,familyName:BAe,lineHeight:FAe,underlineThickness:UAe},ma=fi(fi({},window.THREE?window.THREE:{BoxGeometry:oc,CircleGeometry:F2,DoubleSide:ar,Group:vs,Mesh:Jn,MeshLambertMaterial:Tl,TextGeometry:TM,Vector3:re}),{},{Font:Bfe,TextGeometry:TM}),CI=Ss({props:{labelsData:{default:[]},labelLat:{default:"lat"},labelLng:{default:"lng"},labelAltitude:{default:0},labelText:{default:"text"},labelSize:{default:.5},labelTypeFace:{default:OAe,onChange:function(e,t){t.font=new ma.Font(e)}},labelColor:{default:function(){return"lightgrey"}},labelRotation:{default:0},labelResolution:{default:3},labelIncludeDot:{default:!0},labelDotRadius:{default:.1},labelDotOrientation:{default:function(){return"bottom"}},labelsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;Ti(e),t.scene=e,t.tweenGroup=r;var s=new ma.CircleGeometry(1,32);t.dataMapper=new Ao(e,{objBindAttr:"__threeObjLabel"}).onCreateObj(function(){var o=new ma.MeshLambertMaterial;o.side=ar;var a=new ma.Group;a.add(new ma.Mesh(s,o));var l=new ma.Mesh(void 0,o);a.add(l);var u=new ma.Mesh;return u.visible=!1,l.add(u),a.__globeObjType="label",a})},update:function(e){var t=ft(e.labelLat),i=ft(e.labelLng),r=ft(e.labelAltitude),s=ft(e.labelText),o=ft(e.labelSize),a=ft(e.labelRotation),l=ft(e.labelColor),u=ft(e.labelIncludeDot),A=ft(e.labelDotRadius),p=ft(e.labelDotOrientation),g=new Set(["right","top","bottom"]),v=2*Math.PI*Oi/360;e.dataMapper.onUpdateObj(function(y,b){var w=qi(y.children,2),S=w[0],C=w[1],E=qi(C.children,1),R=E[0],D=l(b),B=Ra(D);C.material.color.set(vl(D)),C.material.transparent=B<1,C.material.opacity=B;var L=u(b),U=p(b);!L||!g.has(U)&&(U="bottom");var P=L?+A(b)*v:1e-12;S.scale.x=S.scale.y=P;var F=+o(b)*v;if(C.geometry&&C.geometry.dispose(),C.geometry=new ma.TextGeometry(s(b),{font:e.font,size:F,depth:0,bevelEnabled:!0,bevelThickness:0,bevelSize:0,curveSegments:e.labelResolution}),R.geometry&&R.geometry.dispose(),C.geometry.computeBoundingBox(),R.geometry=I5(ma.BoxGeometry,_i(new ma.Vector3().subVectors(C.geometry.boundingBox.max,C.geometry.boundingBox.min).toArray())),U!=="right"&&C.geometry.center(),L){var V=P+F/2;U==="right"&&(C.position.x=V),C.position.y={right:-F/2,top:V+F/2,bottom:-V-F/2}[U]}var H=function(W){var K=y.__currentTargetD=W,ee=K.lat,se=K.lng,ge=K.alt,de=K.rot,Ae=K.scale;Object.assign(y.position,ua(ee,se,ge)),y.lookAt(e.scene.localToWorld(new ma.Vector3(0,0,0))),y.rotateY(Math.PI),y.rotateZ(-de*Math.PI/180),y.scale.x=y.scale.y=y.scale.z=Ae},j={lat:+t(b),lng:+i(b),alt:+r(b),rot:+a(b),scale:1},J=y.__currentTargetD||Object.assign({},j,{scale:1e-12});Object.keys(j).some(function(Z){return J[Z]!==j[Z]})&&(!e.labelsTransitionDuration||e.labelsTransitionDuration<0?H(j):e.tweenGroup.add(new Uo(J).to(j,e.labelsTransitionDuration).easing(rs.Quadratic.InOut).onUpdate(H).start()))}).digest(e.labelsData)}}),kAe=fi(fi({},window.THREE?window.THREE:{}),{},{CSS2DObject:Ofe}),RI=Ss({props:{htmlElementsData:{default:[]},htmlLat:{default:"lat"},htmlLng:{default:"lng"},htmlAltitude:{default:0},htmlElement:{},htmlElementVisibilityModifier:{triggerUpdate:!1},htmlTransitionDuration:{default:1e3,triggerUpdate:!1},isBehindGlobe:{onChange:function(){this.updateObjVisibility()},triggerUpdate:!1}},methods:{updateObjVisibility:function(e,t){if(e.dataMapper){var i=t?[t]:e.dataMapper.entries().map(function(r){var s=qi(r,2),o=s[1];return o}).filter(function(r){return r});i.forEach(function(r){var s=!e.isBehindGlobe||!e.isBehindGlobe(r.position);e.htmlElementVisibilityModifier?(r.visible=!0,e.htmlElementVisibilityModifier(r.element,s)):r.visible=s})}}},init:function(e,t,i){var r=i.tweenGroup;Ti(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjHtml"}).onCreateObj(function(s){var o=ft(t.htmlElement)(s),a=new kAe.CSS2DObject(o);return a.__globeObjType="html",a})},update:function(e,t){var i=this,r=ft(e.htmlLat),s=ft(e.htmlLng),o=ft(e.htmlAltitude);t.hasOwnProperty("htmlElement")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(a,l){var u=function(g){var v=a.__currentTargetD=g,y=v.alt,b=v.lat,w=v.lng;Object.assign(a.position,ua(b,w,y)),i.updateObjVisibility(a)},A={lat:+r(l),lng:+s(l),alt:+o(l)};!e.htmlTransitionDuration||e.htmlTransitionDuration<0||!a.__currentTargetD?u(A):e.tweenGroup.add(new Uo(a.__currentTargetD).to(A,e.htmlTransitionDuration).easing(rs.Quadratic.InOut).onUpdate(u).start())}).digest(e.htmlElementsData)}}),b1=window.THREE?window.THREE:{Group:vs,Mesh:Jn,MeshLambertMaterial:Tl,SphereGeometry:Fa},NI=Ss({props:{objectsData:{default:[]},objectLat:{default:"lat"},objectLng:{default:"lng"},objectAltitude:{default:.01},objectFacesSurface:{default:!0},objectRotation:{},objectThreeObject:{default:new b1.Mesh(new b1.SphereGeometry(1,16,8),new b1.MeshLambertMaterial({color:"#ffffaa",transparent:!0,opacity:.7}))}},init:function(e,t){Ti(e),t.scene=e,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjObject"}).onCreateObj(function(i){var r=ft(t.objectThreeObject)(i);t.objectThreeObject===r&&(r=r.clone());var s=new b1.Group;return s.add(r),s.__globeObjType="object",s})},update:function(e,t){var i=ft(e.objectLat),r=ft(e.objectLng),s=ft(e.objectAltitude),o=ft(e.objectFacesSurface),a=ft(e.objectRotation);t.hasOwnProperty("objectThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(l,u){var A=+i(u),p=+r(u),g=+s(u);Object.assign(l.position,ua(A,p,g)),o(u)?l.setRotationFromEuler(new jr(Wc(-A),Wc(p),0,"YXZ")):l.rotation.set(0,0,0);var v=l.children[0],y=a(u);y&&v.setRotationFromEuler(new jr(Wc(y.x||0),Wc(y.y||0),Wc(y.z||0)))}).digest(e.objectsData)}}),PI=Ss({props:{customLayerData:{default:[]},customThreeObject:{},customThreeObjectUpdate:{triggerUpdate:!1}},init:function(e,t){Ti(e),t.scene=e,t.dataMapper=new Ao(e,{objBindAttr:"__threeObjCustom"}).onCreateObj(function(i){var r=ft(t.customThreeObject)(i,Oi);return r&&(t.customThreeObject===r&&(r=r.clone()),r.__globeObjType="custom"),r})},update:function(e,t){e.customThreeObjectUpdate||Ti(e.scene);var i=ft(e.customThreeObjectUpdate);t.hasOwnProperty("customThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj(function(r,s){return i(r,s,Oi)}).digest(e.customLayerData)}}),T1=window.THREE?window.THREE:{Camera:bp,Group:vs,Vector2:rt,Vector3:re},VAe=["globeLayer","pointsLayer","arcsLayer","hexBinLayer","heatmapsLayer","polygonsLayer","hexedPolygonsLayer","pathsLayer","tilesLayer","particlesLayer","ringsLayer","labelsLayer","htmlElementsLayer","objectsLayer","customLayer"],LI=Hs("globeLayer",pI),zAe=Object.assign.apply(Object,_i(["globeImageUrl","bumpImageUrl","globeTileEngineUrl","globeTileEngineMaxLevel","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude"].map(function(n){return Xr({},n,LI.linkProp(n))}))),qAe=Object.assign.apply(Object,_i(["globeMaterial"].map(function(n){return Xr({},n,LI.linkMethod(n))}))),GAe=Hs("pointsLayer",mI),HAe=Object.assign.apply(Object,_i(["pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration"].map(function(n){return Xr({},n,GAe.linkProp(n))}))),WAe=Hs("arcsLayer",_I),$Ae=Object.assign.apply(Object,_i(["arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration"].map(function(n){return Xr({},n,WAe.linkProp(n))}))),jAe=Hs("hexBinLayer",vI),XAe=Object.assign.apply(Object,_i(["hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration"].map(function(n){return Xr({},n,jAe.linkProp(n))}))),QAe=Hs("heatmapsLayer",xI),YAe=Object.assign.apply(Object,_i(["heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration"].map(function(n){return Xr({},n,QAe.linkProp(n))}))),ZAe=Hs("hexedPolygonsLayer",TI),KAe=Object.assign.apply(Object,_i(["hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration"].map(function(n){return Xr({},n,ZAe.linkProp(n))}))),JAe=Hs("polygonsLayer",bI),e0e=Object.assign.apply(Object,_i(["polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration"].map(function(n){return Xr({},n,JAe.linkProp(n))}))),t0e=Hs("pathsLayer",SI),n0e=Object.assign.apply(Object,_i(["pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration"].map(function(n){return Xr({},n,t0e.linkProp(n))}))),i0e=Hs("tilesLayer",wI),r0e=Object.assign.apply(Object,_i(["tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration"].map(function(n){return Xr({},n,i0e.linkProp(n))}))),s0e=Hs("particlesLayer",MI),o0e=Object.assign.apply(Object,_i(["particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture"].map(function(n){return Xr({},n,s0e.linkProp(n))}))),a0e=Hs("ringsLayer",EI),l0e=Object.assign.apply(Object,_i(["ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod"].map(function(n){return Xr({},n,a0e.linkProp(n))}))),u0e=Hs("labelsLayer",CI),c0e=Object.assign.apply(Object,_i(["labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration"].map(function(n){return Xr({},n,u0e.linkProp(n))}))),h0e=Hs("htmlElementsLayer",RI),f0e=Object.assign.apply(Object,_i(["htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration"].map(function(n){return Xr({},n,h0e.linkProp(n))}))),A0e=Hs("objectsLayer",NI),d0e=Object.assign.apply(Object,_i(["objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject"].map(function(n){return Xr({},n,A0e.linkProp(n))}))),p0e=Hs("customLayer",PI),m0e=Object.assign.apply(Object,_i(["customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(n){return Xr({},n,p0e.linkProp(n))}))),g0e=Ss({props:fi(fi(fi(fi(fi(fi(fi(fi(fi(fi(fi(fi(fi(fi(fi({onGlobeReady:{triggerUpdate:!1},rendererSize:{default:new T1.Vector2(window.innerWidth,window.innerHeight),onChange:function(e,t){t.pathsLayer.rendererSize(e)},triggerUpdate:!1}},zAe),HAe),$Ae),XAe),YAe),e0e),KAe),n0e),r0e),o0e),l0e),c0e),f0e),d0e),m0e),methods:fi({getGlobeRadius:MM,getCoords:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return ua.apply(void 0,i)},toGeoCoords:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return dI.apply(void 0,i)},setPointOfView:function(e,t){var i=t instanceof T1.Camera?t.position:t,r=MM(),s=void 0;if(e.scene&&i){var o,a,l,u;s=function(p){o===void 0&&(o=i.clone().applyMatrix4(e.scene.matrixWorld.clone().invert())),a===void 0&&(a=o.length()),l===void 0&&(l=Math.sqrt(Math.pow(a,2)-Math.pow(r,2))),u===void 0&&(u=Math.acos(l/a));var g=o.distanceTo(p);if(g<l)return!1;var v=p.length(),y=Math.acos((Math.pow(a,2)+Math.pow(g,2)-Math.pow(v,2))/(2*a*g));return y<u}}e.layersThatNeedUpdatePov.forEach(function(A){return A.updatePov(t)}),e.layersThatNeedBehindGlobeChecker.forEach(function(A){return A.isBehindGlobe(s)})},pauseAnimation:function(e){return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),e.pausableLayers.forEach(function(t){var i;return(i=t.pauseAnimation)===null||i===void 0?void 0:i.call(t)}),this},resumeAnimation:function(e){return e.animationFrameRequestId===null&&this._animationCycle(),e.pausableLayers.forEach(function(t){var i;return(i=t.resumeAnimation)===null||i===void 0?void 0:i.call(t)}),this},_animationCycle:function(e){e.animationFrameRequestId=requestAnimationFrame(this._animationCycle),e.tweenGroup.update()},_destructor:function(e){this.pauseAnimation(),e.destructableLayers.forEach(function(t){return t._destructor()})}},qAe),stateInit:function(){var e=new tC,t={tweenGroup:e},i={globeLayer:pI(t),pointsLayer:mI(t),arcsLayer:_I(t),hexBinLayer:vI(t),heatmapsLayer:xI(t),polygonsLayer:bI(t),hexedPolygonsLayer:TI(t),pathsLayer:SI(t),tilesLayer:wI(t),particlesLayer:MI(t),ringsLayer:EI(t),labelsLayer:CI(t),htmlElementsLayer:RI(t),objectsLayer:NI(t),customLayer:PI(t)};return fi(fi({tweenGroup:e},i),{},{layersThatNeedUpdatePov:Object.values(i).filter(function(r){return r.hasOwnProperty("updatePov")}),layersThatNeedBehindGlobeChecker:Object.values(i).filter(function(r){return r.hasOwnProperty("isBehindGlobe")}),destructableLayers:Object.values(i).filter(function(r){return r.hasOwnProperty("_destructor")}),pausableLayers:Object.values(i).filter(function(r){return r.hasOwnProperty("pauseAnimation")})})},init:function(e,t,i){var r=i.animateIn,s=r===void 0?!0:r,o=i.waitForGlobeReady,a=o===void 0?!0:o;Ti(e),t.scene=e,t.scene.visible=!1,VAe.forEach(function(u){var A=new T1.Group;t.scene.add(A),t[u](A)});var l=function(){if(s){t.scene.scale.set(1e-6,1e-6,1e-6),t.tweenGroup.add(new Uo({k:1e-6}).to({k:1},600).easing(rs.Quadratic.Out).onUpdate(function(p){var g=p.k;return t.scene.scale.set(g,g,g)}).start());var A=new T1.Vector3(0,1,0);t.tweenGroup.add(new Uo({rot:Math.PI*2}).to({rot:0},1200).easing(rs.Quintic.Out).onUpdate(function(p){var g=p.rot;return t.scene.setRotationFromAxisAngle(A,g)}).start())}t.scene.visible=!0,t.onGlobeReady&&t.onGlobeReady()};a?t.globeLayer.onReady(l):l(),this._animationCycle()},update:function(e){}});function _0e(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=function(r){function s(){var o;v_(this,s);for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return o=__(this,s,[].concat(l)),o.__kapsuleInstance=I5(n,[].concat(_i(t?[o]:[]),l)),o}return x_(s,r),y_(s)}(e);return Object.keys(n()).forEach(function(r){return i.prototype[r]=function(){var s,o=(s=this.__kapsuleInstance)[r].apply(s,arguments);return o===this.__kapsuleInstance?this:o}}),i}var v0e=window.THREE?window.THREE:{Group:vs},DI=_0e(g0e,v0e.Group,!0);const y0e={id:"globeViz",class:"bg-gray-900"},x0e={__name:"leo-3d-earth-hero",setup(n){fu(()=>{const r=[...Array(50).keys()].map(()=>({startLat:(Math.random()-.5)*180,startLng:(Math.random()-.5)*360,endLat:(Math.random()-.5)*180,endLng:(Math.random()-.5)*360,color:["#00F4DC","#8D41D9"][Math.floor(Math.random()*2)]})),s=[...Array(750).keys()].map(()=>({lat:(Math.random()-.5)*180,lng:(Math.random()-.5)*360,alt:Math.random()*.15,radius:Math.random()*1,color:["#00F4DC","#8D41D9"][Math.round(Math.random()*1)]})),o=new DI().globeImageUrl("./img/earth-night.jpg").arcsData(r).arcColor("color").arcAltitude(.25).arcAltitudeAutoScale(1).arcDashLength(.5).arcDashGap(4).arcDashInitialGap(()=>Math.random()*5).arcDashAnimateTime(2e3).arcStroke(.5).customLayerData(s).customThreeObject(g=>{const v=new Jn(new Fa(g.radius),new Tl({color:g.color})),y=new Qf({map:e(),color:g.color,transparent:!0,opacity:.5,depthWrite:!1,blending:uh}),b=new R9(y);b.scale.set(g.radius*6,g.radius*6,1);const w=new vs;return w.add(v),w.add(b),w}).customThreeObjectUpdate((g,v)=>{Object.assign(g.position,o.getCoords(v.lat,v.lng,v.alt))}),a=new eb({alpha:!0});a.setClearColor(0,0),a.setSize(window.innerWidth,window.innerHeight),a.setPixelRatio(window.devicePixelRatio),document.getElementById("globeViz").appendChild(a.domElement);const l=new zA;l.add(o),l.add(new k2(13421772,Math.PI)),l.add(new K4(16777215,.6*Math.PI));const u=new Er(75,window.innerWidth/window.innerHeight,.1,1e3);u.position.set(-200,0,50);let A=!0;function p(){requestAnimationFrame(p),A&&(u.position.x+=(0-u.position.x)*.05,Math.abs(u.position.x)<.1&&(u.position.x=0,A=!1),u.translateZ(3)),u.position.z>300&&(u.position.z=300),o.rotation.y+=.001,o.rotation.x+=25e-5,a.render(l,u)}p()});function e(){const i=document.createElement("canvas");i.width=i.height=128;const r=i.getContext("2d"),s=r.createRadialGradient(128/2,128/2,0,128/2,128/2,128/2);return s.addColorStop(0,"rgba(255,255,255,1)"),s.addColorStop(.2,"rgba(255,255,255,0.6)"),s.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=s,r.fillRect(0,0,128,128),new XG(i)}return(t,i)=>(yt(),Rt("div",y0e))}},b0e="",T0e="",S0e="CelesTrak51311,464",w0e="51SpaceXOneWebOEMODM",M0e=" / ",E0e="",C0e="100",R0e="",N0e="",P0e="",L0e="10",D0e="101U",I0e="",B0e="",F0e="140",U0e="",O0e="",k0e="",V0e="15",z0e="",q0e="",G0e="",H0e="35",W0e="",$0e="",j0e="",X0e="",Q0e="1.8 ",Y0e="#",Z0e=" ",K0e="#",J0e=" ",ede="#",So={title:b0e,subTitle:T0e,p1t1:S0e,p1t2:w0e,feat1Title:M0e,feat1Factory:E0e,feat1Number:C0e,feat1Desc:R0e,feat2Title:N0e,feat2Factory:P0e,feat2Number:L0e,feat2Desc:D0e,feat3Title:I0e,feat3Factory:B0e,feat3Number:F0e,feat3Desc:U0e,feat4Title:O0e,feat4Factory:k0e,feat4Number:V0e,feat4Desc:z0e,feat5Title:q0e,feat5Factory:G0e,feat5Number:H0e,feat5Desc:W0e,featReadMore:$0e,featCaption:j0e,relatedTitle:X0e,related1Title:Q0e,related1Link:Y0e,related2Title:Z0e,related2Link:K0e,related3Title:J0e,related3Link:ede},tde="",nde="",ide="SpaceX",rde="5Golden Dome",sde="Graph Title",ode="Graph Caption",ade="Novaspace2023521000389888",lde="Graph Title",ude="Graph Caption",cde="10ISR202317107202240",hde="",fde="Graph Caption",Ade="1967Outer Space TreatyUNOOSA20251139",dde="2025514",pde="NASACFR",mde="Artemis ProgramILRS54Artemis Accords",gde="SDA",_de="",vde="  ",yde="#",xde="",bde="#",Tde=" SpaceX",Sde="#",wde="30GPS ",Mde="#",$i={title:tde,subTitle:nde,p1t1:ide,p1t2:rde,g1Title:sde,g1Caption:ode,p2t1:ade,g2Title:lde,g2Caption:ude,p3t1:cde,p3t2:hde,g3Caption:fde,p4t1:Ade,g4Caption1:dde,g4Caption2:pde,p5t1:mde,p5t2:gde,relatedTitle:_de,related1Title:vde,related1Link:yde,related2Title:xde,related2Link:bde,related3Title:Tde,related3Link:Sde,related4Title:wde,related4Link:Mde},Ede="",Cde="",Rde="1972Oliver MortonBBC",Nde="2ispaceHAKUTO-R Mission 2DSRPMade in Taiwan6",Pde="lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",Lde="",Dde="Novaspace202311085152032401.6105",Ide="19599142Luna 23Luna 3",Bde="NASA",Fde="19591976499",Ude="",Ode="",kde=" ",Vde="#",zde=" ",qde="#",es={title:Ede,subTitle:Cde,p1t1:Rde,p1t2:Nde,p1t3:Pde,p1Caption:Lde,p2t1:Dde,p2t2:Ide,p2Caption:Bde,p2t3:Fde,p3t1:Ude,relatedTitle:Ode,related1Title:kde,related1Link:Vde,related2Title:zde,related2Link:qde},Gde="",Hde="",Wde="",$de="5101972Kosmos 482Kosmos 482Kosmos 482",jde="20252.55003SpaceXStarshipFAA",Xde="",Qde="The Aerospace CorporationMarlon Sorge",Yde="NASA20246",Zde="3",Kde="",ds={title:Gde,subTitle:Hde,p1t1:Wde,p1t2:$de,p1t3:jde,p2t1:Xde,p2t2:Qde,p2t3:Yde,p3t1:Zde,p3t2:Kde},Jde={class:"leo-intro w-full h-screen min-h-[var(--hero-min-h)] flex flex-col items-center justify-center"},epe={class:"mb-8"},tpe={class:"w-full flex gap-4"},npe={key:0,class:"text-5xl"},Hp=Ct({__name:"leo-intro",props:{chapter:{},current:{}},setup(n){return(e,t)=>(yt(),Rt("div",Jde,[Ee("div",epe,[$r(e.$slots,"default")]),Ee("div",tpe,[Ee("p",null,Ft(Ze(So).title),1),Ee("p",null,Ft(Ze($i).title),1),Ee("p",null,Ft(Ze(es).title),1),Ee("p",null,Ft(Ze(ds).title),1)]),e.chapter?(yt(),Rt("div",npe,Ft(e.chapter),1)):wr("",!0)]))}}),ipe="1.8 ",rpe="#",spe=" ",ope="#",ape=" ",lpe="#",upe="  ",cpe="#",hpe=" SpaceX",fpe="#",Ape="",dpe="#",ppe="30GPS ",mpe="#",gpe=" ",_pe="#",vpe=" ",ype="#",xpe="1.3 ",bpe="#",pr={text1_1:ipe,link1_1:rpe,text1_2:spe,link1_2:ope,text1_3:ape,link1_3:lpe,text2_1:upe,link2_1:cpe,text2_2:hpe,link2_2:fpe,text2_3:Ape,link2_3:dpe,text2_4:ppe,link2_4:mpe,text3_1:gpe,link3_1:_pe,text3_2:vpe,link3_2:ype,text4_1:xpe,link4_1:bpe},Tpe={class:"text-3xl font-bold mb-4"},Spe={class:"text-2xl font-semibold mb-2"},wpe={class:"text-lg mb-4"},Mpe={class:"list-disc pl-5"},Epe=["href"],Cpe=Ct({__name:"leo-outline",setup(n){const e=[{title:So.title,subTitle:So.subTitle,articles:[{text:pr.text1_1,link:pr.link1_1},{text:pr.text1_2,link:pr.link1_2},{text:pr.text1_3,link:pr.link1_3}]},{title:$i.title,subTitle:$i.subTitle,articles:[{text:pr.text2_1,link:pr.link2_1},{text:pr.text2_2,link:pr.link2_2},{text:pr.text2_3,link:pr.link2_3},{text:pr.text2_4,link:pr.link2_4}]},{title:es.title,subTitle:es.subTitle,articles:[{text:pr.text3_1,link:pr.link3_1},{text:pr.text3_2,link:pr.link3_2}]},{title:ds.title,subTitle:ds.subTitle,articles:[{text:pr.text4_1,link:pr.link4_1}]}];return(t,i)=>(yt(),Rt(sr,null,[i[0]||(i[0]=Ee("div",{class:"leo-outline"},null,-1)),Ee("h2",Tpe,Ft(Ze(pr).title),1),(yt(),Rt(sr,null,lg(e,(r,s)=>Ee("div",{key:s,class:"mb-8"},[Ee("h3",Spe,Ft(r.title),1),Ee("p",wpe,Ft(r.subTitle),1),Ee("ul",Mpe,[(yt(!0),Rt(sr,null,lg(r.articles,(o,a)=>(yt(),Rt("li",{key:a},[Ee("a",{href:o.link,class:"text-blue-500 hover:underline"},Ft(o.text),9,Epe)]))),128))])])),64))],64))}}),Rpe={class:"my-10"},Npe={key:0},Ppe={key:1},O5=Ct({__name:"mock",props:{title:{type:Boolean},caption:{type:Boolean}},setup(n){return(e,t)=>(yt(),Rt("div",Rpe,[e.title?(yt(),Rt("div",Npe,"Chart title")):wr("",!0),t[0]||(t[0]=Ee("div",{class:"w-[640px] h-[360px] bg-gray-200 flex items-center justify-center"}," Chart ",-1)),e.caption?(yt(),Rt("div",Ppe,"Chart caption")):wr("",!0)]))}}),Lpe="",Dpe=" ",Ipe="",Bpe="203531.8GDP60%",Fpe="20351.8",Upe="",Ope="20241350",kpe="20241350202310730",Vpe="",zpe="",Bl={title:Lpe,subTitle:Dpe,p1t1:Ipe,p1t2:Bpe,g1Title:Fpe,g1Caption:Upe,g2Title:Ope,p2t1:kpe,p3t1:Vpe,p3t2:zpe},qpe={class:"leo-hero"},Gpe={class:"leo-hero-globe-wrap"},Hpe={class:"leo-hero-globe"},Wpe={class:"leo-hero-intro-wrap"},$pe={class:"leo-container"},jpe=Ct({__name:"section-hero",setup(n){return(e,t)=>(yt(),Rt("div",qpe,[Ee("div",Gpe,[Ee("div",Hpe,[Ut(x0e)]),Ee("div",Wpe,[Ut(Hp,null,{default:Sr(()=>[Ee("p",null,Ft(Ze(Bl).title),1),Ee("p",null,Ft(Ze(Bl).subTitle),1)]),_:1})])]),Ee("div",$pe,[Ee("p",null,Ft(Ze(Bl).p1t1),1),Ee("p",null,Ft(Ze(Bl).p1t2),1),Ee("figure",null,[Ee("figcaption",null,Ft(Ze(Bl).g1Title),1),Ut(O5),Ee("figcaption",null,Ft(Ze(Bl).g1Caption),1)]),t[0]||(t[0]=Ee("figure",null,[Ee("div",{class:"flourish-embed flourish-chart","data-src":"visualisation/20500490"})],-1)),Ee("p",null,Ft(Ze(Bl).p2t1),1),Ee("p",null,Ft(Ze(Bl).p3t1),1),Ee("p",null,Ft(Ze(Bl).p3t2),1)]),Ut(Cpe)]))}}),BM={type:"change"},k5={type:"start"},II={type:"end"},S1=new xp,FM=new Ka,Xpe=Math.cos(70*xA.DEG2RAD),Nr=new re,Xs=2*Math.PI,bi={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},jv=1e-6;class Qpe extends j9{constructor(e,t=null){super(e,t),this.state=bi.NONE,this.target=new re,this.cursor=new re,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:na.ROTATE,MIDDLE:na.DOLLY,RIGHT:na.PAN},this.touches={ONE:Ef.ROTATE,TWO:Ef.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new re,this._lastQuaternion=new eu,this._lastTargetPosition=new re,this._quat=new eu().setFromUnitVectors(e.up,new re(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new oT,this._sphericalDelta=new oT,this._scale=1,this._panOffset=new re,this._rotateStart=new rt,this._rotateEnd=new rt,this._rotateDelta=new rt,this._panStart=new rt,this._panEnd=new rt,this._panDelta=new rt,this._dollyStart=new rt,this._dollyEnd=new rt,this._dollyDelta=new rt,this._dollyDirection=new re,this._mouse=new rt,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Zpe.bind(this),this._onPointerDown=Ype.bind(this),this._onPointerUp=Kpe.bind(this),this._onContextMenu=sme.bind(this),this._onMouseWheel=tme.bind(this),this._onKeyDown=nme.bind(this),this._onTouchStart=ime.bind(this),this._onTouchMove=rme.bind(this),this._onMouseDown=Jpe.bind(this),this._onMouseMove=eme.bind(this),this._interceptControlDown=ome.bind(this),this._interceptControlUp=ame.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(BM),this.update(),this.state=bi.NONE}update(e=null){const t=this.object.position;Nr.copy(t).sub(this.target),Nr.applyQuaternion(this._quat),this._spherical.setFromVector3(Nr),this.autoRotate&&this.state===bi.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(i)&&isFinite(r)&&(i<-Math.PI?i+=Xs:i>Math.PI&&(i-=Xs),r<-Math.PI?r+=Xs:r>Math.PI&&(r-=Xs),i<=r?this._spherical.theta=Math.max(i,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(i+r)/2?Math.max(i,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=o!=this._spherical.radius}if(Nr.setFromSpherical(this._spherical),Nr.applyQuaternion(this._quatInverse),t.copy(this.target).add(Nr),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const a=Nr.length();o=this._clampDistance(a*this._scale);const l=a-o;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),s=!!l}else if(this.object.isOrthographicCamera){const a=new re(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=l!==this.object.zoom;const u=new re(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(a),this.object.updateMatrixWorld(),o=Nr.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(S1.origin.copy(this.object.position),S1.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(S1.direction))<Xpe?this.object.lookAt(this.target):(FM.setFromNormalAndCoplanarPoint(this.object.up,this.target),S1.intersectPlane(FM,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>jv||8*(1-this._lastQuaternion.dot(this.object.quaternion))>jv||this._lastTargetPosition.distanceToSquared(this.target)>jv?(this.dispatchEvent(BM),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Xs/60*this.autoRotateSpeed*e:Xs/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){Nr.setFromMatrixColumn(t,0),Nr.multiplyScalar(-e),this._panOffset.add(Nr)}_panUp(e,t){this.screenSpacePanning===!0?Nr.setFromMatrixColumn(t,1):(Nr.setFromMatrixColumn(t,0),Nr.crossVectors(this.object.up,Nr)),Nr.multiplyScalar(e),this._panOffset.add(Nr)}_pan(e,t){const i=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;Nr.copy(r).sub(this.target);let s=Nr.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/i.clientHeight,this.object.matrix),this._panUp(2*t*s/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),r=e-i.left,s=t-i.top,o=i.width,a=i.height;this._mouse.x=r/o*2-1,this._mouse.y=-(s/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Xs*this._rotateDelta.x/t.clientHeight),this._rotateUp(Xs*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Xs*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Xs*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Xs*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Xs*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(i,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(i,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),r=.5*(e.pageX+i.x),s=.5*(e.pageY+i.y);this._rotateEnd.set(r,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(Xs*this._rotateDelta.x/t.clientHeight),this._rotateUp(Xs*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(i,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(o,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new rt,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function Ype(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(n)&&(this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n)))}function Zpe(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function Kpe(n){switch(this._removePointer(n),this._pointers.length){case 0:this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(II),this.state=bi.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function Jpe(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case na.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(n),this.state=bi.DOLLY;break;case na.ROTATE:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=bi.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=bi.ROTATE}break;case na.PAN:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=bi.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=bi.PAN}break;default:this.state=bi.NONE}this.state!==bi.NONE&&this.dispatchEvent(k5)}function eme(n){switch(this.state){case bi.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(n);break;case bi.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(n);break;case bi.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(n);break}}function tme(n){this.enabled===!1||this.enableZoom===!1||this.state!==bi.NONE||(n.preventDefault(),this.dispatchEvent(k5),this._handleMouseWheel(this._customWheelEvent(n)),this.dispatchEvent(II))}function nme(n){this.enabled!==!1&&this._handleKeyDown(n)}function ime(n){switch(this._trackPointer(n),this._pointers.length){case 1:switch(this.touches.ONE){case Ef.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(n),this.state=bi.TOUCH_ROTATE;break;case Ef.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(n),this.state=bi.TOUCH_PAN;break;default:this.state=bi.NONE}break;case 2:switch(this.touches.TWO){case Ef.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(n),this.state=bi.TOUCH_DOLLY_PAN;break;case Ef.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(n),this.state=bi.TOUCH_DOLLY_ROTATE;break;default:this.state=bi.NONE}break;default:this.state=bi.NONE}this.state!==bi.NONE&&this.dispatchEvent(k5)}function rme(n){switch(this._trackPointer(n),this.state){case bi.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(n),this.update();break;case bi.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(n),this.update();break;case bi.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(n),this.update();break;case bi.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(n),this.update();break;default:this.state=bi.NONE}}function sme(n){this.enabled!==!1&&n.preventDefault()}function ome(n){n.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function ame(n){n.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}var Zn={},UM;function po(){if(UM)return Zn;UM=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.xpdotp=Zn.xke=Zn.x2o3=Zn.vkmpersec=Zn.twoPi=Zn.tumin=Zn.rad2deg=Zn.pi=Zn.mu=Zn.minutesPerDay=Zn.j4=Zn.j3oj2=Zn.j3=Zn.j2=Zn.earthRadius=Zn.deg2rad=void 0;var n=Zn.pi=Math.PI;Zn.twoPi=n*2,Zn.deg2rad=n/180,Zn.rad2deg=180/n,Zn.minutesPerDay=1440;var e=Zn.mu=398600.8,t=Zn.earthRadius=6378.135,i=Zn.xke=60/Math.sqrt(t*t*t/e);Zn.vkmpersec=t*i/60,Zn.tumin=1/i;var r=Zn.j2=.001082616,s=Zn.j3=-253881e-11;return Zn.j4=-165597e-11,Zn.j3oj2=s/r,Zn.x2o3=2/3,Zn.xpdotp=1440/(2*n),Zn}var lme=po(),Xv={},xf={},OM;function b_(){if(OM)return xf;OM=1,Object.defineProperty(xf,"__esModule",{value:!0}),xf.days2mdhms=n,xf.invjday=i,xf.jday=t;function n(r,s){for(var o=[31,r%4===0?29:28,31,30,31,30,31,31,30,31,30,31],a=Math.floor(s),l=1,u=0;a>u+o[l-1]&&l<12;)u+=o[l-1],l+=1;var A=l,p=a-u,g=(s-a)*24,v=Math.floor(g);g=(g-v)*60;var y=Math.floor(g),b=(g-y)*60;return{mon:A,day:p,hr:v,minute:y,sec:b}}function e(r,s,o,a,l,u){var A=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;return 367*r-Math.floor(7*(r+Math.floor((s+9)/12))*.25)+Math.floor(275*s/9)+o+17210135e-1+((A/6e4+u/60+l)/60+a)/24}function t(r,s,o,a,l,u){var A=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;if(r instanceof Date){var p=r;return e(p.getUTCFullYear(),p.getUTCMonth()+1,p.getUTCDate(),p.getUTCHours(),p.getUTCMinutes(),p.getUTCSeconds(),p.getUTCMilliseconds())}return e(r,s,o,a,l,u,A)}function i(r,s){var o=r-24150195e-1,a=o/365.25,l=1900+Math.floor(a),u=Math.floor((l-1901)*.25),A=o-((l-1900)*365+u)+1e-11;A<1&&(l-=1,u=Math.floor((l-1901)*.25),A=o-((l-1900)*365+u));var p=n(l,A),g=p.mon,v=p.day,y=p.hr,b=p.minute,w=p.sec-864e-9;return s?[l,g,v,y,b,Math.floor(w)]:new Date(Date.UTC(l,g-1,v,y,b,Math.floor(w)))}return xf}var B0={},Qv={},Yv={},kM;function BI(){return kM||(kM=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=t;var e=po();function t(i,r){var s=i.e3,o=i.ee2,a=i.peo,l=i.pgho,u=i.pho,A=i.pinco,p=i.plo,g=i.se2,v=i.se3,y=i.sgh2,b=i.sgh3,w=i.sgh4,S=i.sh2,C=i.sh3,E=i.si2,R=i.si3,D=i.sl2,B=i.sl3,L=i.sl4,U=i.t,P=i.xgh2,F=i.xgh3,V=i.xgh4,H=i.xh2,j=i.xh3,J=i.xi2,Z=i.xi3,W=i.xl2,K=i.xl3,ee=i.xl4,se=i.zmol,ge=i.zmos,de=r.init,Ae=r.opsmode,Be=r.ep,ye=r.inclp,De=r.nodep,We=r.argpp,$e=r.mp,Ke,Xe,st,gt,ae,le,G,Te,pe,me,ve,qe,Me,$,z,fe,xe,Le,Ne,ot,Qe,xt=119459e-10,bt=.01675,nt=.00015835218,At=.0549;Qe=ge+xt*U,de==="y"&&(Qe=ge),ot=Qe+2*bt*Math.sin(Qe),xe=Math.sin(ot),me=.5*xe*xe-.25,ve=-.5*xe*Math.cos(ot);var Dt=g*me+v*ve,Ot=E*me+R*ve,dt=D*me+B*ve+L*xe,kt=y*me+b*ve+w*xe,Lt=S*me+C*ve;Qe=se+nt*U,de==="y"&&(Qe=se),ot=Qe+2*At*Math.sin(Qe),xe=Math.sin(ot),me=.5*xe*xe-.25,ve=-.5*xe*Math.cos(ot);var $t=o*me+s*ve,ie=J*me+Z*ve,Mt=W*me+K*ve+ee*xe,je=P*me+F*ve+V*xe,q=H*me+j*ve;return qe=Dt+$t,z=Ot+ie,fe=dt+Mt,Me=kt+je,$=Lt+q,de==="n"&&(qe-=a,z-=A,fe-=p,Me-=l,$-=u,ye+=z,Be+=qe,gt=Math.sin(ye),st=Math.cos(ye),ye>=.2?($/=gt,Me-=st*$,We+=Me,De+=$,$e+=fe):(le=Math.sin(De),ae=Math.cos(De),Ke=gt*le,Xe=gt*ae,G=$*ae+z*st*le,Te=-$*le+z*st*ae,Ke+=G,Xe+=Te,De%=e.twoPi,De<0&&Ae==="a"&&(De+=e.twoPi),Le=$e+We+st*De,pe=fe+Me-z*De*gt,Le+=pe,Ne=De,De=Math.atan2(Ke,Xe),De<0&&Ae==="a"&&(De+=e.twoPi),Math.abs(Ne-De)>e.pi&&(De<Ne?De+=e.twoPi:De-=e.twoPi),$e+=fe,We=Le-$e-st*De)),{ep:Be,inclp:ye,nodep:De,argpp:We,mp:$e}}}(Yv)),Yv}var Zv={},VM;function ume(){return VM||(VM=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=t;var e=po();function t(i){var r=i.epoch,s=i.ep,o=i.argpp,a=i.tc,l=i.inclp,u=i.nodep,A=i.np,p,g,v,y,b,w,S,C,E,R,D,B,L,U,P,F,V,H,j,J,Z,W,K,ee,se,ge,de,Ae,Be,ye,De,We,$e,Ke,Xe,st,gt,ae,le,G,Te,pe,me,ve,qe,Me,$,z,fe,xe,Le,Ne,ot,Qe,xt,bt,nt,At,Dt,Ot,dt,kt,Lt,$t=.01675,ie=.0549,Mt=29864797e-13,je=47968065e-14,q=.39785416,Pt=.91744867,wt=.1945905,sn=-.98088458,$n=A,Rn=s,tn=Math.sin(u),vi=Math.cos(u),Wn=Math.sin(o),ke=Math.cos(o),it=Math.sin(l),pt=Math.cos(l),et=Rn*Rn,c=1-et,X=Math.sqrt(c),dn=0,Nn=0,Kn=0,an=0,ht=0,tr=r+18261.5+a/1440,un=(4.523602-.00092422029*tr)%e.twoPi,qt=Math.sin(un),cn=Math.cos(un),mo=.91375164-.03568096*cn,Oa=Math.sqrt(1-mo*mo),ne=.089683511*qt/Oa,Re=Math.sqrt(1-ne*ne),Ve=5.8351514+.001944368*tr,Ge=.39785416*qt/Oa,Fe=Re*cn+.91744867*ne*qt;Ge=Math.atan2(Ge,Fe),Ge+=Ve-un;var Tt=Math.cos(Ge),Nt=Math.sin(Ge);J=wt,Z=sn,ee=Pt,se=q,W=vi,K=tn,D=Mt;for(var lt=1/$n,Y=0;Y<2;)Y+=1,p=J*W+Z*ee*K,v=-Z*W+J*ee*K,S=-J*K+Z*ee*W,C=Z*se,E=Z*K+J*ee*W,R=J*se,g=pt*S+it*C,y=pt*E+it*R,b=-it*S+pt*C,w=-it*E+pt*R,B=p*ke+g*Wn,L=v*ke+y*Wn,U=-p*Wn+g*ke,P=-v*Wn+y*ke,F=b*Wn,V=w*Wn,H=b*ke,j=w*ke,dt=12*B*B-3*U*U,kt=24*B*L-6*U*P,Lt=12*L*L-3*P*P,Ne=3*(p*p+g*g)+dt*et,ot=6*(p*v+g*y)+kt*et,Qe=3*(v*v+y*y)+Lt*et,xt=-6*p*b+et*(-24*B*H-6*U*F),bt=-6*(p*w+v*b)+et*(-24*(L*H+B*j)+-6*(U*V+P*F)),nt=-6*v*w+et*(-24*L*j-6*P*V),At=6*g*b+et*(24*B*F-6*U*H),Dt=6*(y*b+g*w)+et*(24*(L*F+B*V)-6*(P*H+U*j)),Ot=6*y*w+et*(24*L*V-6*P*j),Ne=Ne+Ne+c*dt,ot=ot+ot+c*kt,Qe=Qe+Qe+c*Lt,$=D*lt,Me=-.5*$/X,z=$*X,qe=-15*Rn*z,fe=B*U+L*P,xe=L*U+B*P,Le=L*P-B*U,Y===1&&(ge=qe,de=Me,Ae=$,Be=z,ye=fe,De=xe,We=Le,$e=Ne,Ke=ot,Xe=Qe,st=xt,gt=bt,ae=nt,le=At,G=Dt,Te=Ot,pe=dt,me=kt,ve=Lt,J=Tt,Z=Nt,ee=mo,se=Oa,W=Re*vi+ne*tn,K=tn*Re-vi*ne,D=je);var mt=(4.7199672+(.2299715*tr-Ve))%e.twoPi,ln=(6.2565837+.017201977*tr)%e.twoPi,Qt=2*ge*De,Bn=2*ge*We,zn=2*de*gt,Li=2*de*(ae-st),Q=-2*Ae*Ke,qn=-2*Ae*(Xe-$e),Yt=-2*Ae*(-21-9*et)*$t,Di=2*Be*me,jn=2*Be*(ve-pe),Qr=-18*Be*$t,Ws=-2*de*G,Ar=-2*de*(Te-le),$s=2*qe*xe,si=2*qe*Le,Ii=2*Me*bt,ei=2*Me*(nt-xt),dr=-2*$*ot,Ur=-2*$*(Qe-Ne),cc=-2*$*(-21-9*et)*ie,Vo=2*z*kt,S_=2*z*(Lt-dt),w_=-18*z*ie,M_=-2*Me*Dt,Mi=-2*Me*(Ot-At);return{snodm:tn,cnodm:vi,sinim:it,cosim:pt,sinomm:Wn,cosomm:ke,day:tr,e3:si,ee2:$s,em:Rn,emsq:et,gam:Ve,peo:dn,pgho:an,pho:ht,pinco:Nn,plo:Kn,rtemsq:X,se2:Qt,se3:Bn,sgh2:Di,sgh3:jn,sgh4:Qr,sh2:Ws,sh3:Ar,si2:zn,si3:Li,sl2:Q,sl3:qn,sl4:Yt,s1:qe,s2:Me,s3:$,s4:z,s5:fe,s6:xe,s7:Le,ss1:ge,ss2:de,ss3:Ae,ss4:Be,ss5:ye,ss6:De,ss7:We,sz1:$e,sz2:Ke,sz3:Xe,sz11:st,sz12:gt,sz13:ae,sz21:le,sz22:G,sz23:Te,sz31:pe,sz32:me,sz33:ve,xgh2:Vo,xgh3:S_,xgh4:w_,xh2:M_,xh3:Mi,xi2:Ii,xi3:ei,xl2:dr,xl3:Ur,xl4:cc,nm:$n,z1:Ne,z2:ot,z3:Qe,z11:xt,z12:bt,z13:nt,z21:At,z22:Dt,z23:Ot,z31:dt,z32:kt,z33:Lt,zmol:mt,zmos:ln}}}(Zv)),Zv}var Kv={},zM;function cme(){return zM||(zM=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=t;var e=po();function t(i){var r=i.cosim,s=i.argpo,o=i.s1,a=i.s2,l=i.s3,u=i.s4,A=i.s5,p=i.sinim,g=i.ss1,v=i.ss2,y=i.ss3,b=i.ss4,w=i.ss5,S=i.sz1,C=i.sz3,E=i.sz11,R=i.sz13,D=i.sz21,B=i.sz23,L=i.sz31,U=i.sz33,P=i.t,F=i.tc,V=i.gsto,H=i.mo,j=i.mdot,J=i.no,Z=i.nodeo,W=i.nodedot,K=i.xpidot,ee=i.z1,se=i.z3,ge=i.z11,de=i.z13,Ae=i.z21,Be=i.z23,ye=i.z31,De=i.z33,We=i.ecco,$e=i.eccsq,Ke=i.emsq,Xe=i.em,st=i.argpm,gt=i.inclm,ae=i.mm,le=i.nm,G=i.nodem,Te=i.irez,pe=i.atime,me=i.d2201,ve=i.d2211,qe=i.d3210,Me=i.d3222,$=i.d4410,z=i.d4422,fe=i.d5220,xe=i.d5232,Le=i.d5421,Ne=i.d5433,ot=i.dedt,Qe=i.didt,xt=i.dmdt,bt=i.dnodt,nt=i.domdt,At=i.del1,Dt=i.del2,Ot=i.del3,dt=i.xfact,kt=i.xlamo,Lt=i.xli,$t=i.xni,ie,Mt,je,q,Pt,wt,sn,$n,Rn,tn,vi,Wn,ke,it,pt,et,c,X,dn,Nn,Kn,an,ht,tr,un,qt,cn,mo,Oa,ne,Re,Ve,Ge=17891679e-13,Fe=21460748e-13,Tt=22123015e-14,Nt=17891679e-13,lt=73636953e-16,Y=21765803e-16,mt=.0043752690880113,ln=37393792e-14,Qt=11428639e-14,Bn=.00015835218,zn=119459e-10;Te=0,le<.0052359877&&le>.0034906585&&(Te=1),le>=.00826&&le<=.00924&&Xe>=.5&&(Te=2);var Li=g*zn*w,Q=v*zn*(E+R),qn=-119459e-10*y*(S+C-14-6*Ke),Yt=b*zn*(L+U-6),Di=-119459e-10*v*(D+B);(gt<.052359877||gt>e.pi-.052359877)&&(Di=0),p!==0&&(Di/=p);var jn=Yt-r*Di;ot=Li+o*Bn*A,Qe=Q+a*Bn*(ge+de),xt=qn-Bn*l*(ee+se-14-6*Ke);var Qr=u*Bn*(ye+De-6),Ws=-.00015835218*a*(Ae+Be);(gt<.052359877||gt>e.pi-.052359877)&&(Ws=0),nt=jn+Qr,bt=Di,p!==0&&(nt-=r/p*Ws,bt+=Ws/p);var Ar=0,$s=(V+F*mt)%e.twoPi;if(Xe+=ot*P,gt+=Qe*P,st+=nt*P,G+=bt*P,ae+=xt*P,Te!==0){if(ne=Math.pow(le/e.xke,e.x2o3),Te===2){Re=r*r;var si=Xe;Xe=We;var Ii=Ke;Ke=$e,Ve=Xe*Ke,it=-.306-(Xe-.64)*.44,Xe<=.65?(pt=3.616-13.247*Xe+16.29*Ke,c=-19.302+117.39*Xe-228.419*Ke+156.591*Ve,X=-18.9068+109.7927*Xe-214.6334*Ke+146.5816*Ve,dn=-41.122+242.694*Xe-471.094*Ke+313.953*Ve,Nn=-146.407+841.88*Xe-1629.014*Ke+1083.435*Ve,Kn=-532.114+3017.977*Xe-5740.032*Ke+3708.276*Ve):(pt=-72.099+331.819*Xe-508.738*Ke+266.724*Ve,c=-346.844+1582.851*Xe-2415.925*Ke+1246.113*Ve,X=-342.585+1554.908*Xe-2366.899*Ke+1215.972*Ve,dn=-1052.797+4758.686*Xe-7193.992*Ke+3651.957*Ve,Nn=-3581.69+16178.11*Xe-24462.77*Ke+12422.52*Ve,Xe>.715?Kn=-5149.66+29936.92*Xe-54087.36*Ke+31324.56*Ve:Kn=1464.74-4664.75*Xe+3763.64*Ke),Xe<.7?(tr=-919.2277+4988.61*Xe-9064.77*Ke+5542.21*Ve,an=-822.71072+4568.6173*Xe-8491.4146*Ke+5337.524*Ve,ht=-853.666+4690.25*Xe-8624.77*Ke+5341.4*Ve):(tr=-37995.78+161616.52*Xe-229838.2*Ke+109377.94*Ve,an=-51752.104+218913.95*Xe-309468.16*Ke+146349.42*Ve,ht=-40023.88+170470.89*Xe-242699.48*Ke+115605.82*Ve),un=p*p,ie=.75*(1+2*r+Re),Mt=1.5*un,q=1.875*p*(1-2*r-3*Re),Pt=-1.875*p*(1+2*r-3*Re),sn=35*un*ie,$n=39.375*un*un,Rn=9.84375*p*(un*(1-2*r-5*Re)+.33333333*(-2+4*r+6*Re)),tn=p*(4.92187512*un*(-2-4*r+10*Re)+6.56250012*(1+2*r-3*Re)),vi=29.53125*p*(2-8*r+Re*(-12+8*r+10*Re)),Wn=29.53125*p*(-2-8*r+Re*(12+8*r-10*Re)),mo=le*le,Oa=ne*ne,cn=3*mo*Oa,qt=cn*Nt,me=qt*ie*it,ve=qt*Mt*pt,cn*=ne,qt=cn*ln,qe=qt*q*c,Me=qt*Pt*X,cn*=ne,qt=2*cn*lt,$=qt*sn*dn,z=qt*$n*Nn,cn*=ne,qt=cn*Qt,fe=qt*Rn*Kn,xe=qt*tn*ht,qt=2*cn*Y,Le=qt*vi*an,Ne=qt*Wn*tr,kt=(H+Z+Z-($s+$s))%e.twoPi,dt=j+xt+2*(W+bt-mt)-J,Xe=si,Ke=Ii}Te===1&&(ke=1+Ke*(-2.5+.8125*Ke),c=1+2*Ke,et=1+Ke*(-6+6.60937*Ke),ie=.75*(1+r)*(1+r),je=.9375*p*p*(1+3*r)-.75*(1+r),wt=1+r,wt*=1.875*wt*wt,At=3*le*le*ne*ne,Dt=2*At*ie*ke*Ge,Ot=3*At*wt*et*Tt*ne,At=At*je*c*Fe*ne,kt=(H+Z+s-$s)%e.twoPi,dt=j+K+xt+nt+bt-(J+mt)),Lt=kt,$t=J,pe=0,le=J+Ar}return{em:Xe,argpm:st,inclm:gt,mm:ae,nm:le,nodem:G,irez:Te,atime:pe,d2201:me,d2211:ve,d3210:qe,d3222:Me,d4410:$,d4422:z,d5220:fe,d5232:xe,d5421:Le,d5433:Ne,dedt:ot,didt:Qe,dmdt:xt,dndt:Ar,dnodt:bt,domdt:nt,del1:At,del2:Dt,del3:Ot,xfact:dt,xlamo:kt,xli:Lt,xni:$t}}}(Kv)),Kv}var Jv={},ey={},qM;function FI(){return qM||(qM=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=po(),t=b_();function i(s){var o=(s-2451545)/36525,a=-62e-7*o*o*o+.093104*o*o+(876600*3600+8640184812866e-6)*o+67310.54841;return a=a*e.deg2rad/240%e.twoPi,a<0&&(a+=e.twoPi),a}function r(s,o,a,l,u,A,p){return s instanceof Date?i((0,t.jday)(s)):i(o!==void 0?(0,t.jday)(s,o,a,l,u,A,p):s)}n.default=r}(ey)),ey}var GM;function hme(){return GM||(GM=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=r;var e=po(),t=i(FI());function i(s){return s&&s.__esModule?s:{default:s}}function r(s){var o=s.ecco,a=s.epoch,l=s.inclo,u=s.opsmode,A=s.no,p=o*o,g=1-p,v=Math.sqrt(g),y=Math.cos(l),b=y*y,w=Math.pow(e.xke/A,e.x2o3),S=.75*e.j2*(3*b-1)/(v*g),C=S/(w*w),E=w*(1-C*C-C*(1/3+134*C*C/81));C=S/(E*E),A/=1+C;var R=Math.pow(e.xke/A,e.x2o3),D=Math.sin(l),B=R*g,L=1-5*b,U=-L-b-b,P=1/R,F=B*B,V=R*(1-o),H="n",j;if(u==="a"){var J=a-7305,Z=Math.floor(J+1e-8),W=J-Z,K=.017202791694070362,ee=1.7321343856509375,se=5075514194322695e-30,ge=K+e.twoPi;j=(ee+K*Z+ge*W+J*J*se)%e.twoPi,j<0&&(j+=e.twoPi)}else j=(0,t.default)(a+24332815e-1);return{no:A,method:H,ainv:P,ao:R,con41:U,con42:L,cosio:y,cosio2:b,eccsq:p,omeosq:g,posq:F,rp:V,rteosq:v,sinio:D,gsto:j}}}(Jv)),Jv}var ty={},ny={},HM;function fme(){return HM||(HM=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=t;var e=po();function t(i){var r=i.irez,s=i.d2201,o=i.d2211,a=i.d3210,l=i.d3222,u=i.d4410,A=i.d4422,p=i.d5220,g=i.d5232,v=i.d5421,y=i.d5433,b=i.dedt,w=i.del1,S=i.del2,C=i.del3,E=i.didt,R=i.dmdt,D=i.dnodt,B=i.domdt,L=i.argpo,U=i.argpdot,P=i.t,F=i.tc,V=i.gsto,H=i.xfact,j=i.xlamo,J=i.no,Z=i.atime,W=i.em,K=i.argpm,ee=i.inclm,se=i.xli,ge=i.mm,de=i.xni,Ae=i.nodem,Be=i.nm,ye=.13130908,De=2.8843198,We=.37448087,$e=5.7686396,Ke=.95240898,Xe=1.8014998,st=1.050833,gt=4.4108898,ae=.0043752690880113,le=720,G=-720,Te=259200,pe,me,ve,qe,Me,$,z,fe,xe=0,Le=0,Ne=(V+F*ae)%e.twoPi;if(W+=b*P,ee+=E*P,K+=B*P,Ae+=D*P,ge+=R*P,r!==0){(Z===0||P*Z<=0||Math.abs(P)<Math.abs(Z))&&(Z=0,de=J,se=j),P>0?pe=le:pe=G;for(var ot=381;ot===381;)r!==2?(z=w*Math.sin(se-ye)+S*Math.sin(2*(se-De))+C*Math.sin(3*(se-We)),Me=de+H,$=w*Math.cos(se-ye)+2*S*Math.cos(2*(se-De))+3*C*Math.cos(3*(se-We)),$*=Me):(fe=L+U*Z,ve=fe+fe,me=se+se,z=s*Math.sin(ve+se-$e)+o*Math.sin(se-$e)+a*Math.sin(fe+se-Ke)+l*Math.sin(-fe+se-Ke)+u*Math.sin(ve+me-Xe)+A*Math.sin(me-Xe)+p*Math.sin(fe+se-st)+g*Math.sin(-fe+se-st)+v*Math.sin(fe+me-gt)+y*Math.sin(-fe+me-gt),Me=de+H,$=s*Math.cos(ve+se-$e)+o*Math.cos(se-$e)+a*Math.cos(fe+se-Ke)+l*Math.cos(-fe+se-Ke)+p*Math.cos(fe+se-st)+g*Math.cos(-fe+se-st)+2*(u*Math.cos(ve+me-Xe)+A*Math.cos(me-Xe)+v*Math.cos(fe+me-gt)+y*Math.cos(-fe+me-gt)),$*=Me),Math.abs(P-Z)>=le?ot=381:(Le=P-Z,ot=0),ot===381&&(se+=Me*pe+z*Te,de+=z*pe+$*Te,Z+=pe);Be=de+z*Le+$*Le*Le*.5,qe=se+Me*Le+z*Le*Le*.5,r!==1?(ge=qe-2*Ae+2*Ne,xe=Be-J):(ge=qe-Ae-K+Ne,xe=Be-J),Be=J+xe}return{atime:Z,em:W,argpm:K,inclm:ee,xli:se,mm:ge,xni:de,nodem:Ae,dndt:xe,nm:Be}}}(ny)),ny}var F0={},WM;function UI(){if(WM)return F0;WM=1,Object.defineProperty(F0,"__esModule",{value:!0}),F0.SatRecError=void 0;var n;return function(e){e[e.None=0]="None",e[e.MeanEccentricityOutOfRange=1]="MeanEccentricityOutOfRange",e[e.MeanMotionBelowZero=2]="MeanMotionBelowZero",e[e.PerturbedEccentricityOutOfRange=3]="PerturbedEccentricityOutOfRange",e[e.SemiLatusRectumBelowZero=4]="SemiLatusRectumBelowZero",e[e.Decayed=6]="Decayed"}(n||(F0.SatRecError=n={})),F0}var $M;function V5(){return $M||($M=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=o;var e=po(),t=s(BI()),i=s(fme()),r=UI();function s(a){return a&&a.__esModule?a:{default:a}}function o(a,l){var u,A,p,g,v,y,b,w,S,C,E,R,D,B,L,U,P,F,V,H,j,J,Z,W,K,ee,se,ge=15e-13;a.t=l,a.error=r.SatRecError.None;var de=a.mo+a.mdot*a.t,Ae=a.argpo+a.argpdot*a.t,Be=a.nodeo+a.nodedot*a.t;S=Ae,j=de;var ye=a.t*a.t;if(Z=Be+a.nodecf*ye,P=1-a.cc1*a.t,F=a.bstar*a.cc4*a.t,V=a.t2cof*ye,a.isimp!==1){b=a.omgcof*a.t;var De=1+a.eta*Math.cos(de);y=a.xmcof*(De*De*De-a.delmo),U=b+y,j=de+U,S=Ae-U,R=ye*a.t,D=R*a.t,P=P-a.d2*ye-a.d3*R-a.d4*D,F+=a.bstar*a.cc5*(Math.sin(j)-a.sinmao),V=V+a.t3cof*R+D*(a.t4cof+a.t*a.t5cof)}J=a.no;var We=a.ecco;if(H=a.inclo,a.method==="d"){B=a.t;var $e={irez:a.irez,d2201:a.d2201,d2211:a.d2211,d3210:a.d3210,d3222:a.d3222,d4410:a.d4410,d4422:a.d4422,d5220:a.d5220,d5232:a.d5232,d5421:a.d5421,d5433:a.d5433,dedt:a.dedt,del1:a.del1,del2:a.del2,del3:a.del3,didt:a.didt,dmdt:a.dmdt,dnodt:a.dnodt,domdt:a.domdt,argpo:a.argpo,argpdot:a.argpdot,t:a.t,tc:B,gsto:a.gsto,xfact:a.xfact,xlamo:a.xlamo,no:a.no,atime:a.atime,em:We,argpm:S,inclm:H,xli:a.xli,mm:j,xni:a.xni,nodem:Z,nm:J},Ke=(0,i.default)($e);We=Ke.em,S=Ke.argpm,H=Ke.inclm,j=Ke.mm,Z=Ke.nodem,J=Ke.nm}if(J<=0)return a.error=r.SatRecError.MeanMotionBelowZero,null;var Xe=Math.pow(e.xke/J,e.x2o3)*P*P;if(J=e.xke/Math.pow(Xe,1.5),We-=F,We>=1||We<-.001)return a.error=r.SatRecError.MeanEccentricityOutOfRange,null;We<1e-6&&(We=1e-6),j+=a.no*V,K=j+S+Z,Z%=e.twoPi,S%=e.twoPi,K%=e.twoPi,j=(K-S-Z)%e.twoPi;var st={am:Xe,em:We,im:H,Om:Z,om:S,mm:j,nm:J},gt=Math.sin(H),ae=Math.cos(H),le=We;if(W=H,C=S,se=Z,ee=j,g=gt,p=ae,a.method==="d"){var G={inclo:a.inclo,init:"n",ep:le,inclp:W,nodep:se,argpp:C,mp:ee,opsmode:a.operationmode},Te=(0,t.default)(a,G);if(le=Te.ep,se=Te.nodep,C=Te.argpp,ee=Te.mp,W=Te.inclp,W<0&&(W=-W,se+=e.pi,C-=e.pi),le<0||le>1)return a.error=r.SatRecError.PerturbedEccentricityOutOfRange,null}a.method==="d"&&(g=Math.sin(W),p=Math.cos(W),a.aycof=-.5*e.j3oj2*g,Math.abs(p+1)>15e-13?a.xlcof=-.25*e.j3oj2*g*(3+5*p)/(1+p):a.xlcof=-.25*e.j3oj2*g*(3+5*p)/ge);var pe=le*Math.cos(C);U=1/(Xe*(1-le*le));var me=le*Math.sin(C)+U*a.aycof,ve=ee+C+se+U*a.xlcof*pe,qe=(ve-se)%e.twoPi;w=qe,L=9999.9;for(var Me=1;Math.abs(L)>=1e-12&&Me<=10;)A=Math.sin(w),u=Math.cos(w),L=1-u*pe-A*me,L=(qe-me*u+pe*A-w)/L,Math.abs(L)>=.95&&(L>0?L=.95:L=-.95),w+=L,Me+=1;var $=pe*u+me*A,z=pe*A-me*u,fe=pe*pe+me*me,xe=Xe*(1-fe);if(xe<0)return a.error=r.SatRecError.SemiLatusRectumBelowZero,null;var Le=Xe*(1-$),Ne=Math.sqrt(Xe)*z/Le,ot=Math.sqrt(xe)/Le,Qe=Math.sqrt(1-fe);U=z/(1+Qe);var xt=Xe/Le*(A-me-pe*U),bt=Xe/Le*(u-pe+me*U);E=Math.atan2(xt,bt);var nt=(bt+bt)*xt,At=1-2*xt*xt;U=1/xe;var Dt=.5*e.j2*U,Ot=Dt*U;a.method==="d"&&(v=p*p,a.con41=3*v-1,a.x1mth2=1-v,a.x7thm1=7*v-1);var dt=Le*(1-1.5*Ot*Qe*a.con41)+.5*Dt*a.x1mth2*At;if(dt<1)return a.error=r.SatRecError.Decayed,null;E-=.25*Ot*a.x7thm1*nt;var kt=se+1.5*Ot*p*nt,Lt=W+1.5*Ot*p*g*At,$t=Ne-J*Dt*a.x1mth2*nt/e.xke,ie=ot+J*Dt*(a.x1mth2*At+1.5*a.con41)/e.xke,Mt=Math.sin(E),je=Math.cos(E),q=Math.sin(kt),Pt=Math.cos(kt),wt=Math.sin(Lt),sn=Math.cos(Lt),$n=-q*sn,Rn=Pt*sn,tn=$n*Mt+Pt*je,vi=Rn*Mt+q*je,Wn=wt*Mt,ke=$n*je-Pt*Mt,it=Rn*je-q*Mt,pt=wt*je,et={x:dt*tn*e.earthRadius,y:dt*vi*e.earthRadius,z:dt*Wn*e.earthRadius},c={x:($t*tn+ie*ke)*e.vkmpersec,y:($t*vi+ie*it)*e.vkmpersec,z:($t*Wn+ie*pt)*e.vkmpersec};return{position:et,velocity:c,meanElements:st}}}(ty)),ty}var jM;function Ame(){return jM||(jM=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var e=po(),t=a(BI()),i=a(ume()),r=a(cme()),s=a(hme()),o=a(V5());function a(u){return u&&u.__esModule?u:{default:u}}function l(u,A){var p=A.opsmode,g=A.satn,v=A.epoch,y=A.xbstar,b=A.xecco,w=A.xargpo,S=A.xinclo,C=A.xmo,E=A.xno,R=A.xnodeo,D,B,L,U,P,F,V,H,j,J,Z,W,K,ee,se,ge,de,Ae,Be,ye,De,We,$e,Ke,Xe,st,gt,ae,le,G,Te,pe,me,ve,qe,Me,$,z,fe,xe,Le,Ne,ot,Qe,xt,bt,nt,At,Dt,Ot,dt,kt,Lt,$t,ie,Mt,je=15e-13,q=u;q.isimp=0,q.method="n",q.aycof=0,q.con41=0,q.cc1=0,q.cc4=0,q.cc5=0,q.d2=0,q.d3=0,q.d4=0,q.delmo=0,q.eta=0,q.argpdot=0,q.omgcof=0,q.sinmao=0,q.t=0,q.t2cof=0,q.t3cof=0,q.t4cof=0,q.t5cof=0,q.x1mth2=0,q.x7thm1=0,q.mdot=0,q.nodedot=0,q.xlcof=0,q.xmcof=0,q.nodecf=0,q.irez=0,q.d2201=0,q.d2211=0,q.d3210=0,q.d3222=0,q.d4410=0,q.d4422=0,q.d5220=0,q.d5232=0,q.d5421=0,q.d5433=0,q.dedt=0,q.del1=0,q.del2=0,q.del3=0,q.didt=0,q.dmdt=0,q.dnodt=0,q.domdt=0,q.e3=0,q.ee2=0,q.peo=0,q.pgho=0,q.pho=0,q.pinco=0,q.plo=0,q.se2=0,q.se3=0,q.sgh2=0,q.sgh3=0,q.sgh4=0,q.sh2=0,q.sh3=0,q.si2=0,q.si3=0,q.sl2=0,q.sl3=0,q.sl4=0,q.gsto=0,q.xfact=0,q.xgh2=0,q.xgh3=0,q.xgh4=0,q.xh2=0,q.xh3=0,q.xi2=0,q.xi3=0,q.xl2=0,q.xl3=0,q.xl4=0,q.xlamo=0,q.zmol=0,q.zmos=0,q.atime=0,q.xli=0,q.xni=0,q.bstar=y,q.ecco=b,q.argpo=w,q.inclo=S,q.mo=C,q.no=E,q.nodeo=R,q.operationmode=p;var Pt=78/e.earthRadius+1,wt=42/e.earthRadius,sn=wt*wt*wt*wt;q.init="y",q.t=0;var $n={satn:g,ecco:q.ecco,epoch:v,inclo:q.inclo,no:q.no,method:q.method,opsmode:q.operationmode},Rn=(0,s.default)($n),tn=Rn.ao,vi=Rn.con42,Wn=Rn.cosio,ke=Rn.cosio2,it=Rn.eccsq,pt=Rn.omeosq,et=Rn.posq,c=Rn.rp,X=Rn.rteosq,dn=Rn.sinio;if(q.no=Rn.no,q.con41=Rn.con41,q.gsto=Rn.gsto,q.a=Math.pow(q.no*e.tumin,-2/3),q.alta=q.a*(1+q.ecco)-1,q.altp=q.a*(1-q.ecco)-1,q.error=0,pt>=0||q.no>=0){if(q.isimp=0,c<220/e.earthRadius+1&&(q.isimp=1),gt=Pt,De=sn,Ae=(c-1)*e.earthRadius,Ae<156){gt=Ae-78,Ae<98&&(gt=20);var Nn=(120-gt)/e.earthRadius;De=Nn*Nn*Nn*Nn,gt=gt/e.earthRadius+1}Be=1/et,bt=1/(tn-gt),q.eta=tn*q.ecco*bt,W=q.eta*q.eta,Z=q.ecco*q.eta,ye=Math.abs(1-W),F=De*Math.pow(bt,4),V=F/Math.pow(ye,3.5),U=V*q.no*(tn*(1+1.5*W+Z*(4+W))+.375*e.j2*bt/ye*q.con41*(8+3*W*(8+W))),q.cc1=q.bstar*U,P=0,q.ecco>1e-4&&(P=-2*F*bt*e.j3oj2*q.no*dn/q.ecco),q.x1mth2=1-ke,q.cc4=2*q.no*V*tn*pt*(q.eta*(2+.5*W)+q.ecco*(.5+2*W)-e.j2*bt/(tn*ye)*(-3*q.con41*(1-2*Z+W*(1.5-.5*Z))+.75*q.x1mth2*(2*W-Z*(1+W))*Math.cos(2*q.argpo))),q.cc5=2*V*tn*pt*(1+2.75*(W+Z)+Z*W),H=ke*ke,ot=1.5*e.j2*Be*q.no,Qe=.5*ot*e.j2*Be,xt=-.46875*e.j4*Be*Be*q.no,q.mdot=q.no+.5*ot*X*q.con41+.0625*Qe*X*(13-78*ke+137*H),q.argpdot=-.5*ot*vi+.0625*Qe*(7-114*ke+395*H)+xt*(3-36*ke+49*H),At=-ot*Wn,q.nodedot=At+(.5*Qe*(4-19*ke)+2*xt*(3-7*ke))*Wn,nt=q.argpdot+q.nodedot,q.omgcof=q.bstar*P*Math.cos(q.argpo),q.xmcof=0,q.ecco>1e-4&&(q.xmcof=-e.x2o3*F*q.bstar/Z),q.nodecf=3.5*pt*At*q.cc1,q.t2cof=1.5*q.cc1,Math.abs(Wn+1)>15e-13?q.xlcof=-.25*e.j3oj2*dn*(3+5*Wn)/(1+Wn):q.xlcof=-.25*e.j3oj2*dn*(3+5*Wn)/je,q.aycof=-.5*e.j3oj2*dn;var Kn=1+q.eta*Math.cos(q.mo);if(q.delmo=Kn*Kn*Kn,q.sinmao=Math.sin(q.mo),q.x7thm1=7*ke-1,2*e.pi/q.no>=225){q.method="d",q.isimp=1,Le=0,se=q.inclo;var an={epoch:v,ep:q.ecco,argpp:q.argpo,tc:Le,inclp:q.inclo,nodep:q.nodeo,np:q.no,e3:q.e3,ee2:q.ee2,peo:q.peo,pgho:q.pgho,pho:q.pho,pinco:q.pinco,plo:q.plo,se2:q.se2,se3:q.se3,sgh2:q.sgh2,sgh3:q.sgh3,sgh4:q.sgh4,sh2:q.sh2,sh3:q.sh3,si2:q.si2,si3:q.si3,sl2:q.sl2,sl3:q.sl3,sl4:q.sl4,xgh2:q.xgh2,xgh3:q.xgh3,xgh4:q.xgh4,xh2:q.xh2,xh3:q.xh3,xi2:q.xi2,xi3:q.xi3,xl2:q.xl2,xl3:q.xl3,xl4:q.xl4,zmol:q.zmol,zmos:q.zmos},ht=(0,i.default)(an);q.e3=ht.e3,q.ee2=ht.ee2,q.peo=ht.peo,q.pgho=ht.pgho,q.pho=ht.pho,q.pinco=ht.pinco,q.plo=ht.plo,q.se2=ht.se2,q.se3=ht.se3,q.sgh2=ht.sgh2,q.sgh3=ht.sgh3,q.sgh4=ht.sgh4,q.sh2=ht.sh2,q.sh3=ht.sh3,q.si2=ht.si2,q.si3=ht.si3,q.sl2=ht.sl2,q.sl3=ht.sl3,q.sl4=ht.sl4,B=ht.sinim,D=ht.cosim,j=ht.em,J=ht.emsq,We=ht.s1,$e=ht.s2,Ke=ht.s3,Xe=ht.s4,st=ht.s5,ae=ht.ss1,le=ht.ss2,G=ht.ss3,Te=ht.ss4,pe=ht.ss5,me=ht.sz1,ve=ht.sz3,qe=ht.sz11,Me=ht.sz13,$=ht.sz21,z=ht.sz23,fe=ht.sz31,xe=ht.sz33,q.xgh2=ht.xgh2,q.xgh3=ht.xgh3,q.xgh4=ht.xgh4,q.xh2=ht.xh2,q.xh3=ht.xh3,q.xi2=ht.xi2,q.xi3=ht.xi3,q.xl2=ht.xl2,q.xl3=ht.xl3,q.xl4=ht.xl4,q.zmol=ht.zmol,q.zmos=ht.zmos,de=ht.nm,Dt=ht.z1,Ot=ht.z3,dt=ht.z11,kt=ht.z13,Lt=ht.z21,$t=ht.z23,ie=ht.z31,Mt=ht.z33;var tr={inclo:se,init:q.init,ep:q.ecco,inclp:q.inclo,nodep:q.nodeo,argpp:q.argpo,mp:q.mo,opsmode:q.operationmode},un=(0,t.default)(q,tr);q.ecco=un.ep,q.inclo=un.inclp,q.nodeo=un.nodep,q.argpo=un.argpp,q.mo=un.mp,K=0,ee=0,ge=0;var qt={cosim:D,emsq:J,argpo:q.argpo,s1:We,s2:$e,s3:Ke,s4:Xe,s5:st,sinim:B,ss1:ae,ss2:le,ss3:G,ss4:Te,ss5:pe,sz1:me,sz3:ve,sz11:qe,sz13:Me,sz21:$,sz23:z,sz31:fe,sz33:xe,t:q.t,tc:Le,gsto:q.gsto,mo:q.mo,mdot:q.mdot,no:q.no,nodeo:q.nodeo,nodedot:q.nodedot,xpidot:nt,z1:Dt,z3:Ot,z11:dt,z13:kt,z21:Lt,z23:$t,z31:ie,z33:Mt,ecco:q.ecco,eccsq:it,em:j,argpm:K,inclm:se,mm:ge,nm:de,nodem:ee,irez:q.irez,atime:q.atime,d2201:q.d2201,d2211:q.d2211,d3210:q.d3210,d3222:q.d3222,d4410:q.d4410,d4422:q.d4422,d5220:q.d5220,d5232:q.d5232,d5421:q.d5421,d5433:q.d5433,dedt:q.dedt,didt:q.didt,dmdt:q.dmdt,dnodt:q.dnodt,domdt:q.domdt,del1:q.del1,del2:q.del2,del3:q.del3,xfact:q.xfact,xlamo:q.xlamo,xli:q.xli,xni:q.xni},cn=(0,r.default)(qt);q.irez=cn.irez,q.atime=cn.atime,q.d2201=cn.d2201,q.d2211=cn.d2211,q.d3210=cn.d3210,q.d3222=cn.d3222,q.d4410=cn.d4410,q.d4422=cn.d4422,q.d5220=cn.d5220,q.d5232=cn.d5232,q.d5421=cn.d5421,q.d5433=cn.d5433,q.dedt=cn.dedt,q.didt=cn.didt,q.dmdt=cn.dmdt,q.dnodt=cn.dnodt,q.domdt=cn.domdt,q.del1=cn.del1,q.del2=cn.del2,q.del3=cn.del3,q.xfact=cn.xfact,q.xlamo=cn.xlamo,q.xli=cn.xli,q.xni=cn.xni}q.isimp!==1&&(L=q.cc1*q.cc1,q.d2=4*tn*bt*L,Ne=q.d2*bt*q.cc1/3,q.d3=(17*tn+gt)*Ne,q.d4=.5*Ne*tn*bt*(221*tn+31*gt)*q.cc1,q.t3cof=q.d2+2*L,q.t4cof=.25*(3*q.d3+q.cc1*(12*q.d2+10*L)),q.t5cof=.2*(3*q.d4+12*q.cc1*q.d3+6*q.d2*q.d2+15*L*(2*q.d2+L)))}(0,o.default)(q,0),q.init="n"}}(Qv)),Qv}var XM;function dme(){if(XM)return B0;XM=1,Object.defineProperty(B0,"__esModule",{value:!0}),B0.json2satrec=s,B0.twoline2satrec=r;var n=po(),e=b_(),t=i(Ame());function i(o){return o&&o.__esModule?o:{default:o}}function r(o,a){var l="i",u=0,A=o.substring(2,7),p=parseInt(o.substring(18,20),10),g=parseFloat(o.substring(20,32)),v=parseFloat(o.substring(33,43)),y=parseFloat("".concat(o.substring(44,45),".").concat(o.substring(45,50),"E").concat(o.substring(50,52))),b=parseFloat("".concat(o.substring(53,54),".").concat(o.substring(54,59),"E").concat(o.substring(59,61))),w=parseFloat(a.substring(8,16))*n.deg2rad,S=parseFloat(a.substring(17,25))*n.deg2rad,C=parseFloat(".".concat(a.substring(26,33))),E=parseFloat(a.substring(34,42))*n.deg2rad,R=parseFloat(a.substring(43,51))*n.deg2rad,D=parseFloat(a.substring(52,63))/n.xpdotp,B=p<57?p+2e3:p+1900,L=(0,e.days2mdhms)(B,g),U=L.mon,P=L.day,F=L.hr,V=L.minute,H=L.sec,j=(0,e.jday)(B,U,P,F,V,H),J={error:u,satnum:A,epochyr:p,epochdays:g,ndot:v,nddot:y,bstar:b,inclo:w,nodeo:S,ecco:C,argpo:E,mo:R,no:D,jdsatepoch:j};return(0,t.default)(J,{opsmode:l,satn:J.satnum,epoch:J.jdsatepoch-24332815e-1,xbstar:J.bstar,xecco:J.ecco,xargpo:J.argpo,xinclo:J.inclo,xmo:J.mo,xno:J.no,xnodeo:J.nodeo}),J}function s(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"i",l=0,u=o.NORAD_CAT_ID.toString(),A=new Date(o.EPOCH+"Z"),p=A.getUTCFullYear(),g=Number(p.toString().slice(-2)),v=(A.valueOf()-new Date(Date.UTC(p,0,1,0,0,0)).valueOf())/(86400*1e3)+1,y=Number(o.MEAN_MOTION_DOT),b=Number(o.MEAN_MOTION_DDOT),w=Number(o.BSTAR),S=Number(o.INCLINATION)*n.deg2rad,C=Number(o.RA_OF_ASC_NODE)*n.deg2rad,E=Number(o.ECCENTRICITY),R=Number(o.ARG_OF_PERICENTER)*n.deg2rad,D=Number(o.MEAN_ANOMALY)*n.deg2rad,B=Number(o.MEAN_MOTION)/n.xpdotp,L=(0,e.days2mdhms)(p,v),U=L.mon,P=L.day,F=L.hr,V=L.minute,H=L.sec,j=(0,e.jday)(p,U,P,F,V,H),J={error:l,satnum:u,epochyr:g,epochdays:v,ndot:y,nddot:b,bstar:w,inclo:S,nodeo:C,ecco:E,argpo:R,mo:D,no:B,jdsatepoch:j};return(0,t.default)(J,{opsmode:a,satn:J.satnum,epoch:J.jdsatepoch-24332815e-1,xbstar:J.bstar,xecco:J.ecco,xargpo:J.argpo,xinclo:J.inclo,xmo:J.mo,xno:J.no,xnodeo:J.nodeo}),J}return B0}var iy={},ry={},QM;function pme(){return QM||(QM=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=s;var e=po(),t=b_(),i=r(V5());function r(o){return o&&o.__esModule?o:{default:o}}function s(o){for(var a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];var A=t.jday.apply(void 0,l),p=(A-o.jdsatepoch)*e.minutesPerDay;return(0,i.default)(o,p)}}(ry)),ry}var YM;function mme(){return YM||(YM=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"gstime",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"propagate",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"sgp4",{enumerable:!0,get:function(){return t.default}});var e=r(pme()),t=r(V5()),i=r(FI());function r(s){return s&&s.__esModule?s:{default:s}}}(iy)),iy}var sy={},ZM;function gme(){return ZM||(ZM=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=i;var e=7292115e-11,t=299792.458;function i(r,s,o){var a=s.x-r.x,l=s.y-r.y,u=s.z-r.z,A=Math.sqrt(Math.pow(a,2)+Math.pow(l,2)+Math.pow(u,2)),p={x:o.x+e*r.y,y:o.y-e*r.x,z:o.z},g=(a*p.x+l*p.y+u*p.z)/A;return 1-g/t}}(sy)),sy}var Qs={},KM;function _me(){if(KM)return Qs;KM=1,Object.defineProperty(Qs,"__esModule",{value:!0}),Qs.degreesLat=i,Qs.degreesLong=r,Qs.degreesToRadians=t,Qs.ecfToEci=u,Qs.ecfToLookAngles=v,Qs.eciToEcf=A,Qs.eciToGeodetic=l,Qs.geodeticToEcf=a,Qs.radiansLat=s,Qs.radiansLong=o,Qs.radiansToDegrees=e;var n=po();function e(y){return y*n.rad2deg}function t(y){return y*n.deg2rad}function i(y){if(y<-n.pi/2||y>n.pi/2)throw new RangeError("Latitude radians must be in range [-pi/2; pi/2].");return e(y)}function r(y){if(y<-n.pi||y>n.pi)throw new RangeError("Longitude radians must be in range [-pi; pi].");return e(y)}function s(y){if(y<-90||y>90)throw new RangeError("Latitude degrees must be in range [-90; 90].");return t(y)}function o(y){if(y<-180||y>180)throw new RangeError("Longitude degrees must be in range [-180; 180].");return t(y)}function a(y){var b=y.longitude,w=y.latitude,S=y.height,C=6378.137,E=6356.7523142,R=(C-E)/C,D=2*R-R*R,B=C/Math.sqrt(1-D*(Math.sin(w)*Math.sin(w))),L=(B+S)*Math.cos(w)*Math.cos(b),U=(B+S)*Math.cos(w)*Math.sin(b),P=(B*(1-D)+S)*Math.sin(w);return{x:L,y:U,z:P}}function l(y,b){for(var w=6378.137,S=6356.7523142,C=Math.sqrt(y.x*y.x+y.y*y.y),E=(w-S)/w,R=2*E-E*E,D=Math.atan2(y.y,y.x)-b;D<-n.pi;)D+=n.twoPi;for(;D>n.pi;)D-=n.twoPi;for(var B=20,L=0,U=Math.atan2(y.z,Math.sqrt(y.x*y.x+y.y*y.y)),P;L++<B;)P=1/Math.sqrt(1-R*(Math.sin(U)*Math.sin(U))),U=Math.atan2(y.z+w*P*R*Math.sin(U),C);var F=C/Math.cos(U)-w*P;return{longitude:D,latitude:U,height:F}}function u(y,b){var w=y.x*Math.cos(b)-y.y*Math.sin(b),S=y.x*Math.sin(b)+y.y*Math.cos(b),C=y.z;return{x:w,y:S,z:C}}function A(y,b){var w=y.x*Math.cos(b)+y.y*Math.sin(b),S=y.x*-Math.sin(b)+y.y*Math.cos(b),C=y.z;return{x:w,y:S,z:C}}function p(y,b){var w=y.longitude,S=y.latitude,C=a(y),E=b.x-C.x,R=b.y-C.y,D=b.z-C.z,B=Math.sin(S)*Math.cos(w)*E+Math.sin(S)*Math.sin(w)*R-Math.cos(S)*D,L=-Math.sin(w)*E+Math.cos(w)*R,U=Math.cos(S)*Math.cos(w)*E+Math.cos(S)*Math.sin(w)*R+Math.sin(S)*D;return{topS:B,topE:L,topZ:U}}function g(y){var b=y.topS,w=y.topE,S=y.topZ,C=Math.sqrt(b*b+w*w+S*S),E=Math.asin(S/C),R=Math.atan2(-w,b)+n.pi;return{azimuth:R,elevation:E,rangeSat:C}}function v(y,b){var w=p(y,b);return g(w)}return Qs}var w1={},JM;function vme(){if(JM)return w1;JM=1,Object.defineProperty(w1,"__esModule",{value:!0}),w1.sunPos=e;var n=po();function e(t){var i=(t-2451545)/36525,r=(280.46+36000.77*i)%360,s=i,o=(357.5277233+35999.05034*s*n.deg2rad)%n.twoPi;o<0&&(o+=n.twoPi);var a=(r+1.914666471*Math.sin(o)+.019994643*Math.sin(2*o))%360*n.deg2rad,l=(23.439291-.0130042*s)*n.deg2rad,u=1.000140612-.016708617*Math.cos(o)-139589e-9*Math.cos(2*o),A=[u*Math.cos(a),u*Math.cos(l)*Math.sin(a),u*Math.sin(l)*Math.sin(a)],p=Math.atan(Math.cos(l)*Math.tan(a)),g=a;g<0&&(g+=n.twoPi);var v=p;Math.abs(a-v)>n.pi*.5&&(v+=.5*n.pi*Math.round((a-p)/(.5*n.pi)));var y=Math.asin(Math.sin(l)*Math.sin(a));return{rsun:A,rtasc:v,decl:y}}return w1}var oy={},e7;function yme(){return e7||(e7=1,Object.defineProperty(oy,"__esModule",{value:!0})),oy}var t7;function xme(){return t7||(t7=1,function(n){function e(b){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},e(b)}Object.defineProperty(n,"__esModule",{value:!0});var t={constants:!0,jday:!0,invjday:!0,twoline2satrec:!0,json2satrec:!0,propagate:!0,sgp4:!0,gstime:!0,dopplerFactor:!0,radiansToDegrees:!0,degreesToRadians:!0,degreesLat:!0,degreesLong:!0,radiansLat:!0,radiansLong:!0,geodeticToEcf:!0,eciToGeodetic:!0,eciToEcf:!0,ecfToEci:!0,ecfToLookAngles:!0,sunPos:!0,SatRecError:!0};Object.defineProperty(n,"SatRecError",{enumerable:!0,get:function(){return A.SatRecError}}),n.constants=void 0,Object.defineProperty(n,"degreesLat",{enumerable:!0,get:function(){return l.degreesLat}}),Object.defineProperty(n,"degreesLong",{enumerable:!0,get:function(){return l.degreesLong}}),Object.defineProperty(n,"degreesToRadians",{enumerable:!0,get:function(){return l.degreesToRadians}}),Object.defineProperty(n,"dopplerFactor",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"ecfToEci",{enumerable:!0,get:function(){return l.ecfToEci}}),Object.defineProperty(n,"ecfToLookAngles",{enumerable:!0,get:function(){return l.ecfToLookAngles}}),Object.defineProperty(n,"eciToEcf",{enumerable:!0,get:function(){return l.eciToEcf}}),Object.defineProperty(n,"eciToGeodetic",{enumerable:!0,get:function(){return l.eciToGeodetic}}),Object.defineProperty(n,"geodeticToEcf",{enumerable:!0,get:function(){return l.geodeticToEcf}}),Object.defineProperty(n,"gstime",{enumerable:!0,get:function(){return o.gstime}}),Object.defineProperty(n,"invjday",{enumerable:!0,get:function(){return r.invjday}}),Object.defineProperty(n,"jday",{enumerable:!0,get:function(){return r.jday}}),Object.defineProperty(n,"json2satrec",{enumerable:!0,get:function(){return s.json2satrec}}),Object.defineProperty(n,"propagate",{enumerable:!0,get:function(){return o.propagate}}),Object.defineProperty(n,"radiansLat",{enumerable:!0,get:function(){return l.radiansLat}}),Object.defineProperty(n,"radiansLong",{enumerable:!0,get:function(){return l.radiansLong}}),Object.defineProperty(n,"radiansToDegrees",{enumerable:!0,get:function(){return l.radiansToDegrees}}),Object.defineProperty(n,"sgp4",{enumerable:!0,get:function(){return o.sgp4}}),Object.defineProperty(n,"sunPos",{enumerable:!0,get:function(){return u.sunPos}}),Object.defineProperty(n,"twoline2satrec",{enumerable:!0,get:function(){return s.twoline2satrec}});var i=y(po());n.constants=i;var r=b_(),s=dme(),o=mme(),a=g(gme()),l=_me(),u=vme(),A=UI(),p=yme();Object.keys(p).forEach(function(b){b==="default"||b==="__esModule"||Object.prototype.hasOwnProperty.call(t,b)||b in n&&n[b]===p[b]||Object.defineProperty(n,b,{enumerable:!0,get:function(){return p[b]}})});function g(b){return b&&b.__esModule?b:{default:b}}function v(b){if(typeof WeakMap!="function")return null;var w=new WeakMap,S=new WeakMap;return(v=function(E){return E?S:w})(b)}function y(b,w){if(b&&b.__esModule)return b;if(b===null||e(b)!="object"&&typeof b!="function")return{default:b};var S=v(w);if(S&&S.has(b))return S.get(b);var C={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in b)if(R!=="default"&&{}.hasOwnProperty.call(b,R)){var D=E?Object.getOwnPropertyDescriptor(b,R):null;D&&(D.get||D.set)?Object.defineProperty(C,R,D):C[R]=b[R]}return C.default=b,S&&S.set(b,C),C}}(Xv)),Xv}var FA=xme();function bme(n,e){const t=[],i=n.split(`
`);let r=null;for(let s=0;s<i.length;++s){const o=i[s].trim();o.length!==0&&(o[0]==="1"?r.tle1=o:o[0]==="2"?r.tle2=o:(r={name:o,...e},t.push(r)))}return t}function n7(n){return{x:n.x,y:n.z,z:-n.y}}function Tme(n,e){if(!n.satrec){const{tle1:t,tle2:i}=n;if(!t||!i)return null;n.satrec=FA.twoline2satrec(t,i)}return FA.propagate(n.satrec,e)}function ay(n,e,t=1){if(!n||!e)return null;const i=Tme(n,e),r=i==null?void 0:i.position;if(!r)return null;if(t===2)return n7(r);const s=FA.gstime(e),o=FA.eciToEcf(r,s);return n7(o)}const Sme="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkU0NzRBMzdDQ0UzQzExRTlBQTNEQ0RGREI3NTMyNURBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkU0NzRBMzdEQ0UzQzExRTlBQTNEQ0RGREI3NTMyNURBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTQ3NEEzN0FDRTNDMTFFOUFBM0RDREZEQjc1MzI1REEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RTQ3NEEzN0JDRTNDMTFFOUFBM0RDREZEQjc1MzI1REEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7CiWTAAAADFklEQVR42uxbQWsTQRSerdVejbe0SGoWCQG95tR7kZyF2msPhRQU9CDoLbceehCsiseC5Bf4B0Q9eLAVpalIAlbavXV7tWrG93R2GR9idp3Z3Wn2ffDIkHZnvvdl9s3Oe7OelFKUGVOi5GABWAAWoNyYNlbQK1bDkRzxDCh0BqTEObAmWB2sClZR34dgAdgQrA92MkkCtMA66rOZ8BoU4Q3YI/WZGbwsngQhLvjK6TZYw7C7j2DPUQy43wdOCwCO15TjN8Au0r+fgYB5pXlV+Jd9MTc7JyoXzv+e/0fH4uDwQAw+DcSH/nvx4++B7QtYTwnx2RppFMCGecJbAnsBJnWbn52XqyurcufttkwK/F+8Bq+l/akxlmzxtuV8FyzUiS60FmTvWU+aAvvAvogIOFa3cAGAhA/2VCfXuNSQDx9sStvAPrFvIgSO7RcigHJ+Sye0fH1Zvn75SmYF7BvHICJsmYhgIsAfv/ydm7dlcBjIrIFj4Fh0JuQqgLrnYwL3796TeQPHJCJ0cxFARftQ/+WLApkJ4f+sDmmdr+lLHd6PeUz7f90OJCYgt1qWAqzr0T7LgJcmMJLVYT0TAVTU348GymKpM1kiNQH206wKaQTY0B9yXAN5WNpI6leafEA7aqzdWnNuX084ta3uBUDRlv5s7yrI3qFlcwZ0osbitUVnszuEW8fmDNiNlE2zq8sbyE2bAbuJfBuXD4A9Pqaxvkb7+W+j707n+M5OTev5hJmRHJ2YJkXjNBYmM1wH4Tg2BZdEgHrUwEyO6yAc6zYEqEYNTGO5DsKxakOAStxQOTyXQThWuDBiQYAwbhwdO+8Q4RjaECCIGpi6dh2EY2BDgGHUwLy96yAch8aFkdI/CKkOsFb3q+N32zvOOo/cNOf745xPswrEBcrHm0+cFYBwS1ZULft2OE1GaC/q3EbJyzaQk+b8HqfEOCnKaXEujHBpjIujXB7nAxJ8RIYPSeUgwGk+Jlf6g5J8VNZUgATvC2R6WNr0fYE8BNBh/bj8aRPAOviNEReD4KRVhlgAFoAFYAEmFj8FGAAJ0wP48QIIgAAAAABJRU5ErkJggg==",wme="./img/earth-night.jpg",OI=50,kI=1440,Mme=kI/(2*3.141592654),i7=new Date,Eme={backgroundColor:266521,defaultSatelliteColor:16711680,onStationClicked:null},Cme={orbitMinutes:0,satelliteSize:OI};class Rme{constructor(){Ei(this,"stations",[]);Ei(this,"referenceFrame",1);Ei(this,"handleWindowResize",()=>{const e=this.el.clientWidth,t=this.el.clientHeight;this.renderer.setSize(e,t),this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.render()});Ei(this,"handleMouseDown",e=>{const t=new rt(e.clientX/this.el.clientWidth*2-1,-(e.clientY/this.el.clientHeight)*2+1);this.raycaster.setFromCamera(t,this.camera);let i=null;const r=this.raycaster.intersectObjects(this.scene.children,!0);if(r&&r.length>0){const o=r[0].object;o&&(i=this._findStationFromMesh(o))}const s=this.options.onStationClicked;s&&s(i)});Ei(this,"addSatellite",(e,t,i)=>{const r=this._getSatelliteSprite(t,i),s=this._getSatellitePositionFromTle(e);if(!s)return;const o=this._getSatelliteApogeeHeight(e);r.position.set(s.x,s.y,s.z),e.mesh=r,e.mesh.apogee=o,this.stations.push(e),e.orbitMinutes>0&&this.addOrbit(e),this.earth.add(r)});Ei(this,"loadLteFileStations",(e,t,i)=>{const r={...Cme,...i};return fetch(e).then(s=>{if(s.ok)return s.text().then(o=>this._addTleFileStations(o,t,r))})});Ei(this,"addOrbit",e=>{if(e.orbitMinutes>0)return;const t=e.satrec.no*Mme,i=1,r=e.orbitMinutes||kI/t,s=new Date;this.orbitMaterial||(this.orbitMaterial=new Sh({color:10066329,opacity:1,transparent:!0}));const o=[];for(let u=0;u<=r;u+=i){const A=new Date(s.getTime()+u*6e4),p=ay(e,A,this.referenceFrame);p&&o.push(new re(p.x,p.y,p.z))}const a=new pi().setFromPoints(o),l=new Tp(a,this.orbitMaterial);e.orbit=l,e.mesh.material=this.selectedMaterial,this.earth.add(l),this.render()});Ei(this,"removeOrbit",e=>{!e||!e.orbit||(this.earth.remove(e.orbit),e.orbit.geometry.dispose(),e.orbit=null,e.mesh.material=this.material,this.render())});Ei(this,"highlightStation",e=>{e.mesh.material=this.highlightedMaterial});Ei(this,"clearStationHighlight",e=>{e.mesh.material=this.material});Ei(this,"setReferenceFrame",e=>{this.referenceFrame=e});Ei(this,"_addTleFileStations",(e,t,i)=>{const r=bme(e,i),{satelliteSize:s}=i;return r.forEach(o=>{this.addSatellite(o,t,s)}),this.render(),r});Ei(this,"_getSatelliteMesh",(e,t)=>(e=e||this.options.defaultSatelliteColor,t=t||OI,this.geometry||(this.geometry=new(void 0)(t,t,t),this.material=new vg({color:e,emissive:16728128,flatShading:!1,side:ar})),new Jn(this.geometry,this.material)));Ei(this,"_setupSpriteMaterials",e=>{this.material&&this.lastColor===e||(this._satelliteSprite=new yg().load(Sme,this.render),this.selectedMaterial=new Qf({map:this._satelliteSprite,color:16711680,sizeAttenuation:!1}),this.highlightedMaterial=new Qf({map:this._satelliteSprite,color:16556800,sizeAttenuation:!1}),this.material=new Qf({map:this._satelliteSprite,color:e,sizeAttenuation:!1}),this.lastColor=e)});Ei(this,"_getSatelliteSprite",(e,t)=>{this._setupSpriteMaterials(e);const r=new R9(this.material);return r.scale.set(t/5e3,t/5e3,1),r});Ei(this,"_getSatellitePositionFromTle",(e,t)=>(t=t||i7,ay(e,t,this.referenceFrame)));Ei(this,"_getSatelliteApogeeHeight",e=>{if(!e.satrec){const{tle1:p,tle2:g}=e;if(!p||!g)return null;e.satrec=FA.twoline2satrec(p,g)}const t=e.satrec,i=398600.4418,r=6378.137,s=t.no,o=t.ecco;if(!s||!o||Number.isNaN(s)||Number.isNaN(o))return null;const a=s*(1440/(2*Math.PI));return(i/(a*2*Math.PI/86400)**2)**(1/3)*(1+o)-r});Ei(this,"updateSatellitePosition",(e,t)=>{t=t||i7;const i=ay(e,t,this.referenceFrame);i&&e.mesh.position.set(i.x,i.y,i.z)});Ei(this,"updateAllPositions",e=>{this.stations&&(this.stations.forEach(t=>{this.updateSatellitePosition(t,e)}),this.referenceFrame===2?this._updateEarthRotation(e):this.render())});Ei(this,"_updateEarthRotation",e=>{const t=FA.gstime(e);this.earthMesh.setRotationFromEuler(new jr(0,t,0)),this.render()});Ei(this,"_setupScene",()=>{const e=this.el.clientWidth,t=this.el.clientHeight;this.scene=new zA,this._setupCamera(e,t),this.renderer=new eb({logarithmicDepthBuffer:!0,antialias:!0}),this.renderer.setClearColor(new Gt(this.options.backgroundColor)),this.renderer.setSize(e,t),this.el.appendChild(this.renderer.domElement)});Ei(this,"_setupLights",()=>{const e=new W9(16777215,1,0);e.position.set(0,59333894,-137112541);const t=new k2(9474192);this.scene.add(e),this.scene.add(t)});Ei(this,"_addBaseObjects",()=>{this._addEarth()});Ei(this,"render",()=>{this.renderer.render(this.scene,this.camera)});Ei(this,"_addEarth",()=>{const e=new yg,t=new vs,i=t.remove;t.remove=function(...o){return o.forEach(a=>{this.children.includes(a)?console.log("Removing from group:",a):console.warn("Object not in group:",a)}),i.apply(this,o)};const r=new Fa(lme.earthRadius,50,50),s=new vg({side:ar,flatShading:!1,map:e.load(wme,this.render)});this.earthMesh=new Jn(r,s),t.add(this.earthMesh),this.earth=t,this.scene.add(this.earth)});Ei(this,"_findStationFromMesh",e=>{for(let t=0;t<this.stations.length;++t){const i=this.stations[t];if(i.mesh===e)return i}return null})}initialize(e,t={}){this.el=e,this.raycaster=new jH,this.options={...Eme,...t},this._setupScene(),this._setupLights(),this._addBaseObjects(),this.render(),window.addEventListener("resize",this.handleWindowResize),window.addEventListener("pointerdown",this.handleMouseDown)}dispose(){window.removeEventListener("pointerdown",this.handleMouseDown),window.removeEventListener("resize",this.handleWindowResize),this.raycaster=null,this.el=null,this.controls.dispose()}_setupCamera(e,t){this.camera=new Er(54,e/t,1e-6,1e27),this.controls=new Qpe(this.camera,this.el),this.controls.enablePan=!1,this.controls.addEventListener("change",()=>this.render()),this.camera.position.z=-15e3,this.camera.position.x=15e3,this.camera.lookAt(0,0,0)}}let ly;function Nme(){if(ly)return ly;let n=null;const e=new Map,t=new Map;return ly={observe:({element:r,enterCallback:s,leaveCallback:o,options:a})=>(n||(n=new IntersectionObserver(l=>{for(const u of l){const A=e.get(u.target),p=t.get(u.target);u.isIntersecting&&A?A():p&&p()}},a)),s&&e.set(r,s),o&&t.set(r,o),n.observe(r),()=>{e.delete(r),t.delete(r),n.unobserve(r),e.size===0&&t.size===0&&(n.disconnect(),n=null)})}}const r7="EARTH",M1="APOGEE_2000",U0="STARLINK",Pme="ONEWEB",Lme="KUIPER",E1="ONEWEB_KUIPER",s7="ALL",Dme="./active_satellites.txt",Ime=16777215,Bme=2e3,Fme=1e3,Ume=Ct({__name:"leo-3d-earth-satellite",setup(n){const e={allChildren:[],initialDate:new Date().getTime()-864e5,currentDate:new Date().getTime(),referenceFrame:1},t=Fi(null),i=Fi(null),r=new Rme;let s=null;fu(()=>{r.referenceFrame=e.referenceFrame,r.initialize(i.value,{}),o(),r.updateAllPositions(new Date),A()}),l4(()=>{s&&clearInterval(s)});function o(){r.loadLteFileStations(Dme,Ime).then(p=>{e.allChildren=l(p),r.earth.children=e.allChildren})}function a(p){const v={[M1]:y=>y.includes(M1),[U0]:y=>y.includes(U0),[E1]:y=>y.includes(E1),[s7]:()=>!0}[p];if(!v){console.warn("Unknown filter:",p);return}r.earth.children=e.allChildren.filter(y=>y.label===r7||v(y.label)),r.render()}function l(p){return Array.from(r.earth.children).map(g=>{const{uuid:v}=g,y=p.find(b=>{var w;return((w=b.mesh)==null?void 0:w.uuid)===v});return y?(g.name=y.name||"",g.label=u(y)):g.label=r7,g})}function u(p){const g=[];return p.name.includes(U0)&&g.push(U0),(p.name.includes(Pme)||p.name.includes(Lme))&&g.push(E1),p.mesh.apogee<Bme&&g.push(M1),g}function A(){const{observe:p}=Nme();p({element:t.value,enterCallback:()=>{s=setInterval(()=>{r.updateAllPositions(new Date)},Fme)},leaveCallback:()=>{s&&clearInterval(s),s=null,r.updateAllPositions(new Date(e.currentDate))},options:{threshold:.5}})}return(p,g)=>(yt(),Rt("div",{ref_key:"root",ref:t},[Ee("button",{class:"p-3 border-solid border bg-white text-black",onClick:g[0]||(g[0]=v=>a(Ze(M1)))},Ft("Apogee Height < 2000")),Ee("button",{class:"p-3 border-solid border bg-white text-black",onClick:g[1]||(g[1]=v=>a(Ze(U0)))}," STARLINK "),Ee("button",{class:"p-3 border-solid border bg-white text-black",onClick:g[2]||(g[2]=v=>a(Ze(E1)))}," ONEWEB/KUIPER "),Ee("button",{class:"p-3 border-solid border bg-white text-black",onClick:g[3]||(g[3]=v=>a(Ze(s7)))}," ALL "),Ee("div",{id:"earth",ref_key:"el",ref:i,class:"w-[600px] h-[600px]"},null,512)],512))}}),Ome={};function kme(n,e){return yt(),Rt("div",null,"feature-grid")}const VI=er(Ome,[["render",kme]]),Vme={class:"leo-read-more"},zme={key:0,class:"text-2xl font-bold mb-4"},qme={class:"list-disc pl-5"},Gme=["href"],T_=Ct({__name:"leo-read-more",props:{title:{},data:{}},setup(n){return(e,t)=>(yt(),Rt("div",Vme,[e.title?(yt(),Rt("h2",zme,Ft(e.title),1)):wr("",!0),Ee("ul",qme,[(yt(!0),Rt(sr,null,lg(e.data,(i,r)=>(yt(),Rt("li",{key:r},[Ee("a",{href:i.link,class:"text-blue-500 hover:underline"},Ft(i.title),9,Gme)]))),128))])]))}}),Hme=Ct({__name:"section1",setup(n){return(e,t)=>(yt(),Rt("div",null,[Ut(Ume),Ut(Hp,{chapter:"01"},{default:Sr(()=>[Ee("p",null,Ft(Ze(So).title),1),Ee("p",null,Ft(Ze(So).subTitle),1)]),_:1}),Ee("p",null,Ft(Ze(So).p1t1),1),Ut(VI),Ut(T_,{title:Ze(So).relatedTitle,data:[{title:Ze(So).related1Title,link:Ze(So).related1Link},{title:Ze(So).related2Title,link:Ze(So).related2Link},{title:Ze(So).related3Title,link:Ze(So).related3Link}]},null,8,["title","data"])]))}}),Wme=Ct({__name:"section2",setup(n){return(e,t)=>(yt(),Rt("div",null,[Ut(Hp,{chapter:"02"},{default:Sr(()=>[Ee("p",null,Ft(Ze($i).title),1),Ee("p",null,Ft(Ze($i).subTitle),1)]),_:1}),Ee("p",null,Ft(Ze($i).p1t1),1),Ee("p",null,Ft(Ze($i).p1t2),1),t[0]||(t[0]=Ee("figure",null,[Ee("div",{class:"flourish-embed flourish-chart","data-src":"visualisation/20500490"})],-1)),Ee("p",null,Ft(Ze($i).p2t1),1),t[1]||(t[1]=Ee("figure",null,[Ee("div",{class:"flourish-embed flourish-chart","data-src":"visualisation/20500490"})],-1)),Ee("p",null,Ft(Ze($i).p3t1),1),Ee("p",null,Ft(Ze($i).p3t2),1),t[2]||(t[2]=Ee("figure",null,[Ee("div",{class:"flourish-embed flourish-chart","data-src":"visualisation/23265551"})],-1)),Ee("p",null,Ft(Ze($i).p4t1),1),Ee("figure",null,[Ee("figcaption",null,Ft(Ze($i).g4Title),1),Ut(O5),Ee("figcaption",null,Ft(Ze($i).g4Caption),1)]),Ee("p",null,Ft(Ze($i).p5t1),1),Ee("p",null,Ft(Ze($i).p5t2),1),Ut(T_,{title:Ze($i).relatedTitle,data:[{title:Ze($i).related1Title,link:Ze($i).related1Link},{title:Ze($i).related2Title,link:Ze($i).related2Link},{title:Ze($i).related3Title,link:Ze($i).related3Link},{title:Ze($i).related4Title,link:Ze($i).related4Link}]},null,8,["title","data"])]))}}),uy={type:"change"},z5={type:"start"},q5={type:"end"},o7=1e-6,ai={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},C1=new rt,Du=new rt,$me=new re,R1=new re,cy=new re,bf=new eu,a7=new re,N1=new re,hy=new re,P1=new re;class jme extends j9{constructor(e,t=null){super(e,t),this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:na.ROTATE,MIDDLE:na.DOLLY,RIGHT:na.PAN},this.target=new re,this.state=ai.NONE,this.keyState=ai.NONE,this._lastPosition=new re,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new re,this._movePrev=new rt,this._moveCurr=new rt,this._lastAxis=new re,this._zoomStart=new rt,this._zoomEnd=new rt,this._panStart=new rt,this._panEnd=new rt,this._pointers=[],this._pointerPositions={},this._onPointerMove=Qme.bind(this),this._onPointerDown=Xme.bind(this),this._onPointerUp=Yme.bind(this),this._onPointerCancel=Zme.bind(this),this._onContextMenu=r1e.bind(this),this._onMouseWheel=i1e.bind(this),this._onKeyDown=Jme.bind(this),this._onKeyUp=Kme.bind(this),this._onTouchStart=s1e.bind(this),this._onTouchMove=o1e.bind(this),this._onTouchEnd=a1e.bind(this),this._onMouseDown=e1e.bind(this),this._onMouseMove=t1e.bind(this),this._onMouseUp=n1e.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,t!==null&&(this.connect(t),this.handleResize()),this.update()}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>o7&&(this.dispatchEvent(uy),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>o7||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(uy),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=ai.NONE,this.keyState=ai.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(uy),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(Du.copy(this._panEnd).sub(this._panStart),Du.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,t=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;Du.x*=e,Du.y*=t}Du.multiplyScalar(this._eye.length()*this.panSpeed),R1.copy(this._eye).cross(this.object.up).setLength(Du.x),R1.add($me.copy(this.object.up).setLength(Du.y)),this.object.position.add(R1),this.target.add(R1),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(Du.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){P1.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=P1.length();e?(this._eye.copy(this.object.position).sub(this.target),a7.copy(this._eye).normalize(),N1.copy(this.object.up).normalize(),hy.crossVectors(N1,a7).normalize(),N1.setLength(this._moveCurr.y-this._movePrev.y),hy.setLength(this._moveCurr.x-this._movePrev.x),P1.copy(N1.add(hy)),cy.crossVectors(P1,this._eye).normalize(),e*=this.rotateSpeed,bf.setFromAxisAngle(cy,e),this._eye.applyQuaternion(bf),this.object.up.applyQuaternion(bf),this._lastAxis.copy(cy),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),bf.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(bf),this.object.up.applyQuaternion(bf)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===ai.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=xA.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=xA.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,t){return C1.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),C1}_getMouseOnCircle(e,t){return C1.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-t))/this.screen.width),C1}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId==e.pointerId){this._pointers.splice(t,1);return}}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new rt,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[t.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function Xme(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n))}function Qme(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function Yme(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchEnd(n):this._onMouseUp(),this._removePointer(n),this._pointers.length===0&&(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function Zme(n){this._removePointer(n)}function Kme(){this.enabled!==!1&&(this.keyState=ai.NONE,window.addEventListener("keydown",this._onKeyDown))}function Jme(n){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===ai.NONE&&(n.code===this.keys[ai.ROTATE]&&!this.noRotate?this.keyState=ai.ROTATE:n.code===this.keys[ai.ZOOM]&&!this.noZoom?this.keyState=ai.ZOOM:n.code===this.keys[ai.PAN]&&!this.noPan&&(this.keyState=ai.PAN)))}function e1e(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case na.DOLLY:this.state=ai.ZOOM;break;case na.ROTATE:this.state=ai.ROTATE;break;case na.PAN:this.state=ai.PAN;break;default:this.state=ai.NONE}const t=this.keyState!==ai.NONE?this.keyState:this.state;t===ai.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY)),this._movePrev.copy(this._moveCurr)):t===ai.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(n.pageX,n.pageY)),this._zoomEnd.copy(this._zoomStart)):t===ai.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(n.pageX,n.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(z5)}function t1e(n){const e=this.keyState!==ai.NONE?this.keyState:this.state;e===ai.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY))):e===ai.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(n.pageX,n.pageY)):e===ai.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(n.pageX,n.pageY))}function n1e(){this.state=ai.NONE,this.dispatchEvent(q5)}function i1e(n){if(this.enabled!==!1&&this.noZoom!==!0){switch(n.preventDefault(),n.deltaMode){case 2:this._zoomStart.y-=n.deltaY*.025;break;case 1:this._zoomStart.y-=n.deltaY*.01;break;default:this._zoomStart.y-=n.deltaY*25e-5;break}this.dispatchEvent(z5),this.dispatchEvent(q5)}}function r1e(n){this.enabled!==!1&&n.preventDefault()}function s1e(n){switch(this._trackPointer(n),this._pointers.length){case 1:this.state=ai.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=ai.TOUCH_ZOOM_PAN;const e=this._pointers[0].pageX-this._pointers[1].pageX,t=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+t*t);const i=(this._pointers[0].pageX+this._pointers[1].pageX)/2,r=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(i,r)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(z5)}function o1e(n){switch(this._trackPointer(n),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY));break;default:const e=this._getSecondPointerPosition(n),t=n.pageX-e.x,i=n.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(t*t+i*i);const r=(n.pageX+e.x)/2,s=(n.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(r,s));break}}function a1e(n){switch(this._pointers.length){case 0:this.state=ai.NONE;break;case 1:this.state=ai.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=ai.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==n.pointerId){const t=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(t.x,t.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(q5)}const Tf=new re,l7=new on,u7=new on,c7=new re,h7=new re;class l1e{constructor(e={}){const t=this;let i,r,s,o;const a={objects:new WeakMap},l=e.element!==void 0?e.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:i,height:r}},this.render=function(y,b){y.matrixWorldAutoUpdate===!0&&y.updateMatrixWorld(),b.parent===null&&b.matrixWorldAutoUpdate===!0&&b.updateMatrixWorld(),l7.copy(b.matrixWorldInverse),u7.multiplyMatrices(b.projectionMatrix,l7),A(y,y,b),v(y)},this.setSize=function(y,b){i=y,r=b,s=i/2,o=r/2,l.style.width=y+"px",l.style.height=b+"px"};function u(y){y.isCSS2DObject&&(y.element.style.display="none");for(let b=0,w=y.children.length;b<w;b++)u(y.children[b])}function A(y,b,w){if(y.visible===!1){u(y);return}if(y.isCSS2DObject){Tf.setFromMatrixPosition(y.matrixWorld),Tf.applyMatrix4(u7);const S=Tf.z>=-1&&Tf.z<=1&&y.layers.test(w.layers)===!0,C=y.element;C.style.display=S===!0?"":"none",S===!0&&(y.onBeforeRender(t,b,w),C.style.transform="translate("+-100*y.center.x+"%,"+-100*y.center.y+"%)translate("+(Tf.x*s+s)+"px,"+(-Tf.y*o+o)+"px)",C.parentNode!==l&&l.appendChild(C),y.onAfterRender(t,b,w));const E={distanceToCameraSquared:p(w,y)};a.objects.set(y,E)}for(let S=0,C=y.children.length;S<C;S++)A(y.children[S],b,w)}function p(y,b){return c7.setFromMatrixPosition(y.matrixWorld),h7.setFromMatrixPosition(b.matrixWorld),c7.distanceToSquared(h7)}function g(y){const b=[];return y.traverseVisible(function(w){w.isCSS2DObject&&b.push(w)}),b}function v(y){const b=g(y).sort(function(S,C){if(S.renderOrder!==C.renderOrder)return C.renderOrder-S.renderOrder;const E=a.objects.get(S).distanceToCameraSquared,R=a.objects.get(C).distanceToCameraSquared;return E-R}),w=b.length;for(let S=0,C=b.length;S<C;S++)b[S].element.style.zIndex=w-S}}}const u1e={id:"moonViz"},c1e="./img/moon_4k.jpg",h1e={__name:"leo-3d-moon-site",setup(n){return fu(()=>{const e=`<svg viewBox="-4 0 36 36">
      <path fill="currentColor" d="M14,0 C21.732,0 28,5.641 28,12.6 C28,23.963 14,36 14,36 C14,36 0,24.064 0,12.6 C0,5.641 6.268,0 14,0 Z"></path>
      <circle fill="black" cx="14" cy="14" r="7"></circle>
    </svg>`,i=[...Array(30).keys()].map(()=>({lat:(Math.random()-.5)*180,lng:(Math.random()-.5)*360,size:7+Math.random()*30,color:["red","white","blue","green"][Math.round(Math.random()*3)]})),r=new DI().globeImageUrl(c1e).htmlElementsData(i).htmlElement(u=>{const A=document.createElement("div");return A.innerHTML=e,A.style.color=u.color,A.style.width=`${u.size}px`,A.style.transition="opacity 250ms",A}).htmlElementVisibilityModifier((u,A)=>u.style.opacity=A?1:0),s=[new eb,new l1e];s.forEach((u,A)=>{u.setSize(window.innerWidth,window.innerHeight),A>0&&(u.domElement.style.position="absolute",u.domElement.style.top="0px",u.domElement.style.pointerEvents="none"),document.getElementById("moonViz").appendChild(u.domElement)});const o=new zA;o.add(r),o.add(new k2(13421772,Math.PI)),o.add(new K4(16777215,.6*Math.PI));const a=new Er;a.aspect=window.innerWidth/window.innerHeight,a.updateProjectionMatrix(),a.position.z=500;const l=new jme(a,s[0].domElement);l.minDistance=101,l.rotateSpeed=5,l.zoomSpeed=.8,r.setPointOfView(a),l.addEventListener("change",()=>r.setPointOfView(a)),function u(){l.update(),s.forEach(A=>A.render(o,a)),requestAnimationFrame(u)}()}),(e,t)=>(yt(),Rt("div",u1e))}},f1e=er(h1e,[["__scopeId","data-v-8ef1560d"]]),A1e={class:"w-[640px] h-[480px] flex items-center justify-center bg-red-200"},d1e=Ct({__name:"section3",setup(n){return(e,t)=>(yt(),Rt("div",null,[Ut(Hp,{chapter:"03"},{default:Sr(()=>[Ee("p",null,Ft(Ze(es).title),1),Ee("p",null,Ft(Ze(es).subTitle),1)]),_:1}),Ee("p",null,Ft(Ze(es).p1t1),1),Ee("p",null,Ft(Ze(es).p1t2),1),Ee("p",null,Ft(Ze(es).p1t3),1),t[0]||(t[0]=Ee("div",{class:"w-[640px] h-[480px] flex items-center justify-center bg-red-200"}," satellite fall down ",-1)),Ee("p",null,Ft(Ze(es).p2t1),1),Ee("p",null,Ft(Ze(es).p2t2),1),Ee("p",null,Ft(Ze(es).p2t3),1),Ee("div",A1e,[Ut(f1e)]),t[1]||(t[1]=Ee("div",{class:"w-[640px] h-[480px] flex items-center justify-center bg-red-200"}," moon svg content ",-1)),Ee("p",null,Ft(Ze(es).p3t1),1),Ut(T_,{title:Ze(es).relatedTitle,data:[{title:Ze(es).related1Title,link:Ze(es).related1Link},{title:Ze(es).related2Title,link:Ze(es).related2Link}]},null,8,["title","data"])]))}}),p1e=Ct({__name:"section4",setup(n){return(e,t)=>(yt(),Rt("div",null,[Ut(Hp,{chapter:"04"},{default:Sr(()=>[Ee("p",null,Ft(Ze(ds).title),1),Ee("p",null,Ft(Ze(ds).subTitle),1)]),_:1}),Ee("p",null,Ft(Ze(ds).p1t1),1),Ee("p",null,Ft(Ze(ds).p1t2),1),Ee("p",null,Ft(Ze(ds).p1t3),1),t[0]||(t[0]=Ee("div",{class:"w-[640px] h-[480px] flex items-center justify-center bg-red-200"}," trash float ",-1)),Ee("p",null,Ft(Ze(ds).p2t1),1),Ee("p",null,Ft(Ze(ds).p2t2),1),Ee("p",null,Ft(Ze(ds).p2t3),1),Ut(O5,{title:!0,caption:!0}),Ee("p",null,Ft(Ze(ds).p3t1),1),Ee("p",null,Ft(Ze(ds).p3t2),1),Ut(T_,{title:Ze(ds).relatedTitle,data:[{title:Ze(ds).related1Title,link:Ze(ds).related1Link}]},null,8,["title","data"])]))}}),m1e="",g1e="52053",_1e={title:m1e,p1t1:g1e},v1e=Ct({__name:"section-tw",setup(n){return(e,t)=>(yt(),Rt("div",null,[Ee("p",null,Ft(Ze(_1e).title),1),Ut(VI)]))}}),y1e={class:"app"},x1e={class:"leo-main"},b1e={class:"bg-black text-white"},T1e=Ct({__name:"App",setup(n){return(e,t)=>(yt(),Rt("div",y1e,[Ut(vq),Ee("main",x1e,[Ee("div",b1e,[Ut(jpe),Ut(Hme),Ut(Wme),Ut(d1e),Ut(p1e)]),Ut(v1e)]),Ut(Nq)]))}});$O(T1e).mount("#app");
